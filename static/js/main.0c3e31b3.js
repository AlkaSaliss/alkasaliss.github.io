/*! For license information please see main.0c3e31b3.js.LICENSE.txt */
(()=>{var __webpack_modules__={388:t=>{var e,n=n||{REVISION:"ALPHA"};!function(t){var e=function(t,e){if(!t)throw e||"Assertion failed"},n=function(t,e,n){return t.hasOwnProperty(e)?t[e]:n},r=!1,i=0,o=function(){if(r)return r=!1,i;var t=2*Math.random()-1,e=2*Math.random()-1,n=t*t+e*e;if(0===n||n>1)return o();var a=Math.sqrt(-2*Math.log(n)/n);return i=e*a,r=!0,t*a},a=function(t){if("undefined"===typeof t||isNaN(t))return[];if("undefined"===typeof ArrayBuffer){for(var e=new Array(t),n=0;n<t;n++)e[n]=0;return e}return new Float64Array(t)},s=function(t,e,n){for(var r,i="undefined"!==typeof n,a=[],s=0;s<t;s++){for(var l=[],c=0;c<e;c++)i?l.push(n):l.push((r=1e-4,0+o()*r));a.push(l)}return a},l=function(t,e){for(var n=t.length,r=0,i=0;i<n;i++){var o=t[i],a=e[i];r+=(o-a)*(o-a)}return r},c=function(t,n,r){var i=Math.sqrt(t.length),o=Math.floor(i);e(o===i,"D should have square number of elements.");for(var s=Math.log(n),l=a(o*o),c=a(o),u=0;u<o;u++){for(var h=-1/0,d=1/0,p=1,f=!1,m=0;!f;){for(var g=0,y=0;y<o;y++){var v=Math.exp(-t[u*o+y]*p);u===y&&(v=0),c[y]=v,g+=v}var b=0;for(y=0;y<o;y++){if(0===g)v=0;else v=c[y]/g;c[y]=v,v>1e-7&&(b-=v*Math.log(v))}b>s?(h=p,d===1/0?p*=2:p=(p+d)/2):(d=p,h===-1/0?p/=2:p=(p+h)/2),m++,Math.abs(b-s)<r&&(f=!0),m>=50&&(f=!0)}for(y=0;y<o;y++)l[u*o+y]=c[y]}var x=a(o*o),_=2*o;for(u=0;u<o;u++)for(y=0;y<o;y++)x[u*o+y]=Math.max((l[u*o+y]+l[y*o+u])/_,1e-100);return x};function u(t){return t>0?1:t<0?-1:0}var h=function(t){t=t||{};this.perplexity=n(t,"perplexity",30),this.dim=n(t,"dim",2),this.epsilon=n(t,"epsilon",10),this.iter=0};h.prototype={initDataRaw:function(t){var n=t.length,r=t[0].length;e(n>0," X is empty? You must have some data!"),e(r>0," X[0] is empty? Where is the data?");var i=function(t){for(var e=t.length,n=a(e*e),r=0;r<e;r++)for(var i=r+1;i<e;i++){var o=l(t[r],t[i]);n[r*e+i]=o,n[i*e+r]=o}return n}(t);this.P=c(i,this.perplexity,1e-4),this.N=n,this.initSolution()},initDataDist:function(t){var n=t.length;e(n>0," X is empty? You must have some data!");for(var r=a(n*n),i=0;i<n;i++)for(var o=i+1;o<n;o++){var s=t[i][o];r[i*n+o]=s,r[o*n+i]=s}this.P=c(r,this.perplexity,1e-4),this.N=n,this.initSolution()},initSolution:function(){this.Y=s(this.N,this.dim),this.gains=s(this.N,this.dim,1),this.ystep=s(this.N,this.dim,0),this.iter=0},getSolution:function(){return this.Y},step:function(){this.iter+=1;for(var t=this.N,e=this.costGrad(this.Y),n=e.cost,r=e.grad,i=a(this.dim),o=0;o<t;o++)for(var s=0;s<this.dim;s++){var l=r[o][s],c=this.ystep[o][s],h=this.gains[o][s],d=u(l)===u(c)?.8*h:h+.2;d<.01&&(d=.01),this.gains[o][s]=d;var p=(this.iter<250?.5:.8)*c-this.epsilon*d*r[o][s];this.ystep[o][s]=p,this.Y[o][s]+=p,i[s]+=this.Y[o][s]}for(o=0;o<t;o++)for(s=0;s<this.dim;s++)this.Y[o][s]-=i[s]/t;return n},debugGrad:function(){for(var t=this.N,e=this.costGrad(this.Y),n=(e.cost,e.grad),r=1e-5,i=0;i<t;i++)for(var o=0;o<this.dim;o++){var a=this.Y[i][o];this.Y[i][o]=a+r;var s=this.costGrad(this.Y);this.Y[i][o]=a-r;var l=this.costGrad(this.Y),c=n[i][o],u=(s.cost-l.cost)/(2*r);console.log(i+","+o+": gradcheck analytic: "+c+" vs. numerical: "+u),this.Y[i][o]=a}},costGrad:function(t){for(var e=this.N,n=this.dim,r=this.P,i=this.iter<100?4:1,o=a(e*e),s=0,l=0;l<e;l++)for(var c=l+1;c<e;c++){for(var u=0,h=0;h<n;h++){var d=t[l][h]-t[c][h];u+=d*d}var p=1/(1+u);o[l*e+c]=p,o[c*e+l]=p,s+=2*p}for(var f=e*e,m=a(f),g=0;g<f;g++)m[g]=Math.max(o[g]/s,1e-100);var y=0,v=[];for(l=0;l<e;l++){var b=new Array(n);for(h=0;h<n;h++)b[h]=0;for(c=0;c<e;c++){y+=-r[l*e+c]*Math.log(m[l*e+c]);var x=4*(i*r[l*e+c]-m[l*e+c])*o[l*e+c];for(h=0;h<n;h++)b[h]+=x*(t[l][h]-t[c][h])}v.push(b)}return{cost:y,grad:v}}},t.tSNE=h}(n),e=n,"undefined"===typeof t.exports?window.tsnejs=e:t.exports=e},87:function(t,e,n){(function(){"use strict";var t;function e(t){var e=0;return function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}}var r="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){return t==Array.prototype||t==Object.prototype||(t[e]=n.value),t};var i=function(t){t=["object"==typeof globalThis&&globalThis,t,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof n.g&&n.g];for(var e=0;e<t.length;++e){var r=t[e];if(r&&r.Math==Math)return r}throw Error("Cannot find global object")}(this);function o(t,e){if(e)t:{var n=i;t=t.split(".");for(var o=0;o<t.length-1;o++){var a=t[o];if(!(a in n))break t;n=n[a]}(e=e(o=n[t=t[t.length-1]]))!=o&&null!=e&&r(n,t,{configurable:!0,writable:!0,value:e})}}function a(t){return(t={next:t})[Symbol.iterator]=function(){return this},t}function s(t){var n="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];return n?n.call(t):{next:e(t)}}function l(t){if(!(t instanceof Array)){t=s(t);for(var e,n=[];!(e=t.next()).done;)n.push(e.value);t=n}return t}o("Symbol",(function(t){function e(t,e){this.g=t,r(this,"description",{configurable:!0,writable:!0,value:e})}if(t)return t;e.prototype.toString=function(){return this.g};var n="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",i=0;return function t(r){if(this instanceof t)throw new TypeError("Symbol is not a constructor");return new e(n+(r||"")+"_"+i++,r)}})),o("Symbol.iterator",(function(t){if(t)return t;t=Symbol("Symbol.iterator");for(var n="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),o=0;o<n.length;o++){var s=i[n[o]];"function"===typeof s&&"function"!=typeof s.prototype[t]&&r(s.prototype,t,{configurable:!0,writable:!0,value:function(){return a(e(this))}})}return t}));var c,u="function"==typeof Object.create?Object.create:function(t){function e(){}return e.prototype=t,new e};if("function"==typeof Object.setPrototypeOf)c=Object.setPrototypeOf;else{var h;t:{var d={};try{d.__proto__={a:!0},h=d.a;break t}catch(ye){}h=!1}c=h?function(t,e){if(t.__proto__=e,t.__proto__!==e)throw new TypeError(t+" is not extensible");return t}:null}var p=c;function f(t,e){if(t.prototype=u(e.prototype),t.prototype.constructor=t,p)p(t,e);else for(var n in e)if("prototype"!=n)if(Object.defineProperties){var r=Object.getOwnPropertyDescriptor(e,n);r&&Object.defineProperty(t,n,r)}else t[n]=e[n];t.ea=e.prototype}function m(){this.l=!1,this.i=null,this.h=void 0,this.g=1,this.s=this.m=0,this.j=null}function g(t){if(t.l)throw new TypeError("Generator is already running");t.l=!0}function y(t,e){t.j={U:e,V:!0},t.g=t.m||t.s}function v(t,e,n){return t.g=n,{value:e}}function b(t){this.g=new m,this.h=t}function x(t,e,n,r){try{var i=e.call(t.g.i,n);if(!(i instanceof Object))throw new TypeError("Iterator result "+i+" is not an object");if(!i.done)return t.g.l=!1,i;var o=i.value}catch(a){return t.g.i=null,y(t.g,a),_(t)}return t.g.i=null,r.call(t.g,o),_(t)}function _(t){for(;t.g.g;)try{var e=t.h(t.g);if(e)return t.g.l=!1,{value:e.value,done:!1}}catch(n){t.g.h=void 0,y(t.g,n)}if(t.g.l=!1,t.g.j){if(e=t.g.j,t.g.j=null,e.V)throw e.U;return{value:e.return,done:!0}}return{value:void 0,done:!0}}function w(t){this.next=function(e){return g(t.g),t.g.i?e=x(t,t.g.i.next,e,t.g.o):(t.g.o(e),e=_(t)),e},this.throw=function(e){return g(t.g),t.g.i?e=x(t,t.g.i.throw,e,t.g.o):(y(t.g,e),e=_(t)),e},this.return=function(e){return function(t,e){g(t.g);var n=t.g.i;return n?x(t,"return"in n?n.return:function(t){return{value:t,done:!0}},e,t.g.return):(t.g.return(e),_(t))}(t,e)},this[Symbol.iterator]=function(){return this}}function S(t,e){return e=new w(new b(e)),p&&t.prototype&&p(e,t.prototype),e}m.prototype.o=function(t){this.h=t},m.prototype.return=function(t){this.j={return:t},this.g=this.s};var T="function"==typeof Object.assign?Object.assign:function(t,e){for(var n=1;n<arguments.length;n++){var r=arguments[n];if(r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t};o("Object.assign",(function(t){return t||T})),o("Promise",(function(t){function e(t){this.h=0,this.i=void 0,this.g=[],this.o=!1;var e=this.j();try{t(e.resolve,e.reject)}catch(n){e.reject(n)}}function n(){this.g=null}function r(t){return t instanceof e?t:new e((function(e){e(t)}))}if(t)return t;n.prototype.h=function(t){if(null==this.g){this.g=[];var e=this;this.i((function(){e.l()}))}this.g.push(t)};var o=i.setTimeout;n.prototype.i=function(t){o(t,0)},n.prototype.l=function(){for(;this.g&&this.g.length;){var t=this.g;this.g=[];for(var e=0;e<t.length;++e){var n=t[e];t[e]=null;try{n()}catch(r){this.j(r)}}}this.g=null},n.prototype.j=function(t){this.i((function(){throw t}))},e.prototype.j=function(){function t(t){return function(r){n||(n=!0,t.call(e,r))}}var e=this,n=!1;return{resolve:t(this.C),reject:t(this.l)}},e.prototype.C=function(t){if(t===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(t instanceof e)this.F(t);else{t:switch(typeof t){case"object":var n=null!=t;break t;case"function":n=!0;break t;default:n=!1}n?this.u(t):this.m(t)}},e.prototype.u=function(t){var e=void 0;try{e=t.then}catch(n){return void this.l(n)}"function"==typeof e?this.G(e,t):this.m(t)},e.prototype.l=function(t){this.s(2,t)},e.prototype.m=function(t){this.s(1,t)},e.prototype.s=function(t,e){if(0!=this.h)throw Error("Cannot settle("+t+", "+e+"): Promise already settled in state"+this.h);this.h=t,this.i=e,2===this.h&&this.D(),this.A()},e.prototype.D=function(){var t=this;o((function(){if(t.B()){var e=i.console;"undefined"!==typeof e&&e.error(t.i)}}),1)},e.prototype.B=function(){if(this.o)return!1;var t=i.CustomEvent,e=i.Event,n=i.dispatchEvent;return"undefined"===typeof n||("function"===typeof t?t=new t("unhandledrejection",{cancelable:!0}):"function"===typeof e?t=new e("unhandledrejection",{cancelable:!0}):(t=i.document.createEvent("CustomEvent")).initCustomEvent("unhandledrejection",!1,!0,t),t.promise=this,t.reason=this.i,n(t))},e.prototype.A=function(){if(null!=this.g){for(var t=0;t<this.g.length;++t)a.h(this.g[t]);this.g=null}};var a=new n;return e.prototype.F=function(t){var e=this.j();t.J(e.resolve,e.reject)},e.prototype.G=function(t,e){var n=this.j();try{t.call(e,n.resolve,n.reject)}catch(r){n.reject(r)}},e.prototype.then=function(t,n){function r(t,e){return"function"==typeof t?function(e){try{i(t(e))}catch(n){o(n)}}:e}var i,o,a=new e((function(t,e){i=t,o=e}));return this.J(r(t,i),r(n,o)),a},e.prototype.catch=function(t){return this.then(void 0,t)},e.prototype.J=function(t,e){function n(){switch(r.h){case 1:t(r.i);break;case 2:e(r.i);break;default:throw Error("Unexpected state: "+r.h)}}var r=this;null==this.g?a.h(n):this.g.push(n),this.o=!0},e.resolve=r,e.reject=function(t){return new e((function(e,n){n(t)}))},e.race=function(t){return new e((function(e,n){for(var i=s(t),o=i.next();!o.done;o=i.next())r(o.value).J(e,n)}))},e.all=function(t){var n=s(t),i=n.next();return i.done?r([]):new e((function(t,e){function o(e){return function(n){a[e]=n,0==--s&&t(a)}}var a=[],s=0;do{a.push(void 0),s++,r(i.value).J(o(a.length-1),e),i=n.next()}while(!i.done)}))},e})),o("Object.is",(function(t){return t||function(t,e){return t===e?0!==t||1/t===1/e:t!==t&&e!==e}})),o("Array.prototype.includes",(function(t){return t||function(t,e){var n=this;n instanceof String&&(n=String(n));var r=n.length;for(0>(e=e||0)&&(e=Math.max(e+r,0));e<r;e++){var i=n[e];if(i===t||Object.is(i,t))return!0}return!1}})),o("String.prototype.includes",(function(t){return t||function(t,e){if(null==this)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(t instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return-1!==this.indexOf(t,e||0)}})),o("Array.prototype.keys",(function(t){return t||function(){return function(t,e){t instanceof String&&(t+="");var n=0,r=!1,i={next:function(){if(!r&&n<t.length){var i=n++;return{value:e(i,t[i]),done:!1}}return r=!0,{done:!0,value:void 0}}};return i[Symbol.iterator]=function(){return i},i}(this,(function(t){return t}))}}));var E=this||self;function M(t,e){t=t.split(".");var n,r=E;t[0]in r||"undefined"==typeof r.execScript||r.execScript("var "+t[0]);for(;t.length&&(n=t.shift());)t.length||void 0===e?r=r[n]&&r[n]!==Object.prototype[n]?r[n]:r[n]={}:r[n]=e}function C(t,e){return e=String.fromCharCode.apply(null,e),null==t?e:t+e}var A,k,I="undefined"!==typeof TextDecoder,R="undefined"!==typeof TextEncoder;function P(t){if(R)t=(k||(k=new TextEncoder)).encode(t);else{var e=void 0;e=void 0!==e&&e;for(var n=0,r=new Uint8Array(3*t.length),i=0;i<t.length;i++){var o=t.charCodeAt(i);if(128>o)r[n++]=o;else{if(2048>o)r[n++]=o>>6|192;else{if(55296<=o&&57343>=o){if(56319>=o&&i<t.length){var a=t.charCodeAt(++i);if(56320<=a&&57343>=a){o=1024*(o-55296)+a-56320+65536,r[n++]=o>>18|240,r[n++]=o>>12&63|128,r[n++]=o>>6&63|128,r[n++]=63&o|128;continue}i--}if(e)throw Error("Found an unpaired surrogate");o=65533}r[n++]=o>>12|224,r[n++]=o>>6&63|128}r[n++]=63&o|128}}t=r.subarray(0,n)}return t}var N={},O=null;function D(t,e){void 0===e&&(e=0),F(),e=N[e];for(var n=Array(Math.floor(t.length/3)),r=e[64]||"",i=0,o=0;i<t.length-2;i+=3){var a=t[i],s=t[i+1],l=t[i+2],c=e[a>>2];a=e[(3&a)<<4|s>>4],s=e[(15&s)<<2|l>>6],l=e[63&l],n[o++]=c+a+s+l}switch(c=0,l=r,t.length-i){case 2:l=e[(15&(c=t[i+1]))<<2]||r;case 1:t=t[i],n[o]=e[t>>2]+e[(3&t)<<4|c>>4]+l+r}return n.join("")}function L(t){var e=t.length,n=3*e/4;n%3?n=Math.floor(n):-1!="=.".indexOf(t[e-1])&&(n=-1!="=.".indexOf(t[e-2])?n-2:n-1);var r=new Uint8Array(n),i=0;return function(t,e){function n(e){for(;r<t.length;){var n=t.charAt(r++),i=O[n];if(null!=i)return i;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return e}F();for(var r=0;;){var i=n(-1),o=n(0),a=n(64),s=n(64);if(64===s&&-1===i)break;e(i<<2|o>>4),64!=a&&(e(o<<4&240|a>>2),64!=s&&e(a<<6&192|s))}}(t,(function(t){r[i++]=t})),r.subarray(0,i)}function F(){if(!O){O={};for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),e=["+/=","+/","-_=","-_.","-_"],n=0;5>n;n++){var r=t.concat(e[n].split(""));N[n]=r;for(var i=0;i<r.length;i++){var o=r[i];void 0===O[o]&&(O[o]=i)}}}}var U,B="function"===typeof Uint8Array.prototype.slice;function z(t,e,n){return e===n?U||(U=new Uint8Array(0)):B?t.slice(e,n):new Uint8Array(t.subarray(e,n))}var j=0;function V(t,e){e=void 0!==(e=void 0===e?{}:e).v&&e.v,this.h=null,this.g=this.j=this.l=0,this.m=!1,this.v=e,t&&W(this,t)}function W(t,e){e=e.constructor===Uint8Array?e:e.constructor===ArrayBuffer||e.constructor===Array?new Uint8Array(e):e.constructor===String?L(e):e instanceof Uint8Array?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(0),t.h=e,t.l=0,t.j=t.h.length,t.g=t.l}function G(t){for(var e=128,n=0,r=0,i=0;4>i&&128<=e;i++)n|=(127&(e=t.h[t.g++]))<<7*i;if(128<=e&&(n|=(127&(e=t.h[t.g++]))<<28,r|=(127&e)>>4),128<=e)for(i=0;5>i&&128<=e;i++)r|=(127&(e=t.h[t.g++]))<<7*i+3;if(128>e)return t=n>>>0,(r=2147483648&(e=r>>>0))&&(e=~e>>>0,0==(t=1+~t>>>0)&&(e=e+1>>>0)),t=4294967296*e+(t>>>0),r?-t:t;t.m=!0}V.prototype.reset=function(){this.g=this.l},V.prototype.i=function(){var t=this.h,e=t[this.g],n=127&e;return 128>e?(this.g+=1,n):(n|=(127&(e=t[this.g+1]))<<7,128>e?(this.g+=2,n):(n|=(127&(e=t[this.g+2]))<<14,128>e?(this.g+=3,n):(n|=(127&(e=t[this.g+3]))<<21,128>e?(this.g+=4,n):(n|=(15&(e=t[this.g+4]))<<28,128>e?(this.g+=5,n>>>0):(this.g+=5,128<=t[this.g++]&&128<=t[this.g++]&&128<=t[this.g++]&&128<=t[this.g++]&&this.g++,n)))))},V.prototype.o=function(){var t=this.h[this.g],e=this.h[this.g+1],n=this.h[this.g+2],r=this.h[this.g+3];return this.g+=4,t=2*((n=(t|e<<8|n<<16|r<<24)>>>0)>>31)+1,e=n>>>23&255,n&=8388607,255==e?n?NaN:1/0*t:0==e?t*Math.pow(2,-149)*n:t*Math.pow(2,e-150)*(n+Math.pow(2,23))};var H=[];function q(){this.g=new Uint8Array(64),this.h=0}function X(t,e){for(;127<e;)t.push(127&e|128),e>>>=7;t.push(e)}function Y(t){var e={},n=void 0!==e.N&&e.N;this.o={v:void 0!==e.v&&e.v},this.N=n,e=this.o,H.length?(n=H.pop(),e&&(n.v=e.v),t&&W(n,t),t=n):t=new V(t,e),this.g=t,this.m=this.g.g,this.h=this.i=this.l=-1,this.j=!1}function K(t){var e=t.g;if((e=e.g==e.j)||(e=t.j)||(e=(e=t.g).m||0>e.g||e.g>e.j),e)return!1;t.m=t.g.g;var n=7&(e=t.g.i());return 0!=n&&5!=n&&1!=n&&2!=n&&3!=n&&4!=n?(t.j=!0,!1):(t.i=e,t.l=e>>>3,t.h=n,!0)}function Z(t){switch(t.h){case 0:if(0!=t.h)Z(t);else{for(t=t.g;128&t.h[t.g];)t.g++;t.g++}break;case 1:1!=t.h?Z(t):(t=t.g).g+=8;break;case 2:if(2!=t.h)Z(t);else{var e=t.g.i();(t=t.g).g+=e}break;case 5:5!=t.h?Z(t):(t=t.g).g+=4;break;case 3:for(e=t.l;;){if(!K(t)){t.j=!0;break}if(4==t.h){t.l!=e&&(t.j=!0);break}Z(t)}break;default:t.j=!0}}function J(t,e,n){var r=t.g.j,i=t.g.i(),o=t.g.g+i;if(t.g.j=o,n(e,t),0!==(n=o-t.g.g))throw Error("Message parsing ended unexpectedly. Expected to read "+i+" bytes, instead read "+(i-n)+" bytes, either the data ended unexpectedly or the message misreported its own length");return t.g.g=o,t.g.j=r,e}function Q(t){return t.g.o()}function $(t){var e,n=t.g.i(),r=(t=t.g).g;if(t.g+=n,t=t.h,I)(e=A)||(e=A=new TextDecoder("utf-8",{fatal:!1})),e=e.decode(t.subarray(r,r+n));else{n=r+n;for(var i,o,a,s=[],l=null;r<n;)128>(i=t[r++])?s.push(i):224>i?r>=n?s.push(65533):(o=t[r++],194>i||128!==(192&o)?(r--,s.push(65533)):s.push((31&i)<<6|63&o)):240>i?r>=n-1?s.push(65533):128!==(192&(o=t[r++]))||224===i&&160>o||237===i&&160<=o||128!==(192&(e=t[r++]))?(r--,s.push(65533)):s.push((15&i)<<12|(63&o)<<6|63&e):244>=i?r>=n-2?s.push(65533):128!==(192&(o=t[r++]))||0!==o-144+(i<<28)>>30||128!==(192&(e=t[r++]))||128!==(192&(a=t[r++]))?(r--,s.push(65533)):(i=(7&i)<<18|(63&o)<<12|(63&e)<<6|63&a,i-=65536,s.push(55296+(i>>10&1023),56320+(1023&i))):s.push(65533),8192<=s.length&&(l=C(l,s),s.length=0);e=C(l,s)}return e}function tt(t,e,n){var r=t.g.i();for(r=t.g.g+r;t.g.g<r;)n.push(e.call(t.g))}function et(t,e){2==t.h?tt(t,V.prototype.o,e):e.push(Q(t))}function nt(){this.h=[],this.i=0,this.g=new q}function rt(t,e){0!==e.length&&(t.h.push(e),t.i+=e.length)}function it(t){var e=t.i+t.g.length();if(0===e)return new Uint8Array(0);e=new Uint8Array(e);for(var n=t.h,r=n.length,i=0,o=0;o<r;o++){var a=n[o];0!==a.length&&(e.set(a,i),i+=a.length)}return 0!==(r=(n=t.g).h)&&(e.set(n.g.subarray(0,r),i),n.h=0),t.h=[e],e}function ot(t,e,n){if(null!=n){X(t.g,8*e+5),t=t.g;var r=n;0===(r=(n=0>r?1:0)?-r:r)?0<1/r?j=0:j=2147483648:isNaN(r)?j=2147483647:34028234663852886e22<r?j=(n<<31|2139095040)>>>0:11754943508222875e-54>r?(r=Math.round(r/Math.pow(2,-149)),j=(n<<31|r)>>>0):(e=Math.floor(Math.log(r)/Math.LN2),r*=Math.pow(2,-e),16777216<=(r=Math.round(8388608*r))&&++e,j=(n<<31|e+127<<23|8388607&r)>>>0),n=j,t.push(n>>>0&255),t.push(n>>>8&255),t.push(n>>>16&255),t.push(n>>>24&255)}}q.prototype.push=function(t){if(!(this.h+1<this.g.length)){var e=this.g;this.g=new Uint8Array(Math.ceil(1+2*this.g.length)),this.g.set(e)}this.g[this.h++]=t},q.prototype.length=function(){return this.h},q.prototype.end=function(){var t=this.g,e=this.h;return this.h=0,z(t,0,e)},Y.prototype.reset=function(){this.g.reset(),this.h=this.l=-1};var at="function"===typeof Uint8Array;function st(t,e,n){if(null!=t)return"object"===typeof t?at&&t instanceof Uint8Array?n(t):lt(t,e,n):e(t)}function lt(t,e,n){if(Array.isArray(t)){for(var r=Array(t.length),i=0;i<t.length;i++)r[i]=st(t[i],e,n);return Array.isArray(t)&&t.W&&dt(r),r}for(i in r={},t)r[i]=st(t[i],e,n);return r}function ct(t){return"number"===typeof t?isFinite(t)?t:String(t):t}var ut,ht={W:{value:!0,configurable:!0}};function dt(t){return Array.isArray(t)&&!Object.isFrozen(t)&&Object.defineProperties(t,ht),t}function pt(t,e,n){var r=ut;if(ut=null,t||(t=r),r=this.constructor.ca,t||(t=r?[r]:[]),this.j=r?0:-1,this.m=this.g=null,this.h=t,t=(r=this.h.length)-1,!r||(null===(r=this.h[t])||"object"!=typeof r||Array.isArray(r)||at&&r instanceof Uint8Array)?void 0!==e&&-1<e?(this.l=Math.max(e,t+1-this.j),this.i=null):this.l=Number.MAX_VALUE:(this.l=t-this.j,this.i=r),n)for(e=0;e<n.length;e++)(t=n[e])<this.l?(t+=this.j,(r=this.h[t])?dt(r):this.h[t]=ft):(mt(this),(r=this.i[t])?dt(r):this.i[t]=ft)}var ft=Object.freeze(dt([]));function mt(t){var e=t.l+t.j;t.h[e]||(t.i=t.h[e]={})}function gt(t,e,n){return-1===e?null:void 0!==n&&n||e>=t.l?t.i?t.i[e]:void 0:t.h[e+t.j]}function yt(t,e){var n=void 0!==n&&n,r=gt(t,e,n);return null==r&&(r=ft),r===ft&&_t(t,e,r=dt([]),n),r}function vt(t){var e=yt(t,3);if(t.m||(t.m={}),!t.m[3]){for(var n=0;n<e.length;n++)e[n]=+e[n];t.m[3]=!0}return e}function bt(t,e,n){return null==(t=gt(t,e))?n:t}function xt(t,e,n){return null==(t=null==(t=gt(t,e))?t:+t)?void 0===n?0:n:t}function _t(t,e,n,r){void 0!==r&&r||e>=t.l?(mt(t),t.i[e]=n):t.h[e+t.j]=n}function wt(t,e,n){if(-1===n)return null;if(t.g||(t.g={}),!t.g[n]){var r=gt(t,n,!1);r&&(t.g[n]=new e(r))}return t.g[n]}function St(t,e){t.g||(t.g={});var n=t.g[1];if(!n){var r=yt(t,1);n=[];for(var i=0;i<r.length;i++)n[i]=new e(r[i]);t.g[1]=n}return n}function Tt(t,e,n){var r=void 0!==r&&r;t.g||(t.g={});var i=n?Mt(n,!1):n;t.g[e]=n,_t(t,e,i,r)}function Et(t,e,n,r){var i=St(t,n);e=e||new n,t=yt(t,1),void 0!=r?(i.splice(r,0,e),t.splice(r,0,Mt(e,!1))):(i.push(e),t.push(Mt(e,!1)))}function Mt(t,e){if(t.g)for(var n in t.g){var r=t.g[n];if(Array.isArray(r))for(var i=0;i<r.length;i++)r[i]&&Mt(r[i],e);else r&&Mt(r,e)}return t.h}function Ct(t,e){if(t=t.o){rt(e,e.g.end());for(var n=0;n<t.length;n++)rt(e,t[n])}}function At(t,e){if(4==e.h)return!1;var n=e.m;return Z(e),e.N||(e=z(e.g.h,n,e.g.g),(n=t.o)?n.push(e):t.o=[e]),!0}function kt(t){pt.call(this,t,-1,Rt)}function It(t,e){for(;K(e);)switch(e.i){case 8:var n=e.g.i();_t(t,1,n);break;case 16:_t(t,2,n=e.g.i());break;case 29:case 26:et(e,t.getPackedDataList());break;case 32:_t(t,4,n=G(e.g));break;default:if(!At(t,e))return t}return t}pt.prototype.toJSON=function(){return lt(Mt(this,!1),ct,D)},pt.prototype.toString=function(){return Mt(this,!1).toString()},f(kt,pt),kt.prototype.getRows=function(){return gt(this,1)},kt.prototype.getCols=function(){return gt(this,2)},kt.prototype.getPackedDataList=function(){return vt(this)},kt.prototype.getLayout=function(){return bt(this,4,0)};var Rt=[3];function Pt(t,e){var n=void 0;return new(n||(n=Promise))((function(r,i){function o(t){try{s(e.next(t))}catch(n){i(n)}}function a(t){try{s(e.throw(t))}catch(n){i(n)}}function s(t){t.done?r(t.value):new n((function(e){e(t.value)})).then(o,a)}s((e=e.apply(t,void 0)).next())}))}function Nt(t){pt.call(this,t)}function Ot(t,e){for(;K(e);)switch(e.i){case 8:var n=e.g.i();_t(t,1,n);break;case 21:_t(t,2,n=Q(e));break;case 26:_t(t,3,n=$(e));break;case 34:_t(t,4,n=$(e));break;default:if(!At(t,e))return t}return t}function Dt(t){pt.call(this,t,-1,Lt)}f(Nt,pt),f(Dt,pt),Dt.prototype.addClassification=function(t,e){return Et(this,t,Nt,e),this};var Lt=[1];function Ft(t){pt.call(this,t)}function Ut(t,e){for(;K(e);)switch(e.i){case 13:var n=Q(e);_t(t,1,n);break;case 21:_t(t,2,n=Q(e));break;case 29:_t(t,3,n=Q(e));break;case 37:_t(t,4,n=Q(e));break;case 45:_t(t,5,n=Q(e));break;default:if(!At(t,e))return t}return t}function Bt(t){pt.call(this,t,-1,jt)}function zt(t){t:{var e=new Bt;for(t=new Y(t);K(t);)if(10===t.i){Et(e,J(t,new Ft,Ut),Ft,void 0)}else if(!At(e,t))break t}return e}f(Ft,pt),f(Bt,pt);var jt=[1];function Vt(t){pt.call(this,t)}function Wt(t){pt.call(this,t,-1,Ht)}function Gt(t,e){for(;K(e);)switch(e.i){case 8:var n=G(e.g);_t(t,1,n);break;case 16:_t(t,2,n=G(e.g));break;case 29:case 26:et(e,t.getVertexBufferList());break;case 32:case 34:n=e;var r=t.getIndexBufferList();2==n.h?tt(n,V.prototype.i,r):r.push(n.g.i());break;default:if(!At(t,e))return t}return t}f(Vt,pt),f(Wt,pt),Wt.prototype.getVertexType=function(){return bt(this,1,0)},Wt.prototype.getPrimitiveType=function(){return bt(this,2,0)},Wt.prototype.getVertexBufferList=function(){return vt(this)},Wt.prototype.getIndexBufferList=function(){return yt(this,4)};var Ht=[3,4];function qt(t){pt.call(this,t)}function Xt(t,e,n){if(n=t.createShader(0===n?t.VERTEX_SHADER:t.FRAGMENT_SHADER),t.shaderSource(n,e),t.compileShader(n),!t.getShaderParameter(n,t.COMPILE_STATUS))throw Error("Could not compile WebGL shader.\n\n"+t.getShaderInfoLog(n));return n}function Yt(t){return St(t,Nt).map((function(t){return{index:bt(t,1,0),Y:xt(t,2),label:null!=gt(t,3)?bt(t,3,""):void 0,displayName:null!=gt(t,4)?bt(t,4,""):void 0}}))}function Kt(t){return{x:xt(t,1),y:xt(t,2),z:xt(t,3),visibility:null!=gt(t,4)?xt(t,4):void 0}}function Zt(t,e){this.h=t,this.g=e,this.l=0}function Jt(t,e,n){return function(t,e){var n=t.g;if(void 0===t.m){var r=Xt(n,"\n  attribute vec2 aVertex;\n  attribute vec2 aTex;\n  varying vec2 vTex;\n  void main(void) {\n    gl_Position = vec4(aVertex, 0.0, 1.0);\n    vTex = aTex;\n  }",0),i=Xt(n,"\n  precision mediump float;\n  varying vec2 vTex;\n  uniform sampler2D sampler0;\n  void main(){\n    gl_FragColor = texture2D(sampler0, vTex);\n  }",1),o=n.createProgram();if(n.attachShader(o,r),n.attachShader(o,i),n.linkProgram(o),!n.getProgramParameter(o,n.LINK_STATUS))throw Error("Could not compile WebGL program.\n\n"+n.getProgramInfoLog(o));r=t.m=o,n.useProgram(r),i=n.getUniformLocation(r,"sampler0"),t.j={I:n.getAttribLocation(r,"aVertex"),H:n.getAttribLocation(r,"aTex"),da:i},t.s=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,t.s),n.enableVertexAttribArray(t.j.I),n.vertexAttribPointer(t.j.I,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),t.o=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,t.o),n.enableVertexAttribArray(t.j.H),n.vertexAttribPointer(t.j.H,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),n.uniform1i(i,0)}r=t.j,n.useProgram(t.m),n.canvas.width=e.width,n.canvas.height=e.height,n.viewport(0,0,e.width,e.height),n.activeTexture(n.TEXTURE0),t.h.bindTexture2d(e.glName),n.enableVertexAttribArray(r.I),n.bindBuffer(n.ARRAY_BUFFER,t.s),n.vertexAttribPointer(r.I,2,n.FLOAT,!1,0,0),n.enableVertexAttribArray(r.H),n.bindBuffer(n.ARRAY_BUFFER,t.o),n.vertexAttribPointer(r.H,2,n.FLOAT,!1,0,0),n.bindFramebuffer(n.DRAW_FRAMEBUFFER?n.DRAW_FRAMEBUFFER:n.FRAMEBUFFER,null),n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT),n.colorMask(!0,!0,!0,!0),n.drawArrays(n.TRIANGLE_FAN,0,4),n.disableVertexAttribArray(r.I),n.disableVertexAttribArray(r.H),n.bindBuffer(n.ARRAY_BUFFER,null),t.h.bindTexture2d(0)}(t,e),"function"===typeof t.g.canvas.transferToImageBitmap?Promise.resolve(t.g.canvas.transferToImageBitmap()):n?Promise.resolve(t.g.canvas):"function"===typeof createImageBitmap?createImageBitmap(t.g.canvas):(void 0===t.i&&(t.i=document.createElement("canvas")),new Promise((function(e){t.i.height=t.g.canvas.height,t.i.width=t.g.canvas.width,t.i.getContext("2d",{}).drawImage(t.g.canvas,0,0,t.g.canvas.width,t.g.canvas.height),e(t.i)})))}function Qt(t){this.g=t}f(qt,pt),qt.prototype.getMesh=function(){return wt(this,Wt,1)},qt.prototype.getPoseTransformMatrix=function(){return wt(this,kt,2)};var $t=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function te(t,e){return e+t}function ee(t,e){window[t]=e}function ne(t){if(this.g=t,this.listeners={},this.j={},this.F={},this.m={},this.s={},this.G=this.o=this.R=!0,this.C=Promise.resolve(),this.P="",this.B={},this.locateFile=t&&t.locateFile||te,"object"===typeof window)var e=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else{if("undefined"===typeof location)throw Error("solutions can only be loaded on a web page or in a web worker");e=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/"}if(this.S=e,t.options)for(var n=(e=s(Object.keys(t.options))).next();!n.done;n=e.next()){n=n.value;var r=t.options[n].default;void 0!==r&&(this.j[n]="function"===typeof r?r():r)}}function re(t){return Pt(t,(function t(){var e,n,r,i,o,a,s,c,u,h,d,p=this;return S(t,(function(t){switch(t.g){case 1:return e=p,p.R?(n=function(t,e){return void 0===t.g.files?[]:"function"===typeof t.g.files?t.g.files(e):t.g.files}(p,p.j),v(t,function(){return Pt(this,(function t(){return S(t,(function(t){switch(t.g){case 1:return t.m=2,v(t,WebAssembly.instantiate($t),4);case 4:t.g=3,t.m=0;break;case 2:return t.m=0,t.j=null,t.return(!1);case 3:return t.return(!0)}}))}))}(),2)):t.return();case 2:if(r=t.h,"object"===typeof window)return ee("createMediapipeSolutionsWasm",{locateFile:p.locateFile}),ee("createMediapipeSolutionsPackedAssets",{locateFile:p.locateFile}),a=n.filter((function(t){return void 0!==t.data})),s=n.filter((function(t){return void 0===t.data})),c=Promise.all(a.map((function(t){var n=ie(e,t.url);if(void 0!==t.path){var r=t.path;n=n.then((function(t){return e.overrideFile(r,t),Promise.resolve(t)}))}return n}))),u=Promise.all(s.map((function(t){return void 0===t.simd||t.simd&&r||!t.simd&&!r?function(t){var e=document.createElement("script");return e.setAttribute("src",t),e.setAttribute("crossorigin","anonymous"),new Promise((function(t){e.addEventListener("load",(function(){t()}),!1),e.addEventListener("error",(function(){t()}),!1),document.body.appendChild(e)}))}(e.locateFile(t.url,e.S)):Promise.resolve()}))).then((function(){return Pt(e,(function t(){var e,n,r=this;return S(t,(function(t){if(1==t.g)return e=window.createMediapipeSolutionsWasm,n=window.createMediapipeSolutionsPackedAssets,v(t,e(n),2);r.h=t.h,t.g=0}))}))})),h=Pt(e,(function t(){var e=this;return S(t,(function(t){return e.g.graph&&e.g.graph.url?t=v(t,ie(e,e.g.graph.url),0):(t.g=0,t=void 0),t}))})),v(t,Promise.all([u,c,h]),7);if("function"!==typeof importScripts)throw Error("solutions can only be loaded on a web page or in a web worker");return i=n.filter((function(t){return void 0===t.simd||t.simd&&r||!t.simd&&!r})).map((function(t){return e.locateFile(t.url,e.S)})),importScripts.apply(null,l(i)),v(t,createMediapipeSolutionsWasm(Module),6);case 6:p.h=t.h,p.l=new OffscreenCanvas(1,1),p.h.canvas=p.l,o=p.h.GL.createContext(p.l,{antialias:!1,alpha:!1,ba:"undefined"!==typeof WebGL2RenderingContext?2:1}),p.h.GL.makeContextCurrent(o),t.g=4;break;case 7:if(p.l=document.createElement("canvas"),!(d=p.l.getContext("webgl2",{}))&&!(d=p.l.getContext("webgl",{})))return alert("Failed to create WebGL canvas context when passing video frame."),t.return();p.D=d,p.h.canvas=p.l,p.h.createContext(p.l,!0,!0,{});case 4:p.i=new p.h.SolutionWasm,p.R=!1,t.g=0}}))}))}function ie(t,e){return Pt(t,(function t(){var n,r,i=this;return S(t,(function(t){return e in i.F?t.return(i.F[e]):(n=i.locateFile(e,""),r=fetch(n).then((function(t){return t.arrayBuffer()})),i.F[e]=r,t.return(r))}))}))}function oe(t,e,n){return Pt(t,(function t(){var r,i,o,a,l,c,u,h,d,p,f,m,g,y,b=this;return S(t,(function(t){switch(t.g){case 1:if(!n)return t.return(e);for(r={},i=0,o=s(Object.keys(n)),a=o.next();!a.done;a=o.next())l=a.value,"string"!==typeof(c=n[l])&&"texture"===c.type&&void 0!==e[c.stream]&&++i;1<i&&(b.G=!1),u=s(Object.keys(n)),a=u.next();case 2:if(a.done){t.g=4;break}if(h=a.value,"string"===typeof(d=n[h]))return g=r,y=h,v(t,function(t,e,n){return Pt(t,(function t(){var r,i=this;return S(t,(function(t){return"number"===typeof n||n instanceof Uint8Array||n instanceof i.h.Uint8BlobList?t.return(n):n instanceof i.h.Texture2dDataOut?((r=i.s[e])||(r=new Zt(i.h,i.D),i.s[e]=r),t.return(Jt(r,n,i.G))):t.return(void 0)}))}))}(b,h,e[d]),14);if(p=e[d.stream],"detection_list"===d.type){if(p){for(var x=p.getRectList(),_=p.getLandmarksList(),w=p.getClassificationsList(),T=[],E=0;E<x.size();++E){var M=x.get(E);t:{var C=new Vt;for(M=new Y(M);K(M);)switch(M.i){case 13:var A=Q(M);_t(C,1,A);break;case 21:_t(C,2,A=Q(M));break;case 29:_t(C,3,A=Q(M));break;case 37:_t(C,4,A=Q(M));break;case 45:_t(C,5,A=Q(M));break;case 48:_t(C,6,A=G(M.g));break;default:if(!At(C,M))break t}}C={Z:xt(C,1),$:xt(C,2),height:xt(C,3),width:xt(C,4),rotation:xt(C,5,0),X:bt(C,6,0)},M=St(zt(_.get(E)),Ft).map(Kt);var k=w.get(E);t:for(A=new Dt,k=new Y(k);K(k);)if(10===k.i)A.addClassification(J(k,new Nt,Ot));else if(!At(A,k))break t;C={T:C,O:M,M:Yt(A)},T.push(C)}x=T}else x=[];r[h]=x,t.g=7;break}if("proto_list"===d.type){if(p){for(x=Array(p.size()),_=0;_<p.size();_++)x[_]=p.get(_);p.delete()}else x=[];r[h]=x,t.g=7;break}if(void 0===p){t.g=3;break}if("float_list"===d.type){r[h]=p,t.g=7;break}if("proto"===d.type){r[h]=p,t.g=7;break}if("texture"!==d.type)throw Error("Unknown output config type: '"+d.type+"'");return(f=b.s[h])||(f=new Zt(b.h,b.D),b.s[h]=f),v(t,Jt(f,p,b.G),13);case 13:m=t.h,r[h]=m;case 7:d.transform&&r[h]&&(r[h]=d.transform(r[h])),t.g=3;break;case 14:g[y]=t.h;case 3:a=u.next(),t.g=2;break;case 4:return t.return(r)}}))}))}function ae(t,e){for(var n=e.name||"$",r=[].concat(l(e.wants)),i=new t.h.StringList,o=s(e.wants),a=o.next();!a.done;a=o.next())i.push_back(a.value);o=t.h.PacketListener.implement({onResults:function(i){for(var o={},a=0;a<e.wants.length;++a)o[r[a]]=i.get(a);var s=t.listeners[n];s&&(t.C=oe(t,o,e.outs).then((function(n){n=s(n);for(var i=0;i<e.wants.length;++i){var a=o[r[i]];"object"===typeof a&&a.hasOwnProperty&&a.hasOwnProperty("delete")&&a.delete()}n&&(t.C=n)})))}}),t.i.attachMultiListener(i,o),i.delete()}function se(t){t=function(t){t:{var e=new qt;for(t=new Y(t);K(t);)switch(t.i){case 10:var n=J(t,new Wt,Gt);Tt(e,1,n);break;case 18:Tt(e,2,n=J(t,new kt,It));break;default:if(!At(e,t))break t}}return e}(t);var e=t.getMesh();if(!e)return t;var n=new Float32Array(e.getVertexBufferList());e.getVertexBufferList=function(){return n};var r=new Uint32Array(e.getIndexBufferList());return e.getIndexBufferList=function(){return r},t}(t=ne.prototype).close=function(){return this.i&&this.i.delete(),Promise.resolve()},t.reset=function(){return Pt(this,(function t(){var e=this;return S(t,(function(t){e.i&&(e.i.reset(),e.m={},e.s={}),t.g=0}))}))},t.setOptions=function(t,e){var n=this;if(e=e||this.g.options){for(var r=[],i=[],o={},a=s(Object.keys(t)),l=a.next();!l.done;o={K:o.K,L:o.L},l=a.next()){var c=l.value;c in this.j&&this.j[c]===t[c]||(this.j[c]=t[c],void 0!==(l=e[c])&&(l.onChange&&(o.K=l.onChange,o.L=t[c],r.push(function(t){return function(){return Pt(n,(function e(){var n=this;return S(e,(function(e){if(1==e.g)return v(e,t.K(t.L),2);!0===e.h&&(n.o=!0),e.g=0}))}))}}(o))),l.graphOptionXref&&(c={valueNumber:1===l.type?t[c]:0,valueBoolean:0===l.type&&t[c],valueString:2===l.type?t[c]:""},l=Object.assign(Object.assign(Object.assign({},{calculatorName:"",calculatorIndex:0}),l.graphOptionXref),c),i.push(l))))}0===r.length&&0===i.length||(this.o=!0,this.A=(void 0===this.A?[]:this.A).concat(i),this.u=(void 0===this.u?[]:this.u).concat(r))}},t.initialize=function(){return Pt(this,(function t(){var e=this;return S(t,(function(t){return 1==t.g?v(t,re(e),2):3!=t.g?v(t,Pt(e,(function t(){var e,n,r,i,o,a,l,c,u=this;return S(t,(function(t){if(1==t.g)return u.g.graph&&u.g.graph.url&&u.P===u.g.graph.url?t.return():(u.o=!0,u.g.graph&&u.g.graph.url?(u.P=u.g.graph.url,v(t,ie(u,u.g.graph.url),3)):void(t.g=2));for(2!=t.g&&(e=t.h,u.i.loadGraph(e)),n=s(Object.keys(u.B)),r=n.next();!r.done;r=n.next())i=r.value,u.i.overrideFile(i,u.B[i]);if(u.B={},u.g.listeners)for(o=s(u.g.listeners),a=o.next();!a.done;a=o.next())l=a.value,ae(u,l);c=u.j,u.j={},u.setOptions(c),t.g=0}))})),3):v(t,function(t){return Pt(t,(function t(){var e,n,r,i,o,a,l=this;return S(t,(function(t){switch(t.g){case 1:if(!l.o)return t.return();if(!l.u){t.g=2;break}e=s(l.u),n=e.next();case 3:if(n.done){t.g=5;break}return v(t,(0,n.value)(),4);case 4:n=e.next(),t.g=3;break;case 5:l.u=void 0;case 2:if(l.A){for(r=new l.h.GraphOptionChangeRequestList,i=s(l.A),o=i.next();!o.done;o=i.next())a=o.value,r.push_back(a);l.i.changeOptions(r),r.delete(),l.A=void 0}l.o=!1,t.g=0}}))}))}(e),0)}))}))},t.overrideFile=function(t,e){this.i?this.i.overrideFile(t,e):this.B[t]=e},t.clearOverriddenFiles=function(){this.B={},this.i&&this.i.clearOverriddenFiles()},t.send=function(t,e){return Pt(this,(function n(){var r,i,o,a,l,c,u,h,d,p=this;return S(n,(function(n){switch(n.g){case 1:return p.g.inputs?(r=1e3*(void 0===e||null===e?performance.now():e),v(n,p.C,2)):n.return();case 2:return v(n,p.initialize(),3);case 3:for(i=new p.h.PacketDataList,o=s(Object.keys(t)),a=o.next();!a.done;a=o.next())if(l=a.value,c=p.g.inputs[l]){t:{var f=p,m=t[l];switch(c.type){case"video":var g=f.m[c.stream];if(g||(g=new Zt(f.h,f.D),f.m[c.stream]=g),0===(f=g).l&&(f.l=f.h.createTexture()),"undefined"!==typeof HTMLVideoElement&&m instanceof HTMLVideoElement){var y=m.videoWidth;g=m.videoHeight}else"undefined"!==typeof HTMLImageElement&&m instanceof HTMLImageElement?(y=m.naturalWidth,g=m.naturalHeight):(y=m.width,g=m.height);g={glName:f.l,width:y,height:g},(y=f.g).canvas.width=g.width,y.canvas.height=g.height,y.activeTexture(y.TEXTURE0),f.h.bindTexture2d(f.l),y.texImage2D(y.TEXTURE_2D,0,y.RGBA,y.RGBA,y.UNSIGNED_BYTE,m),f.h.bindTexture2d(0),f=g;break t;case"detections":for((g=f.m[c.stream])||(g=new Qt(f.h),f.m[c.stream]=g),(f=g).data||(f.data=new f.g.DetectionListData),f.data.reset(m.length),g=0;g<m.length;++g){y=m[g];var b=f.data,x=b.setBoundingBox,_=g,w=y.T,S=new Vt;_t(S,1,w.Z),_t(S,2,w.$),_t(S,3,w.height),_t(S,4,w.width),_t(S,5,w.rotation),_t(S,6,w.X);var T=w=new nt;ot(T,1,gt(S,1)),ot(T,2,gt(S,2)),ot(T,3,gt(S,3)),ot(T,4,gt(S,4)),ot(T,5,gt(S,5));var E=gt(S,6);if(null!=E&&null!=E){X(T.g,48);var M=T.g,C=E;E=0>C;var A=(C=Math.abs(C))>>>0;for(C=Math.floor((C-A)/4294967296),C>>>=0,E&&(C=~C>>>0,4294967295<(A=1+(~A>>>0))&&(A=0,4294967295<++C&&(C=0))),E=j=A,A=C;0<A||127<E;)M.push(127&E|128),E=(E>>>7|A<<25)>>>0,A>>>=7;M.push(E)}if(Ct(S,T),w=it(w),x.call(b,_,w),y.O)for(b=0;b<y.O.length;++b)T=!!(S=y.O[b]).visibility,_=(x=f.data).addNormalizedLandmark,w=g,S=Object.assign(Object.assign({},S),{visibility:T?S.visibility:0}),_t(T=new Ft,1,S.x),_t(T,2,S.y),_t(T,3,S.z),S.visibility&&_t(T,4,S.visibility),ot(M=S=new nt,1,gt(T,1)),ot(M,2,gt(T,2)),ot(M,3,gt(T,3)),ot(M,4,gt(T,4)),ot(M,5,gt(T,5)),Ct(T,M),S=it(S),_.call(x,w,S);if(y.M)for(b=0;b<y.M.length;++b){if(_=(x=f.data).addClassification,w=g,S=y.M[b],_t(T=new Nt,2,S.Y),S.index&&_t(T,1,S.index),S.label&&_t(T,3,S.label),S.displayName&&_t(T,4,S.displayName),M=S=new nt,null!=(A=gt(T,1))&&null!=A)if(X(M.g,8),E=M.g,0<=A)X(E,A);else{for(C=0;9>C;C++)E.push(127&A|128),A>>=7;E.push(1)}ot(M,2,gt(T,2)),null!=(E=gt(T,3))&&(E=P(E),X(M.g,26),X(M.g,E.length),rt(M,M.g.end()),rt(M,E)),null!=(E=gt(T,4))&&(E=P(E),X(M.g,34),X(M.g,E.length),rt(M,M.g.end()),rt(M,E)),Ct(T,M),S=it(S),_.call(x,w,S)}}f=f.data;break t;default:f={}}}switch(u=f,h=c.stream,c.type){case"video":i.pushTexture2d(Object.assign(Object.assign({},u),{stream:h,timestamp:r}));break;case"detections":(d=u).stream=h,d.timestamp=r,i.pushDetectionList(d);break;default:throw Error("Unknown input config type: '"+c.type+"'")}}return p.i.send(i),v(n,p.C,4);case 4:i.delete(),n.g=0}}))}))},t.onResults=function(t,e){this.listeners[e||"$"]=t},M("Solution",ne),M("OptionType",{BOOL:0,NUMBER:1,aa:2,0:"BOOL",1:"NUMBER",2:"STRING"});var le={files:[{url:"face_mesh_solution_packed_assets_loader.js"},{simd:!0,url:"face_mesh_solution_simd_wasm_bin.js"},{simd:!1,url:"face_mesh_solution_wasm_bin.js"}],graph:{url:"face_mesh.binarypb"},listeners:[{wants:["multi_face_geometry","image_transformed","multi_face_landmarks"],outs:{image:"image_transformed",multiFaceGeometry:{type:"proto_list",stream:"multi_face_geometry",transform:function(t){return t.map(se)}},multiFaceLandmarks:{type:"proto_list",stream:"multi_face_landmarks",transform:function(t){return t.map((function(t){return St(zt(t),Ft).map(Kt)}))}}}}],inputs:{image:{type:"video",stream:"input_frames_gpu"}},options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document},enableFaceGeometry:{type:0,graphOptionXref:{calculatorName:"EnableFaceGeometryConstant",calculatorType:"ConstantSidePacketCalculator",fieldName:"bool_value"}},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},maxNumFaces:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorNumFaces",fieldName:"int_value"}},refineLandmarks:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorRefineLandmarks",fieldName:"bool_value"}},minDetectionConfidence:{type:1,graphOptionXref:{calculatorType:"TensorsToDetectionsCalculator",calculatorName:"facelandmarkfrontgpu__facedetectionshortrangegpu__facedetectionshortrangecommon__TensorsToDetectionsCalculator",fieldName:"min_score_thresh"}},minTrackingConfidence:{type:1,graphOptionXref:{calculatorType:"ThresholdingCalculator",calculatorName:"facelandmarkfrontgpu__facelandmarkgpu__ThresholdingCalculator",fieldName:"threshold"}},cameraNear:{type:1,graphOptionXref:{calculatorType:"FaceGeometryEnvGeneratorCalculator",fieldName:"near"}},cameraFar:{type:1,graphOptionXref:{calculatorType:"FaceGeometryEnvGeneratorCalculator",fieldName:"far"}},cameraVerticalFovDegrees:{type:1,graphOptionXref:{calculatorType:"FaceGeometryEnvGeneratorCalculator",fieldName:"vertical_fov_degrees"}}}},ce=[[61,146],[146,91],[91,181],[181,84],[84,17],[17,314],[314,405],[405,321],[321,375],[375,291],[61,185],[185,40],[40,39],[39,37],[37,0],[0,267],[267,269],[269,270],[270,409],[409,291],[78,95],[95,88],[88,178],[178,87],[87,14],[14,317],[317,402],[402,318],[318,324],[324,308],[78,191],[191,80],[80,81],[81,82],[82,13],[13,312],[312,311],[311,310],[310,415],[415,308]],ue=[[263,249],[249,390],[390,373],[373,374],[374,380],[380,381],[381,382],[382,362],[263,466],[466,388],[388,387],[387,386],[386,385],[385,384],[384,398],[398,362]],he=[[276,283],[283,282],[282,295],[295,285],[300,293],[293,334],[334,296],[296,336]],de=[[33,7],[7,163],[163,144],[144,145],[145,153],[153,154],[154,155],[155,133],[33,246],[246,161],[161,160],[160,159],[159,158],[158,157],[157,173],[173,133]],pe=[[46,53],[53,52],[52,65],[65,55],[70,63],[63,105],[105,66],[66,107]],fe=[[10,338],[338,297],[297,332],[332,284],[284,251],[251,389],[389,356],[356,454],[454,323],[323,361],[361,288],[288,397],[397,365],[365,379],[379,378],[378,400],[400,377],[377,152],[152,148],[148,176],[176,149],[149,150],[150,136],[136,172],[172,58],[58,132],[132,93],[93,234],[234,127],[127,162],[162,21],[21,54],[54,103],[103,67],[67,109],[109,10]],me=[].concat(l(ce),l(ue),l(he),l(de),l(pe),l(fe));function ge(t){t=t||{},t=Object.assign(Object.assign({},le),t),this.g=new ne(t)}(t=ge.prototype).close=function(){return this.g.close(),Promise.resolve()},t.onResults=function(t){this.g.onResults(t)},t.initialize=function(){return Pt(this,(function t(){var e=this;return S(t,(function(t){return v(t,e.g.initialize(),0)}))}))},t.reset=function(){this.g.reset()},t.send=function(t){return Pt(this,(function e(){var n=this;return S(e,(function(e){return v(e,n.g.send(t),0)}))}))},t.setOptions=function(t){this.g.setOptions(t)},M("FACE_GEOMETRY",{Layout:{COLUMN_MAJOR:0,ROW_MAJOR:1,0:"COLUMN_MAJOR",1:"ROW_MAJOR"},PrimitiveType:{TRIANGLE:0,0:"TRIANGLE"},VertexType:{VERTEX_PT:0,0:"VERTEX_PT"},DEFAULT_CAMERA_PARAMS:{verticalFovDegrees:63,near:1,far:1e4}}),M("FaceMesh",ge),M("FACEMESH_LIPS",ce),M("FACEMESH_LEFT_EYE",ue),M("FACEMESH_LEFT_EYEBROW",he),M("FACEMESH_LEFT_IRIS",[[474,475],[475,476],[476,477],[477,474]]),M("FACEMESH_RIGHT_EYE",de),M("FACEMESH_RIGHT_EYEBROW",pe),M("FACEMESH_RIGHT_IRIS",[[469,470],[470,471],[471,472],[472,469]]),M("FACEMESH_FACE_OVAL",fe),M("FACEMESH_CONTOURS",me),M("FACEMESH_TESSELATION",[[127,34],[34,139],[139,127],[11,0],[0,37],[37,11],[232,231],[231,120],[120,232],[72,37],[37,39],[39,72],[128,121],[121,47],[47,128],[232,121],[121,128],[128,232],[104,69],[69,67],[67,104],[175,171],[171,148],[148,175],[118,50],[50,101],[101,118],[73,39],[39,40],[40,73],[9,151],[151,108],[108,9],[48,115],[115,131],[131,48],[194,204],[204,211],[211,194],[74,40],[40,185],[185,74],[80,42],[42,183],[183,80],[40,92],[92,186],[186,40],[230,229],[229,118],[118,230],[202,212],[212,214],[214,202],[83,18],[18,17],[17,83],[76,61],[61,146],[146,76],[160,29],[29,30],[30,160],[56,157],[157,173],[173,56],[106,204],[204,194],[194,106],[135,214],[214,192],[192,135],[203,165],[165,98],[98,203],[21,71],[71,68],[68,21],[51,45],[45,4],[4,51],[144,24],[24,23],[23,144],[77,146],[146,91],[91,77],[205,50],[50,187],[187,205],[201,200],[200,18],[18,201],[91,106],[106,182],[182,91],[90,91],[91,181],[181,90],[85,84],[84,17],[17,85],[206,203],[203,36],[36,206],[148,171],[171,140],[140,148],[92,40],[40,39],[39,92],[193,189],[189,244],[244,193],[159,158],[158,28],[28,159],[247,246],[246,161],[161,247],[236,3],[3,196],[196,236],[54,68],[68,104],[104,54],[193,168],[168,8],[8,193],[117,228],[228,31],[31,117],[189,193],[193,55],[55,189],[98,97],[97,99],[99,98],[126,47],[47,100],[100,126],[166,79],[79,218],[218,166],[155,154],[154,26],[26,155],[209,49],[49,131],[131,209],[135,136],[136,150],[150,135],[47,126],[126,217],[217,47],[223,52],[52,53],[53,223],[45,51],[51,134],[134,45],[211,170],[170,140],[140,211],[67,69],[69,108],[108,67],[43,106],[106,91],[91,43],[230,119],[119,120],[120,230],[226,130],[130,247],[247,226],[63,53],[53,52],[52,63],[238,20],[20,242],[242,238],[46,70],[70,156],[156,46],[78,62],[62,96],[96,78],[46,53],[53,63],[63,46],[143,34],[34,227],[227,143],[123,117],[117,111],[111,123],[44,125],[125,19],[19,44],[236,134],[134,51],[51,236],[216,206],[206,205],[205,216],[154,153],[153,22],[22,154],[39,37],[37,167],[167,39],[200,201],[201,208],[208,200],[36,142],[142,100],[100,36],[57,212],[212,202],[202,57],[20,60],[60,99],[99,20],[28,158],[158,157],[157,28],[35,226],[226,113],[113,35],[160,159],[159,27],[27,160],[204,202],[202,210],[210,204],[113,225],[225,46],[46,113],[43,202],[202,204],[204,43],[62,76],[76,77],[77,62],[137,123],[123,116],[116,137],[41,38],[38,72],[72,41],[203,129],[129,142],[142,203],[64,98],[98,240],[240,64],[49,102],[102,64],[64,49],[41,73],[73,74],[74,41],[212,216],[216,207],[207,212],[42,74],[74,184],[184,42],[169,170],[170,211],[211,169],[170,149],[149,176],[176,170],[105,66],[66,69],[69,105],[122,6],[6,168],[168,122],[123,147],[147,187],[187,123],[96,77],[77,90],[90,96],[65,55],[55,107],[107,65],[89,90],[90,180],[180,89],[101,100],[100,120],[120,101],[63,105],[105,104],[104,63],[93,137],[137,227],[227,93],[15,86],[86,85],[85,15],[129,102],[102,49],[49,129],[14,87],[87,86],[86,14],[55,8],[8,9],[9,55],[100,47],[47,121],[121,100],[145,23],[23,22],[22,145],[88,89],[89,179],[179,88],[6,122],[122,196],[196,6],[88,95],[95,96],[96,88],[138,172],[172,136],[136,138],[215,58],[58,172],[172,215],[115,48],[48,219],[219,115],[42,80],[80,81],[81,42],[195,3],[3,51],[51,195],[43,146],[146,61],[61,43],[171,175],[175,199],[199,171],[81,82],[82,38],[38,81],[53,46],[46,225],[225,53],[144,163],[163,110],[110,144],[52,65],[65,66],[66,52],[229,228],[228,117],[117,229],[34,127],[127,234],[234,34],[107,108],[108,69],[69,107],[109,108],[108,151],[151,109],[48,64],[64,235],[235,48],[62,78],[78,191],[191,62],[129,209],[209,126],[126,129],[111,35],[35,143],[143,111],[117,123],[123,50],[50,117],[222,65],[65,52],[52,222],[19,125],[125,141],[141,19],[221,55],[55,65],[65,221],[3,195],[195,197],[197,3],[25,7],[7,33],[33,25],[220,237],[237,44],[44,220],[70,71],[71,139],[139,70],[122,193],[193,245],[245,122],[247,130],[130,33],[33,247],[71,21],[21,162],[162,71],[170,169],[169,150],[150,170],[188,174],[174,196],[196,188],[216,186],[186,92],[92,216],[2,97],[97,167],[167,2],[141,125],[125,241],[241,141],[164,167],[167,37],[37,164],[72,38],[38,12],[12,72],[38,82],[82,13],[13,38],[63,68],[68,71],[71,63],[226,35],[35,111],[111,226],[101,50],[50,205],[205,101],[206,92],[92,165],[165,206],[209,198],[198,217],[217,209],[165,167],[167,97],[97,165],[220,115],[115,218],[218,220],[133,112],[112,243],[243,133],[239,238],[238,241],[241,239],[214,135],[135,169],[169,214],[190,173],[173,133],[133,190],[171,208],[208,32],[32,171],[125,44],[44,237],[237,125],[86,87],[87,178],[178,86],[85,86],[86,179],[179,85],[84,85],[85,180],[180,84],[83,84],[84,181],[181,83],[201,83],[83,182],[182,201],[137,93],[93,132],[132,137],[76,62],[62,183],[183,76],[61,76],[76,184],[184,61],[57,61],[61,185],[185,57],[212,57],[57,186],[186,212],[214,207],[207,187],[187,214],[34,143],[143,156],[156,34],[79,239],[239,237],[237,79],[123,137],[137,177],[177,123],[44,1],[1,4],[4,44],[201,194],[194,32],[32,201],[64,102],[102,129],[129,64],[213,215],[215,138],[138,213],[59,166],[166,219],[219,59],[242,99],[99,97],[97,242],[2,94],[94,141],[141,2],[75,59],[59,235],[235,75],[24,110],[110,228],[228,24],[25,130],[130,226],[226,25],[23,24],[24,229],[229,23],[22,23],[23,230],[230,22],[26,22],[22,231],[231,26],[112,26],[26,232],[232,112],[189,190],[190,243],[243,189],[221,56],[56,190],[190,221],[28,56],[56,221],[221,28],[27,28],[28,222],[222,27],[29,27],[27,223],[223,29],[30,29],[29,224],[224,30],[247,30],[30,225],[225,247],[238,79],[79,20],[20,238],[166,59],[59,75],[75,166],[60,75],[75,240],[240,60],[147,177],[177,215],[215,147],[20,79],[79,166],[166,20],[187,147],[147,213],[213,187],[112,233],[233,244],[244,112],[233,128],[128,245],[245,233],[128,114],[114,188],[188,128],[114,217],[217,174],[174,114],[131,115],[115,220],[220,131],[217,198],[198,236],[236,217],[198,131],[131,134],[134,198],[177,132],[132,58],[58,177],[143,35],[35,124],[124,143],[110,163],[163,7],[7,110],[228,110],[110,25],[25,228],[356,389],[389,368],[368,356],[11,302],[302,267],[267,11],[452,350],[350,349],[349,452],[302,303],[303,269],[269,302],[357,343],[343,277],[277,357],[452,453],[453,357],[357,452],[333,332],[332,297],[297,333],[175,152],[152,377],[377,175],[347,348],[348,330],[330,347],[303,304],[304,270],[270,303],[9,336],[336,337],[337,9],[278,279],[279,360],[360,278],[418,262],[262,431],[431,418],[304,408],[408,409],[409,304],[310,415],[415,407],[407,310],[270,409],[409,410],[410,270],[450,348],[348,347],[347,450],[422,430],[430,434],[434,422],[313,314],[314,17],[17,313],[306,307],[307,375],[375,306],[387,388],[388,260],[260,387],[286,414],[414,398],[398,286],[335,406],[406,418],[418,335],[364,367],[367,416],[416,364],[423,358],[358,327],[327,423],[251,284],[284,298],[298,251],[281,5],[5,4],[4,281],[373,374],[374,253],[253,373],[307,320],[320,321],[321,307],[425,427],[427,411],[411,425],[421,313],[313,18],[18,421],[321,405],[405,406],[406,321],[320,404],[404,405],[405,320],[315,16],[16,17],[17,315],[426,425],[425,266],[266,426],[377,400],[400,369],[369,377],[322,391],[391,269],[269,322],[417,465],[465,464],[464,417],[386,257],[257,258],[258,386],[466,260],[260,388],[388,466],[456,399],[399,419],[419,456],[284,332],[332,333],[333,284],[417,285],[285,8],[8,417],[346,340],[340,261],[261,346],[413,441],[441,285],[285,413],[327,460],[460,328],[328,327],[355,371],[371,329],[329,355],[392,439],[439,438],[438,392],[382,341],[341,256],[256,382],[429,420],[420,360],[360,429],[364,394],[394,379],[379,364],[277,343],[343,437],[437,277],[443,444],[444,283],[283,443],[275,440],[440,363],[363,275],[431,262],[262,369],[369,431],[297,338],[338,337],[337,297],[273,375],[375,321],[321,273],[450,451],[451,349],[349,450],[446,342],[342,467],[467,446],[293,334],[334,282],[282,293],[458,461],[461,462],[462,458],[276,353],[353,383],[383,276],[308,324],[324,325],[325,308],[276,300],[300,293],[293,276],[372,345],[345,447],[447,372],[352,345],[345,340],[340,352],[274,1],[1,19],[19,274],[456,248],[248,281],[281,456],[436,427],[427,425],[425,436],[381,256],[256,252],[252,381],[269,391],[391,393],[393,269],[200,199],[199,428],[428,200],[266,330],[330,329],[329,266],[287,273],[273,422],[422,287],[250,462],[462,328],[328,250],[258,286],[286,384],[384,258],[265,353],[353,342],[342,265],[387,259],[259,257],[257,387],[424,431],[431,430],[430,424],[342,353],[353,276],[276,342],[273,335],[335,424],[424,273],[292,325],[325,307],[307,292],[366,447],[447,345],[345,366],[271,303],[303,302],[302,271],[423,266],[266,371],[371,423],[294,455],[455,460],[460,294],[279,278],[278,294],[294,279],[271,272],[272,304],[304,271],[432,434],[434,427],[427,432],[272,407],[407,408],[408,272],[394,430],[430,431],[431,394],[395,369],[369,400],[400,395],[334,333],[333,299],[299,334],[351,417],[417,168],[168,351],[352,280],[280,411],[411,352],[325,319],[319,320],[320,325],[295,296],[296,336],[336,295],[319,403],[403,404],[404,319],[330,348],[348,349],[349,330],[293,298],[298,333],[333,293],[323,454],[454,447],[447,323],[15,16],[16,315],[315,15],[358,429],[429,279],[279,358],[14,15],[15,316],[316,14],[285,336],[336,9],[9,285],[329,349],[349,350],[350,329],[374,380],[380,252],[252,374],[318,402],[402,403],[403,318],[6,197],[197,419],[419,6],[318,319],[319,325],[325,318],[367,364],[364,365],[365,367],[435,367],[367,397],[397,435],[344,438],[438,439],[439,344],[272,271],[271,311],[311,272],[195,5],[5,281],[281,195],[273,287],[287,291],[291,273],[396,428],[428,199],[199,396],[311,271],[271,268],[268,311],[283,444],[444,445],[445,283],[373,254],[254,339],[339,373],[282,334],[334,296],[296,282],[449,347],[347,346],[346,449],[264,447],[447,454],[454,264],[336,296],[296,299],[299,336],[338,10],[10,151],[151,338],[278,439],[439,455],[455,278],[292,407],[407,415],[415,292],[358,371],[371,355],[355,358],[340,345],[345,372],[372,340],[346,347],[347,280],[280,346],[442,443],[443,282],[282,442],[19,94],[94,370],[370,19],[441,442],[442,295],[295,441],[248,419],[419,197],[197,248],[263,255],[255,359],[359,263],[440,275],[275,274],[274,440],[300,383],[383,368],[368,300],[351,412],[412,465],[465,351],[263,467],[467,466],[466,263],[301,368],[368,389],[389,301],[395,378],[378,379],[379,395],[412,351],[351,419],[419,412],[436,426],[426,322],[322,436],[2,164],[164,393],[393,2],[370,462],[462,461],[461,370],[164,0],[0,267],[267,164],[302,11],[11,12],[12,302],[268,12],[12,13],[13,268],[293,300],[300,301],[301,293],[446,261],[261,340],[340,446],[330,266],[266,425],[425,330],[426,423],[423,391],[391,426],[429,355],[355,437],[437,429],[391,327],[327,326],[326,391],[440,457],[457,438],[438,440],[341,382],[382,362],[362,341],[459,457],[457,461],[461,459],[434,430],[430,394],[394,434],[414,463],[463,362],[362,414],[396,369],[369,262],[262,396],[354,461],[461,457],[457,354],[316,403],[403,402],[402,316],[315,404],[404,403],[403,315],[314,405],[405,404],[404,314],[313,406],[406,405],[405,313],[421,418],[418,406],[406,421],[366,401],[401,361],[361,366],[306,408],[408,407],[407,306],[291,409],[409,408],[408,291],[287,410],[410,409],[409,287],[432,436],[436,410],[410,432],[434,416],[416,411],[411,434],[264,368],[368,383],[383,264],[309,438],[438,457],[457,309],[352,376],[376,401],[401,352],[274,275],[275,4],[4,274],[421,428],[428,262],[262,421],[294,327],[327,358],[358,294],[433,416],[416,367],[367,433],[289,455],[455,439],[439,289],[462,370],[370,326],[326,462],[2,326],[326,370],[370,2],[305,460],[460,455],[455,305],[254,449],[449,448],[448,254],[255,261],[261,446],[446,255],[253,450],[450,449],[449,253],[252,451],[451,450],[450,252],[256,452],[452,451],[451,256],[341,453],[453,452],[452,341],[413,464],[464,463],[463,413],[441,413],[413,414],[414,441],[258,442],[442,441],[441,258],[257,443],[443,442],[442,257],[259,444],[444,443],[443,259],[260,445],[445,444],[444,260],[467,342],[342,445],[445,467],[459,458],[458,250],[250,459],[289,392],[392,290],[290,289],[290,328],[328,460],[460,290],[376,433],[433,435],[435,376],[250,290],[290,392],[392,250],[411,416],[416,433],[433,411],[341,463],[463,464],[464,341],[453,464],[464,465],[465,453],[357,465],[465,412],[412,357],[343,412],[412,399],[399,343],[360,363],[363,440],[440,360],[437,399],[399,456],[456,437],[420,456],[456,363],[363,420],[401,435],[435,288],[288,401],[372,383],[383,353],[353,372],[339,255],[255,249],[249,339],[448,261],[261,255],[255,448],[133,243],[243,190],[190,133],[133,155],[155,112],[112,133],[33,246],[246,247],[247,33],[33,130],[130,25],[25,33],[398,384],[384,286],[286,398],[362,398],[398,414],[414,362],[362,463],[463,341],[341,362],[263,359],[359,467],[467,263],[263,249],[249,255],[255,263],[466,467],[467,260],[260,466],[75,60],[60,166],[166,75],[238,239],[239,79],[79,238],[162,127],[127,139],[139,162],[72,11],[11,37],[37,72],[121,232],[232,120],[120,121],[73,72],[72,39],[39,73],[114,128],[128,47],[47,114],[233,232],[232,128],[128,233],[103,104],[104,67],[67,103],[152,175],[175,148],[148,152],[119,118],[118,101],[101,119],[74,73],[73,40],[40,74],[107,9],[9,108],[108,107],[49,48],[48,131],[131,49],[32,194],[194,211],[211,32],[184,74],[74,185],[185,184],[191,80],[80,183],[183,191],[185,40],[40,186],[186,185],[119,230],[230,118],[118,119],[210,202],[202,214],[214,210],[84,83],[83,17],[17,84],[77,76],[76,146],[146,77],[161,160],[160,30],[30,161],[190,56],[56,173],[173,190],[182,106],[106,194],[194,182],[138,135],[135,192],[192,138],[129,203],[203,98],[98,129],[54,21],[21,68],[68,54],[5,51],[51,4],[4,5],[145,144],[144,23],[23,145],[90,77],[77,91],[91,90],[207,205],[205,187],[187,207],[83,201],[201,18],[18,83],[181,91],[91,182],[182,181],[180,90],[90,181],[181,180],[16,85],[85,17],[17,16],[205,206],[206,36],[36,205],[176,148],[148,140],[140,176],[165,92],[92,39],[39,165],[245,193],[193,244],[244,245],[27,159],[159,28],[28,27],[30,247],[247,161],[161,30],[174,236],[236,196],[196,174],[103,54],[54,104],[104,103],[55,193],[193,8],[8,55],[111,117],[117,31],[31,111],[221,189],[189,55],[55,221],[240,98],[98,99],[99,240],[142,126],[126,100],[100,142],[219,166],[166,218],[218,219],[112,155],[155,26],[26,112],[198,209],[209,131],[131,198],[169,135],[135,150],[150,169],[114,47],[47,217],[217,114],[224,223],[223,53],[53,224],[220,45],[45,134],[134,220],[32,211],[211,140],[140,32],[109,67],[67,108],[108,109],[146,43],[43,91],[91,146],[231,230],[230,120],[120,231],[113,226],[226,247],[247,113],[105,63],[63,52],[52,105],[241,238],[238,242],[242,241],[124,46],[46,156],[156,124],[95,78],[78,96],[96,95],[70,46],[46,63],[63,70],[116,143],[143,227],[227,116],[116,123],[123,111],[111,116],[1,44],[44,19],[19,1],[3,236],[236,51],[51,3],[207,216],[216,205],[205,207],[26,154],[154,22],[22,26],[165,39],[39,167],[167,165],[199,200],[200,208],[208,199],[101,36],[36,100],[100,101],[43,57],[57,202],[202,43],[242,20],[20,99],[99,242],[56,28],[28,157],[157,56],[124,35],[35,113],[113,124],[29,160],[160,27],[27,29],[211,204],[204,210],[210,211],[124,113],[113,46],[46,124],[106,43],[43,204],[204,106],[96,62],[62,77],[77,96],[227,137],[137,116],[116,227],[73,41],[41,72],[72,73],[36,203],[203,142],[142,36],[235,64],[64,240],[240,235],[48,49],[49,64],[64,48],[42,41],[41,74],[74,42],[214,212],[212,207],[207,214],[183,42],[42,184],[184,183],[210,169],[169,211],[211,210],[140,170],[170,176],[176,140],[104,105],[105,69],[69,104],[193,122],[122,168],[168,193],[50,123],[123,187],[187,50],[89,96],[96,90],[90,89],[66,65],[65,107],[107,66],[179,89],[89,180],[180,179],[119,101],[101,120],[120,119],[68,63],[63,104],[104,68],[234,93],[93,227],[227,234],[16,15],[15,85],[85,16],[209,129],[129,49],[49,209],[15,14],[14,86],[86,15],[107,55],[55,9],[9,107],[120,100],[100,121],[121,120],[153,145],[145,22],[22,153],[178,88],[88,179],[179,178],[197,6],[6,196],[196,197],[89,88],[88,96],[96,89],[135,138],[138,136],[136,135],[138,215],[215,172],[172,138],[218,115],[115,219],[219,218],[41,42],[42,81],[81,41],[5,195],[195,51],[51,5],[57,43],[43,61],[61,57],[208,171],[171,199],[199,208],[41,81],[81,38],[38,41],[224,53],[53,225],[225,224],[24,144],[144,110],[110,24],[105,52],[52,66],[66,105],[118,229],[229,117],[117,118],[227,34],[34,234],[234,227],[66,107],[107,69],[69,66],[10,109],[109,151],[151,10],[219,48],[48,235],[235,219],[183,62],[62,191],[191,183],[142,129],[129,126],[126,142],[116,111],[111,143],[143,116],[118,117],[117,50],[50,118],[223,222],[222,52],[52,223],[94,19],[19,141],[141,94],[222,221],[221,65],[65,222],[196,3],[3,197],[197,196],[45,220],[220,44],[44,45],[156,70],[70,139],[139,156],[188,122],[122,245],[245,188],[139,71],[71,162],[162,139],[149,170],[170,150],[150,149],[122,188],[188,196],[196,122],[206,216],[216,92],[92,206],[164,2],[2,167],[167,164],[242,141],[141,241],[241,242],[0,164],[164,37],[37,0],[11,72],[72,12],[12,11],[12,38],[38,13],[13,12],[70,63],[63,71],[71,70],[31,226],[226,111],[111,31],[36,101],[101,205],[205,36],[203,206],[206,165],[165,203],[126,209],[209,217],[217,126],[98,165],[165,97],[97,98],[237,220],[220,218],[218,237],[237,239],[239,241],[241,237],[210,214],[214,169],[169,210],[140,171],[171,32],[32,140],[241,125],[125,237],[237,241],[179,86],[86,178],[178,179],[180,85],[85,179],[179,180],[181,84],[84,180],[180,181],[182,83],[83,181],[181,182],[194,201],[201,182],[182,194],[177,137],[137,132],[132,177],[184,76],[76,183],[183,184],[185,61],[61,184],[184,185],[186,57],[57,185],[185,186],[216,212],[212,186],[186,216],[192,214],[214,187],[187,192],[139,34],[34,156],[156,139],[218,79],[79,237],[237,218],[147,123],[123,177],[177,147],[45,44],[44,4],[4,45],[208,201],[201,32],[32,208],[98,64],[64,129],[129,98],[192,213],[213,138],[138,192],[235,59],[59,219],[219,235],[141,242],[242,97],[97,141],[97,2],[2,141],[141,97],[240,75],[75,235],[235,240],[229,24],[24,228],[228,229],[31,25],[25,226],[226,31],[230,23],[23,229],[229,230],[231,22],[22,230],[230,231],[232,26],[26,231],[231,232],[233,112],[112,232],[232,233],[244,189],[189,243],[243,244],[189,221],[221,190],[190,189],[222,28],[28,221],[221,222],[223,27],[27,222],[222,223],[224,29],[29,223],[223,224],[225,30],[30,224],[224,225],[113,247],[247,225],[225,113],[99,60],[60,240],[240,99],[213,147],[147,215],[215,213],[60,20],[20,166],[166,60],[192,187],[187,213],[213,192],[243,112],[112,244],[244,243],[244,233],[233,245],[245,244],[245,128],[128,188],[188,245],[188,114],[114,174],[174,188],[134,131],[131,220],[220,134],[174,217],[217,236],[236,174],[236,198],[198,134],[134,236],[215,177],[177,58],[58,215],[156,143],[143,124],[124,156],[25,110],[110,7],[7,25],[31,228],[228,25],[25,31],[264,356],[356,368],[368,264],[0,11],[11,267],[267,0],[451,452],[452,349],[349,451],[267,302],[302,269],[269,267],[350,357],[357,277],[277,350],[350,452],[452,357],[357,350],[299,333],[333,297],[297,299],[396,175],[175,377],[377,396],[280,347],[347,330],[330,280],[269,303],[303,270],[270,269],[151,9],[9,337],[337,151],[344,278],[278,360],[360,344],[424,418],[418,431],[431,424],[270,304],[304,409],[409,270],[272,310],[310,407],[407,272],[322,270],[270,410],[410,322],[449,450],[450,347],[347,449],[432,422],[422,434],[434,432],[18,313],[313,17],[17,18],[291,306],[306,375],[375,291],[259,387],[387,260],[260,259],[424,335],[335,418],[418,424],[434,364],[364,416],[416,434],[391,423],[423,327],[327,391],[301,251],[251,298],[298,301],[275,281],[281,4],[4,275],[254,373],[373,253],[253,254],[375,307],[307,321],[321,375],[280,425],[425,411],[411,280],[200,421],[421,18],[18,200],[335,321],[321,406],[406,335],[321,320],[320,405],[405,321],[314,315],[315,17],[17,314],[423,426],[426,266],[266,423],[396,377],[377,369],[369,396],[270,322],[322,269],[269,270],[413,417],[417,464],[464,413],[385,386],[386,258],[258,385],[248,456],[456,419],[419,248],[298,284],[284,333],[333,298],[168,417],[417,8],[8,168],[448,346],[346,261],[261,448],[417,413],[413,285],[285,417],[326,327],[327,328],[328,326],[277,355],[355,329],[329,277],[309,392],[392,438],[438,309],[381,382],[382,256],[256,381],[279,429],[429,360],[360,279],[365,364],[364,379],[379,365],[355,277],[277,437],[437,355],[282,443],[443,283],[283,282],[281,275],[275,363],[363,281],[395,431],[431,369],[369,395],[299,297],[297,337],[337,299],[335,273],[273,321],[321,335],[348,450],[450,349],[349,348],[359,446],[446,467],[467,359],[283,293],[293,282],[282,283],[250,458],[458,462],[462,250],[300,276],[276,383],[383,300],[292,308],[308,325],[325,292],[283,276],[276,293],[293,283],[264,372],[372,447],[447,264],[346,352],[352,340],[340,346],[354,274],[274,19],[19,354],[363,456],[456,281],[281,363],[426,436],[436,425],[425,426],[380,381],[381,252],[252,380],[267,269],[269,393],[393,267],[421,200],[200,428],[428,421],[371,266],[266,329],[329,371],[432,287],[287,422],[422,432],[290,250],[250,328],[328,290],[385,258],[258,384],[384,385],[446,265],[265,342],[342,446],[386,387],[387,257],[257,386],[422,424],[424,430],[430,422],[445,342],[342,276],[276,445],[422,273],[273,424],[424,422],[306,292],[292,307],[307,306],[352,366],[366,345],[345,352],[268,271],[271,302],[302,268],[358,423],[423,371],[371,358],[327,294],[294,460],[460,327],[331,279],[279,294],[294,331],[303,271],[271,304],[304,303],[436,432],[432,427],[427,436],[304,272],[272,408],[408,304],[395,394],[394,431],[431,395],[378,395],[395,400],[400,378],[296,334],[334,299],[299,296],[6,351],[351,168],[168,6],[376,352],[352,411],[411,376],[307,325],[325,320],[320,307],[285,295],[295,336],[336,285],[320,319],[319,404],[404,320],[329,330],[330,349],[349,329],[334,293],[293,333],[333,334],[366,323],[323,447],[447,366],[316,15],[15,315],[315,316],[331,358],[358,279],[279,331],[317,14],[14,316],[316,317],[8,285],[285,9],[9,8],[277,329],[329,350],[350,277],[253,374],[374,252],[252,253],[319,318],[318,403],[403,319],[351,6],[6,419],[419,351],[324,318],[318,325],[325,324],[397,367],[367,365],[365,397],[288,435],[435,397],[397,288],[278,344],[344,439],[439,278],[310,272],[272,311],[311,310],[248,195],[195,281],[281,248],[375,273],[273,291],[291,375],[175,396],[396,199],[199,175],[312,311],[311,268],[268,312],[276,283],[283,445],[445,276],[390,373],[373,339],[339,390],[295,282],[282,296],[296,295],[448,449],[449,346],[346,448],[356,264],[264,454],[454,356],[337,336],[336,299],[299,337],[337,338],[338,151],[151,337],[294,278],[278,455],[455,294],[308,292],[292,415],[415,308],[429,358],[358,355],[355,429],[265,340],[340,372],[372,265],[352,346],[346,280],[280,352],[295,442],[442,282],[282,295],[354,19],[19,370],[370,354],[285,441],[441,295],[295,285],[195,248],[248,197],[197,195],[457,440],[440,274],[274,457],[301,300],[300,368],[368,301],[417,351],[351,465],[465,417],[251,301],[301,389],[389,251],[394,395],[395,379],[379,394],[399,412],[412,419],[419,399],[410,436],[436,322],[322,410],[326,2],[2,393],[393,326],[354,370],[370,461],[461,354],[393,164],[164,267],[267,393],[268,302],[302,12],[12,268],[312,268],[268,13],[13,312],[298,293],[293,301],[301,298],[265,446],[446,340],[340,265],[280,330],[330,425],[425,280],[322,426],[426,391],[391,322],[420,429],[429,437],[437,420],[393,391],[391,326],[326,393],[344,440],[440,438],[438,344],[458,459],[459,461],[461,458],[364,434],[434,394],[394,364],[428,396],[396,262],[262,428],[274,354],[354,457],[457,274],[317,316],[316,402],[402,317],[316,315],[315,403],[403,316],[315,314],[314,404],[404,315],[314,313],[313,405],[405,314],[313,421],[421,406],[406,313],[323,366],[366,361],[361,323],[292,306],[306,407],[407,292],[306,291],[291,408],[408,306],[291,287],[287,409],[409,291],[287,432],[432,410],[410,287],[427,434],[434,411],[411,427],[372,264],[264,383],[383,372],[459,309],[309,457],[457,459],[366,352],[352,401],[401,366],[1,274],[274,4],[4,1],[418,421],[421,262],[262,418],[331,294],[294,358],[358,331],[435,433],[433,367],[367,435],[392,289],[289,439],[439,392],[328,462],[462,326],[326,328],[94,2],[2,370],[370,94],[289,305],[305,455],[455,289],[339,254],[254,448],[448,339],[359,255],[255,446],[446,359],[254,253],[253,449],[449,254],[253,252],[252,450],[450,253],[252,256],[256,451],[451,252],[256,341],[341,452],[452,256],[414,413],[413,463],[463,414],[286,441],[441,414],[414,286],[286,258],[258,441],[441,286],[258,257],[257,442],[442,258],[257,259],[259,443],[443,257],[259,260],[260,444],[444,259],[260,467],[467,445],[445,260],[309,459],[459,250],[250,309],[305,289],[289,290],[290,305],[305,290],[290,460],[460,305],[401,376],[376,435],[435,401],[309,250],[250,392],[392,309],[376,411],[411,433],[433,376],[453,341],[341,464],[464,453],[357,453],[453,465],[465,357],[343,357],[357,412],[412,343],[437,343],[343,399],[399,437],[344,360],[360,440],[440,344],[420,437],[437,456],[456,420],[360,420],[420,363],[363,360],[361,401],[401,288],[288,361],[265,372],[372,353],[353,265],[390,339],[339,249],[249,390],[339,448],[448,255],[255,339]]),M("matrixDataToMatrix",(function(t){for(var e=t.getCols(),n=t.getRows(),r=t.getPackedDataList(),i=[],o=0;o<n;o++)i.push(Array(e));for(o=0;o<n;o++)for(var a=0;a<e;a++){var s=1===t.getLayout()?o*e+a:a*n+o;i[o][a]=r[s]}return i})),M("VERSION","0.4.1633559619")}).call(this)},768:(t,e,n)=>{"use strict";var r=n(989);function i(){this.argTypes=[],this.shimArgs=[],this.arrayArgs=[],this.arrayBlockIndices=[],this.scalarArgs=[],this.offsetArgs=[],this.offsetArgIndex=[],this.indexArgs=[],this.shapeArgs=[],this.funcName="",this.pre=null,this.body=null,this.post=null,this.debug=!1}t.exports=function(t){var e=new i;e.pre=t.pre,e.body=t.body,e.post=t.post;var n=t.args.slice(0);e.argTypes=n;for(var o=0;o<n.length;++o){var a=n[o];if("array"===a||"object"===typeof a&&a.blockIndices){if(e.argTypes[o]="array",e.arrayArgs.push(o),e.arrayBlockIndices.push(a.blockIndices?a.blockIndices:0),e.shimArgs.push("array"+o),o<e.pre.args.length&&e.pre.args[o].count>0)throw new Error("cwise: pre() block may not reference array args");if(o<e.post.args.length&&e.post.args[o].count>0)throw new Error("cwise: post() block may not reference array args")}else if("scalar"===a)e.scalarArgs.push(o),e.shimArgs.push("scalar"+o);else if("index"===a){if(e.indexArgs.push(o),o<e.pre.args.length&&e.pre.args[o].count>0)throw new Error("cwise: pre() block may not reference array index");if(o<e.body.args.length&&e.body.args[o].lvalue)throw new Error("cwise: body() block may not write to array index");if(o<e.post.args.length&&e.post.args[o].count>0)throw new Error("cwise: post() block may not reference array index")}else if("shape"===a){if(e.shapeArgs.push(o),o<e.pre.args.length&&e.pre.args[o].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(o<e.body.args.length&&e.body.args[o].lvalue)throw new Error("cwise: body() block may not write to array shape");if(o<e.post.args.length&&e.post.args[o].lvalue)throw new Error("cwise: post() block may not write to array shape")}else{if("object"!==typeof a||!a.offset)throw new Error("cwise: Unknown argument type "+n[o]);e.argTypes[o]="offset",e.offsetArgs.push({array:a.array,offset:a.offset}),e.offsetArgIndex.push(o)}}if(e.arrayArgs.length<=0)throw new Error("cwise: No array arguments specified");if(e.pre.args.length>n.length)throw new Error("cwise: Too many arguments in pre() block");if(e.body.args.length>n.length)throw new Error("cwise: Too many arguments in body() block");if(e.post.args.length>n.length)throw new Error("cwise: Too many arguments in post() block");return e.debug=!!t.printCode||!!t.debug,e.funcName=t.funcName||"cwise",e.blockSize=t.blockSize||64,r(e)}},800:(t,e,n)=>{"use strict";var r=n(68);function i(t,e,n){var r,i,o=t.length,a=e.arrayArgs.length,s=e.indexArgs.length>0,l=[],c=[],u=0,h=0;for(r=0;r<o;++r)c.push(["i",r,"=0"].join(""));for(i=0;i<a;++i)for(r=0;r<o;++r)h=u,u=t[r],0===r?c.push(["d",i,"s",r,"=t",i,"p",u].join("")):c.push(["d",i,"s",r,"=(t",i,"p",u,"-s",h,"*t",i,"p",h,")"].join(""));for(c.length>0&&l.push("var "+c.join(",")),r=o-1;r>=0;--r)u=t[r],l.push(["for(i",r,"=0;i",r,"<s",u,";++i",r,"){"].join(""));for(l.push(n),r=0;r<o;++r){for(h=u,u=t[r],i=0;i<a;++i)l.push(["p",i,"+=d",i,"s",r].join(""));s&&(r>0&&l.push(["index[",h,"]-=s",h].join("")),l.push(["++index[",u,"]"].join(""))),l.push("}")}return l.join("\n")}function o(t,e,n){for(var r=t.body,i=[],o=[],a=0;a<t.args.length;++a){var s=t.args[a];if(!(s.count<=0)){var l=new RegExp(s.name,"g"),c="",u=e.arrayArgs.indexOf(a);switch(e.argTypes[a]){case"offset":var h=e.offsetArgIndex.indexOf(a);u=e.offsetArgs[h].array,c="+q"+h;case"array":c="p"+u+c;var d="l"+a,p="a"+u;if(0===e.arrayBlockIndices[u])1===s.count?"generic"===n[u]?s.lvalue?(i.push(["var ",d,"=",p,".get(",c,")"].join("")),r=r.replace(l,d),o.push([p,".set(",c,",",d,")"].join(""))):r=r.replace(l,[p,".get(",c,")"].join("")):r=r.replace(l,[p,"[",c,"]"].join("")):"generic"===n[u]?(i.push(["var ",d,"=",p,".get(",c,")"].join("")),r=r.replace(l,d),s.lvalue&&o.push([p,".set(",c,",",d,")"].join(""))):(i.push(["var ",d,"=",p,"[",c,"]"].join("")),r=r.replace(l,d),s.lvalue&&o.push([p,"[",c,"]=",d].join("")));else{for(var f=[s.name],m=[c],g=0;g<Math.abs(e.arrayBlockIndices[u]);g++)f.push("\\s*\\[([^\\]]+)\\]"),m.push("$"+(g+1)+"*t"+u+"b"+g);if(l=new RegExp(f.join(""),"g"),c=m.join("+"),"generic"===n[u])throw new Error("cwise: Generic arrays not supported in combination with blocks!");r=r.replace(l,[p,"[",c,"]"].join(""))}break;case"scalar":r=r.replace(l,"Y"+e.scalarArgs.indexOf(a));break;case"index":r=r.replace(l,"index");break;case"shape":r=r.replace(l,"shape")}}}return[i.join("\n"),r,o.join("\n")].join("\n").trim()}function a(t){for(var e=new Array(t.length),n=!0,r=0;r<t.length;++r){var i=t[r],o=i.match(/\d+/);o=o?o[0]:"",0===i.charAt(0)?e[r]="u"+i.charAt(1)+o:e[r]=i.charAt(0)+o,r>0&&(n=n&&e[r]===e[r-1])}return n?e[0]:e.join("")}t.exports=function(t,e){for(var n=e[1].length-Math.abs(t.arrayBlockIndices[0])|0,s=new Array(t.arrayArgs.length),l=new Array(t.arrayArgs.length),c=0;c<t.arrayArgs.length;++c)l[c]=e[2*c],s[c]=e[2*c+1];var u=[],h=[],d=[],p=[],f=[];for(c=0;c<t.arrayArgs.length;++c){t.arrayBlockIndices[c]<0?(d.push(0),p.push(n),u.push(n),h.push(n+t.arrayBlockIndices[c])):(d.push(t.arrayBlockIndices[c]),p.push(t.arrayBlockIndices[c]+n),u.push(0),h.push(t.arrayBlockIndices[c]));for(var m=[],g=0;g<s[c].length;g++)d[c]<=s[c][g]&&s[c][g]<p[c]&&m.push(s[c][g]-d[c]);f.push(m)}var y=["SS"],v=["'use strict'"],b=[];for(g=0;g<n;++g)b.push(["s",g,"=SS[",g,"]"].join(""));for(c=0;c<t.arrayArgs.length;++c){y.push("a"+c),y.push("t"+c),y.push("p"+c);for(g=0;g<n;++g)b.push(["t",c,"p",g,"=t",c,"[",d[c]+g,"]"].join(""));for(g=0;g<Math.abs(t.arrayBlockIndices[c]);++g)b.push(["t",c,"b",g,"=t",c,"[",u[c]+g,"]"].join(""))}for(c=0;c<t.scalarArgs.length;++c)y.push("Y"+c);if(t.shapeArgs.length>0&&b.push("shape=SS.slice(0)"),t.indexArgs.length>0){var x=new Array(n);for(c=0;c<n;++c)x[c]="0";b.push(["index=[",x.join(","),"]"].join(""))}for(c=0;c<t.offsetArgs.length;++c){var _=t.offsetArgs[c],w=[];for(g=0;g<_.offset.length;++g)0!==_.offset[g]&&(1===_.offset[g]?w.push(["t",_.array,"p",g].join("")):w.push([_.offset[g],"*t",_.array,"p",g].join("")));0===w.length?b.push("q"+c+"=0"):b.push(["q",c,"=",w.join("+")].join(""))}var S=r([].concat(t.pre.thisVars).concat(t.body.thisVars).concat(t.post.thisVars));for((b=b.concat(S)).length>0&&v.push("var "+b.join(",")),c=0;c<t.arrayArgs.length;++c)v.push("p"+c+"|=0");t.pre.body.length>3&&v.push(o(t.pre,t,l));var T=o(t.body,t,l),E=function(t){for(var e=0,n=t[0].length;e<n;){for(var r=1;r<t.length;++r)if(t[r][e]!==t[0][e])return e;++e}return e}(f);E<n?v.push(function(t,e,n,r){for(var o=e.length,a=n.arrayArgs.length,s=n.blockSize,l=n.indexArgs.length>0,c=[],u=0;u<a;++u)c.push(["var offset",u,"=p",u].join(""));for(u=t;u<o;++u)c.push(["for(var j"+u+"=SS[",e[u],"]|0;j",u,">0;){"].join("")),c.push(["if(j",u,"<",s,"){"].join("")),c.push(["s",e[u],"=j",u].join("")),c.push(["j",u,"=0"].join("")),c.push(["}else{s",e[u],"=",s].join("")),c.push(["j",u,"-=",s,"}"].join("")),l&&c.push(["index[",e[u],"]=j",u].join(""));for(u=0;u<a;++u){for(var h=["offset"+u],d=t;d<o;++d)h.push(["j",d,"*t",u,"p",e[d]].join(""));c.push(["p",u,"=(",h.join("+"),")"].join(""))}for(c.push(i(e,n,r)),u=t;u<o;++u)c.push("}");return c.join("\n")}(E,f[0],t,T)):v.push(i(f[0],t,T)),t.post.body.length>3&&v.push(o(t.post,t,l)),t.debug&&console.log("-----Generated cwise routine for ",e,":\n"+v.join("\n")+"\n----------");var M=[t.funcName||"unnamed","_cwise_loop_",s[0].join("s"),"m",E,a(l)].join("");return new Function(["function ",M,"(",y.join(","),"){",v.join("\n"),"} return ",M].join(""))()}},989:(t,e,n)=>{"use strict";var r=n(800);t.exports=function(t){var e=["'use strict'","var CACHED={}"],n=[],i=t.funcName+"_cwise_thunk";e.push(["return function ",i,"(",t.shimArgs.join(","),"){"].join(""));for(var o=[],a=[],s=[["array",t.arrayArgs[0],".shape.slice(",Math.max(0,t.arrayBlockIndices[0]),t.arrayBlockIndices[0]<0?","+t.arrayBlockIndices[0]+")":")"].join("")],l=[],c=[],u=0;u<t.arrayArgs.length;++u){var h=t.arrayArgs[u];n.push(["t",h,"=array",h,".dtype,","r",h,"=array",h,".order"].join("")),o.push("t"+h),o.push("r"+h),a.push("t"+h),a.push("r"+h+".join()"),s.push("array"+h+".data"),s.push("array"+h+".stride"),s.push("array"+h+".offset|0"),u>0&&(l.push("array"+t.arrayArgs[0]+".shape.length===array"+h+".shape.length+"+(Math.abs(t.arrayBlockIndices[0])-Math.abs(t.arrayBlockIndices[u]))),c.push("array"+t.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,t.arrayBlockIndices[0])+"]===array"+h+".shape[shapeIndex+"+Math.max(0,t.arrayBlockIndices[u])+"]"))}for(t.arrayArgs.length>1&&(e.push("if (!("+l.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')"),e.push("for(var shapeIndex=array"+t.arrayArgs[0]+".shape.length-"+Math.abs(t.arrayBlockIndices[0])+"; shapeIndex--\x3e0;) {"),e.push("if (!("+c.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')"),e.push("}")),u=0;u<t.scalarArgs.length;++u)s.push("scalar"+t.scalarArgs[u]);return n.push(["type=[",a.join(","),"].join()"].join("")),n.push("proc=CACHED[type]"),e.push("var "+n.join(",")),e.push(["if(!proc){","CACHED[type]=proc=compile([",o.join(","),"])}","return proc(",s.join(","),")}"].join("")),t.debug&&console.log("-----Generated thunk:\n"+e.join("\n")+"\n----------"),new Function("compile",e.join("\n"))(r.bind(void 0,t))}},695:t=>{function e(t,e,n){var r,i,o,a,s;function l(){var c=Date.now()-a;c<e&&c>=0?r=setTimeout(l,e-c):(r=null,n||(s=t.apply(o,i),o=i=null))}null==e&&(e=100);var c=function(){o=this,i=arguments,a=Date.now();var c=n&&!r;return r||(r=setTimeout(l,e)),c&&(s=t.apply(o,i),o=i=null),s};return c.clear=function(){r&&(clearTimeout(r),r=null)},c.flush=function(){r&&(s=t.apply(o,i),o=i=null,clearTimeout(r),r=null)},c}e.debounce=e,t.exports=e},540:t=>{"use strict";t.exports=function(t){for(var e=new Array(t),n=0;n<t;++n)e[n]=n;return e}},837:t=>{function e(t){return!!t.constructor&&"function"===typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}t.exports=function(t){return null!=t&&(e(t)||function(t){return"function"===typeof t.readFloatLE&&"function"===typeof t.slice&&e(t.slice(0,0))}(t)||!!t._isBuffer)}},353:t=>{t.exports=n;var e=null;try{e=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(E){}function n(t,e,n){this.low=0|t,this.high=0|e,this.unsigned=!!n}function r(t){return!0===(t&&t.__isLong__)}n.prototype.__isLong__,Object.defineProperty(n.prototype,"__isLong__",{value:!0}),n.isLong=r;var i={},o={};function a(t,e){var n,r,a;return e?(a=0<=(t>>>=0)&&t<256)&&(r=o[t])?r:(n=l(t,(0|t)<0?-1:0,!0),a&&(o[t]=n),n):(a=-128<=(t|=0)&&t<128)&&(r=i[t])?r:(n=l(t,t<0?-1:0,!1),a&&(i[t]=n),n)}function s(t,e){if(isNaN(t))return e?y:g;if(e){if(t<0)return y;if(t>=p)return w}else{if(t<=-f)return S;if(t+1>=f)return _}return t<0?s(-t,e).neg():l(t%d|0,t/d|0,e)}function l(t,e,r){return new n(t,e,r)}n.fromInt=a,n.fromNumber=s,n.fromBits=l;var c=Math.pow;function u(t,e,n){if(0===t.length)throw Error("empty string");if("NaN"===t||"Infinity"===t||"+Infinity"===t||"-Infinity"===t)return g;if("number"===typeof e?(n=e,e=!1):e=!!e,(n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=t.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return u(t.substring(1),e,n).neg();for(var i=s(c(n,8)),o=g,a=0;a<t.length;a+=8){var l=Math.min(8,t.length-a),h=parseInt(t.substring(a,a+l),n);if(l<8){var d=s(c(n,l));o=o.mul(d).add(s(h))}else o=(o=o.mul(i)).add(s(h))}return o.unsigned=e,o}function h(t,e){return"number"===typeof t?s(t,e):"string"===typeof t?u(t,e):l(t.low,t.high,"boolean"===typeof e?e:t.unsigned)}n.fromString=u,n.fromValue=h;var d=4294967296,p=d*d,f=p/2,m=a(1<<24),g=a(0);n.ZERO=g;var y=a(0,!0);n.UZERO=y;var v=a(1);n.ONE=v;var b=a(1,!0);n.UONE=b;var x=a(-1);n.NEG_ONE=x;var _=l(-1,2147483647,!1);n.MAX_VALUE=_;var w=l(-1,-1,!0);n.MAX_UNSIGNED_VALUE=w;var S=l(0,-2147483648,!1);n.MIN_VALUE=S;var T=n.prototype;T.toInt=function(){return this.unsigned?this.low>>>0:this.low},T.toNumber=function(){return this.unsigned?(this.high>>>0)*d+(this.low>>>0):this.high*d+(this.low>>>0)},T.toString=function(t){if((t=t||10)<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(S)){var e=s(t),n=this.div(e),r=n.mul(e).sub(this);return n.toString(t)+r.toInt().toString(t)}return"-"+this.neg().toString(t)}for(var i=s(c(t,6),this.unsigned),o=this,a="";;){var l=o.div(i),u=(o.sub(l.mul(i)).toInt()>>>0).toString(t);if((o=l).isZero())return u+a;for(;u.length<6;)u="0"+u;a=""+u+a}},T.getHighBits=function(){return this.high},T.getHighBitsUnsigned=function(){return this.high>>>0},T.getLowBits=function(){return this.low},T.getLowBitsUnsigned=function(){return this.low>>>0},T.getNumBitsAbs=function(){if(this.isNegative())return this.eq(S)?64:this.neg().getNumBitsAbs();for(var t=0!=this.high?this.high:this.low,e=31;e>0&&0==(t&1<<e);e--);return 0!=this.high?e+33:e+1},T.isZero=function(){return 0===this.high&&0===this.low},T.eqz=T.isZero,T.isNegative=function(){return!this.unsigned&&this.high<0},T.isPositive=function(){return this.unsigned||this.high>=0},T.isOdd=function(){return 1===(1&this.low)},T.isEven=function(){return 0===(1&this.low)},T.equals=function(t){return r(t)||(t=h(t)),(this.unsigned===t.unsigned||this.high>>>31!==1||t.high>>>31!==1)&&(this.high===t.high&&this.low===t.low)},T.eq=T.equals,T.notEquals=function(t){return!this.eq(t)},T.neq=T.notEquals,T.ne=T.notEquals,T.lessThan=function(t){return this.comp(t)<0},T.lt=T.lessThan,T.lessThanOrEqual=function(t){return this.comp(t)<=0},T.lte=T.lessThanOrEqual,T.le=T.lessThanOrEqual,T.greaterThan=function(t){return this.comp(t)>0},T.gt=T.greaterThan,T.greaterThanOrEqual=function(t){return this.comp(t)>=0},T.gte=T.greaterThanOrEqual,T.ge=T.greaterThanOrEqual,T.compare=function(t){if(r(t)||(t=h(t)),this.eq(t))return 0;var e=this.isNegative(),n=t.isNegative();return e&&!n?-1:!e&&n?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},T.comp=T.compare,T.negate=function(){return!this.unsigned&&this.eq(S)?S:this.not().add(v)},T.neg=T.negate,T.add=function(t){r(t)||(t=h(t));var e=this.high>>>16,n=65535&this.high,i=this.low>>>16,o=65535&this.low,a=t.high>>>16,s=65535&t.high,c=t.low>>>16,u=0,d=0,p=0,f=0;return p+=(f+=o+(65535&t.low))>>>16,d+=(p+=i+c)>>>16,u+=(d+=n+s)>>>16,u+=e+a,l((p&=65535)<<16|(f&=65535),(u&=65535)<<16|(d&=65535),this.unsigned)},T.subtract=function(t){return r(t)||(t=h(t)),this.add(t.neg())},T.sub=T.subtract,T.multiply=function(t){if(this.isZero())return g;if(r(t)||(t=h(t)),e)return l(e.mul(this.low,this.high,t.low,t.high),e.get_high(),this.unsigned);if(t.isZero())return g;if(this.eq(S))return t.isOdd()?S:g;if(t.eq(S))return this.isOdd()?S:g;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(m)&&t.lt(m))return s(this.toNumber()*t.toNumber(),this.unsigned);var n=this.high>>>16,i=65535&this.high,o=this.low>>>16,a=65535&this.low,c=t.high>>>16,u=65535&t.high,d=t.low>>>16,p=65535&t.low,f=0,y=0,v=0,b=0;return v+=(b+=a*p)>>>16,y+=(v+=o*p)>>>16,v&=65535,y+=(v+=a*d)>>>16,f+=(y+=i*p)>>>16,y&=65535,f+=(y+=o*d)>>>16,y&=65535,f+=(y+=a*u)>>>16,f+=n*p+i*d+o*u+a*c,l((v&=65535)<<16|(b&=65535),(f&=65535)<<16|(y&=65535),this.unsigned)},T.mul=T.multiply,T.divide=function(t){if(r(t)||(t=h(t)),t.isZero())throw Error("division by zero");var n,i,o;if(e)return this.unsigned||-2147483648!==this.high||-1!==t.low||-1!==t.high?l((this.unsigned?e.div_u:e.div_s)(this.low,this.high,t.low,t.high),e.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?y:g;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return y;if(t.gt(this.shru(1)))return b;o=y}else{if(this.eq(S))return t.eq(v)||t.eq(x)?S:t.eq(S)?v:(n=this.shr(1).div(t).shl(1)).eq(g)?t.isNegative()?v:x:(i=this.sub(t.mul(n)),o=n.add(i.div(t)));if(t.eq(S))return this.unsigned?y:g;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();o=g}for(i=this;i.gte(t);){n=Math.max(1,Math.floor(i.toNumber()/t.toNumber()));for(var a=Math.ceil(Math.log(n)/Math.LN2),u=a<=48?1:c(2,a-48),d=s(n),p=d.mul(t);p.isNegative()||p.gt(i);)p=(d=s(n-=u,this.unsigned)).mul(t);d.isZero()&&(d=v),o=o.add(d),i=i.sub(p)}return o},T.div=T.divide,T.modulo=function(t){return r(t)||(t=h(t)),e?l((this.unsigned?e.rem_u:e.rem_s)(this.low,this.high,t.low,t.high),e.get_high(),this.unsigned):this.sub(this.div(t).mul(t))},T.mod=T.modulo,T.rem=T.modulo,T.not=function(){return l(~this.low,~this.high,this.unsigned)},T.and=function(t){return r(t)||(t=h(t)),l(this.low&t.low,this.high&t.high,this.unsigned)},T.or=function(t){return r(t)||(t=h(t)),l(this.low|t.low,this.high|t.high,this.unsigned)},T.xor=function(t){return r(t)||(t=h(t)),l(this.low^t.low,this.high^t.high,this.unsigned)},T.shiftLeft=function(t){return r(t)&&(t=t.toInt()),0===(t&=63)?this:t<32?l(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):l(0,this.low<<t-32,this.unsigned)},T.shl=T.shiftLeft,T.shiftRight=function(t){return r(t)&&(t=t.toInt()),0===(t&=63)?this:t<32?l(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):l(this.high>>t-32,this.high>=0?0:-1,this.unsigned)},T.shr=T.shiftRight,T.shiftRightUnsigned=function(t){if(r(t)&&(t=t.toInt()),0===(t&=63))return this;var e=this.high;return t<32?l(this.low>>>t|e<<32-t,e>>>t,this.unsigned):l(32===t?e:e>>>t-32,0,this.unsigned)},T.shru=T.shiftRightUnsigned,T.shr_u=T.shiftRightUnsigned,T.toSigned=function(){return this.unsigned?l(this.low,this.high,!1):this},T.toUnsigned=function(){return this.unsigned?this:l(this.low,this.high,!0)},T.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},T.toBytesLE=function(){var t=this.high,e=this.low;return[255&e,e>>>8&255,e>>>16&255,e>>>24,255&t,t>>>8&255,t>>>16&255,t>>>24]},T.toBytesBE=function(){var t=this.high,e=this.low;return[t>>>24,t>>>16&255,t>>>8&255,255&t,e>>>24,e>>>16&255,e>>>8&255,255&e]},n.fromBytes=function(t,e,r){return r?n.fromBytesLE(t,e):n.fromBytesBE(t,e)},n.fromBytesLE=function(t,e){return new n(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,e)},n.fromBytesBE=function(t,e){return new n(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],e)}},676:(t,e,n)=>{"use strict";var r=n(768),i={body:"",args:[],thisVars:[],localVars:[]};function o(t){if(!t)return i;for(var e=0;e<t.args.length;++e){var n=t.args[e];t.args[e]=0===e?{name:n,lvalue:!0,rvalue:!!t.rvalue,count:t.count||1}:{name:n,lvalue:!1,rvalue:!0,count:1}}return t.thisVars||(t.thisVars=[]),t.localVars||(t.localVars=[]),t}function a(t){for(var e=[],n=0;n<t.args.length;++n)e.push("a"+n);return new Function("P",["return function ",t.funcName,"_ndarrayops(",e.join(","),") {P(",e.join(","),");return a0}"].join(""))(function(t){return r({args:t.args,pre:o(t.pre),body:o(t.body),post:o(t.proc),funcName:t.funcName})}(t))}var s={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};!function(){for(var t in s){var n=s[t];e[t]=a({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+n+"c"},funcName:t}),e[t+"eq"]=a({args:["array","array"],body:{args:["a","b"],body:"a"+n+"=b"},rvalue:!0,funcName:t+"eq"}),e[t+"s"]=a({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+n+"s"},funcName:t+"s"}),e[t+"seq"]=a({args:["array","scalar"],body:{args:["a","s"],body:"a"+n+"=s"},rvalue:!0,funcName:t+"seq"})}}();var l={not:"!",bnot:"~",neg:"-",recip:"1.0/"};!function(){for(var t in l){var n=l[t];e[t]=a({args:["array","array"],body:{args:["a","b"],body:"a="+n+"b"},funcName:t}),e[t+"eq"]=a({args:["array"],body:{args:["a"],body:"a="+n+"a"},rvalue:!0,count:2,funcName:t+"eq"})}}();var c={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};!function(){for(var t in c){var n=c[t];e[t]=a({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+n+"c"},funcName:t}),e[t+"s"]=a({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+n+"s"},funcName:t+"s"}),e[t+"eq"]=a({args:["array","array"],body:{args:["a","b"],body:"a=a"+n+"b"},rvalue:!0,count:2,funcName:t+"eq"}),e[t+"seq"]=a({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+n+"s"},rvalue:!0,count:2,funcName:t+"seq"})}}();var u=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"];!function(){for(var t=0;t<u.length;++t){var n=u[t];e[n]=a({args:["array","array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:n}),e[n+"eq"]=a({args:["array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:n+"eq"})}}();var h=["max","min","atan2","pow"];!function(){for(var t=0;t<h.length;++t){var n=h[t];e[n]=a({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:n}),e[n+"s"]=a({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:n+"s"}),e[n+"eq"]=a({args:["array","array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:n+"eq"}),e[n+"seq"]=a({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:n+"seq"})}}();var d=["atan2","pow"];!function(){for(var t=0;t<d.length;++t){var n=d[t];e[n+"op"]=a({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:n+"op"}),e[n+"ops"]=a({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:n+"ops"}),e[n+"opeq"]=a({args:["array","array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:n+"opeq"}),e[n+"opseq"]=a({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:n+"opseq"})}}(),e.any=r({args:["array"],pre:i,body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"}),e.all=r({args:["array"],pre:i,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"}),e.sum=r({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"}),e.prod=r({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"}),e.norm2squared=r({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"}),e.norm2=r({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"}),e.norminf=r({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"}),e.norm1=r({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"}),e.sup=r({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),e.inf=r({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),e.argmin=r({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),e.argmax=r({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),e.random=a({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"}),e.assign=a({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"}),e.assigns=a({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"}),e.equals=r({args:["array","array"],pre:i,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1},{name:"y",lvalue:!1,rvalue:!0,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"})},516:(t,e,n)=>{var r=n(540),i=n(837),o="undefined"!==typeof Float64Array;function a(t,e){return t[0]-e[0]}function s(){var t,e=this.stride,n=new Array(e.length);for(t=0;t<n.length;++t)n[t]=[Math.abs(e[t]),t];n.sort(a);var r=new Array(n.length);for(t=0;t<r.length;++t)r[t]=n[t][1];return r}function l(t,e){var n=["View",e,"d",t].join("");e<0&&(n="View_Nil"+t);var i="generic"===t;if(-1===e){var o="function "+n+"(a){this.data=a;};var proto="+n+".prototype;proto.dtype='"+t+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+n+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+n+"(a){return new "+n+"(a);}";return new Function(o)()}if(0===e){o="function "+n+"(a,d) {this.data = a;this.offset = d};var proto="+n+".prototype;proto.dtype='"+t+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+n+"_copy() {return new "+n+"(this.data,this.offset)};proto.pick=function "+n+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+n+"_get(){return "+(i?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+n+"_set(v){return "+(i?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+n+"(a,b,c,d){return new "+n+"(a,d)}";return new Function("TrivialArray",o)(c[t][0])}o=["'use strict'"];var a=r(e),l=a.map((function(t){return"i"+t})),u="this.offset+"+a.map((function(t){return"this.stride["+t+"]*i"+t})).join("+"),h=a.map((function(t){return"b"+t})).join(","),d=a.map((function(t){return"c"+t})).join(",");o.push("function "+n+"(a,"+h+","+d+",d){this.data=a","this.shape=["+h+"]","this.stride=["+d+"]","this.offset=d|0}","var proto="+n+".prototype","proto.dtype='"+t+"'","proto.dimension="+e),o.push("Object.defineProperty(proto,'size',{get:function "+n+"_size(){return "+a.map((function(t){return"this.shape["+t+"]"})).join("*"),"}})"),1===e?o.push("proto.order=[0]"):(o.push("Object.defineProperty(proto,'order',{get:"),e<4?(o.push("function "+n+"_order(){"),2===e?o.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===e&&o.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):o.push("ORDER})")),o.push("proto.set=function "+n+"_set("+l.join(",")+",v){"),i?o.push("return this.data.set("+u+",v)}"):o.push("return this.data["+u+"]=v}"),o.push("proto.get=function "+n+"_get("+l.join(",")+"){"),i?o.push("return this.data.get("+u+")}"):o.push("return this.data["+u+"]}"),o.push("proto.index=function "+n+"_index(",l.join(),"){return "+u+"}"),o.push("proto.hi=function "+n+"_hi("+l.join(",")+"){return new "+n+"(this.data,"+a.map((function(t){return["(typeof i",t,"!=='number'||i",t,"<0)?this.shape[",t,"]:i",t,"|0"].join("")})).join(",")+","+a.map((function(t){return"this.stride["+t+"]"})).join(",")+",this.offset)}");var p=a.map((function(t){return"a"+t+"=this.shape["+t+"]"})),f=a.map((function(t){return"c"+t+"=this.stride["+t+"]"}));o.push("proto.lo=function "+n+"_lo("+l.join(",")+"){var b=this.offset,d=0,"+p.join(",")+","+f.join(","));for(var m=0;m<e;++m)o.push("if(typeof i"+m+"==='number'&&i"+m+">=0){d=i"+m+"|0;b+=c"+m+"*d;a"+m+"-=d}");o.push("return new "+n+"(this.data,"+a.map((function(t){return"a"+t})).join(",")+","+a.map((function(t){return"c"+t})).join(",")+",b)}"),o.push("proto.step=function "+n+"_step("+l.join(",")+"){var "+a.map((function(t){return"a"+t+"=this.shape["+t+"]"})).join(",")+","+a.map((function(t){return"b"+t+"=this.stride["+t+"]"})).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(m=0;m<e;++m)o.push("if(typeof i"+m+"==='number'){d=i"+m+"|0;if(d<0){c+=b"+m+"*(a"+m+"-1);a"+m+"=ceil(-a"+m+"/d)}else{a"+m+"=ceil(a"+m+"/d)}b"+m+"*=d}");o.push("return new "+n+"(this.data,"+a.map((function(t){return"a"+t})).join(",")+","+a.map((function(t){return"b"+t})).join(",")+",c)}");var g=new Array(e),y=new Array(e);for(m=0;m<e;++m)g[m]="a[i"+m+"]",y[m]="b[i"+m+"]";o.push("proto.transpose=function "+n+"_transpose("+l+"){"+l.map((function(t,e){return t+"=("+t+"===undefined?"+e+":"+t+"|0)"})).join(";"),"var a=this.shape,b=this.stride;return new "+n+"(this.data,"+g.join(",")+","+y.join(",")+",this.offset)}"),o.push("proto.pick=function "+n+"_pick("+l+"){var a=[],b=[],c=this.offset");for(m=0;m<e;++m)o.push("if(typeof i"+m+"==='number'&&i"+m+">=0){c=(c+this.stride["+m+"]*i"+m+")|0}else{a.push(this.shape["+m+"]);b.push(this.stride["+m+"])}");return o.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),o.push("return function construct_"+n+"(data,shape,stride,offset){return new "+n+"(data,"+a.map((function(t){return"shape["+t+"]"})).join(",")+","+a.map((function(t){return"stride["+t+"]"})).join(",")+",offset)}"),new Function("CTOR_LIST","ORDER",o.join("\n"))(c[t],s)}var c={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],bigint64:[],biguint64:[],buffer:[],generic:[]};t.exports=function(t,e,n,r){if(void 0===t)return(0,c.array[0])([]);"number"===typeof t&&(t=[t]),void 0===e&&(e=[t.length]);var a=e.length;if(void 0===n){n=new Array(a);for(var s=a-1,u=1;s>=0;--s)n[s]=u,u*=e[s]}if(void 0===r){r=0;for(s=0;s<a;++s)n[s]<0&&(r-=(e[s]-1)*n[s])}for(var h=function(t){if(i(t))return"buffer";if(o)switch(Object.prototype.toString.call(t)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}return Array.isArray(t)?"array":"generic"}(t),d=c[h];d.length<=a+1;)d.push(l(h,d.length-1));return(0,d[a+1])(t,e,n,r)}},20:module=>{var e;window,e=function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=26)}([function(t,e,n){"use strict";var r=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.PoolConvUtil=e.ReduceUtil=e.SplitUtil=e.MathUtil=e.ShapeUtil=e.LongUtil=e.ProtoUtil=e.GemmUtil=e.arrayCopyHelper=e.BroadcastUtil=e.MatMulUtil=e.checkInputsShape=void 0;var a=o(n(13)),s=n(9),l=n(1);e.checkInputsShape=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(!t||t.length!==e.length)return!1;for(var r=0;r<t.length;r++)if(!t[r].dims||t[r].dims.length!==e[r])return!1;return!0};var c=function(){function t(){}return t.preprocessInputShapes=function(t,e){return[1===t.length?[1,t[0]]:t,1===e.length?[e[0],1]:e]},t.postprocessOutputShape=function(t,e,n){1===e&&t.splice(t.length-2,1),1===n&&t.pop()},t.calcMatMulShape=function(t,e){return t[1]!==e[0]?void 0:[t[0],e[1]]},t}();e.MatMulUtil=c;var u=function(){function t(){}return t.calcShape=function(t,e,n){var i;void 0===n&&(n=!1);var o=t.length,a=e.length;if(0===o)return e;if(0===a)return t;var s=Math.max(t.length,e.length),l=new Array(s);if(n){if(o<2||a<2)return;var u=c.calcMatMulShape([t[o-2],t[o-1]],[e[a-2],e[a-1]]);if(void 0===u)return;i=r(u,2),l[s-2]=i[0],l[s-1]=i[1]}for(var h=n?3:1;h<=s;h++){var d=o-h<0?1:t[o-h],p=a-h<0?1:e[a-h];if(d!==p&&d>1&&p>1)return;l[s-h]=Math.max(d,p)}return l},t.index=function(e,n){var r=new Array(n.length);return t.fillIndex(e,n,r),r},t.fillIndex=function(t,e,n){for(var r=t.length-e.length,i=0;i<e.length;i++)n[i]=t[r+i]%e[i]},t.calc=function(e,n,r,i,o){var a=t.calcShape(e.dims,n.dims);if(a){if(i&&!f.areEqual(a,e.dims))return;var s=f.size(a),c=i?e:new l.Tensor(a,o||e.type);if(0===a.length)c.set([],r(e.get([]),n.get([])));else{var u=new Array(a.length),h=new Array(e.dims.length),d=new Array(n.dims.length),p=0,m=0,g=!1,y=!1;0===e.dims.length&&(p=e.get([]),g=!0),0===n.dims.length&&(m=n.get([]),y=!0);for(var v=void 0,b=0;b<s;b++){v=b;for(var x=a.length-1;x>=0;x--)u[x]=v%a[x],v=Math.floor(v/a[x]);g||(t.fillIndex(u,e.dims,h),p=e.get(h)),y||(t.fillIndex(u,n.dims,d),m=n.get(d)),c.set(u,r(p,m))}}return c}},t.isValidBroadcast=function(t,e){var n=t.length,r=e.length;if(n>r)return!1;for(var i=1;i<=n;i++)if(1!==t[n-i]&&t[n-i]!==e[r-i])return!1;return!0},t}();e.BroadcastUtil=u,e.arrayCopyHelper=function(t,e,n,r,i){if(r<0||r>=e.length)throw new Error("sourceIndex out of bounds");if(n<0||n>=t.length)throw new Error("targetIndex out of bounds");if(r+i>e.length)throw new Error("source indices to be copied are outside bounds");if(n+i>t.length)throw new Error("target array is too small to hold result");for(var o=0;o<i;o++)t[n+o]=e[r+o]};var h=function(){function t(){}return t.getShapeOfGemmResult=function(t,e,n,r,i){if(2!==t.length||2!==n.length)throw new Error("shape need to be of size 2");var o,a,s;e?(o=t[1],a=t[0]):(o=t[0],a=t[1]);var l=-1;if(r?(s=n[0],l=1):(s=n[1],l=0),n[l]!==a)throw new Error("dimension mismatch");if(o<=0||s<=0||a<=0)throw new Error("invalid shape specified");if(i&&!u.isValidBroadcast(i,[o,s]))throw new Error("gemm: invalid bias shape for broadcast");return[o,s,a]},t}();e.GemmUtil=h;var d=function(){function t(){}return t.tensorDataTypeFromProto=function(t){switch(t){case s.onnx.TensorProto.DataType.INT8:return"int8";case s.onnx.TensorProto.DataType.UINT8:return"uint8";case s.onnx.TensorProto.DataType.BOOL:return"bool";case s.onnx.TensorProto.DataType.INT16:return"int16";case s.onnx.TensorProto.DataType.UINT16:return"uint16";case s.onnx.TensorProto.DataType.INT32:return"int32";case s.onnx.TensorProto.DataType.UINT32:return"uint32";case s.onnx.TensorProto.DataType.FLOAT:return"float32";case s.onnx.TensorProto.DataType.DOUBLE:return"float64";case s.onnx.TensorProto.DataType.STRING:return"string";case s.onnx.TensorProto.DataType.INT64:return"int32";case s.onnx.TensorProto.DataType.UINT64:return"uint32";default:throw new Error("unsupported data type: "+s.onnx.TensorProto.DataType[t])}},t.tensorDimsFromProto=function(t){return t.map((function(t){return a.default.isLong(t)?t.toNumber():t}))},t.tensorValueTypeFromProto=function(e){return{tensorType:t.tensorDataTypeFromProto(e.elemType),shape:{dims:t.tensorDimsFromProto(e.shape.dim.map((function(t){return t.dimValue})))}}},t}();e.ProtoUtil=d;var p=function(){function t(){}return t.longToNumber=function(t){return a.default.isLong(t)?t.toNumber():t},t}();e.LongUtil=p;var f=function(){function t(){}return t.size=function(e){return t.getSizeFromDimensionRange(e,0,e.length)},t.sizeFromDimension=function(e,n){if(n<0||n>e.length)throw new Error("invalid dimension of "+n+" for sizeFromDimension as Tensor has "+e.length+" dimensions.");return t.getSizeFromDimensionRange(e,n,e.length)},t.sizeToDimension=function(e,n){if(n<0||n>e.length)throw new Error("invalid dimension of "+n+" for sizeToDimension as Tensor has "+e.length+" dimensions.");return t.getSizeFromDimensionRange(e,0,n)},t.getSizeFromDimensionRange=function(t,e,n){for(var r=1,i=e;i<n;i++){if(t[i]<=0)throw new Error("cannot get valid size from specified dimension range. Most likely the range contains 0 or negative values in them.");r*=t[i]}return r},t.computeStrides=function(t){var e=t.length;if(0===e)return[];if(1===e)return[1];var n=new Array(e);n[e-1]=1,n[e-2]=t[e-1];for(var r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n},t.transpose=function(t){return t.slice().reverse()},t.indicesToOffset=function(t,e,n){void 0===n&&(n=t.length);for(var r=0,i=0;i<n;++i)r+=e[i]*t[i];return r},t.offsetToIndices=function(t,e){var n=e.length;if(0===n)return[];if(1===n)return[t*e[0]];for(var r=new Array(e.length),i=0;i<r.length-1;++i)r[i]=Math.floor(t/e[i]),t-=r[i]*e[i];return r[r.length-1]=t,r},t.normalizeAxis=function(t,e){if(t<-e&&t>=e)throw new Error("unsupported axis for this operation.");return t<0?t+e:t},t.normalizeAxes=function(t,e){var n=this;return t.map((function(t){return n.normalizeAxis(t,e)}))},t.incrementIndex=function(t,e,n){if(0===e.length||0===t.length)throw new Error("Index incrementing unsupported for scalar Tensor");if(void 0===n)n=e.length;else if(n<=0||n>e.length)throw new Error("Incorrect axis to increment on");for(var r=n-1;r>=0&&(t[r]++,!(t[r]<e[r]));--r)t[r]=0},t.calculateReshapedDims=function(e,n){if(0===n.length){if(0===e.length||1===t.size(e))return[];throw new Error("cannot reshape to a scalar Tensor")}for(var r=n.length,i=new Array(r),o=-1,a=1,s=0;s<r;s++){if(n[s]<-1)throw new Error("a dimension in shape hints cannot be less than -1");if(-1===n[s]){if(-1!==o)throw new Error("at most one dimension in shape hints can be -1");o=s}else{if(0===n[s]){if(s>=e.length)throw new Error("the dimension with value zero exceeds the dimension size of the input tensor");i[s]=e[s]}else i[s]=n[s];a*=i[s]}}var l=t.size(e);if(-1!==o){if(l%a!=0)throw new Error("the input tensor cannot be reshaped to the requested shape. Input shape: ["+e+"] Output shape: ["+n+"]");i[o]=l/a}else if(a!==l)throw new Error("reshapedDims and originalDims don't have matching sizes");return i},t.sortBasedOnPerm=function(t,e){return e?e.map((function(e){return t[e]})):t.slice().reverse()},t.padShape=function(t,e){var n=t.length;return t.map((function(t,r){return t+e[r]+e[r+n]}))},t.areEqual=function(t,e){return t.length===e.length&&t.every((function(t,n){return t===e[n]}))},t.validateDimsAndCalcSize=function(t){var e,n;if(t.length>6)throw new TypeError("Only rank 0 to 6 is supported for tensor shape.");var r=1;try{for(var o=i(t),a=o.next();!a.done;a=o.next()){var s=a.value;if(!Number.isInteger(s))throw new TypeError("Invalid shape: "+s+" is not an integer");if(s<0||s>2147483647)throw new TypeError("Invalid shape: length "+s+" is not allowed");r*=s}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return r},t.flattenShape=function(t,e){e<0&&(e+=t.length);var n=t.reduce((function(t,e){return t*e}),1),r=t.slice(e).reduce((function(t,e){return t*e}),1);return[n/r,r]},t.squeezeShape=function(e,n){var r=new Array;n=t.normalizeAxes(n,e.length);for(var i=0;i<e.length;i++){var o=n.indexOf(i)>=0;if(o&&1!==e[i])throw new Error("squeeze an axis of size different than 1");(0===n.length&&e[i]>1||n.length>0&&!o)&&r.push(e[i])}return r},t.unsqueezeShape=function(e,n){var r=new Array(e.length+n.length);r.fill(0);for(var i=0;i<n.length;i++){var o=t.normalizeAxis(n[i],e.length);if(o>=r.length)throw new Error("'axes' has an out of range axis");if(0!==r[o])throw new Error("'axes' has a duplicate axis");r[o]=1}var a=0;for(i=0;i<r.length;i++)0===r[i]&&(r[i]=e[a++]);if(a!==e.length)throw new Error("the unsqueezed dimension could not be established");return r},t}();e.ShapeUtil=f;var m=function(){function t(){}return t.sqr=function(t,e,n,r,i){if(r<0||r>=e.length)throw new Error("sourceIndex out of bounds");if(n<0||n>=t.length)throw new Error("targetIndex out of bounds");if(r+i>e.length)throw new Error("source indices to be copied are outside bounds");if(n+i>t.length)throw new Error("target array is too small to hold result");for(var o=0;o<i;o++)t[n+o]+=Math.pow(e[r+o],2)},t.axpy=function(t,e,n,r,i,o){if(r<0||r>=e.length)throw new Error("sourceIndex out of bounds");if(n<0||n>=t.length)throw new Error("targetIndex out of bounds");if(r+i>e.length)throw new Error("source indices to be copied are outside bounds");if(n+i>t.length)throw new Error("target array is too small to hold result");for(var a=0;a<i;a++)t[n+a]+=o*e[r+a]},t.powx=function(t,e,n,r,i,o){if(r<0||r>=e.length)throw new Error("sourceIndex out of bounds");if(n<0||n>=t.length)throw new Error("targetIndex out of bounds");if(r+i>e.length)throw new Error("source indices to be copied are outside bounds");if(n+i>t.length)throw new Error("target array is too small to hold result");for(var a=0;a<i;a++)t[n+a]=Math.pow(e[r+a],o)},t.mul=function(t,e,n,r,i){if(r<0||r>=e.length)throw new Error("sourceIndex out of bounds");if(n<0||n>=t.length)throw new Error("targetIndex out of bounds");if(r+i>e.length)throw new Error("source indices to be copied are outside bounds");if(n+i>t.length)throw new Error("target array is too small to hold result");for(var o=0;o<i;o++)t[n+o]=e[r+o]*t[n+o]},t}();e.MathUtil=m;var g=function(){function t(){}return t.splitShape=function(e,n,r,i){if(0===r.length){if(!i)throw new Error("need to know number of outputs when the 'split' attribute is not specified");t.determineSplit(e[n],i,r)}for(var o=[],a=[0],s=0;s<r.length;++s){0!==s&&a.push(a[s-1]+r[s-1]);var l=e.slice();l[n]=r[s],o.push(l)}return[o,a]},t.determineSplit=function(t,e,n){if(t%e!=0)throw new Error("cannot split tensor to equal sized parts");for(var r=0;r<e;++r)n.push(t/e)},t}();e.SplitUtil=g;var y=function(){function t(){}return t.calcReduce=function(e,n,r,i,o){var a=e.dims.slice(0);0===n.length&&a.forEach((function(t,e){return n.push(e)}));for(var s=t.calcReduceShape(a,n,!0),c=f.size(s),h=new l.Tensor(s,e.type),d=f.computeStrides(s),p=f.computeStrides(a),m=new Array(a.length),g=0;g<c;g++){var y=f.offsetToIndices(g,d);u.fillIndex(y,a,m),h.set(y,t.calcReduceByAxis(e.numberData,n,a,0,f.indicesToOffset(m,p),i,o))}return r?h:new l.Tensor(t.calcReduceShape(a,n,r),h.type,void 0,void 0,h.data,h.dataId)},t.calcReduceByAxis=function(e,n,r,i,o,a,s){var l=0;if(i>=n.length)return a(e[o]);for(var c=n[i],u=c>=r.length?1:f.size(r.slice(c+1)),h=0;h<r[c];h++)l=0===h?t.calcReduceByAxis(e,n,r,i+1,o,a,s):s(l,t.calcReduceByAxis(e,n,r,i+1,o,a,s)),o+=u;return l},t.calcReduceShape=function(t,e,n){for(var r=t.slice(),i=0;i<e.length;i++)r[e[i]]=n?1:0;return r.filter((function(t){return 0!==t}))},t}();e.ReduceUtil=y;var v=function(){function t(){}return t.adjustPoolAttributes=function(t,e,n,r,i){if(!t&&n.length!==e.length-2)throw new Error("length of specified kernel shapes should be 2 less than length of input dimensions");if(t)for(var o=0;o<e.length-2;o++)o>=n.length?n.push(e[o+2]):n[o]=e[o+2];for(o=0;o<n.length;o++)if(o<r.length){if(r[o]<0)throw new Error("strides should be greater than or equal to 1")}else r.push(1);for(o=0;o<2*n.length;o++)if(o<i.length){if(i[o]<0)throw new Error("pad should be greater than or equal to 1")}else i.push(0);for(o=0;o<n.length;o++){if(n[o]<=0)throw new Error("kernel shapes need to be greater than 0");if(i[o]>=n[o]||i[o+n.length]>=n[o])throw new Error("pads should be smaller than kernel")}},t.adjustPadsBasedOnAutoPad=function(e,n,r,i,o,a){if(a){if(o.length!==2*(e.length-2))throw new Error("length of pads should be twice the length of data dimensions");if(n.length!==e.length-2)throw new Error("length of strides should be the length of data dimensions");if(i.length!==e.length-2)throw new Error("length of kernel shapes should be the length of data dimensions");for(var s=0;s<e.length-2;s++)t.adjustPadAndReturnShape(e[s+2],n[s],r[s],i[s],o,s,s+e.length-2,a)}},t.computePoolOutputShape=function(e,n,r,i,o,a){if(n.length<=0)throw new Error("input shape must be of size greater than 0");var s=[n[0],n[1]],l=new Array(i.length).fill(1);return t.computeShapeHelper(e,n,s,r,l,i,o,a),s},t.computeConvOutputShape=function(e,n,r,i,o,a,s){if(e.length<=0||n.length<=0)throw new Error("invalid input tensor dims or invalid filter tensor dims");var l=[e[0],n[0]];return t.computeShapeHelper(!1,e,l,r,i,o,a,s),l},t.computeShapeHelper=function(e,n,r,i,o,a,s,l){if(e)for(var c=0;c<n.length-2;c++)r.push(1);else for(c=0;c<n.length-2;c++)r.push(t.adjustPadAndReturnShape(n[c+2],i[c],o[c],a[c],s,c,c+n.length-2,l))},t.adjustPadAndReturnShape=function(t,e,n,r,i,o,a,s){var l=n*(r-1)+1;if(!s||"NOTSET"===s)return Math.floor((t+i[o]+i[a]-l)/e+1);switch(s){case"VALID":return i[o]=0,i[a]=0,Math.floor((t-l)/e+1);case"SAME_LOWER":case"SAME_UPPER":if(1!==n)throw new Error("Dilation not supported for SAME_UPPER or SAME_LOWER");var c=((t+e-1)/e-1)*e+r-t;return i[o]="SAME_LOWER"===s?Math.floor((c+1)/2):Math.floor(c/2),i[a]=c-i[o],Math.floor((t+c-r)/e+1);default:throw new Error("Unsupported AutoPad type")}},t}();e.PoolConvUtil=v},function(t,e,n){"use strict";(function(t){var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{l(r.next(t))}catch(t){o(t)}}function s(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Tensor=void 0;var a=o(n(13)),s=n(9),l=n(0),c=function(){function e(t,e,n,r,i,o){void 0===o&&(o={}),this.dims=t,this.type=e,this.dataProvider=n,this.asyncDataProvider=r,this.cache=i,this.dataId=o,this.size=l.ShapeUtil.validateDimsAndCalcSize(t);var a=this.size,s=void 0===n&&void 0===r&&void 0===i;if(void 0!==i&&i.length!==a)throw new RangeError("Input dims doesn't match data length.");if("string"===e){if(!(void 0===i||Array.isArray(i)&&i.every((function(t){return"string"==typeof t}))))throw new TypeError("cache should be a string array");s&&(i=new Array(a))}else{if(void 0!==i){var c=u(e);if(!(i instanceof c))throw new TypeError("cache should be type "+c.name)}if(s){var h=new ArrayBuffer(a*function(t){switch(t){case"bool":case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;case"float64":return 8;default:throw new Error("cannot calculate sizeof() on type "+t)}}(e));this.cache=function(t,e){return new(u(e))(t)}(h,e)}}}return Object.defineProperty(e.prototype,"data",{get:function(){if(void 0===this.cache){var t=this.dataProvider(this.dataId);if(t.length!==this.size)throw new Error("Length of data provided by the Data Provider is inconsistent with the dims of this Tensor.");this.cache=t}return this.cache},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stringData",{get:function(){if("string"!==this.type)throw new TypeError("data type is not string");return this.data},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"integerData",{get:function(){switch(this.type){case"uint8":case"int8":case"uint16":case"int16":case"int32":case"uint32":case"bool":return this.data;default:throw new TypeError("data type is not integer (uint8, int8, uint16, int16, int32, uint32, bool)")}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"floatData",{get:function(){switch(this.type){case"float32":case"float64":return this.data;default:throw new TypeError("data type is not float (float32, float64)")}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"numberData",{get:function(){if("string"!==this.type)return this.data;throw new TypeError("type cannot be non-number (string)")},enumerable:!1,configurable:!0}),e.prototype.get=function(t){return this.data[l.ShapeUtil.indicesToOffset(t,this.strides)]},e.prototype.set=function(t,e){this.data[l.ShapeUtil.indicesToOffset(t,this.strides)]=e},e.prototype.getData=function(){return r(this,void 0,void 0,(function(){var t;return i(this,(function(e){switch(e.label){case 0:return void 0!==this.cache?[3,2]:(t=this,[4,this.asyncDataProvider(this.dataId)]);case 1:t.cache=e.sent(),e.label=2;case 2:return[2,this.cache]}}))}))},Object.defineProperty(e.prototype,"strides",{get:function(){return this._strides||(this._strides=l.ShapeUtil.computeStrides(this.dims)),this._strides},enumerable:!1,configurable:!0}),e.fromProto=function(n){if(!n)throw new Error("cannot construct Value from an empty tensor");var r=l.ProtoUtil.tensorDataTypeFromProto(n.dataType),i=new e(l.ProtoUtil.tensorDimsFromProto(n.dims),r);if("string"===r)n.stringData.forEach((function(e,n){var r=t.from(e.buffer,e.byteOffset,e.byteLength);i.data[n]=r.toString()}));else if(n.rawData&&"number"==typeof n.rawData.byteLength&&n.rawData.byteLength>0){var o=i.data,c=new DataView(n.rawData.buffer,n.rawData.byteOffset,n.rawData.byteLength),u=function(t){switch(t){case s.onnx.TensorProto.DataType.UINT8:case s.onnx.TensorProto.DataType.INT8:case s.onnx.TensorProto.DataType.BOOL:return 1;case s.onnx.TensorProto.DataType.UINT16:case s.onnx.TensorProto.DataType.INT16:return 2;case s.onnx.TensorProto.DataType.FLOAT:case s.onnx.TensorProto.DataType.INT32:case s.onnx.TensorProto.DataType.UINT32:return 4;case s.onnx.TensorProto.DataType.INT64:case s.onnx.TensorProto.DataType.DOUBLE:case s.onnx.TensorProto.DataType.UINT64:return 8;default:throw new Error("cannot calculate sizeof() on type "+s.onnx.TensorProto.DataType[t])}}(n.dataType),p=n.rawData.byteLength/u;if(n.rawData.byteLength%u!=0)throw new Error("invalid buffer length");if(o.length!==p)throw new Error("buffer length mismatch");for(var f=0;f<p;f++){var m=d(c,n.dataType,f*u);o[f]=m}}else{var g=void 0;switch(n.dataType){case s.onnx.TensorProto.DataType.FLOAT:g=n.floatData;break;case s.onnx.TensorProto.DataType.INT32:case s.onnx.TensorProto.DataType.INT16:case s.onnx.TensorProto.DataType.UINT16:case s.onnx.TensorProto.DataType.INT8:case s.onnx.TensorProto.DataType.UINT8:case s.onnx.TensorProto.DataType.BOOL:g=n.int32Data;break;case s.onnx.TensorProto.DataType.INT64:g=n.int64Data;break;case s.onnx.TensorProto.DataType.DOUBLE:g=n.doubleData;break;case s.onnx.TensorProto.DataType.UINT32:case s.onnx.TensorProto.DataType.UINT64:g=n.uint64Data;break;default:throw new Error("unspecific error")}if(null==g)throw new Error("failed to populate data from a tensorproto value");var y=i.data;if(y.length!==g.length)throw new Error("array length mismatch");for(f=0;f<g.length;f++){var v=g[f];a.default.isLong(v)?y[f]=h(v,n.dataType):y[f]=v}}return i},e.fromData=function(t,n,r){return new e(n,r,void 0,void 0,t)},e}();function u(t){switch(t){case"bool":case"uint8":return Uint8Array;case"int8":return Int8Array;case"int16":return Int16Array;case"uint16":return Uint16Array;case"int32":return Int32Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;default:throw new Error("unspecified error")}}function h(t,e){if(e===s.onnx.TensorProto.DataType.INT64){if(t.greaterThanOrEqual(2147483648)||t.lessThan(-2147483648))throw new TypeError("int64 is not supported")}else{if(e!==s.onnx.TensorProto.DataType.UINT32&&e!==s.onnx.TensorProto.DataType.UINT64)throw new TypeError("not a LONG type: "+s.onnx.TensorProto.DataType[e]);if(t.greaterThanOrEqual(4294967296)||t.lessThan(0))throw new TypeError("uint64 is not supported")}return t.toNumber()}function d(t,e,n){switch(e){case s.onnx.TensorProto.DataType.BOOL:case s.onnx.TensorProto.DataType.UINT8:return t.getUint8(n);case s.onnx.TensorProto.DataType.INT8:return t.getInt8(n);case s.onnx.TensorProto.DataType.UINT16:return t.getUint16(n,!0);case s.onnx.TensorProto.DataType.INT16:return t.getInt16(n,!0);case s.onnx.TensorProto.DataType.FLOAT:return t.getFloat32(n,!0);case s.onnx.TensorProto.DataType.INT32:return t.getInt32(n,!0);case s.onnx.TensorProto.DataType.UINT32:return t.getUint32(n,!0);case s.onnx.TensorProto.DataType.INT64:return h(a.default.fromBits(t.getUint32(n,!0),t.getUint32(n+4,!0),!1),e);case s.onnx.TensorProto.DataType.DOUBLE:return t.getFloat64(n,!0);case s.onnx.TensorProto.DataType.UINT64:return h(a.default.fromBits(t.getUint32(n,!0),t.getUint32(n+4,!0),!0),e);default:throw new Error("cannot read from DataView for type "+s.onnx.TensorProto.DataType[e])}}e.Tensor=c}).call(this,n(12).Buffer)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getDefaultFragShaderMain=e.getFragShaderPreamble=e.getVertexShaderSource=e.getGlsl=void 0;var r={version:"",attribute:"attribute",varyingVertex:"varying",varyingFrag:"varying",texture2D:"texture2D",output:"gl_FragColor",outputDeclaration:""},i={version:"#version 300 es",attribute:"in",varyingVertex:"out",varyingFrag:"in",texture2D:"texture",output:"outputColor",outputDeclaration:"out vec4 outputColor;"};function o(t){return 1===t?r:i}e.getGlsl=o,e.getVertexShaderSource=function(t){var e=o(t);return e.version+"\n      precision highp float;\n      "+e.attribute+" vec3 position;\n      "+e.attribute+" vec2 textureCoord;\n\n      "+e.varyingVertex+" vec2 TexCoords;\n\n      void main()\n      {\n          gl_Position = vec4(position, 1.0);\n          TexCoords = textureCoord;\n      }"},e.getFragShaderPreamble=function(t){var e=o(t);return e.version+"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    "+e.varyingFrag+" vec2 TexCoords;\n    "+e.outputDeclaration+"\n\n    "},e.getDefaultFragShaderMain=function(t,e){return"\n  void main() {\n    int indices["+e+"];\n    toVec(TexCoords, indices);\n    vec4 result = vec4(process(indices));\n    "+o(t).output+" = result;\n  }\n  "}},function(t,e,n){"use strict";var r,i;Object.defineProperty(e,"__esModule",{value:!0}),e.now=e.Profiler=e.Logger=void 0;var o=function(){function t(){}return t.prototype.log=function(t,e,n){},t}(),a=function(){function t(){}return t.prototype.log=function(t,e,n){console.log(this.color(t)+" "+(n?"\x1b[35m"+n+"\x1b[0m ":"")+e)},t.prototype.color=function(t){switch(t){case"verbose":return"\x1b[34;40mv\x1b[0m";case"info":return"\x1b[32mi\x1b[0m";case"warning":return"\x1b[30;43mw\x1b[0m";case"error":return"\x1b[31;40me\x1b[0m";default:throw new Error("unsupported severity: "+t)}},t}(),s={verbose:1e3,info:2e3,warning:4e3,error:5e3},l=((r={}).none=new o,r.console=new a,r),c={provider:"console",minimalSeverity:"info",logDateTime:!0,logSourceLocation:!1},u=((i={})[""]=c,i);function h(t,e,n,r){if(void 0===e)return i=t,{verbose:h.verbose.bind(null,i),info:h.info.bind(null,i),warning:h.warning.bind(null,i),error:h.error.bind(null,i)};if(void 0===n)d(t,e);else if("number"==typeof n&&void 0===r)d(t,e);else if("string"==typeof n&&void 0===r)d(t,n,0,e);else{if("string"!=typeof n||"number"!=typeof r)throw new TypeError("input is valid");d(t,n,0,e)}var i}function d(t,e,n,r){var i=u[r||""]||u[""];s[t]<s[i.minimalSeverity]||(i.logDateTime&&(e=(new Date).toISOString()+"|"+e),i.logSourceLocation,l[i.provider].log(t,e,r))}!function(t){function e(t){u={},n("",t||{})}function n(t,n){if("*"===t)e(n);else{var r=u[t]||c;u[t]={provider:n.provider||r.provider,minimalSeverity:n.minimalSeverity||r.minimalSeverity,logDateTime:void 0===n.logDateTime?r.logDateTime:n.logDateTime,logSourceLocation:void 0===n.logSourceLocation?r.logSourceLocation:n.logSourceLocation}}}t.verbose=function(e,n){t("verbose",e,n)},t.info=function(e,n){t("info",e,n)},t.warning=function(e,n){t("warning",e,n)},t.error=function(e,n){t("error",e,n)},t.reset=e,t.set=n}(h||(h={})),e.Logger=h;var p=function(){function t(t,e,n,r){this.category=t,this.name=e,this.startTime=n,this.endCallback=r}return t.prototype.end=function(){this.endCallback(this)},t}(),f=function(t,e,n,r){this.category=t,this.name=e,this.startTime=n,this.endTime=r},m=function(){function t(t,e,n){this._started=!1,this._flushPointer=0,this._started=!1,this._maxNumberEvents=void 0===t?1e4:t,this._flushBatchSize=void 0===e?10:e,this._flushIntervalInMilliseconds=void 0===n?5e3:n}return t.create=function(t){return void 0===t?new this:new this(t.maxNumberEvents,t.flushBatchSize,t.flushIntervalInMilliseconds)},t.prototype.start=function(){this._started=!0,this._timingEvents=[],this._flushTime=e.now(),this._flushPointer=0},t.prototype.stop=function(){for(this._started=!1;this._flushPointer<this._timingEvents.length;this._flushPointer++)this.logOneEvent(this._timingEvents[this._flushPointer])},t.prototype.event=function(t,e,n){var r=this._started?this.begin(t,e):void 0,i=!1;try{var o=n();return o&&"function"==typeof o.then?(i=!0,new Promise((function(t,e){o.then((function(e){t(e),r&&r.end()}),(function(t){e(t),r&&r.end()}))}))):o}finally{!i&&r&&r.end()}},t.prototype.begin=function(t,n){var r=this;if(!this._started)throw new Error("profiler is not started yet");var i=e.now();return this.flush(i),new p(t,n,i,(function(t){return r.end(t)}))},t.prototype.end=function(t){if(this._timingEvents.length<this._maxNumberEvents){var n=e.now();this._timingEvents.push(new f(t.category,t.name,t.startTime,n)),this.flush(n)}},t.prototype.logOneEvent=function(t){e.Logger.verbose("Profiler."+t.category,(t.endTime-t.startTime).toFixed(2)+"ms on event '"+t.name+"' at "+t.endTime.toFixed(2))},t.prototype.flush=function(t){if(this._timingEvents.length-this._flushPointer>=this._flushBatchSize||t-this._flushTime>=this._flushIntervalInMilliseconds){for(var n=this._flushPointer;this._flushPointer<n+this._flushBatchSize&&this._flushPointer<this._timingEvents.length;this._flushPointer++)this.logOneEvent(this._timingEvents[this._flushPointer]);this._flushTime=e.now()}},Object.defineProperty(t.prototype,"started",{get:function(){return this._started},enumerable:!1,configurable:!0}),t}();e.Profiler=m,e.now="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:Date.now},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),a=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.hasOwnProperty.call(t,n)&&o(e,t,n);return a(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.WasmBinding=e.init=void 0;var l,c,u,h=n(3),d=s(n(103)),p=!1,f=!1;e.init=function(t,e){if(p)return Promise.resolve();if(f)throw new Error("multiple calls to 'init()' detected.");return f=!0,new Promise((function(r,i){var o,a=function(){void 0!==o&&(clearTimeout(o),o=void 0)},s=function(){a(),r(),f=!1,p=!0},m=d.init(),g=new Promise((function(t,n){o=setTimeout((function(){n("Wasm init promise failed to be resolved within set timeout")}),e)}));t>0?(h.Logger.verbose("WebAssembly-Workers","User has requested "+t+" Workers."),"undefined"==typeof window||void 0===window.Worker?(h.Logger.error("WebAssembly-Workers","Environment does not support usage of Workers. Will not spawn workers."),c=0):(h.Logger.verbose("WebAssembly-Workers","Environment supports usage of Workers. Will spawn "+t+" Workers"),c=t)):(h.Logger.verbose("WebAssembly-Workers","User has disabled usage of Workers. Will not spawn workers."),c=0);var y=new Array(c);l=new Array(c),u=new Array(c);for(var v=function(t){var e=new Promise((function(e,r){var i=n(105).default();l[t]=i,u[t]=[],i.onerror=function(e){h.Logger.error("WebAssembly-Workers","worker-"+t+" ERR: "+e),p||r()},i.onmessage=function(n){if(!(n&&n.data&&n.data.type))throw new Error("missing message type from worker");if("init-success"===n.data.type)e();else{if("ccall"!==n.data.type)throw new Error("unknown message type from worker: "+n.data.type);var r=n.data.perfData;u[t].shift()(n.data.buffer,r)}}}));y[t]=e},b=0;b<c;b++)v(b);Promise.race([m,g]).then((function(){Promise.all(y).then(s,(function(t){h.Logger.warning("WebAssembly-Workers","Unable to get all requested workers initialized. Will use Wasm backend with 0 workers. ERR: "+t),c=0,s()}))}),(function(t){a(),i(t),f=!1}))}))};var m=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},Object.defineProperty(e,"workerNumber",{get:function(){return c},enumerable:!1,configurable:!0}),e.prototype.ccallRemote=function(t,n){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(!p)throw new Error("wasm not initialized. please ensure 'init()' is called.");if(t<0||t>=c)throw new Error("invalid worker ID "+t+". should be in range [0, "+c+")");var o=[],a=e.calculateOffsets(o,r),s=new ArrayBuffer(a);e.ccallSerialize(new Uint8Array(s),o,r);var h=d.now();return l[t].postMessage({type:"ccall",func:n,buffer:s},[s]),new Promise((function(n,i){u[t].push((function(t,i){i.startTimeWorker=i.startTime,i.endTimeWorker=i.endTime,i.startTime=h,i.endTime=d.now(),e.ccallDeserialize(new Uint8Array(t),o,r),n(i)}))}))},e}(d.WasmBinding);e.WasmBinding=m},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TopologicalSortGlslRoutines=e.GlslLibRoutineNode=e.GlslLibRoutine=e.GlslLib=e.GlslContext=e.FunctionType=void 0,function(t){t[t.ValueBased=0]="ValueBased",t[t.Positional=1]="Positional"}(e.FunctionType||(e.FunctionType={})),e.GlslContext=function(t,e){this.glContext=t,this.programInfo=e},e.GlslLib=function(t){this.context=t},e.GlslLibRoutine=function(t,e){this.routineBody=t,this.dependencies=e};var r=function(){function t(t,e,n){this.name=t,this.dependencies=n||[],e&&(this.routineBody=e)}return t.prototype.addDependency=function(t){t&&this.dependencies.push(t)},t}();e.GlslLibRoutineNode=r;var i=function(){function t(){}return t.returnOrderedNodes=function(t){if(!t||0===t.length)return[];if(1===t.length)return t;var e=new Set,n=new Set,r=new Array;return this.createOrderedNodes(t,e,n,r),r},t.createOrderedNodes=function(t,e,n,r){for(var i=0;i<t.length;++i)this.dfsTraverse(t[i],e,n,r)},t.dfsTraverse=function(t,e,n,r){if(t&&!n.has(t.name)){if(e.has(t.name))throw new Error("Cyclic dependency detected. Can't topologically sort routines needed for shader.");e.add(t.name);var i=t.dependencies;if(i&&i.length>0)for(var o=0;o<i.length;++o)this.dfsTraverse(i[o],e,n,r);r.push(t),n.add(t.name),e.delete(t.name)}},t}();e.TopologicalSortGlslRoutines=i},function(t,e,n){"use strict";(function(t){var r=e;function i(t,e,n){for(var r=Object.keys(e),i=0;i<r.length;++i)void 0!==t[r[i]]&&n||(t[r[i]]=e[r[i]]);return t}function o(t){function e(t,n){if(!(this instanceof e))return new e(t,n);Object.defineProperty(this,"message",{get:function(){return t}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),n&&i(this,n)}return(e.prototype=Object.create(Error.prototype)).constructor=e,Object.defineProperty(e.prototype,"name",{get:function(){return t}}),e.prototype.toString=function(){return this.name+": "+this.message},e}r.asPromise=n(64),r.base64=n(65),r.EventEmitter=n(66),r.float=n(67),r.inquire=n(68),r.utf8=n(69),r.pool=n(70),r.LongBits=n(71),r.global="undefined"!=typeof window&&window||void 0!==t&&t||"undefined"!=typeof self&&self||this,r.emptyArray=Object.freeze?Object.freeze([]):[],r.emptyObject=Object.freeze?Object.freeze({}):{},r.isNode=Boolean(r.global.process&&r.global.process.versions&&r.global.process.versions.node),r.isInteger=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},r.isString=function(t){return"string"==typeof t||t instanceof String},r.isObject=function(t){return t&&"object"==typeof t},r.isset=r.isSet=function(t,e){var n=t[e];return!(null==n||!t.hasOwnProperty(e))&&("object"!=typeof n||(Array.isArray(n)?n.length:Object.keys(n).length)>0)},r.Buffer=function(){try{var t=r.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch(t){return null}}(),r._Buffer_from=null,r._Buffer_allocUnsafe=null,r.newBuffer=function(t){return"number"==typeof t?r.Buffer?r._Buffer_allocUnsafe(t):new r.Array(t):r.Buffer?r._Buffer_from(t):"undefined"==typeof Uint8Array?t:new Uint8Array(t)},r.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,r.Long=r.global.dcodeIO&&r.global.dcodeIO.Long||r.global.Long||r.inquire("long"),r.key2Re=/^true|false|0|1$/,r.key32Re=/^-?(?:0|[1-9][0-9]*)$/,r.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,r.longToHash=function(t){return t?r.LongBits.from(t).toHash():r.LongBits.zeroHash},r.longFromHash=function(t,e){var n=r.LongBits.fromHash(t);return r.Long?r.Long.fromBits(n.lo,n.hi,e):n.toNumber(Boolean(e))},r.merge=i,r.lcFirst=function(t){return t.charAt(0).toLowerCase()+t.substring(1)},r.newError=o,r.ProtocolError=o("ProtocolError"),r.oneOfGetter=function(t){for(var e={},n=0;n<t.length;++n)e[t[n]]=1;return function(){for(var t=Object.keys(this),n=t.length-1;n>-1;--n)if(1===e[t[n]]&&void 0!==this[t[n]]&&null!==this[t[n]])return t[n]}},r.oneOfSetter=function(t){return function(e){for(var n=0;n<t.length;++n)t[n]!==e&&delete this[t[n]]}},r.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},r._configure=function(){var t=r.Buffer;t?(r._Buffer_from=t.from!==Uint8Array.from&&t.from||function(e,n){return new t(e,n)},r._Buffer_allocUnsafe=t.allocUnsafe||function(e){return new t(e)}):r._Buffer_from=r._Buffer_allocUnsafe=null}}).call(this,n(8))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FLOAT_TYPES=e.INT_TYPES=e.NUMBER_TYPES=void 0,e.NUMBER_TYPES=["float32","float64","int32","int16","int8","uint16","uint32","uint8"],e.INT_TYPES=["int32","int16","int8","uint16","uint32","uint8"],e.FLOAT_TYPES=["float32","float64"]},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";var r=n(62),i=r.Reader,o=r.Writer,a=r.util,s=r.roots.default||(r.roots.default={});s.onnx=function(){var t,e,n={};return n.Version=(t={},(e=Object.create(t))[t[0]="_START_VERSION"]=0,e[t[1]="IR_VERSION_2017_10_10"]=1,e[t[2]="IR_VERSION_2017_10_30"]=2,e[t[3]="IR_VERSION_2017_11_3"]=3,e[t[4]="IR_VERSION_2019_1_22"]=4,e[t[5]="IR_VERSION"]=5,e),n.AttributeProto=function(){function t(t){if(this.floats=[],this.ints=[],this.strings=[],this.tensors=[],this.graphs=[],t)for(var e=Object.keys(t),n=0;n<e.length;++n)null!=t[e[n]]&&(this[e[n]]=t[e[n]])}return t.prototype.name="",t.prototype.refAttrName="",t.prototype.docString="",t.prototype.type=0,t.prototype.f=0,t.prototype.i=a.Long?a.Long.fromBits(0,0,!1):0,t.prototype.s=a.newBuffer([]),t.prototype.t=null,t.prototype.g=null,t.prototype.floats=a.emptyArray,t.prototype.ints=a.emptyArray,t.prototype.strings=a.emptyArray,t.prototype.tensors=a.emptyArray,t.prototype.graphs=a.emptyArray,t.create=function(e){return new t(e)},t.encode=function(t,e){if(e||(e=o.create()),null!=t.name&&t.hasOwnProperty("name")&&e.uint32(10).string(t.name),null!=t.f&&t.hasOwnProperty("f")&&e.uint32(21).float(t.f),null!=t.i&&t.hasOwnProperty("i")&&e.uint32(24).int64(t.i),null!=t.s&&t.hasOwnProperty("s")&&e.uint32(34).bytes(t.s),null!=t.t&&t.hasOwnProperty("t")&&s.onnx.TensorProto.encode(t.t,e.uint32(42).fork()).ldelim(),null!=t.g&&t.hasOwnProperty("g")&&s.onnx.GraphProto.encode(t.g,e.uint32(50).fork()).ldelim(),null!=t.floats&&t.floats.length){e.uint32(58).fork();for(var n=0;n<t.floats.length;++n)e.float(t.floats[n]);e.ldelim()}if(null!=t.ints&&t.ints.length){for(e.uint32(66).fork(),n=0;n<t.ints.length;++n)e.int64(t.ints[n]);e.ldelim()}if(null!=t.strings&&t.strings.length)for(n=0;n<t.strings.length;++n)e.uint32(74).bytes(t.strings[n]);if(null!=t.tensors&&t.tensors.length)for(n=0;n<t.tensors.length;++n)s.onnx.TensorProto.encode(t.tensors[n],e.uint32(82).fork()).ldelim();if(null!=t.graphs&&t.graphs.length)for(n=0;n<t.graphs.length;++n)s.onnx.GraphProto.encode(t.graphs[n],e.uint32(90).fork()).ldelim();return null!=t.docString&&t.hasOwnProperty("docString")&&e.uint32(106).string(t.docString),null!=t.type&&t.hasOwnProperty("type")&&e.uint32(160).int32(t.type),null!=t.refAttrName&&t.hasOwnProperty("refAttrName")&&e.uint32(170).string(t.refAttrName),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e){t instanceof i||(t=i.create(t));for(var n=void 0===e?t.len:t.pos+e,r=new s.onnx.AttributeProto;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:r.name=t.string();break;case 21:r.refAttrName=t.string();break;case 13:r.docString=t.string();break;case 20:r.type=t.int32();break;case 2:r.f=t.float();break;case 3:r.i=t.int64();break;case 4:r.s=t.bytes();break;case 5:r.t=s.onnx.TensorProto.decode(t,t.uint32());break;case 6:r.g=s.onnx.GraphProto.decode(t,t.uint32());break;case 7:if(r.floats&&r.floats.length||(r.floats=[]),2==(7&o))for(var a=t.uint32()+t.pos;t.pos<a;)r.floats.push(t.float());else r.floats.push(t.float());break;case 8:if(r.ints&&r.ints.length||(r.ints=[]),2==(7&o))for(a=t.uint32()+t.pos;t.pos<a;)r.ints.push(t.int64());else r.ints.push(t.int64());break;case 9:r.strings&&r.strings.length||(r.strings=[]),r.strings.push(t.bytes());break;case 10:r.tensors&&r.tensors.length||(r.tensors=[]),r.tensors.push(s.onnx.TensorProto.decode(t,t.uint32()));break;case 11:r.graphs&&r.graphs.length||(r.graphs=[]),r.graphs.push(s.onnx.GraphProto.decode(t,t.uint32()));break;default:t.skipType(7&o)}}return r},t.decodeDelimited=function(t){return t instanceof i||(t=new i(t)),this.decode(t,t.uint32())},t.verify=function(t){if("object"!=typeof t||null===t)return"object expected";if(null!=t.name&&t.hasOwnProperty("name")&&!a.isString(t.name))return"name: string expected";if(null!=t.refAttrName&&t.hasOwnProperty("refAttrName")&&!a.isString(t.refAttrName))return"refAttrName: string expected";if(null!=t.docString&&t.hasOwnProperty("docString")&&!a.isString(t.docString))return"docString: string expected";if(null!=t.type&&t.hasOwnProperty("type"))switch(t.type){default:return"type: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:}if(null!=t.f&&t.hasOwnProperty("f")&&"number"!=typeof t.f)return"f: number expected";if(null!=t.i&&t.hasOwnProperty("i")&&!(a.isInteger(t.i)||t.i&&a.isInteger(t.i.low)&&a.isInteger(t.i.high)))return"i: integer|Long expected";if(null!=t.s&&t.hasOwnProperty("s")&&!(t.s&&"number"==typeof t.s.length||a.isString(t.s)))return"s: buffer expected";if(null!=t.t&&t.hasOwnProperty("t")&&(n=s.onnx.TensorProto.verify(t.t)))return"t."+n;if(null!=t.g&&t.hasOwnProperty("g")&&(n=s.onnx.GraphProto.verify(t.g)))return"g."+n;if(null!=t.floats&&t.hasOwnProperty("floats")){if(!Array.isArray(t.floats))return"floats: array expected";for(var e=0;e<t.floats.length;++e)if("number"!=typeof t.floats[e])return"floats: number[] expected"}if(null!=t.ints&&t.hasOwnProperty("ints")){if(!Array.isArray(t.ints))return"ints: array expected";for(e=0;e<t.ints.length;++e)if(!(a.isInteger(t.ints[e])||t.ints[e]&&a.isInteger(t.ints[e].low)&&a.isInteger(t.ints[e].high)))return"ints: integer|Long[] expected"}if(null!=t.strings&&t.hasOwnProperty("strings")){if(!Array.isArray(t.strings))return"strings: array expected";for(e=0;e<t.strings.length;++e)if(!(t.strings[e]&&"number"==typeof t.strings[e].length||a.isString(t.strings[e])))return"strings: buffer[] expected"}if(null!=t.tensors&&t.hasOwnProperty("tensors")){if(!Array.isArray(t.tensors))return"tensors: array expected";for(e=0;e<t.tensors.length;++e)if(n=s.onnx.TensorProto.verify(t.tensors[e]))return"tensors."+n}if(null!=t.graphs&&t.hasOwnProperty("graphs")){if(!Array.isArray(t.graphs))return"graphs: array expected";for(e=0;e<t.graphs.length;++e){var n;if(n=s.onnx.GraphProto.verify(t.graphs[e]))return"graphs."+n}}return null},t.fromObject=function(t){if(t instanceof s.onnx.AttributeProto)return t;var e=new s.onnx.AttributeProto;switch(null!=t.name&&(e.name=String(t.name)),null!=t.refAttrName&&(e.refAttrName=String(t.refAttrName)),null!=t.docString&&(e.docString=String(t.docString)),t.type){case"UNDEFINED":case 0:e.type=0;break;case"FLOAT":case 1:e.type=1;break;case"INT":case 2:e.type=2;break;case"STRING":case 3:e.type=3;break;case"TENSOR":case 4:e.type=4;break;case"GRAPH":case 5:e.type=5;break;case"FLOATS":case 6:e.type=6;break;case"INTS":case 7:e.type=7;break;case"STRINGS":case 8:e.type=8;break;case"TENSORS":case 9:e.type=9;break;case"GRAPHS":case 10:e.type=10}if(null!=t.f&&(e.f=Number(t.f)),null!=t.i&&(a.Long?(e.i=a.Long.fromValue(t.i)).unsigned=!1:"string"==typeof t.i?e.i=parseInt(t.i,10):"number"==typeof t.i?e.i=t.i:"object"==typeof t.i&&(e.i=new a.LongBits(t.i.low>>>0,t.i.high>>>0).toNumber())),null!=t.s&&("string"==typeof t.s?a.base64.decode(t.s,e.s=a.newBuffer(a.base64.length(t.s)),0):t.s.length&&(e.s=t.s)),null!=t.t){if("object"!=typeof t.t)throw TypeError(".onnx.AttributeProto.t: object expected");e.t=s.onnx.TensorProto.fromObject(t.t)}if(null!=t.g){if("object"!=typeof t.g)throw TypeError(".onnx.AttributeProto.g: object expected");e.g=s.onnx.GraphProto.fromObject(t.g)}if(t.floats){if(!Array.isArray(t.floats))throw TypeError(".onnx.AttributeProto.floats: array expected");e.floats=[];for(var n=0;n<t.floats.length;++n)e.floats[n]=Number(t.floats[n])}if(t.ints){if(!Array.isArray(t.ints))throw TypeError(".onnx.AttributeProto.ints: array expected");for(e.ints=[],n=0;n<t.ints.length;++n)a.Long?(e.ints[n]=a.Long.fromValue(t.ints[n])).unsigned=!1:"string"==typeof t.ints[n]?e.ints[n]=parseInt(t.ints[n],10):"number"==typeof t.ints[n]?e.ints[n]=t.ints[n]:"object"==typeof t.ints[n]&&(e.ints[n]=new a.LongBits(t.ints[n].low>>>0,t.ints[n].high>>>0).toNumber())}if(t.strings){if(!Array.isArray(t.strings))throw TypeError(".onnx.AttributeProto.strings: array expected");for(e.strings=[],n=0;n<t.strings.length;++n)"string"==typeof t.strings[n]?a.base64.decode(t.strings[n],e.strings[n]=a.newBuffer(a.base64.length(t.strings[n])),0):t.strings[n].length&&(e.strings[n]=t.strings[n])}if(t.tensors){if(!Array.isArray(t.tensors))throw TypeError(".onnx.AttributeProto.tensors: array expected");for(e.tensors=[],n=0;n<t.tensors.length;++n){if("object"!=typeof t.tensors[n])throw TypeError(".onnx.AttributeProto.tensors: object expected");e.tensors[n]=s.onnx.TensorProto.fromObject(t.tensors[n])}}if(t.graphs){if(!Array.isArray(t.graphs))throw TypeError(".onnx.AttributeProto.graphs: array expected");for(e.graphs=[],n=0;n<t.graphs.length;++n){if("object"!=typeof t.graphs[n])throw TypeError(".onnx.AttributeProto.graphs: object expected");e.graphs[n]=s.onnx.GraphProto.fromObject(t.graphs[n])}}return e},t.toObject=function(t,e){e||(e={});var n={};if((e.arrays||e.defaults)&&(n.floats=[],n.ints=[],n.strings=[],n.tensors=[],n.graphs=[]),e.defaults){if(n.name="",n.f=0,a.Long){var r=new a.Long(0,0,!1);n.i=e.longs===String?r.toString():e.longs===Number?r.toNumber():r}else n.i=e.longs===String?"0":0;e.bytes===String?n.s="":(n.s=[],e.bytes!==Array&&(n.s=a.newBuffer(n.s))),n.t=null,n.g=null,n.docString="",n.type=e.enums===String?"UNDEFINED":0,n.refAttrName=""}if(null!=t.name&&t.hasOwnProperty("name")&&(n.name=t.name),null!=t.f&&t.hasOwnProperty("f")&&(n.f=e.json&&!isFinite(t.f)?String(t.f):t.f),null!=t.i&&t.hasOwnProperty("i")&&("number"==typeof t.i?n.i=e.longs===String?String(t.i):t.i:n.i=e.longs===String?a.Long.prototype.toString.call(t.i):e.longs===Number?new a.LongBits(t.i.low>>>0,t.i.high>>>0).toNumber():t.i),null!=t.s&&t.hasOwnProperty("s")&&(n.s=e.bytes===String?a.base64.encode(t.s,0,t.s.length):e.bytes===Array?Array.prototype.slice.call(t.s):t.s),null!=t.t&&t.hasOwnProperty("t")&&(n.t=s.onnx.TensorProto.toObject(t.t,e)),null!=t.g&&t.hasOwnProperty("g")&&(n.g=s.onnx.GraphProto.toObject(t.g,e)),t.floats&&t.floats.length){n.floats=[];for(var i=0;i<t.floats.length;++i)n.floats[i]=e.json&&!isFinite(t.floats[i])?String(t.floats[i]):t.floats[i]}if(t.ints&&t.ints.length)for(n.ints=[],i=0;i<t.ints.length;++i)"number"==typeof t.ints[i]?n.ints[i]=e.longs===String?String(t.ints[i]):t.ints[i]:n.ints[i]=e.longs===String?a.Long.prototype.toString.call(t.ints[i]):e.longs===Number?new a.LongBits(t.ints[i].low>>>0,t.ints[i].high>>>0).toNumber():t.ints[i];if(t.strings&&t.strings.length)for(n.strings=[],i=0;i<t.strings.length;++i)n.strings[i]=e.bytes===String?a.base64.encode(t.strings[i],0,t.strings[i].length):e.bytes===Array?Array.prototype.slice.call(t.strings[i]):t.strings[i];if(t.tensors&&t.tensors.length)for(n.tensors=[],i=0;i<t.tensors.length;++i)n.tensors[i]=s.onnx.TensorProto.toObject(t.tensors[i],e);if(t.graphs&&t.graphs.length)for(n.graphs=[],i=0;i<t.graphs.length;++i)n.graphs[i]=s.onnx.GraphProto.toObject(t.graphs[i],e);return null!=t.docString&&t.hasOwnProperty("docString")&&(n.docString=t.docString),null!=t.type&&t.hasOwnProperty("type")&&(n.type=e.enums===String?s.onnx.AttributeProto.AttributeType[t.type]:t.type),null!=t.refAttrName&&t.hasOwnProperty("refAttrName")&&(n.refAttrName=t.refAttrName),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},t.AttributeType=function(){var t={},e=Object.create(t);return e[t[0]="UNDEFINED"]=0,e[t[1]="FLOAT"]=1,e[t[2]="INT"]=2,e[t[3]="STRING"]=3,e[t[4]="TENSOR"]=4,e[t[5]="GRAPH"]=5,e[t[6]="FLOATS"]=6,e[t[7]="INTS"]=7,e[t[8]="STRINGS"]=8,e[t[9]="TENSORS"]=9,e[t[10]="GRAPHS"]=10,e}(),t}(),n.ValueInfoProto=function(){function t(t){if(t)for(var e=Object.keys(t),n=0;n<e.length;++n)null!=t[e[n]]&&(this[e[n]]=t[e[n]])}return t.prototype.name="",t.prototype.type=null,t.prototype.docString="",t.create=function(e){return new t(e)},t.encode=function(t,e){return e||(e=o.create()),null!=t.name&&t.hasOwnProperty("name")&&e.uint32(10).string(t.name),null!=t.type&&t.hasOwnProperty("type")&&s.onnx.TypeProto.encode(t.type,e.uint32(18).fork()).ldelim(),null!=t.docString&&t.hasOwnProperty("docString")&&e.uint32(26).string(t.docString),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e){t instanceof i||(t=i.create(t));for(var n=void 0===e?t.len:t.pos+e,r=new s.onnx.ValueInfoProto;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:r.name=t.string();break;case 2:r.type=s.onnx.TypeProto.decode(t,t.uint32());break;case 3:r.docString=t.string();break;default:t.skipType(7&o)}}return r},t.decodeDelimited=function(t){return t instanceof i||(t=new i(t)),this.decode(t,t.uint32())},t.verify=function(t){if("object"!=typeof t||null===t)return"object expected";if(null!=t.name&&t.hasOwnProperty("name")&&!a.isString(t.name))return"name: string expected";if(null!=t.type&&t.hasOwnProperty("type")){var e=s.onnx.TypeProto.verify(t.type);if(e)return"type."+e}return null!=t.docString&&t.hasOwnProperty("docString")&&!a.isString(t.docString)?"docString: string expected":null},t.fromObject=function(t){if(t instanceof s.onnx.ValueInfoProto)return t;var e=new s.onnx.ValueInfoProto;if(null!=t.name&&(e.name=String(t.name)),null!=t.type){if("object"!=typeof t.type)throw TypeError(".onnx.ValueInfoProto.type: object expected");e.type=s.onnx.TypeProto.fromObject(t.type)}return null!=t.docString&&(e.docString=String(t.docString)),e},t.toObject=function(t,e){e||(e={});var n={};return e.defaults&&(n.name="",n.type=null,n.docString=""),null!=t.name&&t.hasOwnProperty("name")&&(n.name=t.name),null!=t.type&&t.hasOwnProperty("type")&&(n.type=s.onnx.TypeProto.toObject(t.type,e)),null!=t.docString&&t.hasOwnProperty("docString")&&(n.docString=t.docString),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},t}(),n.NodeProto=function(){function t(t){if(this.input=[],this.output=[],this.attribute=[],t)for(var e=Object.keys(t),n=0;n<e.length;++n)null!=t[e[n]]&&(this[e[n]]=t[e[n]])}return t.prototype.input=a.emptyArray,t.prototype.output=a.emptyArray,t.prototype.name="",t.prototype.opType="",t.prototype.domain="",t.prototype.attribute=a.emptyArray,t.prototype.docString="",t.create=function(e){return new t(e)},t.encode=function(t,e){if(e||(e=o.create()),null!=t.input&&t.input.length)for(var n=0;n<t.input.length;++n)e.uint32(10).string(t.input[n]);if(null!=t.output&&t.output.length)for(n=0;n<t.output.length;++n)e.uint32(18).string(t.output[n]);if(null!=t.name&&t.hasOwnProperty("name")&&e.uint32(26).string(t.name),null!=t.opType&&t.hasOwnProperty("opType")&&e.uint32(34).string(t.opType),null!=t.attribute&&t.attribute.length)for(n=0;n<t.attribute.length;++n)s.onnx.AttributeProto.encode(t.attribute[n],e.uint32(42).fork()).ldelim();return null!=t.docString&&t.hasOwnProperty("docString")&&e.uint32(50).string(t.docString),null!=t.domain&&t.hasOwnProperty("domain")&&e.uint32(58).string(t.domain),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e){t instanceof i||(t=i.create(t));for(var n=void 0===e?t.len:t.pos+e,r=new s.onnx.NodeProto;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:r.input&&r.input.length||(r.input=[]),r.input.push(t.string());break;case 2:r.output&&r.output.length||(r.output=[]),r.output.push(t.string());break;case 3:r.name=t.string();break;case 4:r.opType=t.string();break;case 7:r.domain=t.string();break;case 5:r.attribute&&r.attribute.length||(r.attribute=[]),r.attribute.push(s.onnx.AttributeProto.decode(t,t.uint32()));break;case 6:r.docString=t.string();break;default:t.skipType(7&o)}}return r},t.decodeDelimited=function(t){return t instanceof i||(t=new i(t)),this.decode(t,t.uint32())},t.verify=function(t){if("object"!=typeof t||null===t)return"object expected";if(null!=t.input&&t.hasOwnProperty("input")){if(!Array.isArray(t.input))return"input: array expected";for(var e=0;e<t.input.length;++e)if(!a.isString(t.input[e]))return"input: string[] expected"}if(null!=t.output&&t.hasOwnProperty("output")){if(!Array.isArray(t.output))return"output: array expected";for(e=0;e<t.output.length;++e)if(!a.isString(t.output[e]))return"output: string[] expected"}if(null!=t.name&&t.hasOwnProperty("name")&&!a.isString(t.name))return"name: string expected";if(null!=t.opType&&t.hasOwnProperty("opType")&&!a.isString(t.opType))return"opType: string expected";if(null!=t.domain&&t.hasOwnProperty("domain")&&!a.isString(t.domain))return"domain: string expected";if(null!=t.attribute&&t.hasOwnProperty("attribute")){if(!Array.isArray(t.attribute))return"attribute: array expected";for(e=0;e<t.attribute.length;++e){var n=s.onnx.AttributeProto.verify(t.attribute[e]);if(n)return"attribute."+n}}return null!=t.docString&&t.hasOwnProperty("docString")&&!a.isString(t.docString)?"docString: string expected":null},t.fromObject=function(t){if(t instanceof s.onnx.NodeProto)return t;var e=new s.onnx.NodeProto;if(t.input){if(!Array.isArray(t.input))throw TypeError(".onnx.NodeProto.input: array expected");e.input=[];for(var n=0;n<t.input.length;++n)e.input[n]=String(t.input[n])}if(t.output){if(!Array.isArray(t.output))throw TypeError(".onnx.NodeProto.output: array expected");for(e.output=[],n=0;n<t.output.length;++n)e.output[n]=String(t.output[n])}if(null!=t.name&&(e.name=String(t.name)),null!=t.opType&&(e.opType=String(t.opType)),null!=t.domain&&(e.domain=String(t.domain)),t.attribute){if(!Array.isArray(t.attribute))throw TypeError(".onnx.NodeProto.attribute: array expected");for(e.attribute=[],n=0;n<t.attribute.length;++n){if("object"!=typeof t.attribute[n])throw TypeError(".onnx.NodeProto.attribute: object expected");e.attribute[n]=s.onnx.AttributeProto.fromObject(t.attribute[n])}}return null!=t.docString&&(e.docString=String(t.docString)),e},t.toObject=function(t,e){e||(e={});var n={};if((e.arrays||e.defaults)&&(n.input=[],n.output=[],n.attribute=[]),e.defaults&&(n.name="",n.opType="",n.docString="",n.domain=""),t.input&&t.input.length){n.input=[];for(var r=0;r<t.input.length;++r)n.input[r]=t.input[r]}if(t.output&&t.output.length)for(n.output=[],r=0;r<t.output.length;++r)n.output[r]=t.output[r];if(null!=t.name&&t.hasOwnProperty("name")&&(n.name=t.name),null!=t.opType&&t.hasOwnProperty("opType")&&(n.opType=t.opType),t.attribute&&t.attribute.length)for(n.attribute=[],r=0;r<t.attribute.length;++r)n.attribute[r]=s.onnx.AttributeProto.toObject(t.attribute[r],e);return null!=t.docString&&t.hasOwnProperty("docString")&&(n.docString=t.docString),null!=t.domain&&t.hasOwnProperty("domain")&&(n.domain=t.domain),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},t}(),n.ModelProto=function(){function t(t){if(this.opsetImport=[],this.metadataProps=[],t)for(var e=Object.keys(t),n=0;n<e.length;++n)null!=t[e[n]]&&(this[e[n]]=t[e[n]])}return t.prototype.irVersion=a.Long?a.Long.fromBits(0,0,!1):0,t.prototype.opsetImport=a.emptyArray,t.prototype.producerName="",t.prototype.producerVersion="",t.prototype.domain="",t.prototype.modelVersion=a.Long?a.Long.fromBits(0,0,!1):0,t.prototype.docString="",t.prototype.graph=null,t.prototype.metadataProps=a.emptyArray,t.create=function(e){return new t(e)},t.encode=function(t,e){if(e||(e=o.create()),null!=t.irVersion&&t.hasOwnProperty("irVersion")&&e.uint32(8).int64(t.irVersion),null!=t.producerName&&t.hasOwnProperty("producerName")&&e.uint32(18).string(t.producerName),null!=t.producerVersion&&t.hasOwnProperty("producerVersion")&&e.uint32(26).string(t.producerVersion),null!=t.domain&&t.hasOwnProperty("domain")&&e.uint32(34).string(t.domain),null!=t.modelVersion&&t.hasOwnProperty("modelVersion")&&e.uint32(40).int64(t.modelVersion),null!=t.docString&&t.hasOwnProperty("docString")&&e.uint32(50).string(t.docString),null!=t.graph&&t.hasOwnProperty("graph")&&s.onnx.GraphProto.encode(t.graph,e.uint32(58).fork()).ldelim(),null!=t.opsetImport&&t.opsetImport.length)for(var n=0;n<t.opsetImport.length;++n)s.onnx.OperatorSetIdProto.encode(t.opsetImport[n],e.uint32(66).fork()).ldelim();if(null!=t.metadataProps&&t.metadataProps.length)for(n=0;n<t.metadataProps.length;++n)s.onnx.StringStringEntryProto.encode(t.metadataProps[n],e.uint32(114).fork()).ldelim();return e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e){t instanceof i||(t=i.create(t));for(var n=void 0===e?t.len:t.pos+e,r=new s.onnx.ModelProto;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:r.irVersion=t.int64();break;case 8:r.opsetImport&&r.opsetImport.length||(r.opsetImport=[]),r.opsetImport.push(s.onnx.OperatorSetIdProto.decode(t,t.uint32()));break;case 2:r.producerName=t.string();break;case 3:r.producerVersion=t.string();break;case 4:r.domain=t.string();break;case 5:r.modelVersion=t.int64();break;case 6:r.docString=t.string();break;case 7:r.graph=s.onnx.GraphProto.decode(t,t.uint32());break;case 14:r.metadataProps&&r.metadataProps.length||(r.metadataProps=[]),r.metadataProps.push(s.onnx.StringStringEntryProto.decode(t,t.uint32()));break;default:t.skipType(7&o)}}return r},t.decodeDelimited=function(t){return t instanceof i||(t=new i(t)),this.decode(t,t.uint32())},t.verify=function(t){if("object"!=typeof t||null===t)return"object expected";if(null!=t.irVersion&&t.hasOwnProperty("irVersion")&&!(a.isInteger(t.irVersion)||t.irVersion&&a.isInteger(t.irVersion.low)&&a.isInteger(t.irVersion.high)))return"irVersion: integer|Long expected";if(null!=t.opsetImport&&t.hasOwnProperty("opsetImport")){if(!Array.isArray(t.opsetImport))return"opsetImport: array expected";for(var e=0;e<t.opsetImport.length;++e)if(n=s.onnx.OperatorSetIdProto.verify(t.opsetImport[e]))return"opsetImport."+n}if(null!=t.producerName&&t.hasOwnProperty("producerName")&&!a.isString(t.producerName))return"producerName: string expected";if(null!=t.producerVersion&&t.hasOwnProperty("producerVersion")&&!a.isString(t.producerVersion))return"producerVersion: string expected";if(null!=t.domain&&t.hasOwnProperty("domain")&&!a.isString(t.domain))return"domain: string expected";if(null!=t.modelVersion&&t.hasOwnProperty("modelVersion")&&!(a.isInteger(t.modelVersion)||t.modelVersion&&a.isInteger(t.modelVersion.low)&&a.isInteger(t.modelVersion.high)))return"modelVersion: integer|Long expected";if(null!=t.docString&&t.hasOwnProperty("docString")&&!a.isString(t.docString))return"docString: string expected";if(null!=t.graph&&t.hasOwnProperty("graph")&&(n=s.onnx.GraphProto.verify(t.graph)))return"graph."+n;if(null!=t.metadataProps&&t.hasOwnProperty("metadataProps")){if(!Array.isArray(t.metadataProps))return"metadataProps: array expected";for(e=0;e<t.metadataProps.length;++e){var n;if(n=s.onnx.StringStringEntryProto.verify(t.metadataProps[e]))return"metadataProps."+n}}return null},t.fromObject=function(t){if(t instanceof s.onnx.ModelProto)return t;var e=new s.onnx.ModelProto;if(null!=t.irVersion&&(a.Long?(e.irVersion=a.Long.fromValue(t.irVersion)).unsigned=!1:"string"==typeof t.irVersion?e.irVersion=parseInt(t.irVersion,10):"number"==typeof t.irVersion?e.irVersion=t.irVersion:"object"==typeof t.irVersion&&(e.irVersion=new a.LongBits(t.irVersion.low>>>0,t.irVersion.high>>>0).toNumber())),t.opsetImport){if(!Array.isArray(t.opsetImport))throw TypeError(".onnx.ModelProto.opsetImport: array expected");e.opsetImport=[];for(var n=0;n<t.opsetImport.length;++n){if("object"!=typeof t.opsetImport[n])throw TypeError(".onnx.ModelProto.opsetImport: object expected");e.opsetImport[n]=s.onnx.OperatorSetIdProto.fromObject(t.opsetImport[n])}}if(null!=t.producerName&&(e.producerName=String(t.producerName)),null!=t.producerVersion&&(e.producerVersion=String(t.producerVersion)),null!=t.domain&&(e.domain=String(t.domain)),null!=t.modelVersion&&(a.Long?(e.modelVersion=a.Long.fromValue(t.modelVersion)).unsigned=!1:"string"==typeof t.modelVersion?e.modelVersion=parseInt(t.modelVersion,10):"number"==typeof t.modelVersion?e.modelVersion=t.modelVersion:"object"==typeof t.modelVersion&&(e.modelVersion=new a.LongBits(t.modelVersion.low>>>0,t.modelVersion.high>>>0).toNumber())),null!=t.docString&&(e.docString=String(t.docString)),null!=t.graph){if("object"!=typeof t.graph)throw TypeError(".onnx.ModelProto.graph: object expected");e.graph=s.onnx.GraphProto.fromObject(t.graph)}if(t.metadataProps){if(!Array.isArray(t.metadataProps))throw TypeError(".onnx.ModelProto.metadataProps: array expected");for(e.metadataProps=[],n=0;n<t.metadataProps.length;++n){if("object"!=typeof t.metadataProps[n])throw TypeError(".onnx.ModelProto.metadataProps: object expected");e.metadataProps[n]=s.onnx.StringStringEntryProto.fromObject(t.metadataProps[n])}}return e},t.toObject=function(t,e){e||(e={});var n={};if((e.arrays||e.defaults)&&(n.opsetImport=[],n.metadataProps=[]),e.defaults){if(a.Long){var r=new a.Long(0,0,!1);n.irVersion=e.longs===String?r.toString():e.longs===Number?r.toNumber():r}else n.irVersion=e.longs===String?"0":0;n.producerName="",n.producerVersion="",n.domain="",a.Long?(r=new a.Long(0,0,!1),n.modelVersion=e.longs===String?r.toString():e.longs===Number?r.toNumber():r):n.modelVersion=e.longs===String?"0":0,n.docString="",n.graph=null}if(null!=t.irVersion&&t.hasOwnProperty("irVersion")&&("number"==typeof t.irVersion?n.irVersion=e.longs===String?String(t.irVersion):t.irVersion:n.irVersion=e.longs===String?a.Long.prototype.toString.call(t.irVersion):e.longs===Number?new a.LongBits(t.irVersion.low>>>0,t.irVersion.high>>>0).toNumber():t.irVersion),null!=t.producerName&&t.hasOwnProperty("producerName")&&(n.producerName=t.producerName),null!=t.producerVersion&&t.hasOwnProperty("producerVersion")&&(n.producerVersion=t.producerVersion),null!=t.domain&&t.hasOwnProperty("domain")&&(n.domain=t.domain),null!=t.modelVersion&&t.hasOwnProperty("modelVersion")&&("number"==typeof t.modelVersion?n.modelVersion=e.longs===String?String(t.modelVersion):t.modelVersion:n.modelVersion=e.longs===String?a.Long.prototype.toString.call(t.modelVersion):e.longs===Number?new a.LongBits(t.modelVersion.low>>>0,t.modelVersion.high>>>0).toNumber():t.modelVersion),null!=t.docString&&t.hasOwnProperty("docString")&&(n.docString=t.docString),null!=t.graph&&t.hasOwnProperty("graph")&&(n.graph=s.onnx.GraphProto.toObject(t.graph,e)),t.opsetImport&&t.opsetImport.length){n.opsetImport=[];for(var i=0;i<t.opsetImport.length;++i)n.opsetImport[i]=s.onnx.OperatorSetIdProto.toObject(t.opsetImport[i],e)}if(t.metadataProps&&t.metadataProps.length)for(n.metadataProps=[],i=0;i<t.metadataProps.length;++i)n.metadataProps[i]=s.onnx.StringStringEntryProto.toObject(t.metadataProps[i],e);return n},t.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},t}(),n.StringStringEntryProto=function(){function t(t){if(t)for(var e=Object.keys(t),n=0;n<e.length;++n)null!=t[e[n]]&&(this[e[n]]=t[e[n]])}return t.prototype.key="",t.prototype.value="",t.create=function(e){return new t(e)},t.encode=function(t,e){return e||(e=o.create()),null!=t.key&&t.hasOwnProperty("key")&&e.uint32(10).string(t.key),null!=t.value&&t.hasOwnProperty("value")&&e.uint32(18).string(t.value),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e){t instanceof i||(t=i.create(t));for(var n=void 0===e?t.len:t.pos+e,r=new s.onnx.StringStringEntryProto;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:r.key=t.string();break;case 2:r.value=t.string();break;default:t.skipType(7&o)}}return r},t.decodeDelimited=function(t){return t instanceof i||(t=new i(t)),this.decode(t,t.uint32())},t.verify=function(t){return"object"!=typeof t||null===t?"object expected":null!=t.key&&t.hasOwnProperty("key")&&!a.isString(t.key)?"key: string expected":null!=t.value&&t.hasOwnProperty("value")&&!a.isString(t.value)?"value: string expected":null},t.fromObject=function(t){if(t instanceof s.onnx.StringStringEntryProto)return t;var e=new s.onnx.StringStringEntryProto;return null!=t.key&&(e.key=String(t.key)),null!=t.value&&(e.value=String(t.value)),e},t.toObject=function(t,e){e||(e={});var n={};return e.defaults&&(n.key="",n.value=""),null!=t.key&&t.hasOwnProperty("key")&&(n.key=t.key),null!=t.value&&t.hasOwnProperty("value")&&(n.value=t.value),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},t}(),n.TensorAnnotation=function(){function t(t){if(this.quantParameterTensorNames=[],t)for(var e=Object.keys(t),n=0;n<e.length;++n)null!=t[e[n]]&&(this[e[n]]=t[e[n]])}return t.prototype.tensorName="",t.prototype.quantParameterTensorNames=a.emptyArray,t.create=function(e){return new t(e)},t.encode=function(t,e){if(e||(e=o.create()),null!=t.tensorName&&t.hasOwnProperty("tensorName")&&e.uint32(10).string(t.tensorName),null!=t.quantParameterTensorNames&&t.quantParameterTensorNames.length)for(var n=0;n<t.quantParameterTensorNames.length;++n)s.onnx.StringStringEntryProto.encode(t.quantParameterTensorNames[n],e.uint32(18).fork()).ldelim();return e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e){t instanceof i||(t=i.create(t));for(var n=void 0===e?t.len:t.pos+e,r=new s.onnx.TensorAnnotation;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:r.tensorName=t.string();break;case 2:r.quantParameterTensorNames&&r.quantParameterTensorNames.length||(r.quantParameterTensorNames=[]),r.quantParameterTensorNames.push(s.onnx.StringStringEntryProto.decode(t,t.uint32()));break;default:t.skipType(7&o)}}return r},t.decodeDelimited=function(t){return t instanceof i||(t=new i(t)),this.decode(t,t.uint32())},t.verify=function(t){if("object"!=typeof t||null===t)return"object expected";if(null!=t.tensorName&&t.hasOwnProperty("tensorName")&&!a.isString(t.tensorName))return"tensorName: string expected";if(null!=t.quantParameterTensorNames&&t.hasOwnProperty("quantParameterTensorNames")){if(!Array.isArray(t.quantParameterTensorNames))return"quantParameterTensorNames: array expected";for(var e=0;e<t.quantParameterTensorNames.length;++e){var n=s.onnx.StringStringEntryProto.verify(t.quantParameterTensorNames[e]);if(n)return"quantParameterTensorNames."+n}}return null},t.fromObject=function(t){if(t instanceof s.onnx.TensorAnnotation)return t;var e=new s.onnx.TensorAnnotation;if(null!=t.tensorName&&(e.tensorName=String(t.tensorName)),t.quantParameterTensorNames){if(!Array.isArray(t.quantParameterTensorNames))throw TypeError(".onnx.TensorAnnotation.quantParameterTensorNames: array expected");e.quantParameterTensorNames=[];for(var n=0;n<t.quantParameterTensorNames.length;++n){if("object"!=typeof t.quantParameterTensorNames[n])throw TypeError(".onnx.TensorAnnotation.quantParameterTensorNames: object expected");e.quantParameterTensorNames[n]=s.onnx.StringStringEntryProto.fromObject(t.quantParameterTensorNames[n])}}return e},t.toObject=function(t,e){e||(e={});var n={};if((e.arrays||e.defaults)&&(n.quantParameterTensorNames=[]),e.defaults&&(n.tensorName=""),null!=t.tensorName&&t.hasOwnProperty("tensorName")&&(n.tensorName=t.tensorName),t.quantParameterTensorNames&&t.quantParameterTensorNames.length){n.quantParameterTensorNames=[];for(var r=0;r<t.quantParameterTensorNames.length;++r)n.quantParameterTensorNames[r]=s.onnx.StringStringEntryProto.toObject(t.quantParameterTensorNames[r],e)}return n},t.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},t}(),n.GraphProto=function(){function t(t){if(this.node=[],this.initializer=[],this.input=[],this.output=[],this.valueInfo=[],this.quantizationAnnotation=[],t)for(var e=Object.keys(t),n=0;n<e.length;++n)null!=t[e[n]]&&(this[e[n]]=t[e[n]])}return t.prototype.node=a.emptyArray,t.prototype.name="",t.prototype.initializer=a.emptyArray,t.prototype.docString="",t.prototype.input=a.emptyArray,t.prototype.output=a.emptyArray,t.prototype.valueInfo=a.emptyArray,t.prototype.quantizationAnnotation=a.emptyArray,t.create=function(e){return new t(e)},t.encode=function(t,e){if(e||(e=o.create()),null!=t.node&&t.node.length)for(var n=0;n<t.node.length;++n)s.onnx.NodeProto.encode(t.node[n],e.uint32(10).fork()).ldelim();if(null!=t.name&&t.hasOwnProperty("name")&&e.uint32(18).string(t.name),null!=t.initializer&&t.initializer.length)for(n=0;n<t.initializer.length;++n)s.onnx.TensorProto.encode(t.initializer[n],e.uint32(42).fork()).ldelim();if(null!=t.docString&&t.hasOwnProperty("docString")&&e.uint32(82).string(t.docString),null!=t.input&&t.input.length)for(n=0;n<t.input.length;++n)s.onnx.ValueInfoProto.encode(t.input[n],e.uint32(90).fork()).ldelim();if(null!=t.output&&t.output.length)for(n=0;n<t.output.length;++n)s.onnx.ValueInfoProto.encode(t.output[n],e.uint32(98).fork()).ldelim();if(null!=t.valueInfo&&t.valueInfo.length)for(n=0;n<t.valueInfo.length;++n)s.onnx.ValueInfoProto.encode(t.valueInfo[n],e.uint32(106).fork()).ldelim();if(null!=t.quantizationAnnotation&&t.quantizationAnnotation.length)for(n=0;n<t.quantizationAnnotation.length;++n)s.onnx.TensorAnnotation.encode(t.quantizationAnnotation[n],e.uint32(114).fork()).ldelim();return e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e){t instanceof i||(t=i.create(t));for(var n=void 0===e?t.len:t.pos+e,r=new s.onnx.GraphProto;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:r.node&&r.node.length||(r.node=[]),r.node.push(s.onnx.NodeProto.decode(t,t.uint32()));break;case 2:r.name=t.string();break;case 5:r.initializer&&r.initializer.length||(r.initializer=[]),r.initializer.push(s.onnx.TensorProto.decode(t,t.uint32()));break;case 10:r.docString=t.string();break;case 11:r.input&&r.input.length||(r.input=[]),r.input.push(s.onnx.ValueInfoProto.decode(t,t.uint32()));break;case 12:r.output&&r.output.length||(r.output=[]),r.output.push(s.onnx.ValueInfoProto.decode(t,t.uint32()));break;case 13:r.valueInfo&&r.valueInfo.length||(r.valueInfo=[]),r.valueInfo.push(s.onnx.ValueInfoProto.decode(t,t.uint32()));break;case 14:r.quantizationAnnotation&&r.quantizationAnnotation.length||(r.quantizationAnnotation=[]),r.quantizationAnnotation.push(s.onnx.TensorAnnotation.decode(t,t.uint32()));break;default:t.skipType(7&o)}}return r},t.decodeDelimited=function(t){return t instanceof i||(t=new i(t)),this.decode(t,t.uint32())},t.verify=function(t){if("object"!=typeof t||null===t)return"object expected";if(null!=t.node&&t.hasOwnProperty("node")){if(!Array.isArray(t.node))return"node: array expected";for(var e=0;e<t.node.length;++e)if(n=s.onnx.NodeProto.verify(t.node[e]))return"node."+n}if(null!=t.name&&t.hasOwnProperty("name")&&!a.isString(t.name))return"name: string expected";if(null!=t.initializer&&t.hasOwnProperty("initializer")){if(!Array.isArray(t.initializer))return"initializer: array expected";for(e=0;e<t.initializer.length;++e)if(n=s.onnx.TensorProto.verify(t.initializer[e]))return"initializer."+n}if(null!=t.docString&&t.hasOwnProperty("docString")&&!a.isString(t.docString))return"docString: string expected";if(null!=t.input&&t.hasOwnProperty("input")){if(!Array.isArray(t.input))return"input: array expected";for(e=0;e<t.input.length;++e)if(n=s.onnx.ValueInfoProto.verify(t.input[e]))return"input."+n}if(null!=t.output&&t.hasOwnProperty("output")){if(!Array.isArray(t.output))return"output: array expected";for(e=0;e<t.output.length;++e)if(n=s.onnx.ValueInfoProto.verify(t.output[e]))return"output."+n}if(null!=t.valueInfo&&t.hasOwnProperty("valueInfo")){if(!Array.isArray(t.valueInfo))return"valueInfo: array expected";for(e=0;e<t.valueInfo.length;++e)if(n=s.onnx.ValueInfoProto.verify(t.valueInfo[e]))return"valueInfo."+n}if(null!=t.quantizationAnnotation&&t.hasOwnProperty("quantizationAnnotation")){if(!Array.isArray(t.quantizationAnnotation))return"quantizationAnnotation: array expected";for(e=0;e<t.quantizationAnnotation.length;++e){var n;if(n=s.onnx.TensorAnnotation.verify(t.quantizationAnnotation[e]))return"quantizationAnnotation."+n}}return null},t.fromObject=function(t){if(t instanceof s.onnx.GraphProto)return t;var e=new s.onnx.GraphProto;if(t.node){if(!Array.isArray(t.node))throw TypeError(".onnx.GraphProto.node: array expected");e.node=[];for(var n=0;n<t.node.length;++n){if("object"!=typeof t.node[n])throw TypeError(".onnx.GraphProto.node: object expected");e.node[n]=s.onnx.NodeProto.fromObject(t.node[n])}}if(null!=t.name&&(e.name=String(t.name)),t.initializer){if(!Array.isArray(t.initializer))throw TypeError(".onnx.GraphProto.initializer: array expected");for(e.initializer=[],n=0;n<t.initializer.length;++n){if("object"!=typeof t.initializer[n])throw TypeError(".onnx.GraphProto.initializer: object expected");e.initializer[n]=s.onnx.TensorProto.fromObject(t.initializer[n])}}if(null!=t.docString&&(e.docString=String(t.docString)),t.input){if(!Array.isArray(t.input))throw TypeError(".onnx.GraphProto.input: array expected");for(e.input=[],n=0;n<t.input.length;++n){if("object"!=typeof t.input[n])throw TypeError(".onnx.GraphProto.input: object expected");e.input[n]=s.onnx.ValueInfoProto.fromObject(t.input[n])}}if(t.output){if(!Array.isArray(t.output))throw TypeError(".onnx.GraphProto.output: array expected");for(e.output=[],n=0;n<t.output.length;++n){if("object"!=typeof t.output[n])throw TypeError(".onnx.GraphProto.output: object expected");e.output[n]=s.onnx.ValueInfoProto.fromObject(t.output[n])}}if(t.valueInfo){if(!Array.isArray(t.valueInfo))throw TypeError(".onnx.GraphProto.valueInfo: array expected");for(e.valueInfo=[],n=0;n<t.valueInfo.length;++n){if("object"!=typeof t.valueInfo[n])throw TypeError(".onnx.GraphProto.valueInfo: object expected");e.valueInfo[n]=s.onnx.ValueInfoProto.fromObject(t.valueInfo[n])}}if(t.quantizationAnnotation){if(!Array.isArray(t.quantizationAnnotation))throw TypeError(".onnx.GraphProto.quantizationAnnotation: array expected");for(e.quantizationAnnotation=[],n=0;n<t.quantizationAnnotation.length;++n){if("object"!=typeof t.quantizationAnnotation[n])throw TypeError(".onnx.GraphProto.quantizationAnnotation: object expected");e.quantizationAnnotation[n]=s.onnx.TensorAnnotation.fromObject(t.quantizationAnnotation[n])}}return e},t.toObject=function(t,e){e||(e={});var n={};if((e.arrays||e.defaults)&&(n.node=[],n.initializer=[],n.input=[],n.output=[],n.valueInfo=[],n.quantizationAnnotation=[]),e.defaults&&(n.name="",n.docString=""),t.node&&t.node.length){n.node=[];for(var r=0;r<t.node.length;++r)n.node[r]=s.onnx.NodeProto.toObject(t.node[r],e)}if(null!=t.name&&t.hasOwnProperty("name")&&(n.name=t.name),t.initializer&&t.initializer.length)for(n.initializer=[],r=0;r<t.initializer.length;++r)n.initializer[r]=s.onnx.TensorProto.toObject(t.initializer[r],e);if(null!=t.docString&&t.hasOwnProperty("docString")&&(n.docString=t.docString),t.input&&t.input.length)for(n.input=[],r=0;r<t.input.length;++r)n.input[r]=s.onnx.ValueInfoProto.toObject(t.input[r],e);if(t.output&&t.output.length)for(n.output=[],r=0;r<t.output.length;++r)n.output[r]=s.onnx.ValueInfoProto.toObject(t.output[r],e);if(t.valueInfo&&t.valueInfo.length)for(n.valueInfo=[],r=0;r<t.valueInfo.length;++r)n.valueInfo[r]=s.onnx.ValueInfoProto.toObject(t.valueInfo[r],e);if(t.quantizationAnnotation&&t.quantizationAnnotation.length)for(n.quantizationAnnotation=[],r=0;r<t.quantizationAnnotation.length;++r)n.quantizationAnnotation[r]=s.onnx.TensorAnnotation.toObject(t.quantizationAnnotation[r],e);return n},t.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},t}(),n.TensorProto=function(){function t(t){if(this.dims=[],this.floatData=[],this.int32Data=[],this.stringData=[],this.int64Data=[],this.externalData=[],this.doubleData=[],this.uint64Data=[],t)for(var e=Object.keys(t),n=0;n<e.length;++n)null!=t[e[n]]&&(this[e[n]]=t[e[n]])}return t.prototype.dims=a.emptyArray,t.prototype.dataType=0,t.prototype.segment=null,t.prototype.floatData=a.emptyArray,t.prototype.int32Data=a.emptyArray,t.prototype.stringData=a.emptyArray,t.prototype.int64Data=a.emptyArray,t.prototype.name="",t.prototype.docString="",t.prototype.rawData=a.newBuffer([]),t.prototype.externalData=a.emptyArray,t.prototype.dataLocation=0,t.prototype.doubleData=a.emptyArray,t.prototype.uint64Data=a.emptyArray,t.create=function(e){return new t(e)},t.encode=function(t,e){if(e||(e=o.create()),null!=t.dims&&t.dims.length){e.uint32(10).fork();for(var n=0;n<t.dims.length;++n)e.int64(t.dims[n]);e.ldelim()}if(null!=t.dataType&&t.hasOwnProperty("dataType")&&e.uint32(16).int32(t.dataType),null!=t.segment&&t.hasOwnProperty("segment")&&s.onnx.TensorProto.Segment.encode(t.segment,e.uint32(26).fork()).ldelim(),null!=t.floatData&&t.floatData.length){for(e.uint32(34).fork(),n=0;n<t.floatData.length;++n)e.float(t.floatData[n]);e.ldelim()}if(null!=t.int32Data&&t.int32Data.length){for(e.uint32(42).fork(),n=0;n<t.int32Data.length;++n)e.int32(t.int32Data[n]);e.ldelim()}if(null!=t.stringData&&t.stringData.length)for(n=0;n<t.stringData.length;++n)e.uint32(50).bytes(t.stringData[n]);if(null!=t.int64Data&&t.int64Data.length){for(e.uint32(58).fork(),n=0;n<t.int64Data.length;++n)e.int64(t.int64Data[n]);e.ldelim()}if(null!=t.name&&t.hasOwnProperty("name")&&e.uint32(66).string(t.name),null!=t.rawData&&t.hasOwnProperty("rawData")&&e.uint32(74).bytes(t.rawData),null!=t.doubleData&&t.doubleData.length){for(e.uint32(82).fork(),n=0;n<t.doubleData.length;++n)e.double(t.doubleData[n]);e.ldelim()}if(null!=t.uint64Data&&t.uint64Data.length){for(e.uint32(90).fork(),n=0;n<t.uint64Data.length;++n)e.uint64(t.uint64Data[n]);e.ldelim()}if(null!=t.docString&&t.hasOwnProperty("docString")&&e.uint32(98).string(t.docString),null!=t.externalData&&t.externalData.length)for(n=0;n<t.externalData.length;++n)s.onnx.StringStringEntryProto.encode(t.externalData[n],e.uint32(106).fork()).ldelim();return null!=t.dataLocation&&t.hasOwnProperty("dataLocation")&&e.uint32(112).int32(t.dataLocation),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e){t instanceof i||(t=i.create(t));for(var n=void 0===e?t.len:t.pos+e,r=new s.onnx.TensorProto;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:if(r.dims&&r.dims.length||(r.dims=[]),2==(7&o))for(var a=t.uint32()+t.pos;t.pos<a;)r.dims.push(t.int64());else r.dims.push(t.int64());break;case 2:r.dataType=t.int32();break;case 3:r.segment=s.onnx.TensorProto.Segment.decode(t,t.uint32());break;case 4:if(r.floatData&&r.floatData.length||(r.floatData=[]),2==(7&o))for(a=t.uint32()+t.pos;t.pos<a;)r.floatData.push(t.float());else r.floatData.push(t.float());break;case 5:if(r.int32Data&&r.int32Data.length||(r.int32Data=[]),2==(7&o))for(a=t.uint32()+t.pos;t.pos<a;)r.int32Data.push(t.int32());else r.int32Data.push(t.int32());break;case 6:r.stringData&&r.stringData.length||(r.stringData=[]),r.stringData.push(t.bytes());break;case 7:if(r.int64Data&&r.int64Data.length||(r.int64Data=[]),2==(7&o))for(a=t.uint32()+t.pos;t.pos<a;)r.int64Data.push(t.int64());else r.int64Data.push(t.int64());break;case 8:r.name=t.string();break;case 12:r.docString=t.string();break;case 9:r.rawData=t.bytes();break;case 13:r.externalData&&r.externalData.length||(r.externalData=[]),r.externalData.push(s.onnx.StringStringEntryProto.decode(t,t.uint32()));break;case 14:r.dataLocation=t.int32();break;case 10:if(r.doubleData&&r.doubleData.length||(r.doubleData=[]),2==(7&o))for(a=t.uint32()+t.pos;t.pos<a;)r.doubleData.push(t.double());else r.doubleData.push(t.double());break;case 11:if(r.uint64Data&&r.uint64Data.length||(r.uint64Data=[]),2==(7&o))for(a=t.uint32()+t.pos;t.pos<a;)r.uint64Data.push(t.uint64());else r.uint64Data.push(t.uint64());break;default:t.skipType(7&o)}}return r},t.decodeDelimited=function(t){return t instanceof i||(t=new i(t)),this.decode(t,t.uint32())},t.verify=function(t){if("object"!=typeof t||null===t)return"object expected";if(null!=t.dims&&t.hasOwnProperty("dims")){if(!Array.isArray(t.dims))return"dims: array expected";for(var e=0;e<t.dims.length;++e)if(!(a.isInteger(t.dims[e])||t.dims[e]&&a.isInteger(t.dims[e].low)&&a.isInteger(t.dims[e].high)))return"dims: integer|Long[] expected"}if(null!=t.dataType&&t.hasOwnProperty("dataType")&&!a.isInteger(t.dataType))return"dataType: integer expected";if(null!=t.segment&&t.hasOwnProperty("segment")&&(n=s.onnx.TensorProto.Segment.verify(t.segment)))return"segment."+n;if(null!=t.floatData&&t.hasOwnProperty("floatData")){if(!Array.isArray(t.floatData))return"floatData: array expected";for(e=0;e<t.floatData.length;++e)if("number"!=typeof t.floatData[e])return"floatData: number[] expected"}if(null!=t.int32Data&&t.hasOwnProperty("int32Data")){if(!Array.isArray(t.int32Data))return"int32Data: array expected";for(e=0;e<t.int32Data.length;++e)if(!a.isInteger(t.int32Data[e]))return"int32Data: integer[] expected"}if(null!=t.stringData&&t.hasOwnProperty("stringData")){if(!Array.isArray(t.stringData))return"stringData: array expected";for(e=0;e<t.stringData.length;++e)if(!(t.stringData[e]&&"number"==typeof t.stringData[e].length||a.isString(t.stringData[e])))return"stringData: buffer[] expected"}if(null!=t.int64Data&&t.hasOwnProperty("int64Data")){if(!Array.isArray(t.int64Data))return"int64Data: array expected";for(e=0;e<t.int64Data.length;++e)if(!(a.isInteger(t.int64Data[e])||t.int64Data[e]&&a.isInteger(t.int64Data[e].low)&&a.isInteger(t.int64Data[e].high)))return"int64Data: integer|Long[] expected"}if(null!=t.name&&t.hasOwnProperty("name")&&!a.isString(t.name))return"name: string expected";if(null!=t.docString&&t.hasOwnProperty("docString")&&!a.isString(t.docString))return"docString: string expected";if(null!=t.rawData&&t.hasOwnProperty("rawData")&&!(t.rawData&&"number"==typeof t.rawData.length||a.isString(t.rawData)))return"rawData: buffer expected";if(null!=t.externalData&&t.hasOwnProperty("externalData")){if(!Array.isArray(t.externalData))return"externalData: array expected";for(e=0;e<t.externalData.length;++e){var n;if(n=s.onnx.StringStringEntryProto.verify(t.externalData[e]))return"externalData."+n}}if(null!=t.dataLocation&&t.hasOwnProperty("dataLocation"))switch(t.dataLocation){default:return"dataLocation: enum value expected";case 0:case 1:}if(null!=t.doubleData&&t.hasOwnProperty("doubleData")){if(!Array.isArray(t.doubleData))return"doubleData: array expected";for(e=0;e<t.doubleData.length;++e)if("number"!=typeof t.doubleData[e])return"doubleData: number[] expected"}if(null!=t.uint64Data&&t.hasOwnProperty("uint64Data")){if(!Array.isArray(t.uint64Data))return"uint64Data: array expected";for(e=0;e<t.uint64Data.length;++e)if(!(a.isInteger(t.uint64Data[e])||t.uint64Data[e]&&a.isInteger(t.uint64Data[e].low)&&a.isInteger(t.uint64Data[e].high)))return"uint64Data: integer|Long[] expected"}return null},t.fromObject=function(t){if(t instanceof s.onnx.TensorProto)return t;var e=new s.onnx.TensorProto;if(t.dims){if(!Array.isArray(t.dims))throw TypeError(".onnx.TensorProto.dims: array expected");e.dims=[];for(var n=0;n<t.dims.length;++n)a.Long?(e.dims[n]=a.Long.fromValue(t.dims[n])).unsigned=!1:"string"==typeof t.dims[n]?e.dims[n]=parseInt(t.dims[n],10):"number"==typeof t.dims[n]?e.dims[n]=t.dims[n]:"object"==typeof t.dims[n]&&(e.dims[n]=new a.LongBits(t.dims[n].low>>>0,t.dims[n].high>>>0).toNumber())}if(null!=t.dataType&&(e.dataType=0|t.dataType),null!=t.segment){if("object"!=typeof t.segment)throw TypeError(".onnx.TensorProto.segment: object expected");e.segment=s.onnx.TensorProto.Segment.fromObject(t.segment)}if(t.floatData){if(!Array.isArray(t.floatData))throw TypeError(".onnx.TensorProto.floatData: array expected");for(e.floatData=[],n=0;n<t.floatData.length;++n)e.floatData[n]=Number(t.floatData[n])}if(t.int32Data){if(!Array.isArray(t.int32Data))throw TypeError(".onnx.TensorProto.int32Data: array expected");for(e.int32Data=[],n=0;n<t.int32Data.length;++n)e.int32Data[n]=0|t.int32Data[n]}if(t.stringData){if(!Array.isArray(t.stringData))throw TypeError(".onnx.TensorProto.stringData: array expected");for(e.stringData=[],n=0;n<t.stringData.length;++n)"string"==typeof t.stringData[n]?a.base64.decode(t.stringData[n],e.stringData[n]=a.newBuffer(a.base64.length(t.stringData[n])),0):t.stringData[n].length&&(e.stringData[n]=t.stringData[n])}if(t.int64Data){if(!Array.isArray(t.int64Data))throw TypeError(".onnx.TensorProto.int64Data: array expected");for(e.int64Data=[],n=0;n<t.int64Data.length;++n)a.Long?(e.int64Data[n]=a.Long.fromValue(t.int64Data[n])).unsigned=!1:"string"==typeof t.int64Data[n]?e.int64Data[n]=parseInt(t.int64Data[n],10):"number"==typeof t.int64Data[n]?e.int64Data[n]=t.int64Data[n]:"object"==typeof t.int64Data[n]&&(e.int64Data[n]=new a.LongBits(t.int64Data[n].low>>>0,t.int64Data[n].high>>>0).toNumber())}if(null!=t.name&&(e.name=String(t.name)),null!=t.docString&&(e.docString=String(t.docString)),null!=t.rawData&&("string"==typeof t.rawData?a.base64.decode(t.rawData,e.rawData=a.newBuffer(a.base64.length(t.rawData)),0):t.rawData.length&&(e.rawData=t.rawData)),t.externalData){if(!Array.isArray(t.externalData))throw TypeError(".onnx.TensorProto.externalData: array expected");for(e.externalData=[],n=0;n<t.externalData.length;++n){if("object"!=typeof t.externalData[n])throw TypeError(".onnx.TensorProto.externalData: object expected");e.externalData[n]=s.onnx.StringStringEntryProto.fromObject(t.externalData[n])}}switch(t.dataLocation){case"DEFAULT":case 0:e.dataLocation=0;break;case"EXTERNAL":case 1:e.dataLocation=1}if(t.doubleData){if(!Array.isArray(t.doubleData))throw TypeError(".onnx.TensorProto.doubleData: array expected");for(e.doubleData=[],n=0;n<t.doubleData.length;++n)e.doubleData[n]=Number(t.doubleData[n])}if(t.uint64Data){if(!Array.isArray(t.uint64Data))throw TypeError(".onnx.TensorProto.uint64Data: array expected");for(e.uint64Data=[],n=0;n<t.uint64Data.length;++n)a.Long?(e.uint64Data[n]=a.Long.fromValue(t.uint64Data[n])).unsigned=!0:"string"==typeof t.uint64Data[n]?e.uint64Data[n]=parseInt(t.uint64Data[n],10):"number"==typeof t.uint64Data[n]?e.uint64Data[n]=t.uint64Data[n]:"object"==typeof t.uint64Data[n]&&(e.uint64Data[n]=new a.LongBits(t.uint64Data[n].low>>>0,t.uint64Data[n].high>>>0).toNumber(!0))}return e},t.toObject=function(t,e){e||(e={});var n={};if((e.arrays||e.defaults)&&(n.dims=[],n.floatData=[],n.int32Data=[],n.stringData=[],n.int64Data=[],n.doubleData=[],n.uint64Data=[],n.externalData=[]),e.defaults&&(n.dataType=0,n.segment=null,n.name="",e.bytes===String?n.rawData="":(n.rawData=[],e.bytes!==Array&&(n.rawData=a.newBuffer(n.rawData))),n.docString="",n.dataLocation=e.enums===String?"DEFAULT":0),t.dims&&t.dims.length){n.dims=[];for(var r=0;r<t.dims.length;++r)"number"==typeof t.dims[r]?n.dims[r]=e.longs===String?String(t.dims[r]):t.dims[r]:n.dims[r]=e.longs===String?a.Long.prototype.toString.call(t.dims[r]):e.longs===Number?new a.LongBits(t.dims[r].low>>>0,t.dims[r].high>>>0).toNumber():t.dims[r]}if(null!=t.dataType&&t.hasOwnProperty("dataType")&&(n.dataType=t.dataType),null!=t.segment&&t.hasOwnProperty("segment")&&(n.segment=s.onnx.TensorProto.Segment.toObject(t.segment,e)),t.floatData&&t.floatData.length)for(n.floatData=[],r=0;r<t.floatData.length;++r)n.floatData[r]=e.json&&!isFinite(t.floatData[r])?String(t.floatData[r]):t.floatData[r];if(t.int32Data&&t.int32Data.length)for(n.int32Data=[],r=0;r<t.int32Data.length;++r)n.int32Data[r]=t.int32Data[r];if(t.stringData&&t.stringData.length)for(n.stringData=[],r=0;r<t.stringData.length;++r)n.stringData[r]=e.bytes===String?a.base64.encode(t.stringData[r],0,t.stringData[r].length):e.bytes===Array?Array.prototype.slice.call(t.stringData[r]):t.stringData[r];if(t.int64Data&&t.int64Data.length)for(n.int64Data=[],r=0;r<t.int64Data.length;++r)"number"==typeof t.int64Data[r]?n.int64Data[r]=e.longs===String?String(t.int64Data[r]):t.int64Data[r]:n.int64Data[r]=e.longs===String?a.Long.prototype.toString.call(t.int64Data[r]):e.longs===Number?new a.LongBits(t.int64Data[r].low>>>0,t.int64Data[r].high>>>0).toNumber():t.int64Data[r];if(null!=t.name&&t.hasOwnProperty("name")&&(n.name=t.name),null!=t.rawData&&t.hasOwnProperty("rawData")&&(n.rawData=e.bytes===String?a.base64.encode(t.rawData,0,t.rawData.length):e.bytes===Array?Array.prototype.slice.call(t.rawData):t.rawData),t.doubleData&&t.doubleData.length)for(n.doubleData=[],r=0;r<t.doubleData.length;++r)n.doubleData[r]=e.json&&!isFinite(t.doubleData[r])?String(t.doubleData[r]):t.doubleData[r];if(t.uint64Data&&t.uint64Data.length)for(n.uint64Data=[],r=0;r<t.uint64Data.length;++r)"number"==typeof t.uint64Data[r]?n.uint64Data[r]=e.longs===String?String(t.uint64Data[r]):t.uint64Data[r]:n.uint64Data[r]=e.longs===String?a.Long.prototype.toString.call(t.uint64Data[r]):e.longs===Number?new a.LongBits(t.uint64Data[r].low>>>0,t.uint64Data[r].high>>>0).toNumber(!0):t.uint64Data[r];if(null!=t.docString&&t.hasOwnProperty("docString")&&(n.docString=t.docString),t.externalData&&t.externalData.length)for(n.externalData=[],r=0;r<t.externalData.length;++r)n.externalData[r]=s.onnx.StringStringEntryProto.toObject(t.externalData[r],e);return null!=t.dataLocation&&t.hasOwnProperty("dataLocation")&&(n.dataLocation=e.enums===String?s.onnx.TensorProto.DataLocation[t.dataLocation]:t.dataLocation),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},t.DataType=function(){var t={},e=Object.create(t);return e[t[0]="UNDEFINED"]=0,e[t[1]="FLOAT"]=1,e[t[2]="UINT8"]=2,e[t[3]="INT8"]=3,e[t[4]="UINT16"]=4,e[t[5]="INT16"]=5,e[t[6]="INT32"]=6,e[t[7]="INT64"]=7,e[t[8]="STRING"]=8,e[t[9]="BOOL"]=9,e[t[10]="FLOAT16"]=10,e[t[11]="DOUBLE"]=11,e[t[12]="UINT32"]=12,e[t[13]="UINT64"]=13,e[t[14]="COMPLEX64"]=14,e[t[15]="COMPLEX128"]=15,e[t[16]="BFLOAT16"]=16,e}(),t.Segment=function(){function t(t){if(t)for(var e=Object.keys(t),n=0;n<e.length;++n)null!=t[e[n]]&&(this[e[n]]=t[e[n]])}return t.prototype.begin=a.Long?a.Long.fromBits(0,0,!1):0,t.prototype.end=a.Long?a.Long.fromBits(0,0,!1):0,t.create=function(e){return new t(e)},t.encode=function(t,e){return e||(e=o.create()),null!=t.begin&&t.hasOwnProperty("begin")&&e.uint32(8).int64(t.begin),null!=t.end&&t.hasOwnProperty("end")&&e.uint32(16).int64(t.end),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e){t instanceof i||(t=i.create(t));for(var n=void 0===e?t.len:t.pos+e,r=new s.onnx.TensorProto.Segment;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:r.begin=t.int64();break;case 2:r.end=t.int64();break;default:t.skipType(7&o)}}return r},t.decodeDelimited=function(t){return t instanceof i||(t=new i(t)),this.decode(t,t.uint32())},t.verify=function(t){return"object"!=typeof t||null===t?"object expected":null!=t.begin&&t.hasOwnProperty("begin")&&!(a.isInteger(t.begin)||t.begin&&a.isInteger(t.begin.low)&&a.isInteger(t.begin.high))?"begin: integer|Long expected":null!=t.end&&t.hasOwnProperty("end")&&!(a.isInteger(t.end)||t.end&&a.isInteger(t.end.low)&&a.isInteger(t.end.high))?"end: integer|Long expected":null},t.fromObject=function(t){if(t instanceof s.onnx.TensorProto.Segment)return t;var e=new s.onnx.TensorProto.Segment;return null!=t.begin&&(a.Long?(e.begin=a.Long.fromValue(t.begin)).unsigned=!1:"string"==typeof t.begin?e.begin=parseInt(t.begin,10):"number"==typeof t.begin?e.begin=t.begin:"object"==typeof t.begin&&(e.begin=new a.LongBits(t.begin.low>>>0,t.begin.high>>>0).toNumber())),null!=t.end&&(a.Long?(e.end=a.Long.fromValue(t.end)).unsigned=!1:"string"==typeof t.end?e.end=parseInt(t.end,10):"number"==typeof t.end?e.end=t.end:"object"==typeof t.end&&(e.end=new a.LongBits(t.end.low>>>0,t.end.high>>>0).toNumber())),e},t.toObject=function(t,e){e||(e={});var n={};if(e.defaults){if(a.Long){var r=new a.Long(0,0,!1);n.begin=e.longs===String?r.toString():e.longs===Number?r.toNumber():r}else n.begin=e.longs===String?"0":0;a.Long?(r=new a.Long(0,0,!1),n.end=e.longs===String?r.toString():e.longs===Number?r.toNumber():r):n.end=e.longs===String?"0":0}return null!=t.begin&&t.hasOwnProperty("begin")&&("number"==typeof t.begin?n.begin=e.longs===String?String(t.begin):t.begin:n.begin=e.longs===String?a.Long.prototype.toString.call(t.begin):e.longs===Number?new a.LongBits(t.begin.low>>>0,t.begin.high>>>0).toNumber():t.begin),null!=t.end&&t.hasOwnProperty("end")&&("number"==typeof t.end?n.end=e.longs===String?String(t.end):t.end:n.end=e.longs===String?a.Long.prototype.toString.call(t.end):e.longs===Number?new a.LongBits(t.end.low>>>0,t.end.high>>>0).toNumber():t.end),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},t}(),t.DataLocation=function(){var t={},e=Object.create(t);return e[t[0]="DEFAULT"]=0,e[t[1]="EXTERNAL"]=1,e}(),t}(),n.TensorShapeProto=function(){function t(t){if(this.dim=[],t)for(var e=Object.keys(t),n=0;n<e.length;++n)null!=t[e[n]]&&(this[e[n]]=t[e[n]])}return t.prototype.dim=a.emptyArray,t.create=function(e){return new t(e)},t.encode=function(t,e){if(e||(e=o.create()),null!=t.dim&&t.dim.length)for(var n=0;n<t.dim.length;++n)s.onnx.TensorShapeProto.Dimension.encode(t.dim[n],e.uint32(10).fork()).ldelim();return e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e){t instanceof i||(t=i.create(t));for(var n=void 0===e?t.len:t.pos+e,r=new s.onnx.TensorShapeProto;t.pos<n;){var o=t.uint32();o>>>3===1?(r.dim&&r.dim.length||(r.dim=[]),r.dim.push(s.onnx.TensorShapeProto.Dimension.decode(t,t.uint32()))):t.skipType(7&o)}return r},t.decodeDelimited=function(t){return t instanceof i||(t=new i(t)),this.decode(t,t.uint32())},t.verify=function(t){if("object"!=typeof t||null===t)return"object expected";if(null!=t.dim&&t.hasOwnProperty("dim")){if(!Array.isArray(t.dim))return"dim: array expected";for(var e=0;e<t.dim.length;++e){var n=s.onnx.TensorShapeProto.Dimension.verify(t.dim[e]);if(n)return"dim."+n}}return null},t.fromObject=function(t){if(t instanceof s.onnx.TensorShapeProto)return t;var e=new s.onnx.TensorShapeProto;if(t.dim){if(!Array.isArray(t.dim))throw TypeError(".onnx.TensorShapeProto.dim: array expected");e.dim=[];for(var n=0;n<t.dim.length;++n){if("object"!=typeof t.dim[n])throw TypeError(".onnx.TensorShapeProto.dim: object expected");e.dim[n]=s.onnx.TensorShapeProto.Dimension.fromObject(t.dim[n])}}return e},t.toObject=function(t,e){e||(e={});var n={};if((e.arrays||e.defaults)&&(n.dim=[]),t.dim&&t.dim.length){n.dim=[];for(var r=0;r<t.dim.length;++r)n.dim[r]=s.onnx.TensorShapeProto.Dimension.toObject(t.dim[r],e)}return n},t.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},t.Dimension=function(){function t(t){if(t)for(var e=Object.keys(t),n=0;n<e.length;++n)null!=t[e[n]]&&(this[e[n]]=t[e[n]])}var e;return t.prototype.dimValue=a.Long?a.Long.fromBits(0,0,!1):0,t.prototype.dimParam="",t.prototype.denotation="",Object.defineProperty(t.prototype,"value",{get:a.oneOfGetter(e=["dimValue","dimParam"]),set:a.oneOfSetter(e)}),t.create=function(e){return new t(e)},t.encode=function(t,e){return e||(e=o.create()),null!=t.dimValue&&t.hasOwnProperty("dimValue")&&e.uint32(8).int64(t.dimValue),null!=t.dimParam&&t.hasOwnProperty("dimParam")&&e.uint32(18).string(t.dimParam),null!=t.denotation&&t.hasOwnProperty("denotation")&&e.uint32(26).string(t.denotation),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e){t instanceof i||(t=i.create(t));for(var n=void 0===e?t.len:t.pos+e,r=new s.onnx.TensorShapeProto.Dimension;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:r.dimValue=t.int64();break;case 2:r.dimParam=t.string();break;case 3:r.denotation=t.string();break;default:t.skipType(7&o)}}return r},t.decodeDelimited=function(t){return t instanceof i||(t=new i(t)),this.decode(t,t.uint32())},t.verify=function(t){if("object"!=typeof t||null===t)return"object expected";var e={};if(null!=t.dimValue&&t.hasOwnProperty("dimValue")&&(e.value=1,!(a.isInteger(t.dimValue)||t.dimValue&&a.isInteger(t.dimValue.low)&&a.isInteger(t.dimValue.high))))return"dimValue: integer|Long expected";if(null!=t.dimParam&&t.hasOwnProperty("dimParam")){if(1===e.value)return"value: multiple values";if(e.value=1,!a.isString(t.dimParam))return"dimParam: string expected"}return null!=t.denotation&&t.hasOwnProperty("denotation")&&!a.isString(t.denotation)?"denotation: string expected":null},t.fromObject=function(t){if(t instanceof s.onnx.TensorShapeProto.Dimension)return t;var e=new s.onnx.TensorShapeProto.Dimension;return null!=t.dimValue&&(a.Long?(e.dimValue=a.Long.fromValue(t.dimValue)).unsigned=!1:"string"==typeof t.dimValue?e.dimValue=parseInt(t.dimValue,10):"number"==typeof t.dimValue?e.dimValue=t.dimValue:"object"==typeof t.dimValue&&(e.dimValue=new a.LongBits(t.dimValue.low>>>0,t.dimValue.high>>>0).toNumber())),null!=t.dimParam&&(e.dimParam=String(t.dimParam)),null!=t.denotation&&(e.denotation=String(t.denotation)),e},t.toObject=function(t,e){e||(e={});var n={};return e.defaults&&(n.denotation=""),null!=t.dimValue&&t.hasOwnProperty("dimValue")&&("number"==typeof t.dimValue?n.dimValue=e.longs===String?String(t.dimValue):t.dimValue:n.dimValue=e.longs===String?a.Long.prototype.toString.call(t.dimValue):e.longs===Number?new a.LongBits(t.dimValue.low>>>0,t.dimValue.high>>>0).toNumber():t.dimValue,e.oneofs&&(n.value="dimValue")),null!=t.dimParam&&t.hasOwnProperty("dimParam")&&(n.dimParam=t.dimParam,e.oneofs&&(n.value="dimParam")),null!=t.denotation&&t.hasOwnProperty("denotation")&&(n.denotation=t.denotation),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},t}(),t}(),n.TypeProto=function(){function t(t){if(t)for(var e=Object.keys(t),n=0;n<e.length;++n)null!=t[e[n]]&&(this[e[n]]=t[e[n]])}var e;return t.prototype.tensorType=null,t.prototype.denotation="",Object.defineProperty(t.prototype,"value",{get:a.oneOfGetter(e=["tensorType"]),set:a.oneOfSetter(e)}),t.create=function(e){return new t(e)},t.encode=function(t,e){return e||(e=o.create()),null!=t.tensorType&&t.hasOwnProperty("tensorType")&&s.onnx.TypeProto.Tensor.encode(t.tensorType,e.uint32(10).fork()).ldelim(),null!=t.denotation&&t.hasOwnProperty("denotation")&&e.uint32(50).string(t.denotation),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e){t instanceof i||(t=i.create(t));for(var n=void 0===e?t.len:t.pos+e,r=new s.onnx.TypeProto;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:r.tensorType=s.onnx.TypeProto.Tensor.decode(t,t.uint32());break;case 6:r.denotation=t.string();break;default:t.skipType(7&o)}}return r},t.decodeDelimited=function(t){return t instanceof i||(t=new i(t)),this.decode(t,t.uint32())},t.verify=function(t){if("object"!=typeof t||null===t)return"object expected";if(null!=t.tensorType&&t.hasOwnProperty("tensorType")){var e=s.onnx.TypeProto.Tensor.verify(t.tensorType);if(e)return"tensorType."+e}return null!=t.denotation&&t.hasOwnProperty("denotation")&&!a.isString(t.denotation)?"denotation: string expected":null},t.fromObject=function(t){if(t instanceof s.onnx.TypeProto)return t;var e=new s.onnx.TypeProto;if(null!=t.tensorType){if("object"!=typeof t.tensorType)throw TypeError(".onnx.TypeProto.tensorType: object expected");e.tensorType=s.onnx.TypeProto.Tensor.fromObject(t.tensorType)}return null!=t.denotation&&(e.denotation=String(t.denotation)),e},t.toObject=function(t,e){e||(e={});var n={};return e.defaults&&(n.denotation=""),null!=t.tensorType&&t.hasOwnProperty("tensorType")&&(n.tensorType=s.onnx.TypeProto.Tensor.toObject(t.tensorType,e),e.oneofs&&(n.value="tensorType")),null!=t.denotation&&t.hasOwnProperty("denotation")&&(n.denotation=t.denotation),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},t.Tensor=function(){function t(t){if(t)for(var e=Object.keys(t),n=0;n<e.length;++n)null!=t[e[n]]&&(this[e[n]]=t[e[n]])}return t.prototype.elemType=0,t.prototype.shape=null,t.create=function(e){return new t(e)},t.encode=function(t,e){return e||(e=o.create()),null!=t.elemType&&t.hasOwnProperty("elemType")&&e.uint32(8).int32(t.elemType),null!=t.shape&&t.hasOwnProperty("shape")&&s.onnx.TensorShapeProto.encode(t.shape,e.uint32(18).fork()).ldelim(),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e){t instanceof i||(t=i.create(t));for(var n=void 0===e?t.len:t.pos+e,r=new s.onnx.TypeProto.Tensor;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:r.elemType=t.int32();break;case 2:r.shape=s.onnx.TensorShapeProto.decode(t,t.uint32());break;default:t.skipType(7&o)}}return r},t.decodeDelimited=function(t){return t instanceof i||(t=new i(t)),this.decode(t,t.uint32())},t.verify=function(t){if("object"!=typeof t||null===t)return"object expected";if(null!=t.elemType&&t.hasOwnProperty("elemType")&&!a.isInteger(t.elemType))return"elemType: integer expected";if(null!=t.shape&&t.hasOwnProperty("shape")){var e=s.onnx.TensorShapeProto.verify(t.shape);if(e)return"shape."+e}return null},t.fromObject=function(t){if(t instanceof s.onnx.TypeProto.Tensor)return t;var e=new s.onnx.TypeProto.Tensor;if(null!=t.elemType&&(e.elemType=0|t.elemType),null!=t.shape){if("object"!=typeof t.shape)throw TypeError(".onnx.TypeProto.Tensor.shape: object expected");e.shape=s.onnx.TensorShapeProto.fromObject(t.shape)}return e},t.toObject=function(t,e){e||(e={});var n={};return e.defaults&&(n.elemType=0,n.shape=null),null!=t.elemType&&t.hasOwnProperty("elemType")&&(n.elemType=t.elemType),null!=t.shape&&t.hasOwnProperty("shape")&&(n.shape=s.onnx.TensorShapeProto.toObject(t.shape,e)),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},t}(),t}(),n.OperatorSetIdProto=function(){function t(t){if(t)for(var e=Object.keys(t),n=0;n<e.length;++n)null!=t[e[n]]&&(this[e[n]]=t[e[n]])}return t.prototype.domain="",t.prototype.version=a.Long?a.Long.fromBits(0,0,!1):0,t.create=function(e){return new t(e)},t.encode=function(t,e){return e||(e=o.create()),null!=t.domain&&t.hasOwnProperty("domain")&&e.uint32(10).string(t.domain),null!=t.version&&t.hasOwnProperty("version")&&e.uint32(16).int64(t.version),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e){t instanceof i||(t=i.create(t));for(var n=void 0===e?t.len:t.pos+e,r=new s.onnx.OperatorSetIdProto;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:r.domain=t.string();break;case 2:r.version=t.int64();break;default:t.skipType(7&o)}}return r},t.decodeDelimited=function(t){return t instanceof i||(t=new i(t)),this.decode(t,t.uint32())},t.verify=function(t){return"object"!=typeof t||null===t?"object expected":null!=t.domain&&t.hasOwnProperty("domain")&&!a.isString(t.domain)?"domain: string expected":null!=t.version&&t.hasOwnProperty("version")&&!(a.isInteger(t.version)||t.version&&a.isInteger(t.version.low)&&a.isInteger(t.version.high))?"version: integer|Long expected":null},t.fromObject=function(t){if(t instanceof s.onnx.OperatorSetIdProto)return t;var e=new s.onnx.OperatorSetIdProto;return null!=t.domain&&(e.domain=String(t.domain)),null!=t.version&&(a.Long?(e.version=a.Long.fromValue(t.version)).unsigned=!1:"string"==typeof t.version?e.version=parseInt(t.version,10):"number"==typeof t.version?e.version=t.version:"object"==typeof t.version&&(e.version=new a.LongBits(t.version.low>>>0,t.version.high>>>0).toNumber())),e},t.toObject=function(t,e){e||(e={});var n={};if(e.defaults)if(n.domain="",a.Long){var r=new a.Long(0,0,!1);n.version=e.longs===String?r.toString():e.longs===Number?r.toNumber():r}else n.version=e.longs===String?"0":0;return null!=t.domain&&t.hasOwnProperty("domain")&&(n.domain=t.domain),null!=t.version&&t.hasOwnProperty("version")&&("number"==typeof t.version?n.version=e.longs===String?String(t.version):t.version:n.version=e.longs===String?a.Long.prototype.toString.call(t.version):e.longs===Number?new a.LongBits(t.version.low>>>0,t.version.high>>>0).toNumber():t.version),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},t}(),n}(),t.exports=s},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.reshape=e.WebGLReshape=void 0;var o=n(37),a=n(0),s=n(50),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){var n=a.ShapeUtil.calculateReshapedDims(e[0].dims,e[1].integerData);return[c(t,e[0],n)]},e}(o.Reshape);function c(t,e,n){var r=t.getOrCreateTextureData(e),i=n;4===r.channels&&(i=s.getPackedShape(n));var o={channels:r.channels,height:r.height,width:r.width,shape:0!==i.length?i:[1],strides:a.ShapeUtil.computeStrides(i),unpackedShape:n};return t.createSharedTextureData(o,e.type,r.texture,e.dataId).tensor}e.WebGLReshape=l,e.reshape=c},function(t,e,n){"use strict";var r=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};function i(t,e){if(e.endsWith("+")){var n=Number.parseInt(e.substring(0,e.length-1),10);return!isNaN(n)&&n<=t}if(2===e.split("-").length){var r=e.split("-"),i=(n=Number.parseInt(r[0],10),Number.parseInt(r[1],10));return!isNaN(n)&&!isNaN(i)&&n<=t&&t<=i}return Number.parseInt(e,10)===t}Object.defineProperty(e,"__esModule",{value:!0}),e.resolveOperator=void 0,e.resolveOperator=function(t,e,n){var o,a,s,l;try{for(var c=r(n),u=c.next();!u.done;u=c.next()){var h=u.value,d=h[0],p=h[1],f=h[2],m=h[3];if(t.opType===d)try{for(var g=(s=void 0,r(e)),y=g.next();!y.done;y=g.next()){var v=y.value;if((v.domain===p||"ai.onnx"===v.domain&&""===p)&&i(v.version,f))return m(t)}}catch(t){s={error:t}}finally{try{y&&!y.done&&(l=g.return)&&l.call(g)}finally{if(s)throw s.error}}}}catch(t){o={error:t}}finally{try{u&&!u.done&&(a=c.return)&&a.call(c)}finally{if(o)throw o.error}}throw new TypeError("cannot resolve operator '"+t.opType+"' with opsets: "+e.map((function(t){return(t.domain||"ai.onnx")+" v"+t.version})).join(", "))}},function(t,e,n){"use strict";(function(t){var r=n(59),i=n(60),o=n(61);function a(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(t,e){if(a()<e)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=l.prototype:(null===t&&(t=new l(e)),t.length=e),t}function l(t,e,n){if(!(l.TYPED_ARRAY_SUPPORT||this instanceof l))return new l(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return h(this,t)}return c(this,t,e,n)}function c(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r),l.TYPED_ARRAY_SUPPORT?(t=e).__proto__=l.prototype:t=d(t,e),t}(t,e,n,r):"string"==typeof e?function(t,e,n){if("string"==typeof n&&""!==n||(n="utf8"),!l.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|f(e,n),i=(t=s(t,r)).write(e,n);return i!==r&&(t=t.slice(0,i)),t}(t,e,n):function(t,e){if(l.isBuffer(e)){var n=0|p(e.length);return 0===(t=s(t,n)).length||e.copy(t,0,0,n),t}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(r=e.length)!=r?s(t,0):d(t,e);if("Buffer"===e.type&&o(e.data))return d(t,e.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function u(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function h(t,e){if(u(e),t=s(t,e<0?0:0|p(e)),!l.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function d(t,e){var n=e.length<0?0:0|p(e.length);t=s(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function p(t){if(t>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|t}function f(t,e){if(l.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return z(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return j(t).length;default:if(r)return z(t).length;e=(""+e).toLowerCase(),r=!0}}function m(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return k(this,e,n);case"utf8":case"utf-8":return M(this,e,n);case"ascii":return C(this,e,n);case"latin1":case"binary":return A(this,e,n);case"base64":return E(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function g(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function y(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=l.from(e,r)),l.isBuffer(e))return 0===e.length?-1:v(t,e,n,r,i);if("number"==typeof e)return e&=255,l.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):v(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function v(t,e,n,r,i){var o,a=1,s=t.length,l=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;a=2,s/=2,l/=2,n/=2}function c(t,e){return 1===a?t[e]:t.readUInt16BE(e*a)}if(i){var u=-1;for(o=n;o<s;o++)if(c(t,o)===c(e,-1===u?0:o-u)){if(-1===u&&(u=o),o-u+1===l)return u*a}else-1!==u&&(o-=o-u),u=-1}else for(n+l>s&&(n=s-l),o=n;o>=0;o--){for(var h=!0,d=0;d<l;d++)if(c(t,o+d)!==c(e,d)){h=!1;break}if(h)return o}return-1}function b(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=e.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var a=0;a<r;++a){var s=parseInt(e.substr(2*a,2),16);if(isNaN(s))return a;t[n+a]=s}return a}function x(t,e,n,r){return V(z(e,t.length-n),t,n,r)}function _(t,e,n,r){return V(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function w(t,e,n,r){return _(t,e,n,r)}function S(t,e,n,r){return V(j(e),t,n,r)}function T(t,e,n,r){return V(function(t,e){for(var n,r,i,o=[],a=0;a<t.length&&!((e-=2)<0);++a)r=(n=t.charCodeAt(a))>>8,i=n%256,o.push(i),o.push(r);return o}(e,t.length-n),t,n,r)}function E(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function M(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var o,a,s,l,c=t[i],u=null,h=c>239?4:c>223?3:c>191?2:1;if(i+h<=n)switch(h){case 1:c<128&&(u=c);break;case 2:128==(192&(o=t[i+1]))&&(l=(31&c)<<6|63&o)>127&&(u=l);break;case 3:o=t[i+1],a=t[i+2],128==(192&o)&&128==(192&a)&&(l=(15&c)<<12|(63&o)<<6|63&a)>2047&&(l<55296||l>57343)&&(u=l);break;case 4:o=t[i+1],a=t[i+2],s=t[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(l=(15&c)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&l<1114112&&(u=l)}null===u?(u=65533,h=1):u>65535&&(u-=65536,r.push(u>>>10&1023|55296),u=56320|1023&u),r.push(u),i+=h}return function(t){var e=t.length;if(e<=4096)return String.fromCharCode.apply(String,t);for(var n="",r=0;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=4096));return n}(r)}function C(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function A(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function k(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=e;o<n;++o)i+=B(t[o]);return i}function I(t,e,n){for(var r=t.slice(e,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function R(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function P(t,e,n,r,i,o){if(!l.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function N(t,e,n,r){e<0&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-n,2);i<o;++i)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function O(t,e,n,r){e<0&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-n,4);i<o;++i)t[n+i]=e>>>8*(r?i:3-i)&255}function D(t,e,n,r,i,o){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function L(t,e,n,r,o){return o||D(t,0,n,4),i.write(t,e,n,r,23,4),n+4}function F(t,e,n,r,o){return o||D(t,0,n,8),i.write(t,e,n,r,52,8),n+8}e.Buffer=l,e.SlowBuffer=function(t){return+t!=t&&(t=0),l.alloc(+t)},e.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=a(),l.poolSize=8192,l._augment=function(t){return t.__proto__=l.prototype,t},l.from=function(t,e,n){return c(null,t,e,n)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(t,e,n){return function(t,e,n,r){return u(e),e<=0?s(t,e):void 0!==n?"string"==typeof r?s(t,e).fill(n,r):s(t,e).fill(n):s(t,e)}(null,t,e,n)},l.allocUnsafe=function(t){return h(null,t)},l.allocUnsafeSlow=function(t){return h(null,t)},l.isBuffer=function(t){return!(null==t||!t._isBuffer)},l.compare=function(t,e){if(!l.isBuffer(t)||!l.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,i=0,o=Math.min(n,r);i<o;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},l.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(t,e){if(!o(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return l.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=l.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var a=t[n];if(!l.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,i),i+=a.length}return r},l.byteLength=f,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)g(this,e,e+1);return this},l.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)g(this,e,e+3),g(this,e+1,e+2);return this},l.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)g(this,e,e+7),g(this,e+1,e+6),g(this,e+2,e+5),g(this,e+3,e+4);return this},l.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?M(this,0,t):m.apply(this,arguments)},l.prototype.equals=function(t){if(!l.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===l.compare(this,t)},l.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},l.prototype.compare=function(t,e,n,r,i){if(!l.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(this===t)return 0;for(var o=(i>>>=0)-(r>>>=0),a=(n>>>=0)-(e>>>=0),s=Math.min(o,a),c=this.slice(r,i),u=t.slice(e,n),h=0;h<s;++h)if(c[h]!==u[h]){o=c[h],a=u[h];break}return o<a?-1:a<o?1:0},l.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},l.prototype.indexOf=function(t,e,n){return y(this,t,e,n,!0)},l.prototype.lastIndexOf=function(t,e,n){return y(this,t,e,n,!1)},l.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return b(this,t,e,n);case"utf8":case"utf-8":return x(this,t,e,n);case"ascii":return _(this,t,e,n);case"latin1":case"binary":return w(this,t,e,n);case"base64":return S(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,t,e,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},l.prototype.slice=function(t,e){var n,r=this.length;if((t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),l.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=l.prototype;else{var i=e-t;n=new l(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+t]}return n},l.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||R(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r},l.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||R(t,e,this.length);for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},l.prototype.readUInt8=function(t,e){return e||R(t,1,this.length),this[t]},l.prototype.readUInt16LE=function(t,e){return e||R(t,2,this.length),this[t]|this[t+1]<<8},l.prototype.readUInt16BE=function(t,e){return e||R(t,2,this.length),this[t]<<8|this[t+1]},l.prototype.readUInt32LE=function(t,e){return e||R(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},l.prototype.readUInt32BE=function(t,e){return e||R(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},l.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||R(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},l.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||R(t,e,this.length);for(var r=e,i=1,o=this[t+--r];r>0&&(i*=256);)o+=this[t+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*e)),o},l.prototype.readInt8=function(t,e){return e||R(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},l.prototype.readInt16LE=function(t,e){e||R(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(t,e){e||R(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(t,e){return e||R(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},l.prototype.readInt32BE=function(t,e){return e||R(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},l.prototype.readFloatLE=function(t,e){return e||R(t,4,this.length),i.read(this,t,!0,23,4)},l.prototype.readFloatBE=function(t,e){return e||R(t,4,this.length),i.read(this,t,!1,23,4)},l.prototype.readDoubleLE=function(t,e){return e||R(t,8,this.length),i.read(this,t,!0,52,8)},l.prototype.readDoubleBE=function(t,e){return e||R(t,8,this.length),i.read(this,t,!1,52,8)},l.prototype.writeUIntLE=function(t,e,n,r){t=+t,e|=0,n|=0,r||P(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[e]=255&t;++o<n&&(i*=256);)this[e+o]=t/i&255;return e+n},l.prototype.writeUIntBE=function(t,e,n,r){t=+t,e|=0,n|=0,r||P(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+n},l.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||P(this,t,e,1,255,0),l.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},l.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||P(this,t,e,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):N(this,t,e,!0),e+2},l.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||P(this,t,e,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):N(this,t,e,!1),e+2},l.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||P(this,t,e,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):O(this,t,e,!0),e+4},l.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||P(this,t,e,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):O(this,t,e,!1),e+4},l.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);P(this,t,e,n,i-1,-i)}var o=0,a=1,s=0;for(this[e]=255&t;++o<n&&(a*=256);)t<0&&0===s&&0!==this[e+o-1]&&(s=1),this[e+o]=(t/a|0)-s&255;return e+n},l.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);P(this,t,e,n,i-1,-i)}var o=n-1,a=1,s=0;for(this[e+o]=255&t;--o>=0&&(a*=256);)t<0&&0===s&&0!==this[e+o+1]&&(s=1),this[e+o]=(t/a|0)-s&255;return e+n},l.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||P(this,t,e,1,127,-128),l.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},l.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||P(this,t,e,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):N(this,t,e,!0),e+2},l.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||P(this,t,e,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):N(this,t,e,!1),e+2},l.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||P(this,t,e,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):O(this,t,e,!0),e+4},l.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||P(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):O(this,t,e,!1),e+4},l.prototype.writeFloatLE=function(t,e,n){return L(this,t,e,!0,n)},l.prototype.writeFloatBE=function(t,e,n){return L(this,t,e,!1,n)},l.prototype.writeDoubleLE=function(t,e,n){return F(this,t,e,!0,n)},l.prototype.writeDoubleBE=function(t,e,n){return F(this,t,e,!1,n)},l.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i,o=r-n;if(this===t&&n<e&&e<r)for(i=o-1;i>=0;--i)t[i+e]=this[i+n];else if(o<1e3||!l.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+o),e);return o},l.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!l.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var o;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(o=e;o<n;++o)this[o]=t;else{var a=l.isBuffer(t)?t:z(new l(t,r).toString()),s=a.length;for(o=0;o<n-e;++o)this[o+e]=a[o%s]}return this};var U=/[^+\/0-9A-Za-z-_]/g;function B(t){return t<16?"0"+t.toString(16):t.toString(16)}function z(t,e){var n;e=e||1/0;for(var r=t.length,i=null,o=[],a=0;a<r;++a){if((n=t.charCodeAt(a))>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(a+1===r){(e-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function j(t){return r.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(U,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function V(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}}).call(this,n(8))},function(t,e){t.exports=r;var n=null;try{n=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(t){}function r(t,e,n){this.low=0|t,this.high=0|e,this.unsigned=!!n}function i(t){return!0===(t&&t.__isLong__)}r.prototype.__isLong__,Object.defineProperty(r.prototype,"__isLong__",{value:!0}),r.isLong=i;var o={},a={};function s(t,e){var n,r,i;return e?(i=0<=(t>>>=0)&&t<256)&&(r=a[t])?r:(n=c(t,(0|t)<0?-1:0,!0),i&&(a[t]=n),n):(i=-128<=(t|=0)&&t<128)&&(r=o[t])?r:(n=c(t,t<0?-1:0,!1),i&&(o[t]=n),n)}function l(t,e){if(isNaN(t))return e?v:y;if(e){if(t<0)return v;if(t>=f)return S}else{if(t<=-m)return T;if(t+1>=m)return w}return t<0?l(-t,e).neg():c(t%p|0,t/p|0,e)}function c(t,e,n){return new r(t,e,n)}r.fromInt=s,r.fromNumber=l,r.fromBits=c;var u=Math.pow;function h(t,e,n){if(0===t.length)throw Error("empty string");if("NaN"===t||"Infinity"===t||"+Infinity"===t||"-Infinity"===t)return y;if("number"==typeof e?(n=e,e=!1):e=!!e,(n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=t.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return h(t.substring(1),e,n).neg();for(var i=l(u(n,8)),o=y,a=0;a<t.length;a+=8){var s=Math.min(8,t.length-a),c=parseInt(t.substring(a,a+s),n);if(s<8){var d=l(u(n,s));o=o.mul(d).add(l(c))}else o=(o=o.mul(i)).add(l(c))}return o.unsigned=e,o}function d(t,e){return"number"==typeof t?l(t,e):"string"==typeof t?h(t,e):c(t.low,t.high,"boolean"==typeof e?e:t.unsigned)}r.fromString=h,r.fromValue=d;var p=4294967296,f=p*p,m=f/2,g=s(1<<24),y=s(0);r.ZERO=y;var v=s(0,!0);r.UZERO=v;var b=s(1);r.ONE=b;var x=s(1,!0);r.UONE=x;var _=s(-1);r.NEG_ONE=_;var w=c(-1,2147483647,!1);r.MAX_VALUE=w;var S=c(-1,-1,!0);r.MAX_UNSIGNED_VALUE=S;var T=c(0,-2147483648,!1);r.MIN_VALUE=T;var E=r.prototype;E.toInt=function(){return this.unsigned?this.low>>>0:this.low},E.toNumber=function(){return this.unsigned?(this.high>>>0)*p+(this.low>>>0):this.high*p+(this.low>>>0)},E.toString=function(t){if((t=t||10)<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(T)){var e=l(t),n=this.div(e),r=n.mul(e).sub(this);return n.toString(t)+r.toInt().toString(t)}return"-"+this.neg().toString(t)}for(var i=l(u(t,6),this.unsigned),o=this,a="";;){var s=o.div(i),c=(o.sub(s.mul(i)).toInt()>>>0).toString(t);if((o=s).isZero())return c+a;for(;c.length<6;)c="0"+c;a=""+c+a}},E.getHighBits=function(){return this.high},E.getHighBitsUnsigned=function(){return this.high>>>0},E.getLowBits=function(){return this.low},E.getLowBitsUnsigned=function(){return this.low>>>0},E.getNumBitsAbs=function(){if(this.isNegative())return this.eq(T)?64:this.neg().getNumBitsAbs();for(var t=0!=this.high?this.high:this.low,e=31;e>0&&0==(t&1<<e);e--);return 0!=this.high?e+33:e+1},E.isZero=function(){return 0===this.high&&0===this.low},E.eqz=E.isZero,E.isNegative=function(){return!this.unsigned&&this.high<0},E.isPositive=function(){return this.unsigned||this.high>=0},E.isOdd=function(){return 1==(1&this.low)},E.isEven=function(){return 0==(1&this.low)},E.equals=function(t){return i(t)||(t=d(t)),(this.unsigned===t.unsigned||this.high>>>31!=1||t.high>>>31!=1)&&this.high===t.high&&this.low===t.low},E.eq=E.equals,E.notEquals=function(t){return!this.eq(t)},E.neq=E.notEquals,E.ne=E.notEquals,E.lessThan=function(t){return this.comp(t)<0},E.lt=E.lessThan,E.lessThanOrEqual=function(t){return this.comp(t)<=0},E.lte=E.lessThanOrEqual,E.le=E.lessThanOrEqual,E.greaterThan=function(t){return this.comp(t)>0},E.gt=E.greaterThan,E.greaterThanOrEqual=function(t){return this.comp(t)>=0},E.gte=E.greaterThanOrEqual,E.ge=E.greaterThanOrEqual,E.compare=function(t){if(i(t)||(t=d(t)),this.eq(t))return 0;var e=this.isNegative(),n=t.isNegative();return e&&!n?-1:!e&&n?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},E.comp=E.compare,E.negate=function(){return!this.unsigned&&this.eq(T)?T:this.not().add(b)},E.neg=E.negate,E.add=function(t){i(t)||(t=d(t));var e=this.high>>>16,n=65535&this.high,r=this.low>>>16,o=65535&this.low,a=t.high>>>16,s=65535&t.high,l=t.low>>>16,u=0,h=0,p=0,f=0;return p+=(f+=o+(65535&t.low))>>>16,h+=(p+=r+l)>>>16,u+=(h+=n+s)>>>16,u+=e+a,c((p&=65535)<<16|(f&=65535),(u&=65535)<<16|(h&=65535),this.unsigned)},E.subtract=function(t){return i(t)||(t=d(t)),this.add(t.neg())},E.sub=E.subtract,E.multiply=function(t){if(this.isZero())return y;if(i(t)||(t=d(t)),n)return c(n.mul(this.low,this.high,t.low,t.high),n.get_high(),this.unsigned);if(t.isZero())return y;if(this.eq(T))return t.isOdd()?T:y;if(t.eq(T))return this.isOdd()?T:y;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(g)&&t.lt(g))return l(this.toNumber()*t.toNumber(),this.unsigned);var e=this.high>>>16,r=65535&this.high,o=this.low>>>16,a=65535&this.low,s=t.high>>>16,u=65535&t.high,h=t.low>>>16,p=65535&t.low,f=0,m=0,v=0,b=0;return v+=(b+=a*p)>>>16,m+=(v+=o*p)>>>16,v&=65535,m+=(v+=a*h)>>>16,f+=(m+=r*p)>>>16,m&=65535,f+=(m+=o*h)>>>16,m&=65535,f+=(m+=a*u)>>>16,f+=e*p+r*h+o*u+a*s,c((v&=65535)<<16|(b&=65535),(f&=65535)<<16|(m&=65535),this.unsigned)},E.mul=E.multiply,E.divide=function(t){if(i(t)||(t=d(t)),t.isZero())throw Error("division by zero");var e,r,o;if(n)return this.unsigned||-2147483648!==this.high||-1!==t.low||-1!==t.high?c((this.unsigned?n.div_u:n.div_s)(this.low,this.high,t.low,t.high),n.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?v:y;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return v;if(t.gt(this.shru(1)))return x;o=v}else{if(this.eq(T))return t.eq(b)||t.eq(_)?T:t.eq(T)?b:(e=this.shr(1).div(t).shl(1)).eq(y)?t.isNegative()?b:_:(r=this.sub(t.mul(e)),o=e.add(r.div(t)));if(t.eq(T))return this.unsigned?v:y;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();o=y}for(r=this;r.gte(t);){e=Math.max(1,Math.floor(r.toNumber()/t.toNumber()));for(var a=Math.ceil(Math.log(e)/Math.LN2),s=a<=48?1:u(2,a-48),h=l(e),p=h.mul(t);p.isNegative()||p.gt(r);)p=(h=l(e-=s,this.unsigned)).mul(t);h.isZero()&&(h=b),o=o.add(h),r=r.sub(p)}return o},E.div=E.divide,E.modulo=function(t){return i(t)||(t=d(t)),n?c((this.unsigned?n.rem_u:n.rem_s)(this.low,this.high,t.low,t.high),n.get_high(),this.unsigned):this.sub(this.div(t).mul(t))},E.mod=E.modulo,E.rem=E.modulo,E.not=function(){return c(~this.low,~this.high,this.unsigned)},E.and=function(t){return i(t)||(t=d(t)),c(this.low&t.low,this.high&t.high,this.unsigned)},E.or=function(t){return i(t)||(t=d(t)),c(this.low|t.low,this.high|t.high,this.unsigned)},E.xor=function(t){return i(t)||(t=d(t)),c(this.low^t.low,this.high^t.high,this.unsigned)},E.shiftLeft=function(t){return i(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?c(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):c(0,this.low<<t-32,this.unsigned)},E.shl=E.shiftLeft,E.shiftRight=function(t){return i(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?c(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):c(this.high>>t-32,this.high>=0?0:-1,this.unsigned)},E.shr=E.shiftRight,E.shiftRightUnsigned=function(t){if(i(t)&&(t=t.toInt()),0===(t&=63))return this;var e=this.high;return t<32?c(this.low>>>t|e<<32-t,e>>>t,this.unsigned):c(32===t?e:e>>>t-32,0,this.unsigned)},E.shru=E.shiftRightUnsigned,E.shr_u=E.shiftRightUnsigned,E.toSigned=function(){return this.unsigned?c(this.low,this.high,!1):this},E.toUnsigned=function(){return this.unsigned?this:c(this.low,this.high,!0)},E.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},E.toBytesLE=function(){var t=this.high,e=this.low;return[255&e,e>>>8&255,e>>>16&255,e>>>24,255&t,t>>>8&255,t>>>16&255,t>>>24]},E.toBytesBE=function(){var t=this.high,e=this.low;return[t>>>24,t>>>16&255,t>>>8&255,255&t,e>>>24,e>>>16&255,e>>>8&255,255&e]},r.fromBytes=function(t,e,n){return n?r.fromBytesLE(t,e):r.fromBytesBE(t,e)},r.fromBytesLE=function(t,e){return new r(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,e)},r.fromBytesBE=function(t,e){return new r(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],e)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BatchNormalization=void 0;var r=function(){function t(){}return t.prototype.initialize=function(t){this.epsilon=t.getFloat("epsilon",1e-5),this.momentum=t.getFloat("momentum",.9),this.spatial=t.getInt("spatial",1)},t.prototype.checkInputs=function(t){return!(!t||5!==t.length)&&this.checkInputTypes(t)},t.prototype.checkInputTypes=function(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=t[4];return!(e.dims.length<3||1!==n.dims.length||1!==r.dims.length||1!==i.dims.length||1!==o.dims.length)&&n.dims[0]===e.dims[1]&&r.dims[0]===e.dims[1]&&i.dims[0]===e.dims[1]&&o.dims[0]===e.dims[1]&&!("float32"!==e.type&&"float64"!==e.type||"float32"!==n.type&&"float64"!==n.type||"float32"!==r.type&&"float64"!==r.type||"float32"!==i.type&&"float64"!==i.type||"float32"!==o.type&&"float64"!==o.type)},t}();e.BatchNormalization=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BinaryOp=void 0;var r=function(){function t(t,e,n){this.typeConstraint=t,this.opType=e,this.resultType=n}return t.prototype.initialize=function(t){},t.prototype.checkInputs=function(t){return!(!t||2!==t.length)&&this.checkInputTypes(t)},t.prototype.checkInputTypes=function(t){return-1!==this.typeConstraint.indexOf(t[0].type)&&t[0].type===t[1].type},t}();e.BinaryOp=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Conv=void 0;var r=function(){function t(){}return t.prototype.initialize=function(t){this.autoPad=t.getString("auto_pad","NOTSET"),this.dilations=t.getInts("dilations",[1,1]),this.group=t.getInt("group",1),this.kernelShape=t.getInts("kernel_shape",[]),this.pads=t.getInts("pads",[0,0,0,0]),this.strides=t.getInts("strides",[1,1])},t.prototype.checkInputs=function(t){if(!t||2!==t.length&&3!==t.length)return!1;if(4!==t[0].dims.length||4!==t[1].dims.length)return!1;if(t[0].dims[1]!==t[1].dims[1]*this.group)return!1;if(3===t.length&&(1!==t[2].dims.length||t[1].dims[0]!==t[2].dims[0]))return!1;var e=t[0].dims.length-2;return this.dilations.length===e&&this.strides.length===e&&this.pads.length===2*e&&(0===this.kernelShape.length||this.kernelShape.length===t[1].dims.length-2)&&this.checkInputTypes(t)},t.prototype.checkInputTypes=function(t){return"float32"===t[0].type&&"float32"===t[1].type&&(3!==t.length||"float32"===t[2].type)},t}();e.Conv=r},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a};Object.defineProperty(e,"__esModule",{value:!0}),e.matMul2d=e.matMul=e.CpuMatMul=void 0;var a=n(18),s=n(1),l=n(0),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return[u(e[0],e[1])]},e}(a.MatMul);function u(t,e){var n=o(l.MatMulUtil.preprocessInputShapes(t.dims,e.dims),2),r=n[0],i=n[1],a=[r[r.length-2],i[i.length-1]],c=l.BroadcastUtil.calcShape(r,i,!0);if(!c)throw new Error("input dimensions do not match the requirement");for(var u=l.ShapeUtil.size(c)/(a[0]*a[1]),d=new s.Tensor(c,"float64"===t.type||"float64"===e.type?"float64":"float32"),p=0,f=new Array(c.length),m=new Array(t.dims.length),g=new Array(e.dims.length),y=0;y<u;y++){f[c.length-2]=0,f[c.length-1]=0;for(var v=y,b=c.length-3;b>=0;b--)f[b]=v%c[b],v=Math.floor(v/c[b]);l.BroadcastUtil.fillIndex(f,t.dims,m),l.BroadcastUtil.fillIndex(f,e.dims,g);var x=m.length<=2?0:l.ShapeUtil.indicesToOffset(m,t.strides,c.length-2),_=g.length<=2?0:l.ShapeUtil.indicesToOffset(g,e.strides,c.length-2);h(t.floatData.subarray(x),e.floatData.subarray(_),d.floatData.subarray(p),!1,!1,1,0,a[0],a[1],r[r.length-1]),p+=a[0]*a[1]}return d}function h(t,e,n,r,i,o,a,s,l,c){return r&&i?function(t,e,n,r,i,o,a,s){for(var l=0,c=0,u=0,h=0;h<o;h++){for(var d=0;d<a;d++){for(var p=0,f=0;f<s;f++)p+=t[l]*e[c],l+=o,c+=1;l-=o*s,c-=s,n[u]=r*p+i*n[u],u++,c+=s}c-=a*s,l++}}(t,e,n,o,a,s,l,c):r?function(t,e,n,r,i,o,a,s){for(var l=0,c=0,u=0,h=0;h<o;h++){for(var d=0;d<a;d++){for(var p=0,f=0;f<s;f++)p+=t[l]*e[c],l+=o,c+=a;l-=o*s,c-=a*s,n[u]=r*p+i*n[u],u++,c++}c-=a,l++}}(t,e,n,o,a,s,l,c):i?function(t,e,n,r,i,o,a,s){for(var l=0,c=0,u=0,h=0;h<o;h++){for(var d=0;d<a;d++){for(var p=0,f=0;f<s;f++)p+=t[l]*e[c],l+=1,c+=1;l-=s,c-=s,n[u]=r*p+i*n[u],u++,c+=s}c-=a*s,l+=s}}(t,e,n,o,a,s,l,c):function(t,e,n,r,i,o,a,s){for(var l=0,c=0,u=0,h=0;h<o;h++){for(var d=0;d<a;d++){for(var p=0,f=0;f<s;f++)p+=t[l]*e[c],l+=1,c+=a;l-=s,c-=a*s,n[u]=r*p+i*n[u],u++,c++}c-=a,l+=s}}(t,e,n,o,a,s,l,c)}e.CpuMatMul=c,e.matMul=u,e.matMul2d=h},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MatMul=void 0;var r=function(){function t(){}return t.prototype.initialize=function(t){},t.prototype.checkInputs=function(t){return!(!t||2!==t.length)&&t[0].dims[t[0].dims.length-1]===t[1].dims[t[1].dims.length-2]&&this.checkInputTypes(t)},t.prototype.checkInputTypes=function(t){return("float32"===t[0].type||"float64"===t[0].type)&&("float32"===t[1].type||"float64"===t[1].type)&&t[0].type===t[1].type},t}();e.MatMul=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Gemm=void 0;var r=function(){function t(t){this.isOptionalC=t}return t.prototype.initialize=function(t){this.transA=0!==t.getInt("transA",0),this.transB=0!==t.getInt("transB",0),this.alpha=t.getFloat("alpha",1),this.beta=t.getFloat("beta",1)},t.prototype.checkInputs=function(t){return!!t&&(!this.isOptionalC||!(t.length<2||t.length>3))&&!(!this.isOptionalC&&3!==t.length)&&(3!==t.length||1===t[2].dims.length||2===t[2].dims.length)&&this.checkInputTypes(t)},t.prototype.checkInputTypes=function(t){return!("float32"!==t[0].type&&"float64"!==t[0].type||"float32"!==t[1].type&&"float64"!==t[1].type||3===t.length&&"float32"!==t[2].type&&"float64"!==t[2].type)&&t[0].type===t[1].type&&(3!==t.length||t[0].type===t[2].type)},t}();e.Gemm=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.InstanceNormalization=void 0;var r=function(){function t(){}return t.prototype.initialize=function(t){this.epsilon=t.getFloat("epsilon",1e-5)},t.prototype.checkInputs=function(t){return!(!t||3!==t.length)&&this.checkInputTypes(t)},t.prototype.checkInputTypes=function(t){var e=t[0],n=t[1],r=t[2];return!(e.dims.length<3||1!==n.dims.length||1!==r.dims.length)&&n.dims[0]===e.dims[1]&&r.dims[0]===e.dims[1]&&!("float32"!==e.type&&"float64"!==e.type||"float32"!==n.type&&"float64"!==n.type||"float32"!==r.type&&"float64"!==r.type)},t}();e.InstanceNormalization=r},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.GlobalMaxPool=e.MaxPool=e.GlobalAveragePool=e.AveragePool=void 0;var o=function(){function t(){}return t.prototype.checkInputs=function(t){return!(!t||1!==t.length)&&this.checkInputTypes(t)},t.prototype.checkInputTypes=function(t){return"float32"===t[0].type||"float64"===t[0].type},t}(),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.initialize=function(t){if(this.autoPad=t.getString("auto_pad","NOTSET"),this.kernelShape=t.getInts("kernel_shape"),this.strides=t.getInts("strides",[]),this.pads=t.getInts("pads",[]),this.countIncludePad=0!==t.getInt("count_include_pad",0),this.ceilMode=t.getInt("ceil_mode",0),0!==this.ceilMode)throw new Error("using ceil() in shape computation is not yet supported for AveragePool")},e}(o);e.AveragePool=a;var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.initialize=function(t){this.countIncludePad=0!==t.getInt("count_include_pad",0)},e}(o);e.GlobalAveragePool=s;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.initialize=function(t){if(this.autoPad=t.getString("auto_pad","NOTSET"),this.kernelShape=t.getInts("kernel_shape"),this.strides=t.getInts("strides",[]),this.pads=t.getInts("pads",[]),this.ceilMode=t.getInt("ceil_mode",0),this.storageOrder=t.getInt("storage_order",0),0!==this.storageOrder)throw new Error("column major storage order is not yet supported for MaxPool");if(0!==this.ceilMode)throw new Error("using ceil() in shape computation is not yet supported for MaxPool")},e}(o);e.MaxPool=l;var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.initialize=function(t){},e}(o);e.GlobalMaxPool=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Softmax=void 0;var r=function(){function t(){}return t.prototype.initialize=function(t){this.axis=t.getInt("axis",1)},t.prototype.checkInputs=function(t){return!(!t||1!==t.length)&&this.checkInputTypes(t)},t.prototype.checkInputTypes=function(t){return"float32"===t[0].type||"float64"===t[0].type},t}();e.Softmax=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Sum=void 0;var r=function(){function t(){}return t.prototype.initialize=function(t){},t.prototype.checkInputs=function(t){if(!t||0===t.length)return!1;for(var e=t[0].dims.length,n=1;n<t.length;n++){if(e!==t[n].dims.length)return!1;for(var r=0;r<e;r++)if(t[0].dims[r]!==t[n].dims[r])return!1}return this.checkInputTypes(t)},t.prototype.checkInputTypes=function(t){if("float32"!==t[0].type&&"float64"!==t[0].type)return!1;for(var e=1;e<t.length;e++)if(t[0].type!==t[e].type)return!1;return!0},t}();e.Sum=r},function(t,e){var n,r,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(t){r=a}}();var l,c=[],u=!1,h=-1;function d(){u&&l&&(u=!1,l.length?c=l.concat(c):h=-1,c.length&&p())}function p(){if(!u){var t=s(d);u=!0;for(var e=c.length;e;){for(l=c,c=[];++h<e;)l&&l[h].run();h=-1,e=c.length}l=null,u=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function m(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new f(t,e)),1!==c.length||u||s(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.env=void 0;var a=o(n(46)),s=o(n(26));e.env=new function(){this.onnx=s,this.backend=s.backend,this.platform=a,this.debug=!1}},function(t,e,n){"use strict";(function(e){var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=(this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e})(n(53)),a=o;("undefined"!=typeof window?window:e).onnx=a,t.exports=o}).call(this,n(8))},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.CPU_OP_RESOLVE_RULES=void 0;var a=n(7),s=n(57),l=n(77),c=n(78),u=n(79),h=n(80),d=n(81),p=n(82),f=n(83),m=n(84),g=n(85),y=n(86),v=n(87),b=n(17),x=n(89),_=n(90),w=o(n(91)),S=n(92),T=n(93),E=n(94),M=n(95),C=n(96),A=n(97),k=n(98),I=o(n(42)),R=n(42),P=n(99),N=n(100);e.CPU_OP_RESOLVE_RULES=[["Abs","","6+",function(){return new R.CpuUnaryOp(a.NUMBER_TYPES,I.abs)}],["Acos","","7+",function(){return new R.CpuUnaryOp(a.FLOAT_TYPES,I.acos)}],["Acosh","","9+",function(){return new R.CpuUnaryOp(a.FLOAT_TYPES,I.acosh)}],["Add","","7+",function(){return new c.CpuBinaryOp(a.NUMBER_TYPES,(function(t,e){return t+e}))}],["And","","7+",function(){return new c.CpuBinaryOp(["bool"],(function(t,e){return t&&e}))}],["ArgMax","","1-11",function(){return new s.CpuArgMax}],["Asin","","7+",function(){return new R.CpuUnaryOp(a.FLOAT_TYPES,I.asin)}],["Asinh","","9+",function(){return new R.CpuUnaryOp(a.FLOAT_TYPES,I.asinh)}],["Atan","","7+",function(){return new R.CpuUnaryOp(a.FLOAT_TYPES,I.atan)}],["Atanh","","9+",function(){return new R.CpuUnaryOp(a.FLOAT_TYPES,I.atanh)}],["AveragePool","","7-10",function(){return new _.CpuAveragePool}],["BatchNormalization","","7+",function(){return new l.CpuBatchNormalization}],["Ceil","","6+",function(){return new R.CpuUnaryOp(a.FLOAT_TYPES,I.ceil)}],["Clip","","6-10",function(){return new R.CpuUnaryOp(a.FLOAT_TYPES,I.clip,I.clipInitializer)}],["Concat","","4+",function(){return new u.CpuConcat}],["Conv","","1+",function(){return new h.CpuConv}],["Cos","","7+",function(){return new R.CpuUnaryOp(a.FLOAT_TYPES,I.cos)}],["Cosh","","9+",function(){return new R.CpuUnaryOp(a.FLOAT_TYPES,I.cosh)}],["Div","","7+",function(){return new c.CpuBinaryOp(a.NUMBER_TYPES,(function(t,e){return t/e}))}],["Dropout","","7+",function(){return new d.CpuDropout}],["Elu","","6+",function(){return new R.CpuUnaryOp(a.FLOAT_TYPES,I.elu,I.eluInitializer)}],["Exp","","6+",function(){return new R.CpuUnaryOp(a.FLOAT_TYPES,I.exp)}],["Flatten","","1+",function(){return new p.CpuFlatten}],["Floor","","6+",function(){return new R.CpuUnaryOp(a.FLOAT_TYPES,I.floor)}],["Gather","","1+",function(){return new f.CpuGather}],["Gemm","","7-10",function(){return new m.CpuGemm(!1)}],["Gemm","","11+",function(){return new m.CpuGemm(!0)}],["GlobalAveragePool","","1+",function(){return new _.CpuGlobalAveragePool}],["GlobalMaxPool","","1+",function(){return new _.CpuGlobalMaxPool}],["ImageScaler","","1+",function(){return new g.CpuImageScaler}],["InstanceNormalization","","6+",function(){return new y.CpuInstanceNormalization}],["IsNaN","","9+",function(){return new R.CpuUnaryOp(a.FLOAT_TYPES,I.isNan,void 0,"bool")}],["LeakyRelu","","6+",function(){return new R.CpuUnaryOp(a.FLOAT_TYPES,I.leakyRelu,I.leakyReluInitializer)}],["Log","","6+",function(){return new R.CpuUnaryOp(a.FLOAT_TYPES,I.log)}],["LRN","","1+",function(){return new v.CpuLrn}],["MatMul","","1+",function(){return new b.CpuMatMul}],["MaxPool","","1-9",function(){return new _.CpuMaxPool}],["Mul","","7+",function(){return new c.CpuBinaryOp(a.NUMBER_TYPES,(function(t,e){return t*e}))}],["Neg","","6+",function(){return new R.CpuUnaryOp(a.NUMBER_TYPES,I.neg)}],["Not","","1+",function(){return new R.CpuUnaryOp(["bool"],I.not,void 0,"bool")}],["Or","","7+",function(){return new c.CpuBinaryOp(["bool"],(function(t,e){return t||e}))}],["PRelu","","7+",function(){return new c.CpuBinaryOp(a.NUMBER_TYPES,(function(t,e){return t>=0?t:t*e}))}],["Pad","","2-10",function(){return new x.CpuPad}],["Reciprocal","","6+",function(){return new R.CpuUnaryOp(a.FLOAT_TYPES,I.reciprocal)}],["ReduceLogSum","","1+",function(){return new w.CpuReduceLogSum}],["ReduceMax","","1+",function(){return new w.CpuReduceMax}],["ReduceMean","","1+",function(){return new w.CpuReduceMean}],["ReduceMin","","1+",function(){return new w.CpuReduceMin}],["ReduceProd","","1+",function(){return new w.CpuReduceProd}],["ReduceSum","","1+",function(){return new w.CpuReduceSum}],["ReduceSumSquare","","1+",function(){return new w.CpuReduceSumSquare}],["Relu","","6+",function(){return new R.CpuUnaryOp(a.FLOAT_TYPES,I.relu)}],["Reshape","","5+",function(){return new S.CpuReshape}],["Sigmoid","","6+",function(){return new R.CpuUnaryOp(a.FLOAT_TYPES,I.sigmoid)}],["Sign","","9+",function(){return new R.CpuUnaryOp(a.NUMBER_TYPES,I.sign)}],["Sin","","7+",function(){return new R.CpuUnaryOp(a.FLOAT_TYPES,I.sin)}],["Sinh","","9+",function(){return new R.CpuUnaryOp(a.FLOAT_TYPES,I.sinh)}],["Slice","","10+",function(){return new T.CpuSliceV10}],["Slice","","1-9",function(){return new T.CpuSlice}],["Softmax","","1+",function(){return new E.CpuSoftmax}],["Sqrt","","6+",function(){return new R.CpuUnaryOp(a.FLOAT_TYPES,I.sqrt)}],["Squeeze","","1+",function(){return new M.CpuSqueeze}],["Sub","","7+",function(){return new c.CpuBinaryOp(a.NUMBER_TYPES,(function(t,e){return t-e}))}],["Sum","","6+",function(){return new C.CpuSum}],["Tan","","7+",function(){return new R.CpuUnaryOp(a.FLOAT_TYPES,I.tan)}],["Tanh","","6+",function(){return new R.CpuUnaryOp(a.FLOAT_TYPES,I.tanh)}],["Tile","","6+",function(){return new A.CpuTile}],["Transpose","","1+",function(){return new k.CpuTranspose}],["Unsqueeze","","1+",function(){return new P.CpuUnsqueeze}],["Upsample","","7-8",function(){return new N.CpuUpsample}],["Xor","","7+",function(){return new c.CpuBinaryOp(["bool"],(function(t,e){return t^e}))}]]},function(t,e,n){"use strict";t.exports=h;var r,i=n(6),o=i.LongBits,a=i.base64,s=i.utf8;function l(t,e,n){this.fn=t,this.len=e,this.next=void 0,this.val=n}function c(){}function u(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function h(){this.len=0,this.head=new l(c,0,0),this.tail=this.head,this.states=null}var d=function(){return i.Buffer?function(){return(h.create=function(){return new r})()}:function(){return new h}};function p(t,e,n){e[n]=255&t}function f(t,e){this.len=t,this.next=void 0,this.val=e}function m(t,e,n){for(;t.hi;)e[n++]=127&t.lo|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[n++]=127&t.lo|128,t.lo=t.lo>>>7;e[n++]=t.lo}function g(t,e,n){e[n]=255&t,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24}h.create=d(),h.alloc=function(t){return new i.Array(t)},i.Array!==Array&&(h.alloc=i.pool(h.alloc,i.Array.prototype.subarray)),h.prototype._push=function(t,e,n){return this.tail=this.tail.next=new l(t,e,n),this.len+=e,this},f.prototype=Object.create(l.prototype),f.prototype.fn=function(t,e,n){for(;t>127;)e[n++]=127&t|128,t>>>=7;e[n]=t},h.prototype.uint32=function(t){return this.len+=(this.tail=this.tail.next=new f((t>>>=0)<128?1:t<16384?2:t<2097152?3:t<268435456?4:5,t)).len,this},h.prototype.int32=function(t){return t<0?this._push(m,10,o.fromNumber(t)):this.uint32(t)},h.prototype.sint32=function(t){return this.uint32((t<<1^t>>31)>>>0)},h.prototype.uint64=function(t){var e=o.from(t);return this._push(m,e.length(),e)},h.prototype.int64=h.prototype.uint64,h.prototype.sint64=function(t){var e=o.from(t).zzEncode();return this._push(m,e.length(),e)},h.prototype.bool=function(t){return this._push(p,1,t?1:0)},h.prototype.fixed32=function(t){return this._push(g,4,t>>>0)},h.prototype.sfixed32=h.prototype.fixed32,h.prototype.fixed64=function(t){var e=o.from(t);return this._push(g,4,e.lo)._push(g,4,e.hi)},h.prototype.sfixed64=h.prototype.fixed64,h.prototype.float=function(t){return this._push(i.float.writeFloatLE,4,t)},h.prototype.double=function(t){return this._push(i.float.writeDoubleLE,8,t)};var y=i.Array.prototype.set?function(t,e,n){e.set(t,n)}:function(t,e,n){for(var r=0;r<t.length;++r)e[n+r]=t[r]};h.prototype.bytes=function(t){var e=t.length>>>0;if(!e)return this._push(p,1,0);if(i.isString(t)){var n=h.alloc(e=a.length(t));a.decode(t,n,0),t=n}return this.uint32(e)._push(y,e,t)},h.prototype.string=function(t){var e=s.length(t);return e?this.uint32(e)._push(s.write,e,t):this._push(p,1,0)},h.prototype.fork=function(){return this.states=new u(this),this.head=this.tail=new l(c,0,0),this.len=0,this},h.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new l(c,0,0),this.len=0),this},h.prototype.ldelim=function(){var t=this.head,e=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=t.next,this.tail=e,this.len+=n),this},h.prototype.finish=function(){for(var t=this.head.next,e=this.constructor.alloc(this.len),n=0;t;)t.fn(t.val,e,n),n+=t.len,t=t.next;return e},h._configure=function(t){r=t,h.create=d(),r._configure()}},function(t,e,n){"use strict";t.exports=l;var r,i=n(6),o=i.LongBits,a=i.utf8;function s(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function l(t){this.buf=t,this.pos=0,this.len=t.length}var c,u="undefined"!=typeof Uint8Array?function(t){if(t instanceof Uint8Array||Array.isArray(t))return new l(t);throw Error("illegal buffer")}:function(t){if(Array.isArray(t))return new l(t);throw Error("illegal buffer")},h=function(){return i.Buffer?function(t){return(l.create=function(t){return i.Buffer.isBuffer(t)?new r(t):u(t)})(t)}:u};function d(){var t=new o(0,0),e=0;if(!(this.len-this.pos>4)){for(;e<3;++e){if(this.pos>=this.len)throw s(this);if(t.lo=(t.lo|(127&this.buf[this.pos])<<7*e)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(127&this.buf[this.pos++])<<7*e)>>>0,t}for(;e<4;++e)if(t.lo=(t.lo|(127&this.buf[this.pos])<<7*e)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(127&this.buf[this.pos])<<28)>>>0,t.hi=(t.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return t;if(e=0,this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(127&this.buf[this.pos])<<7*e+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw s(this);if(t.hi=(t.hi|(127&this.buf[this.pos])<<7*e+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}function p(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}function f(){if(this.pos+8>this.len)throw s(this,8);return new o(p(this.buf,this.pos+=4),p(this.buf,this.pos+=4))}l.create=h(),l.prototype._slice=i.Array.prototype.subarray||i.Array.prototype.slice,l.prototype.uint32=(c=4294967295,function(){if(c=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return c;if((this.pos+=5)>this.len)throw this.pos=this.len,s(this,10);return c}),l.prototype.int32=function(){return 0|this.uint32()},l.prototype.sint32=function(){var t=this.uint32();return t>>>1^-(1&t)},l.prototype.bool=function(){return 0!==this.uint32()},l.prototype.fixed32=function(){if(this.pos+4>this.len)throw s(this,4);return p(this.buf,this.pos+=4)},l.prototype.sfixed32=function(){if(this.pos+4>this.len)throw s(this,4);return 0|p(this.buf,this.pos+=4)},l.prototype.float=function(){if(this.pos+4>this.len)throw s(this,4);var t=i.float.readFloatLE(this.buf,this.pos);return this.pos+=4,t},l.prototype.double=function(){if(this.pos+8>this.len)throw s(this,4);var t=i.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,t},l.prototype.bytes=function(){var t=this.uint32(),e=this.pos,n=this.pos+t;if(n>this.len)throw s(this,t);return this.pos+=t,Array.isArray(this.buf)?this.buf.slice(e,n):e===n?new this.buf.constructor(0):this._slice.call(this.buf,e,n)},l.prototype.string=function(){var t=this.bytes();return a.read(t,0,t.length)},l.prototype.skip=function(t){if("number"==typeof t){if(this.pos+t>this.len)throw s(this,t);this.pos+=t}else do{if(this.pos>=this.len)throw s(this)}while(128&this.buf[this.pos++]);return this},l.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(t=7&this.uint32());)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this},l._configure=function(t){r=t,l.create=h(),r._configure();var e=i.Long?"toLong":"toNumber";i.merge(l.prototype,{int64:function(){return d.call(this)[e](!1)},uint64:function(){return d.call(this)[e](!0)},sint64:function(){return d.call(this).zzDecode()[e](!1)},fixed64:function(){return f.call(this)[e](!0)},sfixed64:function(){return f.call(this)[e](!1)}})}},function(t,e,n){"use strict";var r=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.Concat=void 0;var i=function(){function t(){}return t.prototype.initialize=function(t){this.axis=t.getInt("axis")},t.prototype.checkInputs=function(t){return!(!t||t.length<1)&&this.checkInputTypes(t)},t.prototype.checkInputTypes=function(t){var e,n,i=t[0].type,o=t[0].dims.length;if("string"===i)return!1;try{for(var a=r(t),s=a.next();!s.done;s=a.next()){var l=s.value;if(l.type!==i)return!1;if(l.dims.length!==o)return!1}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return!0},t}();e.Concat=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Dropout=void 0;var r=function(){function t(){}return t.prototype.initialize=function(t){this.ratio=t.getFloat("ratio",.5),this.testMode=!0},t.prototype.checkInputs=function(t){return!(!t||1!==t.length)&&this.checkInputTypes(t)},t.prototype.checkInputTypes=function(t){return"float32"===t[0].type||"float64"===t[0].type},t}();e.Dropout=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Flatten=void 0;var r=function(){function t(){}return t.prototype.initialize=function(t){this.axis=t.getInt("axis",1)},t.prototype.checkInputs=function(t){if(!t||1!==t.length)return!1;var e=t[0].dims.length;return 0!==e&&!(this.axis<-e||this.axis>e)&&this.checkInputTypes(t)},t.prototype.checkInputTypes=function(t){return"string"!==t[0].type},t}();e.Flatten=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Gather=void 0;var r=n(7),i=function(){function t(){}return t.prototype.initialize=function(t){this.axis=t.getInt("axis",0)},t.prototype.checkInputs=function(t){if(!t||2!==t.length)return!1;var e=t[0].dims.length;return!(e<1)&&!(this.axis<-e||this.axis>e-1)&&this.checkInputTypes(t)},t.prototype.checkInputTypes=function(t){return-1!==r.NUMBER_TYPES.indexOf(t[0].type)&&("int32"===t[1].type||"int16"===t[1].type)},t}();e.Gather=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ImageScaler=void 0;var r=function(){function t(){}return t.prototype.initialize=function(t){this.scale=t.getFloat("scale"),this.bias=t.getFloats("bias")},t.prototype.checkInputs=function(t){return!(!t||1!==t.length)&&4===t[0].dims.length&&this.checkInputTypes(t)},t.prototype.checkInputTypes=function(t){return"float32"===t[0].type||"float64"===t[0].type},t}();e.ImageScaler=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Pad=void 0;var r=function(){function t(){}return t.prototype.initialize=function(t){this.mode=t.getString("mode","constant"),this.value=t.getFloat("value",0),this.pads=t.getInts("pads")},t.prototype.checkInputs=function(t){return!(!t||1!==t.length)&&this.checkInputTypes(t)},t.prototype.checkInputTypes=function(t){return"float32"===t[0].type||"float64"===t[0].type},t}();e.Pad=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ReduceBase=void 0;var r=n(7),i=function(){function t(){}return t.prototype.initialize=function(t){this.axes=t.getInts("axes",[]),this.keepDims=1===t.getInt("keepdims",1)},t.prototype.checkInputs=function(t){return!(!t||1!==t.length)&&this.checkInputTypes(t)},t.prototype.checkInputTypes=function(t){return-1!==r.NUMBER_TYPES.indexOf(t[0].type)},t}();e.ReduceBase=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Reshape=void 0;var r=function(){function t(){}return t.prototype.initialize=function(t){},t.prototype.checkInputs=function(t){return!(!t||2!==t.length||1!==t[1].dims.length)&&this.checkInputTypes(t)},t.prototype.checkInputTypes=function(t){return("float32"===t[0].type||"float64"===t[0].type)&&"int32"===t[1].type},t}();e.Reshape=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SliceV10=e.Slice=void 0;var r=function(){function t(){}return t.prototype.initialize=function(t){this.starts=t.getInts("starts"),this.ends=t.getInts("ends"),this.axes=t.getInts("axes",[])},t.prototype.checkInputs=function(t){return!(!t||1!==t.length)&&this.checkInputTypes(t)},t.prototype.checkInputTypes=function(t){return"float32"===t[0].type||"float64"===t[0].type},t}();e.Slice=r;var i=function(){function t(){}return t.prototype.initialize=function(t){},t.prototype.checkInputs=function(t){return!(!t||t.length<3||t.length>5)&&this.checkInputTypes(t)},t.prototype.checkInputTypes=function(t){return"int32"===t[1].type&&1===t[1].dims.length&&"int32"===t[2].type&&1===t[2].dims.length&&(!(t.length>=4)||"int32"===t[3].type&&1===t[3].dims.length)&&(!(t.length>=5)||"int32"===t[4].type&&1===t[4].dims.length)},t}();e.SliceV10=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Squeeze=void 0;var r=function(){function t(){}return t.prototype.initialize=function(t){this.axes=t.getInts("axes")},t.prototype.checkInputs=function(t){return!(!t||1!==t.length)&&this.checkInputTypes(t)},t.prototype.checkInputTypes=function(t){return"string"!==t[0].type},t}();e.Squeeze=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Tile=void 0;var r=n(7),i=function(){function t(){}return t.prototype.initialize=function(t){},t.prototype.checkInputs=function(t){return!(!t||2!==t.length)&&1===t[1].dims.length&&t[1].dims[0]===t[0].dims.length&&this.checkInputTypes(t)},t.prototype.checkInputTypes=function(t){return-1!==r.NUMBER_TYPES.indexOf(t[0].type)&&("int32"===t[1].type||"int16"===t[1].type)},t}();e.Tile=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Transpose=void 0;var r=function(){function t(){}return t.prototype.initialize=function(t){this.perm=t.getInts("perm",[])},t.prototype.checkInputs=function(t){return!(!t||1!==t.length)&&this.checkInputTypes(t)},t.prototype.checkInputTypes=function(t){return"float32"===t[0].type||"float64"===t[0].type},t}();e.Transpose=r},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.tanh=e.tan=e.sqrt=e.sinh=e.sin=e.sign=e.sigmoid=e.relu=e.reciprocal=e.not=e.neg=e.log=e.leakyRelu=e.leakyReluInitializer=e.isNan=e.floor=e.exp=e.elu=e.eluInitializer=e.cosh=e.cos=e.clip=e.clipInitializer=e.ceil=e.atanh=e.atan=e.asinh=e.asin=e.acosh=e.acos=e.abs=e.unaryOp=e.CpuUnaryOp=void 0;var o=n(43),a=n(1),s=function(t){function e(e,n,r,i){var o=t.call(this,e,i)||this;return o.func=n,o.attributesInitializer=r,o}return i(e,t),e.prototype.initialize=function(t){this.attributesInitializer&&(this.attributes=this.attributesInitializer(t))},e.prototype.run=function(t,e){return[l(e[0],this.func,this.attributes,this.resultType)]},e}(o.UnaryOp);function l(t,e,n,r){var i=new a.Tensor(t.dims,r||t.type);return e(t.data,i.data,n),i}e.CpuUnaryOp=s,e.unaryOp=l,e.abs=function(t,e){for(var n=0;n<t.length;n++)e[n]=Math.abs(t[n])},e.acos=function(t,e){for(var n=0;n<t.length;n++)e[n]=Math.acos(t[n])},e.acosh=function(t,e){for(var n=0;n<t.length;n++)e[n]=Math.acosh(t[n])},e.asin=function(t,e){for(var n=0;n<t.length;n++)e[n]=Math.asin(t[n])},e.asinh=function(t,e){for(var n=0;n<t.length;n++)e[n]=Math.asinh(t[n])},e.atan=function(t,e){for(var n=0;n<t.length;n++)e[n]=Math.atan(t[n])},e.atanh=function(t,e){for(var n=0;n<t.length;n++)e[n]=Math.atanh(t[n])},e.ceil=function(t,e){for(var n=0;n<t.length;n++)e[n]=Math.ceil(t[n])},e.clipInitializer=function(t){return{min:t.getFloat("min",-34028234663852886e22),max:t.getFloat("max",34028234663852886e22)}},e.clip=function(t,e,n){for(var r=n.min,i=n.max,o=0;o<t.length;o++){var a=t[o];e[o]=a<r?r:a>i?i:a}},e.cos=function(t,e){for(var n=0;n<t.length;n++)e[n]=Math.cos(t[n])},e.cosh=function(t,e){for(var n=0;n<t.length;n++)e[n]=Math.cosh(t[n])},e.eluInitializer=function(t){return t.getFloat("alpha",1)},e.elu=function(t,e,n){for(var r=n,i=0;i<t.length;i++){var o=t[i];e[i]=o>=0?o:r*(Math.exp(o)-1)}},e.exp=function(t,e){for(var n=0;n<t.length;n++)e[n]=Math.exp(t[n])},e.floor=function(t,e){for(var n=0;n<t.length;n++)e[n]=Math.floor(t[n])},e.isNan=function(t,e){for(var n=0;n<t.length;n++)e[n]=Number.isNaN(t[n])?1:0},e.leakyReluInitializer=function(t){return t.getFloat("alpha",.01)},e.leakyRelu=function(t,e,n){for(var r=n,i=0;i<t.length;i++){var o=t[i];e[i]=o>=0?o:r*o}},e.log=function(t,e){for(var n=0;n<t.length;n++)e[n]=Math.log(t[n])},e.neg=function(t,e){for(var n=0;n<t.length;n++)e[n]=-t[n]},e.not=function(t,e){for(var n=0;n<t.length;n++)e[n]=t[n]?0:1},e.reciprocal=function(t,e){for(var n=0;n<t.length;n++)e[n]=1/t[n]},e.relu=function(t,e){for(var n=0;n<t.length;n++)e[n]=Math.max(0,t[n])},e.sigmoid=function(t,e){for(var n=0;n<t.length;n++)e[n]=1/(1+Math.exp(-t[n]))},e.sign=function(t,e){for(var n=0;n<t.length;n++)e[n]=t[n]>0?1:t[n]<0?-1:0},e.sin=function(t,e){for(var n=0;n<t.length;n++)e[n]=Math.sin(t[n])},e.sinh=function(t,e){for(var n=0;n<t.length;n++)e[n]=Math.sinh(t[n])},e.sqrt=function(t,e){for(var n=0;n<t.length;n++)e[n]=Math.sqrt(t[n])},e.tan=function(t,e){for(var n=0;n<t.length;n++)e[n]=Math.tan(t[n])},e.tanh=function(t,e){for(var n=0;n<t.length;n++)e[n]=Math.tanh(t[n])}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.UnaryOp=void 0;var r=function(){function t(t,e){this.typeConstraint=t,this.resultType=e}return t.prototype.initialize=function(t){},t.prototype.checkInputs=function(t){return!(!t||1!==t.length)&&this.checkInputTypes(t)},t.prototype.checkInputTypes=function(t){return-1!==this.typeConstraint.indexOf(t[0].type)},t}();e.UnaryOp=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Unsqueeze=void 0;var r=function(){function t(){}return t.prototype.initialize=function(t){this.axes=t.getInts("axes")},t.prototype.checkInputs=function(t){return!(!t||1!==t.length)&&this.checkInputTypes(t)},t.prototype.checkInputTypes=function(t){return"string"!==t[0].type},t}();e.Unsqueeze=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Upsample=void 0;var r=function(){function t(){}return t.prototype.initialize=function(t){if(this.mode=t.getString("mode","nearest"),this.scales=t.getFloats("scales"),"nearest"!==this.mode&&"linear"!==this.mode)throw new Error("unrecognized mode: "+this.mode);if("linear"===this.mode&&2!==this.scales.length&&4!==this.scales.length)throw new Error("only support 2-D or 4-D upsampling for linear mode");this.roi=new Array(2*this.scales.length).fill(0)},t.prototype.checkInputs=function(t){return!(!t||1!==t.length)&&t[0].dims.length===this.scales.length&&this.checkInputTypes(t)},t.prototype.checkInputTypes=function(t){return"string"!==t[0].type},t}();e.Upsample=r},function(t,e,n){(function(t,r){var i;(function(){"use strict";var o={function:!0,object:!0},a=o[typeof window]&&window||this,s=o[typeof e]&&e,l=o[typeof t]&&t&&!t.nodeType&&t,c=s&&l&&"object"==typeof r&&r;!c||c.global!==c&&c.window!==c&&c.self!==c||(a=c);var u=Math.pow(2,53)-1,h=/\bOpera/,d=Object.prototype,p=d.hasOwnProperty,f=d.toString;function m(t){return(t=String(t)).charAt(0).toUpperCase()+t.slice(1)}function g(t){return t=_(t),/^(?:webOS|i(?:OS|P))/.test(t)?t:m(t)}function y(t,e){for(var n in t)p.call(t,n)&&e(t[n],n,t)}function v(t){return null==t?m(t):f.call(t).slice(8,-1)}function b(t){return String(t).replace(/([ -])(?!$)/g,"$1?")}function x(t,e){var n=null;return function(t,e){var n=-1,r=t?t.length:0;if("number"==typeof r&&r>-1&&r<=u)for(;++n<r;)e(t[n],n);else y(t,e)}(t,(function(r,i){n=e(n,r,i,t)})),n}function _(t){return String(t).replace(/^ +| +$/g,"")}var w=function t(e){var n=a,r=e&&"object"==typeof e&&"String"!=v(e);r&&(n=e,e=null);var i=n.navigator||{},o=i.userAgent||"";e||(e=o);var s,l,c,u,d,p=r?!!i.likeChrome:/\bChrome\b/.test(e)&&!/internal|\n/i.test(f.toString()),m=r?"Object":"ScriptBridgingProxyObject",w=r?"Object":"Environment",S=r&&n.java?"JavaPackage":v(n.java),T=r?"Object":"RuntimeObject",E=/\bJava/.test(S)&&n.java,M=E&&v(n.environment)==w,C=E?"a":"\u03b1",A=E?"b":"\u03b2",k=n.document||{},I=n.operamini||n.opera,R=h.test(R=r&&I?I["[[Class]]"]:v(I))?R:I=null,P=e,N=[],O=null,D=e==o,L=D&&I&&"function"==typeof I.version&&I.version(),F=x([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"],(function(t,n){return t||RegExp("\\b"+(n.pattern||b(n))+"\\b","i").exec(e)&&(n.label||n)})),U=x(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"(?:Edge|Edg|EdgA|EdgiOS)"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Vivaldi","Waterfox","WebPositive",{label:"Yandex Browser",pattern:"YaBrowser"},{label:"UC Browser",pattern:"UCBrowser"},"Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chromium","Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"],(function(t,n){return t||RegExp("\\b"+(n.pattern||b(n))+"\\b","i").exec(e)&&(n.label||n)})),B=V([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),z=x({Apple:{iPad:1,iPhone:1,iPod:1},Alcatel:{},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},Huawei:{},Lenovo:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Oppo:{},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1},Xiaomi:{Mi:1,Redmi:1}},(function(t,n,r){return t||(n[B]||n[/^[a-z]+(?: +[a-z]+\b)*/i.exec(B)]||RegExp("\\b"+b(r)+"(?:\\b|\\w*\\d)","i").exec(e))&&r})),j=x(["Windows Phone","KaiOS","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian",{label:"DragonFly BSD",pattern:"DragonFly"},"Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "],(function(t,n){var r=n.pattern||b(n);return!t&&(t=RegExp("\\b"+r+"(?:/[\\d.]+|[ \\w.]*)","i").exec(e))&&(t=function(t,e,n){var r={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return e&&n&&/^Win/i.test(t)&&!/^Windows Phone /i.test(t)&&(r=r[/[\d.]+$/.exec(t)])&&(t="Windows "+r),t=String(t),e&&n&&(t=t.replace(RegExp(e,"i"),n)),g(t.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}(t,r,n.label||n)),t}));function V(t){return x(t,(function(t,n){var r=n.pattern||b(n);return!t&&(t=RegExp("\\b"+r+" *\\d+[.\\w_]*","i").exec(e)||RegExp("\\b"+r+" *\\w+-[\\w]*","i").exec(e)||RegExp("\\b"+r+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(e))&&((t=String(n.label&&!RegExp(r,"i").test(n.label)?n.label:t).split("/"))[1]&&!/[\d.]+/.test(t[0])&&(t[0]+=" "+t[1]),n=n.label||n,t=g(t[0].replace(RegExp(r,"i"),n).replace(RegExp("; *(?:"+n+"[_-])?","i")," ").replace(RegExp("("+n+")[-_.]?(\\w)","i"),"$1 $2"))),t}))}function W(t){return x(t,(function(t,n){return t||(RegExp(n+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(e)||0)[1]||null}))}if(F&&(F=[F]),/\bAndroid\b/.test(j)&&!B&&(s=/\bAndroid[^;]*;(.*?)(?:Build|\) AppleWebKit)\b/i.exec(e))&&(B=_(s[1]).replace(/^[a-z]{2}-[a-z]{2};\s*/i,"")||null),z&&!B?B=V([z]):z&&B&&(B=B.replace(RegExp("^("+b(z)+")[-_.\\s]","i"),z+" ").replace(RegExp("^("+b(z)+")[-_.]?(\\w)","i"),z+" $2")),(s=/\bGoogle TV\b/.exec(B))&&(B=s[0]),/\bSimulator\b/i.test(e)&&(B=(B?B+" ":"")+"Simulator"),"Opera Mini"==U&&/\bOPiOS\b/.test(e)&&N.push("running in Turbo/Uncompressed mode"),"IE"==U&&/\blike iPhone OS\b/.test(e)?(z=(s=t(e.replace(/like iPhone OS/,""))).manufacturer,B=s.product):/^iP/.test(B)?(U||(U="Safari"),j="iOS"+((s=/ OS ([\d_]+)/i.exec(e))?" "+s[1].replace(/_/g,"."):"")):"Konqueror"==U&&/^Linux\b/i.test(j)?j="Kubuntu":z&&"Google"!=z&&(/Chrome/.test(U)&&!/\bMobile Safari\b/i.test(e)||/\bVita\b/.test(B))||/\bAndroid\b/.test(j)&&/^Chrome/.test(U)&&/\bVersion\//i.test(e)?(U="Android Browser",j=/\bAndroid\b/.test(j)?j:"Android"):"Silk"==U?(/\bMobi/i.test(e)||(j="Android",N.unshift("desktop mode")),/Accelerated *= *true/i.test(e)&&N.unshift("accelerated")):"UC Browser"==U&&/\bUCWEB\b/.test(e)?N.push("speed mode"):"PaleMoon"==U&&(s=/\bFirefox\/([\d.]+)\b/.exec(e))?N.push("identifying as Firefox "+s[1]):"Firefox"==U&&(s=/\b(Mobile|Tablet|TV)\b/i.exec(e))?(j||(j="Firefox OS"),B||(B=s[1])):!U||(s=!/\bMinefield\b/i.test(e)&&/\b(?:Firefox|Safari)\b/.exec(U))?(U&&!B&&/[\/,]|^[^(]+?\)/.test(e.slice(e.indexOf(s+"/")+8))&&(U=null),(s=B||z||j)&&(B||z||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(j))&&(U=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(j)?j:s)+" Browser")):"Electron"==U&&(s=(/\bChrome\/([\d.]+)\b/.exec(e)||0)[1])&&N.push("Chromium "+s),L||(L=W(["(?:Cloud9|CriOS|CrMo|Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$)|UCBrowser|YaBrowser)","Version",b(U),"(?:Firefox|Minefield|NetFront)"])),(s=("iCab"==F&&parseFloat(L)>3?"WebKit":/\bOpera\b/.test(U)&&(/\bOPR\b/.test(e)?"Blink":"Presto"))||/\b(?:Midori|Nook|Safari)\b/i.test(e)&&!/^(?:Trident|EdgeHTML)$/.test(F)&&"WebKit"||!F&&/\bMSIE\b/i.test(e)&&("Mac OS"==j?"Tasman":"Trident")||"WebKit"==F&&/\bPlayStation\b(?! Vita\b)/i.test(U)&&"NetFront")&&(F=[s]),"IE"==U&&(s=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(e)||0)[1])?(U+=" Mobile",j="Windows Phone "+(/\+$/.test(s)?s:s+".x"),N.unshift("desktop mode")):/\bWPDesktop\b/i.test(e)?(U="IE Mobile",j="Windows Phone 8.x",N.unshift("desktop mode"),L||(L=(/\brv:([\d.]+)/.exec(e)||0)[1])):"IE"!=U&&"Trident"==F&&(s=/\brv:([\d.]+)/.exec(e))&&(U&&N.push("identifying as "+U+(L?" "+L:"")),U="IE",L=s[1]),D){if(u="global",d=null!=(c=n)?typeof c[u]:"number",/^(?:boolean|number|string|undefined)$/.test(d)||"object"==d&&!c[u])v(s=n.runtime)==m?(U="Adobe AIR",j=s.flash.system.Capabilities.os):v(s=n.phantom)==T?(U="PhantomJS",L=(s=s.version||null)&&s.major+"."+s.minor+"."+s.patch):"number"==typeof k.documentMode&&(s=/\bTrident\/(\d+)/i.exec(e))?(L=[L,k.documentMode],(s=+s[1]+4)!=L[1]&&(N.push("IE "+L[1]+" mode"),F&&(F[1]=""),L[1]=s),L="IE"==U?String(L[1].toFixed(1)):L[0]):"number"==typeof k.documentMode&&/^(?:Chrome|Firefox)\b/.test(U)&&(N.push("masking as "+U+" "+L),U="IE",L="11.0",F=["Trident"],j="Windows");else if(E&&(P=(s=E.lang.System).getProperty("os.arch"),j=j||s.getProperty("os.name")+" "+s.getProperty("os.version")),M){try{L=n.require("ringo/engine").version.join("."),U="RingoJS"}catch(t){(s=n.system)&&s.global.system==n.system&&(U="Narwhal",j||(j=s[0].os||null))}U||(U="Rhino")}else"object"==typeof n.process&&!n.process.browser&&(s=n.process)&&("object"==typeof s.versions&&("string"==typeof s.versions.electron?(N.push("Node "+s.versions.node),U="Electron",L=s.versions.electron):"string"==typeof s.versions.nw&&(N.push("Chromium "+L,"Node "+s.versions.node),U="NW.js",L=s.versions.nw)),U||(U="Node.js",P=s.arch,j=s.platform,L=(L=/[\d.]+/.exec(s.version))?L[0]:null));j=j&&g(j)}if(L&&(s=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(L)||/(?:alpha|beta)(?: ?\d)?/i.exec(e+";"+(D&&i.appMinorVersion))||/\bMinefield\b/i.test(e)&&"a")&&(O=/b/i.test(s)?"beta":"alpha",L=L.replace(RegExp(s+"\\+?$"),"")+("beta"==O?A:C)+(/\d+\+?/.exec(s)||"")),"Fennec"==U||"Firefox"==U&&/\b(?:Android|Firefox OS|KaiOS)\b/.test(j))U="Firefox Mobile";else if("Maxthon"==U&&L)L=L.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(B))"Xbox 360"==B&&(j=null),"Xbox 360"==B&&/\bIEMobile\b/.test(e)&&N.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(U)&&(!U||B||/Browser|Mobi/.test(U))||"Windows CE"!=j&&!/Mobi/i.test(e))if("IE"==U&&D)try{null===n.external&&N.unshift("platform preview")}catch(t){N.unshift("embedded")}else(/\bBlackBerry\b/.test(B)||/\bBB10\b/.test(e))&&(s=(RegExp(B.replace(/ +/g," *")+"/([.\\d]+)","i").exec(e)||0)[1]||L)?(j=((s=[s,/BB10/.test(e)])[1]?(B=null,z="BlackBerry"):"Device Software")+" "+s[0],L=null):this!=y&&"Wii"!=B&&(D&&I||/Opera/.test(U)&&/\b(?:MSIE|Firefox)\b/i.test(e)||"Firefox"==U&&/\bOS X (?:\d+\.){2,}/.test(j)||"IE"==U&&(j&&!/^Win/.test(j)&&L>5.5||/\bWindows XP\b/.test(j)&&L>8||8==L&&!/\bTrident\b/.test(e)))&&!h.test(s=t.call(y,e.replace(h,"")+";"))&&s.name&&(s="ing as "+s.name+((s=s.version)?" "+s:""),h.test(U)?(/\bIE\b/.test(s)&&"Mac OS"==j&&(j=null),s="identify"+s):(s="mask"+s,U=R?g(R.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(s)&&(j=null),D||(L=null)),F=["Presto"],N.push(s));else U+=" Mobile";(s=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(e)||0)[1])&&(s=[parseFloat(s.replace(/\.(\d)$/,".0$1")),s],"Safari"==U&&"+"==s[1].slice(-1)?(U="WebKit Nightly",O="alpha",L=s[1].slice(0,-1)):L!=s[1]&&L!=(s[2]=(/\bSafari\/([\d.]+\+?)/i.exec(e)||0)[1])||(L=null),s[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(e)||0)[1],537.36==s[0]&&537.36==s[2]&&parseFloat(s[1])>=28&&"WebKit"==F&&(F=["Blink"]),D&&(p||s[1])?(F&&(F[1]="like Chrome"),s=s[1]||((s=s[0])<530?1:s<532?2:s<532.05?3:s<533?4:s<534.03?5:s<534.07?6:s<534.1?7:s<534.13?8:s<534.16?9:s<534.24?10:s<534.3?11:s<535.01?12:s<535.02?"13+":s<535.07?15:s<535.11?16:s<535.19?17:s<536.05?18:s<536.1?19:s<537.01?20:s<537.11?"21+":s<537.13?23:s<537.18?24:s<537.24?25:s<537.36?26:"Blink"!=F?"27":"28")):(F&&(F[1]="like Safari"),s=(s=s[0])<400?1:s<500?2:s<526?3:s<533?4:s<534?"4+":s<535?5:s<537?6:s<538?7:s<601?8:s<602?9:s<604?10:s<606?11:s<608?12:"12"),F&&(F[1]+=" "+(s+="number"==typeof s?".x":/[.+]/.test(s)?"":"+")),"Safari"==U&&(!L||parseInt(L)>45)?L=s:"Chrome"==U&&/\bHeadlessChrome/i.test(e)&&N.unshift("headless")),"Opera"==U&&(s=/\bzbov|zvav$/.exec(j))?(U+=" ",N.unshift("desktop mode"),"zvav"==s?(U+="Mini",L=null):U+="Mobile",j=j.replace(RegExp(" *"+s+"$"),"")):"Safari"==U&&/\bChrome\b/.exec(F&&F[1])?(N.unshift("desktop mode"),U="Chrome Mobile",L=null,/\bOS X\b/.test(j)?(z="Apple",j="iOS 4.3+"):j=null):/\bSRWare Iron\b/.test(U)&&!L&&(L=W("Chrome")),L&&0==L.indexOf(s=/[\d.]+$/.exec(j))&&e.indexOf("/"+s+"-")>-1&&(j=_(j.replace(s,""))),j&&-1!=j.indexOf(U)&&!RegExp(U+" OS").test(j)&&(j=j.replace(RegExp(" *"+b(U)+" *"),"")),F&&!/\b(?:Avant|Nook)\b/.test(U)&&(/Browser|Lunascape|Maxthon/.test(U)||"Safari"!=U&&/^iOS/.test(j)&&/\bSafari\b/.test(F[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|SRWare Iron|Vivaldi|Web)/.test(U)&&F[1])&&(s=F[F.length-1])&&N.push(s),N.length&&(N=["("+N.join("; ")+")"]),z&&B&&B.indexOf(z)<0&&N.push("on "+z),B&&N.push((/^on /.test(N[N.length-1])?"":"on ")+B),j&&(s=/ ([\d.+]+)$/.exec(j),l=s&&"/"==j.charAt(j.length-s[0].length-1),j={architecture:32,family:s&&!l?j.replace(s[0],""):j,version:s?s[1]:null,toString:function(){var t=this.version;return this.family+(t&&!l?" "+t:"")+(64==this.architecture?" 64-bit":"")}}),(s=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(P))&&!/\bi686\b/i.test(P)?(j&&(j.architecture=64,j.family=j.family.replace(RegExp(" *"+s),"")),U&&(/\bWOW64\b/i.test(e)||D&&/\w(?:86|32)$/.test(i.cpuClass||i.platform)&&!/\bWin64; x64\b/i.test(e))&&N.unshift("32-bit")):j&&/^OS X/.test(j.family)&&"Chrome"==U&&parseFloat(L)>=39&&(j.architecture=64),e||(e=null);var G={};return G.description=e,G.layout=F&&F[0],G.manufacturer=z,G.name=U,G.prerelease=O,G.product=B,G.ua=e,G.version=U&&L,G.os=j||{architecture:null,family:null,version:null,toString:function(){return"null"}},G.parse=t,G.toString=function(){return this.description||""},G.version&&N.unshift(L),G.name&&N.unshift(U),j&&U&&(j!=String(j).split(" ")[0]||j!=U.split(" ")[0]&&!B)&&N.push(B?"("+j+")":"on "+j),N.length&&(G.description=N.join(" ")),G}();a.platform=w,void 0===(i=function(){return w}.call(e,n,e,t))||(t.exports=i)}).call(this)}).call(this,n(102)(t),n(8))},function(t,e,n){(function(t){function n(t,e){for(var n=0,r=t.length-1;r>=0;r--){var i=t[r];"."===i?t.splice(r,1):".."===i?(t.splice(r,1),n++):n&&(t.splice(r,1),n--)}if(e)for(;n--;n)t.unshift("..");return t}function r(t,e){if(t.filter)return t.filter(e);for(var n=[],r=0;r<t.length;r++)e(t[r],r,t)&&n.push(t[r]);return n}e.resolve=function(){for(var e="",i=!1,o=arguments.length-1;o>=-1&&!i;o--){var a=o>=0?arguments[o]:t.cwd();if("string"!=typeof a)throw new TypeError("Arguments to path.resolve must be strings");a&&(e=a+"/"+e,i="/"===a.charAt(0))}return(i?"/":"")+(e=n(r(e.split("/"),(function(t){return!!t})),!i).join("/"))||"."},e.normalize=function(t){var o=e.isAbsolute(t),a="/"===i(t,-1);return(t=n(r(t.split("/"),(function(t){return!!t})),!o).join("/"))||o||(t="."),t&&a&&(t+="/"),(o?"/":"")+t},e.isAbsolute=function(t){return"/"===t.charAt(0)},e.join=function(){var t=Array.prototype.slice.call(arguments,0);return e.normalize(r(t,(function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t})).join("/"))},e.relative=function(t,n){function r(t){for(var e=0;e<t.length&&""===t[e];e++);for(var n=t.length-1;n>=0&&""===t[n];n--);return e>n?[]:t.slice(e,n-e+1)}t=e.resolve(t).substr(1),n=e.resolve(n).substr(1);for(var i=r(t.split("/")),o=r(n.split("/")),a=Math.min(i.length,o.length),s=a,l=0;l<a;l++)if(i[l]!==o[l]){s=l;break}var c=[];for(l=s;l<i.length;l++)c.push("..");return(c=c.concat(o.slice(s))).join("/")},e.sep="/",e.delimiter=":",e.dirname=function(t){if("string"!=typeof t&&(t+=""),0===t.length)return".";for(var e=t.charCodeAt(0),n=47===e,r=-1,i=!0,o=t.length-1;o>=1;--o)if(47===(e=t.charCodeAt(o))){if(!i){r=o;break}}else i=!1;return-1===r?n?"/":".":n&&1===r?"/":t.slice(0,r)},e.basename=function(t,e){var n=function(t){"string"!=typeof t&&(t+="");var e,n=0,r=-1,i=!0;for(e=t.length-1;e>=0;--e)if(47===t.charCodeAt(e)){if(!i){n=e+1;break}}else-1===r&&(i=!1,r=e+1);return-1===r?"":t.slice(n,r)}(t);return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n},e.extname=function(t){"string"!=typeof t&&(t+="");for(var e=-1,n=0,r=-1,i=!0,o=0,a=t.length-1;a>=0;--a){var s=t.charCodeAt(a);if(47!==s)-1===r&&(i=!1,r=a+1),46===s?-1===e?e=a:1!==o&&(o=1):-1!==e&&(o=-1);else if(!i){n=a+1;break}}return-1===e||-1===r||0===o||1===o&&e===r-1&&e===n+1?"":t.slice(e,r)};var i=function(t,e,n){return t.substr(e,n)}}).call(this,n(24))},function(t,e){},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Clip=void 0;var r=function(){function t(){}return t.prototype.initialize=function(t){this.min=t.getFloat("min",-34028234663852886e22),this.max=t.getFloat("max",34028234663852886e22)},t.prototype.checkInputs=function(t){return!(!t||1!==t.length)&&this.checkInputTypes(t)},t.prototype.checkInputTypes=function(t){return"float32"===t[0].type||"float64"===t[0].type},t}();e.Clip=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getPackedShape=void 0,e.getPackedShape=function(t){var e=t.length;return t.slice(0,e-1).concat(t[e-1]/4)}},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e},a=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},s=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(a(arguments[e]));return t};Object.defineProperty(e,"__esModule",{value:!0}),e.Tensor=void 0;var l=n(1),c=o(n(52)),u=function(){function t(t,e,n){var r=n||[t.length];if(0===t.length)throw new RangeError("Tensor data should contain at least one element.");Array.isArray(t)&&"string"!==e?"float32"===e?this.data=Float32Array.from(t):"bool"===e?this.data=new Uint8Array(t):"int32"===e&&(this.data=Int32Array.from(t)):this.data=t,this.dims=r,this.type=e,this.internalTensor=new l.Tensor(this.dims,this.type,void 0,void 0,this.data),this.size=this.internalTensor.size}return t.prototype.get=function(t){for(var e=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=[];if("number"==typeof t)i=s([t],n);else{if(!t)throw new Error("Input index array is undefined. ");i=t}if(c.validateIndices(i),i.length!==this.dims.length)throw new RangeError("Input index array dims don't match the tensor dims.");i.forEach((function(t,n){if(t>=e.dims[n])throw new RangeError("Input index array dims don't match the tensor dims.")}));var o=this.internalTensor.get(i);return"bool"===this.type?1===o:o},t.prototype.set=function(t,e){for(var n=this,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];c.matchElementType(this.type,t);var o=[];if("number"==typeof e)o=s([e],r);else{if(!e)throw new Error("Input index array is undefined.");o=e}if(c.validateIndices(o),o.length!==this.dims.length)throw new RangeError("Input index array dims don't match the tensor dims.");o.forEach((function(t,e){if(t>=n.dims[e])throw new RangeError("Input index array dims don't match the tensor dims.")})),"boolean"==typeof t?this.internalTensor.set(o,t?1:0):this.internalTensor.set(o,t)},t}();e.Tensor=u},function(t,e,n){"use strict";var r=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.validateIndices=e.matchElementType=e.toInternalTensor=e.fromInternalTensor=void 0;var i=n(1),o=n(51);e.fromInternalTensor=function(t){switch(t.type){case"bool":return new o.Tensor(new Uint8Array(t.integerData),"bool",t.dims);case"float32":return new o.Tensor(t.floatData,"float32",t.dims);case"float64":return new o.Tensor(new Float32Array(t.floatData),"float32",t.dims);case"string":return new o.Tensor(t.stringData,"string",t.dims);case"int8":return new o.Tensor(new Int32Array(t.integerData),"int32",t.dims);case"int32":return new o.Tensor(t.integerData,"int32",t.dims);default:throw new TypeError("Tensor type is not supported. ")}},e.toInternalTensor=function(t){return new i.Tensor(t.dims,t.type,void 0,void 0,t.data)},e.matchElementType=function(t,e){switch(typeof e){case"string":if("string"!==t)throw new TypeError("The new element type doesn't match the tensor data type.");break;case"number":if("float32"!==t&&"int32"!==t)throw new TypeError("The new element type doesn't match the tensor data type.");if("float32"===t&&Number.isInteger(e))throw new TypeError("The new element type doesn't match the tensor data type.");if("int32"===t&&!Number.isInteger(e))throw new TypeError("The new element type doesn't match the tensor data type.");break;case"boolean":if("bool"!==t)throw new TypeError("The new element type doesn't match the tensor data type.");break;default:throw new TypeError("The new element type is not supported.")}},e.validateIndices=function(t){var e,n;if(t.length<0||t.length>6)throw new RangeError("Only rank 0 to 6 is supported for tensor shape.");try{for(var i=r(t),o=i.next();!o.done;o=i.next()){var a=o.value;if(!Number.isInteger(a))throw new TypeError("Invalid index: "+a+" is not an integer");if(a<0||a>2147483647)throw new TypeError("Invalid index: length "+a+" is not allowed")}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}}},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||e.hasOwnProperty(n)||r(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),e.ENV=e.backend=void 0;var o=n(54),a=n(101),s=n(119),l=n(168);i(n(169),e),i(n(170),e),i(n(171),e),i(n(172),e),e.backend={cpu:new o.CpuBackend,wasm:new a.WasmBackend,webgl:new s.WebGLBackend},e.ENV=l.envImpl},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CpuBackend=void 0;var r=n(55),i=function(){function t(){}return t.prototype.initialize=function(){return!0},t.prototype.createSessionHandler=function(t){return new r.CpuSessionHandler(this,t)},t.prototype.dispose=function(){},t}();e.CpuBackend=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CpuSessionHandler=void 0;var r=n(11),i=n(56),o=n(27),a=function(){function t(t,e){this.backend=t,this.context=e}return t.prototype.createInferenceHandler=function(){return new i.CpuInferenceHandler(this,this.context.profiler)},t.prototype.dispose=function(){},t.prototype.resolve=function(t,e){var n=r.resolveOperator(t,e,o.CPU_OP_RESOLVE_RULES);return n.initialize(t.attributes),n},t}();e.CpuSessionHandler=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CpuInferenceHandler=void 0;var r=function(){function t(t,e){this.session=t,this.profiler=e}return t.prototype.dispose=function(){},t}();e.CpuInferenceHandler=r},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.argMax=e.CpuArgMax=void 0;var o=n(58),a=n(1),s=n(0),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return[c(e[0],this.axis,this.keepDims)]},e}(o.ArgMax);function c(t,e,n){var r=t.dims?t.dims.length:1;e=s.ShapeUtil.normalizeAxis(e,r);for(var i=s.ReduceUtil.calcReduceShape(t.dims,[e],!0),o=t.data,l=new Int32Array(s.ShapeUtil.size(i)),c=s.ShapeUtil.sizeFromDimension(t.dims,e+1),u=s.ShapeUtil.computeStrides(i),h=s.ShapeUtil.computeStrides(t.dims),d=new Array(t.dims.length),p=0;p<l.length;p++){var f=s.ShapeUtil.offsetToIndices(p,u);s.BroadcastUtil.fillIndex(f,t.dims,d);for(var m=s.ShapeUtil.indicesToOffset(d,h),g=t.data[m],y=0,v=0;v<t.dims[e];++v){var b=o[m+v*c];b>g&&(g=b,y=v)}l[p]=y}return new a.Tensor(n?i:s.ReduceUtil.calcReduceShape(t.dims,[e],n),"int32",void 0,void 0,l)}e.CpuArgMax=l,e.argMax=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ArgMax=void 0;var r=n(7),i=function(){function t(){}return t.prototype.initialize=function(t){this.axis=t.getInt("axis",0),this.keepDims=1===t.getInt("keepdims",1)},t.prototype.checkInputs=function(t){return!(!t||1!==t.length)&&this.checkInputTypes(t)},t.prototype.checkInputTypes=function(t){return-1!==r.NUMBER_TYPES.indexOf(t[0].type)},t}();e.ArgMax=i},function(t,e,n){"use strict";e.byteLength=function(t){var e=l(t),n=e[0],r=e[1];return 3*(n+r)/4-r},e.toByteArray=function(t){var e,n,r=l(t),a=r[0],s=r[1],c=new o(function(t,e,n){return 3*(e+n)/4-n}(0,a,s)),u=0,h=s>0?a-4:a;for(n=0;n<h;n+=4)e=i[t.charCodeAt(n)]<<18|i[t.charCodeAt(n+1)]<<12|i[t.charCodeAt(n+2)]<<6|i[t.charCodeAt(n+3)],c[u++]=e>>16&255,c[u++]=e>>8&255,c[u++]=255&e;return 2===s&&(e=i[t.charCodeAt(n)]<<2|i[t.charCodeAt(n+1)]>>4,c[u++]=255&e),1===s&&(e=i[t.charCodeAt(n)]<<10|i[t.charCodeAt(n+1)]<<4|i[t.charCodeAt(n+2)]>>2,c[u++]=e>>8&255,c[u++]=255&e),c},e.fromByteArray=function(t){for(var e,n=t.length,i=n%3,o=[],a=0,s=n-i;a<s;a+=16383)o.push(c(t,a,a+16383>s?s:a+16383));return 1===i?(e=t[n-1],o.push(r[e>>2]+r[e<<4&63]+"==")):2===i&&(e=(t[n-2]<<8)+t[n-1],o.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"=")),o.join("")};for(var r=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0;s<64;++s)r[s]=a[s],i[a.charCodeAt(s)]=s;function l(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function c(t,e,n){for(var i,o,a=[],s=e;s<n;s+=3)i=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(255&t[s+2]),a.push(r[(o=i)>>18&63]+r[o>>12&63]+r[o>>6&63]+r[63&o]);return a.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,n,r,i){var o,a,s=8*i-r-1,l=(1<<s)-1,c=l>>1,u=-7,h=n?i-1:0,d=n?-1:1,p=t[e+h];for(h+=d,o=p&(1<<-u)-1,p>>=-u,u+=s;u>0;o=256*o+t[e+h],h+=d,u-=8);for(a=o&(1<<-u)-1,o>>=-u,u+=r;u>0;a=256*a+t[e+h],h+=d,u-=8);if(0===o)o=1-c;else{if(o===l)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,r),o-=c}return(p?-1:1)*a*Math.pow(2,o-r)},e.write=function(t,e,n,r,i,o){var a,s,l,c=8*o-i-1,u=(1<<c)-1,h=u>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,f=r?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=u):(a=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-a))<1&&(a--,l*=2),(e+=a+h>=1?d/l:d*Math.pow(2,1-h))*l>=2&&(a++,l/=2),a+h>=u?(s=0,a=u):a+h>=1?(s=(e*l-1)*Math.pow(2,i),a+=h):(s=e*Math.pow(2,h-1)*Math.pow(2,i),a=0));i>=8;t[n+p]=255&s,p+=f,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;t[n+p]=255&a,p+=f,a/=256,c-=8);t[n+p-f]|=128*m}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e,n){"use strict";t.exports=n(63)},function(t,e,n){"use strict";var r=e;function i(){r.util._configure(),r.Writer._configure(r.BufferWriter),r.Reader._configure(r.BufferReader)}r.build="minimal",r.Writer=n(28),r.BufferWriter=n(72),r.Reader=n(29),r.BufferReader=n(73),r.util=n(6),r.rpc=n(74),r.roots=n(76),r.configure=i,i()},function(t,e,n){"use strict";t.exports=function(t,e){for(var n=new Array(arguments.length-1),r=0,i=2,o=!0;i<arguments.length;)n[r++]=arguments[i++];return new Promise((function(i,a){n[r]=function(t){if(o)if(o=!1,t)a(t);else{for(var e=new Array(arguments.length-1),n=0;n<e.length;)e[n++]=arguments[n];i.apply(null,e)}};try{t.apply(e||null,n)}catch(t){o&&(o=!1,a(t))}}))}},function(t,e,n){"use strict";var r=e;r.length=function(t){var e=t.length;if(!e)return 0;for(var n=0;--e%4>1&&"="===t.charAt(e);)++n;return Math.ceil(3*t.length)/4-n};for(var i=new Array(64),o=new Array(123),a=0;a<64;)o[i[a]=a<26?a+65:a<52?a+71:a<62?a-4:a-59|43]=a++;r.encode=function(t,e,n){for(var r,o=null,a=[],s=0,l=0;e<n;){var c=t[e++];switch(l){case 0:a[s++]=i[c>>2],r=(3&c)<<4,l=1;break;case 1:a[s++]=i[r|c>>4],r=(15&c)<<2,l=2;break;case 2:a[s++]=i[r|c>>6],a[s++]=i[63&c],l=0}s>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,a)),s=0)}return l&&(a[s++]=i[r],a[s++]=61,1===l&&(a[s++]=61)),o?(s&&o.push(String.fromCharCode.apply(String,a.slice(0,s))),o.join("")):String.fromCharCode.apply(String,a.slice(0,s))},r.decode=function(t,e,n){for(var r,i=n,a=0,s=0;s<t.length;){var l=t.charCodeAt(s++);if(61===l&&a>1)break;if(void 0===(l=o[l]))throw Error("invalid encoding");switch(a){case 0:r=l,a=1;break;case 1:e[n++]=r<<2|(48&l)>>4,r=l,a=2;break;case 2:e[n++]=(15&r)<<4|(60&l)>>2,r=l,a=3;break;case 3:e[n++]=(3&r)<<6|l,a=0}}if(1===a)throw Error("invalid encoding");return n-i},r.test=function(t){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(t)}},function(t,e,n){"use strict";function r(){this._listeners={}}t.exports=r,r.prototype.on=function(t,e,n){return(this._listeners[t]||(this._listeners[t]=[])).push({fn:e,ctx:n||this}),this},r.prototype.off=function(t,e){if(void 0===t)this._listeners={};else if(void 0===e)this._listeners[t]=[];else for(var n=this._listeners[t],r=0;r<n.length;)n[r].fn===e?n.splice(r,1):++r;return this},r.prototype.emit=function(t){var e=this._listeners[t];if(e){for(var n=[],r=1;r<arguments.length;)n.push(arguments[r++]);for(r=0;r<e.length;)e[r].fn.apply(e[r++].ctx,n)}return this}},function(t,e,n){"use strict";function r(t){return"undefined"!=typeof Float32Array?function(){var e=new Float32Array([-0]),n=new Uint8Array(e.buffer),r=128===n[3];function i(t,r,i){e[0]=t,r[i]=n[0],r[i+1]=n[1],r[i+2]=n[2],r[i+3]=n[3]}function o(t,r,i){e[0]=t,r[i]=n[3],r[i+1]=n[2],r[i+2]=n[1],r[i+3]=n[0]}function a(t,r){return n[0]=t[r],n[1]=t[r+1],n[2]=t[r+2],n[3]=t[r+3],e[0]}function s(t,r){return n[3]=t[r],n[2]=t[r+1],n[1]=t[r+2],n[0]=t[r+3],e[0]}t.writeFloatLE=r?i:o,t.writeFloatBE=r?o:i,t.readFloatLE=r?a:s,t.readFloatBE=r?s:a}():function(){function e(t,e,n,r){var i=e<0?1:0;if(i&&(e=-e),0===e)t(1/e>0?0:2147483648,n,r);else if(isNaN(e))t(2143289344,n,r);else if(e>34028234663852886e22)t((i<<31|2139095040)>>>0,n,r);else if(e<11754943508222875e-54)t((i<<31|Math.round(e/1401298464324817e-60))>>>0,n,r);else{var o=Math.floor(Math.log(e)/Math.LN2);t((i<<31|o+127<<23|8388607&Math.round(e*Math.pow(2,-o)*8388608))>>>0,n,r)}}function n(t,e,n){var r=t(e,n),i=2*(r>>31)+1,o=r>>>23&255,a=8388607&r;return 255===o?a?NaN:i*(1/0):0===o?1401298464324817e-60*i*a:i*Math.pow(2,o-150)*(a+8388608)}t.writeFloatLE=e.bind(null,i),t.writeFloatBE=e.bind(null,o),t.readFloatLE=n.bind(null,a),t.readFloatBE=n.bind(null,s)}(),"undefined"!=typeof Float64Array?function(){var e=new Float64Array([-0]),n=new Uint8Array(e.buffer),r=128===n[7];function i(t,r,i){e[0]=t,r[i]=n[0],r[i+1]=n[1],r[i+2]=n[2],r[i+3]=n[3],r[i+4]=n[4],r[i+5]=n[5],r[i+6]=n[6],r[i+7]=n[7]}function o(t,r,i){e[0]=t,r[i]=n[7],r[i+1]=n[6],r[i+2]=n[5],r[i+3]=n[4],r[i+4]=n[3],r[i+5]=n[2],r[i+6]=n[1],r[i+7]=n[0]}function a(t,r){return n[0]=t[r],n[1]=t[r+1],n[2]=t[r+2],n[3]=t[r+3],n[4]=t[r+4],n[5]=t[r+5],n[6]=t[r+6],n[7]=t[r+7],e[0]}function s(t,r){return n[7]=t[r],n[6]=t[r+1],n[5]=t[r+2],n[4]=t[r+3],n[3]=t[r+4],n[2]=t[r+5],n[1]=t[r+6],n[0]=t[r+7],e[0]}t.writeDoubleLE=r?i:o,t.writeDoubleBE=r?o:i,t.readDoubleLE=r?a:s,t.readDoubleBE=r?s:a}():function(){function e(t,e,n,r,i,o){var a=r<0?1:0;if(a&&(r=-r),0===r)t(0,i,o+e),t(1/r>0?0:2147483648,i,o+n);else if(isNaN(r))t(0,i,o+e),t(2146959360,i,o+n);else if(r>17976931348623157e292)t(0,i,o+e),t((a<<31|2146435072)>>>0,i,o+n);else{var s;if(r<22250738585072014e-324)t((s=r/5e-324)>>>0,i,o+e),t((a<<31|s/4294967296)>>>0,i,o+n);else{var l=Math.floor(Math.log(r)/Math.LN2);1024===l&&(l=1023),t(4503599627370496*(s=r*Math.pow(2,-l))>>>0,i,o+e),t((a<<31|l+1023<<20|1048576*s&1048575)>>>0,i,o+n)}}}function n(t,e,n,r,i){var o=t(r,i+e),a=t(r,i+n),s=2*(a>>31)+1,l=a>>>20&2047,c=4294967296*(1048575&a)+o;return 2047===l?c?NaN:s*(1/0):0===l?5e-324*s*c:s*Math.pow(2,l-1075)*(c+4503599627370496)}t.writeDoubleLE=e.bind(null,i,0,4),t.writeDoubleBE=e.bind(null,o,4,0),t.readDoubleLE=n.bind(null,a,0,4),t.readDoubleBE=n.bind(null,s,4,0)}(),t}function i(t,e,n){e[n]=255&t,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24}function o(t,e,n){e[n]=t>>>24,e[n+1]=t>>>16&255,e[n+2]=t>>>8&255,e[n+3]=255&t}function a(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}function s(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}t.exports=r(r)},function(module,exports,__webpack_require__){"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(t){}return null}module.exports=inquire},function(t,e,n){"use strict";var r=e;r.length=function(t){for(var e=0,n=0,r=0;r<t.length;++r)(n=t.charCodeAt(r))<128?e+=1:n<2048?e+=2:55296==(64512&n)&&56320==(64512&t.charCodeAt(r+1))?(++r,e+=4):e+=3;return e},r.read=function(t,e,n){if(n-e<1)return"";for(var r,i=null,o=[],a=0;e<n;)(r=t[e++])<128?o[a++]=r:r>191&&r<224?o[a++]=(31&r)<<6|63&t[e++]:r>239&&r<365?(r=((7&r)<<18|(63&t[e++])<<12|(63&t[e++])<<6|63&t[e++])-65536,o[a++]=55296+(r>>10),o[a++]=56320+(1023&r)):o[a++]=(15&r)<<12|(63&t[e++])<<6|63&t[e++],a>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),a=0);return i?(a&&i.push(String.fromCharCode.apply(String,o.slice(0,a))),i.join("")):String.fromCharCode.apply(String,o.slice(0,a))},r.write=function(t,e,n){for(var r,i,o=n,a=0;a<t.length;++a)(r=t.charCodeAt(a))<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=63&r|128):55296==(64512&r)&&56320==(64512&(i=t.charCodeAt(a+1)))?(r=65536+((1023&r)<<10)+(1023&i),++a,e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=63&r|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=63&r|128);return n-o}},function(t,e,n){"use strict";t.exports=function(t,e,n){var r=n||8192,i=r>>>1,o=null,a=r;return function(n){if(n<1||n>i)return t(n);a+n>r&&(o=t(r),a=0);var s=e.call(o,a,a+=n);return 7&a&&(a=1+(7|a)),s}}},function(t,e,n){"use strict";t.exports=i;var r=n(6);function i(t,e){this.lo=t>>>0,this.hi=e>>>0}var o=i.zero=new i(0,0);o.toNumber=function(){return 0},o.zzEncode=o.zzDecode=function(){return this},o.length=function(){return 1};var a=i.zeroHash="\0\0\0\0\0\0\0\0";i.fromNumber=function(t){if(0===t)return o;var e=t<0;e&&(t=-t);var n=t>>>0,r=(t-n)/4294967296>>>0;return e&&(r=~r>>>0,n=~n>>>0,++n>4294967295&&(n=0,++r>4294967295&&(r=0))),new i(n,r)},i.from=function(t){if("number"==typeof t)return i.fromNumber(t);if(r.isString(t)){if(!r.Long)return i.fromNumber(parseInt(t,10));t=r.Long.fromString(t)}return t.low||t.high?new i(t.low>>>0,t.high>>>0):o},i.prototype.toNumber=function(t){if(!t&&this.hi>>>31){var e=1+~this.lo>>>0,n=~this.hi>>>0;return e||(n=n+1>>>0),-(e+4294967296*n)}return this.lo+4294967296*this.hi},i.prototype.toLong=function(t){return r.Long?new r.Long(0|this.lo,0|this.hi,Boolean(t)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(t)}};var s=String.prototype.charCodeAt;i.fromHash=function(t){return t===a?o:new i((s.call(t,0)|s.call(t,1)<<8|s.call(t,2)<<16|s.call(t,3)<<24)>>>0,(s.call(t,4)|s.call(t,5)<<8|s.call(t,6)<<16|s.call(t,7)<<24)>>>0)},i.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},i.prototype.zzEncode=function(){var t=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^t)>>>0,this.lo=(this.lo<<1^t)>>>0,this},i.prototype.zzDecode=function(){var t=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^t)>>>0,this.hi=(this.hi>>>1^t)>>>0,this},i.prototype.length=function(){var t=this.lo,e=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return 0===n?0===e?t<16384?t<128?1:2:t<2097152?3:4:e<16384?e<128?5:6:e<2097152?7:8:n<128?9:10}},function(t,e,n){"use strict";t.exports=o;var r=n(28);(o.prototype=Object.create(r.prototype)).constructor=o;var i=n(6);function o(){r.call(this)}function a(t,e,n){t.length<40?i.utf8.write(t,e,n):e.utf8Write?e.utf8Write(t,n):e.write(t,n)}o._configure=function(){o.alloc=i._Buffer_allocUnsafe,o.writeBytesBuffer=i.Buffer&&i.Buffer.prototype instanceof Uint8Array&&"set"===i.Buffer.prototype.set.name?function(t,e,n){e.set(t,n)}:function(t,e,n){if(t.copy)t.copy(e,n,0,t.length);else for(var r=0;r<t.length;)e[n++]=t[r++]}},o.prototype.bytes=function(t){i.isString(t)&&(t=i._Buffer_from(t,"base64"));var e=t.length>>>0;return this.uint32(e),e&&this._push(o.writeBytesBuffer,e,t),this},o.prototype.string=function(t){var e=i.Buffer.byteLength(t);return this.uint32(e),e&&this._push(a,e,t),this},o._configure()},function(t,e,n){"use strict";t.exports=o;var r=n(29);(o.prototype=Object.create(r.prototype)).constructor=o;var i=n(6);function o(t){r.call(this,t)}o._configure=function(){i.Buffer&&(o.prototype._slice=i.Buffer.prototype.slice)},o.prototype.string=function(){var t=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+t,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+t,this.len))},o._configure()},function(t,e,n){"use strict";e.Service=n(75)},function(t,e,n){"use strict";t.exports=i;var r=n(6);function i(t,e,n){if("function"!=typeof t)throw TypeError("rpcImpl must be a function");r.EventEmitter.call(this),this.rpcImpl=t,this.requestDelimited=Boolean(e),this.responseDelimited=Boolean(n)}(i.prototype=Object.create(r.EventEmitter.prototype)).constructor=i,i.prototype.rpcCall=function t(e,n,i,o,a){if(!o)throw TypeError("request must be specified");var s=this;if(!a)return r.asPromise(t,s,e,n,i,o);if(s.rpcImpl)try{return s.rpcImpl(e,n[s.requestDelimited?"encodeDelimited":"encode"](o).finish(),(function(t,n){if(t)return s.emit("error",t,e),a(t);if(null!==n){if(!(n instanceof i))try{n=i[s.responseDelimited?"decodeDelimited":"decode"](n)}catch(t){return s.emit("error",t,e),a(t)}return s.emit("data",n,e),a(null,n)}s.end(!0)}))}catch(t){return s.emit("error",t,e),void setTimeout((function(){a(t)}),0)}else setTimeout((function(){a(Error("already ended"))}),0)},i.prototype.end=function(t){return this.rpcImpl&&(t||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},function(t,e,n){"use strict";t.exports={}},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.batchNormalization=e.CpuBatchNormalization=void 0;var o=n(14),a=n(1),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return[l(e[0],e[1],e[2],e[3],e[4],this.epsilon,this.momentum,this.spatial)]},e}(o.BatchNormalization);function l(t,e,n,r,i,o,s,l){for(var c=t.dims,u=c[0],h=c[1],d=1,p=2;p<c.length;p++)d*=c[p];for(var f=new a.Tensor(t.dims,t.type),m=t.floatData,g=f.floatData,y=e.numberData,v=n.numberData,b=r.numberData,x=i.numberData,_=0;_<u*h;_++){var w=_*d;for(p=0;p<d;p++)g[w+p]=y[_%h]*((m[w+p]-b[_%h])/Math.sqrt(x[_%h]+o))+v[_%h]}return f}e.CpuBatchNormalization=s,e.batchNormalization=l},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.CpuBinaryOp=void 0;var o=n(15),a=n(0),s=function(t){function e(e,n,r,i){var o=t.call(this,e,r,i)||this;return o.opLambda=n,o}return i(e,t),e.prototype.initialize=function(t){if(!this.opType&&!this.opLambda)throw new Error("Both opType and opLambda cannot be missing for a binary op");if(!this.opLambda)throw this.opType,new Error("Binary op could not be initialized. Missing op lambda.")},e.prototype.run=function(t,e){return[function(t,e,n,r,i){var o=a.BroadcastUtil.calc(t,e,n,!1,i);if(!o)throw new Error("not broadcastable");return o}(e[0],e[1],this.opLambda,0,this.resultType)]},e}(o.BinaryOp);e.CpuBinaryOp=s},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),a=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.hasOwnProperty.call(t,n)&&o(e,t,n);return a(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.concat=e.CpuConcat=void 0;var l=n(30),c=n(1),u=s(n(0)),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return[d(e,this.axis)]},e}(l.Concat);function d(t,e){var n=t[0],r=n.dims;if(e>=r.length||e<-1*r.length)throw new Error("axis specified for concat doesn't match input dimensionality");e<0&&(e=r.length+e);for(var i=r[e],o=new Array(r.length),a=1;a<t.length;a++)for(var s=(g=t[a]).dims,l=0;l<r.length;l++){if(l===e)i+=s[l];else if(r[l]!==s[l])throw new Error("non concat dimensions must match");o[l]=s[l]}o[e]=i;var h=new c.Tensor(o,n.type),d=h.numberData,p=1;for(a=o.length-1;a>=e;a--)p*=o[a];for(var f=0,m=0;m<t.length;m++){var g,y=1;for(a=(g=t[m]).dims.length-1;a>=e;a--)y*=g.dims[a];for(var v=g.numberData,b=u.ShapeUtil.size(g.dims),x=f,_=(a=0,0);a<b;a++)d[x+a]=v[a],++_===y&&(x+=p-y,_=0);f+=y}return h}e.CpuConcat=h,e.concat=d},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.conv2d=e.CpuConv=void 0;var o=n(16),a=n(1),s=n(0),l=n(17),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){var n=e[0],r=e[1],i=3===e.length?e[2]:void 0;if(0===this.kernelShape.length)for(var o=e[1].dims,l=2;l<o.length;++l)this.kernelShape.push(o[l]);var c=s.PoolConvUtil.computeConvOutputShape(n.dims,r.dims,this.strides,this.dilations,this.kernelShape,this.pads,this.autoPad),h=new a.Tensor(c,n.type);return u(h,n,r,i,this.dilations,this.group,this.pads,this.strides),[h]},e}(o.Conv);function u(t,e,n,r,i,o,a,s){for(var c=e.dims[0],u=e.dims[1],d=e.dims[2],p=e.dims[3],f=n.dims[0],m=n.dims[1],g=n.dims[2],y=n.dims[3],v=f*m*g*y,b=[g,y],x=t.dims[0],_=t.dims[1],w=t.dims[2],S=t.dims[3],T=w*S,E=u/o*(d*p),M=x*_*w*S/x/o,C=v/o,A=u/o*(b[0]*b[1]),k=new Float32Array(A*T),I=0;I<c;++I){for(var R=0,P=0,N=0;N<o;++N)h(e.floatData.subarray(R+N*E),k,u/o,d,p,b[0],b[1],i[0],i[1],a[0],a[1],a[2],a[3],s[0],s[1]),l.matMul2d(n.floatData.subarray(N*C),k,t.floatData.subarray(P+N*M),!1,!1,1,0,f/o,T,A);R+=E*o,P+=M*o}if(r)for(var O=r.floatData,D=t.floatData,L=t.dims[0],F=t.dims[1],U=t.dims[2]*t.dims[3],B=F*U,z=0;z<L;++z)for(var j=0;j<F;++j)for(var V=z*B+j*U,W=0;W<U;++W)D[V+W]+=O[j]}function h(t,e,n,r,i,o,a,s,l,c,u,h,d,p,f){var m=1+~~((r+h+c-(s*(o-1)+1))/p),g=1+~~((i+u+d-(l*(a-1)+1))/f);if(1!==s||1!==l||0!==u||0!==d||0!==c||0!==h)for(var y=1+~~((r+c+h-(s*(o-1)+1))/p),v=1+~~((i+u+d-(l*(a-1)+1))/f),b=n*o*a,x=0;x<b;++x)for(var _=x%a,w=~~(x/a)%o,S=~~(x/(o*a)),T=0;T<y;++T)for(var E=0;E<v;++E){var M=T*p-c+w*s,C=E*f-u+_*l;e[(x*y+T)*v+E]=M>=0&&M<r&&C>=0&&C<i?t[(S*r+M)*i+C]:0}else for(var A=0;A<n*o*a;A++)for(var k=~~(A/(o*a)),I=A%(o*a),R=~~(I/a),P=I%a,N=k*(o*a*m*g)+R*(a*m*g)+P*(m*g),O=k*(r*i),D=0;D<m;D++){var L=D*p+R,F=P;if(1===f)e.set(t.subarray(O+L*i+F,O+L*i+F+g),N+D*g);else for(var U=0;U<g;U++)e[N+(D*g+U)]=t[O+(L*i+F+U*f)]}}e.CpuConv=c,e.conv2d=u},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.dropout=e.CpuDropout=void 0;var o=n(31),a=n(1),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return[l(e[0],this.ratio,this.testMode)]},e}(o.Dropout);function l(t,e,n){if(!n)throw new Error("only test mode is supported");var r=new a.Tensor(t.dims,t.type),i=t.floatData;return r.numberData.set(i),r}e.CpuDropout=s,e.dropout=l},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.flatten=e.CpuFlatten=void 0;var o=n(32),a=n(1),s=n(0),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return[c(e[0],this.axis)]},e}(o.Flatten);function c(t,e){var n=s.ShapeUtil.flattenShape(t.dims,e),r=new a.Tensor(n,t.type),i=t.numberData;return r.numberData.set(i),r}e.CpuFlatten=l,e.flatten=c},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.gather=e.CpuGather=void 0;var o=n(33),a=n(1),s=n(0),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return[c(e[0],e[1],this.axis)]},e}(o.Gather);function c(t,e,n){n=s.ShapeUtil.normalizeAxis(n,t.dims.length);var r=t.dims.slice(),i=r.slice(),o=e.data;i[n]=o.length;for(var l=s.ShapeUtil.computeStrides(r),c=s.ShapeUtil.computeStrides(i),u=new a.Tensor(i,t.type).numberData,h=t.data,d=0;d<u.length;++d){var p=s.ShapeUtil.offsetToIndices(d,c),f=p.slice(),m=o[p[n]];f[n]=m<0?m+r[n]:m;var g=s.ShapeUtil.indicesToOffset(f,l);u[d]=h[g]}var y=r.slice(0,n).concat(e.dims).concat(r.slice(n+1));return new a.Tensor(y,t.type,void 0,void 0,u)}e.CpuGather=l,e.gather=c},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),a=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.hasOwnProperty.call(t,n)&&o(e,t,n);return a(e,t),e},l=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a};Object.defineProperty(e,"__esModule",{value:!0}),e.gemm=e.CpuGemm=void 0;var c=n(19),u=n(1),h=s(n(0)),d=n(17),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return[f(e[0],e[1],this.alpha,this.beta,this.transA,this.transB,3===e.length?e[2]:void 0)]},e}(c.Gemm);function f(t,e,n,r,i,o,a){var s=l(h.GemmUtil.getShapeOfGemmResult(t.dims,i,e.dims,o,null==a?void 0:a.dims),3),c=s[0],p=s[1],f=s[2],m=new u.Tensor([c,p],t.type);if(a&&h.BroadcastUtil.calc(m,a,(function(t,e){return e}),!0)!==m)throw new Error("tensor C is not broadcastable to [M,N]");return d.matMul2d(t.floatData,e.floatData,m.floatData,i,o,n,r,c,p,f),m}e.CpuGemm=p,e.gemm=f},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a};Object.defineProperty(e,"__esModule",{value:!0}),e.imageScaler=e.CpuImageScaler=void 0;var a=n(34),s=n(1),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return[c(e[0],this.bias,this.scale)]},e}(a.ImageScaler);function c(t,e,n){for(var r=o(t.dims,4),i=r[0],a=r[1],l=r[2],c=r[3],u=new s.Tensor([i,a,l,c],t.type),h=t.floatData,d=u.floatData,p=0;p<i*a;p++)for(var f=0;f<l*c;f++){var m=p*l*c+f;d[m]=h[m]*n+e[p%a]}return u}e.CpuImageScaler=l,e.imageScaler=c},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.instanceNormalization=e.CpuInstanceNormalization=void 0;var o=n(20),a=n(1),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return[l(e[0],e[1],e[2],this.epsilon)]},e}(o.InstanceNormalization);function l(t,e,n,r){for(var i=t.dims,o=i[0],s=i[1],l=1,c=2;c<i.length;c++)l*=i[c];for(var u,h,d,p,f,m,g=new a.Tensor(t.dims,t.type),y=t.floatData,v=g.floatData,b=e.numberData,x=n.numberData,_=0;_<o*s;_++){for(f=(p=_*l)+l,m=_%s,u=0,c=p;c<f;++c)u+=y[c];for(h=u/l,u=0,c=p;c<f;++c)u+=Math.pow(y[c]-h,2);for(d=u/l,c=p;c<f;++c)v[c]=b[m]*((y[c]-h)/Math.sqrt(d+r))+x[m]}return g}e.CpuInstanceNormalization=s,e.instanceNormalization=l},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),a=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.hasOwnProperty.call(t,n)&&o(e,t,n);return a(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.lrn=e.CpuLrn=void 0;var l=n(88),c=n(1),u=s(n(0)),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return[d(e[0],this.alpha,this.beta,this.bias,this.size)]},e}(l.Lrn);function d(t,e,n,r,i){for(var o=t.dims[0],a=t.dims[1],s=t.floatData,l=1,h=2;h<t.dims.length;++h)l*=t.dims[h];var d=l*a,p=new c.Tensor(t.dims,t.type),f=new Array(u.ShapeUtil.size(t.dims));for(h=0;h<f.length;++h)f[h]=r;for(var m=new Float64Array((a+i-1)*l),g=e/i,y=(i-1)/2,v=0;v<o;++v){u.MathUtil.sqr(m,s,y*l,d*v,d);for(var b=0;b<i;++b)u.MathUtil.axpy(f,m,d*v,b*l,l,g);for(b=1;b<a;++b){var x=v*d+b*l;u.arrayCopyHelper(f,f,x,x-l,l),u.MathUtil.axpy(f,m,x,(b+i-1)*l,l,g),u.MathUtil.axpy(f,m,x,(b-1)*l,l,-g)}}return u.MathUtil.powx(f,f,0,0,u.ShapeUtil.size(t.dims),-n),u.MathUtil.mul(f,s,0,0,u.ShapeUtil.size(t.dims)),p.floatData.set(f),p}e.CpuLrn=h,e.lrn=d},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Lrn=void 0;var r=function(){function t(){}return t.prototype.initialize=function(t){this.alpha=t.getFloat("alpha",1e-4),this.beta=t.getFloat("beta",.75),this.bias=t.getFloat("bias",1),this.size=t.getInt("size")},t.prototype.checkInputs=function(t){return!(!t||1!==t.length)&&!(t[0].dims.length<3)&&this.checkInputTypes(t)},t.prototype.checkInputTypes=function(t){return"float32"===t[0].type||"float64"===t[0].type},t}();e.Lrn=r},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},a=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(o(arguments[e]));return t};Object.defineProperty(e,"__esModule",{value:!0}),e.pad=e.CpuPad=void 0;var s=n(35),l=n(1),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return[u(e[0],this.mode,this.value,this.pads)]},e}(s.Pad);function u(t,e,n,r){var i=t.dims,o=function(t,e){var n=Array(t.length);Object.assign(n,t);for(var r=0;r<t.length;r++)n[r]+=e[r]+e[r+n.length];return n}(i,r),a=new l.Tensor(o,t.type);switch(e){case"constant":for(var s=0;s<o.reduce((function(t,e){return t*e}),1);s++){var c=p(s,o);a.set(c,n)}for(s=0;s<i.reduce((function(t,e){return t*e}),1);s++)c=p(s,i),a.set(c.map((function(t,e){return t+r[e]})),t.get(c));break;case"reflect":for(s=0;s<o.reduce((function(t,e){return t*e}),1);s++)c=p(s,o),a.set(c,t.get(c.map((function(t,e){return h(t,r[e],i[e])}))));break;case"edge":for(s=0;s<o.reduce((function(t,e){return t*e}),1);s++)c=p(s,o),a.set(c,t.get(c.map((function(t,e){return d(t,r[e],i[e])}))));break;default:throw Error("Illegal pad mode.")}return a}function h(t,e,n){if(t<e){var r=(e-t-1)%(n-1);return 1===Math.floor((e-t-1)/(n-1))%2?n-r-2:r+1}return t<e+n?t-e:(r=(t-(e+n))%(n-1),0===Math.floor((t-(e+n))/(n-1))%2?n-r-2:r+1)}function d(t,e,n){return t<e?0:t<e+n?t-e:n-1}function p(t,e){if(t<0||e.some((function(t){return t<0})))throw Error("Array index out of range");var n=a(e);return n.reverse(),n.map((function(e,n,r){return Math.floor(t/function(t){return t.reduce((function(t,e){return t*e}),1)}(r.slice(0,n)))%e})).reverse()}e.CpuPad=c,e.pad=u},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.pool=e.globalMaxPool=e.maxPool=e.globalAveragePool=e.averagePool=e.CpuGlobalMaxPool=e.CpuMaxPool=e.CpuGlobalAveragePool=e.CpuAveragePool=void 0;var o=n(21),a=n(1),s=n(0),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return[d(e[0],this.autoPad,this.countIncludePad,this.kernelShape,this.pads,this.strides)]},e}(o.AveragePool);e.CpuAveragePool=l;var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return[p(e[0])]},e}(o.GlobalAveragePool);e.CpuGlobalAveragePool=c;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return[f(e[0],this.autoPad,this.kernelShape,this.pads,this.strides)]},e}(o.MaxPool);e.CpuMaxPool=u;var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return[m(e[0])]},e}(o.GlobalMaxPool);function d(t,e,n,r,i,o){return g(!1,t,e,n,r,i,o,0,(function(t,e){return t+e}),(function(t,e){return t/e}))}function p(t){return g(!0,t,"NOTSET",!1,[],[],[],0,(function(t,e){return t+e}),(function(t,e){return t/e}))}function f(t,e,n,r,i){return g(!1,t,e,!1,n,r,i,Number.MIN_SAFE_INTEGER,(function(t,e){return Math.max(t,e)}),(function(t,e){return t}))}function m(t){return g(!0,t,"NOTSET",!1,[],[],[],Number.MIN_SAFE_INTEGER,(function(t,e){return Math.max(t,e)}),(function(t,e){return t}))}function g(t,e,n,r,i,o,l,c,u,h){s.PoolConvUtil.adjustPoolAttributes(t,e.dims,i,l,o);for(var d=s.PoolConvUtil.computePoolOutputShape(t,e.dims,l,i,o,n),p=s.ShapeUtil.size(i),f=s.ShapeUtil.computeStrides(i),m=f.length,g=d.length,y=s.ShapeUtil.size(d),v=new a.Tensor(d,e.type),b=s.ShapeUtil.computeStrides(d),x=0;x<y;x++){for(var _=s.ShapeUtil.offsetToIndices(x,b),w=_.slice(0),S=_.slice(0),T=0;T<m;T++)w[g-m+T]=_[g-m+T]*l[T];var E=c,M=0,C=!1;for(T=0;T<p;T++){var A=s.ShapeUtil.offsetToIndices(T,f);C=!1;for(var k=g-m;k<g;k++)if(S[k]=w[k]+A[k-g+m]-o[k-2],S[k]>=e.dims[k]||S[k]<0){M++,C=!0;break}E=C?E:u(E,e.get(S))}E=h(E,r?p:p-M),v.set(_,E)}return v}e.CpuGlobalMaxPool=h,e.averagePool=d,e.globalAveragePool=p,e.maxPool=f,e.globalMaxPool=m,e.pool=g},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.reduceProd=e.reduceMean=e.reduceMin=e.reduceMax=e.reduceLogSum=e.reduceSumSquare=e.reduceSum=e.CpuReduceProd=e.CpuReduceMean=e.CpuReduceMin=e.CpuReduceMax=e.CpuReduceLogSum=e.CpuReduceSumSquare=e.CpuReduceSum=void 0;var o=n(36),a=n(0),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return[f(e[0],a.ShapeUtil.normalizeAxes(this.axes,e[0].dims.length),this.keepDims)]},e}(o.ReduceBase);e.CpuReduceSum=s;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return[m(e[0],a.ShapeUtil.normalizeAxes(this.axes,e[0].dims.length),this.keepDims)]},e}(o.ReduceBase);e.CpuReduceSumSquare=l;var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return[g(e[0],a.ShapeUtil.normalizeAxes(this.axes,e[0].dims.length),this.keepDims)]},e}(o.ReduceBase);e.CpuReduceLogSum=c;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return[y(e[0],a.ShapeUtil.normalizeAxes(this.axes,e[0].dims.length),this.keepDims)]},e}(o.ReduceBase);e.CpuReduceMax=u;var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return[v(e[0],a.ShapeUtil.normalizeAxes(this.axes,e[0].dims.length),this.keepDims)]},e}(o.ReduceBase);e.CpuReduceMin=h;var d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return[b(e[0],a.ShapeUtil.normalizeAxes(this.axes,e[0].dims.length),this.keepDims)]},e}(o.ReduceBase);e.CpuReduceMean=d;var p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return[x(e[0],a.ShapeUtil.normalizeAxes(this.axes,e[0].dims.length),this.keepDims)]},e}(o.ReduceBase);function f(t,e,n){return a.ReduceUtil.calcReduce(t,e,n,(function(t){return t}),(function(t,e){return t+e}))}function m(t,e,n){return a.ReduceUtil.calcReduce(t,e,n,(function(t){return t*t}),(function(t,e){return t+e}))}function g(t,e,n){for(var r=a.ReduceUtil.calcReduce(t,e,n,(function(t){return t}),(function(t,e){return t+e})),i=r.floatData.length,o=0;o<i;o++)r.floatData[o]=Math.log(r.floatData[o]);return r}function y(t,e,n){return a.ReduceUtil.calcReduce(t,e,n,(function(t){return t}),(function(t,e){return Math.max(t,e)}))}function v(t,e,n){return a.ReduceUtil.calcReduce(t,e,n,(function(t){return t}),(function(t,e){return Math.min(t,e)}))}function b(t,e,n){for(var r=a.ReduceUtil.calcReduce(t,e,n,(function(t){return t}),(function(t,e){return t+e})),i=a.ReduceUtil.calcReduceShape(t.dims,e,n),o=a.ShapeUtil.size(t.dims)/a.ShapeUtil.size(i),s=r.floatData.length,l=0;l<s;l++)r.floatData[l]=r.floatData[l]/o;return r}function x(t,e,n){return a.ReduceUtil.calcReduce(t,e,n,(function(t){return t}),(function(t,e){return t*e}))}e.CpuReduceProd=p,e.reduceSum=f,e.reduceSumSquare=m,e.reduceLogSum=g,e.reduceMax=y,e.reduceMin=v,e.reduceMean=b,e.reduceProd=x},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.reshape=e.CpuReshape=void 0;var o=n(37),a=n(1),s=n(0),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return[c(e[0],e[1])]},e}(o.Reshape);function c(t,e){var n=s.ShapeUtil.calculateReshapedDims(t.dims,e.integerData),r=new a.Tensor(n,t.type);return r.floatData.set(t.floatData),r}e.CpuReshape=l,e.reshape=c},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.slice=e.CpuSliceV10=e.CpuSlice=void 0;var o=n(38),a=n(1),s=n(0),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return[u(e[0],this.starts,this.ends,this.axes)]},e}(o.Slice);e.CpuSlice=l;var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){if(e.length>=5&&e[4].integerData.some((function(t){return 1!==t})))throw new Error("currently non-1 steps is not supported for Slice");var n=Array.from(e[1].integerData),r=Array.from(e[2].integerData),i=e.length>=4?Array.from(e[3].integerData):[];return[u(e[0],n,r,i)]},e}(o.SliceV10);function u(t,e,n,r){0===r.length&&(r=t.dims.map((function(t,e){return e}))),r=s.ShapeUtil.normalizeAxes(r,t.dims.length),e=e.map((function(e,n){return e>t.dims[r[n]]-1?t.dims[r[n]]:s.ShapeUtil.normalizeAxis(e,t.dims[r[n]])})),n=n.map((function(e,n){return e>t.dims[r[n]]-1?t.dims[r[n]]:s.ShapeUtil.normalizeAxis(e,t.dims[r[n]])}));var i=[],o=[];r.forEach((function(t,r){i[t]=n[r]-e[r],o[t]=e[r]}));for(var l=0;l<t.dims.length;l++)i[l]=i[l]||t.dims[l],o[l]=o[l]||0;var c=s.ShapeUtil.computeStrides(i),u=s.ShapeUtil.computeStrides(t.dims?t.dims:[t.data.length]),h=t.data,d=new a.Tensor(i,t.type),p=d.data;for(l=0;l<p.length;++l){var f=s.ShapeUtil.offsetToIndices(l,c).map((function(t,e){return t+o[e]})),m=s.ShapeUtil.indicesToOffset(f,u);p[l]=h[m]}return d}e.CpuSliceV10=c,e.slice=u},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),a=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.hasOwnProperty.call(t,n)&&o(e,t,n);return a(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.softmax=e.CpuSoftmax=void 0;var l=n(22),c=n(1),u=s(n(0)),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return[d(e[0],this.axis)]},e}(l.Softmax);function d(t,e){var n=t.dims,r=n.length;e=u.ShapeUtil.normalizeAxis(e,r);for(var i=u.ShapeUtil.sizeToDimension(n,e),o=u.ShapeUtil.sizeFromDimension(n,e),a=t.numberData,s=new c.Tensor(t.dims,t.type),l=s.numberData,h=0;h<i;h++){for(var d=h*o,p=Number.MIN_VALUE,f=0;f<o;f++)a[d+f]>p&&(p=a[d+f]);var m=0;for(f=0;f<o;f++){var g=a[d+f]-p;l[d+f]=Math.exp(g),m+=Math.exp(g)}for(f=0;f<o;f++)0===m?l[d+f]=0:l[d+f]/=m}return s}e.CpuSoftmax=h,e.softmax=d},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.squeeze=e.CpuSqueeze=void 0;var o=n(39),a=n(1),s=n(0),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return[c(e[0],this.axes)]},e}(o.Squeeze);function c(t,e){var n=s.ShapeUtil.squeezeShape(t.dims,e),r=new a.Tensor(n,t.type),i=t.numberData;return r.numberData.set(i),r}e.CpuSqueeze=l,e.squeeze=c},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.sum=e.CpuSum=void 0;var o=n(23),a=n(1),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return[l(e)]},e}(o.Sum);function l(t){for(var e=new a.Tensor(t[0].dims,t[0].type),n=t[0].floatData.length,r=e.floatData,i=0;i<t.length;i++)for(var o=t[i].floatData,s=0;s<n;++s)r[s]+=o[s];return e}e.CpuSum=s,e.sum=l},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.tile=e.CpuTile=void 0;var o=n(40),a=n(1),s=n(0),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return[c(e[0],e[1])]},e}(o.Tile);function c(t,e){for(var n=t.dims?t.dims:[t.data.length],r=n.length,i=new Array(r),o=0;o<r;o++)i[o]=n[o]*e.numberData[o];var l=s.ShapeUtil.computeStrides(n),c=s.ShapeUtil.computeStrides(i),u=new a.Tensor(i,t.type),h=u.numberData,d=t.data;for(o=0;o<h.length;++o){for(var p=s.ShapeUtil.offsetToIndices(o,c),f=new Array(r),m=0;m<r;++m)f[m]=p[m]%t.dims[m];var g=s.ShapeUtil.indicesToOffset(f,l);h[o]=d[g]}return u}e.CpuTile=l,e.tile=c},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.transpose=e.CpuTranspose=void 0;var o=n(41),a=n(1),s=n(0),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return[c(e[0],this.perm)]},e}(o.Transpose);function c(t,e){var n=t.dims,r=n.length,i=new Array(r);if(e.length===r)i=e;else for(var o=0;o<r;o++)i[o]=r-o-1;var l=new Array(r),c=new Array(r);for(o=0;o<r;o++){var u=i[o];l[o]=n[u],c[o]=u+1<r?s.ShapeUtil.sizeFromDimension(n,u+1):1}var h,d,p,f=new a.Tensor(l,t.type),m=t.floatData,g=f.floatData,y=0,v=1,b=1,x=!0;for(o=r-1;o>=0;--o){var _=i[o];x&&_===o?v*=n[_]:(x=!1,b*=n[_],++y)}return 1===b?(h=v,d=g,p=m,s.arrayCopyHelper(d,p,0,0,h)):1===v?function(t,e,n,r,i,o){for(var a=new Array(t).fill(0),l=0,c=0;c<n;++c){var u=s.ShapeUtil.indicesToOffset(a,r,t);i[l++]=o[u],s.ShapeUtil.incrementIndex(a,e,t)}}(y,l,b,c,g,m):function(t,e,n,r,i,o,a){for(var l=new Array(t).fill(0),c=0,u=0;u<n;++u){var h=s.ShapeUtil.indicesToOffset(l,i,t);s.arrayCopyHelper(o,a,c,0+h,r),s.ShapeUtil.incrementIndex(l,e,t),c+=r}}(y,l,b,v,c,g,m),f}e.CpuTranspose=l,e.transpose=c},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.unsqueeze=e.CpuUnsqueeze=void 0;var o=n(44),a=n(1),s=n(0),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return[c(e[0],this.axes)]},e}(o.Unsqueeze);function c(t,e){var n=s.ShapeUtil.unsqueezeShape(t.dims,e),r=new a.Tensor(n,t.type),i=t.numberData;return r.numberData.set(i),r}e.CpuUnsqueeze=l,e.unsqueeze=c},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.CpuUpsample=void 0;var o=n(45),a=n(1),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){var n=this,r=e[0].dims,i=r.map((function(t,e){return Math.floor(t*n.scales[e])})),o=new a.Tensor(i,e[0].type);return"nearest"===this.mode?function(t,e,n,r,i){var o=n.length,a=new Array(o);a.fill(0);var s=new Array(o);s[o-1]=1;for(var c=o-2;c>=0;c--)s[c]=s[c+1]*n[c+1];var u=new Array(o);u.fill(0),u[o-1]=-1;for(var h=0,d=0;h<e.length;h++){for(var p=o-1;p>=0;p--){if(++u[p]<r[p]){var f=0,m=l(u[p],i[p]);f=Math.floor(m),(f=Math.max(0,Math.min(f,n[p]-1)))!==a[p]&&(d+=(f-a[p])*s[p],a[p]=f);break}u[p]=0,d+=(0-a[p])*s[p],a[p]=0}e[h]=t[d]}}(e[0].data,o.data,r,i,this.scales):function(t,e,n,r,i){var o=2===n.length;!function(t,e,n,r,i,o,a,s,c,u){for(var h=[],d=[],p=new Array(a),f=new Array(a),m=new Array(s),g=new Array(s),y=new Array(a),v=new Array(a),b=new Array(s),x=new Array(s),_=0;_<a;++_){var w=l(_,c);h.push(w),w=Math.max(0,Math.min(w,i-1));var S=Math.min(Math.floor(w),i-1),T=Math.min(S+1,i-1);S===T?(y[_]=.5,v[_]=.5):(y[_]=Math.abs(w-S),v[_]=Math.abs(w-T)),p[_]=o*S,f[_]=o*T}for(var E=0;E<s;++E){var M=l(E,u);d.push(M),M=Math.max(0,Math.min(M,o-1)),m[E]=Math.min(Math.floor(M),o-1),g[E]=Math.min(m[E]+1,o-1),m[E]===g[E]?(b[E]=.5,x[E]=.5):(b[E]=Math.abs(M-m[E]),x[E]=Math.abs(M-g[E]))}for(var C=0,A=0,k=0;k<n;++k)for(var I=0;I<r;++I){for(_=0;_<a;++_)for(E=0;E<s;++E){var R=t[C+p[_]+m[E]],P=t[C+p[_]+g[E]],N=t[C+f[_]+m[E]],O=t[C+f[_]+g[E]];e[A+s*_+E]=x[E]*v[_]*R+b[E]*v[_]*P+x[E]*y[_]*N+b[E]*y[_]*O}C+=i*o,A+=s*a}}(t,e,o?1:n[0],o?1:n[1],o?n[0]:n[2],o?n[1]:n[3],o?r[0]:r[2],o?r[1]:r[3],o?i[0]:i[2],o?i[1]:i[3])}(e[0].data,o.data,r,i,this.scales),[o]},e}(o.Upsample);function l(t,e){return t/e}e.CpuUpsample=s},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e},a=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{l(r.next(t))}catch(t){o(t)}}function s(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((r=r.apply(t,e||[])).next())}))},s=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.WasmBackend=e.bindingInitPromise=void 0;var l=o(n(46)),c=n(3),u=o(n(4)),h=n(106),d=function(){function t(){this.cpuFallback=!0,this.worker=function(){if("undefined"!=typeof navigator&&navigator){if("number"==typeof navigator.hardwareConcurrency)return Math.max(Math.ceil(navigator.hardwareConcurrency/2)-1,0);if("Safari"===l.name&&l.os&&("iOS"===l.os.family||"OS X"===l.os.family))return 1}return 0}(),this.initTimeout=5e3}return t.prototype.initialize=function(){return a(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return function(t){if(!Number.isFinite(t)||Number.isNaN(t))throw new Error(t+" is not valid number of workers");if(!Number.isInteger(t))throw new Error(t+" is not an integer and hence not valid number of workers")}(this.worker),[4,this.isWasmSupported()];case 1:return t.sent()?[2,!0]:[2,!1]}}))}))},t.prototype.createSessionHandler=function(t){return new h.WasmSessionHandler(this,t,this.cpuFallback)},t.prototype.dispose=function(){},t.prototype.isWasmSupported=function(){return a(this,void 0,void 0,(function(){var t;return s(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,u.init(this.worker,this.initTimeout)];case 1:return e.sent(),[2,!0];case 2:return t=e.sent(),c.Logger.warning("WebAssembly","Unable to initialize WebAssembly backend. "+t),[2,!1];case 3:return[2]}}))}))},t}();e.WasmBackend=d},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,n){"use strict";var r;Object.defineProperty(e,"__esModule",{value:!0}),e.now=e.WasmBinding=e.init=void 0;var i=!1,o=!1;e.init=function(){if(i)return Promise.resolve();if(o)throw new Error("multiple calls to 'init()' detected.");return o=!0,new Promise((function(t,e){(r=n(104))(r).then((function(){t(),o=!1,i=!0}),(function(t){o=!1,e(t)}))}))};var a=function(){function t(){this.ptr8=0,this.numBytesAllocated=0}return t.prototype.ccall=function(n){for(var o=[],a=1;a<arguments.length;a++)o[a-1]=arguments[a];if(!i)throw new Error("wasm not initialized. please ensure 'init()' is called.");var s=e.now(),l=[],c=t.calculateOffsets(l,o);c>this.numBytesAllocated&&this.expandMemory(c),t.ccallSerialize(r.HEAPU8.subarray(this.ptr8,this.ptr8+c),l,o);var u=e.now();this.func(n,this.ptr8);var h=e.now();return t.ccallDeserialize(r.HEAPU8.subarray(this.ptr8,this.ptr8+c),l,o),{startTime:s,endTime:e.now(),startTimeFunc:u,endTimeFunc:h}},t.prototype.ccallRaw=function(t,n){if(!i)throw new Error("wasm not initialized. please ensure 'init()' is called.");var o=e.now(),a=n.byteLength;a>this.numBytesAllocated&&this.expandMemory(a),r.HEAPU8.subarray(this.ptr8,this.ptr8+a).set(n);var s=e.now();this.func(t,this.ptr8);var l=e.now();return n.set(r.HEAPU8.subarray(this.ptr8,this.ptr8+a)),{startTime:o,endTime:e.now(),startTimeFunc:s,endTimeFunc:l}},t.prototype.func=function(t,e){(0,r[t])(e)},t.calculateOffsets=function(t,e){for(var n=4+4*e.length,r=0;r<e.length;r++){var i=e[r],o=i[0],a=i[1],s=i[2],l=0;switch(a){case"bool":case"int32":case"float32":l=4;break;case"float64":l=8;break;case"boolptr":if(!o){t.push(0);continue}if(!Array.isArray(o)&&!ArrayBuffer.isView(o))throw new Error("boolptr requires boolean array or Uint8Array");l=4*Math.ceil(o.length/4);break;case"int32ptr":case"float32ptr":if(!o){t.push(0);continue}if(Array.isArray(o)){if("inout"===s||"out"===s)throw new TypeError("inout/out parameters must be ArrayBufferView for ptr types.");l=4*o.length}else{if(!ArrayBuffer.isView(o))throw new TypeError("unsupported data type in 'ccall()'");l=o.byteLength}break;default:throw new Error("not supported parameter type: "+a)}t.push(n),n+=l}return n},t.ccallSerialize=function(t,e,n){var r=new Int32Array(t.buffer,t.byteOffset),i=new Uint32Array(t.buffer,t.byteOffset),o=new Float32Array(t.buffer,t.byteOffset);i[0]=n.length;for(var a=0;a<n.length;a++){var s=n[a],l=s[0],c=s[1],u=s[2],h=e[a],d=h>>2;if(i[a+1]=h,"out"!==u&&0!==h)switch(c){case"bool":t[h]=!0===l?1:0;break;case"int32":r[d]=l;break;case"float32":o[d]=l;break;case"boolptr":var p=l;t.subarray(h,h+p.length).set(l);break;case"int32ptr":var f=l;r.subarray(d,d+f.length).set(f);break;case"float32ptr":var m=l;o.subarray(d,d+m.length).set(m);break;default:throw new Error("not supported parameter type: "+c)}}},t.ccallDeserialize=function(t,e,n){for(var r=new Float32Array(t.buffer,t.byteOffset),i=new Uint8Array(t.buffer,t.byteOffset),o=0;o<n.length;o++){var a=n[o],s=a[0],l=a[1],c=a[2],u=e[o],h=u>>2;if("out"===c||"inout"===c)switch(l){case"float32ptr":var d=s;d.set(r.subarray(h,h+d.length));break;case"boolptr":var p=s;p.set(i.subarray(u,u+p.length));break;default:throw new Error("not supported parameter type: "+l)}}},t.prototype.expandMemory=function(t){if(0!==this.ptr8&&r._free(this.ptr8),this.numBytesAllocated=2*t,this.ptr8=r._malloc(this.numBytesAllocated),0===this.ptr8)throw new Error("Unable to allocate requested amount of memory. Failing.")},t.prototype.dispose=function(){if(!i)throw new Error("wasm not initialized. please ensure 'init()' is called.");0!==this.ptr8&&r._free(this.ptr8)},t}();e.WasmBinding=a,e.now="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:Date.now},function(t,e,n){(function(e,r,i){var o,a=(o=(o="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0)||e,function(t){t=void 0!==(t=t||{})?t:{};var e,a={};for(e in t)t.hasOwnProperty(e)&&(a[e]=t[e]);var s,l,c=[],u=!1,h=!1;u="object"==typeof window,h="function"==typeof importScripts,s="object"==typeof r&&"object"==typeof r.versions&&"string"==typeof r.versions.node,l=!u&&!s&&!h;var d,p,f,m,g="";s?(g=h?n(47).dirname(g)+"/":i+"/",d=function(t,e){return f||(f=n(48)),m||(m=n(47)),t=m.normalize(t),f.readFileSync(t,e?null:"utf8")},p=function(t){var e=d(t,!0);return e.buffer||(e=new Uint8Array(e)),S(e.buffer),e},r.argv.length>1&&r.argv[1].replace(/\\/g,"/"),c=r.argv.slice(2),r.on("uncaughtException",(function(t){if(!(t instanceof it))throw t})),r.on("unhandledRejection",W),t.inspect=function(){return"[Emscripten Module object]"}):l?("undefined"!=typeof read&&(d=function(t){return read(t)}),p=function(t){var e;return"function"==typeof readbuffer?new Uint8Array(readbuffer(t)):(S("object"==typeof(e=read(t,"binary"))),e)},"undefined"!=typeof scriptArgs?c=scriptArgs:void 0!==arguments&&(c=arguments),"undefined"!=typeof print&&("undefined"==typeof console&&(console={}),console.log=print,console.warn=console.error="undefined"!=typeof printErr?printErr:print)):(u||h)&&(h?g=self.location.href:document.currentScript&&(g=document.currentScript.src),o&&(g=o),g=0!==g.indexOf("blob:")?g.substr(0,g.lastIndexOf("/")+1):"",d=function(t){var e=new XMLHttpRequest;return e.open("GET",t,!1),e.send(null),e.responseText},h&&(p=function(t){var e=new XMLHttpRequest;return e.open("GET",t,!1),e.responseType="arraybuffer",e.send(null),new Uint8Array(e.response)}));var y,v,b=t.print||console.log.bind(console),x=t.printErr||console.warn.bind(console);for(e in a)a.hasOwnProperty(e)&&(t[e]=a[e]);a=null,t.arguments&&(c=t.arguments),t.thisProgram&&t.thisProgram,t.quit&&t.quit,t.wasmBinary&&(y=t.wasmBinary),t.noExitRuntime&&t.noExitRuntime,"object"!=typeof WebAssembly&&x("no native wasm support detected");var _=new WebAssembly.Table({initial:31,maximum:31,element:"anyfunc"}),w=!1;function S(t,e){t||W("Assertion failed: "+e)}var T,E,M,C="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function A(t,e,n){for(var r=e+n,i=e;t[i]&&!(i>=r);)++i;if(i-e>16&&t.subarray&&C)return C.decode(t.subarray(e,i));for(var o="";e<i;){var a=t[e++];if(128&a){var s=63&t[e++];if(192!=(224&a)){var l=63&t[e++];if((a=224==(240&a)?(15&a)<<12|s<<6|l:(7&a)<<18|s<<12|l<<6|63&t[e++])<65536)o+=String.fromCharCode(a);else{var c=a-65536;o+=String.fromCharCode(55296|c>>10,56320|1023&c)}}else o+=String.fromCharCode((31&a)<<6|s)}else o+=String.fromCharCode(a)}return o}function k(t,e){return t?A(E,t,e):""}function I(t,e){return t%e>0&&(t+=e-t%e),t}function R(e){T=e,t.HEAP8=new Int8Array(e),t.HEAP16=new Int16Array(e),t.HEAP32=M=new Int32Array(e),t.HEAPU8=E=new Uint8Array(e),t.HEAPU16=new Uint16Array(e),t.HEAPU32=new Uint32Array(e),t.HEAPF32=new Float32Array(e),t.HEAPF64=new Float64Array(e)}"undefined"!=typeof TextDecoder&&new TextDecoder("utf-16le");var P=t.INITIAL_MEMORY||16777216;function N(e){for(;e.length>0;){var n=e.shift();if("function"!=typeof n){var r=n.func;"number"==typeof r?void 0===n.arg?t.dynCall_v(r):t.dynCall_vi(r,n.arg):r(void 0===n.arg?null:n.arg)}else n()}}(v=t.wasmMemory?t.wasmMemory:new WebAssembly.Memory({initial:P/65536}))&&(T=v.buffer),P=T.byteLength,R(T),M[1440]=5248800;var O=[],D=[],L=[],F=[];function U(t){O.unshift(t)}function B(t){F.unshift(t)}Math.abs,Math.ceil,Math.floor,Math.min;var z=0,j=null,V=null;function W(e){throw t.onAbort&&t.onAbort(e),b(e+=""),x(e),w=!0,e="abort("+e+"). Build with -s ASSERTIONS=1 for more info.",new WebAssembly.RuntimeError(e)}t.preloadedImages={},t.preloadedAudios={};var G="data:application/octet-stream;base64,";function H(t){return String.prototype.startsWith?t.startsWith(G):0===t.indexOf(G)}var q="onnx-wasm.wasm";function X(){try{if(y)return new Uint8Array(y);if(p)return p(q);throw"both async and sync fetching of the wasm failed"}catch(t){W(t)}}H(q)||(q=function(e){return t.locateFile?t.locateFile(e,g):g+e}(q)),D.push({func:function(){et()}});var Y={};function K(){return K.uncaught_exceptions>0}function Z(t){try{return v.grow(t-T.byteLength+65535>>16),R(v.buffer),1}catch(t){}}var J={mappings:{},buffers:[null,[],[]],printChar:function(t,e){var n=J.buffers[t];0===e||10===e?((1===t?b:x)(A(n,0)),n.length=0):n.push(e)},varargs:void 0,get:function(){return J.varargs+=4,M[J.varargs-4>>2]},getStr:function(t){return k(t)},get64:function(t,e){return t}};[].push((function(){void 0!==rt&&rt(0);var t=J.buffers;t[1].length&&J.printChar(1,10),t[2].length&&J.printChar(2,10)}));var Q={__assert_fail:function(t,e,n,r){W("Assertion failed: "+k(t)+", at: "+[e?k(e):"unknown filename",n,r?k(r):"unknown function"])},__cxa_allocate_exception:function(t){return nt(t)},__cxa_throw:function(t,e,n){throw Y[t]={ptr:t,adjusted:[t],type:e,destructor:n,refcount:0,caught:!1,rethrown:!1},"uncaught_exception"in K?K.uncaught_exceptions++:K.uncaught_exceptions=1,t},abort:function(){W()},emscripten_get_sbrk_ptr:function(){return 5760},emscripten_memcpy_big:function(t,e,n){E.copyWithin(t,e,e+n)},emscripten_resize_heap:function(t){var e=E.length;if(t>2147418112)return!1;for(var n=1;n<=4;n*=2){var r=e*(1+.2/n);if(r=Math.min(r,t+100663296),Z(Math.min(2147418112,I(Math.max(16777216,t,r),65536))))return!0}return!1},fd_close:function(t){return 0},fd_seek:function(t,e,n,r,i){},fd_write:function(t,e,n,r){for(var i=0,o=0;o<n;o++){for(var a=M[e+8*o>>2],s=M[e+(8*o+4)>>2],l=0;l<s;l++)J.printChar(t,E[a+l]);i+=s}return M[r>>2]=i,0},memory:v,setTempRet0:function(t){},table:_},$=function(){var e={env:Q,wasi_snapshot_preview1:Q};function n(e,n){var r=e.exports;t.asm=r,function(e){if(z--,t.monitorRunDependencies&&t.monitorRunDependencies(z),0==z&&(null!==j&&(clearInterval(j),j=null),V)){var n=V;V=null,n()}}()}function r(t){n(t.instance)}function i(t){return(y||!u&&!h||"function"!=typeof fetch?new Promise((function(t,e){t(X())})):fetch(q,{credentials:"same-origin"}).then((function(t){if(!t.ok)throw"failed to load wasm binary file at '"+q+"'";return t.arrayBuffer()})).catch((function(){return X()}))).then((function(t){return WebAssembly.instantiate(t,e)})).then(t,(function(t){x("failed to asynchronously prepare wasm: "+t),W(t)}))}if(z++,t.monitorRunDependencies&&t.monitorRunDependencies(z),t.instantiateWasm)try{return t.instantiateWasm(e,n)}catch(t){return x("Module.instantiateWasm callback failed with error: "+t),!1}return function(){if(y||"function"!=typeof WebAssembly.instantiateStreaming||H(q)||"function"!=typeof fetch)return i(r);fetch(q,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,e).then(r,(function(t){x("wasm streaming compile failed: "+t),x("falling back to ArrayBuffer instantiation"),i(r)}))}))}(),{}}();t.asm=$;var tt,et=t.___wasm_call_ctors=function(){return(et=t.___wasm_call_ctors=t.asm.__wasm_call_ctors).apply(null,arguments)},nt=(t._batch_normalization_f32=function(){return(t._batch_normalization_f32=t.asm.batch_normalization_f32).apply(null,arguments)},t._add_f32=function(){return(t._add_f32=t.asm.add_f32).apply(null,arguments)},t._sub_f32=function(){return(t._sub_f32=t.asm.sub_f32).apply(null,arguments)},t._mul_f32=function(){return(t._mul_f32=t.asm.mul_f32).apply(null,arguments)},t._div_f32=function(){return(t._div_f32=t.asm.div_f32).apply(null,arguments)},t._prelu_f32=function(){return(t._prelu_f32=t.asm.prelu_f32).apply(null,arguments)},t._xor_u8=function(){return(t._xor_u8=t.asm.xor_u8).apply(null,arguments)},t._or_u8=function(){return(t._or_u8=t.asm.or_u8).apply(null,arguments)},t._and_u8=function(){return(t._and_u8=t.asm.and_u8).apply(null,arguments)},t._clip_f32=function(){return(t._clip_f32=t.asm.clip_f32).apply(null,arguments)},t._conv_f32=function(){return(t._conv_f32=t.asm.conv_f32).apply(null,arguments)},t._gemm_f32=function(){return(t._gemm_f32=t.asm.gemm_f32).apply(null,arguments)},t._free=function(){return(t._free=t.asm.free).apply(null,arguments)},t._malloc=function(){return(nt=t._malloc=t.asm.malloc).apply(null,arguments)}),rt=(t._instance_normalization_f32=function(){return(t._instance_normalization_f32=t.asm.instance_normalization_f32).apply(null,arguments)},t._matmul_f32=function(){return(t._matmul_f32=t.asm.matmul_f32).apply(null,arguments)},t._average_pool_f32=function(){return(t._average_pool_f32=t.asm.average_pool_f32).apply(null,arguments)},t._max_pool_f32=function(){return(t._max_pool_f32=t.asm.max_pool_f32).apply(null,arguments)},t._softmax_f32=function(){return(t._softmax_f32=t.asm.softmax_f32).apply(null,arguments)},t._sum_f32=function(){return(t._sum_f32=t.asm.sum_f32).apply(null,arguments)},t.___errno_location=function(){return(t.___errno_location=t.asm.__errno_location).apply(null,arguments)},t._fflush=function(){return(rt=t._fflush=t.asm.fflush).apply(null,arguments)});function it(t){this.name="ExitStatus",this.message="Program terminated with exit("+t+")",this.status=t}function ot(e){function n(){tt||(tt=!0,t.calledRun=!0,w||(N(D),N(L),t.onRuntimeInitialized&&t.onRuntimeInitialized(),function(){if(t.postRun)for("function"==typeof t.postRun&&(t.postRun=[t.postRun]);t.postRun.length;)B(t.postRun.shift());N(F)}()))}e=e||c,z>0||(function(){if(t.preRun)for("function"==typeof t.preRun&&(t.preRun=[t.preRun]);t.preRun.length;)U(t.preRun.shift());N(O)}(),z>0||(t.setStatus?(t.setStatus("Running..."),setTimeout((function(){setTimeout((function(){t.setStatus("")}),1),n()}),1)):n()))}if(t._setThrew=function(){return(t._setThrew=t.asm.setThrew).apply(null,arguments)},t.stackSave=function(){return(t.stackSave=t.asm.stackSave).apply(null,arguments)},t.stackAlloc=function(){return(t.stackAlloc=t.asm.stackAlloc).apply(null,arguments)},t.stackRestore=function(){return(t.stackRestore=t.asm.stackRestore).apply(null,arguments)},t.__growWasmMemory=function(){return(t.__growWasmMemory=t.asm.__growWasmMemory).apply(null,arguments)},t.dynCall_ii=function(){return(t.dynCall_ii=t.asm.dynCall_ii).apply(null,arguments)},t.dynCall_iiii=function(){return(t.dynCall_iiii=t.asm.dynCall_iiii).apply(null,arguments)},t.dynCall_jiji=function(){return(t.dynCall_jiji=t.asm.dynCall_jiji).apply(null,arguments)},t.dynCall_iidiiii=function(){return(t.dynCall_iidiiii=t.asm.dynCall_iidiiii).apply(null,arguments)},t.dynCall_vii=function(){return(t.dynCall_vii=t.asm.dynCall_vii).apply(null,arguments)},t.dynCall_vi=function(){return(t.dynCall_vi=t.asm.dynCall_vi).apply(null,arguments)},t.dynCall_viiiiii=function(){return(t.dynCall_viiiiii=t.asm.dynCall_viiiiii).apply(null,arguments)},t.dynCall_viiiii=function(){return(t.dynCall_viiiii=t.asm.dynCall_viiiii).apply(null,arguments)},t.dynCall_viiii=function(){return(t.dynCall_viiii=t.asm.dynCall_viiii).apply(null,arguments)},t.asm=$,t.then=function(e){if(tt)e(t);else{var n=t.onRuntimeInitialized;t.onRuntimeInitialized=function(){n&&n(),e(t)}}return t},V=function t(){tt||ot(),tt||(V=t)},t.run=ot,t.preInit)for("function"==typeof t.preInit&&(t.preInit=[t.preInit]);t.preInit.length>0;)t.preInit.pop()();return ot(),t});t.exports=a}).call(this,"/index.js",n(24),"/")},function(t,e,n){"use strict";n.r(e),e.default=function(){return new Worker(n.p+"onnx-worker.js")}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.WasmSessionHandler=void 0;var r=n(11),i=n(27),o=n(107),a=n(108),s=function(){function t(t,e,n){this.backend=t,this.context=e,this.opResolveRules=n?a.WASM_OP_RESOLVE_RULES.concat(i.CPU_OP_RESOLVE_RULES):a.WASM_OP_RESOLVE_RULES}return t.prototype.createInferenceHandler=function(){return new o.WasmInferenceHandler(this,this.context.profiler)},t.prototype.dispose=function(){},t.prototype.resolve=function(t,e){var n=r.resolveOperator(t,e,this.opResolveRules);return n.initialize(t.attributes),n},t}();e.WasmSessionHandler=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.WasmInferenceHandler=void 0;var r=function(){function t(t,e){this.session=t,this.profiler=e}return t.prototype.dispose=function(){},t}();e.WasmInferenceHandler=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.WASM_OP_RESOLVE_RULES=void 0;var r=n(109),i=n(110),o=n(111),a=n(112),s=n(113),l=n(114),c=n(115),u=n(116),h=n(117),d=n(118);e.WASM_OP_RESOLVE_RULES=[["Add","","7+",function(){return new i.WasmBinaryOp(["float32"],"Add")}],["And","","7+",function(){return new i.WasmBinaryOp(["bool"],"And")}],["AveragePool","","7-10",function(){return new u.WasmAveragePool}],["BatchNormalization","","7+",function(){return new r.WasmBatchNormalization}],["Clip","","6-10",function(){return new o.WasmClip}],["Conv","","1+",function(){return new a.WasmConv}],["Div","","7+",function(){return new i.WasmBinaryOp(["float32"],"Div")}],["Gemm","","7-10",function(){return new s.WasmGemm(!1)}],["Gemm","","11+",function(){return new s.WasmGemm(!0)}],["GlobalAveragePool","","1+",function(){return new u.WasmGlobalAveragePool}],["GlobalMaxPool","","1+",function(){return new u.WasmGlobalMaxPool}],["InstanceNormalization","","6+",function(){return new l.WasmInstanceNormalization}],["MatMul","","1+",function(){return new c.WasmMatMul}],["MaxPool","","1-9",function(){return new u.WasmMaxPool}],["Mul","","7+",function(){return new i.WasmBinaryOp(["float32"],"Mul")}],["Or","","7+",function(){return new i.WasmBinaryOp(["bool"],"Or")}],["PRelu","","7+",function(){return new i.WasmBinaryOp(["float32"],"PRelu")}],["Softmax","","1+",function(){return new h.WasmSoftmax}],["Sub","","7+",function(){return new i.WasmBinaryOp(["float32"],"Sub")}],["Sum","","6+",function(){return new d.WasmSum}],["Xor","","7+",function(){return new i.WasmBinaryOp(["bool"],"Xor")}]]},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.WasmBatchNormalization=void 0;var o=n(14),a=n(1),s=n(4),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){for(var n=e[0],r=e[1],i=e[2],o=e[3],l=e[4],c=1,u=2;u<n.dims.length;u++)c*=n.dims[u];var h=new a.Tensor(n.dims,n.type);return s.WasmBinding.getInstance().ccall("_batch_normalization_f32",[n.floatData,"float32ptr"],[h.floatData,"float32ptr","out"],[n.dims[0],"int32"],[n.dims[1],"int32"],[c,"int32"],[r.floatData,"float32ptr"],[i.floatData,"float32ptr"],[o.floatData,"float32ptr"],[l.floatData,"float32ptr"],[this.epsilon,"float32"]),[h]},e.prototype.checkInputTypes=function(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=t[4];return!(e.dims.length<3||1!==n.dims.length||1!==r.dims.length||1!==i.dims.length||1!==o.dims.length)&&n.dims[0]===e.dims[1]&&r.dims[0]===e.dims[1]&&i.dims[0]===e.dims[1]&&o.dims[0]===e.dims[1]&&"float32"===e.type&&"float32"===n.type&&"float32"===r.type&&"float32"===i.type&&"float32"===o.type},e}(o.BatchNormalization);e.WasmBatchNormalization=l},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.WasmBinaryOp=void 0;var o=n(15),a=n(1),s=n(0),l=n(4),c=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return i(e,t),e.prototype.run=function(t,e){var n=s.BroadcastUtil.calcShape(e[0].dims,e[1].dims,!1);if(!n)throw new Error("not broadcastable");var r,i="",o="";switch(this.opType){case"Add":"float32"===e[0].type&&(i="_add_f32",o="float32InFloat32Out");break;case"Sub":"float32"===e[0].type&&(i="_sub_f32",o="float32InFloat32Out");break;case"Mul":"float32"===e[0].type&&(i="_mul_f32",o="float32InFloat32Out");break;case"Div":"float32"===e[0].type&&(i="_div_f32",o="float32InFloat32Out");break;case"PRelu":"float32"===e[0].type&&(i="_prelu_f32",o="float32InFloat32Out");break;case"Xor":i="_xor_u8",o="boolInBoolOut";break;case"Or":i="_or_u8",o="boolInBoolOut";break;case"And":i="_and_u8",o="boolInBoolOut";break;default:throw Error("unsupported binary op by the Wasm backend")}if("float32InFloat32Out"===o)r=new a.Tensor(n,"float32"),l.WasmBinding.getInstance().ccall(i,[e[0].floatData,"float32ptr"],[e[0].dims.length,"int32"],[e[0].dims,"int32ptr"],[e[1].floatData,"float32ptr"],[e[1].dims.length,"int32"],[e[1].dims,"int32ptr"],[r.floatData,"float32ptr","out"],[r.floatData.length,"int32"],[n.length,"int32"],[n,"int32ptr"]);else{if("boolInBoolOut"!==o)throw new Error("Unsupported binary op format. Probably unsupported data types.");r=new a.Tensor(n,"bool"),l.WasmBinding.getInstance().ccall(i,[e[0].integerData,"boolptr"],[e[0].dims.length,"int32"],[e[0].dims,"int32ptr"],[e[1].integerData,"boolptr"],[e[1].dims.length,"int32"],[e[1].dims,"int32ptr"],[r.integerData,"boolptr","out"],[r.integerData.length,"int32"],[n.length,"int32"],[n,"int32ptr"])}return[r]},e}(o.BinaryOp);e.WasmBinaryOp=c},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.WasmClip=void 0;var o=n(49),a=n(1),s=n(4),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){var n=new a.Tensor(e[0].dims,e[0].type),r=n.floatData.length;if("float32"!==e[0].type)throw new Error("Unsupported input type for Clip operator.");return s.WasmBinding.getInstance().ccall("_clip_f32",[e[0].floatData,"float32ptr"],[n.floatData,"float32ptr","out"],[r,"int32"],[this.min,"float32"],[this.max,"float32"]),[n]},e.prototype.checkInputTypes=function(t){return"float32"===t[0].type},e}(o.Clip);e.WasmClip=l},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{l(r.next(t))}catch(t){o(t)}}function s(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((r=r.apply(t,e||[])).next())}))},a=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.WasmConv=void 0;var s=n(16),l=n(1),c=n(0),u=n(4),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return o(this,void 0,void 0,(function(){var t,n,r,i,o,s,h,d,p,f,m,g,y,v,b,x,_,w;return a(this,(function(a){switch(a.label){case 0:if(t=e[0],n=e[1],r=3===e.length?e[2]:void 0,0===this.kernelShape.length)for(i=e[1].dims,w=2;w<i.length;++w)this.kernelShape.push(i[w]);return o=c.PoolConvUtil.computeConvOutputShape(t.dims,n.dims,this.strides,this.dilations,this.kernelShape,this.pads,this.autoPad),s=new l.Tensor(o,t.type),1!==(h=function(t,e,n,r){return 1!==t||1!==e||1===n||r<=0?1:Math.min(n,r+1)}(t.dims[0],this.group,n.dims[0],u.WasmBinding.workerNumber))?[3,1]:(u.WasmBinding.getInstance().ccall("_conv_f32",[t.floatData,"float32ptr"],[t.dims,"int32ptr"],[n.floatData,"float32ptr"],[n.dims,"int32ptr"],[s.floatData,"float32ptr","out"],[s.dims,"int32ptr"],[r?r.floatData:null,"float32ptr"],[this.dilations,"int32ptr"],[this.group,"int32"],[this.pads,"int32ptr"],[this.strides,"int32ptr"]),[2,[s]]);case 1:for((d=n.dims.slice(0))[0]=Math.floor(n.dims[0]/h),p=d[0]*d[1]*d[2]*d[3],(f=n.dims.slice(0))[0]=n.dims[0]-(h-1)*d[0],m=[1,d[0],o[2],o[3]],g=d[0]*o[2]*o[3],y=[1,f[0],o[2],o[3]],v=new Array(h),b=new Array(h),x=new Array(h),_=new Array(h-1),w=0;w<h;++w)w!==h-1?(v[w]=n.floatData.subarray(w*p,(w+1)*p),b[w]=s.floatData.subarray(w*g,(w+1)*g),r&&(x[w]=r.floatData.subarray(w*d[0],(w+1)*d[0])),_[w]=u.WasmBinding.getInstance().ccallRemote(w,"_conv_f32",[t.floatData,"float32ptr"],[t.dims,"int32ptr"],[v[w],"float32ptr"],[d,"int32ptr"],[b[w],"float32ptr","out"],[m,"int32ptr"],[x.length>0?x[w]:null,"float32ptr"],[this.dilations,"int32ptr"],[this.group,"int32"],[this.pads,"int32ptr"],[this.strides,"int32ptr"])):(v[w]=n.floatData.subarray(w*p),b[w]=s.floatData.subarray(w*g),r&&(x[w]=r.floatData.subarray(w*d[0])),u.WasmBinding.getInstance().ccall("_conv_f32",[t.floatData,"float32ptr"],[t.dims,"int32ptr"],[v[w],"float32ptr"],[f,"int32ptr"],[b[w],"float32ptr","out"],[y,"int32ptr"],[x.length>0?x[w]:null,"float32ptr"],[this.dilations,"int32ptr"],[this.group,"int32"],[this.pads,"int32ptr"],[this.strides,"int32ptr"]));return[4,Promise.all(_)];case 2:return a.sent(),[2,[s]]}}))}))},e.prototype.checkInputTypes=function(t){return"float32"===t[0].type&&"float32"===t[1].type&&(3!==t.length||"float32"===t[2].type)},e}(s.Conv);e.WasmConv=h},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a};Object.defineProperty(e,"__esModule",{value:!0}),e.WasmGemm=void 0;var a=n(19),s=n(1),l=n(0),c=n(4),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){var n=e[0],r=e[1],i=e[2],a=o(l.GemmUtil.getShapeOfGemmResult(n.dims,this.transA,r.dims,this.transB,null==i?void 0:i.dims),2),u=a[0],h=a[1],d=new s.Tensor([u,h],n.type);if(i&&!l.BroadcastUtil.calc(d,i,(function(t,e){return e}),!0))throw new Error("c is not broadcastable to the shape of the result of the Gemm operator");return c.WasmBinding.getInstance().ccall("_gemm_f32",[this.transA,"bool"],[this.transB,"bool"],[this.transA?n.dims[1]:n.dims[0],"int32"],[this.transB?r.dims[0]:r.dims[1],"int32"],[this.transA?n.dims[0]:n.dims[1],"int32"],[this.alpha,"float32"],[n.floatData,"float32ptr"],[r.floatData,"float32ptr"],[this.beta,"float32"],[d.floatData,"float32ptr","inout"]),[d]},e.prototype.checkInputTypes=function(t){return"float32"===t[0].type&&"float32"===t[1].type&&"float32"===t[2].type&&t[0].type===t[1].type&&t[0].type===t[2].type},e}(a.Gemm);e.WasmGemm=u},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.WasmInstanceNormalization=void 0;var o=n(20),a=n(1),s=n(4),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){for(var n=e[0],r=e[1],i=e[2],o=1,l=2;l<n.dims.length;l++)o*=n.dims[l];var c=new a.Tensor(n.dims,n.type);return s.WasmBinding.getInstance().ccall("_instance_normalization_f32",[n.floatData,"float32ptr"],[c.floatData,"float32ptr","out"],[n.dims[0],"int32"],[n.dims[1],"int32"],[o,"int32"],[r.floatData,"float32ptr"],[i.floatData,"float32ptr"],[this.epsilon,"float32"]),[c]},e.prototype.checkInputTypes=function(t){var e=t[0],n=t[1],r=t[2];return!(e.dims.length<3||1!==n.dims.length||1!==r.dims.length)&&n.dims[0]===e.dims[1]&&r.dims[0]===e.dims[1]&&"float32"===e.type&&"float32"===n.type&&"float32"===r.type},e}(o.InstanceNormalization);e.WasmInstanceNormalization=l},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a};Object.defineProperty(e,"__esModule",{value:!0}),e.WasmMatMul=void 0;var a=n(18),s=n(1),l=n(0),c=n(4),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){var n=o(l.MatMulUtil.preprocessInputShapes(e[0].dims,e[1].dims),2),r=n[0],i=n[1],a=l.BroadcastUtil.calcShape(r,i,!0);if(!a)throw new Error("input dimensions do not match the requirement");var u=l.ShapeUtil.size(a),h=new Float32Array(u);c.WasmBinding.getInstance().ccall("_matmul_f32",[e[0].floatData,"float32ptr"],[e[0].dims,"int32ptr"],[e[0].dims.length,"int32"],[e[1].floatData,"float32ptr"],[e[1].dims,"int32ptr"],[e[1].dims.length,"int32"],[h,"float32ptr","out"],[h.length,"int32"],[a,"int32ptr"],[a.length,"int32"]),l.MatMulUtil.postprocessOutputShape(a,e[0].dims.length,e[1].dims.length);var d=new s.Tensor(a,e[0].type);return d.floatData.set(h),[d]},e.prototype.checkInputTypes=function(t){return"float32"===t[0].type&&"float32"===t[1].type&&t[0].type===t[1].type},e}(a.MatMul);e.WasmMatMul=u},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{l(r.next(t))}catch(t){o(t)}}function s(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((r=r.apply(t,e||[])).next())}))},a=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.WasmGlobalMaxPool=e.WasmMaxPool=e.WasmGlobalAveragePool=e.WasmAveragePool=void 0;var s=n(21),l=n(1),c=n(0),u=n(4),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.checkInputTypes=function(t){return m(t)},e.prototype.run=function(t,e){return o(this,void 0,void 0,(function(){return a(this,(function(t){return[2,g(e[0],this.autoPad,this.countIncludePad,this.kernelShape,this.pads,this.strides)]}))}))},e}(s.AveragePool);e.WasmAveragePool=h;var d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.checkInputTypes=function(t){return m(t)},e.prototype.run=function(t,e){return o(this,void 0,void 0,(function(){return a(this,(function(t){return[2,y(e[0])]}))}))},e}(s.GlobalAveragePool);e.WasmGlobalAveragePool=d;var p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.checkInputTypes=function(t){return m(t)},e.prototype.run=function(t,e){return o(this,void 0,void 0,(function(){return a(this,(function(t){return[2,v(e[0],this.autoPad,this.kernelShape,this.pads,this.strides)]}))}))},e}(s.MaxPool);e.WasmMaxPool=p;var f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.checkInputTypes=function(t){return m(t)},e.prototype.run=function(t,e){return o(this,void 0,void 0,(function(){return a(this,(function(t){return[2,b(e[0])]}))}))},e}(s.GlobalMaxPool);function m(t){return"float32"===t[0].type}function g(t,e,n,r,i,s){return o(this,void 0,void 0,(function(){return a(this,(function(o){return[2,x(!1,1,t,e,n,r,i,s)]}))}))}function y(t){return o(this,void 0,void 0,(function(){return a(this,(function(e){return[2,x(!0,1,t,"NOTSET",!1,[],[],[])]}))}))}function v(t,e,n,r,i){return o(this,void 0,void 0,(function(){return a(this,(function(o){return[2,x(!1,2,t,e,!1,n,r,i)]}))}))}function b(t){return o(this,void 0,void 0,(function(){return a(this,(function(e){return[2,x(!0,2,t,"NOTSET",!1,[],[],[])]}))}))}function x(t,e,n,r,i,s,h,d){return o(this,void 0,void 0,(function(){var o,p,f,m,g,y,v,b,x,_,w,S,T,E;return a(this,(function(a){switch(a.label){case 0:switch(o="",e){case 1:o="_average_pool_f32";break;case 2:o="_max_pool_f32";break;default:throw new Error("unknown pool type")}return c.PoolConvUtil.adjustPoolAttributes(t,n.dims,s,d,h),p=c.PoolConvUtil.computePoolOutputShape(t,n.dims,d,s,h,r),f=new l.Tensor(p,n.type),1!==(m=function(t,e,n){return 1!==t||1===e||n<=0?1:Math.min(e,n+1)}(n.dims[0],n.dims[1],u.WasmBinding.workerNumber))?[3,1]:(u.WasmBinding.getInstance().ccall(o,[s.length,"int32"],[t,"bool"],[n.floatData,"float32ptr"],[n.dims,"int32ptr"],[f.floatData,"float32ptr","out"],[f.dims,"int32ptr"],[s,"int32ptr"],[h,"int32ptr"],[d,"int32ptr"],[i,"bool"]),[3,3]);case 1:for((g=n.dims.slice(0))[1]=Math.floor(n.dims[1]/m),y=c.ShapeUtil.size(g),(v=n.dims.slice(0))[1]=n.dims[1]-(m-1)*g[1],(b=p.slice(0))[1]=g[1],x=c.ShapeUtil.size(b),(_=p.slice(0))[1]=v[1],w=new Array(m-1),S=n.floatData,T=f.floatData,E=0;E<m;++E)E!==m-1?w[E]=u.WasmBinding.getInstance().ccallRemote(E,o,[s.length,"int32"],[t,"bool"],[S.subarray(E*y,(E+1)*y),"float32ptr"],[g,"int32ptr"],[T.subarray(E*x,(E+1)*x),"float32ptr","out"],[b,"int32ptr"],[s,"int32ptr"],[h,"int32ptr"],[d,"int32ptr"],[i,"bool"]):u.WasmBinding.getInstance().ccall(o,[s.length,"int32"],[t,"bool"],[S.subarray((m-1)*y),"float32ptr"],[v,"int32ptr"],[T.subarray((m-1)*x),"float32ptr","out"],[_,"int32ptr"],[s,"int32ptr"],[h,"int32ptr"],[d,"int32ptr"],[i,"bool"]);return[4,Promise.all(w)];case 2:a.sent(),a.label=3;case 3:return[2,[f]]}}))}))}e.WasmGlobalMaxPool=f},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.WasmSoftmax=void 0;var o=n(22),a=n(1),s=n(0),l=n(4),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){var n=e[0],r=s.ShapeUtil.normalizeAxis(this.axis,n.dims.length),i=s.ShapeUtil.sizeToDimension(n.dims,r),o=s.ShapeUtil.sizeFromDimension(n.dims,r),c=new a.Tensor(n.dims,n.type);return l.WasmBinding.getInstance().ccall("_softmax_f32",[n.floatData,"float32ptr"],[c.floatData,"float32ptr","out"],[i,"int32"],[o,"int32"]),[c]},e.prototype.checkInputTypes=function(t){return"float32"===t[0].type},e}(o.Softmax);e.WasmSoftmax=c},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},a=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(o(arguments[e]));return t};Object.defineProperty(e,"__esModule",{value:!0}),e.WasmSum=void 0;var s=n(23),l=n(1),c=n(4),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){for(var n,r=new l.Tensor(e[0].dims,e[0].type),i=e[0].floatData.length,o=new Array(e.length),s=0;s<e.length;s++)o[s]=[e[s].floatData,"float32ptr"];return(n=c.WasmBinding.getInstance()).ccall.apply(n,a(["_sum_f32",[e.length,"int32"],[i,"int32"],[r.floatData,"float32ptr","inout"]],o)),[r]},e.prototype.checkInputTypes=function(t){if("float32"!==t[0].type)return!1;for(var e=1;e<t.length;e++)if(t[0].type!==t[e].type)return!1;return!0},e}(s.Sum);e.WasmSum=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.WebGLBackend=void 0;var r=n(3),i=n(120),o=n(165),a=function(){function t(){}return t.prototype.initialize=function(){try{return this.glContext=o.createWebGLContext(this.contextId),"number"!=typeof this.matmulMaxBatchSize&&(this.matmulMaxBatchSize=16),"string"!=typeof this.textureCacheMode&&(this.textureCacheMode="full"),r.Logger.verbose("WebGLBackend","Created WebGLContext: "+typeof this.glContext),!0}catch(t){return r.Logger.warning("WebGLBackend","Unable to initialize WebGLBackend. "+t),!1}},t.prototype.createSessionHandler=function(t){return new i.WebGLSessionHandler(this,t)},t.prototype.dispose=function(){this.glContext.dispose()},t}();e.WebGLBackend=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.WebGLSessionHandler=void 0;var r=n(3),i=n(11),o=n(121),a=n(123),s=n(154),l=n(163),c=n(164),u=function(){function t(t,e){this.backend=t,this.context=e,this.programManager=new s.ProgramManager(this.context.profiler,t.glContext),this.layoutStrategy=new l.AlwaysKeepOriginalSizeStrategy(t.glContext.maxTextureSize),this.textureManager=new c.TextureManager(t.glContext,this.layoutStrategy,this.context.profiler,{reuseTextures:"full"===t.textureCacheMode}),this.textureDataCache=new Map}return t.prototype.createInferenceHandler=function(){return new o.WebGLInferenceHandler(this)},t.prototype.onGraphInitialized=function(t){var e=t.getValues().filter((function(t){return-1===t.from&&t.tensor})).map((function(t){return t.tensor.dataId}));this.initializers=new Set(e)},t.prototype.isInitializer=function(t){return!!this.initializers&&this.initializers.has(t)},t.prototype.getTextureData=function(t){return this.textureDataCache.get(t)},t.prototype.setTextureData=function(t,e){r.Logger.verbose("WebGLSessionHandler","Storing Texture data in cache"),this.textureDataCache.set(t,e)},t.prototype.dispose=function(){var t=this;this.programManager.dispose(),this.textureManager.clearActiveTextures(),this.textureDataCache.forEach((function(e){return t.textureManager.releaseTexture(e,!0)})),this.textureDataCache=new Map},t.prototype.resolve=function(t,e){var n=i.resolveOperator(t,e,a.WEBGL_OP_RESOLVE_RULES);return n.initialize(t.attributes),n},t}();e.WebGLSessionHandler=u},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},i=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a};Object.defineProperty(e,"__esModule",{value:!0}),e.WebGLInferenceHandler=void 0;var o=n(3),a=n(1),s=n(0),l=n(122),c=n(50),u=function(){function t(t){this.session=t,this.textureDataCache=new Map}return t.prototype.run=function(t,e){var n=this.session.programManager.getArtifact(t);if(!n){var r=t.createProgramInfo(this,e);n=this.session.programManager.build(r),this.session.programManager.setArtifact(t,n)}var i=t.createRunData(this,n.programInfo,e);return this.session.programManager.run(n,i),[i.outputTextureData.tensor]},t.prototype.getOrCreateTextureData=function(t,e){var n=this.getTextureData(t.dataId);return n?o.Logger.verbose("InferenceHandler","Retrieving TextureData from cache: ["+t.dims+"]"):(o.Logger.verbose("InferenceHandler","Creating new TextureData for dims: ["+t.dims+"]"),e||(e=this.createTextureLayoutFromShape(t.dims.slice())),n=this.createTextureData(e,t.type,t.numberData,t,1)),n},t.prototype.createTextureDataFromLayout=function(t,e){return this.createTextureData(t,e)},t.prototype.createTextureDataFromLayoutBindTensor=function(t,e,n,r){return this.createTextureData(t,e,n,r,1)},t.prototype.createTextureData=function(t,e,n,r,i){o.Logger.verbose("InferenceHandler","Creating TextureData: layout:["+JSON.stringify(t)+"]");var a=this.session.textureManager.createTextureFromLayout(e,t,n,i);return this.createTextureDataFromTexture(t,e,a,r)},t.prototype.createSharedTextureData=function(t,e,n,r){return this.createTextureDataFromTexture(t,e,n,void 0,r)},t.prototype.createTextureDataFromTexture=function(t,e,n,i,o){var s=this,l=r(r({},t),{tensor:i||new a.Tensor(t.unpackedShape,e,(function(t){return s.readTexture(l)}),void 0,void 0,o),texture:n});return this.setTextureData(l.tensor.dataId,l),l},t.prototype.getTextureData=function(t){return this.session.isInitializer(t)?this.session.getTextureData(t):this.textureDataCache.get(t)},t.prototype.setTextureData=function(t,e){this.session.isInitializer(t)?this.session.setTextureData(t,e):this.textureDataCache.set(t,e)},t.prototype.getOrCreateTextureLayout=function(t,e,n){return void 0===e&&(e=1),this.getTextureData(t.dataId)||this.createTextureLayoutFromShape(1===e?t.dims.slice():c.getPackedShape(t.dims.slice()),e,n)},t.prototype.createTextureLayoutFromShape=function(t,e,n,r){void 0===e&&(e=1);var o=i(this.session.layoutStrategy.computeTextureWH(t,r),2),a=o[0],l=o[1],c=t;if(0===t.length&&(c=[1]),1===e)n=t;else if(!n)throw new Error("Unpacked shape is needed when using channels > 1");return{width:a,height:l,channels:e||1,shape:c,strides:s.ShapeUtil.computeStrides(c),unpackedShape:n}},t.prototype.dispose=function(){var t=this;this.session.textureManager.clearActiveTextures(),this.textureDataCache.forEach((function(e){return t.session.textureManager.releaseTexture(e)})),this.textureDataCache=new Map},t.prototype.readTexture=function(t){if(!this.session.backend.glContext.isFloat32DownloadSupported){var e=(new l.WebGLUint8Encode).runInternal(this,t);return this.session.textureManager.readUint8TextureAsFloat(e)}return this.session.textureManager.readTexture(t,t.tensor.type,t.channels)},t}();e.WebGLInferenceHandler=u},function(t,e,n){"use strict";var r=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a};Object.defineProperty(e,"__esModule",{value:!0}),e.WebGLUint8Encode=void 0;var i=n(0),o=n(2),a=function(){function t(){}return t.prototype.runInternal=function(t,e){var n=e.shape,a=r(t.session.layoutStrategy.computeTextureWH(e.shape),2),s={width:a[0],height:a[1],channels:4,shape:n,strides:i.ShapeUtil.computeStrides(n),unpackedShape:n},l=o.getGlsl(t.session.backend.glContext.version),c={inputLayouts:[e],outputLayout:s,samplers:["X"],shaderSource:"\n      const float FLOAT_MAX = 1.70141184e38;\n      const float FLOAT_MIN = 1.17549435e-38;\n\n      bool isNaN(float val) {\n        return (val < 1.0 || 0.0 < val || val == 0.0) ? false : true;\n      }\n\n      highp vec4 encodeAsUint8(highp float v) {\n        if (isNaN(v)) {\n          return vec4(255, 255, 255, 255);\n        }\n\n        highp float av = abs(v);\n\n        if(av < FLOAT_MIN) {\n          return vec4(0.0, 0.0, 0.0, 0.0);\n        } else if(v > FLOAT_MAX) {\n          return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n        } else if(v < -FLOAT_MAX) {\n          return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n        }\n\n        highp vec4 c = vec4(0,0,0,0);\n\n        highp float e = floor(log2(av));\n        highp float m = exp2(fract(log2(av))) - 1.0;\n\n        c[2] = floor(128.0 * m);\n        m -= c[2] / 128.0;\n        c[1] = floor(32768.0 * m);\n        m -= c[1] / 32768.0;\n        c[0] = floor(8388608.0 * m);\n\n        highp float ebias = e + 127.0;\n        c[3] = floor(ebias / 2.0);\n        ebias -= c[3] * 2.0;\n        c[2] += floor(ebias) * 128.0;\n\n        c[3] += 128.0 * step(0.0, -v);\n\n        return c / 255.0;\n      }\n\n      void main() {\n        float value = "+l.texture2D+"(X,TexCoords).r;\n        "+l.output+" = encodeAsUint8(value);\n      }",hasMain:!0},u=t.session.programManager.build(c),h=t.session.backend.glContext.getEncoder("byte",4),d=t.session.backend.glContext.allocateTexture(s.width,s.height,h),p={inputTextureDatas:[e],outputTextureData:t.createSharedTextureData(s,"uint8",d,{}),uniformData:{}};return t.session.programManager.run(u,p),p.outputTextureData},t}();e.WebGLUint8Encode=a},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.WEBGL_OP_RESOLVE_RULES=void 0;var a=n(7),s=n(124),l=o(n(125)),c=n(126),u=n(127),h=n(128),d=n(129),p=n(130),f=n(132),m=n(133),g=n(134),y=n(135),v=n(136),b=n(137),x=n(139),_=n(140),w=n(141),S=o(n(142)),T=n(10),E=n(143),M=n(144),C=n(145),A=n(147),k=n(148),I=n(149),R=n(150),P=o(n(151)),N=n(152),O=n(153);e.WEBGL_OP_RESOLVE_RULES=[["Abs","","6+",function(){return new P.WebGLUnaryOp(a.NUMBER_TYPES,P.glslAbs())}],["Acos","","7+",function(){return new P.WebGLUnaryOp(a.FLOAT_TYPES,P.glslAcos())}],["Add","","7+",function(){return new l.WebGLBinaryOp(a.NUMBER_TYPES,l.glslAdd())}],["And","","7+",function(){return new l.WebGLBinaryOp(["bool"],l.glslAnd())}],["Asin","","7+",function(){return new P.WebGLUnaryOp(a.FLOAT_TYPES,P.glslAsin())}],["Atan","","7+",function(){return new P.WebGLUnaryOp(a.FLOAT_TYPES,P.glslAtan())}],["AveragePool","","7-10",function(){return new w.WebGLAveragePool}],["BatchNormalization","","7+",function(){return new s.WebGLBatchNormalization}],["Ceil","","6+",function(){return new P.WebGLUnaryOp(a.FLOAT_TYPES,P.glslCeil())}],["Clip","","6-10",function(){return new c.WebGLClip}],["Concat","","4+",function(){return new u.WebGLConcat}],["Conv","","1+",function(){return new h.WebGLConv}],["Cos","","7+",function(){return new P.WebGLUnaryOp(a.FLOAT_TYPES,P.glslCos())}],["Div","","7+",function(){return new l.WebGLBinaryOp(a.NUMBER_TYPES,l.glslDiv())}],["Dropout","","7+",function(){return new d.WebGLDropout}],["Equal","","7+",function(){return new l.WebGLBinaryOp(a.NUMBER_TYPES,l.glslEqual(),void 0,"bool")}],["Elu","","6+",function(){return new p.WebGLElu}],["Exp","","6+",function(){return new P.WebGLUnaryOp(a.FLOAT_TYPES,P.glslExp())}],["Flatten","","1+",function(){return new f.WebGLFlatten}],["Floor","","6+",function(){return new P.WebGLUnaryOp(a.FLOAT_TYPES,P.glslFloor())}],["Gather","","1+",function(){return new m.WebGLGather}],["Gemm","","7-10",function(){return new g.WebGLGemm(!1)}],["Gemm","","11+",function(){return new g.WebGLGemm(!0)}],["GlobalAveragePool","","1+",function(){return new w.WebGLGlobalAveragePool}],["GlobalMaxPool","","1+",function(){return new w.WebGLGlobalMaxPool}],["Greater","","7+",function(){return new l.WebGLBinaryOp(a.NUMBER_TYPES,l.glslGreater(),void 0,"bool")}],["Identity","","1+",function(){return new P.WebGLUnaryOp(a.NUMBER_TYPES,P.glslIdentity())}],["ImageScaler","","1+",function(){return new y.WebGLImageScaler}],["InstanceNormalization","","6+",function(){return new v.WebGLInstanceNormalization}],["LeakyRelu","","6+",function(){return new b.WebGLLeakyRelu}],["Less","","7+",function(){return new l.WebGLBinaryOp(a.NUMBER_TYPES,l.glslLess(),void 0,"bool")}],["Log","","6+",function(){return new P.WebGLUnaryOp(a.FLOAT_TYPES,P.glslLog())}],["MatMul","","1+",function(){return new x.WebGLMatMul}],["MaxPool","","1-9",function(){return new w.WebGLMaxPool}],["Mul","","7+",function(){return new l.WebGLBinaryOp(a.NUMBER_TYPES,l.glslMul())}],["Neg","","6+",function(){return new P.WebGLUnaryOp(a.NUMBER_TYPES,P.glslNeg())}],["Not","","1+",function(){return new P.WebGLUnaryOp(["bool"],P.glslNot())}],["Or","","7+",function(){return new l.WebGLBinaryOp(["bool"],l.glslOr())}],["Pad","","2-10",function(){return new _.WebGLPad}],["Pow","","7+",function(){return new l.WebGLBinaryOp(a.FLOAT_TYPES,l.glslPow())}],["PRelu","","7+",function(){return new l.WebGLBinaryOp(a.FLOAT_TYPES,l.glslPRelu())}],["ReduceLogSum","","1+",function(){return new S.WebGLReduceLogSum}],["ReduceMax","","1+",function(){return new S.WebGLReduceMax}],["ReduceMean","","1+",function(){return new S.WebGLReduceMean}],["ReduceMin","","1+",function(){return new S.WebGLReduceMin}],["ReduceProd","","1+",function(){return new S.WebGLReduceProd}],["ReduceSum","","1+",function(){return new S.WebGLReduceSum}],["ReduceSumSquare","","1+",function(){return new S.WebGLReduceSumSquare}],["Relu","","6+",function(){return new P.WebGLUnaryOp(a.FLOAT_TYPES,P.glslRelu())}],["Reshape","","5+",function(){return new T.WebGLReshape}],["Sigmoid","","6+",function(){return new P.WebGLUnaryOp(a.FLOAT_TYPES,P.glslSigmoid())}],["Sin","","7+",function(){return new P.WebGLUnaryOp(a.FLOAT_TYPES,P.glslSin())}],["Slice","","10+",function(){return new E.WebGLSliceV10}],["Slice","","1-9",function(){return new E.WebGLSlice}],["Softmax","","1+",function(){return new M.WebGLSoftmax}],["Split","","2+",function(t){return new C.WebGLSplit(t.outputs.length)}],["Sqrt","","6+",function(){return new P.WebGLUnaryOp(a.FLOAT_TYPES,P.glslSqrt())}],["Squeeze","","1+",function(){return new A.WebGLSqueeze}],["Sub","","7+",function(){return new l.WebGLBinaryOp(a.NUMBER_TYPES,l.glslSub())}],["Sum","","6+",function(){return new k.WebGLSum}],["Tan","","7+",function(){return new P.WebGLUnaryOp(a.FLOAT_TYPES,P.glslTan())}],["Tanh","","6+",function(){return new P.WebGLUnaryOp(a.FLOAT_TYPES,P.glslTanh())}],["Tile","","6+",function(){return new I.WebGLTile}],["Transpose","","1+",function(){return new R.WebGLTranspose}],["Upsample","","7-8",function(){return new O.WebGLUpsample}],["Unsqueeze","","1+",function(){return new N.WebGLUnsqueeze}],["Xor","","7+",function(){return new l.WebGLBinaryOp(["bool"],l.glslXor())}]]},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.WebGLBatchNormalization=void 0;var o=n(14),a=n(2),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return t.run(this,e)},e.prototype.createProgramInfo=function(t,e){var n=e.map((function(e){return t.getOrCreateTextureLayout(e)})),r=e[0].dims.slice(),i=r.length,o=n[1],s=a.getGlsl(t.session.backend.glContext.version),l="\n      float process(int["+i+"] indices) {\n        vec2 position = offsetToCoords(indices[1], "+o.width+", "+o.height+");\n        float scale = getColorAsFloat("+s.texture2D+"(Scale, position));\n        float mean = getColorAsFloat("+s.texture2D+"(Mean, position));\n        float variance = getColorAsFloat("+s.texture2D+"(Variance, position));\n        float b = getColorAsFloat("+s.texture2D+"(B, position));\n\n        return scale * ( (_A(indices) - mean) / sqrt(variance + float("+this.epsilon+")) ) + b;\n      }";return{inputLayouts:n,outputLayout:t.createTextureLayoutFromShape(r),samplers:["A","Scale","B","Mean","Variance"],shaderSource:l}},e.prototype.createRunData=function(t,e,n){var r=[t.getOrCreateTextureData(n[0],e.inputLayouts[0])];n.slice(1).forEach((function(e){return r.push(t.getOrCreateTextureData(e))}));var i=t.createTextureDataFromLayout(e.outputLayout,r[0].tensor.type);return{inputTextureDatas:r,outputTextureData:i,uniformData:{}}},e}(o.BatchNormalization);e.WebGLBatchNormalization=s},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.glslPRelu=e.glslPow=e.glslXor=e.glslOr=e.glslAnd=e.glslLess=e.glslGreater=e.glslEqual=e.glslSub=e.glslMul=e.glslDiv=e.glslAdd=e.WebGLBinaryOp=void 0;var o=n(15),a=n(0),s=n(5),l=n(2),c=function(t){function e(e,n,r,i){var o=t.call(this,e,r,i)||this;return o.glslFunc=n,o}return i(e,t),e.prototype.run=function(t,e){return t.run(this,e)},e.prototype.createProgramInfo=function(t,e){var n=e.map((function(e){return t.getOrCreateTextureLayout(e)}));if(!a.ShapeUtil.areEqual(e[0].dims,e[1].dims)){var r=a.BroadcastUtil.calcShape(e[0].dims,e[1].dims,!1);if(!r)throw new Error("Can't perform binary op on the given tensors");var i=r.length,o=0!==e[0].dims.length?e[0].dims.length:1,s=0!==e[1].dims.length?e[1].dims.length:1,c=0!==e[0].dims.length?"bcastIndices_A(indices, aindices);":"aindices[0] = 0;",u=0!==e[1].dims.length?"bcastIndices_B(indices, bindices);":"bindices[0] = 0;",h="\n      "+this.glslFunc.body+"\n      float process(int indices["+i+"]) {\n        int aindices["+o+"];\n        int bindices["+s+"];\n        "+c+"\n        "+u+"\n        return "+this.glslFunc.name+"(_A(aindices), _B(bindices));\n    }";return{inputLayouts:n,outputLayout:t.createTextureLayoutFromShape(r),samplers:["A","B"],shaderSource:h}}var d=l.getGlsl(t.session.backend.glContext.version),p="\n    "+this.glslFunc.body+"\n    void main() {\n      vec4 v1 = "+d.texture2D+"(A, TexCoords);\n      vec4 v2 = "+d.texture2D+"(B, TexCoords);\n      vec4 result = "+this.glslFunc.name+"(v1, v2);\n      "+d.output+" = result;\n    }\n    ";return{hasMain:!0,inputLayouts:n,outputLayout:t.createTextureLayoutFromShape(e[0].dims),samplers:["A","B"],shaderSource:p}},e.prototype.createRunData=function(t,e,n){return{inputTextureDatas:n.map((function(n,r){return t.getOrCreateTextureData(n,e.inputLayouts[r])})),outputTextureData:t.createTextureDataFromLayout(e.outputLayout,this.resultType?this.resultType:n[0].type),uniformData:{}}},e}(o.BinaryOp);e.WebGLBinaryOp=c,e.glslAdd=function(){return{body:"\n  float add_(float a, float b) {\n    return a + b;\n  }\n  vec4 add_(vec4 v1, vec4 v2) {\n    return v1 + v2;\n  }\n  ",name:"add_",type:s.FunctionType.ValueBased}},e.glslDiv=function(){return{body:"\n  float div_(float a, float b) {\n    return a / b;\n  }\n  vec4 div_(vec4 v1, vec4 v2) {\n    return v1 / v2;\n  }\n  ",name:"div_",type:s.FunctionType.ValueBased}},e.glslMul=function(){return{body:"\n  float mul_(float a, float b) {\n    return a * b;\n  }\n  vec4 mul_(vec4 v1, vec4 v2) {\n    return v1 * v2;\n  }\n  ",name:"mul_",type:s.FunctionType.ValueBased}},e.glslSub=function(){return{body:"\n  float sub_(float a, float b) {\n    return a - b;\n  }\n  vec4 sub_(vec4 v1, vec4 v2) {\n    return v1 - v2;\n  }\n  ",name:"sub_",type:s.FunctionType.ValueBased}},e.glslEqual=function(){return{body:"\n  float equal_(float a, float b) {\n    return float(a == b);\n  }\n  vec4 equal_(vec4 v1, vec4 v2) {\n    return vec4( v1 == v2 );\n  }\n  ",name:"equal_",type:s.FunctionType.ValueBased}},e.glslGreater=function(){return{body:"\n  float greater_(float a, float b) {\n    return float(a > b);\n  }\n  vec4 greater_(vec4 v1, vec4 v2) {\n    return vec4( v1.r > v2.r ,\n      v1.g > v2.g,\n      v1.b > v2.b,\n      v1.a > v2.a );\n  }\n  ",name:"greater_",type:s.FunctionType.ValueBased}},e.glslLess=function(){return{body:"\n  float less_(float a, float b) {\n    return float(a < b);\n  }\n  vec4 less_(vec4 v1, vec4 v2) {\n    return vec4( v1.r < v2.r ,\n                v1.g < v2.g,\n                v1.b < v2.b,\n                v1.a < v2.a );\n  }\n  ",name:"less_",type:s.FunctionType.ValueBased}},e.glslAnd=function(){return{body:"\n  float and_(float a, float b) {\n    return float( bool(a) && bool(b) );\n  }\n  vec4 and_(vec4 v1, vec4 v2) {\n    bvec4 b1 = bvec4(v1);\n    bvec4 b2 = bvec4(v2);\n    return vec4( b1.r && b2.r ,\n                b1.g && b2.g,\n                b1.b && b2.b,\n                b1.a && b2.a );\n  }\n  ",name:"and_",type:s.FunctionType.ValueBased}},e.glslOr=function(){return{body:"\n  float or_(float a, float b) {\n    return float( bool(a) || bool(b) );\n  }\n  vec4 or_(vec4 v1, vec4 v2) {\n    bvec4 b1 = bvec4(v1);\n    bvec4 b2 = bvec4(v2);\n    return vec4( b1.r || b2.r ,\n                b1.g || b2.g,\n                b1.b || b2.b,\n                b1.a || b2.a );\n  }\n  ",name:"or_",type:s.FunctionType.ValueBased}},e.glslXor=function(){return{body:"\n  float xor_(float a, float b) {\n    return float( bool(a) ^^ bool(b) );\n  }\n  vec4 xor_(vec4 v1, vec4 v2) {\n    bvec4 b1 = bvec4(v1);\n    bvec4 b2 = bvec4(v2);\n    return vec4( b1.r ^^ b2.r ,\n                b1.g ^^ b2.g,\n                b1.b ^^ b2.b,\n                b1.a ^^ b2.a );\n  }\n  ",name:"xor_",type:s.FunctionType.ValueBased}},e.glslPow=function(){return function(t){var e=t+"_";return{body:"\n  float pow_(float a, float b) {\n    return pow(a, b);\n  }\n  vec4 pow_(vec4 v1, vec4 v2) {\n    return pow(v1, v2);\n  }\n  ",name:e,type:s.FunctionType.ValueBased}}("pow")},e.glslPRelu=function(){return{body:"\n  float prelu_(float a, float b) {\n    return a < 0.0 ? a * b: a;\n  }\n  vec4 prelu_(vec4 v1, vec4 v2) {\n    return vec4(\n      v1.r < 0.0 ? v1.r * v2.r: v1.r,\n      v1.g < 0.0 ? v1.g * v2.g: v1.g,\n      v1.b < 0.0 ? v1.b * v2.b: v1.b,\n      v1.a < 0.0 ? v1.a * v2.a: v1.a\n      );\n  }\n  ",name:"prelu_",type:s.FunctionType.ValueBased}}},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.WebGLClip=void 0;var o=n(49),a=n(2),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return t.run(this,e)},e.prototype.createProgramInfo=function(t,e){var n=e[0].dims.slice(),r=a.getGlsl(t.session.backend.glContext.version),i="\n      const float min = float("+this.min+");\n      const float max = float("+this.max+");\n      void main() {\n        float v = "+r.texture2D+"(A, TexCoords).r;\n        "+r.output+" = vec4(clamp(v, min, max));\n      }\n      ";return{inputLayouts:[t.getOrCreateTextureLayout(e[0])],outputLayout:t.createTextureLayoutFromShape(n),samplers:["A"],shaderSource:i,hasMain:!0}},e.prototype.createRunData=function(t,e,n){var r=[t.getOrCreateTextureData(n[0],e.inputLayouts[0])];return{inputTextureDatas:r,outputTextureData:t.createTextureDataFromLayout(e.outputLayout,r[0].tensor.type),uniformData:{}}},e}(o.Clip);e.WebGLClip=s},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.WebGLConcat=void 0;var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return t.run(this,e)},e.prototype.createProgramInfo=function(t,e){var n=e[0].dims.slice();if(this.axis>=n.length||this.axis<-1*n.length)throw new Error("axis specified for concat doesn't match input dimensionality");this.axis<0&&(this.axis=n.length+this.axis);for(var r=n.slice(0),i=1;i<e.length;i++)for(var o=e[i].dims.slice(),a=0;a<n.length;a++)if(a===this.axis)r[this.axis]+=o[a];else if(n[a]!==o[a])throw new Error("non concat dimensions must match");var s,l=r.length;s=e.length<5?this.getTextureIndexWhereDataResidesLinearSearch(e.length):this.getTextureIndexWhereDataResidesBinarySearch(e.length);var c=this.fetchDataFromCorrectTextureMethod(e.length,l),u=this.getValueFromArrayIndexMethod(e.length),h=e.map((function(t,e){return"X"+e})),d="\n      "+c+"\n      "+u+"\n      "+s+"\n      float process(int indices["+l+"]) {\n        int textureIndex = getTextureWhereDataResides (indices["+this.axis+"]);\n\n        if(textureIndex != 0) {\n          indices["+this.axis+"] = indices["+this.axis+"] - int(getValueFromArrayIndex(sizeInConcatAxis, textureIndex-int(1)));\n        }\n\n        return fetchDataFromCorrectTexture(textureIndex, indices);\n      }";return{inputLayouts:e.map((function(e){return t.getOrCreateTextureLayout(e)})),outputLayout:t.createTextureLayoutFromShape(r),samplers:h,variables:[{name:"sizeInConcatAxis",type:"int",arrayLength:e.length}],shaderSource:d}},e.prototype.createRunData=function(t,e,n){for(var r=n.map((function(n,r){return t.getOrCreateTextureData(n,e.inputLayouts[r])})),i=new Array(e.inputLayouts.length),o=0,a=0;a<e.inputLayouts.length;++a)o+=e.inputLayouts[a].shape[this.axis],i[a]=o;var s={sizeInConcatAxis:i};return{inputTextureDatas:r,outputTextureData:t.createTextureDataFromLayout(e.outputLayout,r[0].tensor.type),uniformData:s}},e.prototype.getTextureIndexWhereDataResidesLinearSearch=function(t){return"int getTextureWhereDataResides(int index) {\n      for(int i=0; i<"+t+"; i++) {\n          if(index < int(sizeInConcatAxis[i])){\n              return i;\n          }\n        }\n      }"},e.prototype.getTextureIndexWhereDataResidesBinarySearch=function(t){return this.getTextureIndexWhereDataResidesLinearSearch(t)},e.prototype.fetchDataFromCorrectTextureMethod=function(t,e){for(var n=["float fetchDataFromCorrectTexture(int textureIndex, int indices["+e+"]) {"],r=0;r<t;++r)0===r?n.push("\tif (textureIndex == "+r+") { return _X"+r+"(indices); }"):r===t-1?n.push("\telse { return _X"+r+"(indices); }"):n.push("\telse if (textureIndex == "+r+") { return _X"+r+"(indices); }");return n.push("\t}"),n.join("\n")},e.prototype.getValueFromArrayIndexMethod=function(t){for(var e=["int getValueFromArrayIndex(int arr["+t+"], int index) {"],n=0;n<t;++n)0===n?e.push("\tif (index == "+n+") { return arr["+n+"]; }"):n===t-1?e.push("\telse { return arr["+n+"]; }"):e.push("\telse if (index == "+n+") { return arr["+n+"]; }");return e.push("\t}"),e.join("\n")},e}(n(30).Concat);e.WebGLConcat=o},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},a=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(o(arguments[e]));return t};Object.defineProperty(e,"__esModule",{value:!0}),e.WebGLConv=void 0;var s=n(3),l=n(16),c=n(0),u=n(2),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.readSize=8,e.blockSize=64,e}return i(e,t),e.prototype.run=function(t,e){var n=t.session.programManager;if(!this.artifacts){this.artifacts=[];for(var r=this.createProgramInfos(t,e),i=0;i<r.length;++i){var o=t.session.programManager.build(r[i]);this.artifacts.push(o)}}var a=this.createRunDatas(t,this.artifacts.map((function(t){return t.programInfo})),e);return n.run(this.artifacts[0],a[0]),n.run(this.artifacts[1],a[1]),[a[1].outputTextureData.tensor]},e.prototype.createProgramInfos=function(t,n){var r=n[0].dims.slice(),i=n[1].dims.slice();if(0===this.kernelShape.length)for(var o=n[1].dims,a=2;a<o.length;++a)this.kernelShape.push(o[a]);c.PoolConvUtil.adjustPadsBasedOnAutoPad(n[0].dims,this.strides,this.dilations,this.kernelShape,this.pads,this.autoPad),s.Logger.verbose("Conv","autpPad:"+this.autoPad+", dilations:"+this.dilations+", group:"+this.group+", kernelShape:"+this.kernelShape+", pads:"+this.pads+", strides:"+this.strides);var l=e.calcOutputShape(r,i,this.dilations,this.pads,this.strides),u=this.createIm2ColProgramInfo(t,n,l);return[u,this.createDotProductProgramInfo(t,u.outputLayout,n,l)]},e.prototype.createRunDatas=function(t,n,r){var i=r[1],o=r.length>=3?r[2]:void 0,a=t.getTextureData(i.dataId);if(!a){s.Logger.verbose("Conv","Did not find the adjustedKernel texture in the cache. Creating rew.");var l=e.prepKernelForDotProduct(i.dims.slice(),this.group,4,i.floatData);a=t.createTextureDataFromLayoutBindTensor(n[1].inputLayouts[1],i.type,l,i)}var c={inputTextureDatas:[t.getOrCreateTextureData(r[0])],outputTextureData:t.createTextureDataFromLayout(n[0].outputLayout,r[0].type),uniformData:{}},u=[c.outputTextureData,a];return o&&u.push(t.getOrCreateTextureData(o)),[c,{inputTextureDatas:u,outputTextureData:t.createTextureDataFromLayout(n[1].outputLayout,r[0].type),uniformData:{},draw:function(t,e){for(var n=t.gl,r=e.programInfo.params.sharedDim,i=e.programInfo.params.sharedDimReadSize,o=e.uniformLocations.find((function(t){return"sharedDimOffset"===t.name})).location,a=!1,l=0;l<r;l+=i)s.Logger.verbose("MatMul2D","k = "+l+", sharedDim: "+r+", readSize = "+i),l===i&&(a=!0,n.enable(n.BLEND),t.checkError(),n.blendEquation(n.FUNC_ADD),t.checkError(),n.blendFunc(n.ONE,n.ONE),t.checkError()),n.uniform1i(o,l),t.checkError(),t.draw();a&&(n.disable(n.BLEND),t.checkError())}}]},e.prototype.createIm2ColProgramInfo=function(t,n,r){var i=n[0].dims.slice(),o=n[1].dims.slice(),a=r.length,s=e.calcIm2ColDims(i,o,r,4),l=t.createTextureLayoutFromShape(s,4,[s[0],s[1],s[2],4*s[3]],{breakAxis:3}),c="\n      const int XC = "+i[1]+";\n      const int XH = "+i[2]+";\n      const int XW = "+i[3]+";\n      const int KH = "+this.kernelShape[0]+";\n      const int KW = "+this.kernelShape[1]+";\n      const int dilationH = "+this.dilations[0]+";\n      const int dilationW = "+this.dilations[1]+";\n      const int strideH = "+this.strides[0]+";\n      const int strideW = "+this.strides[1]+";\n      const int padH = "+this.pads[0]+";\n      const int padW = "+this.pads[1]+";\n      const int KHKW = KH*KW;\n      const int XCKHKW = XC * KHKW;\n      const int outputChannels = 4;\n\n      vec4 process(int indices["+a+"]) {\n        int b  = indices[0]; // batch size\n        int oh = indices[1] * strideH - padH; //output height\n        int ow = indices[2] * strideW - padW; //output width\n        int p = indices[3] * outputChannels; //patch\n        vec4 v = vec4(0.0);\n        for(int i=0; i < outputChannels; ++i) {\n          if(p < XCKHKW) {\n            int patchC = p / KHKW;\n            int patchH = (p - patchC*KHKW) / KW;\n            int patchW = (p - patchC*KHKW) - patchH * KW;\n            int xh2 = oh + patchH * dilationH;\n            int xw2 = ow + patchW * dilationW;\n            int x["+i.length+"];\n            x[0] = b;\n            x[1] = patchC;\n            x[2] = xh2;\n            x[3] = xw2;\n            if(xh2 >= 0 &&\n                xh2 < XH &&\n                xw2 >= 0 &&\n                xw2 < XW) {\n              v[i] = _X(x);\n            }\n          }\n          ++p;\n        }\n        return v;\n      }\n      ";return{inputLayouts:[t.createTextureLayoutFromShape(i)],outputLayout:l,samplers:["X"],shaderSource:c}},e.prototype.createDotProductProgramInfo=function(t,e,n,r){var i,o=n[0].dims.slice(),a=n[1].dims.slice(),s=[a[0],Math.ceil(o[1]*a[2]*a[3]/4)],l=t.createTextureLayoutFromShape(s,4,[s[0],4*s[1]],{breakAxis:1}),c=r.length,h=[e,l];3===n.length&&(i=t.createTextureLayoutFromShape(n[2].dims.slice()),h.push(i));var d=t.createTextureLayoutFromShape(r),p=n.length<3?"0.0":"_B(b)",f=e.shape[3],m=t.session.backend.glContext.isBlendSupported&&t.session.backend.matmulMaxBatchSize?this.calcSharedDimReadSize(t.session.backend.matmulMaxBatchSize,f):f,g=["Im2Col","K"];3===n.length&&g.push("B");var y=u.getGlsl(t.session.backend.glContext.version),v="\n    float process(int indices["+c+"]) {\n      int b[1];\n      b[0] = indices[1];\n      int im2col["+e.shape.length+"];\n      im2col[0] = indices[0];\n      im2col[1] = indices[2];\n      im2col[2] = indices[3];\n      int im2colOffset = im2col[0] * "+e.strides[0]+" + im2col[1] * "+e.strides[1]+" + im2col[2] * "+e.strides[2]+" + sharedDimOffset;\n      int kernelOffset = indices[1] * "+l.strides[0]+" + sharedDimOffset;\n      float sum = sharedDimOffset == 0 ? "+p+" : 0.0;\n      for (int i = 0; i < "+m+"; ++i) {\n        vec2 im2colCoords = offsetToCoords(im2colOffset, "+e.width+", "+e.height+");\n        vec2 kernelCoords = offsetToCoords(kernelOffset, "+l.width+", "+l.height+");\n        sum += dot("+y.texture2D+"(Im2Col, im2colCoords), "+y.texture2D+"(K, kernelCoords));\n        ++im2colOffset;\n        ++kernelOffset;\n      }\n      return sum;\n    }";return{inputLayouts:3===n.length?[e,l,i]:[e,l],outputLayout:d,shaderSource:v,samplers:g,variables:[{name:"sharedDimOffset",type:"int"}],params:{sharedDim:f,sharedDimReadSize:m}}},e.prepKernelForDotProduct=function(t,e,n,r){if(1===e&&(1===n||t[2]*t[3]%n==0))return r;for(var i=t[0],o=t[1]*t[2]*t[3],a=Math.ceil(o*e/n)*n,s=new Float32Array(i*a),l=0;l<i;++l){var c=l*o,u=l*a+l%e*o;s.set(r.subarray(c,c+o),u)}return s},e.calcIm2ColDims=function(t,e,n,r){return void 0===r&&(r=1),[n[0],n[2],n[3],Math.ceil(t[1]*e[2]*e[3]/r)]},e.calcOutputShape=function(t,e,n,r,i){var o,s=t[0],l=t.slice(2),c=l.length,u=e[0],h=e.slice(2).map((function(t,e){return t+(t-1)*(n[e]-1)})),d=l.map((function(t,e){return t+r[e]+r[e+c]})).map((function(t,e){return Math.floor((t-h[e]+i[e])/i[e])}));return(o=[s,u]).concat.apply(o,a(d))},e.prototype.calcSharedDimReadSize=function(t,e){return t<=0||e<t||e%t!=0?e:t},e.prototype.calcBlockSize=function(t){if(!(t.height<64))return[64,64]},e}(l.Conv);e.WebGLConv=h},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.WebGLDropout=void 0;var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){if(this.testMode)return[e[0]];throw new Error("Non test mode Dropout is not implemented yet")},e.prototype.createProgramInfo=function(t,e){throw new Error("Non test mode Dropout is not implemented yet")},e.prototype.createRunData=function(t,e,n){throw new Error("Non test mode Dropout is not implemented yet")},e}(n(31).Dropout);e.WebGLDropout=o},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.WebGLElu=void 0;var o=n(131),a=n(2),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return t.run(this,e)},e.prototype.createProgramInfo=function(t,e){var n=e[0].dims.slice(),r=a.getGlsl(t.session.backend.glContext.version),i="\n      void main() {\n        float v = "+r.texture2D+"(A, TexCoords).r;\n        "+r.output+" = vec4(v >= 0.0 ? v: (exp(v) - 1.0) * "+this.alpha.toExponential()+"); /* float number format */\n      }\n      ";return{inputLayouts:[t.getOrCreateTextureLayout(e[0])],outputLayout:t.createTextureLayoutFromShape(n),samplers:["A"],shaderSource:i,hasMain:!0}},e.prototype.createRunData=function(t,e,n){var r=[t.getOrCreateTextureData(n[0],e.inputLayouts[0])];return{inputTextureDatas:r,outputTextureData:t.createTextureDataFromLayout(e.outputLayout,r[0].tensor.type),uniformData:{}}},e}(o.Elu);e.WebGLElu=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Elu=void 0;var r=function(){function t(){}return t.prototype.initialize=function(t){this.alpha=t.getFloat("alpha",1)},t.prototype.checkInputs=function(t){return!(!t||1!==t.length)&&this.checkInputTypes(t)},t.prototype.checkInputTypes=function(t){return"float32"===t[0].type||"float64"===t[0].type},t}();e.Elu=r},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.WebGLFlatten=void 0;var o=n(32),a=n(0),s=n(10),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){var n=a.ShapeUtil.flattenShape(e[0].dims,this.axis);return[s.reshape(t,e[0],n)]},e}(o.Flatten);e.WebGLFlatten=l},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.WebGLGather=void 0;var o=n(33),a=n(0),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return t.run(this,e)},e.prototype.createProgramInfo=function(t,e){var n=e[0].dims.slice(),r=e[1].dims.slice(),i=new Array(n.length+r.length-1);if(0===i.length)throw Error("A scalar tensor output has not been supported");for(var o=a.ShapeUtil.normalizeAxis(this.axis,n.length),s=[],l=0;l<i.length;l++)l<o?(i[l]=n[l],s.push("inputIdx["+l+"] = outputIdx["+l+"];")):l<o+r.length?(i[l]=r[l-o],s.push("indexDataIdx["+(l-o)+"] = outputIdx["+l+"];")):(i[l]=n[l-r.length+1],s.push("inputIdx["+(l-r.length+1)+"] = outputIdx["+l+"];"));var c="\n      float process(int outputIdx["+i.length+"]) {\n        int inputIdx["+n.length+"];\n        int indexDataIdx["+r.length+"];\n        "+s.join("\n        ")+"\n        int idx = int(_B(indexDataIdx));\n        inputIdx["+o+"] = idx < 0 ? idx + "+n[o]+" : idx;\n        return _A(inputIdx);\n      }";return{inputLayouts:e.map((function(e){return t.getOrCreateTextureLayout(e)})),outputLayout:t.createTextureLayoutFromShape(i),samplers:["A","B"],shaderSource:c}},e.prototype.createRunData=function(t,e,n){var r=n.map((function(n,r){return t.getOrCreateTextureData(n,e.inputLayouts[r])}));return{inputTextureDatas:r,outputTextureData:t.createTextureDataFromLayout(e.outputLayout,r[0].tensor.type),uniformData:{}}},e}(o.Gather);e.WebGLGather=s},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a};Object.defineProperty(e,"__esModule",{value:!0}),e.WebGLGemm=void 0;var a=n(19),s=n(0),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return t.run(this,e)},e.prototype.createProgramInfo=function(t,e){var n=e[0].dims.slice(),r=e[1].dims.slice(),i=o(s.GemmUtil.getShapeOfGemmResult(n,this.transA,r,this.transB,3===e.length?e[2].dims:void 0),2),a=[i[0],i[1]];if(!a)throw new Error("Can't use gemm on the given tensors");var l=n[n.length-1],c="";this.transA&&(l=n[0]),this.transA&&this.transB?c="value += _A_T(a) * _B_T(b);":this.transA&&!this.transB?c="value += _A_T(a) * _B(b);":!this.transA&&this.transB?c="value += _A(a) * _B_T(b);":this.transA||this.transB||(c="value += _A(a) * _B(b);");var u=a.length,h="\n      float process(int indices["+u+"]) {\n          int a["+u+"];\n          int b["+u+"];\n          "+(3===e.length?"int c["+e[2].dims.length+"];":"")+"\n\n          copyVec(indices, a);\n          copyVec(indices, b);\n          "+(3===e.length?"bcastIndices_C(indices, c);":"")+"\n\n          float value = 0.0;\n          for (int k=0; k<"+l+"; ++k) {\n              a["+(u-1)+"] = k;\n              b["+(u-2)+"] = k;\n              "+c+"\n          }\n\n          value = value * alpha;\n          "+(3===e.length?"value += beta * _C(c);":"")+"\n          return value;\n      }";return{inputLayouts:e.map((function(e){return t.getOrCreateTextureLayout(e)})),outputLayout:t.createTextureLayoutFromShape(a),samplers:3===e.length?["A","B","C"]:["A","B"],variables:[{name:"alpha",type:"float"},{name:"beta",type:"float"}],shaderSource:h}},e.prototype.createRunData=function(t,e,n){var r=n.map((function(n,r){return t.getOrCreateTextureData(n,e.inputLayouts[r])}));return{inputTextureDatas:r,outputTextureData:t.createTextureDataFromLayout(e.outputLayout,r[0].tensor.type),uniformData:{alpha:this.alpha,beta:this.beta}}},e}(a.Gemm);e.WebGLGemm=l},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.WebGLImageScaler=void 0;var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return t.run(this,e)},e.prototype.createProgramInfo=function(t,e){var n=e[0].dims.slice(),r=n.length,i="\n      "+this.createGetBiasMethod(this.bias.length)+"\n      float process(int indices["+r+"]) {\n        return _X(indices) * scale + getBias(bias, indices[1]);\n      }";return{inputLayouts:[t.getOrCreateTextureLayout(e[0])],outputLayout:t.createTextureLayoutFromShape(n),samplers:["X"],variables:[{name:"bias",type:"float",arrayLength:this.bias.length},{name:"scale",type:"float"}],shaderSource:i}},e.prototype.createRunData=function(t,e,n){var r=[t.getOrCreateTextureData(n[0],e.inputLayouts[0])];return{inputTextureDatas:r,outputTextureData:t.createTextureDataFromLayout(e.outputLayout,r[0].tensor.type),uniformData:{bias:this.bias,scale:this.scale}}},e.prototype.createGetBiasMethod=function(t){for(var e=["float getBias(float bias["+t+"], int channel) {"],n=0;n<t;++n)0===n?e.push("\tif (channel == "+n+") { return bias["+n+"]; }"):n===t-1?e.push("\telse { return bias["+n+"]; }"):e.push("\telse if (channel == "+n+") { return bias["+n+"]; }");return e.push("\t}"),e.join("\n")},e}(n(34).ImageScaler);e.WebGLImageScaler=o},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.WebGLInstanceNormalization=void 0;var o=n(20),a=n(2),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){var n=this;this.artifacts||(this.artifacts=[],this.createProgramInfos(t,e).forEach((function(e,r){var i=t.session.programManager.build(e);n.artifacts.push(i)})));var r=this.createRunDatas(t,this.artifacts.map((function(t){return t.programInfo})),e);return r.forEach((function(e,r){return t.session.programManager.run(n.artifacts[r],e)})),[r[1].outputTextureData.tensor]},e.prototype.checkInputTypes=function(e){return!!t.prototype.checkInputTypes.call(this,e)&&4===e[0].dims.length},e.prototype.createMeanAndVarianceProgramInfo=function(t,e){var n=e.shape,r=n[1],i=n[2]*n[3],o=[n[0],r],a=[n[0],4*r],s="\n    vec4 process(int[2] indices) {\n      vec4 v = vec4(0.0);\n      int a[4];\n      a[0] = indices[0];\n      a[1] = indices[1];\n      float temp = 0.0;\n      for(int a2=0; a2<"+n[2]+"; a2++) {\n        a[2] = a2;\n        for(int a3=0; a3<"+n[3]+"; a3++) {\n          a[3] = a3;\n          float x = _X(a);\n          temp += x;\n        }\n      }\n      float mean = temp / float("+i+");\n      temp = 0.0;\n      for(int a2=0; a2<"+n[2]+"; a2++) {\n        a[2] = a2;\n        for(int a3=0; a3<"+n[3]+"; a3++) {\n          a[3] = a3;\n          float x = _X(a);\n          temp += (x - mean) * (x - mean);\n        }\n      }\n      v.r = mean;\n      v.g = temp / float("+i+");\n\n      return v;\n    }";return{inputLayouts:[e],outputLayout:t.createTextureLayoutFromShape(o,4,a),samplers:["X"],shaderSource:s}},e.prototype.createComputOutputProgramInfo=function(t,e,n,r,i){var o=a.getGlsl(t.session.backend.glContext.version),s="\n    vec4 getMeanAndVariance(int[2] mv) {\n      int offset = indicesToOffset_MeanAndVariance(mv);\n      vec2 coords = offsetToCoords(offset, "+i.width+", "+i.height+");\n      return "+o.texture2D+"(MeanAndVariance, coords);\n    }\n\n    float process(int[4] indices) {\n\n          int mv[2];\n          mv[0] = indices[0];\n          mv[1] = indices[1];\n          vec4 mean_and_variance = getMeanAndVariance(mv);\n          float mean = mean_and_variance.r;\n          float variance = mean_and_variance.g;\n\n          int sb[1];\n          sb[0] = indices[1];\n          float scale = _Scale(sb);\n          float b = _B(sb);\n\n          return scale * (_X(indices) - mean) / sqrt(variance + epsilon) + b;\n        }";return{inputLayouts:[e,i,n,r],outputLayout:t.createTextureLayoutFromShape(e.shape),samplers:["X","MeanAndVariance","Scale","B"],variables:[{name:"epsilon",type:"float"}],shaderSource:s}},e.prototype.createProgramInfos=function(t,e){var n=t.getOrCreateTextureLayout(e[0]),r=t.getOrCreateTextureLayout(e[1]),i=t.getOrCreateTextureLayout(e[2]),o=this.createMeanAndVarianceProgramInfo(t,n);return[o,this.createComputOutputProgramInfo(t,n,r,i,o.outputLayout)]},e.prototype.createRunDatas=function(t,e,n){var r=n[0].type,i=t.getOrCreateTextureData(n[0],e[0].inputLayouts[0]),o=t.getOrCreateTextureData(n[1],e[1].inputLayouts[2]),a=t.getOrCreateTextureData(n[2],e[1].inputLayouts[3]),s=[];return s.push({inputTextureDatas:[i],outputTextureData:t.createTextureDataFromLayout(e[0].outputLayout,r),uniformData:{}}),s.push({inputTextureDatas:[i,s[0].outputTextureData,o,a],outputTextureData:t.createTextureDataFromLayout(e[1].outputLayout,r),uniformData:{epsilon:this.epsilon}}),s},e}(o.InstanceNormalization);e.WebGLInstanceNormalization=s},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.WebGLLeakyRelu=void 0;var o=n(138),a=n(2),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return t.run(this,e)},e.prototype.createProgramInfo=function(t,e){var n=e[0].dims.slice(),r=a.getGlsl(t.session.backend.glContext.version),i="\n      void main() {\n        float v = "+r.texture2D+"(A, TexCoords).r;\n        "+r.output+" = vec4(v < 0.0 ? v * float("+this.alpha+") : v);\n      }\n      ";return{hasMain:!0,inputLayouts:[t.getOrCreateTextureLayout(e[0])],outputLayout:t.createTextureLayoutFromShape(n),samplers:["A"],shaderSource:i}},e.prototype.createRunData=function(t,e,n){var r=[t.getOrCreateTextureData(n[0],e.inputLayouts[0])];return{inputTextureDatas:r,outputTextureData:t.createTextureDataFromLayout(e.outputLayout,r[0].tensor.type),uniformData:{}}},e}(o.LeakyRelu);e.WebGLLeakyRelu=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LeakyRelu=void 0;var r=function(){function t(){}return t.prototype.initialize=function(t){this.alpha=t.getFloat("alpha",.01)},t.prototype.checkInputs=function(t){return!(!t||1!==t.length)&&this.checkInputTypes(t)},t.prototype.checkInputTypes=function(t){return"float32"===t[0].type||"float64"===t[0].type},t}();e.LeakyRelu=r},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.WebGLMatMul=void 0;var o=n(18),a=n(0),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return t.run(this,e)},e.prototype.createProgramInfo=function(t,e){var n=e[0].dims,r=e[1].dims,i=a.BroadcastUtil.calcShape(n,r,!0);if(!i)throw new Error("Can't use matmul on the given tensors");var o=i.length,s=n.length,l=r.length,c="\n      float process(int indices["+o+"]) {\n          int a["+s+"];\n          int b["+l+"];\n          bcastMatmulIndices_A(indices, a);\n          bcastMatmulIndices_B(indices, b);\n\n          float value;\n          for (int k=0; k<"+n[n.length-1]+"; ++k) {\n              a["+(s-1)+"] = k;\n              b["+(l-2)+"] = k;\n              value += _A(a) * _B(b);\n          }\n          return value;\n      }";return{inputLayouts:e.map((function(e){return t.getOrCreateTextureLayout(e)})),outputLayout:t.createTextureLayoutFromShape(i),samplers:["A","B"],shaderSource:c}},e.prototype.createRunData=function(t,e,n){var r=n.map((function(n,r){return t.getOrCreateTextureData(n,e.inputLayouts[r])}));return{inputTextureDatas:r,outputTextureData:t.createTextureDataFromLayout(e.outputLayout,r[0].tensor.type),uniformData:{}}},e}(o.MatMul);e.WebGLMatMul=s},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.getPadFunction=e.WebGLPad=void 0;var o=n(35),a=n(0),s=n(2),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return t.run(this,e)},e.prototype.createProgramInfo=function(t,e){var n=a.ShapeUtil.padShape(e[0].dims.slice(),this.pads),r=n.length,i=t.getOrCreateTextureLayout(e[0]),o="\n      "+c(s.getGlsl(t.session.backend.glContext.version),"A",i,this.mode,this.pads,this.value)+"\n      float process(int["+r+"] indices) {\n          return padA(indices);\n      }";return{inputLayouts:[i],outputLayout:t.createTextureLayoutFromShape(n),samplers:["A"],shaderSource:o}},e.prototype.createRunData=function(t,e,n){var r=[t.getOrCreateTextureData(n[0],e.inputLayouts[0])];return{inputTextureDatas:r,outputTextureData:t.createTextureDataFromLayout(e.outputLayout,r[0].tensor.type),uniformData:{}}},e}(o.Pad);function c(t,e,n,r,i,o){switch(r){case"constant":return function(t,e,n,r,i,o,a,s){for(var l=n.length,c="",u=l-1;u>=0;--u)c+="\n          k = m["+u+"] - "+a[u]+";\n          if (k < 0)  return constant;\n          if (k >= "+n[u]+") return constant;\n          offset += k * "+r[u]+";\n          ";return"\n        float pad"+e+"(int m["+l+"]) {\n          const float constant = float("+s+");\n          int offset = 0;\n          int k = 0;\n          "+c+"\n          vec2 coords = offsetToCoords(offset, "+i+", "+o+");\n          float value = getColorAsFloat("+t.texture2D+"("+e+", coords));\n          return value;\n        }\n        "}(t,e,n.shape,n.strides,n.width,n.height,i,o);case"reflect":return function(t,e,n,r,i,o,a){for(var s=n.length,l="",c=s-1;c>=0;--c)l+="\n        k = m["+c+"] - "+a[c]+";\n        if (k < 0) { k = -k; }\n        {\n          const int _2n_1 = "+2*(n[c]-1)+";\n          k = int( mod( float(k), float(_2n_1) ) ) ;\n          if(k >= "+n[c]+") { k = _2n_1 - k; }\n        }\n        offset += k * "+r[c]+";\n        ";return"\n      float pad"+e+"(int m["+s+"]) {\n        int offset = 0;\n        int k = 0;\n        "+l+"\n        vec2 coords = offsetToCoords(offset, "+i+", "+o+");\n        float value = getColorAsFloat("+t.texture2D+"("+e+", coords));\n        return value;\n      }\n      "}(t,e,n.shape,n.strides,n.width,n.height,i);case"edge":return function(t,e,n,r,i,o,a){for(var s=n.length,l="",c=s-1;c>=0;--c)l+="\n      k = m["+c+"] - "+a[c]+";\n      if (k < 0)  k = 0;\n      if (k >= "+n[c]+") k = "+(n[c]-1)+";\n      offset += k * "+r[c]+";\n      ";return"\n    float pad"+e+"(int m["+s+"]) {\n      int offset = 0;\n      int k = 0;\n      "+l+"\n      vec2 coords = offsetToCoords(offset, "+i+", "+o+");\n      float value = getColorAsFloat("+t.texture2D+"("+e+", coords));\n      return value;\n    }\n    "}(t,e,n.shape,n.strides,n.width,n.height,i);default:throw new Error("Invalid mode")}}e.WebGLPad=l,e.getPadFunction=c},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.offsetToIndices=e.copyArray=e.GeneratePoolingCode=e.WebGLMaxPool=e.WebGLGlobalMaxPool=e.WebGLAveragePool=e.WebGLGlobalAveragePool=void 0;var o=n(21),a=n(0),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return t.run(this,e)},e.prototype.createProgramInfo=function(t,e){return c(t,e,!0,this.kernelShape,this.autoPad,this.strides,this.pads,this.countIncludePad)},e.prototype.createRunData=function(t,e,n){var r=[t.getOrCreateTextureData(n[0],e.inputLayouts[0])];return{inputTextureDatas:r,outputTextureData:t.createTextureDataFromLayout(e.outputLayout,r[0].tensor.type),uniformData:{}}},e}(o.GlobalAveragePool);e.WebGLGlobalAveragePool=s;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return t.run(this,e)},e.prototype.createProgramInfo=function(t,e){return c(t,e,!1,this.kernelShape,this.autoPad,this.strides,this.pads,this.countIncludePad)},e.prototype.createRunData=function(t,e,n){var r=[t.getOrCreateTextureData(n[0],e.inputLayouts[0])];return{inputTextureDatas:r,outputTextureData:t.createTextureDataFromLayout(e.outputLayout,r[0].tensor.type),uniformData:{}}},e}(o.AveragePool);function c(t,e,n,r,i,o,s,l){void 0===r&&(r=[]),void 0===i&&(i=""),void 0===o&&(o=[]),void 0===s&&(s=[]);var c=e[0].dims.slice();a.PoolConvUtil.adjustPoolAttributes(n,c,r,o,s);var u=a.PoolConvUtil.computePoolOutputShape(n,c,o,r,s,i),h=a.ShapeUtil.size(r),d="";d+=l?"value /= float("+h+");":"value /= float("+h+" - pad);";var f=t.getOrCreateTextureLayout(e[0]),m="\n      "+p(f,r,s,o,"value += _X(x);",d,"0.0")+"\n    ";return{inputLayouts:[f],outputLayout:t.createTextureLayoutFromShape(u),samplers:["X"],shaderSource:m}}e.WebGLAveragePool=l;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return t.run(this,e)},e.prototype.createProgramInfo=function(t,e){return d(t,e,!0,this.kernelShape,this.autoPad,this.strides,this.pads)},e.prototype.createRunData=function(t,e,n){var r=[t.getOrCreateTextureData(n[0])];return{inputTextureDatas:r,outputTextureData:t.createTextureDataFromLayout(e.outputLayout,r[0].tensor.type),uniformData:{}}},e}(o.GlobalMaxPool);e.WebGLGlobalMaxPool=u;var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return t.run(this,e)},e.prototype.createProgramInfo=function(t,e){return d(t,e,!1,this.kernelShape,this.autoPad,this.strides,this.pads)},e.prototype.createRunData=function(t,e,n){var r=[t.getOrCreateTextureData(n[0])];return{inputTextureDatas:r,outputTextureData:t.createTextureDataFromLayout(e.outputLayout,r[0].tensor.type),uniformData:{}}},e}(o.MaxPool);function d(t,e,n,r,i,o,s){void 0===r&&(r=[]),void 0===i&&(i=""),void 0===o&&(o=[]),void 0===s&&(s=[]);var l=e[0].dims.slice();a.PoolConvUtil.adjustPoolAttributes(n,l,r,o,s);var c=a.PoolConvUtil.computePoolOutputShape(n,l,o,r,s,i),u=t.createTextureLayoutFromShape(l),h="\n    "+p(u,r,s,o,"\n              value = max(_X(x), value);\n      ","","-1e5")+"\n  ";return{inputLayouts:[u],outputLayout:t.createTextureLayoutFromShape(c),samplers:["X"],shaderSource:h}}function p(t,e,n,r,i,o,s){var l=t.shape,c=t.shape.length;if(e.length<=2){var u,h=e[e.length-1],d=r[r.length-1],p=n[n.length/2-1],g=n[n.length-1],y=l[c-1],v="",b="";if(u=p+g!==0?"\n                for (int i = 0; i < "+h+"; i++) {\n                  x["+c+" - 1] = indices["+c+" - 1] * "+d+" - "+p+" + i;\n                  if (x["+c+" - 1] < 0 || x["+c+" - 1] >= "+y+") {\n                    pad++;\n                    continue;\n                  }\n                  "+i+"\n                }":"\n                for (int i = 0; i < "+h+"; i++) {\n                  x["+c+" - 1] = indices["+c+" - 1] * "+d+" - "+p+" + i;\n                  "+i+"\n                }",2===e.length){var x=e[e.length-2],_=r[r.length-2],w=n[n.length/2-2],S=n[n.length-2],T=l[c-2];v=w+S!==0?"\n              for (int j = 0; j < "+x+"; j++) {\n                x["+c+" - 2] = indices["+c+" - 2] * "+_+" - "+w+" + j;\n                if (x["+c+" - 2] < 0 || x["+c+" - 2] >= "+T+") {\n                  pad+= "+h+";\n                  continue;\n                }\n            ":"\n                for (int j = 0; j < "+x+"; j++) {\n                  x["+c+" - 2] = indices["+c+" - 2] * "+_+" - "+w+" + j;\n                ",b="\n              }\n            "}return"\n            float process(int indices["+c+"]) {\n              int x["+c+"];\n              copyVec(indices, x);\n\n              float value = "+s+";\n              int pad = 0;\n              "+v+"\n              "+u+"\n              "+b+"\n              "+o+"\n              return value;\n            }\n          "}var E=a.ShapeUtil.size(e),M=a.ShapeUtil.computeStrides(e),C=M.length,A=n.length,k=m(C),I=f(l,"inputDims"),R=f(n,"pads"),P=f(M,"kernelStrides");return"\n            "+k+"\n            float process(int indices["+c+"]) {\n                int x["+c+"];\n                copyVec(indices, x);\n                int offset["+C+"];\n                int pads["+A+"];\n                int inputDims["+c+"];\n                int kernelStrides["+C+"];\n                int strides["+C+"];\n                "+R+"\n                "+I+"\n                "+f(r,"strides")+"\n                "+P+"\n\n                float value = "+s+";\n                int pad = 0;\n                bool isPad = false;\n                for (int i = 0; i < "+E+"; i++) {\n                    offsetToIndices(i, kernelStrides, offset);\n                    isPad = false;\n                    for (int j = "+c+" - "+C+"; j < "+c+"; j++) {\n                      x[j] = indices[j] * strides[j - "+c+" + "+C+"]\n                        + offset[j - "+c+" + "+C+"] - pads[j - 2];\n                      "+(n.reduce((function(t,e){return t+e}))?"\n                if (x[j] >= inputDims[j] || x[j] < 0) {\n                  pad++;\n                  isPad = true;\n                  break;\n                }\n              }\n              if (!isPad) {\n                "+i+"\n              }":"\n                  }\n                  "+i)+"\n                }\n                "+o+"\n\n                return value;\n            }"}function f(t,e){for(var n="",r=0;r<t.length;r++)n+="\n      "+e+"["+r+"] = "+t[r]+";\n    ";return n}function m(t){return"\n    void offsetToIndices(int offset, int["+t+"] strides, out int["+t+"] indices) {\n      if ("+t+" == 0) {\n        return;\n      }\n      for (int i = 0; i < "+t+" - 1; ++i) {\n        indices[i] = offset / strides[i];\n        offset -= indices[i] * strides[i];\n      }\n      indices["+t+" - 1] = offset;\n    }"}e.WebGLMaxPool=h,e.GeneratePoolingCode=p,e.copyArray=f,e.offsetToIndices=m},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.WebGLReduceSumSquare=e.WebGLReduceLogSum=e.WebGLReduceProd=e.WebGLReduceMin=e.WebGLReduceMax=e.WebGLReduceMean=e.WebGLReduceSum=void 0;var o=n(36),a=n(0),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return t.run(this,e)},e.prototype.createProgramInfo=function(t,e){for(var n=[],r=e[0].dims.length||1,i=[],o=a.ShapeUtil.normalizeAxes(this.axes,e[0].dims.length),s=this.getOps(e,o),l=s[1],c=0;c<e[0].dims.length;c++)o.indexOf(c)>=0||0===o.length?(this.keepDims&&n.push(1),l="\n        for(int j"+c+" = 0; j"+c+" < "+e[0].dims[c]+"; j"+c+"++) {\n          inputIdx["+c+"] = j"+c+";\n          "+l+"\n        }\n        "):(i.push("inputIdx["+c+"] = outputIdx["+n.length+"];"),n.push(e[0].dims[c]));var u="\n      float process(int outputIdx["+(n.length||1)+"]) {\n        float value;                 // final result\n        int inputIdx["+r+"];      // addressing input data\n        "+i.join("\n")+"\n        "+s[0]+"       // init ops for reduce max/min\n        "+l+"\n        "+s[2]+"       // final computation for reduce mean\n        return value;\n      }";return{inputLayouts:e.map((function(e){return t.getOrCreateTextureLayout(e)})),outputLayout:t.createTextureLayoutFromShape(n),samplers:["A"],shaderSource:u}},e.prototype.createRunData=function(t,e,n){var r=n.map((function(n,r){return t.getOrCreateTextureData(n,e.inputLayouts[r])}));return{inputTextureDatas:r,outputTextureData:t.createTextureDataFromLayout(e.outputLayout,r[0].tensor.type),uniformData:{}}},e}(o.ReduceBase),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.getOps=function(t){return["value = 0.0;","value += _A(inputIdx);",""]},e}(s);e.WebGLReduceSum=l;var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.getOps=function(t,e){for(var n=1,r=0;r<t[0].dims.length;r++)(e.indexOf(r)>=0||0===e.length)&&(n*=t[0].dims[r]);return["value = 0.0;","value += _A(inputIdx);","value /= "+n+".;"]},e}(s);e.WebGLReduceMean=c;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.getOps=function(t,e){for(var n=[],r=0;r<t[0].dims.length;r++)(e.indexOf(r)>=0||0===e.length)&&n.push("inputIdx["+r+"] = 0;");return[n.join("\n")+"\nvalue = _A(inputIdx);","value = max(value, _A(inputIdx));",""]},e}(s);e.WebGLReduceMax=u;var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.getOps=function(t,e){for(var n=[],r=0;r<t[0].dims.length;r++)(e.indexOf(r)>=0||0===e.length)&&n.push("inputIdx["+r+"] = 0;");return[n.join("\n")+"\nvalue = _A(inputIdx);","value = min(value, _A(inputIdx));",""]},e}(s);e.WebGLReduceMin=h;var d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.getOps=function(t){return["value = 1.0;","value *= _A(inputIdx);",""]},e}(s);e.WebGLReduceProd=d;var p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.getOps=function(t){return["value = 0.0;","value += _A(inputIdx);","value = log(value);"]},e}(s);e.WebGLReduceLogSum=p;var f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.getOps=function(t){return["float t; value = 0.0;","t = _A(inputIdx); value += t * t;",""]},e}(s);e.WebGLReduceSumSquare=f},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.WebGLSliceV10=e.WebGLSlice=void 0;var o=n(38),a=n(0),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return t.run(this,e)},e.prototype.createProgramInfo=function(t,e){return c(t,e[0],this.starts,this.ends,this.axes)},e.prototype.createRunData=function(t,e,n){return u(t,e,n)},e}(o.Slice);e.WebGLSlice=s;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return t.run(this,e)},e.prototype.createProgramInfo=function(t,e){if(!t.session.isInitializer(e[1].dataId)||!t.session.isInitializer(e[2].dataId)||e.length>=4&&!t.session.isInitializer(e[3].dataId)||e.length>=5&&!t.session.isInitializer(e[4].dataId))throw new Error("dynamic slice attributes are not allowed");if(e.length>=5&&e[4].integerData.some((function(t){return 1!==t})))throw new Error("currently non-1 steps is not supported for Slice");var n=Array.from(e[1].integerData),r=Array.from(e[2].integerData),i=e.length>=4?Array.from(e[3].integerData):[];return c(t,e[0],n,r,i)},e.prototype.createRunData=function(t,e,n){return u(t,e,n)},e}(o.SliceV10);function c(t,e,n,r,i){0===i.length&&(i=e.dims.slice(0).map((function(t,e){return e}))),i=a.ShapeUtil.normalizeAxes(i,e.dims.length),n=n.map((function(t,n){return t>e.dims[i[n]]-1?e.dims[i[n]]:a.ShapeUtil.normalizeAxis(t,e.dims[i[n]])})),r=r.map((function(t,n){return t>e.dims[i[n]]-1?e.dims[i[n]]:a.ShapeUtil.normalizeAxis(t,e.dims[i[n]])}));for(var o=e.dims.slice(),s=[],l=0;l<i.length;l++)o[i[l]]=r[l]-n[l],n[l]>0&&s.push("outputIdx["+i[l]+"] += "+n[l]+";");var c="\n      float process(int outputIdx["+o.length+"]) {\n        "+s.join("\n      ")+"\n        return _A(outputIdx);\n      }";return{inputLayouts:[t.getOrCreateTextureLayout(e)],outputLayout:t.createTextureLayoutFromShape(o),samplers:["A"],shaderSource:c}}function u(t,e,n){var r=[t.getOrCreateTextureData(n[0],e.inputLayouts[0])];return{inputTextureDatas:r,outputTextureData:t.createTextureDataFromLayout(e.outputLayout,r[0].tensor.type),uniformData:{}}}e.WebGLSliceV10=l},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},a=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(o(arguments[e]));return t};Object.defineProperty(e,"__esModule",{value:!0}),e.WebGLSoftmax=void 0;var s=n(22),l=n(0),c=n(2),u=function(t){function e(){return t.call(this)||this}return i(e,t),e.prototype.run=function(t,e){var n=this;this.artifacts||(this.artifacts=[],this.createProgramInfos(t,e).forEach((function(e,r){var i=t.session.programManager.build(e);n.artifacts.push(i)})));var r=this.createRunDatas(t,this.artifacts.map((function(t){return t.programInfo})),e);return r.forEach((function(e,r){return t.session.programManager.run(n.artifacts[r],e)})),[r[r.length-1].outputTextureData.tensor]},e.prototype.createSoftMaxProgramInfo=function(t,e,n,r,i,o){var a=e.dims.slice(),s=t.createTextureLayoutFromShape(a),l=a,c=l.length,u=s.width,h=s.height;if(n<1||r<1)throw new Error("Logical row count N and feature count D must be greater than or equal to 1");if(1!==i.shape.length||1!==o.shape.length)throw new Error("Dimensionality of the intermediate results should be 1");if(i.shape[0]!==n||o.shape[0]!==n)throw new Error("Shape of the intermediate results should be equal to logical row count");var d="\n    float process(int["+c+"] indices) {\n\n      // get offset of current logical tensor index from the 2-D texture coordinates (TexCoords)\n      int offset = coordsToOffset(TexCoords, "+u+", "+h+");\n\n      //determine the logical row for this index\n      int logical_row_index[1];\n      logical_row_index[0] = offset / "+r+";\n\n      float norm_factor = _Norm(logical_row_index);\n\n      // avoid possible division by 0\n      // if norm_facor is 0, all elements are zero\n      // if so, return 0\n      if(norm_factor == 0.0)\n        return 0.0;\n\n      return exp(_A(indices) - _Max(logical_row_index)) / norm_factor;\n    }";return{inputLayouts:[s,i,o],outputLayout:t.createTextureLayoutFromShape(l),samplers:["A","Max","Norm"],shaderSource:d}},e.prototype.createComputScaleProgramInfo=function(t,e,n,r,i,o){var a=t.createTextureLayoutFromShape(e.dims.slice()),s=o.length,l=a.width,u=a.height;if(n<1||r<1)throw new Error("Logical row count N and feature count D must be greater than or equal to 1");if(1!==o.length)throw new Error("Dimensionality of the output should be 1");if(o[0]!==n)throw new Error("Shape of the output should be equal to logical row count");if(1!==i.shape.length)throw new Error("Dimensionality of the intermediate results should be 1");if(i.shape[0]!==n)throw new Error("Shape of the intermediate results should be equal to logical row count");var h="\n    float process(int["+s+"] indices) {\n\n      int logical_row_start_offset = indices[0] * "+r+";\n\n      float norm_factor = 0.0;\n      float max = _Max(indices);\n      for(int i=0; i<"+r+"; ++i)\n      {\n        norm_factor += exp(getColorAsFloat("+c.getGlsl(t.session.backend.glContext.version).texture2D+"(A, offsetToCoords(logical_row_start_offset + i, "+l+", "+u+"))) - max);\n      }\n\n      return norm_factor;\n    }";return{inputLayouts:[a,i],outputLayout:t.createTextureLayoutFromShape(o),samplers:["A","Max"],shaderSource:h}},e.prototype.createComputeMaxProgramInfo=function(t,e,n,r,i){var o=t.createTextureLayoutFromShape(e.dims.slice()),a=i.length,s=o.width,l=o.height;if(n<1||r<1)throw new Error("Logical row count N and feature count D must be greater than or equal to 1");if(1!==i.length)throw new Error("Dimensionality of the output should be 1");if(i[0]!==n)throw new Error("Shape of the output should be equal to logical row count");var u=c.getGlsl(t.session.backend.glContext.version),h="\n        float process(int["+a+"] indices) {\n\n          int logical_row_start_offset = indices[0] * "+r+";\n\n          float max = getColorAsFloat("+u.texture2D+"(A, offsetToCoords(logical_row_start_offset, "+s+", "+l+" )));\n          for(int i=1; i<"+r+"; ++i)\n          {\n            float current = getColorAsFloat("+u.texture2D+"(A, offsetToCoords(logical_row_start_offset + i, "+s+", "+l+")));\n            if(current > max)\n              max = current;\n          }\n\n          return max;\n        }";return{inputLayouts:[o],outputLayout:t.createTextureLayoutFromShape(i),samplers:["A"],shaderSource:h}},e.prototype.createProgramInfos=function(t,e){var n=e[0].dims.slice(),r=l.ShapeUtil.normalizeAxis(this.axis,n.length),i=l.ShapeUtil.sizeToDimension(n,r),o=l.ShapeUtil.sizeFromDimension(n,r),a=this.createComputeMaxProgramInfo(t,e[0],i,o,[i]),s=this.createComputScaleProgramInfo(t,e[0],i,o,a.outputLayout,[i]);return[a,s,this.createSoftMaxProgramInfo(t,e[0],i,o,a.outputLayout,s.outputLayout)]},e.prototype.createRunDatas=function(t,e,n){var r=n[0].type,i=t.getOrCreateTextureData(n[0],e[0].inputLayouts[0]),o=[];o.push({inputTextureDatas:[i],outputTextureData:t.createTextureDataFromLayout(e[0].outputLayout,r),uniformData:{}});for(var s=1;s<e.length;++s)o.push({inputTextureDatas:a(o[s-1].inputTextureDatas,[o[s-1].outputTextureData]),outputTextureData:t.createTextureDataFromLayout(e[s].outputLayout,r),uniformData:{}});return o},e}(s.Softmax);e.WebGLSoftmax=u},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a};Object.defineProperty(e,"__esModule",{value:!0}),e.WebGLSplit=void 0;var a=n(146),s=n(0),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){var n=this;if(!this.artifacts){this.artifacts=[];for(var r=s.ShapeUtil.normalizeAxis(this.axis,e[0].dims.length),i=this.getProgramCount(t,e,r),o=0;o<i;++o){var a=this.createProgramInfo(t,e[0],r,o),l=t.session.programManager.build(a);this.artifacts.push(l)}}var c=[];return this.artifacts.forEach((function(r){var i=n.createRunData(t,r.programInfo,e);t.session.programManager.run(r,i),c.push(i.outputTextureData.tensor)})),c},e.prototype.getProgramCount=function(t,e,n){return o(s.SplitUtil.splitShape(e[0].dims,n,this.split,this.numOutputs),2)[1].length},e.prototype.createProgramInfo=function(t,e,n,r){var i=o(s.SplitUtil.splitShape(e.dims,n,this.split,this.numOutputs),2),a=i[0],l=i[1][r],c=a[r],u="\n      float process(int indices["+c.length+"]) {\n        indices["+n+"] += "+l+";\n        return _A(indices);\n      }";return{inputLayouts:[t.getOrCreateTextureLayout(e)],outputLayout:t.createTextureLayoutFromShape(c),samplers:["A"],shaderSource:u}},e.prototype.createRunData=function(t,e,n){var r=[t.getOrCreateTextureData(n[0],e.inputLayouts[0])];return{inputTextureDatas:r,outputTextureData:t.createTextureDataFromLayout(e.outputLayout,r[0].tensor.type),uniformData:{}}},e}(a.Split);e.WebGLSplit=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Split=void 0;var r=function(){function t(t){this.numOutputs=t}return t.prototype.initialize=function(t){this.axis=t.getInt("axis",0),this.split=t.getInts("split",[])},t.prototype.checkInputs=function(t){return!(!t||1!==t.length)&&this.checkInputTypes(t)},t.prototype.checkInputTypes=function(t){return"int8"===t[0].type||"uint8"===t[0].type||"int16"===t[0].type||"uint16"===t[0].type||"int32"===t[0].type||"uint32"===t[0].type||"float32"===t[0].type||"float64"===t[0].type||"bool"===t[0].type},t}();e.Split=r},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.WebGLSqueeze=void 0;var o=n(39),a=n(0),s=n(10),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){var n=a.ShapeUtil.squeezeShape(e[0].dims,this.axes);return[s.reshape(t,e[0],n)]},e}(o.Squeeze);e.WebGLSqueeze=l},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.WebGLSum=void 0;var o=n(23),a=n(2),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return t.run(this,e)},e.prototype.createProgramInfo=function(t,e){var n=a.getGlsl(t.session.backend.glContext.version),r=e[0].dims.slice(),i=e.map((function(t,e){return n.texture2D+"(X"+e+",TexCoords)"})).join(" + "),o=e.map((function(t,e){return"X"+e}));return{inputLayouts:e.map((function(e){return t.getOrCreateTextureLayout(e)})),outputLayout:t.createTextureLayoutFromShape(r),samplers:o,shaderSource:"\n      void main() {\n        vec4 result = "+i+";\n        "+n.output+" = result;\n      }",hasMain:!0}},e.prototype.createRunData=function(t,e,n){var r=n.map((function(n,r){return t.getOrCreateTextureData(n,e.inputLayouts[r])}));return{inputTextureDatas:r,outputTextureData:t.createTextureDataFromLayout(e.outputLayout,r[0].tensor.type),uniformData:{}}},e}(o.Sum);e.WebGLSum=s},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.WebGLTile=void 0;var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return t.run(this,e)},e.prototype.createProgramInfo=function(t,e){for(var n=e[0].dims.slice(),r=new Array(n.length),i=[],o=0;o<n.length;o++)r[o]=n[o]*e[1].numberData[o],i.push("inputIdx["+o+"] = int(mod(float(outputIdx["+o+"]), "+n[o]+".));");var a=r.length,s="\n    float process(int outputIdx["+a+"]) {\n      int inputIdx["+a+"];\n      "+i.join("\n")+"\n      return _A(inputIdx);\n    }";return{inputLayouts:e.map((function(e){return t.getOrCreateTextureLayout(e)})),outputLayout:t.createTextureLayoutFromShape(r),samplers:["A"],shaderSource:s}},e.prototype.createRunData=function(t,e,n){var r=n.map((function(n,r){return t.getOrCreateTextureData(n,e.inputLayouts[r])}));return{inputTextureDatas:r,outputTextureData:t.createTextureDataFromLayout(e.outputLayout,r[0].tensor.type),uniformData:{}}},e}(n(40).Tile);e.WebGLTile=o},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},a=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(o(arguments[e]));return t};Object.defineProperty(e,"__esModule",{value:!0}),e.WebGLTranspose=void 0;var s=n(41),l=n(0),c=n(5),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return t.run(this,e)},e.prototype.getOutputShape=function(t){var e=this.getAdjustedPerm(t[0]);return l.ShapeUtil.sortBasedOnPerm(t[0],e)},e.prototype.createProgramInfo=function(t,e){var n=e.map((function(t){return t.dims.slice()})),r=this.getAdjustedPerm(n[0]),i=this.getOutputShape(n),o=e[0].dims.length,a="\n      "+this.getPermFunctionBody("perm",r,o)+"\n      float process(int indices["+o+"]) {\n        int a["+o+"];\n        perm(a, indices);\n        return _A(a);\n      }",s=t.createTextureLayoutFromShape(i,1,i);return{inputLayouts:[t.getOrCreateTextureLayout(e[0])],outputLayout:s,samplers:["A"],shaderSource:a}},e.prototype.createRunData=function(t,e,n){var r=[t.getOrCreateTextureData(n[0],e.inputLayouts[0])];return{inputTextureDatas:r,outputTextureData:t.createTextureDataFromLayout(e.outputLayout,r[0].tensor.type),uniformData:{}}},e.prototype.getPositionalFunction=function(t,e,n){var r=this.getOutputShape([e]);return n||(n="perm"),{name:n,body:this.getPermFunctionBody(n,this.getAdjustedPerm(e),r.length),type:c.FunctionType.Positional,inputShape:e,outputShape:r}},e.prototype.getAdjustedPerm=function(t){var e=this.perm;return e&&e.length!==t.length&&(e=a(t.keys()).reverse()),e},e.prototype.getPermFunctionBody=function(t,e,n){var r=[];r.push("void "+t+"(out int a["+n+"], int src["+n+"]) {");for(var i=0;i<n;++i)r.push("\ta["+e[i]+"]=src["+i+"];");return r.push("\t}"),r.join("\n")},e}(s.Transpose);e.WebGLTranspose=u},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.glslTanh=e.glslTan=e.glslSqrt=e.glslSigmoid=e.glslRelu=e.glslSin=e.glslNot=e.glslNeg=e.glslLog=e.glslIdentity=e.glslFloor=e.glslExp=e.glslCos=e.glslCeil=e.glslAtan=e.glslAsin=e.glslAcos=e.glslAbs=e.WebGLUnaryOp=void 0;var o=n(43),a=n(5),s=n(2),l=function(t){function e(e,n){var r=t.call(this,e)||this;return r.typeConstraint=e,r.glslFunc=n,r}return i(e,t),e.prototype.run=function(t,e){return t.run(this,e)},e.prototype.createProgramInfo=function(t,e){var n=e[0].dims.slice(),r=t.getOrCreateTextureLayout(e[0]),i=s.getGlsl(t.session.backend.glContext.version),o="\n      "+this.glslFunc.body+"\n      void main() {\n        vec4 v = "+i.texture2D+"(A, TexCoords);\n        v = "+this.glslFunc.name+"(v);\n        "+i.output+" = v;\n      }\n      ";return{inputLayouts:[r],outputLayout:t.createTextureLayoutFromShape(n),samplers:["A"],shaderSource:o,hasMain:!0}},e.prototype.createRunData=function(t,e,n){var r=[t.getOrCreateTextureData(n[0],e.inputLayouts[0])];return{inputTextureDatas:r,outputTextureData:t.createTextureDataFromLayout(e.outputLayout,r[0].tensor.type),uniformData:{}}},e}(o.UnaryOp);function c(t){var e=t+"_";return{body:"\n  float "+e+"(float a) {\n    return "+t+"(a);\n  }\n  vec4 "+e+"(vec4 v) {\n    return "+t+"(v);\n  }\n  ",name:e,type:a.FunctionType.ValueBased}}e.WebGLUnaryOp=l,e.glslAbs=function(){return c("abs")},e.glslAcos=function(){return c("acos")},e.glslAsin=function(){return c("asin")},e.glslAtan=function(){return c("atan")},e.glslCeil=function(){return c("ceil")},e.glslCos=function(){return c("cos")},e.glslExp=function(){return c("exp")},e.glslFloor=function(){return c("floor")},e.glslIdentity=function(){return{body:"\n  float indentity_(float a) {\n    return a;\n  }\n  vec4 indentity_(vec4 v) {\n    return v;\n  }\n  ",name:"indentity_",type:a.FunctionType.ValueBased}},e.glslLog=function(){return c("log")},e.glslNeg=function(){return{body:"\n  float neg_(float a) {\n    return -a;\n  }\n  vec4 neg_(vec4 v) {\n    return -v;\n  }\n  ",name:"neg_",type:a.FunctionType.ValueBased}},e.glslNot=function(){return{body:"\n  float not_(float a) {\n    return float( ! bool(a) );\n  }\n  bool not_(bool a) {\n    return !a;\n  }\n  vec4 not_(vec4 v) {\n    return vec4(!bool(v.x), !bool(v.y), !bool(v.z), !bool(v.w));\n  }\n  bvec4 not_(bvec4 v) {\n    return bvec4(!v.x, !v.y, !v.z, !v.w);\n  }\n  ",name:"not_",type:a.FunctionType.ValueBased}},e.glslSin=function(){return c("sin")},e.glslRelu=function(){return{body:"\n  float relu_(float a) {\n    return max( a, 0.0 );\n  }\n  vec4 relu_(vec4 v) {\n    return max( v, 0.0 );\n  }\n  ",name:"relu_",type:a.FunctionType.ValueBased}},e.glslSigmoid=function(){return{body:"\n  float sigmoid_(float a) {\n    return 1.0 / (1.0 + exp(-a));\n  }\n  vec4 sigmoid_(vec4 v) {\n    return 1.0 / (1.0 + exp(-v));\n  }\n  ",name:"sigmoid_",type:a.FunctionType.ValueBased}},e.glslSqrt=function(){return c("sqrt")},e.glslTan=function(){return c("tan")},e.glslTanh=function(){return{body:"\n  float tanh_(float a) {\n    a = clamp(a, -10., 10.);\n    a = exp(2.*a);\n    return (a - 1.) / (a + 1.);\n  }\n  vec4 tanh_(vec4 v) {\n    v = clamp(v, -10., 10.);\n    v = exp(2.*v);\n    return (v - 1.) / (v + 1.);\n  }\n  ",name:"tanh_",type:a.FunctionType.ValueBased}}},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.WebGLUnsqueeze=void 0;var o=n(44),a=n(0),s=n(10),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){var n=a.ShapeUtil.unsqueezeShape(e[0].dims,this.axes);return[s.reshape(t,e[0],n)]},e}(o.Unsqueeze);e.WebGLUnsqueeze=l},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.WebGLUpsample=void 0;var o=n(45),a=n(2),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.run=function(t,e){return t.run(this,e)},e.prototype.createProgramInfo=function(t,e){for(var n=this,r=t.getOrCreateTextureLayout(e[0]),i=e[0].dims.map((function(t,e){return Math.floor(t*n.scales[e])})),o=t.createTextureLayoutFromShape(i),s=i.length,l=a.getGlsl(t.session.backend.glContext.version),c=new Array(s),u=new Array(s),h="\n      int output_pitches["+s+"];\n      int input_pitches["+s+"];\n      ",d=s-1;d>=0;d--)c[d]=d===s-1?1:c[d+1]*i[d+1],u[d]=d===s-1?1:u[d+1]*e[0].dims[d+1],h+="\n      output_pitches["+d+"] = "+c[d]+";\n      input_pitches["+d+"] = "+u[d]+";\n      ";var p="\n    float getInputFloat(int index) {\n      vec2 coords = offsetToCoords(index, "+r.width+", "+r.height+");\n      float value = getColorAsFloat("+l.texture2D+"(X, coords));\n      return value;\n    }\n    ";return{inputLayouts:[r],outputLayout:o,samplers:["X"],shaderSource:"nearest"===this.mode?"\n      "+p+"\n      float process(int indices["+s+"]) {\n        int input_index = 0;\n        int output_index = coordsToOffset(TexCoords, "+o.width+", "+o.height+");\n\n        "+h+"\n\n        int d, m;\n        for (int dim = 0; dim < "+s+"; ++dim) {\n          d = output_index / output_pitches[dim];\n          m = output_index - d * output_pitches[dim];\n          output_index = m;\n\n          if (scales[dim] != 1 && d > 0) {\n            int d2 = d / scales[dim];\n            m = d - d2 * scales[dim];\n            d = d2;\n          }\n          input_index += input_pitches[dim] * d;\n        }\n\n        return getInputFloat(input_index);\n      }":4===s?"\n      "+p+"\n      float process(int indices[4]) {\n        int input_index = 0;\n        int output_index = coordsToOffset(TexCoords, "+o.width+", "+o.height+");\n\n        "+h+"\n\n        int m;\n        int index_of_dim0, index_of_dim1, index_of_dim2, index_of_dim3;\n        index_of_dim0 = output_index / output_pitches[0];\n        m = output_index - index_of_dim0 * output_pitches[0];\n        index_of_dim1 = m / output_pitches[1];\n        m = m - index_of_dim1 * output_pitches[1];\n        index_of_dim2 = m / output_pitches[2];\n        m = m - index_of_dim2 * output_pitches[2];\n        index_of_dim3 = m;\n\n        int index_of_input_dim2, index_of_input_dim3, x_offset, y_offset;\n        index_of_input_dim2 = index_of_dim2 / scales[2];\n        y_offset = index_of_dim2 - index_of_input_dim2 * scales[2];\n        index_of_input_dim3 = index_of_dim3 / scales[3];\n        x_offset = index_of_dim3 - index_of_input_dim3 * scales[3];\n\n        input_index = index_of_dim0 * input_pitches[0] +\n                      index_of_dim1 * input_pitches[1] +\n                      index_of_input_dim2 * input_pitches[2] +\n                      index_of_input_dim3;\n\n        float x00 = getInputFloat(input_index);\n        float x10, x01, x11;\n\n        bool end_of_dim2 = false;\n        if (index_of_input_dim2 == ("+e[0].dims[2]+" - 1)) {\n          // It's the end in dimension 2\n          x01 = x00;\n          end_of_dim2 = true;\n        } else {\n          x01 = getInputFloat(input_index + input_pitches[2]);\n        }\n\n        if (index_of_input_dim3 == (input_pitches[2] - 1)) {\n          // It's the end in dimension 3\n          x10 = x00;\n          x11 = x01;\n        }\n        else {\n          x10 = getInputFloat(input_index + 1);\n          x11 = end_of_dim2 ? x10 : getInputFloat(input_index + input_pitches[2] + 1);\n        }\n\n        float y0 = x00 + float(y_offset) * (x01 - x00) / float(scales[2]);\n        float y1 = x10 + float(y_offset) * (x11 - x10) / float(scales[2]);\n        return y0 + float(x_offset) * (y1 - y0) / float(scales[3]);\n      }":"\n      "+p+"\n      float process(int indices[2]) {\n        int input_index = 0;\n        int output_index = coordsToOffset(TexCoords, "+o.width+", "+o.height+");\n\n        "+h+"\n\n        int m;\n        int index_of_dim0, index_of_dim1;\n        index_of_dim0 = output_index / output_pitches[0];\n        m = output_index - index_of_dim0 * output_pitches[0];\n        index_of_dim1 = m;\n\n        int index_of_input_dim0, index_of_input_dim1, x_offset, y_offset;\n        index_of_input_dim0 = index_of_dim0 / scales[0];\n        y_offset = index_of_dim0 - index_of_input_dim0 * scales[0];\n        index_of_input_dim1 = index_of_dim1 / scales[1];\n        x_offset = index_of_dim1 - index_of_input_dim1 * scales[1];\n\n        input_index = index_of_input_dim0 * input_pitches[0] + index_of_input_dim1;\n\n        float x00 = getInputFloat(input_index);\n        float x10, x01, x11;\n\n        bool end_of_dim0 = false;\n        if (index_of_input_dim0 == ("+e[0].dims[0]+" - 1)) {\n          // It's the end in dimension 0\n          x01 = x00;\n          end_of_dim0 = true;\n        } else {\n          x01 = getInputFloat(input_index + input_pitches[0]);\n        }\n\n        if (index_of_input_dim1 == (input_pitches[0] - 1)) {\n          // It's the end in dimension 1\n          x10 = x00;\n          x11 = x01;\n        }\n        else {\n          x10 = getInputFloat(input_index + 1);\n          x11 = end_of_dim0 ? x10 : getInputFloat(input_index + input_pitches[0] + 1);\n        }\n\n        float y0 = x00 + float(y_offset) * (x01 - x00) / float(scales[0]);\n        float y1 = x10 + float(y_offset) * (x11 - x10) / float(scales[0]);\n        return y0 + float(x_offset) * (y1 - y0) / float(scales[1]);\n      }",variables:[{name:"scales",type:"int",arrayLength:this.scales.length}]}},e.prototype.createRunData=function(t,e,n){var r=n.map((function(n,r){return t.getOrCreateTextureData(n,e.inputLayouts[r])}));return{inputTextureDatas:r,outputTextureData:t.createTextureDataFromLayout(e.outputLayout,r[0].tensor.type),uniformData:{scales:this.scales.map((function(t){return Math.ceil(t)}))}}},e}(o.Upsample);e.WebGLUpsample=s},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.ProgramManager=void 0;var o=n(25),a=n(3),s=n(155),l=n(2),c=function(){function t(t,e){this.profiler=t,this.glContext=e,this.repo=new Map,this.attributesBound=!1}return t.prototype.getArtifact=function(t){return this.repo.get(t)},t.prototype.setArtifact=function(t,e){this.repo.set(t,e)},t.prototype.run=function(t,e){var n=this;this.profiler.event("backend","ProgramManager.run",(function(){var r=n.glContext.gl,i=t.program;r.useProgram(i);try{n.bindOutput(e.outputTextureData),n.attributesBound||n.bindAttributes(t.attribLocations),n.bindUniforms(t.uniformLocations,e.uniformData,e.inputTextureDatas)}catch(e){throw a.Logger.error("ProgramManager",t.programInfo.shaderSource),e}n.profiler.event("backend","GlContext.draw()",(function(){n.doDraw(t,e),r.flush()}))}))},t.prototype.dispose=function(){var t=this;this.vertexShader&&this.glContext.deleteShader(this.vertexShader),this.repo.forEach((function(e){return t.glContext.deleteProgram(e.program)}))},t.prototype.build=function(t){var e=this;return this.profiler.event("backend","ProgramManager.build",(function(){var n=new s.GlslPreprocessor(e.glContext,t),r=n.preprocess(),i=e.compile(r);return{programInfo:t,program:i,uniformLocations:e.getUniformLocations(i,n.context.programInfo.samplers,n.context.programInfo.variables),attribLocations:e.getAttribLocations(i)}}))},t.prototype.doDraw=function(t,e){e.draw?(a.Logger.verbose("ProgramManager","Custom draw function"),e.draw(this.glContext,t)):this.glContext.draw()},t.prototype.compile=function(t){if(!this.vertexShader){a.Logger.verbose("ProrgramManager","Compiling and caching Vertex shader for the first time");var e=l.getVertexShaderSource(this.glContext.version);this.vertexShader=this.glContext.compileShader(e,this.glContext.gl.VERTEX_SHADER)}o.env.debug&&a.Logger.verbose("ProrgramManager","FragShader:\n"+t+"\n");var n=this.glContext.compileShader(t,this.glContext.gl.FRAGMENT_SHADER),r=this.glContext.createProgram(this.vertexShader,n);return this.glContext.deleteShader(n),r},t.prototype.bindOutput=function(t){a.Logger.verbose("ProrgramManager","Binding output texture to Framebuffer: w/h="+t.width+"/"+t.height+", shape="+t.shape+", type="+t.tensor.type),this.glContext.attachFramebuffer(t.texture,t.width,t.height)},t.prototype.bindAttributes=function(t){var e=t.position,n=t.textureCoord;this.glContext.setVertexAttributes(e,n),this.attributesBound=!0},t.prototype.bindUniforms=function(t,e,n){var r,o,a=this.glContext.gl,s=0;try{for(var l=i(t),c=l.next();!c.done;c=l.next()){var u=c.value,h=u.name,d=u.type,p=u.location,f=u.arrayLength;switch(d){case"sampler2D":this.bindTexture(n[s],p,s),s++;break;case"float":f?a.uniform1fv(p,e[h]):a.uniform1f(p,e[h]);break;case"int":f?a.uniform1iv(p,e[h]):a.uniform1i(p,e[h]);break;default:throw new Error("Uniform not implemented: "+d)}}}catch(t){r={error:t}}finally{try{c&&!c.done&&(o=l.return)&&o.call(l)}finally{if(r)throw r.error}}},t.prototype.bindTexture=function(t,e,n){this.glContext.bindTextureToUniform(t.texture,n,e)},t.prototype.getAttribLocations=function(t){return{position:this.getAttribLocation(t,"position"),textureCoord:this.getAttribLocation(t,"textureCoord")}},t.prototype.getUniformLocations=function(t,e,n){var o,a,s,l,c=[];if(e)try{for(var u=i(e),h=u.next();!h.done;h=u.next()){var d=h.value;c.push({name:d,type:"sampler2D",location:this.getUniformLocation(t,d)})}}catch(t){o={error:t}}finally{try{h&&!h.done&&(a=u.return)&&a.call(u)}finally{if(o)throw o.error}}if(n)try{for(var p=i(n),f=p.next();!f.done;f=p.next()){var m=f.value;c.push(r(r({},m),{location:this.getUniformLocation(t,m.name)}))}}catch(t){s={error:t}}finally{try{f&&!f.done&&(l=p.return)&&l.call(p)}finally{if(s)throw s.error}}return c},t.prototype.getUniformLocation=function(t,e){var n=this.glContext.gl.getUniformLocation(t,e);if(null===n)throw new Error("Uniform "+e+" not found.");return n},t.prototype.getAttribLocation=function(t,e){return this.glContext.gl.getAttribLocation(t,e)},t}();e.ProgramManager=c},function(t,e,n){"use strict";var r=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.GlslPreprocessor=void 0;var i=n(5),o=n(156),a=n(157),s=n(2),l=function(){function t(t,e){var n=this;this.libs={},this.glslLibRoutineDependencyGraph={},this.context=new i.GlslContext(t,e),Object.keys(a.glslRegistry).forEach((function(t){var e=new a.glslRegistry[t](n.context);n.libs[t]=e}));var r=this.glslLibRoutineDependencyGraph;for(var o in this.libs){var s=this.libs[o].getFunctions();for(var l in s){var c=o+"."+l,u=void 0;r[c]?(u=r[c]).routineBody=s[l].routineBody:(u=new i.GlslLibRoutineNode(c,s[l].routineBody),r[c]=u);var h=s[l].dependencies;if(h)for(var d=0;d<h.length;++d)if(r[h[d]])u.addDependency(r[h[d]]);else{var p=new i.GlslLibRoutineNode(h[d]);r[h[d]]=p,u.addDependency(p)}}}}return t.prototype.preprocess=function(){var t=this.context.programInfo,e=t.shaderSource;return this.context.programInfo.hasMain||(e=e+"\n      "+s.getDefaultFragShaderMain(this.context.glContext.version,t.outputLayout.shape.length)),e=o.replaceInlines(e),s.getFragShaderPreamble(this.context.glContext.version)+"\n    "+this.getUniforms(t.samplers,t.variables)+"\n    "+this.getImports(e)+"\n    "+e},t.prototype.getImports=function(t){var e=this.selectGlslLibRoutinesToBeIncluded(t);if(0===e.length)return"";for(var n="",r=0;r<e.length;++r){if(!e[r].routineBody)throw new Error("Missing body for the Glsl Library routine: "+e[r].name);n+=e[r].routineBody+"\n"}return n},t.prototype.selectGlslLibRoutinesToBeIncluded=function(t){var e=this,n=[];return Object.keys(this.glslLibRoutineDependencyGraph).forEach((function(r){var i=r.split(".")[1];-1!==t.indexOf(i)&&n.push(e.glslLibRoutineDependencyGraph[r])})),i.TopologicalSortGlslRoutines.returnOrderedNodes(n)},t.prototype.getUniforms=function(t,e){var n,i,o,a,s=[];if(t)try{for(var l=r(t),c=l.next();!c.done;c=l.next()){var u=c.value;s.push("uniform sampler2D "+u+";")}}catch(t){n={error:t}}finally{try{c&&!c.done&&(i=l.return)&&i.call(l)}finally{if(n)throw n.error}}if(e)try{for(var h=r(e),d=h.next();!d.done;d=h.next()){var p=d.value;s.push("uniform "+p.type+" "+p.name+(p.arrayLength?"["+p.arrayLength+"]":"")+";")}}catch(t){o={error:t}}finally{try{d&&!d.done&&(a=h.return)&&a.call(h)}finally{if(o)throw o.error}}return s.join("\n")},t}();e.GlslPreprocessor=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.replaceInlines=void 0;var r=/@inline[\s\n\r]+(\w+)[\s\n\r]+([0-9a-zA-Z_]+)\s*\(([^)]*)\)\s*{(([^}]|[\n\r])*)}/gm;e.replaceInlines=function(t){for(var e,n={};null!==(e=r.exec(t));){var i=e[3].split(",").map((function(t){var e=t.trim().split(" ");return e&&2===e.length?{type:e[0],name:e[1]}:null})).filter((function(t){return null!==t}));n[e[2]]={params:i,body:e[4]}}for(var o in n)for(var a="(\\w+)?\\s+([_0-9a-zA-Z]+)\\s+=\\s+__FUNC__\\((.*)\\)\\s*;".replace("__FUNC__",o),s=new RegExp(a,"gm"),l=function(){var r=e[1],i=e[2],a=e[3].split(","),s=r?r+" "+i+";":"",l=n[o].body,c="";n[o].params.forEach((function(t,e){t&&(c+=t.type+" "+t.name+" = "+a[e]+";\n")}));var u="\n      "+s+"\n      {\n        "+(l=(l=c+"\n "+l).replace("return",i+" = "))+"\n      }\n      ";t=t.replace(e[0],u)};null!==(e=s.exec(t));)l();return t=t.replace(r,"")}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.glslRegistry=void 0;var r=n(158),i=n(159),o=n(160),a=n(161),s=n(162);e.glslRegistry={encoding:i.EncodingGlslLib,fragcolor:o.FragColorGlslLib,vec:s.VecGlslLib,shapeUtils:a.ShapeUtilsGlslLib,coordinates:r.CoordsGlslLib}},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__assign||function(){return(o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.CoordsGlslLib=void 0;var a=n(5),s=n(2),l=function(t){function e(e){return t.call(this,e)||this}return i(e,t),e.prototype.getFunctions=function(){return o(o(o(o({},this.offsetToCoords()),this.coordsToOffset()),this.toVec()),this.valueFrom())},e.prototype.getCustomTypes=function(){return{}},e.prototype.offsetToCoords=function(){return{offsetToCoords:new a.GlslLibRoutine("\n      vec2 offsetToCoords(int offset, int width, int height) {\n        int t = offset / width;\n        int s = offset - t*width;\n        vec2 coords = (vec2(s,t) + vec2(0.5,0.5)) / vec2(width, height);\n        return coords;\n      }\n      ")}},e.prototype.coordsToOffset=function(){return{coordsToOffset:new a.GlslLibRoutine("\n      int coordsToOffset(vec2 coords, int width, int height) {\n        float s = coords.s * float(width);\n        float t = coords.t * float(height);\n        int offset = int(t) * width + int(s);\n        return offset;\n      }\n      ")}},e.prototype.toVec=function(){for(var t=this.context.programInfo.outputLayout,e=t.shape.length,n=t.strides,r=t.width,i=t.height,o=[],s=0;s<e-1;++s)o.push("\n        c["+s+"] = offset / "+n[s]+";"),o.push("\n        offset -= c["+s+"] * "+n[s]+";");o.push("\n        c["+(e-1)+"] = offset;");var l="\n      void toVec(vec2 texCoords, out int c["+e+"]) {\n        int offset = coordsToOffset(texCoords, "+r+", "+i+");\n        "+o.join("")+"\n      }\n      void toVec(int offset, out int c["+e+"]) {\n        "+o.join("")+"\n      }\n    ";return{toVec:new a.GlslLibRoutine(l,["coordinates.coordsToOffset"])}},e.prototype.valueFrom=function(){var t=this,e=this.context.programInfo,n={};return this.context.programInfo.samplers.forEach((function(r,i){var o=e.inputLayouts[i],s=o.shape.length,l="_"+r;n[l]=new a.GlslLibRoutine(t.getValueFromSingle(r,s,o.width,o.height,!1),["shapeUtils.indicesToOffset"+l,"coordinates.offsetToCoords","fragcolor.getColorAsFloat"]),n[l+="_T"]=new a.GlslLibRoutine(t.getValueFromSingle(r,s,o.width,o.height,!0),["shapeUtils.indicesToOffset"+l,"coordinates.offsetToCoords","fragcolor.getColorAsFloat"])})),n},e.prototype.getValueFromSingle=function(t,e,n,r,i){var o="_"+t;return i&&(o+="_T"),"\n        float "+o+"(int m["+e+"]) {\n          int offset = indicesToOffset"+o+"(m);\n          vec2 coords = offsetToCoords(offset, "+n+", "+r+");\n          float value = getColorAsFloat("+s.getGlsl(this.context.glContext.version).texture2D+"("+t+", coords));\n          return value;\n        }\n        "},e}(a.GlslLib);e.CoordsGlslLib=l},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__assign||function(){return(o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.EncodingGlslLib=void 0;var a=n(5),s=function(t){function e(e){return t.call(this,e)||this}return i(e,t),e.prototype.getFunctions=function(){return o(o({},this.encodeFloat32()),this.decodeFloat32())},e.prototype.getCustomTypes=function(){return{}},e.prototype.encodeFloat32=function(){return{encode:new a.GlslLibRoutine("highp vec4 encode(highp float f) {\n        return vec4(f, 0.0, 0.0, 0.0);\n      }\n        ")}},e.prototype.decodeFloat32=function(){return{decode:new a.GlslLibRoutine("highp float decode(highp vec4 rgba) {\n        return rgba.r;\n      }\n        ")}},e.prototype.encodeUint8=function(){var t=e.isLittleEndian()?"rgba.rgba=rgba.abgr;":"";return{encode:new a.GlslLibRoutine("\n      highp vec4 encode(highp float f) {\n        highp float F = abs(f);\n        highp float Sign = step(0.0,-f);\n        highp float Exponent = floor(log2(F));\n        highp float Mantissa = (exp2(- Exponent) * F);\n        Exponent = floor(log2(F) + 127.0) + floor(log2(Mantissa));\n        highp vec4 rgba;\n        rgba[0] = 128.0 * Sign  + floor(Exponent*exp2(-1.0));\n        rgba[1] = 128.0 * mod(Exponent,2.0) + mod(floor(Mantissa*128.0),128.0);\n        rgba[2] = floor(mod(floor(Mantissa*exp2(23.0 -8.0)),exp2(8.0)));\n        rgba[3] = floor(exp2(23.0)*mod(Mantissa,exp2(-15.0)));\n        "+t+"\n        rgba = rgba / 255.0; // values need to be normalized to [0,1]\n        return rgba;\n    }\n        ")}},e.prototype.decodeUint8=function(){var t=e.isLittleEndian()?"rgba.rgba=rgba.abgr;":"";return{decode:new a.GlslLibRoutine("\n        highp float decode(highp vec4 rgba) {\n          rgba = rgba * 255.0; // values need to be de-normalized from [0,1] to [0,255]\n          "+t+"\n          highp float Sign = 1.0 - step(128.0,rgba[0])*2.0;\n          highp float Exponent = 2.0 * mod(rgba[0],128.0) + step(128.0,rgba[1]) - 127.0;\n          highp float Mantissa = mod(rgba[1],128.0)*65536.0 + rgba[2]*256.0 +rgba[3] + float(0x800000);\n          highp float Result =  Sign * exp2(Exponent) * (Mantissa * exp2(-23.0 ));\n          return Result;\n      }\n        ")}},e.isLittleEndian=function(){var t=new ArrayBuffer(4),e=new Uint32Array(t),n=new Uint8Array(t);if(e[0]=3735928559,239===n[0])return!0;if(222===n[0])return!1;throw new Error("unknown endianness")},e}(a.GlslLib);e.EncodingGlslLib=s},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__assign||function(){return(o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.FragColorGlslLib=void 0;var a=n(5),s=n(2),l=function(t){function e(e){return t.call(this,e)||this}return i(e,t),e.prototype.getFunctions=function(){return o(o({},this.setFragColor()),this.getColorAsFloat())},e.prototype.getCustomTypes=function(){return{}},e.prototype.setFragColor=function(){var t=s.getGlsl(this.context.glContext.version);return{setFragColor:new a.GlslLibRoutine("\n        void setFragColor(float value) {\n            "+t.output+" = encode(value);\n        }\n        ",["encoding.encode"])}},e.prototype.getColorAsFloat=function(){return{getColorAsFloat:new a.GlslLibRoutine("\n        float getColorAsFloat(vec4 color) {\n            return decode(color);\n        }\n        ",["encoding.decode"])}},e}(a.GlslLib);e.FragColorGlslLib=l},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__assign||function(){return(o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.ShapeUtilsGlslLib=void 0;var a=n(5),s=function(t){function e(e){return t.call(this,e)||this}return i(e,t),e.prototype.getFunctions=function(){return o(o(o(o(o({},this.bcastIndex()),this.bcastMatmulIndex()),this.offsetToIndices()),this.indicesToOffset()),this.incrementIndices())},e.prototype.getCustomTypes=function(){return{}},e.prototype.bcastIndex=function(){var t=this.context.programInfo,e=t.outputLayout.shape.length,n={};return this.context.programInfo.samplers.forEach((function(r,i){var o=t.inputLayouts[i].shape;if(o.length<=e){for(var s=o.length,l=e-s,c="bcastIndices_"+r,u="",h=0;h<s;++h)u+="\n          realIndices["+h+"] = int( mod(float(bcastedIndices["+(l+h)+"]), "+o[h]+".0) );\n          ";var d="\n        void "+c+" (int bcastedIndices["+e+"], out int realIndices["+s+"]) {\n          "+u+"\n        }\n        ";n[c]=new a.GlslLibRoutine(d)}})),n},e.prototype.bcastMatmulIndex=function(){var t=this.context.programInfo,e=t.outputLayout.shape.length,n={};return this.context.programInfo.samplers.forEach((function(r,i){var o=t.inputLayouts[i].shape;if(!(o.length<2||o.length>e)){for(var s=o.length,l=e-s,c="bcastMatmulIndices_"+r,u="",h=0;h<s-2;++h)u+="\n          realIndices["+h+"] = int( mod(float(bcastedIndices["+(l+h)+"]), "+o[h]+".0) );\n          ";var d="\n        void "+c+"(int bcastedIndices["+e+"], out int realIndices["+s+"]) {\n          "+u+"\n          realIndices["+(s-1)+"] = bcastedIndices["+(e-1)+"];\n          realIndices["+(s-2)+"] = bcastedIndices["+(e-2)+"];\n        }\n        ";n[c]=new a.GlslLibRoutine(d)}})),n},e.prototype.indicesToOffset=function(){var t=this.context.programInfo,n={};return this.context.programInfo.samplers.forEach((function(r,i){var o=t.inputLayouts[i].shape,s=t.inputLayouts[i].strides,l=o.length,c="indicesToOffset_"+r;n[c]=new a.GlslLibRoutine(e.indexToOffsetSingle(c,l,s)),n[c="indicesToOffset_"+r+"_T"]=new a.GlslLibRoutine(e.indexToOffsetSingle(c,l,s.slice().reverse()))})),n},e.indexToOffsetSingle=function(t,e,n){for(var r="",i=e-1;i>=0;--i)r+="\n        offset += indices["+i+"] * "+n[i]+";\n        ";return"\n      int "+t+"(int indices["+e+"]) {\n        int offset = 0;\n        "+r+"\n        return offset;\n      }\n      "},e.prototype.offsetToIndices=function(){var t=this.context.programInfo,n={};return this.context.programInfo.samplers.forEach((function(r,i){var o=t.inputLayouts[i].shape,s=t.inputLayouts[i].strides,l=o.length,c="offsetToIndices_"+r;n[c]=new a.GlslLibRoutine(e.offsetToIndicesSingle(c,l,s)),n[c="offsetToIndices_"+r+"_T"]=new a.GlslLibRoutine(e.offsetToIndicesSingle(c,l,s.slice().reverse()))})),n},e.offsetToIndicesSingle=function(t,e,n){for(var r=[],i=0;i<e-1;++i)r.push("\n      indices["+i+"] = offset / "+n[i]+";"),r.push("\n        offset -= indices["+i+"] * "+n[i]+";");return r.push("\n      indices["+(e-1)+"] = offset;"),"\n      void "+t+"(int offset, out int indices["+e+"]) {\n        "+r.join("")+"\n      }\n      "},e.prototype.incrementIndices=function(){var t=this.context.programInfo,e={};return this.context.programInfo.samplers.forEach((function(n,r){for(var i=t.inputLayouts[r].shape,o=i.length,s="incrementIndices_"+n,l="",c=0;c<o;++c)l+="\n        shape["+c+"] = "+i[c]+";";var u="\n        void "+s+"(int axis, out int indices["+o+"]) {\n          int shape["+o+"];\n          "+l+";\n          for(int i = "+o+" -1 ; i >= 0; --i) {\n            if(i > axis) continue;\n            indices[i] += 1;\n            if(indices[i] < shape[i]) {\n              break;\n            }\n            indices[i] = 0;\n          }\n        }\n        ";e[s]=new a.GlslLibRoutine(u)})),e},e}(a.GlslLib);e.ShapeUtilsGlslLib=s},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__assign||function(){return(o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.VecGlslLib=void 0;var a=n(5),s=function(t){function e(e){return t.call(this,e)||this}return i(e,t),e.prototype.getCustomTypes=function(){return{}},e.prototype.getFunctions=function(){return o(o(o(o({},this.binaryVecFunctions()),this.copyVec()),this.setVecItem()),this.getVecItem())},e.prototype.binaryVecFunctions=function(){var t=this.context.programInfo.outputLayout.shape.length,e={add:"+=",sub:"-=",mul:"*=",div:"/="},n={};for(var r in e){for(var i=r+"Vec",o="",s=0;s<t;++s)o+="\n          dest["+s+"] "+e[r]+" src["+s+"];\n          ";var l="\n        void "+i+"(int src["+t+"], out int dest["+t+"]) {\n          "+o+"\n        }\n        ";n[i]=new a.GlslLibRoutine(l)}return n},e.prototype.copyVec=function(){for(var t=this.context.programInfo.outputLayout.shape.length,e="",n=0;n<t;++n)e+="\n        dest["+n+"] = src["+n+"];\n        ";var r="\n      void copyVec(int src["+t+"], out int dest["+t+"]) {\n        "+e+"\n      }\n      ";return{copyVec:new a.GlslLibRoutine(r)}},e.prototype.setVecItem=function(){for(var t=this.context.programInfo.outputLayout.shape.length,e="\n        if(index < 0)\n            index ="+t+" + index;\n        if (index == 0)\n            m[0] = value;\n        ",n=1;n<t-1;++n)e+="\n        else if (index == "+n+")\n            m["+n+"] = value;\n            ";var r="\n      void setVecItem(out int m["+t+"], int index, int value) {\n        "+(e+="\n        else\n            m["+(t-1)+"] = value;\n        ")+"\n      }\n        ";return{setVecItem:new a.GlslLibRoutine(r)}},e.prototype.getVecItem=function(){for(var t=this.context.programInfo.outputLayout.shape.length,e="\n        if(index < 0)\n            index = "+t+" + index;\n        if (index == 0)\n            return m[0];\n      ",n=1;n<t-1;++n)e+="\n        else if (index == "+n+")\n            return m["+n+"];\n      ";var r="\n      int getVecItem(int m["+t+"], int index) {\n        "+(e+="\n        else\n            return m["+(t-1)+"];\n        ")+"\n      }\n    ";return{getVecItem:new a.GlslLibRoutine(r)}},e}(a.GlslLib);e.VecGlslLib=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AlwaysKeepOriginalSizeStrategy=void 0;var r=n(3),i=function(){function t(t){this.maxTextureSize=t}return t.prototype.computeTextureWH=function(t,e){if(0===t.length)return[1,1];var n=this.maxTextureSize;if(e){var i=e.breakAxis>=t.length?1:t.slice(e.breakAxis).reduce((function(t,e){return t*e})),o=e.breakAxis<=0?1:t.slice(0,e.breakAxis).reduce((function(t,e){return t*e}));if(!(i>n||o>n))return[i,o];r.Logger.verbose("TextureLayout","Given width/height preferences were unattainable: shape:"+t+", breakAxis:"+e.breakAxis)}for(var a=t.reduce((function(t,e){return t*e})),s=Math.floor(Math.sqrt(a));s<n&&s<a&&a%s!=0;s++);if(s>=n||a%s!=0)throw new Error("The given dimensions are outside this GPU's boundaries: "+t);return[s,a/s]},t}();e.AlwaysKeepOriginalSizeStrategy=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TextureManager=void 0;var r=n(3),i=function(){function t(t,e,n,r){this.glContext=t,this.layoutStrategy=e,this.profiler=n,this.config=r,r.reuseTextures&&(this.inUseTextures=new Map,this.idleTextures=new Map,this.textureLookup=new Map)}return t.prototype.createTextureFromLayout=function(t,e,n,i){var o,a,s=this.toEncoderType(t),l=this.glContext.getEncoder(s,e.channels||1,i);if(this.config.reuseTextures){o=e.width+"x"+e.height+"_"+l.format+"_"+l.internalFormat+"_"+l.textureType,(a=this.inUseTextures.get(o))||(a=[],this.inUseTextures.set(o,a));var c=this.idleTextures.get(o);if(c&&c.length>0){var u=c.pop();return a.push(u),1===i&&this.glContext.updateTexture(u,e.width,e.height,l,this.toTextureData(t,n)),u}}r.Logger.verbose("TextureManager","Creating new texture of size "+e.width+"x"+e.height);var h=this.glContext.allocateTexture(e.width,e.height,l,this.toTextureData(t,n));return this.config.reuseTextures&&(a.push(h),this.textureLookup.set(h,o)),h},t.prototype.readTexture=function(t,e,n){var r=this;return n||(n=1),this.profiler.event("backend","TextureManager.readTexture",(function(){var i=t.shape.reduce((function(t,e){return t*e}))*n,o=r.glContext.readTexture(t.texture,t.width,t.height,i,r.toEncoderType(e),n);return r.toTensorData(e,o)}))},t.prototype.readUint8TextureAsFloat=function(t){var e=this;return this.profiler.event("backend","TextureManager.readUint8TextureAsFloat",(function(){var n=t.shape.reduce((function(t,e){return t*e})),r=e.glContext.readTexture(t.texture,t.width,t.height,4*n,"byte",4);return new Float32Array(r.buffer,r.byteOffset,n)}))},t.prototype.releaseTexture=function(t,e){var n;if(this.config.reuseTextures&&(n=this.textureLookup.get(t.texture))){e&&this.textureLookup.delete(n);var i=this.inUseTextures.get(n);if(i){var o=i.indexOf(t.texture);if(-1!==o){i.splice(o,1);var a=this.idleTextures.get(n);a||(a=[],this.idleTextures.set(n,a)),a.push(t.texture)}}}n&&!e||(r.Logger.verbose("TextureManager","Deleting texture of size "+t.width+"x"+t.height),this.glContext.deleteTexture(t.texture))},t.prototype.toTensorData=function(t,e){return e instanceof Float32Array?e:new Float32Array(e)},t.prototype.toTextureData=function(t,e){if(e)return e instanceof Float32Array?e:new Float32Array(e)},t.prototype.toEncoderType=function(t){return"float"},t.prototype.clearActiveTextures=function(){this.glContext.clearActiveTextures()},t}();e.TextureManager=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createNewWebGLContext=e.createWebGLContext=void 0;var r=n(3),i=n(166),o={};function a(t){var e,n=function(){var t=document.createElement("canvas");return t.width=1,t.height=1,t}(),o={alpha:!1,depth:!1,antialias:!1,stencil:!1,preserveDrawingBuffer:!1,premultipliedAlpha:!1,failIfMajorPerformanceCaveat:!1};if((!t||"webgl2"===t)&&(e=n.getContext("webgl2",o)))try{return new i.WebGLContext(e,2)}catch(t){r.Logger.warning("GlContextFactory","failed to create WebGLContext using contextId 'webgl2'. Error: "+t)}if((!t||"webgl"===t)&&(e=n.getContext("webgl",o)||n.getContext("experimental-webgl",o)))try{return new i.WebGLContext(e,1)}catch(t){r.Logger.warning("GlContextFactory","failed to create WebGLContext using contextId 'webgl' or 'experimental-webgl'. Error: "+t)}throw new Error("WebGL is not supported")}e.createWebGLContext=function t(e){var n;e&&"webgl2"!==e||!("webgl2"in o)?e&&"webgl"!==e||!("webgl"in o)||(n=o.webgl):n=o.webgl2,n=n||a(e),e=e||1===n.version?"webgl":"webgl2";var r=n.gl;return o[e]=n,r.isContextLost()?(delete o[e],t(e)):(r.disable(r.DEPTH_TEST),r.disable(r.STENCIL_TEST),r.disable(r.BLEND),r.disable(r.DITHER),r.disable(r.POLYGON_OFFSET_FILL),r.disable(r.SAMPLE_COVERAGE),r.enable(r.SCISSOR_TEST),r.enable(r.CULL_FACE),r.cullFace(r.BACK),n)},e.createNewWebGLContext=a},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.WebGLContext=void 0;var a=n(25),s=o(n(167)),l=function(){function t(t,e){this.frameBufferBound=!1,this.gl=t,this.version=e,this.getExtensions(),this.vertexbuffer=this.createVertexbuffer(),this.framebuffer=this.createFramebuffer(),this.queryVitalParameters()}return t.prototype.allocateTexture=function(t,e,n,r){var i=this.gl,o=i.createTexture();i.bindTexture(i.TEXTURE_2D,o),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE);var a=r?n.encode(r,t*e):null;return i.texImage2D(i.TEXTURE_2D,0,n.internalFormat,t,e,0,n.format,n.textureType,a),this.checkError(),o},t.prototype.updateTexture=function(t,e,n,r,i){var o=this.gl;o.bindTexture(o.TEXTURE_2D,t);var a=r.encode(i,e*n);o.texSubImage2D(o.TEXTURE_2D,0,0,0,e,n,r.format,r.textureType,a),this.checkError()},t.prototype.attachFramebuffer=function(t,e,n){var r=this.gl;r.bindTexture(r.TEXTURE_2D,t),r.bindFramebuffer(r.FRAMEBUFFER,this.framebuffer),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,t,0),this.checkError(),r.viewport(0,0,e,n),r.scissor(0,0,e,n)},t.prototype.readTexture=function(t,e,n,r,i,o){var a=this.gl;o||(o=1),this.frameBufferBound||this.attachFramebuffer(t,e,n);var s=this.getEncoder(i,o),l=s.allocate(e*n);return a.bindTexture(a.TEXTURE_2D,t),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,t,0),a.readPixels(0,0,e,n,a.RGBA,s.textureType,l),this.checkError(),s.decode(l,r)},t.prototype.isFramebufferReady=function(){return!0},t.prototype.getActiveTexture=function(){var t=this.gl;return"TEXTURE"+(t.getParameter(this.gl.ACTIVE_TEXTURE)-t.TEXTURE0)},t.prototype.getTextureBinding=function(){return this.gl.getParameter(this.gl.TEXTURE_BINDING_2D)},t.prototype.getFramebufferBinding=function(){return this.gl.getParameter(this.gl.FRAMEBUFFER_BINDING)},t.prototype.setVertexAttributes=function(t,e){var n=this.gl;n.vertexAttribPointer(t,3,n.FLOAT,!1,20,0),n.enableVertexAttribArray(t),-1!==e&&(n.vertexAttribPointer(e,2,n.FLOAT,!1,20,12),n.enableVertexAttribArray(e)),this.checkError()},t.prototype.createProgram=function(t,e){var n=this.gl,r=n.createProgram();return n.attachShader(r,t),n.attachShader(r,e),n.linkProgram(r),r},t.prototype.compileShader=function(t,e){var n=this.gl,r=n.createShader(e);if(!r)throw new Error("createShader() returned null with type "+e);if(n.shaderSource(r,t),n.compileShader(r),!1===n.getShaderParameter(r,n.COMPILE_STATUS))throw new Error("Failed to compile shader: "+n.getShaderInfoLog(r));return r},t.prototype.deleteShader=function(t){this.gl.deleteShader(t)},t.prototype.bindTextureToUniform=function(t,e,n){var r=this.gl;r.activeTexture(r.TEXTURE0+e),this.checkError(),r.bindTexture(r.TEXTURE_2D,t),this.checkError(),r.uniform1i(n,e),this.checkError()},t.prototype.draw=function(){this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.checkError()},t.prototype.checkError=function(){if(a.env.debug){var t=this.gl,e=t.getError(),n="";switch(e){case t.NO_ERROR:return;case t.INVALID_ENUM:n="INVALID_ENUM";break;case t.INVALID_VALUE:n="INVALID_VALUE";break;case t.INVALID_OPERATION:n="INVALID_OPERATION";break;case t.INVALID_FRAMEBUFFER_OPERATION:n="INVALID_FRAMEBUFFER_OPERATION";break;case t.OUT_OF_MEMORY:n="OUT_OF_MEMORY";break;case t.CONTEXT_LOST_WEBGL:n="CONTEXT_LOST_WEBGL";break;default:n="Unknown WebGL Error: "+e.toString(16)}throw new Error(n)}},t.prototype.deleteTexture=function(t){this.gl.deleteTexture(t)},t.prototype.deleteProgram=function(t){this.gl.deleteProgram(t)},t.prototype.getEncoder=function(t,e,n){if(void 0===n&&(n=0),2===this.version)return new s.RedFloat32DataEncoder(this.gl,e);switch(t){case"float":return 1===n||this.isRenderFloat32Supported?new s.RGBAFloatDataEncoder(this.gl,e):new s.RGBAFloatDataEncoder(this.gl,e,this.textureHalfFloatExtension.HALF_FLOAT_OES);case"int":throw new Error("not implemented");case"byte":return new s.Uint8DataEncoder(this.gl,e);default:throw new Error("Invalid dataType: "+t)}},t.prototype.clearActiveTextures=function(){for(var t=this.gl,e=0;e<this.maxTextureImageUnits;++e)t.activeTexture(t.TEXTURE0+e),t.bindTexture(t.TEXTURE_2D,null)},t.prototype.dispose=function(){if(!this.disposed){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteFramebuffer(this.framebuffer),t.bindBuffer(t.ARRAY_BUFFER,null),t.deleteBuffer(this.vertexbuffer),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null),t.finish(),this.disposed=!0}},t.prototype.createDefaultGeometry=function(){return new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0])},t.prototype.createVertexbuffer=function(){var t=this.gl,e=t.createBuffer();if(!e)throw new Error("createBuffer() returned null");var n=this.createDefaultGeometry();return t.bindBuffer(t.ARRAY_BUFFER,e),t.bufferData(t.ARRAY_BUFFER,n,t.STATIC_DRAW),this.checkError(),e},t.prototype.createFramebuffer=function(){var t=this.gl.createFramebuffer();if(!t)throw new Error("createFramebuffer returned null");return t},t.prototype.queryVitalParameters=function(){var t=this.gl;if(this.isFloatTextureAttachableToFrameBuffer=this.checkFloatTextureAttachableToFrameBuffer(),this.isRenderFloat32Supported=this.checkRenderFloat32(),this.isFloat32DownloadSupported=this.checkFloat32Download(),1===this.version&&!this.textureHalfFloatExtension&&!this.isRenderFloat32Supported)throw new Error("both float32 and float16 TextureType are not supported");this.isBlendSupported=!this.isRenderFloat32Supported||this.checkFloat32Blend(),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),this.maxTextureImageUnits=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),this.version},t.prototype.getExtensions=function(){2===this.version?this.colorBufferFloatExtension=this.gl.getExtension("EXT_color_buffer_float"):(this.textureFloatExtension=this.gl.getExtension("OES_texture_float"),this.textureHalfFloatExtension=this.gl.getExtension("OES_texture_half_float"))},t.prototype.checkFloatTextureAttachableToFrameBuffer=function(){var t=this.gl,e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);var n=2===this.version?t.RGBA32F:t.RGBA;t.texImage2D(t.TEXTURE_2D,0,n,1,1,0,t.RGBA,t.FLOAT,null);var r=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0);var i=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(e),t.deleteFramebuffer(r),i},t.prototype.checkRenderFloat32=function(){if(2===this.version){if(!this.colorBufferFloatExtension)return!1}else if(!this.textureFloatExtension)return!1;return this.isFloatTextureAttachableToFrameBuffer},t.prototype.checkFloat32Download=function(){if(2===this.version){if(!this.colorBufferFloatExtension)return!1}else{if(!this.textureFloatExtension)return!1;if(!this.gl.getExtension("WEBGL_color_buffer_float"))return!1}return this.isFloatTextureAttachableToFrameBuffer},t.prototype.checkFloat32Blend=function(){var t,e,n,r,i,o=this.gl;try{t=o.createTexture(),e=o.createFramebuffer(),o.bindTexture(o.TEXTURE_2D,t);var a=2===this.version?o.RGBA32F:o.RGBA;return o.texImage2D(o.TEXTURE_2D,0,a,1,1,0,o.RGBA,o.FLOAT,null),o.bindFramebuffer(o.FRAMEBUFFER,e),o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,t,0),o.enable(o.BLEND),!!(n=o.createShader(o.VERTEX_SHADER))&&(o.shaderSource(n,"void main(){}"),o.compileShader(n),!!(r=o.createShader(o.FRAGMENT_SHADER))&&(o.shaderSource(r,"precision highp float;void main(){gl_FragColor=vec4(0.5);}"),o.compileShader(r),!!(i=o.createProgram())&&(o.attachShader(i,n),o.attachShader(i,r),o.linkProgram(i),o.useProgram(i),o.drawArrays(o.POINTS,0,1),o.getError()===o.NO_ERROR)))}finally{o.disable(o.BLEND),i&&o.deleteProgram(i),n&&o.deleteShader(n),r&&o.deleteShader(r),e&&(o.bindFramebuffer(o.FRAMEBUFFER,null),o.deleteFramebuffer(e)),t&&(o.bindTexture(o.TEXTURE_2D,null),o.deleteTexture(t))}},t}();e.WebGLContext=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Uint8DataEncoder=e.RGBAFloatDataEncoder=e.RedFloat32DataEncoder=void 0;var r=n(3),i=function(){function t(t,e){if(void 0===e&&(e=1),1===e)this.internalFormat=t.R32F,this.format=t.RED,this.textureType=t.FLOAT,this.channelSize=e;else{if(4!==e)throw new Error("Invalid number of channels: "+e);this.internalFormat=t.RGBA32F,this.format=t.RGBA,this.textureType=t.FLOAT,this.channelSize=e}}return t.prototype.encode=function(t,e){var n,i;return t.constructor!==Float32Array&&(r.Logger.warning("Encoder","data was not of type Float32; creating new Float32Array"),i=new Float32Array(t)),e*this.channelSize>t.length?(r.Logger.warning("Encoder","Source data too small. Allocating larger array"),i=t,n=this.allocate(e*this.channelSize),i.forEach((function(t,e){return n[e]=t}))):n=i=t,n},t.prototype.allocate=function(t){return new Float32Array(4*t)},t.prototype.decode=function(t,e){return 1===this.channelSize?t.filter((function(t,e){return e%4==0})).subarray(0,e):t.subarray(0,e)},t}();e.RedFloat32DataEncoder=i;var o=function(){function t(t,e,n){if(void 0===e&&(e=1),1!==e&&4!==e)throw new Error("Invalid number of channels: "+e);this.internalFormat=t.RGBA,this.format=t.RGBA,this.channelSize=e,this.textureType=n||t.FLOAT}return t.prototype.encode=function(t,e){var n=t;return 1===this.channelSize&&(r.Logger.verbose("Encoder","Exploding into a larger array"),n=this.allocate(e),t.forEach((function(t,e){return n[4*e]=t}))),n},t.prototype.allocate=function(t){return new Float32Array(4*t)},t.prototype.decode=function(t,e){return 1===this.channelSize?t.filter((function(t,e){return e%4==0})).subarray(0,e):t.subarray(0,e)},t}();e.RGBAFloatDataEncoder=o;var a=function(){function t(t,e){if(void 0===e&&(e=1),this.channelSize=4,1===e)this.internalFormat=t.ALPHA,this.format=t.ALPHA,this.textureType=t.UNSIGNED_BYTE,this.channelSize=e;else{if(4!==e)throw new Error("Invalid number of channels: "+e);this.internalFormat=t.RGBA,this.format=t.RGBA,this.textureType=t.UNSIGNED_BYTE,this.channelSize=e}}return t.prototype.encode=function(t,e){return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)},t.prototype.allocate=function(t){return new Uint8Array(t*this.channelSize)},t.prototype.decode=function(t,e){if(t instanceof Uint8Array)return t.subarray(0,e);throw new Error("Invalid array type: "+t.constructor)},t}();e.Uint8DataEncoder=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.envImpl=void 0;var r=n(25),i=function(){function t(){}return Object.defineProperty(t.prototype,"debug",{get:function(){return r.env.debug},set:function(t){r.env.debug=t},enumerable:!1,configurable:!0}),t}();e.envImpl=new i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Tensor=void 0;var a=o(n(51));e.Tensor=a.Tensor},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.InferenceSession=void 0;var a=o(n(173));e.InferenceSession=a.InferenceSession},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e},a=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{l(r.next(t))}catch(t){o(t)}}function s(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((r=r.apply(t,e||[])).next())}))},s=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.InferenceSession=void 0;var l=n(174),c=o(n(52)),u=function(){function t(t){this.session=new l.Session(t)}return t.prototype.loadModel=function(t,e,n){if("string"==typeof t)return this.session.loadModel(t);if("undefined"!=typeof Blob&&t instanceof Blob){var r=URL.createObjectURL(t);return this.session.loadModel(r)}if(t instanceof ArrayBuffer)return this.session.loadModel(t,e,n);if(ArrayBuffer.isView(t))return this.session.loadModel(t);throw new Error("Model type is not supported.")},t.prototype.run=function(t,e){return a(this,void 0,void 0,(function(){var e,n,r,i,o,a;return s(this,(function(s){switch(s.label){case 0:return e=new Map,t instanceof Map?(n=new Map,t.forEach((function(t,e){n.set(e,t.internalTensor)})),[4,this.session.run(n)]):[3,2];case 1:return e=s.sent(),[3,5];case 2:return Array.isArray(t)?(r=[],t.forEach((function(t){r.push(t.internalTensor)})),[4,this.session.run(r)]):[3,4];case 3:return e=s.sent(),[3,5];case 4:for(o in i=new Map,t)i.set(o,t[o].internalTensor);s.label=5;case 5:return a=new Map,e.forEach((function(t,e){a.set(e,c.fromInternalTensor(t))})),[2,a]}}))}))},t.prototype.startProfiling=function(){this.session.startProfiling()},t.prototype.endProfiling=function(){this.session.endProfiling()},t}();e.InferenceSession=u},function(t,e,n){"use strict";(function(t){var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{l(r.next(t))}catch(t){o(t)}}function s(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.Session=void 0;var o=n(48),a=n(175),s=n(178),l=n(179),c=n(3),u=n(180),h=function(){function e(t){void 0===t&&(t={}),this._initialized=!1,this.backendHint=t.backendHint,this.profiler=c.Profiler.create(t.profiler),this.context={profiler:this.profiler,graphInputTypes:[],graphInputDims:[]}}return e.prototype.startProfiling=function(){this.profiler.start()},e.prototype.endProfiling=function(){this.profiler.stop()},e.prototype.loadModel=function(e,n,l){return r(this,void 0,void 0,(function(){var c=this;return i(this,(function(h){switch(h.label){case 0:return[4,this.profiler.event("session","Session.loadModel",(function(){return r(c,void 0,void 0,(function(){var r,c,h;return i(this,(function(i){switch(i.label){case 0:return[4,s.Backend(this.backendHint)];case 1:return r=i.sent(),this.sessionHandler=r.createSessionHandler(this.context),this._model=new u.Model,"string"!=typeof e?[3,7]:"undefined"!=typeof fetch?[3,3]:[4,a.promisify(o.readFile)(e)];case 2:return c=i.sent(),this.initialize(t.from(c)),[3,6];case 3:return[4,fetch(e)];case 4:return[4,i.sent().arrayBuffer()];case 5:c=i.sent(),this.initialize(t.from(c)),i.label=6;case 6:return[3,8];case 7:ArrayBuffer.isView(e)?this.initialize(t.from(e)):(h=new Uint8Array(e,n||0,l||e.byteLength),this.initialize(t.from(h))),i.label=8;case 8:return[2]}}))}))}))];case 1:return h.sent(),[2]}}))}))},e.prototype.initialize=function(t){var e=this;if(this._initialized)throw new Error("already initialized");this.profiler.event("session","Session.initialize",(function(){var n=e.sessionHandler.transformGraph?e.sessionHandler:void 0;e._model.load(t,n),e.sessionHandler.onGraphInitialized&&e.sessionHandler.onGraphInitialized(e._model.graph),e.initializeOps(e._model.graph),e._executionPlan=new l.ExecutionPlan(e._model.graph,e._ops,e.profiler)})),this._initialized=!0},e.prototype.run=function(t){var e=this;if(!this._initialized)throw new Error("session not initialized yet");return this.profiler.event("session","Session.run",(function(){return r(e,void 0,void 0,(function(){var e,n;return i(this,(function(r){switch(r.label){case 0:return e=this.normalizeAndValidateInputs(t),[4,this._executionPlan.execute(this.sessionHandler,e)];case 1:return n=r.sent(),[2,this.createOutput(n)]}}))}))}))},e.prototype.normalizeAndValidateInputs=function(t){var e=this._model.graph.getInputNames();if(Array.isArray(t)){if(t.length!==e.length)throw new Error("incorrect input array length: expected "+e.length+" but got "+t.length)}else{if(t.size!==e.length)throw new Error("incorrect input map size: expected "+e.length+" but got "+t.size);for(var n=new Array(t.size),r=0,i=0;i<e.length;++i){var o=t.get(e[i]);if(!o)throw new Error("missing input tensor for: '"+name+"'");n[r++]=o}t=n}if(this.context.graphInputTypes&&0!==this.context.graphInputTypes.length&&this.context.graphInputDims&&0!==this.context.graphInputDims.length)this.validateInputTensorDims(this.context.graphInputDims,t,!1);else{var a=this._model.graph.getInputIndices(),s=this._model.graph.getValues(),l=new Array(a.length);for(i=0;i<a.length;++i){var c=s[a[i]];l[i]=c.type.shape.dims,this.context.graphInputTypes.push(c.type.tensorType),this.context.graphInputDims.push(t[i].dims)}this.validateInputTensorDims(l,t,!0)}return this.validateInputTensorTypes(this.context.graphInputTypes,t),t},e.prototype.validateInputTensorTypes=function(t,e){for(var n=0;n<e.length;n++){var r=t[n],i=e[n].type;if(r!==i)throw new Error("input tensor["+n+"] check failed: expected type '"+r+"' but got "+i)}},e.prototype.validateInputTensorDims=function(t,e,n){for(var r=0;r<e.length;r++){var i=t[r],o=e[r].dims;if(!this.compareTensorDims(i,o,n))throw new Error("input tensor["+r+"] check failed: expected shape '["+i.join(",")+"]' but got ["+o.join(",")+"]")}},e.prototype.compareTensorDims=function(t,e,n){if(t.length!==e.length)return!1;for(var r=0;r<t.length;++r)if(t[r]!==e[r]&&(!n||0!==t[r]))return!1;return!0},e.prototype.createOutput=function(t){var e=this._model.graph.getOutputNames();if(t.length!==e.length)throw new Error("expected number of outputs do not match number of generated outputs");for(var n=new Map,r=0;r<e.length;++r)n.set(e[r],t[r]);return n},e.prototype.initializeOps=function(t){var e=t.getNodes();this._ops=new Array(e.length);for(var n=0;n<e.length;n++)this._ops[n]=this.sessionHandler.resolve(e[n],this._model.opsets)},e}();e.Session=h}).call(this,n(12).Buffer)},function(t,e,n){(function(t){var r=Object.getOwnPropertyDescriptors||function(t){for(var e=Object.keys(t),n={},r=0;r<e.length;r++)n[e[r]]=Object.getOwnPropertyDescriptor(t,e[r]);return n},i=/%[sdj%]/g;e.format=function(t){if(!y(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(s(arguments[n]));return e.join(" ")}n=1;for(var r=arguments,o=r.length,a=String(t).replace(i,(function(t){if("%%"===t)return"%";if(n>=o)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return t}})),l=r[n];n<o;l=r[++n])m(l)||!x(l)?a+=" "+l:a+=" "+s(l);return a},e.deprecate=function(n,r){if(void 0!==t&&!0===t.noDeprecation)return n;if(void 0===t)return function(){return e.deprecate(n,r).apply(this,arguments)};var i=!1;return function(){if(!i){if(t.throwDeprecation)throw new Error(r);t.traceDeprecation?console.trace(r):console.error(r),i=!0}return n.apply(this,arguments)}};var o,a={};function s(t,n){var r={seen:[],stylize:c};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),f(n)?r.showHidden=n:n&&e._extend(r,n),v(r.showHidden)&&(r.showHidden=!1),v(r.depth)&&(r.depth=2),v(r.colors)&&(r.colors=!1),v(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=l),u(r,t,r.depth)}function l(t,e){var n=s.styles[e];return n?"\x1b["+s.colors[n][0]+"m"+t+"\x1b["+s.colors[n][1]+"m":t}function c(t,e){return t}function u(t,n,r){if(t.customInspect&&n&&S(n.inspect)&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,t);return y(i)||(i=u(t,i,r)),i}var o=function(t,e){if(v(e))return t.stylize("undefined","undefined");if(y(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}return g(e)?t.stylize(""+e,"number"):f(e)?t.stylize(""+e,"boolean"):m(e)?t.stylize("null","null"):void 0}(t,n);if(o)return o;var a=Object.keys(n),s=function(t){var e={};return t.forEach((function(t,n){e[t]=!0})),e}(a);if(t.showHidden&&(a=Object.getOwnPropertyNames(n)),w(n)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return h(n);if(0===a.length){if(S(n)){var l=n.name?": "+n.name:"";return t.stylize("[Function"+l+"]","special")}if(b(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(_(n))return t.stylize(Date.prototype.toString.call(n),"date");if(w(n))return h(n)}var c,x="",T=!1,E=["{","}"];return p(n)&&(T=!0,E=["[","]"]),S(n)&&(x=" [Function"+(n.name?": "+n.name:"")+"]"),b(n)&&(x=" "+RegExp.prototype.toString.call(n)),_(n)&&(x=" "+Date.prototype.toUTCString.call(n)),w(n)&&(x=" "+h(n)),0!==a.length||T&&0!=n.length?r<0?b(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special"):(t.seen.push(n),c=T?function(t,e,n,r,i){for(var o=[],a=0,s=e.length;a<s;++a)C(e,String(a))?o.push(d(t,e,n,r,String(a),!0)):o.push("");return i.forEach((function(i){i.match(/^\d+$/)||o.push(d(t,e,n,r,i,!0))})),o}(t,n,r,s,a):a.map((function(e){return d(t,n,r,s,e,T)})),t.seen.pop(),function(t,e,n){return t.reduce((function(t,e){return e.indexOf("\n"),t+e.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}(c,x,E)):E[0]+x+E[1]}function h(t){return"["+Error.prototype.toString.call(t)+"]"}function d(t,e,n,r,i,o){var a,s,l;if((l=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]}).get?s=l.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):l.set&&(s=t.stylize("[Setter]","special")),C(r,i)||(a="["+i+"]"),s||(t.seen.indexOf(l.value)<0?(s=m(n)?u(t,l.value,null):u(t,l.value,n-1)).indexOf("\n")>-1&&(s=o?s.split("\n").map((function(t){return"  "+t})).join("\n").substr(2):"\n"+s.split("\n").map((function(t){return"   "+t})).join("\n")):s=t.stylize("[Circular]","special")),v(a)){if(o&&i.match(/^\d+$/))return s;(a=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=t.stylize(a,"string"))}return a+": "+s}function p(t){return Array.isArray(t)}function f(t){return"boolean"==typeof t}function m(t){return null===t}function g(t){return"number"==typeof t}function y(t){return"string"==typeof t}function v(t){return void 0===t}function b(t){return x(t)&&"[object RegExp]"===T(t)}function x(t){return"object"==typeof t&&null!==t}function _(t){return x(t)&&"[object Date]"===T(t)}function w(t){return x(t)&&("[object Error]"===T(t)||t instanceof Error)}function S(t){return"function"==typeof t}function T(t){return Object.prototype.toString.call(t)}function E(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(n){if(v(o)&&(o=t.env.NODE_DEBUG||""),n=n.toUpperCase(),!a[n])if(new RegExp("\\b"+n+"\\b","i").test(o)){var r=t.pid;a[n]=function(){var t=e.format.apply(e,arguments);console.error("%s %d: %s",n,r,t)}}else a[n]=function(){};return a[n]},e.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=p,e.isBoolean=f,e.isNull=m,e.isNullOrUndefined=function(t){return null==t},e.isNumber=g,e.isString=y,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=v,e.isRegExp=b,e.isObject=x,e.isDate=_,e.isError=w,e.isFunction=S,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=n(176);var M=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function C(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){console.log("%s - %s",function(){var t=new Date,e=[E(t.getHours()),E(t.getMinutes()),E(t.getSeconds())].join(":");return[t.getDate(),M[t.getMonth()],e].join(" ")}(),e.format.apply(e,arguments))},e.inherits=n(177),e._extend=function(t,e){if(!e||!x(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t};var A="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function k(t,e){if(!t){var n=new Error("Promise was rejected with a falsy value");n.reason=t,t=n}return e(t)}e.promisify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');if(A&&t[A]){var e;if("function"!=typeof(e=t[A]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(e,A,{value:e,enumerable:!1,writable:!1,configurable:!0}),e}function e(){for(var e,n,r=new Promise((function(t,r){e=t,n=r})),i=[],o=0;o<arguments.length;o++)i.push(arguments[o]);i.push((function(t,r){t?n(t):e(r)}));try{t.apply(this,i)}catch(t){n(t)}return r}return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),A&&Object.defineProperty(e,A,{value:e,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(e,r(t))},e.promisify.custom=A,e.callbackify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');function n(){for(var n=[],r=0;r<arguments.length;r++)n.push(arguments[r]);var i=n.pop();if("function"!=typeof i)throw new TypeError("The last argument must be of type Function");var o=this,a=function(){return i.apply(o,arguments)};e.apply(this,n).then((function(e){t.nextTick(a,null,e)}),(function(e){t.nextTick(k,e,a)}))}return Object.setPrototypeOf(n,Object.getPrototypeOf(e)),Object.defineProperties(n,r(e)),n}}).call(this,n(24))},function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{l(r.next(t))}catch(t){o(t)}}function s(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},o=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.Backend=void 0;var a=new Map;function s(t){return r(this,void 0,void 0,(function(){var e,n,r;return i(this,(function(i){switch(i.label){case 0:return void 0!==(e=onnx.backend)[t]&&function(t){var e=t;return"initialize"in e&&"function"==typeof e.initialize&&"createSessionHandler"in e&&"function"==typeof e.createSessionHandler&&"dispose"in e&&"function"==typeof e.dispose}(e[t])?e[t].disabled?[3,3]:(n=e[t],"object"==typeof(r=n.initialize())&&"then"in r?[4,r]:[3,2]):[3,3];case 1:r=i.sent(),i.label=2;case 2:if(r)return a.set(t,n),[2,n];i.label=3;case 3:return[2,void 0]}}))}))}e.Backend=function t(e){return r(this,void 0,void 0,(function(){var n,r,l,c,u,h,d,p,f;return i(this,(function(i){switch(i.label){case 0:return e?[3,1]:[2,t(["webgl","wasm","cpu"])];case 1:n="string"==typeof e?[e]:e,i.label=2;case 2:i.trys.push([2,7,8,9]),r=o(n),l=r.next(),i.label=3;case 3:return l.done?[3,6]:(c=l.value,(u=a.get(c))?[2,u]:[4,s(c)]);case 4:if(h=i.sent())return[2,h];i.label=5;case 5:return l=r.next(),[3,3];case 6:return[3,9];case 7:return d=i.sent(),p={error:d},[3,9];case 8:try{l&&!l.done&&(f=r.return)&&f.call(r)}finally{if(p)throw p.error}return[7];case 9:throw new Error("no available backend to use")}}))}))}},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{l(r.next(t))}catch(t){o(t)}}function s(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},o=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},s=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(a(arguments[e]));return t};Object.defineProperty(e,"__esModule",{value:!0}),e.ExecutionPlan=void 0;var l=n(3),c=function(t,e){this.op=t,this.node=e},u=function(){function t(t,e,n){this.graph=t,this.profiler=n,this.initialize(e)}return t.prototype.initialize=function(t){var e=this;this.profiler.event("session","ExecutionPlan.initialize",(function(){var n=e.graph.getNodes();if(n.length!==t.length)throw new Error("The size of nodes and OPs do not match.");e._ops=t.map((function(t,e){return new c(t,n[e])})),e.reset(),e._starter=[],e._ops.forEach((function(t,n){var r,i,a=!0;try{for(var s=o(t.node.inputs),l=s.next();!l.done;l=s.next()){var c=l.value;if(!e._values[c]&&-1===e.graph.getInputIndices().indexOf(c)){a=!1;break}}}catch(t){r={error:t}}finally{try{l&&!l.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}a&&e._starter.push(n)}))}))},t.prototype.reset=function(){this._values=this.graph.getValues().map((function(t){return t.tensor}))},t.prototype.execute=function(t,e){var n=this;return this.profiler.event("session","ExecutionPlan.execute",(function(){return r(n,void 0,void 0,(function(){var n,a,c,u,h,d,p,f,m,g=this;return i(this,(function(y){switch(y.label){case 0:if(this.reset(),n=t.createInferenceHandler(),a=this.graph.getInputIndices(),e.length!==a.length)throw new Error("number of input tensors don't match the number of inputs to the model: actual: "+e.length+" expected: "+a.length);e.forEach((function(t,e){var n=a[e];g._values[n]=t})),c=this._starter.slice(0),u=this.graph.getValues(),h=this.graph.getNodes(),d=0,p=function(){var t,e,a,p,m,y;return i(this,(function(v){switch(v.label){case 0:if(t=c[d++],e=f._ops[t],-1!==(a=e.node.inputs.map((function(t){return g._values[t]}))).indexOf(void 0))throw new Error("unresolved input detected: op: "+e.node);return p=a,l.Logger.verbose("ExecPlan","Runing op:"+e.node.name+" ("+p.map((function(t,n){return"'"+e.node.inputs[n]+"': "+t.type+"["+t.dims.join(",")+"]"})).join(", ")+")"),[4,f.profiler.event("node",e.node.name,(function(){return r(g,void 0,void 0,(function(){var t;return i(this,(function(r){if(!(t=e.op).checkInputs(p))throw new Error("invalid inputs detected; op: "+e.node.name);return[2,t.run(n,p)]}))}))}))];case 1:if((m=v.sent()).length!==e.node.outputs.length)throw new Error("the size of output does not match model definition.");return m.forEach((function(t,n){var r=e.node.outputs[n];if(g._values[r])throw new Error("output ["+r+"] already has value: op:"+e.node.name);g._values[r]=t})),y=new Set,m.forEach((function(t,n){var r,i,a,s,l=e.node.outputs[n];try{for(var c=(r=void 0,o(u[l].to)),d=c.next();!d.done;d=c.next()){var p=d.value,f=h[p],m=!0;try{for(var v=(a=void 0,o(f.inputs)),b=v.next();!b.done;b=v.next()){var x=b.value;if(!g._values[x]){m=!1;break}}}catch(t){a={error:t}}finally{try{b&&!b.done&&(s=v.return)&&s.call(v)}finally{if(a)throw a.error}}m&&y.add(p)}}catch(t){r={error:t}}finally{try{d&&!d.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}})),c.push.apply(c,s(y)),[2]}}))},f=this,y.label=1;case 1:return d<c.length?[5,p()]:[3,3];case 2:return y.sent(),[3,1];case 3:return m=[],this.graph.getOutputIndices().forEach((function(t,e){var n=g._values[t];if(void 0===n)throw new Error("required output ["+t+"] does not have value");n.data,m.push(n)})),l.Logger.verbose("ExecPlan","disposing of inferenceHandler"),n.dispose(),[2,m]}}))}))}))},t}();e.ExecutionPlan=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Model=void 0;var r=n(9),i=n(181),o=n(0),a=function(){function t(){}return t.prototype.load=function(t,e){var n=r.onnx.ModelProto.decode(t);if(o.LongUtil.longToNumber(n.irVersion)<3)throw new Error("only support ONNX model with IR_VERSION>=3");this._opsets=n.opsetImport.map((function(t){return{domain:t.domain,version:o.LongUtil.longToNumber(t.version)}})),this._graph=i.Graph.from(n.graph,e)},Object.defineProperty(t.prototype,"graph",{get:function(){return this._graph},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"opsets",{get:function(){return this._opsets},enumerable:!1,configurable:!0}),t}();e.Model=a},function(t,e,n){"use strict";var r=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.Graph=void 0;var i=n(182),o=n(1),a=n(0);e.Graph={from:function(t,e){return new c(t,e)}};var s=function(){function t(t){this._from=void 0,this._to=[],this.tensor=void 0,this.type=void 0,t&&(this.type=a.ProtoUtil.tensorValueTypeFromProto(t.type.tensorType))}return Object.defineProperty(t.prototype,"from",{get:function(){return this._from},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"to",{get:function(){return this._to},enumerable:!1,configurable:!0}),t}(),l=function(t){this.name=t.name,this.opType=t.opType,this.inputs=[],this.outputs=[],this.attributes=new i.Attribute(t.attribute),this.executeNode=!0},c=function(){function t(t,e){if(!t)throw new TypeError("graph is empty");this.buildGraph(t),this.transformGraph(e),this.checkIsAcyclic()}return t.prototype.getInputIndices=function(){return this._allInputIndices},t.prototype.getInputNames=function(){return this._allInputNames},t.prototype.getOutputIndices=function(){return this._allOutputIndices},t.prototype.getOutputNames=function(){return this._allOutputNames},t.prototype.getValues=function(){return this._allData},t.prototype.getNodes=function(){return this._nodes},t.prototype.buildGraph=function(t){var e,n,i,c,u,h,d,p,f,m,g,y,v=new Map;this._allData=[],this._allInputIndices=[],this._allInputNames=[],this._allOutputIndices=[],this._allOutputNames=[],this._nodes=[];var b=new Map;if(!t.input)throw new Error("missing information in graph: input");var x=[];try{for(var _=r(t.input),w=_.next();!w.done;w=_.next()){var S=w.value;if(v.has(S.name))throw new Error("duplicated input name: "+S.name);var T=this._allData.push(new s(S))-1;v.set(S.name,T),x.push(S.name)}}catch(t){e={error:t}}finally{try{w&&!w.done&&(n=_.return)&&n.call(_)}finally{if(e)throw e.error}}if(!t.initializer)throw new Error("missing information in graph: initializer");try{for(var E=r(t.initializer),M=E.next();!M.done;M=E.next()){S=M.value;var C=v.get(S.name);if(void 0===C){var A=new s;A.type={shape:{dims:a.ProtoUtil.tensorDimsFromProto(S.dims)},tensorType:a.ProtoUtil.tensorDataTypeFromProto(S.dataType)},C=this._allData.push(A)-1,v.set(S.name,C)}this._allData[C]._from=-1,this._allData[C].tensor=o.Tensor.fromProto(S)}}catch(t){i={error:t}}finally{try{M&&!M.done&&(c=E.return)&&c.call(E)}finally{if(i)throw i.error}}for(S=0;S<this._allData.length;S++)this._allData[S].tensor||(this._allInputIndices.push(S),this._allInputNames.push(x[S]));if(!t.output)throw new Error("missing information in graph: output");try{for(var k=r(t.output),I=k.next();!I.done;I=k.next()){if(S=I.value,v.has(S.name))throw new Error("duplicated output name: "+S.name);T=this._allData.push(new s(S))-1,v.set(S.name,T),this._allOutputIndices.push(T),this._allOutputNames.push(S.name)}}catch(t){u={error:t}}finally{try{I&&!I.done&&(h=k.return)&&h.call(k)}finally{if(u)throw u.error}}if(!t.node)throw new Error("missing information in graph: node");try{for(var R=r(t.node),P=R.next();!P.done;P=R.next()){if(!(B=P.value).name)for(var N=0;;N++){var O="unnamed_"+B.opType+"_"+N;if(!b.has(O)){B.name=O;break}}if(b.has(B.name))throw new Error("duplicated node name: "+B.name);T=this._nodes.push(new l(B))-1,b.set(B.name,T)}}catch(t){d={error:t}}finally{try{P&&!P.done&&(p=R.return)&&p.call(R)}finally{if(d)throw d.error}}for(S=0;S<this._nodes.length;S++){var D=this._nodes[S];if(!(B=t.node[S]).output)throw new Error("missing output for node: "+B.name);try{for(var L=(f=void 0,r(B.output)),F=L.next();!F.done;F=L.next()){var U=F.value;if(void 0===(V=v.get(U))&&(V=this._allData.push(new s)-1,v.set(U,V)),D.outputs.push(V),void 0!==this._allData[V]._from)throw new Error("multiple nodes output to one data value: "+V);if(this._allData[V]._from=S,"Constant"===B.opType){if(!B.attribute||1!==B.attribute.length||!B.attribute[0].t)throw new Error("missing attributes or missing tensor value in attributes for this Constant operator");if(!B.output||1!==B.output.length)throw new Error("missing output or incorrect number of outputs for this Constant operator");D.outputs.pop(),D.executeNode=!1,this._allData[V]._from=-1,this._allData[V].tensor=o.Tensor.fromProto(B.attribute[0].t)}}}catch(t){f={error:t}}finally{try{F&&!F.done&&(m=L.return)&&m.call(L)}finally{if(f)throw f.error}}}for(S=0;S<this._nodes.length;S++){var B;if(D=this._nodes[S],!(B=t.node[S]).input)throw new Error("missing input for node: "+B.name);try{for(var z=(g=void 0,r(B.input)),j=z.next();!j.done;j=z.next()){var V,W=j.value;if(void 0===(V=v.get(W)))throw new Error("unrecognized input '"+W+"' for node: "+B.name);D.inputs.push(V),this._allData[V]._to.push(S)}}catch(t){g={error:t}}finally{try{j&&!j.done&&(y=z.return)&&y.call(z)}finally{if(g)throw g.error}}}return!0},t.prototype.checkIsAcyclic=function(){var t=this,e=new Set;this._allInputIndices.forEach((function(n){t._allData[n]._to.forEach((function(t){e.add(t)}))}));for(var n=Array.from(e),r=new Array(this._nodes.length).fill("white"),i=function(){var e=n.pop();"gray"===r[e]?r[e]="black":(n.push(e),r[e]="gray",o._nodes[e].outputs.forEach((function(i){var o=t._allData[i];if(void 0!==o.tensor)throw new Error("node outputs should not be initialized");if(o._from!==e)throw new Error("from property of the Value object doesn't match index of Node being processed");o._to.forEach((function(t){if("gray"===r[t])throw new Error("model graph is cyclic");"white"===r[t]&&n.push(t)}))})))},o=this;n.length>0;)i()},t.prototype.transformGraph=function(t){this.removeAllIdentityNodes(),this.removeAllDropoutNodes(),t&&t.transformGraph(this),this.finalizeGraph()},t.prototype.finalizeGraph=function(){for(var t,e=this,n=0,r=function(r){if(!i._nodes[r].executeNode)return n++,i._nodes[r].outputs.forEach((function(t){e._allData[t]._from=-2})),i._nodes.splice(r,1),r--,t=r,"continue";n>0&&(i._nodes[r].inputs.forEach((function(t){var i=e._allData[t]._to.indexOf(r+n);-1!==i&&(e._allData[t]._to[i]=r)})),i._nodes[r].outputs.forEach((function(t){e._allData[t]._from&&e._allData[t]._from===r+n&&(e._allData[t]._from=r)}))),t=r},i=this,o=0;o<this._nodes.length;o++)r(o),o=t;n=0;var a,s=function(t){if(-2===l._allData[t].from&&-1===l._allOutputIndices.indexOf(t+n))return n++,l._allData.splice(t,1),t--,a=t,"continue";if(n>0){var r=-1;void 0!==l._allData[t].from&&-1!==l._allData[t].from?-1!==(r=l._nodes[l._allData[t].from].outputs.indexOf(t+n))&&(l._nodes[l._allData[t].from].outputs[r]=t):-1!==(r=l._allInputIndices.indexOf(t+n))&&(l._allInputIndices[r]=t),l._allData[t].to.forEach((function(i){-1!==(r=e._nodes[i].inputs.indexOf(t+n))&&(e._nodes[i].inputs[r]=t)})),0===l._allData[t].to.length&&-1!==(r=l._allOutputIndices.indexOf(t+n))&&(l._allOutputIndices[r]=t)}a=t},l=this;for(o=0;o<this._allData.length;o++)s(o),o=a},t.prototype.deleteNode=function(t){var e,n,i=this._nodes[t];if(i.inputs.length>1)throw new Error("Node deletion with multiple inputs is not supported. ");if(i.outputs.length>1)for(var o=1;o<i.outputs.length;o++)if(this._allData[i.outputs[o]].to.length>0)throw new Error("Node deletion with more than one output connected to other nodes is not supported. ");i.executeNode=!1;var a=i.inputs[0],s=i.outputs[0],l=this._allData[s].to,c=this._allData[a].to.indexOf(t);if(-1===c)throw new Error("The Value object doesn't have the current Node in it's 'to' property ");this._allData[a].to.splice(c,1),this._allData[s]._to=[];var u=this._allOutputIndices.indexOf(s);if(-1!==u&&(this._allOutputIndices[u]=a),l&&l.length>0)try{for(var h=r(l),d=h.next();!d.done;d=h.next()){var p=d.value,f=this._nodes[p].inputs.indexOf(s);if(-1===f)throw new Error("The Node object doesn't have the output Value in it's 'inputs' property ");this._nodes[p].inputs[f]=a,this._allData[a].to.push(p)}}catch(t){e={error:t}}finally{try{d&&!d.done&&(n=h.return)&&n.call(h)}finally{if(e)throw e.error}}},t.prototype.removeAllDropoutNodes=function(){var t,e,n=0;try{for(var i=r(this._nodes),o=i.next();!o.done;o=i.next()){var a=o.value;if("Dropout"===a.opType){if(1!==a.inputs.length)throw new Error("Dropout nodes should only contain one input. ");if(1!==a.outputs.length&&2!==a.outputs.length)throw new Error("Dropout nodes should contain either 1 or 2 output(s)");if(2===a.outputs.length&&0!==this._allData[a.outputs[1]]._to.length)throw new Error("Dropout nodes's second output should not be referenced by other nodes");this.deleteNode(n)}n++}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},t.prototype.removeAllIdentityNodes=function(){var t,e,n=0;try{for(var i=r(this._nodes),o=i.next();!o.done;o=i.next())"Identity"===o.value.opType&&this.deleteNode(n),n++}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},t}()},function(t,e,n){"use strict";(function(t){var r=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Attribute=void 0;var o=i(n(13)),a=n(9),s=n(1),l=n(0),c=function(){function e(t){var n,i;if(this._attributes=new Map,null!=t){try{for(var o=r(t),a=o.next();!a.done;a=o.next()){var s=a.value;this._attributes.set(s.name,[e.getValue(s),e.getType(s)])}}catch(t){n={error:t}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}if(this._attributes.size<t.length)throw new Error("duplicated attribute names")}}return e.prototype.set=function(t,e,n){this._attributes.set(t,[n,e])},e.prototype.delete=function(t){this._attributes.delete(t)},e.prototype.getFloat=function(t,e){return this.get(t,"float",e)},e.prototype.getInt=function(t,e){return this.get(t,"int",e)},e.prototype.getString=function(t,e){return this.get(t,"string",e)},e.prototype.getTensor=function(t,e){return this.get(t,"tensor",e)},e.prototype.getFloats=function(t,e){return this.get(t,"floats",e)},e.prototype.getInts=function(t,e){return this.get(t,"ints",e)},e.prototype.getStrings=function(t,e){return this.get(t,"strings",e)},e.prototype.getTensors=function(t,e){return this.get(t,"tensors",e)},e.prototype.get=function(t,e,n){var r=this._attributes.get(t);if(void 0===r){if(void 0!==n)return n;throw new Error("required attribute not found: "+t)}if(r[1]!==e)throw new Error("type mismatch: expected "+e+" but got "+r[1]);return r[0]},e.getType=function(t){switch(t.type){case a.onnx.AttributeProto.AttributeType.FLOAT:return"float";case a.onnx.AttributeProto.AttributeType.INT:return"int";case a.onnx.AttributeProto.AttributeType.STRING:return"string";case a.onnx.AttributeProto.AttributeType.TENSOR:return"tensor";case a.onnx.AttributeProto.AttributeType.FLOATS:return"floats";case a.onnx.AttributeProto.AttributeType.INTS:return"ints";case a.onnx.AttributeProto.AttributeType.STRINGS:return"strings";case a.onnx.AttributeProto.AttributeType.TENSORS:return"tensors";default:throw new Error("attribute type is not supported yet: "+a.onnx.AttributeProto.AttributeType[t.type])}},e.getValue=function(e){if(e.type===a.onnx.AttributeProto.AttributeType.GRAPH||e.type===a.onnx.AttributeProto.AttributeType.GRAPHS)throw new Error("graph attribute is not supported yet");var n=this.getValueNoCheck(e);if(e.type===a.onnx.AttributeProto.AttributeType.INT&&o.default.isLong(n))return n.toNumber();if(e.type===a.onnx.AttributeProto.AttributeType.INTS){for(var r=n,i=new Array(r.length),c=0;c<r.length;c++){var u=r[c];i[c]=l.LongUtil.longToNumber(u)}return i}if(e.type===a.onnx.AttributeProto.AttributeType.TENSOR)return s.Tensor.fromProto(n);if(e.type===a.onnx.AttributeProto.AttributeType.TENSORS)return n.map((function(t){return s.Tensor.fromProto(t)}));if(e.type===a.onnx.AttributeProto.AttributeType.STRING){var h=n;return t.from(h.buffer,h.byteOffset,h.byteLength).toString()}return e.type===a.onnx.AttributeProto.AttributeType.STRINGS?n.map((function(e){return t.from(e.buffer,e.byteOffset,e.byteLength).toString()})):n},e.getValueNoCheck=function(t){switch(t.type){case a.onnx.AttributeProto.AttributeType.FLOAT:return t.f;case a.onnx.AttributeProto.AttributeType.INT:return t.i;case a.onnx.AttributeProto.AttributeType.STRING:return t.s;case a.onnx.AttributeProto.AttributeType.TENSOR:return t.t;case a.onnx.AttributeProto.AttributeType.GRAPH:return t.g;case a.onnx.AttributeProto.AttributeType.FLOATS:return t.floats;case a.onnx.AttributeProto.AttributeType.INTS:return t.ints;case a.onnx.AttributeProto.AttributeType.STRINGS:return t.strings;case a.onnx.AttributeProto.AttributeType.TENSORS:return t.tensors;case a.onnx.AttributeProto.AttributeType.GRAPHS:return t.graphs;default:throw new Error("unsupported attribute type: "+a.onnx.AttributeProto.AttributeType[t.type])}},e}();e.Attribute=c}).call(this,n(12).Buffer)}])},module.exports=e()},730:(t,e,n)=>{"use strict";var r=n(43),i=n(67);function o(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,s={};function l(t,e){c(t,e),c(t+"Capture",e)}function c(t,e){for(s[t]=e,t=0;t<e.length;t++)a.add(e[t])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},f={};function m(t,e,n,r,i,o,a){this.acceptsBooleans=2===e||3===e||4===e,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=a}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(t){g[t]=new m(t,0,!1,t,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(t){var e=t[0];g[e]=new m(e,1,!1,t[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(t){g[t]=new m(t,2,!1,t.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(t){g[t]=new m(t,2,!1,t,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(t){g[t]=new m(t,3,!1,t.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(t){g[t]=new m(t,3,!0,t,null,!1,!1)})),["capture","download"].forEach((function(t){g[t]=new m(t,4,!1,t,null,!1,!1)})),["cols","rows","size","span"].forEach((function(t){g[t]=new m(t,6,!1,t,null,!1,!1)})),["rowSpan","start"].forEach((function(t){g[t]=new m(t,5,!1,t.toLowerCase(),null,!1,!1)}));var y=/[\-:]([a-z])/g;function v(t){return t[1].toUpperCase()}function b(t,e,n,r){var i=g.hasOwnProperty(e)?g[e]:null;(null!==i?0!==i.type:r||!(2<e.length)||"o"!==e[0]&&"O"!==e[0]||"n"!==e[1]&&"N"!==e[1])&&(function(t,e,n,r){if(null===e||"undefined"===typeof e||function(t,e,n,r){if(null!==n&&0===n.type)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(t=t.toLowerCase().slice(0,5))&&"aria-"!==t);default:return!1}}(t,e,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!e;case 4:return!1===e;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}(e,n,i,r)&&(n=null),r||null===i?function(t){return!!h.call(f,t)||!h.call(p,t)&&(d.test(t)?f[t]=!0:(p[t]=!0,!1))}(e)&&(null===n?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=null===n?3!==i.type&&"":n:(e=i.attributeName,r=i.attributeNamespace,null===n?t.removeAttribute(e):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(t){var e=t.replace(y,v);g[e]=new m(e,1,!1,t,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(t){var e=t.replace(y,v);g[e]=new m(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(t){var e=t.replace(y,v);g[e]=new m(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(t){g[t]=new m(t,1,!1,t.toLowerCase(),null,!1,!1)})),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(t){g[t]=new m(t,1,!1,t.toLowerCase(),null,!0,!0)}));var x=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_=Symbol.for("react.element"),w=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),M=Symbol.for("react.provider"),C=Symbol.for("react.context"),A=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),I=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),P=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var N=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var O=Symbol.iterator;function D(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=O&&t[O]||t["@@iterator"])?t:null}var L,F=Object.assign;function U(t){if(void 0===L)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);L=e&&e[1]||""}return"\n"+L+t}var B=!1;function z(t,e){if(!t||B)return"";B=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var i=c.stack.split("\n"),o=r.stack.split("\n"),a=i.length-1,s=o.length-1;1<=a&&0<=s&&i[a]!==o[s];)s--;for(;1<=a&&0<=s;a--,s--)if(i[a]!==o[s]){if(1!==a||1!==s)do{if(a--,0>--s||i[a]!==o[s]){var l="\n"+i[a].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}}while(1<=a&&0<=s);break}}}finally{B=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?U(t):""}function j(t){switch(t.tag){case 5:return U(t.type);case 16:return U("Lazy");case 13:return U("Suspense");case 19:return U("SuspenseList");case 0:case 2:case 15:return t=z(t.type,!1);case 11:return t=z(t.type.render,!1);case 1:return t=z(t.type,!0);default:return""}}function V(t){if(null==t)return null;if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t;switch(t){case S:return"Fragment";case w:return"Portal";case E:return"Profiler";case T:return"StrictMode";case k:return"Suspense";case I:return"SuspenseList"}if("object"===typeof t)switch(t.$$typeof){case C:return(t.displayName||"Context")+".Consumer";case M:return(t._context.displayName||"Context")+".Provider";case A:var e=t.render;return(t=t.displayName)||(t=""!==(t=e.displayName||e.name||"")?"ForwardRef("+t+")":"ForwardRef"),t;case R:return null!==(e=t.displayName||null)?e:V(t.type)||"Memo";case P:e=t._payload,t=t._init;try{return V(t(e))}catch(n){}}return null}function W(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=(t=e.render).displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return V(e);case 8:return e===T?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e}return null}function G(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":case"object":return t;default:return""}}function H(t){var e=t.type;return(t=t.nodeName)&&"input"===t.toLowerCase()&&("checkbox"===e||"radio"===e)}function q(t){t._valueTracker||(t._valueTracker=function(t){var e=H(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(t){r=""+t,o.call(this,t)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(t){r=""+t},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}(t))}function X(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=H(t)?t.checked?"true":"false":t.value),(t=r)!==n&&(e.setValue(t),!0)}function Y(t){if("undefined"===typeof(t=t||("undefined"!==typeof document?document:void 0)))return null;try{return t.activeElement||t.body}catch(e){return t.body}}function K(t,e){var n=e.checked;return F({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:t._wrapperState.initialChecked})}function Z(t,e){var n=null==e.defaultValue?"":e.defaultValue,r=null!=e.checked?e.checked:e.defaultChecked;n=G(null!=e.value?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===e.type||"radio"===e.type?null!=e.checked:null!=e.value}}function J(t,e){null!=(e=e.checked)&&b(t,"checked",e,!1)}function Q(t,e){J(t,e);var n=G(e.value),r=e.type;if(null!=n)"number"===r?(0===n&&""===t.value||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if("submit"===r||"reset"===r)return void t.removeAttribute("value");e.hasOwnProperty("value")?tt(t,e.type,n):e.hasOwnProperty("defaultValue")&&tt(t,e.type,G(e.defaultValue)),null==e.checked&&null!=e.defaultChecked&&(t.defaultChecked=!!e.defaultChecked)}function $(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!("submit"!==r&&"reset"!==r||void 0!==e.value&&null!==e.value))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}""!==(n=t.name)&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,""!==n&&(t.name=n)}function tt(t,e,n){"number"===e&&Y(t.ownerDocument)===t||(null==n?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var et=Array.isArray;function nt(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+G(n),e=null,i=0;i<t.length;i++){if(t[i].value===n)return t[i].selected=!0,void(r&&(t[i].defaultSelected=!0));null!==e||t[i].disabled||(e=t[i])}null!==e&&(e.selected=!0)}}function rt(t,e){if(null!=e.dangerouslySetInnerHTML)throw Error(o(91));return F({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function it(t,e){var n=e.value;if(null==n){if(n=e.children,e=e.defaultValue,null!=n){if(null!=e)throw Error(o(92));if(et(n)){if(1<n.length)throw Error(o(93));n=n[0]}e=n}null==e&&(e=""),n=e}t._wrapperState={initialValue:G(n)}}function ot(t,e){var n=G(e.value),r=G(e.defaultValue);null!=n&&((n=""+n)!==t.value&&(t.value=n),null==e.defaultValue&&t.defaultValue!==n&&(t.defaultValue=n)),null!=r&&(t.defaultValue=""+r)}function at(t){var e=t.textContent;e===t._wrapperState.initialValue&&""!==e&&null!==e&&(t.value=e)}function st(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lt(t,e){return null==t||"http://www.w3.org/1999/xhtml"===t?st(e):"http://www.w3.org/2000/svg"===t&&"foreignObject"===e?"http://www.w3.org/1999/xhtml":t}var ct,ut,ht=(ut=function(t,e){if("http://www.w3.org/2000/svg"!==t.namespaceURI||"innerHTML"in t)t.innerHTML=e;else{for((ct=ct||document.createElement("div")).innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ct.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,e,n,r){MSApp.execUnsafeLocalFunction((function(){return ut(t,e)}))}:ut);function dt(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&3===n.nodeType)return void(n.nodeValue=e)}t.textContent=e}var pt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ft=["Webkit","ms","Moz","O"];function mt(t,e,n){return null==e||"boolean"===typeof e||""===e?"":n||"number"!==typeof e||0===e||pt.hasOwnProperty(t)&&pt[t]?(""+e).trim():e+"px"}function gt(t,e){for(var n in t=t.style,e)if(e.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=mt(n,e[n],r);"float"===n&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}Object.keys(pt).forEach((function(t){ft.forEach((function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),pt[e]=pt[t]}))}));var yt=F({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function vt(t,e){if(e){if(yt[t]&&(null!=e.children||null!=e.dangerouslySetInnerHTML))throw Error(o(137,t));if(null!=e.dangerouslySetInnerHTML){if(null!=e.children)throw Error(o(60));if("object"!==typeof e.dangerouslySetInnerHTML||!("__html"in e.dangerouslySetInnerHTML))throw Error(o(61))}if(null!=e.style&&"object"!==typeof e.style)throw Error(o(62))}}function bt(t,e){if(-1===t.indexOf("-"))return"string"===typeof e.is;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xt=null;function _t(t){return(t=t.target||t.srcElement||window).correspondingUseElement&&(t=t.correspondingUseElement),3===t.nodeType?t.parentNode:t}var wt=null,St=null,Tt=null;function Et(t){if(t=bi(t)){if("function"!==typeof wt)throw Error(o(280));var e=t.stateNode;e&&(e=_i(e),wt(t.stateNode,t.type,e))}}function Mt(t){St?Tt?Tt.push(t):Tt=[t]:St=t}function Ct(){if(St){var t=St,e=Tt;if(Tt=St=null,Et(t),e)for(t=0;t<e.length;t++)Et(e[t])}}function At(t,e){return t(e)}function kt(){}var It=!1;function Rt(t,e,n){if(It)return t(e,n);It=!0;try{return At(t,e,n)}finally{It=!1,(null!==St||null!==Tt)&&(kt(),Ct())}}function Pt(t,e){var n=t.stateNode;if(null===n)return null;var r=_i(n);if(null===r)return null;n=r[e];t:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(t=t.type)||"input"===t||"select"===t||"textarea"===t)),t=!r;break t;default:t=!1}if(t)return null;if(n&&"function"!==typeof n)throw Error(o(231,e,typeof n));return n}var Nt=!1;if(u)try{var Ot={};Object.defineProperty(Ot,"passive",{get:function(){Nt=!0}}),window.addEventListener("test",Ot,Ot),window.removeEventListener("test",Ot,Ot)}catch(ut){Nt=!1}function Dt(t,e,n,r,i,o,a,s,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(u){this.onError(u)}}var Lt=!1,Ft=null,Ut=!1,Bt=null,zt={onError:function(t){Lt=!0,Ft=t}};function jt(t,e,n,r,i,o,a,s,l){Lt=!1,Ft=null,Dt.apply(zt,arguments)}function Vt(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do{0!==(4098&(e=t).flags)&&(n=e.return),t=e.return}while(t)}return 3===e.tag?n:null}function Wt(t){if(13===t.tag){var e=t.memoizedState;if(null===e&&(null!==(t=t.alternate)&&(e=t.memoizedState)),null!==e)return e.dehydrated}return null}function Gt(t){if(Vt(t)!==t)throw Error(o(188))}function Ht(t){return null!==(t=function(t){var e=t.alternate;if(!e){if(null===(e=Vt(t)))throw Error(o(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(null===i)break;var a=i.alternate;if(null===a){if(null!==(r=i.return)){n=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===n)return Gt(i),t;if(a===r)return Gt(i),e;a=a.sibling}throw Error(o(188))}if(n.return!==r.return)n=i,r=a;else{for(var s=!1,l=i.child;l;){if(l===n){s=!0,n=i,r=a;break}if(l===r){s=!0,r=i,n=a;break}l=l.sibling}if(!s){for(l=a.child;l;){if(l===n){s=!0,n=a,r=i;break}if(l===r){s=!0,r=a,n=i;break}l=l.sibling}if(!s)throw Error(o(189))}}if(n.alternate!==r)throw Error(o(190))}if(3!==n.tag)throw Error(o(188));return n.stateNode.current===n?t:e}(t))?qt(t):null}function qt(t){if(5===t.tag||6===t.tag)return t;for(t=t.child;null!==t;){var e=qt(t);if(null!==e)return e;t=t.sibling}return null}var Xt=i.unstable_scheduleCallback,Yt=i.unstable_cancelCallback,Kt=i.unstable_shouldYield,Zt=i.unstable_requestPaint,Jt=i.unstable_now,Qt=i.unstable_getCurrentPriorityLevel,$t=i.unstable_ImmediatePriority,te=i.unstable_UserBlockingPriority,ee=i.unstable_NormalPriority,ne=i.unstable_LowPriority,re=i.unstable_IdlePriority,ie=null,oe=null;var ae=Math.clz32?Math.clz32:function(t){return t>>>=0,0===t?32:31-(se(t)/le|0)|0},se=Math.log,le=Math.LN2;var ce=64,ue=4194304;function he(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&t;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&t;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function de(t,e){var n=t.pendingLanes;if(0===n)return 0;var r=0,i=t.suspendedLanes,o=t.pingedLanes,a=268435455&n;if(0!==a){var s=a&~i;0!==s?r=he(s):0!==(o&=a)&&(r=he(o))}else 0!==(a=n&~i)?r=he(a):0!==o&&(r=he(o));if(0===r)return 0;if(0!==e&&e!==r&&0===(e&i)&&((i=r&-r)>=(o=e&-e)||16===i&&0!==(4194240&o)))return e;if(0!==(4&r)&&(r|=16&n),0!==(e=t.entangledLanes))for(t=t.entanglements,e&=r;0<e;)i=1<<(n=31-ae(e)),r|=t[n],e&=~i;return r}function pe(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;default:return-1}}function fe(t){return 0!==(t=-1073741825&t.pendingLanes)?t:1073741824&t?1073741824:0}function me(){var t=ce;return 0===(4194240&(ce<<=1))&&(ce=64),t}function ge(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function ye(t,e,n){t.pendingLanes|=e,536870912!==e&&(t.suspendedLanes=0,t.pingedLanes=0),(t=t.eventTimes)[e=31-ae(e)]=n}function ve(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-ae(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var be=0;function xe(t){return 1<(t&=-t)?4<t?0!==(268435455&t)?16:536870912:4:1}var _e,we,Se,Te,Ee,Me=!1,Ce=[],Ae=null,ke=null,Ie=null,Re=new Map,Pe=new Map,Ne=[],Oe="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function De(t,e){switch(t){case"focusin":case"focusout":Ae=null;break;case"dragenter":case"dragleave":ke=null;break;case"mouseover":case"mouseout":Ie=null;break;case"pointerover":case"pointerout":Re.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pe.delete(e.pointerId)}}function Le(t,e,n,r,i,o){return null===t||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},null!==e&&(null!==(e=bi(e))&&we(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,null!==i&&-1===e.indexOf(i)&&e.push(i),t)}function Fe(t){var e=vi(t.target);if(null!==e){var n=Vt(e);if(null!==n)if(13===(e=n.tag)){if(null!==(e=Wt(n)))return t.blockedOn=e,void Ee(t.priority,(function(){Se(n)}))}else if(3===e&&n.stateNode.current.memoizedState.isDehydrated)return void(t.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}t.blockedOn=null}function Ue(t){if(null!==t.blockedOn)return!1;for(var e=t.targetContainers;0<e.length;){var n=Ke(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(null!==n)return null!==(e=bi(n))&&we(e),t.blockedOn=n,!1;var r=new(n=t.nativeEvent).constructor(n.type,n);xt=r,n.target.dispatchEvent(r),xt=null,e.shift()}return!0}function Be(t,e,n){Ue(t)&&n.delete(e)}function ze(){Me=!1,null!==Ae&&Ue(Ae)&&(Ae=null),null!==ke&&Ue(ke)&&(ke=null),null!==Ie&&Ue(Ie)&&(Ie=null),Re.forEach(Be),Pe.forEach(Be)}function je(t,e){t.blockedOn===e&&(t.blockedOn=null,Me||(Me=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,ze)))}function Ve(t){function e(e){return je(e,t)}if(0<Ce.length){je(Ce[0],t);for(var n=1;n<Ce.length;n++){var r=Ce[n];r.blockedOn===t&&(r.blockedOn=null)}}for(null!==Ae&&je(Ae,t),null!==ke&&je(ke,t),null!==Ie&&je(Ie,t),Re.forEach(e),Pe.forEach(e),n=0;n<Ne.length;n++)(r=Ne[n]).blockedOn===t&&(r.blockedOn=null);for(;0<Ne.length&&null===(n=Ne[0]).blockedOn;)Fe(n),null===n.blockedOn&&Ne.shift()}var We=x.ReactCurrentBatchConfig,Ge=!0;function He(t,e,n,r){var i=be,o=We.transition;We.transition=null;try{be=1,Xe(t,e,n,r)}finally{be=i,We.transition=o}}function qe(t,e,n,r){var i=be,o=We.transition;We.transition=null;try{be=4,Xe(t,e,n,r)}finally{be=i,We.transition=o}}function Xe(t,e,n,r){if(Ge){var i=Ke(t,e,n,r);if(null===i)Gr(t,e,r,Ye,n),De(t,r);else if(function(t,e,n,r,i){switch(e){case"focusin":return Ae=Le(Ae,t,e,n,r,i),!0;case"dragenter":return ke=Le(ke,t,e,n,r,i),!0;case"mouseover":return Ie=Le(Ie,t,e,n,r,i),!0;case"pointerover":var o=i.pointerId;return Re.set(o,Le(Re.get(o)||null,t,e,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,Pe.set(o,Le(Pe.get(o)||null,t,e,n,r,i)),!0}return!1}(i,t,e,n,r))r.stopPropagation();else if(De(t,r),4&e&&-1<Oe.indexOf(t)){for(;null!==i;){var o=bi(i);if(null!==o&&_e(o),null===(o=Ke(t,e,n,r))&&Gr(t,e,r,Ye,n),o===i)break;i=o}null!==i&&r.stopPropagation()}else Gr(t,e,r,null,n)}}var Ye=null;function Ke(t,e,n,r){if(Ye=null,null!==(t=vi(t=_t(r))))if(null===(e=Vt(t)))t=null;else if(13===(n=e.tag)){if(null!==(t=Wt(e)))return t;t=null}else if(3===n){if(e.stateNode.current.memoizedState.isDehydrated)return 3===e.tag?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Ye=t,null}function Ze(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Qt()){case $t:return 1;case te:return 4;case ee:case ne:return 16;case re:return 536870912;default:return 16}default:return 16}}var Je=null,Qe=null,$e=null;function tn(){if($e)return $e;var t,e,n=Qe,r=n.length,i="value"in Je?Je.value:Je.textContent,o=i.length;for(t=0;t<r&&n[t]===i[t];t++);var a=r-t;for(e=1;e<=a&&n[r-e]===i[o-e];e++);return $e=i.slice(t,1<e?1-e:void 0)}function en(t){var e=t.keyCode;return"charCode"in t?0===(t=t.charCode)&&13===e&&(t=13):t=e,10===t&&(t=13),32<=t||13===t?t:0}function nn(){return!0}function rn(){return!1}function on(t){function e(e,n,r,i,o){for(var a in this._reactName=e,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null,t)t.hasOwnProperty(a)&&(e=t[a],this[a]=e?e(i):i[a]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return F(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():"unknown"!==typeof t.returnValue&&(t.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():"unknown"!==typeof t.cancelBubble&&(t.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),e}var an,sn,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=on(cn),hn=F({},cn,{view:0,detail:0}),dn=on(hn),pn=F({},hn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:En,button:0,buttons:0,relatedTarget:function(t){return void 0===t.relatedTarget?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ln&&(ln&&"mousemove"===t.type?(an=t.screenX-ln.screenX,sn=t.screenY-ln.screenY):sn=an=0,ln=t),an)},movementY:function(t){return"movementY"in t?t.movementY:sn}}),fn=on(pn),mn=on(F({},pn,{dataTransfer:0})),gn=on(F({},hn,{relatedTarget:0})),yn=on(F({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),vn=F({},cn,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),bn=on(vn),xn=on(F({},cn,{data:0})),_n={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Tn(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):!!(t=Sn[t])&&!!e[t]}function En(){return Tn}var Mn=F({},hn,{key:function(t){if(t.key){var e=_n[t.key]||t.key;if("Unidentified"!==e)return e}return"keypress"===t.type?13===(t=en(t))?"Enter":String.fromCharCode(t):"keydown"===t.type||"keyup"===t.type?wn[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:En,charCode:function(t){return"keypress"===t.type?en(t):0},keyCode:function(t){return"keydown"===t.type||"keyup"===t.type?t.keyCode:0},which:function(t){return"keypress"===t.type?en(t):"keydown"===t.type||"keyup"===t.type?t.keyCode:0}}),Cn=on(Mn),An=on(F({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),kn=on(F({},hn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:En})),In=on(F({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Rn=F({},pn,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Pn=on(Rn),Nn=[9,13,27,32],On=u&&"CompositionEvent"in window,Dn=null;u&&"documentMode"in document&&(Dn=document.documentMode);var Ln=u&&"TextEvent"in window&&!Dn,Fn=u&&(!On||Dn&&8<Dn&&11>=Dn),Un=String.fromCharCode(32),Bn=!1;function zn(t,e){switch(t){case"keyup":return-1!==Nn.indexOf(e.keyCode);case"keydown":return 229!==e.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function jn(t){return"object"===typeof(t=t.detail)&&"data"in t?t.data:null}var Vn=!1;var Wn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gn(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return"input"===e?!!Wn[t.type]:"textarea"===e}function Hn(t,e,n,r){Mt(r),0<(e=qr(e,"onChange")).length&&(n=new un("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var qn=null,Xn=null;function Yn(t){Ur(t,0)}function Kn(t){if(X(xi(t)))return t}function Zn(t,e){if("change"===t)return e}var Jn=!1;if(u){var Qn;if(u){var $n="oninput"in document;if(!$n){var tr=document.createElement("div");tr.setAttribute("oninput","return;"),$n="function"===typeof tr.oninput}Qn=$n}else Qn=!1;Jn=Qn&&(!document.documentMode||9<document.documentMode)}function er(){qn&&(qn.detachEvent("onpropertychange",nr),Xn=qn=null)}function nr(t){if("value"===t.propertyName&&Kn(Xn)){var e=[];Hn(e,Xn,t,_t(t)),Rt(Yn,e)}}function rr(t,e,n){"focusin"===t?(er(),Xn=n,(qn=e).attachEvent("onpropertychange",nr)):"focusout"===t&&er()}function ir(t){if("selectionchange"===t||"keyup"===t||"keydown"===t)return Kn(Xn)}function or(t,e){if("click"===t)return Kn(e)}function ar(t,e){if("input"===t||"change"===t)return Kn(e)}var sr="function"===typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t===1/e)||t!==t&&e!==e};function lr(t,e){if(sr(t,e))return!0;if("object"!==typeof t||null===t||"object"!==typeof e||null===e)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!h.call(e,i)||!sr(t[i],e[i]))return!1}return!0}function cr(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function ur(t,e){var n,r=cr(t);for(t=0;r;){if(3===r.nodeType){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}t:{for(;r;){if(r.nextSibling){r=r.nextSibling;break t}r=r.parentNode}r=void 0}r=cr(r)}}function hr(t,e){return!(!t||!e)&&(t===e||(!t||3!==t.nodeType)&&(e&&3===e.nodeType?hr(t,e.parentNode):"contains"in t?t.contains(e):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(e))))}function dr(){for(var t=window,e=Y();e instanceof t.HTMLIFrameElement;){try{var n="string"===typeof e.contentWindow.location.href}catch(r){n=!1}if(!n)break;e=Y((t=e.contentWindow).document)}return e}function pr(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&("input"===e&&("text"===t.type||"search"===t.type||"tel"===t.type||"url"===t.type||"password"===t.type)||"textarea"===e||"true"===t.contentEditable)}function fr(t){var e=dr(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&hr(n.ownerDocument.documentElement,n)){if(null!==r&&pr(n))if(e=r.start,void 0===(t=r.end)&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if((t=(e=n.ownerDocument||document)&&e.defaultView||window).getSelection){t=t.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=void 0===r.end?o:Math.min(r.end,i),!t.extend&&o>r&&(i=r,r=o,o=i),i=ur(n,o);var a=ur(n,r);i&&a&&(1!==t.rangeCount||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&((e=e.createRange()).setStart(i.node,i.offset),t.removeAllRanges(),o>r?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}for(e=[],t=n;t=t.parentNode;)1===t.nodeType&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<e.length;n++)(t=e[n]).element.scrollLeft=t.left,t.element.scrollTop=t.top}}var mr=u&&"documentMode"in document&&11>=document.documentMode,gr=null,yr=null,vr=null,br=!1;function xr(t,e,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==gr||gr!==Y(r)||("selectionStart"in(r=gr)&&pr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},vr&&lr(vr,r)||(vr=r,0<(r=qr(yr,"onSelect")).length&&(e=new un("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=gr)))}function _r(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var wr={animationend:_r("Animation","AnimationEnd"),animationiteration:_r("Animation","AnimationIteration"),animationstart:_r("Animation","AnimationStart"),transitionend:_r("Transition","TransitionEnd")},Sr={},Tr={};function Er(t){if(Sr[t])return Sr[t];if(!wr[t])return t;var e,n=wr[t];for(e in n)if(n.hasOwnProperty(e)&&e in Tr)return Sr[t]=n[e];return t}u&&(Tr=document.createElement("div").style,"AnimationEvent"in window||(delete wr.animationend.animation,delete wr.animationiteration.animation,delete wr.animationstart.animation),"TransitionEvent"in window||delete wr.transitionend.transition);var Mr=Er("animationend"),Cr=Er("animationiteration"),Ar=Er("animationstart"),kr=Er("transitionend"),Ir=new Map,Rr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Pr(t,e){Ir.set(t,e),l(e,[t])}for(var Nr=0;Nr<Rr.length;Nr++){var Or=Rr[Nr];Pr(Or.toLowerCase(),"on"+(Or[0].toUpperCase()+Or.slice(1)))}Pr(Mr,"onAnimationEnd"),Pr(Cr,"onAnimationIteration"),Pr(Ar,"onAnimationStart"),Pr("dblclick","onDoubleClick"),Pr("focusin","onFocus"),Pr("focusout","onBlur"),Pr(kr,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Dr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Lr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Dr));function Fr(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,function(t,e,n,r,i,a,s,l,c){if(jt.apply(this,arguments),Lt){if(!Lt)throw Error(o(198));var u=Ft;Lt=!1,Ft=null,Ut||(Ut=!0,Bt=u)}}(r,e,void 0,t),t.currentTarget=null}function Ur(t,e){e=0!==(4&e);for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;t:{var o=void 0;if(e)for(var a=r.length-1;0<=a;a--){var s=r[a],l=s.instance,c=s.currentTarget;if(s=s.listener,l!==o&&i.isPropagationStopped())break t;Fr(i,s,c),o=l}else for(a=0;a<r.length;a++){if(l=(s=r[a]).instance,c=s.currentTarget,s=s.listener,l!==o&&i.isPropagationStopped())break t;Fr(i,s,c),o=l}}}if(Ut)throw t=Bt,Ut=!1,Bt=null,t}function Br(t,e){var n=e[mi];void 0===n&&(n=e[mi]=new Set);var r=t+"__bubble";n.has(r)||(Wr(e,t,2,!1),n.add(r))}function zr(t,e,n){var r=0;e&&(r|=4),Wr(n,t,r,e)}var jr="_reactListening"+Math.random().toString(36).slice(2);function Vr(t){if(!t[jr]){t[jr]=!0,a.forEach((function(e){"selectionchange"!==e&&(Lr.has(e)||zr(e,!1,t),zr(e,!0,t))}));var e=9===t.nodeType?t:t.ownerDocument;null===e||e[jr]||(e[jr]=!0,zr("selectionchange",!1,e))}}function Wr(t,e,n,r){switch(Ze(e)){case 1:var i=He;break;case 4:i=qe;break;default:i=Xe}n=i.bind(null,e,n,t),i=void 0,!Nt||"touchstart"!==e&&"touchmove"!==e&&"wheel"!==e||(i=!0),r?void 0!==i?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):void 0!==i?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Gr(t,e,n,r,i){var o=r;if(0===(1&e)&&0===(2&e)&&null!==r)t:for(;;){if(null===r)return;var a=r.tag;if(3===a||4===a){var s=r.stateNode.containerInfo;if(s===i||8===s.nodeType&&s.parentNode===i)break;if(4===a)for(a=r.return;null!==a;){var l=a.tag;if((3===l||4===l)&&((l=a.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;a=a.return}for(;null!==s;){if(null===(a=vi(s)))return;if(5===(l=a.tag)||6===l){r=o=a;continue t}s=s.parentNode}}r=r.return}Rt((function(){var r=o,i=_t(n),a=[];t:{var s=Ir.get(t);if(void 0!==s){var l=un,c=t;switch(t){case"keypress":if(0===en(n))break t;case"keydown":case"keyup":l=Cn;break;case"focusin":c="focus",l=gn;break;case"focusout":c="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=fn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=kn;break;case Mr:case Cr:case Ar:l=yn;break;case kr:l=In;break;case"scroll":l=dn;break;case"wheel":l=Pn;break;case"copy":case"cut":case"paste":l=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=An}var u=0!==(4&e),h=!u&&"scroll"===t,d=u?null!==s?s+"Capture":null:s;u=[];for(var p,f=r;null!==f;){var m=(p=f).stateNode;if(5===p.tag&&null!==m&&(p=m,null!==d&&(null!=(m=Pt(f,d))&&u.push(Hr(f,m,p)))),h)break;f=f.return}0<u.length&&(s=new l(s,c,null,n,i),a.push({event:s,listeners:u}))}}if(0===(7&e)){if(l="mouseout"===t||"pointerout"===t,(!(s="mouseover"===t||"pointerover"===t)||n===xt||!(c=n.relatedTarget||n.fromElement)||!vi(c)&&!c[fi])&&(l||s)&&(s=i.window===i?i:(s=i.ownerDocument)?s.defaultView||s.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?vi(c):null)&&(c!==(h=Vt(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(u=fn,m="onMouseLeave",d="onMouseEnter",f="mouse","pointerout"!==t&&"pointerover"!==t||(u=An,m="onPointerLeave",d="onPointerEnter",f="pointer"),h=null==l?s:xi(l),p=null==c?s:xi(c),(s=new u(m,f+"leave",l,n,i)).target=h,s.relatedTarget=p,m=null,vi(i)===r&&((u=new u(d,f+"enter",c,n,i)).target=p,u.relatedTarget=h,m=u),h=m,l&&c)t:{for(d=c,f=0,p=u=l;p;p=Xr(p))f++;for(p=0,m=d;m;m=Xr(m))p++;for(;0<f-p;)u=Xr(u),f--;for(;0<p-f;)d=Xr(d),p--;for(;f--;){if(u===d||null!==d&&u===d.alternate)break t;u=Xr(u),d=Xr(d)}u=null}else u=null;null!==l&&Yr(a,s,l,u,!1),null!==c&&null!==h&&Yr(a,h,c,u,!0)}if("select"===(l=(s=r?xi(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===l&&"file"===s.type)var g=Zn;else if(Gn(s))if(Jn)g=ar;else{g=ir;var y=rr}else(l=s.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(g=or);switch(g&&(g=g(t,r))?Hn(a,g,n,i):(y&&y(t,s,r),"focusout"===t&&(y=s._wrapperState)&&y.controlled&&"number"===s.type&&tt(s,"number",s.value)),y=r?xi(r):window,t){case"focusin":(Gn(y)||"true"===y.contentEditable)&&(gr=y,yr=r,vr=null);break;case"focusout":vr=yr=gr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,xr(a,n,i);break;case"selectionchange":if(mr)break;case"keydown":case"keyup":xr(a,n,i)}var v;if(On)t:{switch(t){case"compositionstart":var b="onCompositionStart";break t;case"compositionend":b="onCompositionEnd";break t;case"compositionupdate":b="onCompositionUpdate";break t}b=void 0}else Vn?zn(t,n)&&(b="onCompositionEnd"):"keydown"===t&&229===n.keyCode&&(b="onCompositionStart");b&&(Fn&&"ko"!==n.locale&&(Vn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Vn&&(v=tn()):(Qe="value"in(Je=i)?Je.value:Je.textContent,Vn=!0)),0<(y=qr(r,b)).length&&(b=new xn(b,t,null,n,i),a.push({event:b,listeners:y}),v?b.data=v:null!==(v=jn(n))&&(b.data=v))),(v=Ln?function(t,e){switch(t){case"compositionend":return jn(e);case"keypress":return 32!==e.which?null:(Bn=!0,Un);case"textInput":return(t=e.data)===Un&&Bn?null:t;default:return null}}(t,n):function(t,e){if(Vn)return"compositionend"===t||!On&&zn(t,e)?(t=tn(),$e=Qe=Je=null,Vn=!1,t):null;switch(t){case"paste":default:return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Fn&&"ko"!==e.locale?null:e.data}}(t,n))&&(0<(r=qr(r,"onBeforeInput")).length&&(i=new xn("onBeforeInput","beforeinput",null,n,i),a.push({event:i,listeners:r}),i.data=v))}Ur(a,e)}))}function Hr(t,e,n){return{instance:t,listener:e,currentTarget:n}}function qr(t,e){for(var n=e+"Capture",r=[];null!==t;){var i=t,o=i.stateNode;5===i.tag&&null!==o&&(i=o,null!=(o=Pt(t,n))&&r.unshift(Hr(t,o,i)),null!=(o=Pt(t,e))&&r.push(Hr(t,o,i))),t=t.return}return r}function Xr(t){if(null===t)return null;do{t=t.return}while(t&&5!==t.tag);return t||null}function Yr(t,e,n,r,i){for(var o=e._reactName,a=[];null!==n&&n!==r;){var s=n,l=s.alternate,c=s.stateNode;if(null!==l&&l===r)break;5===s.tag&&null!==c&&(s=c,i?null!=(l=Pt(n,o))&&a.unshift(Hr(n,l,s)):i||null!=(l=Pt(n,o))&&a.push(Hr(n,l,s))),n=n.return}0!==a.length&&t.push({event:e,listeners:a})}var Kr=/\r\n?/g,Zr=/\u0000|\uFFFD/g;function Jr(t){return("string"===typeof t?t:""+t).replace(Kr,"\n").replace(Zr,"")}function Qr(t,e,n){if(e=Jr(e),Jr(t)!==e&&n)throw Error(o(425))}function $r(){}var ti=null,ei=null;function ni(t,e){return"textarea"===t||"noscript"===t||"string"===typeof e.children||"number"===typeof e.children||"object"===typeof e.dangerouslySetInnerHTML&&null!==e.dangerouslySetInnerHTML&&null!=e.dangerouslySetInnerHTML.__html}var ri="function"===typeof setTimeout?setTimeout:void 0,ii="function"===typeof clearTimeout?clearTimeout:void 0,oi="function"===typeof Promise?Promise:void 0,ai="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof oi?function(t){return oi.resolve(null).then(t).catch(si)}:ri;function si(t){setTimeout((function(){throw t}))}function li(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return t.removeChild(i),void Ve(e);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);Ve(e)}function ci(t){for(;null!=t;t=t.nextSibling){var e=t.nodeType;if(1===e||3===e)break;if(8===e){if("$"===(e=t.data)||"$!"===e||"$?"===e)break;if("/$"===e)return null}}return t}function ui(t){t=t.previousSibling;for(var e=0;t;){if(8===t.nodeType){var n=t.data;if("$"===n||"$!"===n||"$?"===n){if(0===e)return t;e--}else"/$"===n&&e++}t=t.previousSibling}return null}var hi=Math.random().toString(36).slice(2),di="__reactFiber$"+hi,pi="__reactProps$"+hi,fi="__reactContainer$"+hi,mi="__reactEvents$"+hi,gi="__reactListeners$"+hi,yi="__reactHandles$"+hi;function vi(t){var e=t[di];if(e)return e;for(var n=t.parentNode;n;){if(e=n[fi]||n[di]){if(n=e.alternate,null!==e.child||null!==n&&null!==n.child)for(t=ui(t);null!==t;){if(n=t[di])return n;t=ui(t)}return e}n=(t=n).parentNode}return null}function bi(t){return!(t=t[di]||t[fi])||5!==t.tag&&6!==t.tag&&13!==t.tag&&3!==t.tag?null:t}function xi(t){if(5===t.tag||6===t.tag)return t.stateNode;throw Error(o(33))}function _i(t){return t[pi]||null}var wi=[],Si=-1;function Ti(t){return{current:t}}function Ei(t){0>Si||(t.current=wi[Si],wi[Si]=null,Si--)}function Mi(t,e){Si++,wi[Si]=t.current,t.current=e}var Ci={},Ai=Ti(Ci),ki=Ti(!1),Ii=Ci;function Ri(t,e){var n=t.type.contextTypes;if(!n)return Ci;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i,o={};for(i in n)o[i]=e[i];return r&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=o),o}function Pi(t){return null!==(t=t.childContextTypes)&&void 0!==t}function Ni(){Ei(ki),Ei(Ai)}function Oi(t,e,n){if(Ai.current!==Ci)throw Error(o(168));Mi(Ai,e),Mi(ki,n)}function Di(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in e))throw Error(o(108,W(t)||"Unknown",i));return F({},n,r)}function Li(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ci,Ii=Ai.current,Mi(Ai,t),Mi(ki,ki.current),!0}function Fi(t,e,n){var r=t.stateNode;if(!r)throw Error(o(169));n?(t=Di(t,e,Ii),r.__reactInternalMemoizedMergedChildContext=t,Ei(ki),Ei(Ai),Mi(Ai,t)):Ei(ki),Mi(ki,n)}var Ui=null,Bi=!1,zi=!1;function ji(t){null===Ui?Ui=[t]:Ui.push(t)}function Vi(){if(!zi&&null!==Ui){zi=!0;var t=0,e=be;try{var n=Ui;for(be=1;t<n.length;t++){var r=n[t];do{r=r(!0)}while(null!==r)}Ui=null,Bi=!1}catch(i){throw null!==Ui&&(Ui=Ui.slice(t+1)),Xt($t,Vi),i}finally{be=e,zi=!1}}return null}var Wi=[],Gi=0,Hi=null,qi=0,Xi=[],Yi=0,Ki=null,Zi=1,Ji="";function Qi(t,e){Wi[Gi++]=qi,Wi[Gi++]=Hi,Hi=t,qi=e}function $i(t,e,n){Xi[Yi++]=Zi,Xi[Yi++]=Ji,Xi[Yi++]=Ki,Ki=t;var r=Zi;t=Ji;var i=32-ae(r)-1;r&=~(1<<i),n+=1;var o=32-ae(e)+i;if(30<o){var a=i-i%5;o=(r&(1<<a)-1).toString(32),r>>=a,i-=a,Zi=1<<32-ae(e)+i|n<<i|r,Ji=o+t}else Zi=1<<o|n<<i|r,Ji=t}function to(t){null!==t.return&&(Qi(t,1),$i(t,1,0))}function eo(t){for(;t===Hi;)Hi=Wi[--Gi],Wi[Gi]=null,qi=Wi[--Gi],Wi[Gi]=null;for(;t===Ki;)Ki=Xi[--Yi],Xi[Yi]=null,Ji=Xi[--Yi],Xi[Yi]=null,Zi=Xi[--Yi],Xi[Yi]=null}var no=null,ro=null,io=!1,oo=null;function ao(t,e){var n=Rc(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,null===(e=t.deletions)?(t.deletions=[n],t.flags|=16):e.push(n)}function so(t,e){switch(t.tag){case 5:var n=t.type;return null!==(e=1!==e.nodeType||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e)&&(t.stateNode=e,no=t,ro=ci(e.firstChild),!0);case 6:return null!==(e=""===t.pendingProps||3!==e.nodeType?null:e)&&(t.stateNode=e,no=t,ro=null,!0);case 13:return null!==(e=8!==e.nodeType?null:e)&&(n=null!==Ki?{id:Zi,overflow:Ji}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},(n=Rc(18,null,null,0)).stateNode=e,n.return=t,t.child=n,no=t,ro=null,!0);default:return!1}}function lo(t){return 0!==(1&t.mode)&&0===(128&t.flags)}function co(t){if(io){var e=ro;if(e){var n=e;if(!so(t,e)){if(lo(t))throw Error(o(418));e=ci(n.nextSibling);var r=no;e&&so(t,e)?ao(r,n):(t.flags=-4097&t.flags|2,io=!1,no=t)}}else{if(lo(t))throw Error(o(418));t.flags=-4097&t.flags|2,io=!1,no=t}}}function uo(t){for(t=t.return;null!==t&&5!==t.tag&&3!==t.tag&&13!==t.tag;)t=t.return;no=t}function ho(t){if(t!==no)return!1;if(!io)return uo(t),io=!0,!1;var e;if((e=3!==t.tag)&&!(e=5!==t.tag)&&(e="head"!==(e=t.type)&&"body"!==e&&!ni(t.type,t.memoizedProps)),e&&(e=ro)){if(lo(t))throw po(),Error(o(418));for(;e;)ao(t,e),e=ci(e.nextSibling)}if(uo(t),13===t.tag){if(!(t=null!==(t=t.memoizedState)?t.dehydrated:null))throw Error(o(317));t:{for(t=t.nextSibling,e=0;t;){if(8===t.nodeType){var n=t.data;if("/$"===n){if(0===e){ro=ci(t.nextSibling);break t}e--}else"$"!==n&&"$!"!==n&&"$?"!==n||e++}t=t.nextSibling}ro=null}}else ro=no?ci(t.stateNode.nextSibling):null;return!0}function po(){for(var t=ro;t;)t=ci(t.nextSibling)}function fo(){ro=no=null,io=!1}function mo(t){null===oo?oo=[t]:oo.push(t)}var go=x.ReactCurrentBatchConfig;function yo(t,e,n){if(null!==(t=n.ref)&&"function"!==typeof t&&"object"!==typeof t){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(o(309));var r=n.stateNode}if(!r)throw Error(o(147,t));var i=r,a=""+t;return null!==e&&null!==e.ref&&"function"===typeof e.ref&&e.ref._stringRef===a?e.ref:(e=function(t){var e=i.refs;null===t?delete e[a]:e[a]=t},e._stringRef=a,e)}if("string"!==typeof t)throw Error(o(284));if(!n._owner)throw Error(o(290,t))}return t}function vo(t,e){throw t=Object.prototype.toString.call(e),Error(o(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function bo(t){return(0,t._init)(t._payload)}function xo(t){function e(e,n){if(t){var r=e.deletions;null===r?(e.deletions=[n],e.flags|=16):r.push(n)}}function n(n,r){if(!t)return null;for(;null!==r;)e(n,r),r=r.sibling;return null}function r(t,e){for(t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function i(t,e){return(t=Nc(t,e)).index=0,t.sibling=null,t}function a(e,n,r){return e.index=r,t?null!==(r=e.alternate)?(r=r.index)<n?(e.flags|=2,n):r:(e.flags|=2,n):(e.flags|=1048576,n)}function s(e){return t&&null===e.alternate&&(e.flags|=2),e}function l(t,e,n,r){return null===e||6!==e.tag?((e=Fc(n,t.mode,r)).return=t,e):((e=i(e,n)).return=t,e)}function c(t,e,n,r){var o=n.type;return o===S?h(t,e,n.props.children,r,n.key):null!==e&&(e.elementType===o||"object"===typeof o&&null!==o&&o.$$typeof===P&&bo(o)===e.type)?((r=i(e,n.props)).ref=yo(t,e,n),r.return=t,r):((r=Oc(n.type,n.key,n.props,null,t.mode,r)).ref=yo(t,e,n),r.return=t,r)}function u(t,e,n,r){return null===e||4!==e.tag||e.stateNode.containerInfo!==n.containerInfo||e.stateNode.implementation!==n.implementation?((e=Uc(n,t.mode,r)).return=t,e):((e=i(e,n.children||[])).return=t,e)}function h(t,e,n,r,o){return null===e||7!==e.tag?((e=Dc(n,t.mode,r,o)).return=t,e):((e=i(e,n)).return=t,e)}function d(t,e,n){if("string"===typeof e&&""!==e||"number"===typeof e)return(e=Fc(""+e,t.mode,n)).return=t,e;if("object"===typeof e&&null!==e){switch(e.$$typeof){case _:return(n=Oc(e.type,e.key,e.props,null,t.mode,n)).ref=yo(t,null,e),n.return=t,n;case w:return(e=Uc(e,t.mode,n)).return=t,e;case P:return d(t,(0,e._init)(e._payload),n)}if(et(e)||D(e))return(e=Dc(e,t.mode,n,null)).return=t,e;vo(t,e)}return null}function p(t,e,n,r){var i=null!==e?e.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:l(t,e,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case _:return n.key===i?c(t,e,n,r):null;case w:return n.key===i?u(t,e,n,r):null;case P:return p(t,e,(i=n._init)(n._payload),r)}if(et(n)||D(n))return null!==i?null:h(t,e,n,r,null);vo(t,n)}return null}function f(t,e,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r)return l(e,t=t.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case _:return c(e,t=t.get(null===r.key?n:r.key)||null,r,i);case w:return u(e,t=t.get(null===r.key?n:r.key)||null,r,i);case P:return f(t,e,n,(0,r._init)(r._payload),i)}if(et(r)||D(r))return h(e,t=t.get(n)||null,r,i,null);vo(e,r)}return null}function m(i,o,s,l){for(var c=null,u=null,h=o,m=o=0,g=null;null!==h&&m<s.length;m++){h.index>m?(g=h,h=null):g=h.sibling;var y=p(i,h,s[m],l);if(null===y){null===h&&(h=g);break}t&&h&&null===y.alternate&&e(i,h),o=a(y,o,m),null===u?c=y:u.sibling=y,u=y,h=g}if(m===s.length)return n(i,h),io&&Qi(i,m),c;if(null===h){for(;m<s.length;m++)null!==(h=d(i,s[m],l))&&(o=a(h,o,m),null===u?c=h:u.sibling=h,u=h);return io&&Qi(i,m),c}for(h=r(i,h);m<s.length;m++)null!==(g=f(h,i,m,s[m],l))&&(t&&null!==g.alternate&&h.delete(null===g.key?m:g.key),o=a(g,o,m),null===u?c=g:u.sibling=g,u=g);return t&&h.forEach((function(t){return e(i,t)})),io&&Qi(i,m),c}function g(i,s,l,c){var u=D(l);if("function"!==typeof u)throw Error(o(150));if(null==(l=u.call(l)))throw Error(o(151));for(var h=u=null,m=s,g=s=0,y=null,v=l.next();null!==m&&!v.done;g++,v=l.next()){m.index>g?(y=m,m=null):y=m.sibling;var b=p(i,m,v.value,c);if(null===b){null===m&&(m=y);break}t&&m&&null===b.alternate&&e(i,m),s=a(b,s,g),null===h?u=b:h.sibling=b,h=b,m=y}if(v.done)return n(i,m),io&&Qi(i,g),u;if(null===m){for(;!v.done;g++,v=l.next())null!==(v=d(i,v.value,c))&&(s=a(v,s,g),null===h?u=v:h.sibling=v,h=v);return io&&Qi(i,g),u}for(m=r(i,m);!v.done;g++,v=l.next())null!==(v=f(m,i,g,v.value,c))&&(t&&null!==v.alternate&&m.delete(null===v.key?g:v.key),s=a(v,s,g),null===h?u=v:h.sibling=v,h=v);return t&&m.forEach((function(t){return e(i,t)})),io&&Qi(i,g),u}return function t(r,o,a,l){if("object"===typeof a&&null!==a&&a.type===S&&null===a.key&&(a=a.props.children),"object"===typeof a&&null!==a){switch(a.$$typeof){case _:t:{for(var c=a.key,u=o;null!==u;){if(u.key===c){if((c=a.type)===S){if(7===u.tag){n(r,u.sibling),(o=i(u,a.props.children)).return=r,r=o;break t}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===P&&bo(c)===u.type){n(r,u.sibling),(o=i(u,a.props)).ref=yo(r,u,a),o.return=r,r=o;break t}n(r,u);break}e(r,u),u=u.sibling}a.type===S?((o=Dc(a.props.children,r.mode,l,a.key)).return=r,r=o):((l=Oc(a.type,a.key,a.props,null,r.mode,l)).ref=yo(r,o,a),l.return=r,r=l)}return s(r);case w:t:{for(u=a.key;null!==o;){if(o.key===u){if(4===o.tag&&o.stateNode.containerInfo===a.containerInfo&&o.stateNode.implementation===a.implementation){n(r,o.sibling),(o=i(o,a.children||[])).return=r,r=o;break t}n(r,o);break}e(r,o),o=o.sibling}(o=Uc(a,r.mode,l)).return=r,r=o}return s(r);case P:return t(r,o,(u=a._init)(a._payload),l)}if(et(a))return m(r,o,a,l);if(D(a))return g(r,o,a,l);vo(r,a)}return"string"===typeof a&&""!==a||"number"===typeof a?(a=""+a,null!==o&&6===o.tag?(n(r,o.sibling),(o=i(o,a)).return=r,r=o):(n(r,o),(o=Fc(a,r.mode,l)).return=r,r=o),s(r)):n(r,o)}}var _o=xo(!0),wo=xo(!1),So=Ti(null),To=null,Eo=null,Mo=null;function Co(){Mo=Eo=To=null}function Ao(t){var e=So.current;Ei(So),t._currentValue=e}function ko(t,e,n){for(;null!==t;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,null!==r&&(r.childLanes|=e)):null!==r&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Io(t,e){To=t,Mo=Eo=null,null!==(t=t.dependencies)&&null!==t.firstContext&&(0!==(t.lanes&e)&&(bs=!0),t.firstContext=null)}function Ro(t){var e=t._currentValue;if(Mo!==t)if(t={context:t,memoizedValue:e,next:null},null===Eo){if(null===To)throw Error(o(308));Eo=t,To.dependencies={lanes:0,firstContext:t}}else Eo=Eo.next=t;return e}var Po=null;function No(t){null===Po?Po=[t]:Po.push(t)}function Oo(t,e,n,r){var i=e.interleaved;return null===i?(n.next=n,No(e)):(n.next=i.next,i.next=n),e.interleaved=n,Do(t,r)}function Do(t,e){t.lanes|=e;var n=t.alternate;for(null!==n&&(n.lanes|=e),n=t,t=t.return;null!==t;)t.childLanes|=e,null!==(n=t.alternate)&&(n.childLanes|=e),n=t,t=t.return;return 3===n.tag?n.stateNode:null}var Lo=!1;function Fo(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Uo(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Bo(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function zo(t,e,n){var r=t.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Al)){var i=r.pending;return null===i?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Do(t,n)}return null===(i=r.interleaved)?(e.next=e,No(r)):(e.next=i.next,i.next=e),r.interleaved=e,Do(t,n)}function jo(t,e,n){if(null!==(e=e.updateQueue)&&(e=e.shared,0!==(4194240&n))){var r=e.lanes;n|=r&=t.pendingLanes,e.lanes=n,ve(t,n)}}function Vo(t,e){var n=t.updateQueue,r=t.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===o?i=o=a:o=o.next=a,n=n.next}while(null!==n);null===o?i=o=e:o=o.next=e}else i=o=e;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},void(t.updateQueue=n)}null===(t=n.lastBaseUpdate)?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Wo(t,e,n,r){var i=t.updateQueue;Lo=!1;var o=i.firstBaseUpdate,a=i.lastBaseUpdate,s=i.shared.pending;if(null!==s){i.shared.pending=null;var l=s,c=l.next;l.next=null,null===a?o=c:a.next=c,a=l;var u=t.alternate;null!==u&&((s=(u=u.updateQueue).lastBaseUpdate)!==a&&(null===s?u.firstBaseUpdate=c:s.next=c,u.lastBaseUpdate=l))}if(null!==o){var h=i.baseState;for(a=0,u=c=l=null,s=o;;){var d=s.lane,p=s.eventTime;if((r&d)===d){null!==u&&(u=u.next={eventTime:p,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});t:{var f=t,m=s;switch(d=e,p=n,m.tag){case 1:if("function"===typeof(f=m.payload)){h=f.call(p,h,d);break t}h=f;break t;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(d="function"===typeof(f=m.payload)?f.call(p,h,d):f)||void 0===d)break t;h=F({},h,d);break t;case 2:Lo=!0}}null!==s.callback&&0!==s.lane&&(t.flags|=64,null===(d=i.effects)?i.effects=[s]:d.push(s))}else p={eventTime:p,lane:d,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===u?(c=u=p,l=h):u=u.next=p,a|=d;if(null===(s=s.next)){if(null===(s=i.shared.pending))break;s=(d=s).next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}if(null===u&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,null!==(e=i.shared.interleaved)){i=e;do{a|=i.lane,i=i.next}while(i!==e)}else null===o&&(i.shared.lanes=0);Ll|=a,t.lanes=a,t.memoizedState=h}}function Go(t,e,n){if(t=e.effects,e.effects=null,null!==t)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(o(191,i));i.call(r)}}}var Ho={},qo=Ti(Ho),Xo=Ti(Ho),Yo=Ti(Ho);function Ko(t){if(t===Ho)throw Error(o(174));return t}function Zo(t,e){switch(Mi(Yo,e),Mi(Xo,t),Mi(qo,Ho),t=e.nodeType){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:lt(null,"");break;default:e=lt(e=(t=8===t?e.parentNode:e).namespaceURI||null,t=t.tagName)}Ei(qo),Mi(qo,e)}function Jo(){Ei(qo),Ei(Xo),Ei(Yo)}function Qo(t){Ko(Yo.current);var e=Ko(qo.current),n=lt(e,t.type);e!==n&&(Mi(Xo,t),Mi(qo,n))}function $o(t){Xo.current===t&&(Ei(qo),Ei(Xo))}var ta=Ti(0);function ea(t){for(var e=t;null!==e;){if(13===e.tag){var n=e.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return e}else if(19===e.tag&&void 0!==e.memoizedProps.revealOrder){if(0!==(128&e.flags))return e}else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var na=[];function ra(){for(var t=0;t<na.length;t++)na[t]._workInProgressVersionPrimary=null;na.length=0}var ia=x.ReactCurrentDispatcher,oa=x.ReactCurrentBatchConfig,aa=0,sa=null,la=null,ca=null,ua=!1,ha=!1,da=0,pa=0;function fa(){throw Error(o(321))}function ma(t,e){if(null===e)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!sr(t[n],e[n]))return!1;return!0}function ga(t,e,n,r,i,a){if(aa=a,sa=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ia.current=null===t||null===t.memoizedState?$a:ts,t=n(r,i),ha){a=0;do{if(ha=!1,da=0,25<=a)throw Error(o(301));a+=1,ca=la=null,e.updateQueue=null,ia.current=es,t=n(r,i)}while(ha)}if(ia.current=Qa,e=null!==la&&null!==la.next,aa=0,ca=la=sa=null,ua=!1,e)throw Error(o(300));return t}function ya(){var t=0!==da;return da=0,t}function va(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ca?sa.memoizedState=ca=t:ca=ca.next=t,ca}function ba(){if(null===la){var t=sa.alternate;t=null!==t?t.memoizedState:null}else t=la.next;var e=null===ca?sa.memoizedState:ca.next;if(null!==e)ca=e,la=t;else{if(null===t)throw Error(o(310));t={memoizedState:(la=t).memoizedState,baseState:la.baseState,baseQueue:la.baseQueue,queue:la.queue,next:null},null===ca?sa.memoizedState=ca=t:ca=ca.next=t}return ca}function xa(t,e){return"function"===typeof e?e(t):e}function _a(t){var e=ba(),n=e.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=t;var r=la,i=r.baseQueue,a=n.pending;if(null!==a){if(null!==i){var s=i.next;i.next=a.next,a.next=s}r.baseQueue=i=a,n.pending=null}if(null!==i){a=i.next,r=r.baseState;var l=s=null,c=null,u=a;do{var h=u.lane;if((aa&h)===h)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=d,s=r):c=c.next=d,sa.lanes|=h,Ll|=h}u=u.next}while(null!==u&&u!==a);null===c?s=r:c.next=l,sr(r,e.memoizedState)||(bs=!0),e.memoizedState=r,e.baseState=s,e.baseQueue=c,n.lastRenderedState=r}if(null!==(t=n.interleaved)){i=t;do{a=i.lane,sa.lanes|=a,Ll|=a,i=i.next}while(i!==t)}else null===i&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function wa(t){var e=ba(),n=e.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,a=e.memoizedState;if(null!==i){n.pending=null;var s=i=i.next;do{a=t(a,s.action),s=s.next}while(s!==i);sr(a,e.memoizedState)||(bs=!0),e.memoizedState=a,null===e.baseQueue&&(e.baseState=a),n.lastRenderedState=a}return[a,r]}function Sa(){}function Ta(t,e){var n=sa,r=ba(),i=e(),a=!sr(r.memoizedState,i);if(a&&(r.memoizedState=i,bs=!0),r=r.queue,La(Ca.bind(null,n,r,t),[t]),r.getSnapshot!==e||a||null!==ca&&1&ca.memoizedState.tag){if(n.flags|=2048,Ra(9,Ma.bind(null,n,r,i,e),void 0,null),null===kl)throw Error(o(349));0!==(30&aa)||Ea(n,e,i)}return i}function Ea(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},null===(e=sa.updateQueue)?(e={lastEffect:null,stores:null},sa.updateQueue=e,e.stores=[t]):null===(n=e.stores)?e.stores=[t]:n.push(t)}function Ma(t,e,n,r){e.value=n,e.getSnapshot=r,Aa(e)&&ka(t)}function Ca(t,e,n){return n((function(){Aa(e)&&ka(t)}))}function Aa(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!sr(t,n)}catch(r){return!0}}function ka(t){var e=Do(t,1);null!==e&&nc(e,t,1,-1)}function Ia(t){var e=va();return"function"===typeof t&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xa,lastRenderedState:t},e.queue=t,t=t.dispatch=Ya.bind(null,sa,t),[e.memoizedState,t]}function Ra(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},null===(e=sa.updateQueue)?(e={lastEffect:null,stores:null},sa.updateQueue=e,e.lastEffect=t.next=t):null===(n=e.lastEffect)?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t),t}function Pa(){return ba().memoizedState}function Na(t,e,n,r){var i=va();sa.flags|=t,i.memoizedState=Ra(1|e,n,void 0,void 0===r?null:r)}function Oa(t,e,n,r){var i=ba();r=void 0===r?null:r;var o=void 0;if(null!==la){var a=la.memoizedState;if(o=a.destroy,null!==r&&ma(r,a.deps))return void(i.memoizedState=Ra(e,n,o,r))}sa.flags|=t,i.memoizedState=Ra(1|e,n,o,r)}function Da(t,e){return Na(8390656,8,t,e)}function La(t,e){return Oa(2048,8,t,e)}function Fa(t,e){return Oa(4,2,t,e)}function Ua(t,e){return Oa(4,4,t,e)}function Ba(t,e){return"function"===typeof e?(t=t(),e(t),function(){e(null)}):null!==e&&void 0!==e?(t=t(),e.current=t,function(){e.current=null}):void 0}function za(t,e,n){return n=null!==n&&void 0!==n?n.concat([t]):null,Oa(4,4,Ba.bind(null,e,t),n)}function ja(){}function Va(t,e){var n=ba();e=void 0===e?null:e;var r=n.memoizedState;return null!==r&&null!==e&&ma(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Wa(t,e){var n=ba();e=void 0===e?null:e;var r=n.memoizedState;return null!==r&&null!==e&&ma(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Ga(t,e,n){return 0===(21&aa)?(t.baseState&&(t.baseState=!1,bs=!0),t.memoizedState=n):(sr(n,e)||(n=me(),sa.lanes|=n,Ll|=n,t.baseState=!0),e)}function Ha(t,e){var n=be;be=0!==n&&4>n?n:4,t(!0);var r=oa.transition;oa.transition={};try{t(!1),e()}finally{be=n,oa.transition=r}}function qa(){return ba().memoizedState}function Xa(t,e,n){var r=ec(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Ka(t))Za(e,n);else if(null!==(n=Oo(t,e,n,r))){nc(n,t,r,tc()),Ja(n,e,r)}}function Ya(t,e,n){var r=ec(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ka(t))Za(e,i);else{var o=t.alternate;if(0===t.lanes&&(null===o||0===o.lanes)&&null!==(o=e.lastRenderedReducer))try{var a=e.lastRenderedState,s=o(a,n);if(i.hasEagerState=!0,i.eagerState=s,sr(s,a)){var l=e.interleaved;return null===l?(i.next=i,No(e)):(i.next=l.next,l.next=i),void(e.interleaved=i)}}catch(c){}null!==(n=Oo(t,e,i,r))&&(nc(n,t,r,i=tc()),Ja(n,e,r))}}function Ka(t){var e=t.alternate;return t===sa||null!==e&&e===sa}function Za(t,e){ha=ua=!0;var n=t.pending;null===n?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Ja(t,e,n){if(0!==(4194240&n)){var r=e.lanes;n|=r&=t.pendingLanes,e.lanes=n,ve(t,n)}}var Qa={readContext:Ro,useCallback:fa,useContext:fa,useEffect:fa,useImperativeHandle:fa,useInsertionEffect:fa,useLayoutEffect:fa,useMemo:fa,useReducer:fa,useRef:fa,useState:fa,useDebugValue:fa,useDeferredValue:fa,useTransition:fa,useMutableSource:fa,useSyncExternalStore:fa,useId:fa,unstable_isNewReconciler:!1},$a={readContext:Ro,useCallback:function(t,e){return va().memoizedState=[t,void 0===e?null:e],t},useContext:Ro,useEffect:Da,useImperativeHandle:function(t,e,n){return n=null!==n&&void 0!==n?n.concat([t]):null,Na(4194308,4,Ba.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Na(4194308,4,t,e)},useInsertionEffect:function(t,e){return Na(4,2,t,e)},useMemo:function(t,e){var n=va();return e=void 0===e?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=va();return e=void 0!==n?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=Xa.bind(null,sa,t),[r.memoizedState,t]},useRef:function(t){return t={current:t},va().memoizedState=t},useState:Ia,useDebugValue:ja,useDeferredValue:function(t){return va().memoizedState=t},useTransition:function(){var t=Ia(!1),e=t[0];return t=Ha.bind(null,t[1]),va().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=sa,i=va();if(io){if(void 0===n)throw Error(o(407));n=n()}else{if(n=e(),null===kl)throw Error(o(349));0!==(30&aa)||Ea(r,e,n)}i.memoizedState=n;var a={value:n,getSnapshot:e};return i.queue=a,Da(Ca.bind(null,r,a,t),[t]),r.flags|=2048,Ra(9,Ma.bind(null,r,a,n,e),void 0,null),n},useId:function(){var t=va(),e=kl.identifierPrefix;if(io){var n=Ji;e=":"+e+"R"+(n=(Zi&~(1<<32-ae(Zi)-1)).toString(32)+n),0<(n=da++)&&(e+="H"+n.toString(32)),e+=":"}else e=":"+e+"r"+(n=pa++).toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},ts={readContext:Ro,useCallback:Va,useContext:Ro,useEffect:La,useImperativeHandle:za,useInsertionEffect:Fa,useLayoutEffect:Ua,useMemo:Wa,useReducer:_a,useRef:Pa,useState:function(){return _a(xa)},useDebugValue:ja,useDeferredValue:function(t){return Ga(ba(),la.memoizedState,t)},useTransition:function(){return[_a(xa)[0],ba().memoizedState]},useMutableSource:Sa,useSyncExternalStore:Ta,useId:qa,unstable_isNewReconciler:!1},es={readContext:Ro,useCallback:Va,useContext:Ro,useEffect:La,useImperativeHandle:za,useInsertionEffect:Fa,useLayoutEffect:Ua,useMemo:Wa,useReducer:wa,useRef:Pa,useState:function(){return wa(xa)},useDebugValue:ja,useDeferredValue:function(t){var e=ba();return null===la?e.memoizedState=t:Ga(e,la.memoizedState,t)},useTransition:function(){return[wa(xa)[0],ba().memoizedState]},useMutableSource:Sa,useSyncExternalStore:Ta,useId:qa,unstable_isNewReconciler:!1};function ns(t,e){if(t&&t.defaultProps){for(var n in e=F({},e),t=t.defaultProps)void 0===e[n]&&(e[n]=t[n]);return e}return e}function rs(t,e,n,r){n=null===(n=n(r,e=t.memoizedState))||void 0===n?e:F({},e,n),t.memoizedState=n,0===t.lanes&&(t.updateQueue.baseState=n)}var is={isMounted:function(t){return!!(t=t._reactInternals)&&Vt(t)===t},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=tc(),i=ec(t),o=Bo(r,i);o.payload=e,void 0!==n&&null!==n&&(o.callback=n),null!==(e=zo(t,o,i))&&(nc(e,t,i,r),jo(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=tc(),i=ec(t),o=Bo(r,i);o.tag=1,o.payload=e,void 0!==n&&null!==n&&(o.callback=n),null!==(e=zo(t,o,i))&&(nc(e,t,i,r),jo(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=tc(),r=ec(t),i=Bo(n,r);i.tag=2,void 0!==e&&null!==e&&(i.callback=e),null!==(e=zo(t,i,r))&&(nc(e,t,r,n),jo(e,t,r))}};function os(t,e,n,r,i,o,a){return"function"===typeof(t=t.stateNode).shouldComponentUpdate?t.shouldComponentUpdate(r,o,a):!e.prototype||!e.prototype.isPureReactComponent||(!lr(n,r)||!lr(i,o))}function as(t,e,n){var r=!1,i=Ci,o=e.contextType;return"object"===typeof o&&null!==o?o=Ro(o):(i=Pi(e)?Ii:Ai.current,o=(r=null!==(r=e.contextTypes)&&void 0!==r)?Ri(t,i):Ci),e=new e(n,o),t.memoizedState=null!==e.state&&void 0!==e.state?e.state:null,e.updater=is,t.stateNode=e,e._reactInternals=t,r&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=o),e}function ss(t,e,n,r){t=e.state,"function"===typeof e.componentWillReceiveProps&&e.componentWillReceiveProps(n,r),"function"===typeof e.UNSAFE_componentWillReceiveProps&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&is.enqueueReplaceState(e,e.state,null)}function ls(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},Fo(t);var o=e.contextType;"object"===typeof o&&null!==o?i.context=Ro(o):(o=Pi(e)?Ii:Ai.current,i.context=Ri(t,o)),i.state=t.memoizedState,"function"===typeof(o=e.getDerivedStateFromProps)&&(rs(t,e,o,n),i.state=t.memoizedState),"function"===typeof e.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(e=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),e!==i.state&&is.enqueueReplaceState(i,i.state,null),Wo(t,n,i,r),i.state=t.memoizedState),"function"===typeof i.componentDidMount&&(t.flags|=4194308)}function cs(t,e){try{var n="",r=e;do{n+=j(r),r=r.return}while(r);var i=n}catch(o){i="\nError generating stack: "+o.message+"\n"+o.stack}return{value:t,source:e,stack:i,digest:null}}function us(t,e,n){return{value:t,source:null,stack:null!=n?n:null,digest:null!=e?e:null}}function hs(t,e){try{console.error(e.value)}catch(n){setTimeout((function(){throw n}))}}var ds="function"===typeof WeakMap?WeakMap:Map;function ps(t,e,n){(n=Bo(-1,n)).tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Gl||(Gl=!0,Hl=r),hs(0,e)},n}function fs(t,e,n){(n=Bo(-1,n)).tag=3;var r=t.type.getDerivedStateFromError;if("function"===typeof r){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){hs(0,e)}}var o=t.stateNode;return null!==o&&"function"===typeof o.componentDidCatch&&(n.callback=function(){hs(0,e),"function"!==typeof r&&(null===ql?ql=new Set([this]):ql.add(this));var t=e.stack;this.componentDidCatch(e.value,{componentStack:null!==t?t:""})}),n}function ms(t,e,n){var r=t.pingCache;if(null===r){r=t.pingCache=new ds;var i=new Set;r.set(e,i)}else void 0===(i=r.get(e))&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=Ec.bind(null,t,e,n),e.then(t,t))}function gs(t){do{var e;if((e=13===t.tag)&&(e=null===(e=t.memoizedState)||null!==e.dehydrated),e)return t;t=t.return}while(null!==t);return null}function ys(t,e,n,r,i){return 0===(1&t.mode)?(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((e=Bo(-1,1)).tag=2,zo(n,e,1))),n.lanes|=1),t):(t.flags|=65536,t.lanes=i,t)}var vs=x.ReactCurrentOwner,bs=!1;function xs(t,e,n,r){e.child=null===t?wo(e,null,n,r):_o(e,t.child,n,r)}function _s(t,e,n,r,i){n=n.render;var o=e.ref;return Io(e,i),r=ga(t,e,n,r,o,i),n=ya(),null===t||bs?(io&&n&&to(e),e.flags|=1,xs(t,e,r,i),e.child):(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Gs(t,e,i))}function ws(t,e,n,r,i){if(null===t){var o=n.type;return"function"!==typeof o||Pc(o)||void 0!==o.defaultProps||null!==n.compare||void 0!==n.defaultProps?((t=Oc(n.type,null,r,e,e.mode,i)).ref=e.ref,t.return=e,e.child=t):(e.tag=15,e.type=o,Ss(t,e,o,r,i))}if(o=t.child,0===(t.lanes&i)){var a=o.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(a,r)&&t.ref===e.ref)return Gs(t,e,i)}return e.flags|=1,(t=Nc(o,r)).ref=e.ref,t.return=e,e.child=t}function Ss(t,e,n,r,i){if(null!==t){var o=t.memoizedProps;if(lr(o,r)&&t.ref===e.ref){if(bs=!1,e.pendingProps=r=o,0===(t.lanes&i))return e.lanes=t.lanes,Gs(t,e,i);0!==(131072&t.flags)&&(bs=!0)}}return Ms(t,e,n,r,i)}function Ts(t,e,n){var r=e.pendingProps,i=r.children,o=null!==t?t.memoizedState:null;if("hidden"===r.mode)if(0===(1&e.mode))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Mi(Nl,Pl),Pl|=n;else{if(0===(1073741824&n))return t=null!==o?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Mi(Nl,Pl),Pl|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==o?o.baseLanes:n,Mi(Nl,Pl),Pl|=r}else null!==o?(r=o.baseLanes|n,e.memoizedState=null):r=n,Mi(Nl,Pl),Pl|=r;return xs(t,e,i,n),e.child}function Es(t,e){var n=e.ref;(null===t&&null!==n||null!==t&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Ms(t,e,n,r,i){var o=Pi(n)?Ii:Ai.current;return o=Ri(e,o),Io(e,i),n=ga(t,e,n,r,o,i),r=ya(),null===t||bs?(io&&r&&to(e),e.flags|=1,xs(t,e,n,i),e.child):(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Gs(t,e,i))}function Cs(t,e,n,r,i){if(Pi(n)){var o=!0;Li(e)}else o=!1;if(Io(e,i),null===e.stateNode)Ws(t,e),as(e,n,r),ls(e,n,r,i),r=!0;else if(null===t){var a=e.stateNode,s=e.memoizedProps;a.props=s;var l=a.context,c=n.contextType;"object"===typeof c&&null!==c?c=Ro(c):c=Ri(e,c=Pi(n)?Ii:Ai.current);var u=n.getDerivedStateFromProps,h="function"===typeof u||"function"===typeof a.getSnapshotBeforeUpdate;h||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==r||l!==c)&&ss(e,a,r,c),Lo=!1;var d=e.memoizedState;a.state=d,Wo(e,r,a,i),l=e.memoizedState,s!==r||d!==l||ki.current||Lo?("function"===typeof u&&(rs(e,n,u,r),l=e.memoizedState),(s=Lo||os(e,n,s,r,d,l,c))?(h||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(e.flags|=4194308)):("function"===typeof a.componentDidMount&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),a.props=r,a.state=l,a.context=c,r=s):("function"===typeof a.componentDidMount&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,Uo(t,e),s=e.memoizedProps,c=e.type===e.elementType?s:ns(e.type,s),a.props=c,h=e.pendingProps,d=a.context,"object"===typeof(l=n.contextType)&&null!==l?l=Ro(l):l=Ri(e,l=Pi(n)?Ii:Ai.current);var p=n.getDerivedStateFromProps;(u="function"===typeof p||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==h||d!==l)&&ss(e,a,r,l),Lo=!1,d=e.memoizedState,a.state=d,Wo(e,r,a,i);var f=e.memoizedState;s!==h||d!==f||ki.current||Lo?("function"===typeof p&&(rs(e,n,p,r),f=e.memoizedState),(c=Lo||os(e,n,c,r,d,f,l)||!1)?(u||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(r,f,l),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(r,f,l)),"function"===typeof a.componentDidUpdate&&(e.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(e.flags|=1024)):("function"!==typeof a.componentDidUpdate||s===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=f),a.props=r,a.state=f,a.context=l,r=c):("function"!==typeof a.componentDidUpdate||s===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),r=!1)}return As(t,e,n,r,o,i)}function As(t,e,n,r,i,o){Es(t,e);var a=0!==(128&e.flags);if(!r&&!a)return i&&Fi(e,n,!1),Gs(t,e,o);r=e.stateNode,vs.current=e;var s=a&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return e.flags|=1,null!==t&&a?(e.child=_o(e,t.child,null,o),e.child=_o(e,null,s,o)):xs(t,e,s,o),e.memoizedState=r.state,i&&Fi(e,n,!0),e.child}function ks(t){var e=t.stateNode;e.pendingContext?Oi(0,e.pendingContext,e.pendingContext!==e.context):e.context&&Oi(0,e.context,!1),Zo(t,e.containerInfo)}function Is(t,e,n,r,i){return fo(),mo(i),e.flags|=256,xs(t,e,n,r),e.child}var Rs,Ps,Ns,Os,Ds={dehydrated:null,treeContext:null,retryLane:0};function Ls(t){return{baseLanes:t,cachePool:null,transitions:null}}function Fs(t,e,n){var r,i=e.pendingProps,a=ta.current,s=!1,l=0!==(128&e.flags);if((r=l)||(r=(null===t||null!==t.memoizedState)&&0!==(2&a)),r?(s=!0,e.flags&=-129):null!==t&&null===t.memoizedState||(a|=1),Mi(ta,1&a),null===t)return co(e),null!==(t=e.memoizedState)&&null!==(t=t.dehydrated)?(0===(1&e.mode)?e.lanes=1:"$!"===t.data?e.lanes=8:e.lanes=1073741824,null):(l=i.children,t=i.fallback,s?(i=e.mode,s=e.child,l={mode:"hidden",children:l},0===(1&i)&&null!==s?(s.childLanes=0,s.pendingProps=l):s=Lc(l,i,0,null),t=Dc(t,i,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Ls(n),e.memoizedState=Ds,t):Us(e,l));if(null!==(a=t.memoizedState)&&null!==(r=a.dehydrated))return function(t,e,n,r,i,a,s){if(n)return 256&e.flags?(e.flags&=-257,Bs(t,e,s,r=us(Error(o(422))))):null!==e.memoizedState?(e.child=t.child,e.flags|=128,null):(a=r.fallback,i=e.mode,r=Lc({mode:"visible",children:r.children},i,0,null),(a=Dc(a,i,s,null)).flags|=2,r.return=e,a.return=e,r.sibling=a,e.child=r,0!==(1&e.mode)&&_o(e,t.child,null,s),e.child.memoizedState=Ls(s),e.memoizedState=Ds,a);if(0===(1&e.mode))return Bs(t,e,s,null);if("$!"===i.data){if(r=i.nextSibling&&i.nextSibling.dataset)var l=r.dgst;return r=l,Bs(t,e,s,r=us(a=Error(o(419)),r,void 0))}if(l=0!==(s&t.childLanes),bs||l){if(null!==(r=kl)){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(r.suspendedLanes|s))?0:i)&&i!==a.retryLane&&(a.retryLane=i,Do(t,i),nc(r,t,i,-1))}return mc(),Bs(t,e,s,r=us(Error(o(421))))}return"$?"===i.data?(e.flags|=128,e.child=t.child,e=Cc.bind(null,t),i._reactRetry=e,null):(t=a.treeContext,ro=ci(i.nextSibling),no=e,io=!0,oo=null,null!==t&&(Xi[Yi++]=Zi,Xi[Yi++]=Ji,Xi[Yi++]=Ki,Zi=t.id,Ji=t.overflow,Ki=e),e=Us(e,r.children),e.flags|=4096,e)}(t,e,l,i,r,a,n);if(s){s=i.fallback,l=e.mode,r=(a=t.child).sibling;var c={mode:"hidden",children:i.children};return 0===(1&l)&&e.child!==a?((i=e.child).childLanes=0,i.pendingProps=c,e.deletions=null):(i=Nc(a,c)).subtreeFlags=14680064&a.subtreeFlags,null!==r?s=Nc(r,s):(s=Dc(s,l,n,null)).flags|=2,s.return=e,i.return=e,i.sibling=s,e.child=i,i=s,s=e.child,l=null===(l=t.child.memoizedState)?Ls(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},s.memoizedState=l,s.childLanes=t.childLanes&~n,e.memoizedState=Ds,i}return t=(s=t.child).sibling,i=Nc(s,{mode:"visible",children:i.children}),0===(1&e.mode)&&(i.lanes=n),i.return=e,i.sibling=null,null!==t&&(null===(n=e.deletions)?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=i,e.memoizedState=null,i}function Us(t,e){return(e=Lc({mode:"visible",children:e},t.mode,0,null)).return=t,t.child=e}function Bs(t,e,n,r){return null!==r&&mo(r),_o(e,t.child,null,n),(t=Us(e,e.pendingProps.children)).flags|=2,e.memoizedState=null,t}function zs(t,e,n){t.lanes|=e;var r=t.alternate;null!==r&&(r.lanes|=e),ko(t.return,e,n)}function js(t,e,n,r,i){var o=t.memoizedState;null===o?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function Vs(t,e,n){var r=e.pendingProps,i=r.revealOrder,o=r.tail;if(xs(t,e,r.children,n),0!==(2&(r=ta.current)))r=1&r|2,e.flags|=128;else{if(null!==t&&0!==(128&t.flags))t:for(t=e.child;null!==t;){if(13===t.tag)null!==t.memoizedState&&zs(t,n,e);else if(19===t.tag)zs(t,n,e);else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break t;for(;null===t.sibling;){if(null===t.return||t.return===e)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Mi(ta,r),0===(1&e.mode))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;null!==n;)null!==(t=n.alternate)&&null===ea(t)&&(i=n),n=n.sibling;null===(n=i)?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),js(e,!1,i,n,o);break;case"backwards":for(n=null,i=e.child,e.child=null;null!==i;){if(null!==(t=i.alternate)&&null===ea(t)){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}js(e,!0,n,null,o);break;case"together":js(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Ws(t,e){0===(1&e.mode)&&null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Gs(t,e,n){if(null!==t&&(e.dependencies=t.dependencies),Ll|=e.lanes,0===(n&e.childLanes))return null;if(null!==t&&e.child!==t.child)throw Error(o(153));if(null!==e.child){for(n=Nc(t=e.child,t.pendingProps),e.child=n,n.return=e;null!==t.sibling;)t=t.sibling,(n=n.sibling=Nc(t,t.pendingProps)).return=e;n.sibling=null}return e.child}function Hs(t,e){if(!io)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;null!==e;)null!==e.alternate&&(n=e),e=e.sibling;null===n?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?e||null===t.tail?t.tail=null:t.tail.sibling=null:r.sibling=null}}function qs(t){var e=null!==t.alternate&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=t,i=i.sibling;else for(i=t.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function Xs(t,e,n){var r=e.pendingProps;switch(eo(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qs(e),null;case 1:case 17:return Pi(e.type)&&Ni(),qs(e),null;case 3:return r=e.stateNode,Jo(),Ei(ki),Ei(Ai),ra(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==t&&null!==t.child||(ho(e)?e.flags|=4:null===t||t.memoizedState.isDehydrated&&0===(256&e.flags)||(e.flags|=1024,null!==oo&&(ac(oo),oo=null))),Ps(t,e),qs(e),null;case 5:$o(e);var i=Ko(Yo.current);if(n=e.type,null!==t&&null!=e.stateNode)Ns(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(null===e.stateNode)throw Error(o(166));return qs(e),null}if(t=Ko(qo.current),ho(e)){r=e.stateNode,n=e.type;var a=e.memoizedProps;switch(r[di]=e,r[pi]=a,t=0!==(1&e.mode),n){case"dialog":Br("cancel",r),Br("close",r);break;case"iframe":case"object":case"embed":Br("load",r);break;case"video":case"audio":for(i=0;i<Dr.length;i++)Br(Dr[i],r);break;case"source":Br("error",r);break;case"img":case"image":case"link":Br("error",r),Br("load",r);break;case"details":Br("toggle",r);break;case"input":Z(r,a),Br("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},Br("invalid",r);break;case"textarea":it(r,a),Br("invalid",r)}for(var l in vt(n,a),i=null,a)if(a.hasOwnProperty(l)){var c=a[l];"children"===l?"string"===typeof c?r.textContent!==c&&(!0!==a.suppressHydrationWarning&&Qr(r.textContent,c,t),i=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==a.suppressHydrationWarning&&Qr(r.textContent,c,t),i=["children",""+c]):s.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Br("scroll",r)}switch(n){case"input":q(r),$(r,a,!0);break;case"textarea":q(r),at(r);break;case"select":case"option":break;default:"function"===typeof a.onClick&&(r.onclick=$r)}r=i,e.updateQueue=r,null!==r&&(e.flags|=4)}else{l=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===t&&(t=st(n)),"http://www.w3.org/1999/xhtml"===t?"script"===n?((t=l.createElement("div")).innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):"string"===typeof r.is?t=l.createElement(n,{is:r.is}):(t=l.createElement(n),"select"===n&&(l=t,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):t=l.createElementNS(t,n),t[di]=e,t[pi]=r,Rs(t,e,!1,!1),e.stateNode=t;t:{switch(l=bt(n,r),n){case"dialog":Br("cancel",t),Br("close",t),i=r;break;case"iframe":case"object":case"embed":Br("load",t),i=r;break;case"video":case"audio":for(i=0;i<Dr.length;i++)Br(Dr[i],t);i=r;break;case"source":Br("error",t),i=r;break;case"img":case"image":case"link":Br("error",t),Br("load",t),i=r;break;case"details":Br("toggle",t),i=r;break;case"input":Z(t,r),i=K(t,r),Br("invalid",t);break;case"option":default:i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=F({},r,{value:void 0}),Br("invalid",t);break;case"textarea":it(t,r),i=rt(t,r),Br("invalid",t)}for(a in vt(n,i),c=i)if(c.hasOwnProperty(a)){var u=c[a];"style"===a?gt(t,u):"dangerouslySetInnerHTML"===a?null!=(u=u?u.__html:void 0)&&ht(t,u):"children"===a?"string"===typeof u?("textarea"!==n||""!==u)&&dt(t,u):"number"===typeof u&&dt(t,""+u):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(s.hasOwnProperty(a)?null!=u&&"onScroll"===a&&Br("scroll",t):null!=u&&b(t,a,u,l))}switch(n){case"input":q(t),$(t,r,!1);break;case"textarea":q(t),at(t);break;case"option":null!=r.value&&t.setAttribute("value",""+G(r.value));break;case"select":t.multiple=!!r.multiple,null!=(a=r.value)?nt(t,!!r.multiple,a,!1):null!=r.defaultValue&&nt(t,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(t.onclick=$r)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break t;case"img":r=!0;break t;default:r=!1}}r&&(e.flags|=4)}null!==e.ref&&(e.flags|=512,e.flags|=2097152)}return qs(e),null;case 6:if(t&&null!=e.stateNode)Os(t,e,t.memoizedProps,r);else{if("string"!==typeof r&&null===e.stateNode)throw Error(o(166));if(n=Ko(Yo.current),Ko(qo.current),ho(e)){if(r=e.stateNode,n=e.memoizedProps,r[di]=e,(a=r.nodeValue!==n)&&null!==(t=no))switch(t.tag){case 3:Qr(r.nodeValue,n,0!==(1&t.mode));break;case 5:!0!==t.memoizedProps.suppressHydrationWarning&&Qr(r.nodeValue,n,0!==(1&t.mode))}a&&(e.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[di]=e,e.stateNode=r}return qs(e),null;case 13:if(Ei(ta),r=e.memoizedState,null===t||null!==t.memoizedState&&null!==t.memoizedState.dehydrated){if(io&&null!==ro&&0!==(1&e.mode)&&0===(128&e.flags))po(),fo(),e.flags|=98560,a=!1;else if(a=ho(e),null!==r&&null!==r.dehydrated){if(null===t){if(!a)throw Error(o(318));if(!(a=null!==(a=e.memoizedState)?a.dehydrated:null))throw Error(o(317));a[di]=e}else fo(),0===(128&e.flags)&&(e.memoizedState=null),e.flags|=4;qs(e),a=!1}else null!==oo&&(ac(oo),oo=null),a=!0;if(!a)return 65536&e.flags?e:null}return 0!==(128&e.flags)?(e.lanes=n,e):((r=null!==r)!==(null!==t&&null!==t.memoizedState)&&r&&(e.child.flags|=8192,0!==(1&e.mode)&&(null===t||0!==(1&ta.current)?0===Ol&&(Ol=3):mc())),null!==e.updateQueue&&(e.flags|=4),qs(e),null);case 4:return Jo(),Ps(t,e),null===t&&Vr(e.stateNode.containerInfo),qs(e),null;case 10:return Ao(e.type._context),qs(e),null;case 19:if(Ei(ta),null===(a=e.memoizedState))return qs(e),null;if(r=0!==(128&e.flags),null===(l=a.rendering))if(r)Hs(a,!1);else{if(0!==Ol||null!==t&&0!==(128&t.flags))for(t=e.child;null!==t;){if(null!==(l=ea(t))){for(e.flags|=128,Hs(a,!1),null!==(r=l.updateQueue)&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;null!==n;)t=r,(a=n).flags&=14680066,null===(l=a.alternate)?(a.childLanes=0,a.lanes=t,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,t=l.dependencies,a.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Mi(ta,1&ta.current|2),e.child}t=t.sibling}null!==a.tail&&Jt()>Vl&&(e.flags|=128,r=!0,Hs(a,!1),e.lanes=4194304)}else{if(!r)if(null!==(t=ea(l))){if(e.flags|=128,r=!0,null!==(n=t.updateQueue)&&(e.updateQueue=n,e.flags|=4),Hs(a,!0),null===a.tail&&"hidden"===a.tailMode&&!l.alternate&&!io)return qs(e),null}else 2*Jt()-a.renderingStartTime>Vl&&1073741824!==n&&(e.flags|=128,r=!0,Hs(a,!1),e.lanes=4194304);a.isBackwards?(l.sibling=e.child,e.child=l):(null!==(n=a.last)?n.sibling=l:e.child=l,a.last=l)}return null!==a.tail?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=Jt(),e.sibling=null,n=ta.current,Mi(ta,r?1&n|2:1&n),e):(qs(e),null);case 22:case 23:return hc(),r=null!==e.memoizedState,null!==t&&null!==t.memoizedState!==r&&(e.flags|=8192),r&&0!==(1&e.mode)?0!==(1073741824&Pl)&&(qs(e),6&e.subtreeFlags&&(e.flags|=8192)):qs(e),null;case 24:case 25:return null}throw Error(o(156,e.tag))}function Ys(t,e){switch(eo(e),e.tag){case 1:return Pi(e.type)&&Ni(),65536&(t=e.flags)?(e.flags=-65537&t|128,e):null;case 3:return Jo(),Ei(ki),Ei(Ai),ra(),0!==(65536&(t=e.flags))&&0===(128&t)?(e.flags=-65537&t|128,e):null;case 5:return $o(e),null;case 13:if(Ei(ta),null!==(t=e.memoizedState)&&null!==t.dehydrated){if(null===e.alternate)throw Error(o(340));fo()}return 65536&(t=e.flags)?(e.flags=-65537&t|128,e):null;case 19:return Ei(ta),null;case 4:return Jo(),null;case 10:return Ao(e.type._context),null;case 22:case 23:return hc(),null;default:return null}}Rs=function(t,e){for(var n=e.child;null!==n;){if(5===n.tag||6===n.tag)t.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ps=function(){},Ns=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Ko(qo.current);var o,a=null;switch(n){case"input":i=K(t,i),r=K(t,r),a=[];break;case"select":i=F({},i,{value:void 0}),r=F({},r,{value:void 0}),a=[];break;case"textarea":i=rt(t,i),r=rt(t,r),a=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(t.onclick=$r)}for(u in vt(n,r),n=null,i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&null!=i[u])if("style"===u){var l=i[u];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(s.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in r){var c=r[u];if(l=null!=i?i[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(a||(a=[]),a.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(a=a||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(a=a||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(s.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Br("scroll",t),a||l===c||(a=[])):(a=a||[]).push(u,c))}n&&(a=a||[]).push("style",n);var u=a;(e.updateQueue=u)&&(e.flags|=4)}},Os=function(t,e,n,r){n!==r&&(e.flags|=4)};var Ks=!1,Zs=!1,Js="function"===typeof WeakSet?WeakSet:Set,Qs=null;function $s(t,e){var n=t.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Tc(t,e,r)}else n.current=null}function tl(t,e,n){try{n()}catch(r){Tc(t,e,r)}}var el=!1;function nl(t,e,n){var r=e.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&t)===t){var o=i.destroy;i.destroy=void 0,void 0!==o&&tl(e,n,o)}i=i.next}while(i!==r)}}function rl(t,e){if(null!==(e=null!==(e=e.updateQueue)?e.lastEffect:null)){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function il(t){var e=t.ref;if(null!==e){var n=t.stateNode;t.tag,t=n,"function"===typeof e?e(t):e.current=t}}function ol(t){var e=t.alternate;null!==e&&(t.alternate=null,ol(e)),t.child=null,t.deletions=null,t.sibling=null,5===t.tag&&(null!==(e=t.stateNode)&&(delete e[di],delete e[pi],delete e[mi],delete e[gi],delete e[yi])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function al(t){return 5===t.tag||3===t.tag||4===t.tag}function sl(t){t:for(;;){for(;null===t.sibling;){if(null===t.return||al(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;5!==t.tag&&6!==t.tag&&18!==t.tag;){if(2&t.flags)continue t;if(null===t.child||4===t.tag)continue t;t.child.return=t,t=t.child}if(!(2&t.flags))return t.stateNode}}function ll(t,e,n){var r=t.tag;if(5===r||6===r)t=t.stateNode,e?8===n.nodeType?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(8===n.nodeType?(e=n.parentNode).insertBefore(t,n):(e=n).appendChild(t),null!==(n=n._reactRootContainer)&&void 0!==n||null!==e.onclick||(e.onclick=$r));else if(4!==r&&null!==(t=t.child))for(ll(t,e,n),t=t.sibling;null!==t;)ll(t,e,n),t=t.sibling}function cl(t,e,n){var r=t.tag;if(5===r||6===r)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(4!==r&&null!==(t=t.child))for(cl(t,e,n),t=t.sibling;null!==t;)cl(t,e,n),t=t.sibling}var ul=null,hl=!1;function dl(t,e,n){for(n=n.child;null!==n;)pl(t,e,n),n=n.sibling}function pl(t,e,n){if(oe&&"function"===typeof oe.onCommitFiberUnmount)try{oe.onCommitFiberUnmount(ie,n)}catch(s){}switch(n.tag){case 5:Zs||$s(n,e);case 6:var r=ul,i=hl;ul=null,dl(t,e,n),hl=i,null!==(ul=r)&&(hl?(t=ul,n=n.stateNode,8===t.nodeType?t.parentNode.removeChild(n):t.removeChild(n)):ul.removeChild(n.stateNode));break;case 18:null!==ul&&(hl?(t=ul,n=n.stateNode,8===t.nodeType?li(t.parentNode,n):1===t.nodeType&&li(t,n),Ve(t)):li(ul,n.stateNode));break;case 4:r=ul,i=hl,ul=n.stateNode.containerInfo,hl=!0,dl(t,e,n),ul=r,hl=i;break;case 0:case 11:case 14:case 15:if(!Zs&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var o=i,a=o.destroy;o=o.tag,void 0!==a&&(0!==(2&o)||0!==(4&o))&&tl(n,e,a),i=i.next}while(i!==r)}dl(t,e,n);break;case 1:if(!Zs&&($s(n,e),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){Tc(n,e,s)}dl(t,e,n);break;case 21:dl(t,e,n);break;case 22:1&n.mode?(Zs=(r=Zs)||null!==n.memoizedState,dl(t,e,n),Zs=r):dl(t,e,n);break;default:dl(t,e,n)}}function fl(t){var e=t.updateQueue;if(null!==e){t.updateQueue=null;var n=t.stateNode;null===n&&(n=t.stateNode=new Js),e.forEach((function(e){var r=Ac.bind(null,t,e);n.has(e)||(n.add(e),e.then(r,r))}))}}function ml(t,e){var n=e.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var a=t,s=e,l=s;t:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,hl=!1;break t;case 3:case 4:ul=l.stateNode.containerInfo,hl=!0;break t}l=l.return}if(null===ul)throw Error(o(160));pl(a,s,i),ul=null,hl=!1;var c=i.alternate;null!==c&&(c.return=null),i.return=null}catch(u){Tc(i,e,u)}}if(12854&e.subtreeFlags)for(e=e.child;null!==e;)gl(e,t),e=e.sibling}function gl(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ml(e,t),yl(t),4&r){try{nl(3,t,t.return),rl(3,t)}catch(g){Tc(t,t.return,g)}try{nl(5,t,t.return)}catch(g){Tc(t,t.return,g)}}break;case 1:ml(e,t),yl(t),512&r&&null!==n&&$s(n,n.return);break;case 5:if(ml(e,t),yl(t),512&r&&null!==n&&$s(n,n.return),32&t.flags){var i=t.stateNode;try{dt(i,"")}catch(g){Tc(t,t.return,g)}}if(4&r&&null!=(i=t.stateNode)){var a=t.memoizedProps,s=null!==n?n.memoizedProps:a,l=t.type,c=t.updateQueue;if(t.updateQueue=null,null!==c)try{"input"===l&&"radio"===a.type&&null!=a.name&&J(i,a),bt(l,s);var u=bt(l,a);for(s=0;s<c.length;s+=2){var h=c[s],d=c[s+1];"style"===h?gt(i,d):"dangerouslySetInnerHTML"===h?ht(i,d):"children"===h?dt(i,d):b(i,h,d,u)}switch(l){case"input":Q(i,a);break;case"textarea":ot(i,a);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var f=a.value;null!=f?nt(i,!!a.multiple,f,!1):p!==!!a.multiple&&(null!=a.defaultValue?nt(i,!!a.multiple,a.defaultValue,!0):nt(i,!!a.multiple,a.multiple?[]:"",!1))}i[pi]=a}catch(g){Tc(t,t.return,g)}}break;case 6:if(ml(e,t),yl(t),4&r){if(null===t.stateNode)throw Error(o(162));i=t.stateNode,a=t.memoizedProps;try{i.nodeValue=a}catch(g){Tc(t,t.return,g)}}break;case 3:if(ml(e,t),yl(t),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Ve(e.containerInfo)}catch(g){Tc(t,t.return,g)}break;case 4:default:ml(e,t),yl(t);break;case 13:ml(e,t),yl(t),8192&(i=t.child).flags&&(a=null!==i.memoizedState,i.stateNode.isHidden=a,!a||null!==i.alternate&&null!==i.alternate.memoizedState||(jl=Jt())),4&r&&fl(t);break;case 22:if(h=null!==n&&null!==n.memoizedState,1&t.mode?(Zs=(u=Zs)||h,ml(e,t),Zs=u):ml(e,t),yl(t),8192&r){if(u=null!==t.memoizedState,(t.stateNode.isHidden=u)&&!h&&0!==(1&t.mode))for(Qs=t,h=t.child;null!==h;){for(d=Qs=h;null!==Qs;){switch(f=(p=Qs).child,p.tag){case 0:case 11:case 14:case 15:nl(4,p,p.return);break;case 1:$s(p,p.return);var m=p.stateNode;if("function"===typeof m.componentWillUnmount){r=p,n=p.return;try{e=r,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(g){Tc(r,n,g)}}break;case 5:$s(p,p.return);break;case 22:if(null!==p.memoizedState){_l(d);continue}}null!==f?(f.return=p,Qs=f):_l(d)}h=h.sibling}t:for(h=null,d=t;;){if(5===d.tag){if(null===h){h=d;try{i=d.stateNode,u?"function"===typeof(a=i.style).setProperty?a.setProperty("display","none","important"):a.display="none":(l=d.stateNode,s=void 0!==(c=d.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=mt("display",s))}catch(g){Tc(t,t.return,g)}}}else if(6===d.tag){if(null===h)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(g){Tc(t,t.return,g)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===t)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===t)break t;for(;null===d.sibling;){if(null===d.return||d.return===t)break t;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:ml(e,t),yl(t),4&r&&fl(t);case 21:}}function yl(t){var e=t.flags;if(2&e){try{t:{for(var n=t.return;null!==n;){if(al(n)){var r=n;break t}n=n.return}throw Error(o(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(dt(i,""),r.flags&=-33),cl(t,sl(t),i);break;case 3:case 4:var a=r.stateNode.containerInfo;ll(t,sl(t),a);break;default:throw Error(o(161))}}catch(s){Tc(t,t.return,s)}t.flags&=-3}4096&e&&(t.flags&=-4097)}function vl(t,e,n){Qs=t,bl(t,e,n)}function bl(t,e,n){for(var r=0!==(1&t.mode);null!==Qs;){var i=Qs,o=i.child;if(22===i.tag&&r){var a=null!==i.memoizedState||Ks;if(!a){var s=i.alternate,l=null!==s&&null!==s.memoizedState||Zs;s=Ks;var c=Zs;if(Ks=a,(Zs=l)&&!c)for(Qs=i;null!==Qs;)l=(a=Qs).child,22===a.tag&&null!==a.memoizedState?wl(i):null!==l?(l.return=a,Qs=l):wl(i);for(;null!==o;)Qs=o,bl(o,e,n),o=o.sibling;Qs=i,Ks=s,Zs=c}xl(t)}else 0!==(8772&i.subtreeFlags)&&null!==o?(o.return=i,Qs=o):xl(t)}}function xl(t){for(;null!==Qs;){var e=Qs;if(0!==(8772&e.flags)){var n=e.alternate;try{if(0!==(8772&e.flags))switch(e.tag){case 0:case 11:case 15:Zs||rl(5,e);break;case 1:var r=e.stateNode;if(4&e.flags&&!Zs)if(null===n)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:ns(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;null!==a&&Go(e,a,r);break;case 3:var s=e.updateQueue;if(null!==s){if(n=null,null!==e.child)switch(e.child.tag){case 5:case 1:n=e.child.stateNode}Go(e,s,n)}break;case 5:var l=e.stateNode;if(null===n&&4&e.flags){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===e.memoizedState){var u=e.alternate;if(null!==u){var h=u.memoizedState;if(null!==h){var d=h.dehydrated;null!==d&&Ve(d)}}}break;default:throw Error(o(163))}Zs||512&e.flags&&il(e)}catch(p){Tc(e,e.return,p)}}if(e===t){Qs=null;break}if(null!==(n=e.sibling)){n.return=e.return,Qs=n;break}Qs=e.return}}function _l(t){for(;null!==Qs;){var e=Qs;if(e===t){Qs=null;break}var n=e.sibling;if(null!==n){n.return=e.return,Qs=n;break}Qs=e.return}}function wl(t){for(;null!==Qs;){var e=Qs;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{rl(4,e)}catch(l){Tc(e,n,l)}break;case 1:var r=e.stateNode;if("function"===typeof r.componentDidMount){var i=e.return;try{r.componentDidMount()}catch(l){Tc(e,i,l)}}var o=e.return;try{il(e)}catch(l){Tc(e,o,l)}break;case 5:var a=e.return;try{il(e)}catch(l){Tc(e,a,l)}}}catch(l){Tc(e,e.return,l)}if(e===t){Qs=null;break}var s=e.sibling;if(null!==s){s.return=e.return,Qs=s;break}Qs=e.return}}var Sl,Tl=Math.ceil,El=x.ReactCurrentDispatcher,Ml=x.ReactCurrentOwner,Cl=x.ReactCurrentBatchConfig,Al=0,kl=null,Il=null,Rl=0,Pl=0,Nl=Ti(0),Ol=0,Dl=null,Ll=0,Fl=0,Ul=0,Bl=null,zl=null,jl=0,Vl=1/0,Wl=null,Gl=!1,Hl=null,ql=null,Xl=!1,Yl=null,Kl=0,Zl=0,Jl=null,Ql=-1,$l=0;function tc(){return 0!==(6&Al)?Jt():-1!==Ql?Ql:Ql=Jt()}function ec(t){return 0===(1&t.mode)?1:0!==(2&Al)&&0!==Rl?Rl&-Rl:null!==go.transition?(0===$l&&($l=me()),$l):0!==(t=be)?t:t=void 0===(t=window.event)?16:Ze(t.type)}function nc(t,e,n,r){if(50<Zl)throw Zl=0,Jl=null,Error(o(185));ye(t,n,r),0!==(2&Al)&&t===kl||(t===kl&&(0===(2&Al)&&(Fl|=n),4===Ol&&sc(t,Rl)),rc(t,r),1===n&&0===Al&&0===(1&e.mode)&&(Vl=Jt()+500,Bi&&Vi()))}function rc(t,e){var n=t.callbackNode;!function(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,o=t.pendingLanes;0<o;){var a=31-ae(o),s=1<<a,l=i[a];-1===l?0!==(s&n)&&0===(s&r)||(i[a]=pe(s,e)):l<=e&&(t.expiredLanes|=s),o&=~s}}(t,e);var r=de(t,t===kl?Rl:0);if(0===r)null!==n&&Yt(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(null!=n&&Yt(n),1===e)0===t.tag?function(t){Bi=!0,ji(t)}(lc.bind(null,t)):ji(lc.bind(null,t)),ai((function(){0===(6&Al)&&Vi()})),n=null;else{switch(xe(r)){case 1:n=$t;break;case 4:n=te;break;case 16:default:n=ee;break;case 536870912:n=re}n=kc(n,ic.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function ic(t,e){if(Ql=-1,$l=0,0!==(6&Al))throw Error(o(327));var n=t.callbackNode;if(wc()&&t.callbackNode!==n)return null;var r=de(t,t===kl?Rl:0);if(0===r)return null;if(0!==(30&r)||0!==(r&t.expiredLanes)||e)e=gc(t,r);else{e=r;var i=Al;Al|=2;var a=fc();for(kl===t&&Rl===e||(Wl=null,Vl=Jt()+500,dc(t,e));;)try{vc();break}catch(l){pc(t,l)}Co(),El.current=a,Al=i,null!==Il?e=0:(kl=null,Rl=0,e=Ol)}if(0!==e){if(2===e&&(0!==(i=fe(t))&&(r=i,e=oc(t,i))),1===e)throw n=Dl,dc(t,0),sc(t,r),rc(t,Jt()),n;if(6===e)sc(t,r);else{if(i=t.current.alternate,0===(30&r)&&!function(t){for(var e=t;;){if(16384&e.flags){var n=e.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!sr(o(),i))return!1}catch(s){return!1}}}if(n=e.child,16384&e.subtreeFlags&&null!==n)n.return=e,e=n;else{if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}(i)&&(2===(e=gc(t,r))&&(0!==(a=fe(t))&&(r=a,e=oc(t,a))),1===e))throw n=Dl,dc(t,0),sc(t,r),rc(t,Jt()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(o(345));case 2:case 5:_c(t,zl,Wl);break;case 3:if(sc(t,r),(130023424&r)===r&&10<(e=jl+500-Jt())){if(0!==de(t,0))break;if(((i=t.suspendedLanes)&r)!==r){tc(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=ri(_c.bind(null,t,zl,Wl),e);break}_c(t,zl,Wl);break;case 4:if(sc(t,r),(4194240&r)===r)break;for(e=t.eventTimes,i=-1;0<r;){var s=31-ae(r);a=1<<s,(s=e[s])>i&&(i=s),r&=~a}if(r=i,10<(r=(120>(r=Jt()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Tl(r/1960))-r)){t.timeoutHandle=ri(_c.bind(null,t,zl,Wl),r);break}_c(t,zl,Wl);break;default:throw Error(o(329))}}}return rc(t,Jt()),t.callbackNode===n?ic.bind(null,t):null}function oc(t,e){var n=Bl;return t.current.memoizedState.isDehydrated&&(dc(t,e).flags|=256),2!==(t=gc(t,e))&&(e=zl,zl=n,null!==e&&ac(e)),t}function ac(t){null===zl?zl=t:zl.push.apply(zl,t)}function sc(t,e){for(e&=~Ul,e&=~Fl,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-ae(e),r=1<<n;t[n]=-1,e&=~r}}function lc(t){if(0!==(6&Al))throw Error(o(327));wc();var e=de(t,0);if(0===(1&e))return rc(t,Jt()),null;var n=gc(t,e);if(0!==t.tag&&2===n){var r=fe(t);0!==r&&(e=r,n=oc(t,r))}if(1===n)throw n=Dl,dc(t,0),sc(t,e),rc(t,Jt()),n;if(6===n)throw Error(o(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,_c(t,zl,Wl),rc(t,Jt()),null}function cc(t,e){var n=Al;Al|=1;try{return t(e)}finally{0===(Al=n)&&(Vl=Jt()+500,Bi&&Vi())}}function uc(t){null!==Yl&&0===Yl.tag&&0===(6&Al)&&wc();var e=Al;Al|=1;var n=Cl.transition,r=be;try{if(Cl.transition=null,be=1,t)return t()}finally{be=r,Cl.transition=n,0===(6&(Al=e))&&Vi()}}function hc(){Pl=Nl.current,Ei(Nl)}function dc(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(-1!==n&&(t.timeoutHandle=-1,ii(n)),null!==Il)for(n=Il.return;null!==n;){var r=n;switch(eo(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Ni();break;case 3:Jo(),Ei(ki),Ei(Ai),ra();break;case 5:$o(r);break;case 4:Jo();break;case 13:case 19:Ei(ta);break;case 10:Ao(r.type._context);break;case 22:case 23:hc()}n=n.return}if(kl=t,Il=t=Nc(t.current,null),Rl=Pl=e,Ol=0,Dl=null,Ul=Fl=Ll=0,zl=Bl=null,null!==Po){for(e=0;e<Po.length;e++)if(null!==(r=(n=Po[e]).interleaved)){n.interleaved=null;var i=r.next,o=n.pending;if(null!==o){var a=o.next;o.next=i,r.next=a}n.pending=r}Po=null}return t}function pc(t,e){for(;;){var n=Il;try{if(Co(),ia.current=Qa,ua){for(var r=sa.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}ua=!1}if(aa=0,ca=la=sa=null,ha=!1,da=0,Ml.current=null,null===n||null===n.return){Ol=1,Dl=e,Il=null;break}t:{var a=t,s=n.return,l=n,c=e;if(e=Rl,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,h=l,d=h.tag;if(0===(1&h.mode)&&(0===d||11===d||15===d)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var f=gs(s);if(null!==f){f.flags&=-257,ys(f,s,l,0,e),1&f.mode&&ms(a,u,e),c=u;var m=(e=f).updateQueue;if(null===m){var g=new Set;g.add(c),e.updateQueue=g}else m.add(c);break t}if(0===(1&e)){ms(a,u,e),mc();break t}c=Error(o(426))}else if(io&&1&l.mode){var y=gs(s);if(null!==y){0===(65536&y.flags)&&(y.flags|=256),ys(y,s,l,0,e),mo(cs(c,l));break t}}a=c=cs(c,l),4!==Ol&&(Ol=2),null===Bl?Bl=[a]:Bl.push(a),a=s;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e,Vo(a,ps(0,c,e));break t;case 1:l=c;var v=a.type,b=a.stateNode;if(0===(128&a.flags)&&("function"===typeof v.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===ql||!ql.has(b)))){a.flags|=65536,e&=-e,a.lanes|=e,Vo(a,fs(a,l,e));break t}}a=a.return}while(null!==a)}xc(n)}catch(x){e=x,Il===n&&null!==n&&(Il=n=n.return);continue}break}}function fc(){var t=El.current;return El.current=Qa,null===t?Qa:t}function mc(){0!==Ol&&3!==Ol&&2!==Ol||(Ol=4),null===kl||0===(268435455&Ll)&&0===(268435455&Fl)||sc(kl,Rl)}function gc(t,e){var n=Al;Al|=2;var r=fc();for(kl===t&&Rl===e||(Wl=null,dc(t,e));;)try{yc();break}catch(i){pc(t,i)}if(Co(),Al=n,El.current=r,null!==Il)throw Error(o(261));return kl=null,Rl=0,Ol}function yc(){for(;null!==Il;)bc(Il)}function vc(){for(;null!==Il&&!Kt();)bc(Il)}function bc(t){var e=Sl(t.alternate,t,Pl);t.memoizedProps=t.pendingProps,null===e?xc(t):Il=e,Ml.current=null}function xc(t){var e=t;do{var n=e.alternate;if(t=e.return,0===(32768&e.flags)){if(null!==(n=Xs(n,e,Pl)))return void(Il=n)}else{if(null!==(n=Ys(n,e)))return n.flags&=32767,void(Il=n);if(null===t)return Ol=6,void(Il=null);t.flags|=32768,t.subtreeFlags=0,t.deletions=null}if(null!==(e=e.sibling))return void(Il=e);Il=e=t}while(null!==e);0===Ol&&(Ol=5)}function _c(t,e,n){var r=be,i=Cl.transition;try{Cl.transition=null,be=1,function(t,e,n,r){do{wc()}while(null!==Yl);if(0!==(6&Al))throw Error(o(327));n=t.finishedWork;var i=t.finishedLanes;if(null===n)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(o(177));t.callbackNode=null,t.callbackPriority=0;var a=n.lanes|n.childLanes;if(function(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-ae(n),o=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~o}}(t,a),t===kl&&(Il=kl=null,Rl=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Xl||(Xl=!0,kc(ee,(function(){return wc(),null}))),a=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||a){a=Cl.transition,Cl.transition=null;var s=be;be=1;var l=Al;Al|=4,Ml.current=null,function(t,e){if(ti=Ge,pr(t=dr())){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else t:{var r=(n=(n=t.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch(_){n=null;break t}var s=0,l=-1,c=-1,u=0,h=0,d=t,p=null;e:for(;;){for(var f;d!==n||0!==i&&3!==d.nodeType||(l=s+i),d!==a||0!==r&&3!==d.nodeType||(c=s+r),3===d.nodeType&&(s+=d.nodeValue.length),null!==(f=d.firstChild);)p=d,d=f;for(;;){if(d===t)break e;if(p===n&&++u===i&&(l=s),p===a&&++h===r&&(c=s),null!==(f=d.nextSibling))break;p=(d=p).parentNode}d=f}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ei={focusedElem:t,selectionRange:n},Ge=!1,Qs=e;null!==Qs;)if(t=(e=Qs).child,0!==(1028&e.subtreeFlags)&&null!==t)t.return=e,Qs=t;else for(;null!==Qs;){e=Qs;try{var m=e.alternate;if(0!==(1024&e.flags))switch(e.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,y=m.memoizedState,v=e.stateNode,b=v.getSnapshotBeforeUpdate(e.elementType===e.type?g:ns(e.type,g),y);v.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var x=e.stateNode.containerInfo;1===x.nodeType?x.textContent="":9===x.nodeType&&x.documentElement&&x.removeChild(x.documentElement);break;default:throw Error(o(163))}}catch(_){Tc(e,e.return,_)}if(null!==(t=e.sibling)){t.return=e.return,Qs=t;break}Qs=e.return}m=el,el=!1}(t,n),gl(n,t),fr(ei),Ge=!!ti,ei=ti=null,t.current=n,vl(n,t,i),Zt(),Al=l,be=s,Cl.transition=a}else t.current=n;if(Xl&&(Xl=!1,Yl=t,Kl=i),a=t.pendingLanes,0===a&&(ql=null),function(t){if(oe&&"function"===typeof oe.onCommitFiberRoot)try{oe.onCommitFiberRoot(ie,t,void 0,128===(128&t.current.flags))}catch(e){}}(n.stateNode),rc(t,Jt()),null!==e)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Gl)throw Gl=!1,t=Hl,Hl=null,t;0!==(1&Kl)&&0!==t.tag&&wc(),a=t.pendingLanes,0!==(1&a)?t===Jl?Zl++:(Zl=0,Jl=t):Zl=0,Vi()}(t,e,n,r)}finally{Cl.transition=i,be=r}return null}function wc(){if(null!==Yl){var t=xe(Kl),e=Cl.transition,n=be;try{if(Cl.transition=null,be=16>t?16:t,null===Yl)var r=!1;else{if(t=Yl,Yl=null,Kl=0,0!==(6&Al))throw Error(o(331));var i=Al;for(Al|=4,Qs=t.current;null!==Qs;){var a=Qs,s=a.child;if(0!==(16&Qs.flags)){var l=a.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Qs=u;null!==Qs;){var h=Qs;switch(h.tag){case 0:case 11:case 15:nl(8,h,a)}var d=h.child;if(null!==d)d.return=h,Qs=d;else for(;null!==Qs;){var p=(h=Qs).sibling,f=h.return;if(ol(h),h===u){Qs=null;break}if(null!==p){p.return=f,Qs=p;break}Qs=f}}}var m=a.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(null!==g)}}Qs=a}}if(0!==(2064&a.subtreeFlags)&&null!==s)s.return=a,Qs=s;else t:for(;null!==Qs;){if(0!==(2048&(a=Qs).flags))switch(a.tag){case 0:case 11:case 15:nl(9,a,a.return)}var v=a.sibling;if(null!==v){v.return=a.return,Qs=v;break t}Qs=a.return}}var b=t.current;for(Qs=b;null!==Qs;){var x=(s=Qs).child;if(0!==(2064&s.subtreeFlags)&&null!==x)x.return=s,Qs=x;else t:for(s=b;null!==Qs;){if(0!==(2048&(l=Qs).flags))try{switch(l.tag){case 0:case 11:case 15:rl(9,l)}}catch(w){Tc(l,l.return,w)}if(l===s){Qs=null;break t}var _=l.sibling;if(null!==_){_.return=l.return,Qs=_;break t}Qs=l.return}}if(Al=i,Vi(),oe&&"function"===typeof oe.onPostCommitFiberRoot)try{oe.onPostCommitFiberRoot(ie,t)}catch(w){}r=!0}return r}finally{be=n,Cl.transition=e}}return!1}function Sc(t,e,n){t=zo(t,e=ps(0,e=cs(n,e),1),1),e=tc(),null!==t&&(ye(t,1,e),rc(t,e))}function Tc(t,e,n){if(3===t.tag)Sc(t,t,n);else for(;null!==e;){if(3===e.tag){Sc(e,t,n);break}if(1===e.tag){var r=e.stateNode;if("function"===typeof e.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===ql||!ql.has(r))){e=zo(e,t=fs(e,t=cs(n,t),1),1),t=tc(),null!==e&&(ye(e,1,t),rc(e,t));break}}e=e.return}}function Ec(t,e,n){var r=t.pingCache;null!==r&&r.delete(e),e=tc(),t.pingedLanes|=t.suspendedLanes&n,kl===t&&(Rl&n)===n&&(4===Ol||3===Ol&&(130023424&Rl)===Rl&&500>Jt()-jl?dc(t,0):Ul|=n),rc(t,e)}function Mc(t,e){0===e&&(0===(1&t.mode)?e=1:(e=ue,0===(130023424&(ue<<=1))&&(ue=4194304)));var n=tc();null!==(t=Do(t,e))&&(ye(t,e,n),rc(t,n))}function Cc(t){var e=t.memoizedState,n=0;null!==e&&(n=e.retryLane),Mc(t,n)}function Ac(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(o(314))}null!==r&&r.delete(e),Mc(t,n)}function kc(t,e){return Xt(t,e)}function Ic(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Rc(t,e,n,r){return new Ic(t,e,n,r)}function Pc(t){return!(!(t=t.prototype)||!t.isReactComponent)}function Nc(t,e){var n=t.alternate;return null===n?((n=Rc(t.tag,e,t.key,t.mode)).elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&t.flags,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Oc(t,e,n,r,i,a){var s=2;if(r=t,"function"===typeof t)Pc(t)&&(s=1);else if("string"===typeof t)s=5;else t:switch(t){case S:return Dc(n.children,i,a,e);case T:s=8,i|=8;break;case E:return(t=Rc(12,n,e,2|i)).elementType=E,t.lanes=a,t;case k:return(t=Rc(13,n,e,i)).elementType=k,t.lanes=a,t;case I:return(t=Rc(19,n,e,i)).elementType=I,t.lanes=a,t;case N:return Lc(n,i,a,e);default:if("object"===typeof t&&null!==t)switch(t.$$typeof){case M:s=10;break t;case C:s=9;break t;case A:s=11;break t;case R:s=14;break t;case P:s=16,r=null;break t}throw Error(o(130,null==t?t:typeof t,""))}return(e=Rc(s,n,e,i)).elementType=t,e.type=r,e.lanes=a,e}function Dc(t,e,n,r){return(t=Rc(7,t,r,e)).lanes=n,t}function Lc(t,e,n,r){return(t=Rc(22,t,r,e)).elementType=N,t.lanes=n,t.stateNode={isHidden:!1},t}function Fc(t,e,n){return(t=Rc(6,t,null,e)).lanes=n,t}function Uc(t,e,n){return(e=Rc(4,null!==t.children?t.children:[],t.key,e)).lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Bc(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ge(0),this.expirationTimes=ge(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ge(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function zc(t,e,n,r,i,o,a,s,l){return t=new Bc(t,e,n,s,l),1===e?(e=1,!0===o&&(e|=8)):e=0,o=Rc(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Fo(o),t}function jc(t){if(!t)return Ci;t:{if(Vt(t=t._reactInternals)!==t||1!==t.tag)throw Error(o(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break t;case 1:if(Pi(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break t}}e=e.return}while(null!==e);throw Error(o(171))}if(1===t.tag){var n=t.type;if(Pi(n))return Di(t,n,e)}return e}function Vc(t,e,n,r,i,o,a,s,l){return(t=zc(n,r,!0,t,0,o,0,s,l)).context=jc(null),n=t.current,(o=Bo(r=tc(),i=ec(n))).callback=void 0!==e&&null!==e?e:null,zo(n,o,i),t.current.lanes=i,ye(t,i,r),rc(t,r),t}function Wc(t,e,n,r){var i=e.current,o=tc(),a=ec(i);return n=jc(n),null===e.context?e.context=n:e.pendingContext=n,(e=Bo(o,a)).payload={element:t},null!==(r=void 0===r?null:r)&&(e.callback=r),null!==(t=zo(i,e,a))&&(nc(t,i,a,o),jo(t,i,a)),a}function Gc(t){return(t=t.current).child?(t.child.tag,t.child.stateNode):null}function Hc(t,e){if(null!==(t=t.memoizedState)&&null!==t.dehydrated){var n=t.retryLane;t.retryLane=0!==n&&n<e?n:e}}function qc(t,e){Hc(t,e),(t=t.alternate)&&Hc(t,e)}Sl=function(t,e,n){if(null!==t)if(t.memoizedProps!==e.pendingProps||ki.current)bs=!0;else{if(0===(t.lanes&n)&&0===(128&e.flags))return bs=!1,function(t,e,n){switch(e.tag){case 3:ks(e),fo();break;case 5:Qo(e);break;case 1:Pi(e.type)&&Li(e);break;case 4:Zo(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Mi(So,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=e.memoizedState))return null!==r.dehydrated?(Mi(ta,1&ta.current),e.flags|=128,null):0!==(n&e.child.childLanes)?Fs(t,e,n):(Mi(ta,1&ta.current),null!==(t=Gs(t,e,n))?t.sibling:null);Mi(ta,1&ta.current);break;case 19:if(r=0!==(n&e.childLanes),0!==(128&t.flags)){if(r)return Vs(t,e,n);e.flags|=128}if(null!==(i=e.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Mi(ta,ta.current),r)break;return null;case 22:case 23:return e.lanes=0,Ts(t,e,n)}return Gs(t,e,n)}(t,e,n);bs=0!==(131072&t.flags)}else bs=!1,io&&0!==(1048576&e.flags)&&$i(e,qi,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Ws(t,e),t=e.pendingProps;var i=Ri(e,Ai.current);Io(e,n),i=ga(null,e,r,t,i,n);var a=ya();return e.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Pi(r)?(a=!0,Li(e)):a=!1,e.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,Fo(e),i.updater=is,e.stateNode=i,i._reactInternals=e,ls(e,r,t,n),e=As(null,e,r,!0,a,n)):(e.tag=0,io&&a&&to(e),xs(null,e,i,n),e=e.child),e;case 16:r=e.elementType;t:{switch(Ws(t,e),t=e.pendingProps,r=(i=r._init)(r._payload),e.type=r,i=e.tag=function(t){if("function"===typeof t)return Pc(t)?1:0;if(void 0!==t&&null!==t){if((t=t.$$typeof)===A)return 11;if(t===R)return 14}return 2}(r),t=ns(r,t),i){case 0:e=Ms(null,e,r,t,n);break t;case 1:e=Cs(null,e,r,t,n);break t;case 11:e=_s(null,e,r,t,n);break t;case 14:e=ws(null,e,r,ns(r.type,t),n);break t}throw Error(o(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,Ms(t,e,r,i=e.elementType===r?i:ns(r,i),n);case 1:return r=e.type,i=e.pendingProps,Cs(t,e,r,i=e.elementType===r?i:ns(r,i),n);case 3:t:{if(ks(e),null===t)throw Error(o(387));r=e.pendingProps,i=(a=e.memoizedState).element,Uo(t,e),Wo(e,r,null,n);var s=e.memoizedState;if(r=s.element,a.isDehydrated){if(a={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=a,e.memoizedState=a,256&e.flags){e=Is(t,e,r,n,i=cs(Error(o(423)),e));break t}if(r!==i){e=Is(t,e,r,n,i=cs(Error(o(424)),e));break t}for(ro=ci(e.stateNode.containerInfo.firstChild),no=e,io=!0,oo=null,n=wo(e,null,r,n),e.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fo(),r===i){e=Gs(t,e,n);break t}xs(t,e,r,n)}e=e.child}return e;case 5:return Qo(e),null===t&&co(e),r=e.type,i=e.pendingProps,a=null!==t?t.memoizedProps:null,s=i.children,ni(r,i)?s=null:null!==a&&ni(r,a)&&(e.flags|=32),Es(t,e),xs(t,e,s,n),e.child;case 6:return null===t&&co(e),null;case 13:return Fs(t,e,n);case 4:return Zo(e,e.stateNode.containerInfo),r=e.pendingProps,null===t?e.child=_o(e,null,r,n):xs(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,_s(t,e,r,i=e.elementType===r?i:ns(r,i),n);case 7:return xs(t,e,e.pendingProps,n),e.child;case 8:case 12:return xs(t,e,e.pendingProps.children,n),e.child;case 10:t:{if(r=e.type._context,i=e.pendingProps,a=e.memoizedProps,s=i.value,Mi(So,r._currentValue),r._currentValue=s,null!==a)if(sr(a.value,s)){if(a.children===i.children&&!ki.current){e=Gs(t,e,n);break t}}else for(null!==(a=e.child)&&(a.return=e);null!==a;){var l=a.dependencies;if(null!==l){s=a.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===a.tag){(c=Bo(-1,n&-n)).tag=2;var u=a.updateQueue;if(null!==u){var h=(u=u.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}a.lanes|=n,null!==(c=a.alternate)&&(c.lanes|=n),ko(a.return,n,e),l.lanes|=n;break}c=c.next}}else if(10===a.tag)s=a.type===e.type?null:a.child;else if(18===a.tag){if(null===(s=a.return))throw Error(o(341));s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),ko(s,n,e),s=a.sibling}else s=a.child;if(null!==s)s.return=a;else for(s=a;null!==s;){if(s===e){s=null;break}if(null!==(a=s.sibling)){a.return=s.return,s=a;break}s=s.return}a=s}xs(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Io(e,n),r=r(i=Ro(i)),e.flags|=1,xs(t,e,r,n),e.child;case 14:return i=ns(r=e.type,e.pendingProps),ws(t,e,r,i=ns(r.type,i),n);case 15:return Ss(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ns(r,i),Ws(t,e),e.tag=1,Pi(r)?(t=!0,Li(e)):t=!1,Io(e,n),as(e,r,i),ls(e,r,i,n),As(null,e,r,!0,t,n);case 19:return Vs(t,e,n);case 22:return Ts(t,e,n)}throw Error(o(156,e.tag))};var Xc="function"===typeof reportError?reportError:function(t){console.error(t)};function Yc(t){this._internalRoot=t}function Kc(t){this._internalRoot=t}function Zc(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)}function Jc(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType&&(8!==t.nodeType||" react-mount-point-unstable "!==t.nodeValue))}function Qc(){}function $c(t,e,n,r,i){var o=n._reactRootContainer;if(o){var a=o;if("function"===typeof i){var s=i;i=function(){var t=Gc(a);s.call(t)}}Wc(e,a,t,i)}else a=function(t,e,n,r,i){if(i){if("function"===typeof r){var o=r;r=function(){var t=Gc(a);o.call(t)}}var a=Vc(e,r,t,0,null,!1,0,"",Qc);return t._reactRootContainer=a,t[fi]=a.current,Vr(8===t.nodeType?t.parentNode:t),uc(),a}for(;i=t.lastChild;)t.removeChild(i);if("function"===typeof r){var s=r;r=function(){var t=Gc(l);s.call(t)}}var l=zc(t,0,!1,null,0,!1,0,"",Qc);return t._reactRootContainer=l,t[fi]=l.current,Vr(8===t.nodeType?t.parentNode:t),uc((function(){Wc(e,l,n,r)})),l}(n,e,t,i,r);return Gc(a)}Kc.prototype.render=Yc.prototype.render=function(t){var e=this._internalRoot;if(null===e)throw Error(o(409));Wc(t,e,null,null)},Kc.prototype.unmount=Yc.prototype.unmount=function(){var t=this._internalRoot;if(null!==t){this._internalRoot=null;var e=t.containerInfo;uc((function(){Wc(null,t,null,null)})),e[fi]=null}},Kc.prototype.unstable_scheduleHydration=function(t){if(t){var e=Te();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Ne.length&&0!==e&&e<Ne[n].priority;n++);Ne.splice(n,0,t),0===n&&Fe(t)}},_e=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=he(e.pendingLanes);0!==n&&(ve(e,1|n),rc(e,Jt()),0===(6&Al)&&(Vl=Jt()+500,Vi()))}break;case 13:uc((function(){var e=Do(t,1);if(null!==e){var n=tc();nc(e,t,1,n)}})),qc(t,1)}},we=function(t){if(13===t.tag){var e=Do(t,134217728);if(null!==e)nc(e,t,134217728,tc());qc(t,134217728)}},Se=function(t){if(13===t.tag){var e=ec(t),n=Do(t,e);if(null!==n)nc(n,t,e,tc());qc(t,e)}},Te=function(){return be},Ee=function(t,e){var n=be;try{return be=t,e()}finally{be=n}},wt=function(t,e,n){switch(e){case"input":if(Q(t,n),e=n.name,"radio"===n.type&&null!=e){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=_i(r);if(!i)throw Error(o(90));X(r),Q(r,i)}}}break;case"textarea":ot(t,n);break;case"select":null!=(e=n.value)&&nt(t,!!n.multiple,e,!1)}},At=cc,kt=uc;var tu={usingClientEntryPoint:!1,Events:[bi,xi,_i,Mt,Ct,cc]},eu={findFiberByHostInstance:vi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nu={bundleType:eu.bundleType,version:eu.version,rendererPackageName:eu.rendererPackageName,rendererConfig:eu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:x.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return null===(t=Ht(t))?null:t.stateNode},findFiberByHostInstance:eu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ru=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ru.isDisabled&&ru.supportsFiber)try{ie=ru.inject(nu),oe=ru}catch(ut){}}e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tu,e.createPortal=function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Zc(e))throw Error(o(200));return function(t,e,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:w,key:null==r?null:""+r,children:t,containerInfo:e,implementation:n}}(t,e,null,n)},e.createRoot=function(t,e){if(!Zc(t))throw Error(o(299));var n=!1,r="",i=Xc;return null!==e&&void 0!==e&&(!0===e.unstable_strictMode&&(n=!0),void 0!==e.identifierPrefix&&(r=e.identifierPrefix),void 0!==e.onRecoverableError&&(i=e.onRecoverableError)),e=zc(t,1,!1,null,0,n,0,r,i),t[fi]=e.current,Vr(8===t.nodeType?t.parentNode:t),new Yc(e)},e.findDOMNode=function(t){if(null==t)return null;if(1===t.nodeType)return t;var e=t._reactInternals;if(void 0===e){if("function"===typeof t.render)throw Error(o(188));throw t=Object.keys(t).join(","),Error(o(268,t))}return t=null===(t=Ht(e))?null:t.stateNode},e.flushSync=function(t){return uc(t)},e.hydrate=function(t,e,n){if(!Jc(e))throw Error(o(200));return $c(null,t,e,!0,n)},e.hydrateRoot=function(t,e,n){if(!Zc(t))throw Error(o(405));var r=null!=n&&n.hydratedSources||null,i=!1,a="",s=Xc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(a=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),e=Vc(e,null,t,1,null!=n?n:null,i,0,a,s),t[fi]=e.current,Vr(t),r)for(t=0;t<r.length;t++)i=(i=(n=r[t])._getVersion)(n._source),null==e.mutableSourceEagerHydrationData?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Kc(e)},e.render=function(t,e,n){if(!Jc(e))throw Error(o(200));return $c(null,t,e,!1,n)},e.unmountComponentAtNode=function(t){if(!Jc(t))throw Error(o(40));return!!t._reactRootContainer&&(uc((function(){$c(null,null,t,!1,(function(){t._reactRootContainer=null,t[fi]=null}))})),!0)},e.unstable_batchedUpdates=cc,e.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Jc(n))throw Error(o(200));if(null==t||void 0===t._reactInternals)throw Error(o(38));return $c(t,e,n,!1,r)},e.version="18.3.1-next-f1338f8080-20240426"},391:(t,e,n)=>{"use strict";var r=n(950);e.createRoot=r.createRoot,e.hydrateRoot=r.hydrateRoot},950:(t,e,n)=>{"use strict";!function t(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}(),t.exports=n(730)},612:(t,e)=>{"use strict";function n(t,e){var n=t.length;t.push(e);t:for(;0<n;){var r=n-1>>>1,i=t[r];if(!(0<o(i,e)))break t;t[r]=e,t[n]=i,n=r}}function r(t){return 0===t.length?null:t[0]}function i(t){if(0===t.length)return null;var e=t[0],n=t.pop();if(n!==e){t[0]=n;t:for(var r=0,i=t.length,a=i>>>1;r<a;){var s=2*(r+1)-1,l=t[s],c=s+1,u=t[c];if(0>o(l,n))c<i&&0>o(u,l)?(t[r]=u,t[c]=n,r=c):(t[r]=l,t[s]=n,r=s);else{if(!(c<i&&0>o(u,n)))break t;t[r]=u,t[c]=n,r=c}}}return e}function o(t,e){var n=t.sortIndex-e.sortIndex;return 0!==n?n:t.id-e.id}if("object"===typeof performance&&"function"===typeof performance.now){var a=performance;e.unstable_now=function(){return a.now()}}else{var s=Date,l=s.now();e.unstable_now=function(){return s.now()-l}}var c=[],u=[],h=1,d=null,p=3,f=!1,m=!1,g=!1,y="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function x(t){for(var e=r(u);null!==e;){if(null===e.callback)i(u);else{if(!(e.startTime<=t))break;i(u),e.sortIndex=e.expirationTime,n(c,e)}e=r(u)}}function _(t){if(g=!1,x(t),!m)if(null!==r(c))m=!0,N(w);else{var e=r(u);null!==e&&O(_,e.startTime-t)}}function w(t,n){m=!1,g&&(g=!1,v(M),M=-1),f=!0;var o=p;try{for(x(n),d=r(c);null!==d&&(!(d.expirationTime>n)||t&&!k());){var a=d.callback;if("function"===typeof a){d.callback=null,p=d.priorityLevel;var s=a(d.expirationTime<=n);n=e.unstable_now(),"function"===typeof s?d.callback=s:d===r(c)&&i(c),x(n)}else i(c);d=r(c)}if(null!==d)var l=!0;else{var h=r(u);null!==h&&O(_,h.startTime-n),l=!1}return l}finally{d=null,p=o,f=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var S,T=!1,E=null,M=-1,C=5,A=-1;function k(){return!(e.unstable_now()-A<C)}function I(){if(null!==E){var t=e.unstable_now();A=t;var n=!0;try{n=E(!0,t)}finally{n?S():(T=!1,E=null)}}else T=!1}if("function"===typeof b)S=function(){b(I)};else if("undefined"!==typeof MessageChannel){var R=new MessageChannel,P=R.port2;R.port1.onmessage=I,S=function(){P.postMessage(null)}}else S=function(){y(I,0)};function N(t){E=t,T||(T=!0,S())}function O(t,n){M=y((function(){t(e.unstable_now())}),n)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(t){t.callback=null},e.unstable_continueExecution=function(){m||f||(m=!0,N(w))},e.unstable_forceFrameRate=function(t){0>t||125<t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<t?Math.floor(1e3/t):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(t){switch(p){case 1:case 2:case 3:var e=3;break;default:e=p}var n=p;p=e;try{return t()}finally{p=n}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var n=p;p=t;try{return e()}finally{p=n}},e.unstable_scheduleCallback=function(t,i,o){var a=e.unstable_now();switch("object"===typeof o&&null!==o?o="number"===typeof(o=o.delay)&&0<o?a+o:a:o=a,t){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return t={id:h++,callback:i,priorityLevel:t,startTime:o,expirationTime:s=o+s,sortIndex:-1},o>a?(t.sortIndex=o,n(u,t),null===r(c)&&t===r(u)&&(g?(v(M),M=-1):g=!0,O(_,o-a))):(t.sortIndex=s,n(c,t),m||f||(m=!0,N(w))),t},e.unstable_shouldYield=k,e.unstable_wrapCallback=function(t){var e=p;return function(){var n=p;p=e;try{return t.apply(this,arguments)}finally{p=n}}}},67:(t,e,n)=>{"use strict";t.exports=n(612)},302:(t,e)=>{"use strict";e.ConcurrentRoot=1,e.ContinuousEventPriority=4,e.DefaultEventPriority=16,e.DiscreteEventPriority=1},958:(t,e,n)=>{t.exports=function(t){var e={},r=n(43),i=n(853),o=Object.assign;function a(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,l=Symbol.for("react.element"),c=Symbol.for("react.portal"),u=Symbol.for("react.fragment"),h=Symbol.for("react.strict_mode"),d=Symbol.for("react.profiler"),p=Symbol.for("react.provider"),f=Symbol.for("react.context"),m=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),y=Symbol.for("react.suspense_list"),v=Symbol.for("react.memo"),b=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var x=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var _=Symbol.iterator;function w(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=_&&t[_]||t["@@iterator"])?t:null}function S(t){if(null==t)return null;if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t;switch(t){case u:return"Fragment";case c:return"Portal";case d:return"Profiler";case h:return"StrictMode";case g:return"Suspense";case y:return"SuspenseList"}if("object"===typeof t)switch(t.$$typeof){case f:return(t.displayName||"Context")+".Consumer";case p:return(t._context.displayName||"Context")+".Provider";case m:var e=t.render;return(t=t.displayName)||(t=""!==(t=e.displayName||e.name||"")?"ForwardRef("+t+")":"ForwardRef"),t;case v:return null!==(e=t.displayName||null)?e:S(t.type)||"Memo";case b:e=t._payload,t=t._init;try{return S(t(e))}catch(n){}}return null}function T(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=(t=e.render).displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return S(e);case 8:return e===h?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e}return null}function E(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do{0!==(4098&(e=t).flags)&&(n=e.return),t=e.return}while(t)}return 3===e.tag?n:null}function M(t){if(E(t)!==t)throw Error(a(188))}function C(t){var e=t.alternate;if(!e){if(null===(e=E(t)))throw Error(a(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(r=i.return)){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return M(i),t;if(o===r)return M(i),e;o=o.sibling}throw Error(a(188))}if(n.return!==r.return)n=i,r=o;else{for(var s=!1,l=i.child;l;){if(l===n){s=!0,n=i,r=o;break}if(l===r){s=!0,r=i,n=o;break}l=l.sibling}if(!s){for(l=o.child;l;){if(l===n){s=!0,n=o,r=i;break}if(l===r){s=!0,r=o,n=i;break}l=l.sibling}if(!s)throw Error(a(189))}}if(n.alternate!==r)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?t:e}function A(t){return null!==(t=C(t))?k(t):null}function k(t){if(5===t.tag||6===t.tag)return t;for(t=t.child;null!==t;){var e=k(t);if(null!==e)return e;t=t.sibling}return null}function I(t){if(5===t.tag||6===t.tag)return t;for(t=t.child;null!==t;){if(4!==t.tag){var e=I(t);if(null!==e)return e}t=t.sibling}return null}var R,P=Array.isArray,N=t.getPublicInstance,O=t.getRootHostContext,D=t.getChildHostContext,L=t.prepareForCommit,F=t.resetAfterCommit,U=t.createInstance,B=t.appendInitialChild,z=t.finalizeInitialChildren,j=t.prepareUpdate,V=t.shouldSetTextContent,W=t.createTextInstance,G=t.scheduleTimeout,H=t.cancelTimeout,q=t.noTimeout,X=t.isPrimaryRenderer,Y=t.supportsMutation,K=t.supportsPersistence,Z=t.supportsHydration,J=t.getInstanceFromNode,Q=t.preparePortalMount,$=t.getCurrentEventPriority,tt=t.detachDeletedInstance,et=t.supportsMicrotasks,nt=t.scheduleMicrotask,rt=t.supportsTestSelectors,it=t.findFiberRoot,ot=t.getBoundingRect,at=t.getTextContent,st=t.isHiddenSubtree,lt=t.matchAccessibilityRole,ct=t.setFocusIfFocusable,ut=t.setupIntersectionObserver,ht=t.appendChild,dt=t.appendChildToContainer,pt=t.commitTextUpdate,ft=t.commitMount,mt=t.commitUpdate,gt=t.insertBefore,yt=t.insertInContainerBefore,vt=t.removeChild,bt=t.removeChildFromContainer,xt=t.resetTextContent,_t=t.hideInstance,wt=t.hideTextInstance,St=t.unhideInstance,Tt=t.unhideTextInstance,Et=t.clearContainer,Mt=t.cloneInstance,Ct=t.createContainerChildSet,At=t.appendChildToContainerChildSet,kt=t.finalizeContainerChildren,It=t.replaceContainerChildren,Rt=t.cloneHiddenInstance,Pt=t.cloneHiddenTextInstance,Nt=t.canHydrateInstance,Ot=t.canHydrateTextInstance,Dt=t.canHydrateSuspenseInstance,Lt=t.isSuspenseInstancePending,Ft=t.isSuspenseInstanceFallback,Ut=t.registerSuspenseInstanceRetry,Bt=t.getNextHydratableSibling,zt=t.getFirstHydratableChild,jt=t.getFirstHydratableChildWithinContainer,Vt=t.getFirstHydratableChildWithinSuspenseInstance,Wt=t.hydrateInstance,Gt=t.hydrateTextInstance,Ht=t.hydrateSuspenseInstance,qt=t.getNextHydratableInstanceAfterSuspenseInstance,Xt=t.commitHydratedContainer,Yt=t.commitHydratedSuspenseInstance,Kt=t.clearSuspenseBoundary,Zt=t.clearSuspenseBoundaryFromContainer,Jt=t.shouldDeleteUnhydratedTailInstances,Qt=t.didNotMatchHydratedContainerTextInstance,$t=t.didNotMatchHydratedTextInstance;function te(t){if(void 0===R)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);R=e&&e[1]||""}return"\n"+R+t}var ee=!1;function ne(t,e){if(!t||ee)return"";ee=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var i=c.stack.split("\n"),o=r.stack.split("\n"),a=i.length-1,s=o.length-1;1<=a&&0<=s&&i[a]!==o[s];)s--;for(;1<=a&&0<=s;a--,s--)if(i[a]!==o[s]){if(1!==a||1!==s)do{if(a--,0>--s||i[a]!==o[s]){var l="\n"+i[a].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}}while(1<=a&&0<=s);break}}}finally{ee=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?te(t):""}var re=Object.prototype.hasOwnProperty,ie=[],oe=-1;function ae(t){return{current:t}}function se(t){0>oe||(t.current=ie[oe],ie[oe]=null,oe--)}function le(t,e){oe++,ie[oe]=t.current,t.current=e}var ce={},ue=ae(ce),he=ae(!1),de=ce;function pe(t,e){var n=t.type.contextTypes;if(!n)return ce;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i,o={};for(i in n)o[i]=e[i];return r&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=o),o}function fe(t){return null!==(t=t.childContextTypes)&&void 0!==t}function me(){se(he),se(ue)}function ge(t,e,n){if(ue.current!==ce)throw Error(a(168));le(ue,e),le(he,n)}function ye(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in e))throw Error(a(108,T(t)||"Unknown",i));return o({},n,r)}function ve(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ce,de=ue.current,le(ue,t),le(he,he.current),!0}function be(t,e,n){var r=t.stateNode;if(!r)throw Error(a(169));n?(t=ye(t,e,de),r.__reactInternalMemoizedMergedChildContext=t,se(he),se(ue),le(ue,t)):se(he),le(he,n)}var xe=Math.clz32?Math.clz32:function(t){return 0===(t>>>=0)?32:31-(_e(t)/we|0)|0},_e=Math.log,we=Math.LN2;var Se=64,Te=4194304;function Ee(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&t;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&t;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Me(t,e){var n=t.pendingLanes;if(0===n)return 0;var r=0,i=t.suspendedLanes,o=t.pingedLanes,a=268435455&n;if(0!==a){var s=a&~i;0!==s?r=Ee(s):0!==(o&=a)&&(r=Ee(o))}else 0!==(a=n&~i)?r=Ee(a):0!==o&&(r=Ee(o));if(0===r)return 0;if(0!==e&&e!==r&&0===(e&i)&&((i=r&-r)>=(o=e&-e)||16===i&&0!==(4194240&o)))return e;if(0!==(4&r)&&(r|=16&n),0!==(e=t.entangledLanes))for(t=t.entanglements,e&=r;0<e;)i=1<<(n=31-xe(e)),r|=t[n],e&=~i;return r}function Ce(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;default:return-1}}function Ae(t){return 0!==(t=-1073741825&t.pendingLanes)?t:1073741824&t?1073741824:0}function ke(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Ie(t,e,n){t.pendingLanes|=e,536870912!==e&&(t.suspendedLanes=0,t.pingedLanes=0),(t=t.eventTimes)[e=31-xe(e)]=n}function Re(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-xe(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Pe=0;function Ne(t){return 1<(t&=-t)?4<t?0!==(268435455&t)?16:536870912:4:1}var Oe=i.unstable_scheduleCallback,De=i.unstable_cancelCallback,Le=i.unstable_shouldYield,Fe=i.unstable_requestPaint,Ue=i.unstable_now,Be=i.unstable_ImmediatePriority,ze=i.unstable_UserBlockingPriority,je=i.unstable_NormalPriority,Ve=i.unstable_IdlePriority,We=null,Ge=null;var He="function"===typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t===1/e)||t!==t&&e!==e},qe=null,Xe=!1,Ye=!1;function Ke(t){null===qe?qe=[t]:qe.push(t)}function Ze(){if(!Ye&&null!==qe){Ye=!0;var t=0,e=Pe;try{var n=qe;for(Pe=1;t<n.length;t++){var r=n[t];do{r=r(!0)}while(null!==r)}qe=null,Xe=!1}catch(i){throw null!==qe&&(qe=qe.slice(t+1)),Oe(Be,Ze),i}finally{Pe=e,Ye=!1}}return null}var Je=s.ReactCurrentBatchConfig;function Qe(t,e){if(He(t,e))return!0;if("object"!==typeof t||null===t||"object"!==typeof e||null===e)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!re.call(e,i)||!He(t[i],e[i]))return!1}return!0}function $e(t){switch(t.tag){case 5:return te(t.type);case 16:return te("Lazy");case 13:return te("Suspense");case 19:return te("SuspenseList");case 0:case 2:case 15:return t=ne(t.type,!1);case 11:return t=ne(t.type.render,!1);case 1:return t=ne(t.type,!0);default:return""}}function tn(t,e){if(t&&t.defaultProps){for(var n in e=o({},e),t=t.defaultProps)void 0===e[n]&&(e[n]=t[n]);return e}return e}var en=ae(null),nn=null,rn=null,on=null;function an(){on=rn=nn=null}function sn(t,e,n){X?(le(en,e._currentValue),e._currentValue=n):(le(en,e._currentValue2),e._currentValue2=n)}function ln(t){var e=en.current;se(en),X?t._currentValue=e:t._currentValue2=e}function cn(t,e,n){for(;null!==t;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,null!==r&&(r.childLanes|=e)):null!==r&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function un(t,e){nn=t,on=rn=null,null!==(t=t.dependencies)&&null!==t.firstContext&&(0!==(t.lanes&e)&&(Li=!0),t.firstContext=null)}function hn(t){var e=X?t._currentValue:t._currentValue2;if(on!==t)if(t={context:t,memoizedValue:e,next:null},null===rn){if(null===nn)throw Error(a(308));rn=t,nn.dependencies={lanes:0,firstContext:t}}else rn=rn.next=t;return e}var dn=null,pn=!1;function fn(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function mn(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function gn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function yn(t,e){var n=t.updateQueue;null!==n&&(n=n.shared,null!==Ko&&0!==(1&t.mode)&&0===(2&Yo)?(null===(t=n.interleaved)?(e.next=e,null===dn?dn=[n]:dn.push(n)):(e.next=t.next,t.next=e),n.interleaved=e):(null===(t=n.pending)?e.next=e:(e.next=t.next,t.next=e),n.pending=e))}function vn(t,e,n){if(null!==(e=e.updateQueue)&&(e=e.shared,0!==(4194240&n))){var r=e.lanes;n|=r&=t.pendingLanes,e.lanes=n,Re(t,n)}}function bn(t,e){var n=t.updateQueue,r=t.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===o?i=o=a:o=o.next=a,n=n.next}while(null!==n);null===o?i=o=e:o=o.next=e}else i=o=e;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},void(t.updateQueue=n)}null===(t=n.lastBaseUpdate)?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function xn(t,e,n,r){var i=t.updateQueue;pn=!1;var a=i.firstBaseUpdate,s=i.lastBaseUpdate,l=i.shared.pending;if(null!==l){i.shared.pending=null;var c=l,u=c.next;c.next=null,null===s?a=u:s.next=u,s=c;var h=t.alternate;null!==h&&((l=(h=h.updateQueue).lastBaseUpdate)!==s&&(null===l?h.firstBaseUpdate=u:l.next=u,h.lastBaseUpdate=c))}if(null!==a){var d=i.baseState;for(s=0,h=u=c=null,l=a;;){var p=l.lane,f=l.eventTime;if((r&p)===p){null!==h&&(h=h.next={eventTime:f,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});t:{var m=t,g=l;switch(p=e,f=n,g.tag){case 1:if("function"===typeof(m=g.payload)){d=m.call(f,d,p);break t}d=m;break t;case 3:m.flags=-65537&m.flags|128;case 0:if(null===(p="function"===typeof(m=g.payload)?m.call(f,d,p):m)||void 0===p)break t;d=o({},d,p);break t;case 2:pn=!0}}null!==l.callback&&0!==l.lane&&(t.flags|=64,null===(p=i.effects)?i.effects=[l]:p.push(l))}else f={eventTime:f,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},null===h?(u=h=f,c=d):h=h.next=f,s|=p;if(null===(l=l.next)){if(null===(l=i.shared.pending))break;l=(p=l).next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}if(null===h&&(c=d),i.baseState=c,i.firstBaseUpdate=u,i.lastBaseUpdate=h,null!==(e=i.shared.interleaved)){i=e;do{s|=i.lane,i=i.next}while(i!==e)}else null===a&&(i.shared.lanes=0);na|=s,t.lanes=s,t.memoizedState=d}}function _n(t,e,n){if(t=e.effects,e.effects=null,null!==t)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(a(191,i));i.call(r)}}}var wn=(new r.Component).refs;function Sn(t,e,n,r){n=null===(n=n(r,e=t.memoizedState))||void 0===n?e:o({},e,n),t.memoizedState=n,0===t.lanes&&(t.updateQueue.baseState=n)}var Tn={isMounted:function(t){return!!(t=t._reactInternals)&&E(t)===t},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=_a(),i=wa(t),o=gn(r,i);o.payload=e,void 0!==n&&null!==n&&(o.callback=n),yn(t,o),null!==(e=Sa(t,i,r))&&vn(e,t,i)},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=_a(),i=wa(t),o=gn(r,i);o.tag=1,o.payload=e,void 0!==n&&null!==n&&(o.callback=n),yn(t,o),null!==(e=Sa(t,i,r))&&vn(e,t,i)},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=_a(),r=wa(t),i=gn(n,r);i.tag=2,void 0!==e&&null!==e&&(i.callback=e),yn(t,i),null!==(e=Sa(t,r,n))&&vn(e,t,r)}};function En(t,e,n,r,i,o,a){return"function"===typeof(t=t.stateNode).shouldComponentUpdate?t.shouldComponentUpdate(r,o,a):!e.prototype||!e.prototype.isPureReactComponent||(!Qe(n,r)||!Qe(i,o))}function Mn(t,e,n){var r=!1,i=ce,o=e.contextType;return"object"===typeof o&&null!==o?o=hn(o):(i=fe(e)?de:ue.current,o=(r=null!==(r=e.contextTypes)&&void 0!==r)?pe(t,i):ce),e=new e(n,o),t.memoizedState=null!==e.state&&void 0!==e.state?e.state:null,e.updater=Tn,t.stateNode=e,e._reactInternals=t,r&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=o),e}function Cn(t,e,n,r){t=e.state,"function"===typeof e.componentWillReceiveProps&&e.componentWillReceiveProps(n,r),"function"===typeof e.UNSAFE_componentWillReceiveProps&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Tn.enqueueReplaceState(e,e.state,null)}function An(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs=wn,fn(t);var o=e.contextType;"object"===typeof o&&null!==o?i.context=hn(o):(o=fe(e)?de:ue.current,i.context=pe(t,o)),i.state=t.memoizedState,"function"===typeof(o=e.getDerivedStateFromProps)&&(Sn(t,e,o,n),i.state=t.memoizedState),"function"===typeof e.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(e=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),e!==i.state&&Tn.enqueueReplaceState(i,i.state,null),xn(t,n,i,r),i.state=t.memoizedState),"function"===typeof i.componentDidMount&&(t.flags|=4194308)}var kn=[],In=0,Rn=null,Pn=0,Nn=[],On=0,Dn=null,Ln=1,Fn="";function Un(t,e){kn[In++]=Pn,kn[In++]=Rn,Rn=t,Pn=e}function Bn(t,e,n){Nn[On++]=Ln,Nn[On++]=Fn,Nn[On++]=Dn,Dn=t;var r=Ln;t=Fn;var i=32-xe(r)-1;r&=~(1<<i),n+=1;var o=32-xe(e)+i;if(30<o){var a=i-i%5;o=(r&(1<<a)-1).toString(32),r>>=a,i-=a,Ln=1<<32-xe(e)+i|n<<i|r,Fn=o+t}else Ln=1<<o|n<<i|r,Fn=t}function zn(t){null!==t.return&&(Un(t,1),Bn(t,1,0))}function jn(t){for(;t===Rn;)Rn=kn[--In],kn[In]=null,Pn=kn[--In],kn[In]=null;for(;t===Dn;)Dn=Nn[--On],Nn[On]=null,Fn=Nn[--On],Nn[On]=null,Ln=Nn[--On],Nn[On]=null}var Vn=null,Wn=null,Gn=!1,Hn=!1,qn=null;function Xn(t,e){var n=Qa(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,null===(e=t.deletions)?(t.deletions=[n],t.flags|=16):e.push(n)}function Yn(t,e){switch(t.tag){case 5:return null!==(e=Nt(e,t.type,t.pendingProps))&&(t.stateNode=e,Vn=t,Wn=zt(e),!0);case 6:return null!==(e=Ot(e,t.pendingProps))&&(t.stateNode=e,Vn=t,Wn=null,!0);case 13:if(null!==(e=Dt(e))){var n=null!==Dn?{id:Ln,overflow:Fn}:null;return t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},(n=Qa(18,null,null,0)).stateNode=e,n.return=t,t.child=n,Vn=t,Wn=null,!0}return!1;default:return!1}}function Kn(t){return 0!==(1&t.mode)&&0===(128&t.flags)}function Zn(t){if(Gn){var e=Wn;if(e){var n=e;if(!Yn(t,e)){if(Kn(t))throw Error(a(418));e=Bt(n);var r=Vn;e&&Yn(t,e)?Xn(r,n):(t.flags=-4097&t.flags|2,Gn=!1,Vn=t)}}else{if(Kn(t))throw Error(a(418));t.flags=-4097&t.flags|2,Gn=!1,Vn=t}}}function Jn(t){for(t=t.return;null!==t&&5!==t.tag&&3!==t.tag&&13!==t.tag;)t=t.return;Vn=t}function Qn(t){if(!Z||t!==Vn)return!1;if(!Gn)return Jn(t),Gn=!0,!1;if(3!==t.tag&&(5!==t.tag||Jt(t.type)&&!V(t.type,t.memoizedProps))){var e=Wn;if(e){if(Kn(t)){for(t=Wn;t;)t=Bt(t);throw Error(a(418))}for(;e;)Xn(t,e),e=Bt(e)}}if(Jn(t),13===t.tag){if(!Z)throw Error(a(316));if(!(t=null!==(t=t.memoizedState)?t.dehydrated:null))throw Error(a(317));Wn=qt(t)}else Wn=Vn?Bt(t.stateNode):null;return!0}function $n(){Z&&(Wn=Vn=null,Hn=Gn=!1)}function tr(t){null===qn?qn=[t]:qn.push(t)}function er(t,e,n){if(null!==(t=n.ref)&&"function"!==typeof t&&"object"!==typeof t){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(a(309));var r=n.stateNode}if(!r)throw Error(a(147,t));var i=r,o=""+t;return null!==e&&null!==e.ref&&"function"===typeof e.ref&&e.ref._stringRef===o?e.ref:(e=function(t){var e=i.refs;e===wn&&(e=i.refs={}),null===t?delete e[o]:e[o]=t},e._stringRef=o,e)}if("string"!==typeof t)throw Error(a(284));if(!n._owner)throw Error(a(290,t))}return t}function nr(t,e){throw t=Object.prototype.toString.call(e),Error(a(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function rr(t){return(0,t._init)(t._payload)}function ir(t){function e(e,n){if(t){var r=e.deletions;null===r?(e.deletions=[n],e.flags|=16):r.push(n)}}function n(n,r){if(!t)return null;for(;null!==r;)e(n,r),r=r.sibling;return null}function r(t,e){for(t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function i(t,e){return(t=ts(t,e)).index=0,t.sibling=null,t}function o(e,n,r){return e.index=r,t?null!==(r=e.alternate)?(r=r.index)<n?(e.flags|=2,n):r:(e.flags|=2,n):(e.flags|=1048576,n)}function s(e){return t&&null===e.alternate&&(e.flags|=2),e}function h(t,e,n,r){return null===e||6!==e.tag?((e=is(n,t.mode,r)).return=t,e):((e=i(e,n)).return=t,e)}function d(t,e,n,r){var o=n.type;return o===u?f(t,e,n.props.children,r,n.key):null!==e&&(e.elementType===o||"object"===typeof o&&null!==o&&o.$$typeof===b&&rr(o)===e.type)?((r=i(e,n.props)).ref=er(t,e,n),r.return=t,r):((r=es(n.type,n.key,n.props,null,t.mode,r)).ref=er(t,e,n),r.return=t,r)}function p(t,e,n,r){return null===e||4!==e.tag||e.stateNode.containerInfo!==n.containerInfo||e.stateNode.implementation!==n.implementation?((e=os(n,t.mode,r)).return=t,e):((e=i(e,n.children||[])).return=t,e)}function f(t,e,n,r,o){return null===e||7!==e.tag?((e=ns(n,t.mode,r,o)).return=t,e):((e=i(e,n)).return=t,e)}function m(t,e,n){if("string"===typeof e&&""!==e||"number"===typeof e)return(e=is(""+e,t.mode,n)).return=t,e;if("object"===typeof e&&null!==e){switch(e.$$typeof){case l:return(n=es(e.type,e.key,e.props,null,t.mode,n)).ref=er(t,null,e),n.return=t,n;case c:return(e=os(e,t.mode,n)).return=t,e;case b:return m(t,(0,e._init)(e._payload),n)}if(P(e)||w(e))return(e=ns(e,t.mode,n,null)).return=t,e;nr(t,e)}return null}function g(t,e,n,r){var i=null!==e?e.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:h(t,e,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case l:return n.key===i?d(t,e,n,r):null;case c:return n.key===i?p(t,e,n,r):null;case b:return g(t,e,(i=n._init)(n._payload),r)}if(P(n)||w(n))return null!==i?null:f(t,e,n,r,null);nr(t,n)}return null}function y(t,e,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r)return h(e,t=t.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case l:return d(e,t=t.get(null===r.key?n:r.key)||null,r,i);case c:return p(e,t=t.get(null===r.key?n:r.key)||null,r,i);case b:return y(t,e,n,(0,r._init)(r._payload),i)}if(P(r)||w(r))return f(e,t=t.get(n)||null,r,i,null);nr(e,r)}return null}function v(i,a,s,l){for(var c=null,u=null,h=a,d=a=0,p=null;null!==h&&d<s.length;d++){h.index>d?(p=h,h=null):p=h.sibling;var f=g(i,h,s[d],l);if(null===f){null===h&&(h=p);break}t&&h&&null===f.alternate&&e(i,h),a=o(f,a,d),null===u?c=f:u.sibling=f,u=f,h=p}if(d===s.length)return n(i,h),Gn&&Un(i,d),c;if(null===h){for(;d<s.length;d++)null!==(h=m(i,s[d],l))&&(a=o(h,a,d),null===u?c=h:u.sibling=h,u=h);return Gn&&Un(i,d),c}for(h=r(i,h);d<s.length;d++)null!==(p=y(h,i,d,s[d],l))&&(t&&null!==p.alternate&&h.delete(null===p.key?d:p.key),a=o(p,a,d),null===u?c=p:u.sibling=p,u=p);return t&&h.forEach((function(t){return e(i,t)})),Gn&&Un(i,d),c}function x(i,s,l,c){var u=w(l);if("function"!==typeof u)throw Error(a(150));if(null==(l=u.call(l)))throw Error(a(151));for(var h=u=null,d=s,p=s=0,f=null,v=l.next();null!==d&&!v.done;p++,v=l.next()){d.index>p?(f=d,d=null):f=d.sibling;var b=g(i,d,v.value,c);if(null===b){null===d&&(d=f);break}t&&d&&null===b.alternate&&e(i,d),s=o(b,s,p),null===h?u=b:h.sibling=b,h=b,d=f}if(v.done)return n(i,d),Gn&&Un(i,p),u;if(null===d){for(;!v.done;p++,v=l.next())null!==(v=m(i,v.value,c))&&(s=o(v,s,p),null===h?u=v:h.sibling=v,h=v);return Gn&&Un(i,p),u}for(d=r(i,d);!v.done;p++,v=l.next())null!==(v=y(d,i,p,v.value,c))&&(t&&null!==v.alternate&&d.delete(null===v.key?p:v.key),s=o(v,s,p),null===h?u=v:h.sibling=v,h=v);return t&&d.forEach((function(t){return e(i,t)})),Gn&&Un(i,p),u}return function t(r,o,a,h){if("object"===typeof a&&null!==a&&a.type===u&&null===a.key&&(a=a.props.children),"object"===typeof a&&null!==a){switch(a.$$typeof){case l:t:{for(var d=a.key,p=o;null!==p;){if(p.key===d){if((d=a.type)===u){if(7===p.tag){n(r,p.sibling),(o=i(p,a.props.children)).return=r,r=o;break t}}else if(p.elementType===d||"object"===typeof d&&null!==d&&d.$$typeof===b&&rr(d)===p.type){n(r,p.sibling),(o=i(p,a.props)).ref=er(r,p,a),o.return=r,r=o;break t}n(r,p);break}e(r,p),p=p.sibling}a.type===u?((o=ns(a.props.children,r.mode,h,a.key)).return=r,r=o):((h=es(a.type,a.key,a.props,null,r.mode,h)).ref=er(r,o,a),h.return=r,r=h)}return s(r);case c:t:{for(p=a.key;null!==o;){if(o.key===p){if(4===o.tag&&o.stateNode.containerInfo===a.containerInfo&&o.stateNode.implementation===a.implementation){n(r,o.sibling),(o=i(o,a.children||[])).return=r,r=o;break t}n(r,o);break}e(r,o),o=o.sibling}(o=os(a,r.mode,h)).return=r,r=o}return s(r);case b:return t(r,o,(p=a._init)(a._payload),h)}if(P(a))return v(r,o,a,h);if(w(a))return x(r,o,a,h);nr(r,a)}return"string"===typeof a&&""!==a||"number"===typeof a?(a=""+a,null!==o&&6===o.tag?(n(r,o.sibling),(o=i(o,a)).return=r,r=o):(n(r,o),(o=is(a,r.mode,h)).return=r,r=o),s(r)):n(r,o)}}var or=ir(!0),ar=ir(!1),sr={},lr=ae(sr),cr=ae(sr),ur=ae(sr);function hr(t){if(t===sr)throw Error(a(174));return t}function dr(t,e){le(ur,e),le(cr,t),le(lr,sr),t=O(e),se(lr),le(lr,t)}function pr(){se(lr),se(cr),se(ur)}function fr(t){var e=hr(ur.current),n=hr(lr.current);n!==(e=D(n,t.type,e))&&(le(cr,t),le(lr,e))}function mr(t){cr.current===t&&(se(lr),se(cr))}var gr=ae(0);function yr(t){for(var e=t;null!==e;){if(13===e.tag){var n=e.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||Lt(n)||Ft(n)))return e}else if(19===e.tag&&void 0!==e.memoizedProps.revealOrder){if(0!==(128&e.flags))return e}else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var vr=[];function br(){for(var t=0;t<vr.length;t++){var e=vr[t];X?e._workInProgressVersionPrimary=null:e._workInProgressVersionSecondary=null}vr.length=0}var xr=s.ReactCurrentDispatcher,_r=s.ReactCurrentBatchConfig,wr=0,Sr=null,Tr=null,Er=null,Mr=!1,Cr=!1,Ar=0,kr=0;function Ir(){throw Error(a(321))}function Rr(t,e){if(null===e)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!He(t[n],e[n]))return!1;return!0}function Pr(t,e,n,r,i,o){if(wr=o,Sr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,xr.current=null===t||null===t.memoizedState?fi:mi,t=n(r,i),Cr){o=0;do{if(Cr=!1,Ar=0,25<=o)throw Error(a(301));o+=1,Er=Tr=null,e.updateQueue=null,xr.current=gi,t=n(r,i)}while(Cr)}if(xr.current=pi,e=null!==Tr&&null!==Tr.next,wr=0,Er=Tr=Sr=null,Mr=!1,e)throw Error(a(300));return t}function Nr(){var t=0!==Ar;return Ar=0,t}function Or(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Er?Sr.memoizedState=Er=t:Er=Er.next=t,Er}function Dr(){if(null===Tr){var t=Sr.alternate;t=null!==t?t.memoizedState:null}else t=Tr.next;var e=null===Er?Sr.memoizedState:Er.next;if(null!==e)Er=e,Tr=t;else{if(null===t)throw Error(a(310));t={memoizedState:(Tr=t).memoizedState,baseState:Tr.baseState,baseQueue:Tr.baseQueue,queue:Tr.queue,next:null},null===Er?Sr.memoizedState=Er=t:Er=Er.next=t}return Er}function Lr(t,e){return"function"===typeof e?e(t):e}function Fr(t){var e=Dr(),n=e.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=t;var r=Tr,i=r.baseQueue,o=n.pending;if(null!==o){if(null!==i){var s=i.next;i.next=o.next,o.next=s}r.baseQueue=i=o,n.pending=null}if(null!==i){o=i.next,r=r.baseState;var l=s=null,c=null,u=o;do{var h=u.lane;if((wr&h)===h)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=d,s=r):c=c.next=d,Sr.lanes|=h,na|=h}u=u.next}while(null!==u&&u!==o);null===c?s=r:c.next=l,He(r,e.memoizedState)||(Li=!0),e.memoizedState=r,e.baseState=s,e.baseQueue=c,n.lastRenderedState=r}if(null!==(t=n.interleaved)){i=t;do{o=i.lane,Sr.lanes|=o,na|=o,i=i.next}while(i!==t)}else null===i&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Ur(t){var e=Dr(),n=e.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,o=e.memoizedState;if(null!==i){n.pending=null;var s=i=i.next;do{o=t(o,s.action),s=s.next}while(s!==i);He(o,e.memoizedState)||(Li=!0),e.memoizedState=o,null===e.baseQueue&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function Br(){}function zr(t,e){var n=Sr,r=Dr(),i=e(),o=!He(r.memoizedState,i);if(o&&(r.memoizedState=i,Li=!0),r=r.queue,Jr(Wr.bind(null,n,r,t),[t]),r.getSnapshot!==e||o||null!==Er&&1&Er.memoizedState.tag){if(n.flags|=2048,qr(9,Vr.bind(null,n,r,i,e),void 0,null),null===Ko)throw Error(a(349));0!==(30&wr)||jr(n,e,i)}return i}function jr(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},null===(e=Sr.updateQueue)?(e={lastEffect:null,stores:null},Sr.updateQueue=e,e.stores=[t]):null===(n=e.stores)?e.stores=[t]:n.push(t)}function Vr(t,e,n,r){e.value=n,e.getSnapshot=r,Gr(e)&&Sa(t,1,-1)}function Wr(t,e,n){return n((function(){Gr(e)&&Sa(t,1,-1)}))}function Gr(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!He(t,n)}catch(r){return!0}}function Hr(t){var e=Or();return"function"===typeof t&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Lr,lastRenderedState:t},e.queue=t,t=t.dispatch=li.bind(null,Sr,t),[e.memoizedState,t]}function qr(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},null===(e=Sr.updateQueue)?(e={lastEffect:null,stores:null},Sr.updateQueue=e,e.lastEffect=t.next=t):null===(n=e.lastEffect)?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t),t}function Xr(){return Dr().memoizedState}function Yr(t,e,n,r){var i=Or();Sr.flags|=t,i.memoizedState=qr(1|e,n,void 0,void 0===r?null:r)}function Kr(t,e,n,r){var i=Dr();r=void 0===r?null:r;var o=void 0;if(null!==Tr){var a=Tr.memoizedState;if(o=a.destroy,null!==r&&Rr(r,a.deps))return void(i.memoizedState=qr(e,n,o,r))}Sr.flags|=t,i.memoizedState=qr(1|e,n,o,r)}function Zr(t,e){return Yr(8390656,8,t,e)}function Jr(t,e){return Kr(2048,8,t,e)}function Qr(t,e){return Kr(4,2,t,e)}function $r(t,e){return Kr(4,4,t,e)}function ti(t,e){return"function"===typeof e?(t=t(),e(t),function(){e(null)}):null!==e&&void 0!==e?(t=t(),e.current=t,function(){e.current=null}):void 0}function ei(t,e,n){return n=null!==n&&void 0!==n?n.concat([t]):null,Kr(4,4,ti.bind(null,e,t),n)}function ni(){}function ri(t,e){var n=Dr();e=void 0===e?null:e;var r=n.memoizedState;return null!==r&&null!==e&&Rr(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function ii(t,e){var n=Dr();e=void 0===e?null:e;var r=n.memoizedState;return null!==r&&null!==e&&Rr(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function oi(t,e){var n=Pe;Pe=0!==n&&4>n?n:4,t(!0);var r=_r.transition;_r.transition={};try{t(!1),e()}finally{Pe=n,_r.transition=r}}function ai(){return Dr().memoizedState}function si(t,e,n){var r=wa(t);n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},ci(t)?ui(e,n):(hi(t,e,n),null!==(t=Sa(t,r,n=_a()))&&di(t,e,r))}function li(t,e,n){var r=wa(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(ci(t))ui(e,i);else{hi(t,e,i);var o=t.alternate;if(0===t.lanes&&(null===o||0===o.lanes)&&null!==(o=e.lastRenderedReducer))try{var a=e.lastRenderedState,s=o(a,n);if(i.hasEagerState=!0,i.eagerState=s,He(s,a))return}catch(l){}null!==(t=Sa(t,r,n=_a()))&&di(t,e,r)}}function ci(t){var e=t.alternate;return t===Sr||null!==e&&e===Sr}function ui(t,e){Cr=Mr=!0;var n=t.pending;null===n?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function hi(t,e,n){null!==Ko&&0!==(1&t.mode)&&0===(2&Yo)?(null===(t=e.interleaved)?(n.next=n,null===dn?dn=[e]:dn.push(e)):(n.next=t.next,t.next=n),e.interleaved=n):(null===(t=e.pending)?n.next=n:(n.next=t.next,t.next=n),e.pending=n)}function di(t,e,n){if(0!==(4194240&n)){var r=e.lanes;n|=r&=t.pendingLanes,e.lanes=n,Re(t,n)}}var pi={readContext:hn,useCallback:Ir,useContext:Ir,useEffect:Ir,useImperativeHandle:Ir,useInsertionEffect:Ir,useLayoutEffect:Ir,useMemo:Ir,useReducer:Ir,useRef:Ir,useState:Ir,useDebugValue:Ir,useDeferredValue:Ir,useTransition:Ir,useMutableSource:Ir,useSyncExternalStore:Ir,useId:Ir,unstable_isNewReconciler:!1},fi={readContext:hn,useCallback:function(t,e){return Or().memoizedState=[t,void 0===e?null:e],t},useContext:hn,useEffect:Zr,useImperativeHandle:function(t,e,n){return n=null!==n&&void 0!==n?n.concat([t]):null,Yr(4194308,4,ti.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Yr(4194308,4,t,e)},useInsertionEffect:function(t,e){return Yr(4,2,t,e)},useMemo:function(t,e){var n=Or();return e=void 0===e?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Or();return e=void 0!==n?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=si.bind(null,Sr,t),[r.memoizedState,t]},useRef:function(t){return t={current:t},Or().memoizedState=t},useState:Hr,useDebugValue:ni,useDeferredValue:function(t){var e=Hr(t),n=e[0],r=e[1];return Zr((function(){var e=_r.transition;_r.transition={};try{r(t)}finally{_r.transition=e}}),[t]),n},useTransition:function(){var t=Hr(!1),e=t[0];return t=oi.bind(null,t[1]),Or().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Sr,i=Or();if(Gn){if(void 0===n)throw Error(a(407));n=n()}else{if(n=e(),null===Ko)throw Error(a(349));0!==(30&wr)||jr(r,e,n)}i.memoizedState=n;var o={value:n,getSnapshot:e};return i.queue=o,Zr(Wr.bind(null,r,o,t),[t]),r.flags|=2048,qr(9,Vr.bind(null,r,o,n,e),void 0,null),n},useId:function(){var t=Or(),e=Ko.identifierPrefix;if(Gn){var n=Fn;e=":"+e+"R"+(n=(Ln&~(1<<32-xe(Ln)-1)).toString(32)+n),0<(n=Ar++)&&(e+="H"+n.toString(32)),e+=":"}else e=":"+e+"r"+(n=kr++).toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},mi={readContext:hn,useCallback:ri,useContext:hn,useEffect:Jr,useImperativeHandle:ei,useInsertionEffect:Qr,useLayoutEffect:$r,useMemo:ii,useReducer:Fr,useRef:Xr,useState:function(){return Fr(Lr)},useDebugValue:ni,useDeferredValue:function(t){var e=Fr(Lr),n=e[0],r=e[1];return Jr((function(){var e=_r.transition;_r.transition={};try{r(t)}finally{_r.transition=e}}),[t]),n},useTransition:function(){return[Fr(Lr)[0],Dr().memoizedState]},useMutableSource:Br,useSyncExternalStore:zr,useId:ai,unstable_isNewReconciler:!1},gi={readContext:hn,useCallback:ri,useContext:hn,useEffect:Jr,useImperativeHandle:ei,useInsertionEffect:Qr,useLayoutEffect:$r,useMemo:ii,useReducer:Ur,useRef:Xr,useState:function(){return Ur(Lr)},useDebugValue:ni,useDeferredValue:function(t){var e=Ur(Lr),n=e[0],r=e[1];return Jr((function(){var e=_r.transition;_r.transition={};try{r(t)}finally{_r.transition=e}}),[t]),n},useTransition:function(){return[Ur(Lr)[0],Dr().memoizedState]},useMutableSource:Br,useSyncExternalStore:zr,useId:ai,unstable_isNewReconciler:!1};function yi(t,e){try{var n="",r=e;do{n+=$e(r),r=r.return}while(r);var i=n}catch(o){i="\nError generating stack: "+o.message+"\n"+o.stack}return{value:t,source:e,stack:i}}function vi(t,e){try{console.error(e.value)}catch(n){setTimeout((function(){throw n}))}}var bi,xi,_i,wi,Si="function"===typeof WeakMap?WeakMap:Map;function Ti(t,e,n){(n=gn(-1,n)).tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){ha||(ha=!0,da=r),vi(0,e)},n}function Ei(t,e,n){(n=gn(-1,n)).tag=3;var r=t.type.getDerivedStateFromError;if("function"===typeof r){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){vi(0,e)}}var o=t.stateNode;return null!==o&&"function"===typeof o.componentDidCatch&&(n.callback=function(){vi(0,e),"function"!==typeof r&&(null===pa?pa=new Set([this]):pa.add(this));var t=e.stack;this.componentDidCatch(e.value,{componentStack:null!==t?t:""})}),n}function Mi(t,e,n){var r=t.pingCache;if(null===r){r=t.pingCache=new Si;var i=new Set;r.set(e,i)}else void 0===(i=r.get(e))&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=qa.bind(null,t,e,n),e.then(t,t))}function Ci(t){do{var e;if((e=13===t.tag)&&(e=null===(e=t.memoizedState)||null!==e.dehydrated),e)return t;t=t.return}while(null!==t);return null}function Ai(t,e,n,r,i){return 0===(1&t.mode)?(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((e=gn(-1,1)).tag=2,yn(n,e))),n.lanes|=1),t):(t.flags|=65536,t.lanes=i,t)}function ki(t){t.flags|=4}function Ii(t,e){if(null!==t&&t.child===e.child)return!0;if(0!==(16&e.flags))return!1;for(t=e.child;null!==t;){if(0!==(12854&t.flags)||0!==(12854&t.subtreeFlags))return!1;t=t.sibling}return!0}if(Y)bi=function(t,e){for(var n=e.child;null!==n;){if(5===n.tag||6===n.tag)B(t,n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},xi=function(){},_i=function(t,e,n,r,i){if((t=t.memoizedProps)!==r){var o=e.stateNode,a=hr(lr.current);n=j(o,n,t,r,i,a),(e.updateQueue=n)&&ki(e)}},wi=function(t,e,n,r){n!==r&&ki(e)};else if(K){bi=function(t,e,n,r){for(var i=e.child;null!==i;){if(5===i.tag){var o=i.stateNode;n&&r&&(o=Rt(o,i.type,i.memoizedProps,i)),B(t,o)}else if(6===i.tag)o=i.stateNode,n&&r&&(o=Pt(o,i.memoizedProps,i)),B(t,o);else if(4!==i.tag)if(22===i.tag&&null!==i.memoizedState)null!==(o=i.child)&&(o.return=i),bi(t,i,!0,!0);else if(null!==i.child){i.child.return=i,i=i.child;continue}if(i===e)break;for(;null===i.sibling;){if(null===i.return||i.return===e)return;i=i.return}i.sibling.return=i.return,i=i.sibling}};var Ri=function(t,e,n,r){for(var i=e.child;null!==i;){if(5===i.tag){var o=i.stateNode;n&&r&&(o=Rt(o,i.type,i.memoizedProps,i)),At(t,o)}else if(6===i.tag)o=i.stateNode,n&&r&&(o=Pt(o,i.memoizedProps,i)),At(t,o);else if(4!==i.tag)if(22===i.tag&&null!==i.memoizedState)null!==(o=i.child)&&(o.return=i),Ri(t,i,!0,!0);else if(null!==i.child){i.child.return=i,i=i.child;continue}if(i===e)break;for(;null===i.sibling;){if(null===i.return||i.return===e)return;i=i.return}i.sibling.return=i.return,i=i.sibling}};xi=function(t,e){var n=e.stateNode;if(!Ii(t,e)){t=n.containerInfo;var r=Ct(t);Ri(r,e,!1,!1),n.pendingChildren=r,ki(e),kt(t,r)}},_i=function(t,e,n,r,i){var o=t.stateNode,a=t.memoizedProps;if((t=Ii(t,e))&&a===r)e.stateNode=o;else{var s=e.stateNode,l=hr(lr.current),c=null;a!==r&&(c=j(s,n,a,r,i,l)),t&&null===c?e.stateNode=o:(o=Mt(o,c,n,a,r,e,t,s),z(o,n,r,i,l)&&ki(e),e.stateNode=o,t?ki(e):bi(o,e,!1,!1))}},wi=function(t,e,n,r){n!==r?(t=hr(ur.current),n=hr(lr.current),e.stateNode=W(r,t,n,e),ki(e)):e.stateNode=t.stateNode}}else xi=function(){},_i=function(){},wi=function(){};function Pi(t,e){if(!Gn)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;null!==e;)null!==e.alternate&&(n=e),e=e.sibling;null===n?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?e||null===t.tail?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Ni(t){var e=null!==t.alternate&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=t,i=i.sibling;else for(i=t.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function Oi(t,e,n){var r=e.pendingProps;switch(jn(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ni(e),null;case 1:case 17:return fe(e.type)&&me(),Ni(e),null;case 3:return r=e.stateNode,pr(),se(he),se(ue),br(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==t&&null!==t.child||(Qn(e)?ki(e):null===t||t.memoizedState.isDehydrated&&0===(256&e.flags)||(e.flags|=1024,null!==qn&&(Aa(qn),qn=null))),xi(t,e),Ni(e),null;case 5:mr(e),n=hr(ur.current);var i=e.type;if(null!==t&&null!=e.stateNode)_i(t,e,i,r,n),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(null===e.stateNode)throw Error(a(166));return Ni(e),null}if(t=hr(lr.current),Qn(e)){if(!Z)throw Error(a(175));t=Wt(e.stateNode,e.type,e.memoizedProps,n,t,e,!Hn),e.updateQueue=t,null!==t&&ki(e)}else{var o=U(i,r,n,t,e);bi(o,e,!1,!1),e.stateNode=o,z(o,i,r,n,t)&&ki(e)}null!==e.ref&&(e.flags|=512,e.flags|=2097152)}return Ni(e),null;case 6:if(t&&null!=e.stateNode)wi(t,e,t.memoizedProps,r);else{if("string"!==typeof r&&null===e.stateNode)throw Error(a(166));if(t=hr(ur.current),n=hr(lr.current),Qn(e)){if(!Z)throw Error(a(176));if(t=e.stateNode,r=e.memoizedProps,(n=Gt(t,r,e,!Hn))&&null!==(i=Vn))switch(o=0!==(1&i.mode),i.tag){case 3:Qt(i.stateNode.containerInfo,t,r,o);break;case 5:$t(i.type,i.memoizedProps,i.stateNode,t,r,o)}n&&ki(e)}else e.stateNode=W(r,t,n,e)}return Ni(e),null;case 13:if(se(gr),r=e.memoizedState,Gn&&null!==Wn&&0!==(1&e.mode)&&0===(128&e.flags)){for(t=Wn;t;)t=Bt(t);return $n(),e.flags|=98560,e}if(null!==r&&null!==r.dehydrated){if(r=Qn(e),null===t){if(!r)throw Error(a(318));if(!Z)throw Error(a(344));if(!(t=null!==(t=e.memoizedState)?t.dehydrated:null))throw Error(a(317));Ht(t,e)}else $n(),0===(128&e.flags)&&(e.memoizedState=null),e.flags|=4;return Ni(e),null}return null!==qn&&(Aa(qn),qn=null),0!==(128&e.flags)?(e.lanes=n,e):(r=null!==r,n=!1,null===t?Qn(e):n=null!==t.memoizedState,r&&!n&&(e.child.flags|=8192,0!==(1&e.mode)&&(null===t||0!==(1&gr.current)?0===ta&&(ta=3):La())),null!==e.updateQueue&&(e.flags|=4),Ni(e),null);case 4:return pr(),xi(t,e),null===t&&Q(e.stateNode.containerInfo),Ni(e),null;case 10:return ln(e.type._context),Ni(e),null;case 19:if(se(gr),null===(i=e.memoizedState))return Ni(e),null;if(r=0!==(128&e.flags),null===(o=i.rendering))if(r)Pi(i,!1);else{if(0!==ta||null!==t&&0!==(128&t.flags))for(t=e.child;null!==t;){if(null!==(o=yr(t))){for(e.flags|=128,Pi(i,!1),null!==(t=o.updateQueue)&&(e.updateQueue=t,e.flags|=4),e.subtreeFlags=0,t=n,r=e.child;null!==r;)i=t,(n=r).flags&=14680066,null===(o=n.alternate)?(n.childLanes=0,n.lanes=i,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=o.childLanes,n.lanes=o.lanes,n.child=o.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=o.memoizedProps,n.memoizedState=o.memoizedState,n.updateQueue=o.updateQueue,n.type=o.type,i=o.dependencies,n.dependencies=null===i?null:{lanes:i.lanes,firstContext:i.firstContext}),r=r.sibling;return le(gr,1&gr.current|2),e.child}t=t.sibling}null!==i.tail&&Ue()>la&&(e.flags|=128,r=!0,Pi(i,!1),e.lanes=4194304)}else{if(!r)if(null!==(t=yr(o))){if(e.flags|=128,r=!0,null!==(t=t.updateQueue)&&(e.updateQueue=t,e.flags|=4),Pi(i,!0),null===i.tail&&"hidden"===i.tailMode&&!o.alternate&&!Gn)return Ni(e),null}else 2*Ue()-i.renderingStartTime>la&&1073741824!==n&&(e.flags|=128,r=!0,Pi(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(null!==(t=i.last)?t.sibling=o:e.child=o,i.last=o)}return null!==i.tail?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Ue(),e.sibling=null,t=gr.current,le(gr,r?1&t|2:1&t),e):(Ni(e),null);case 22:case 23:return Pa(),r=null!==e.memoizedState,null!==t&&null!==t.memoizedState!==r&&(e.flags|=8192),r&&0!==(1&e.mode)?0!==(1073741824&Qo)&&(Ni(e),Y&&6&e.subtreeFlags&&(e.flags|=8192)):Ni(e),null;case 24:case 25:return null}throw Error(a(156,e.tag))}var Di=s.ReactCurrentOwner,Li=!1;function Fi(t,e,n,r){e.child=null===t?ar(e,null,n,r):or(e,t.child,n,r)}function Ui(t,e,n,r,i){n=n.render;var o=e.ref;return un(e,i),r=Pr(t,e,n,r,o,i),n=Nr(),null===t||Li?(Gn&&n&&zn(e),e.flags|=1,Fi(t,e,r,i),e.child):(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,io(t,e,i))}function Bi(t,e,n,r,i){if(null===t){var o=n.type;return"function"!==typeof o||$a(o)||void 0!==o.defaultProps||null!==n.compare||void 0!==n.defaultProps?((t=es(n.type,null,r,e,e.mode,i)).ref=e.ref,t.return=e,e.child=t):(e.tag=15,e.type=o,zi(t,e,o,r,i))}if(o=t.child,0===(t.lanes&i)){var a=o.memoizedProps;if((n=null!==(n=n.compare)?n:Qe)(a,r)&&t.ref===e.ref)return io(t,e,i)}return e.flags|=1,(t=ts(o,r)).ref=e.ref,t.return=e,e.child=t}function zi(t,e,n,r,i){if(null!==t&&Qe(t.memoizedProps,r)&&t.ref===e.ref){if(Li=!1,0===(t.lanes&i))return e.lanes=t.lanes,io(t,e,i);0!==(131072&t.flags)&&(Li=!0)}return Wi(t,e,n,r,i)}function ji(t,e,n){var r=e.pendingProps,i=r.children,o=null!==t?t.memoizedState:null;if("hidden"===r.mode)if(0===(1&e.mode))e.memoizedState={baseLanes:0,cachePool:null},le($o,Qo),Qo|=n;else{if(0===(1073741824&n))return t=null!==o?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null},e.updateQueue=null,le($o,Qo),Qo|=t,null;e.memoizedState={baseLanes:0,cachePool:null},r=null!==o?o.baseLanes:n,le($o,Qo),Qo|=r}else null!==o?(r=o.baseLanes|n,e.memoizedState=null):r=n,le($o,Qo),Qo|=r;return Fi(t,e,i,n),e.child}function Vi(t,e){var n=e.ref;(null===t&&null!==n||null!==t&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Wi(t,e,n,r,i){var o=fe(n)?de:ue.current;return o=pe(e,o),un(e,i),n=Pr(t,e,n,r,o,i),r=Nr(),null===t||Li?(Gn&&r&&zn(e),e.flags|=1,Fi(t,e,n,i),e.child):(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,io(t,e,i))}function Gi(t,e,n,r,i){if(fe(n)){var o=!0;ve(e)}else o=!1;if(un(e,i),null===e.stateNode)null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2),Mn(e,n,r),An(e,n,r,i),r=!0;else if(null===t){var a=e.stateNode,s=e.memoizedProps;a.props=s;var l=a.context,c=n.contextType;"object"===typeof c&&null!==c?c=hn(c):c=pe(e,c=fe(n)?de:ue.current);var u=n.getDerivedStateFromProps,h="function"===typeof u||"function"===typeof a.getSnapshotBeforeUpdate;h||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==r||l!==c)&&Cn(e,a,r,c),pn=!1;var d=e.memoizedState;a.state=d,xn(e,r,a,i),l=e.memoizedState,s!==r||d!==l||he.current||pn?("function"===typeof u&&(Sn(e,n,u,r),l=e.memoizedState),(s=pn||En(e,n,s,r,d,l,c))?(h||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(e.flags|=4194308)):("function"===typeof a.componentDidMount&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),a.props=r,a.state=l,a.context=c,r=s):("function"===typeof a.componentDidMount&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,mn(t,e),s=e.memoizedProps,c=e.type===e.elementType?s:tn(e.type,s),a.props=c,h=e.pendingProps,d=a.context,"object"===typeof(l=n.contextType)&&null!==l?l=hn(l):l=pe(e,l=fe(n)?de:ue.current);var p=n.getDerivedStateFromProps;(u="function"===typeof p||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==h||d!==l)&&Cn(e,a,r,l),pn=!1,d=e.memoizedState,a.state=d,xn(e,r,a,i);var f=e.memoizedState;s!==h||d!==f||he.current||pn?("function"===typeof p&&(Sn(e,n,p,r),f=e.memoizedState),(c=pn||En(e,n,c,r,d,f,l)||!1)?(u||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(r,f,l),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(r,f,l)),"function"===typeof a.componentDidUpdate&&(e.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(e.flags|=1024)):("function"!==typeof a.componentDidUpdate||s===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=f),a.props=r,a.state=f,a.context=l,r=c):("function"!==typeof a.componentDidUpdate||s===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),r=!1)}return Hi(t,e,n,r,o,i)}function Hi(t,e,n,r,i,o){Vi(t,e);var a=0!==(128&e.flags);if(!r&&!a)return i&&be(e,n,!1),io(t,e,o);r=e.stateNode,Di.current=e;var s=a&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return e.flags|=1,null!==t&&a?(e.child=or(e,t.child,null,o),e.child=or(e,null,s,o)):Fi(t,e,s,o),e.memoizedState=r.state,i&&be(e,n,!0),e.child}function qi(t){var e=t.stateNode;e.pendingContext?ge(0,e.pendingContext,e.pendingContext!==e.context):e.context&&ge(0,e.context,!1),dr(t,e.containerInfo)}function Xi(t,e,n,r,i){return $n(),tr(i),e.flags|=256,Fi(t,e,n,r),e.child}var Yi={dehydrated:null,treeContext:null,retryLane:0};function Ki(t){return{baseLanes:t,cachePool:null}}function Zi(t,e,n){var r,i=e.pendingProps,o=gr.current,s=!1,l=0!==(128&e.flags);if((r=l)||(r=(null===t||null!==t.memoizedState)&&0!==(2&o)),r?(s=!0,e.flags&=-129):null!==t&&null===t.memoizedState||(o|=1),le(gr,1&o),null===t)return Zn(e),null!==(t=e.memoizedState)&&null!==(t=t.dehydrated)?(0===(1&e.mode)?e.lanes=1:Ft(t)?e.lanes=8:e.lanes=1073741824,null):(o=i.children,t=i.fallback,s?(i=e.mode,s=e.child,o={mode:"hidden",children:o},0===(1&i)&&null!==s?(s.childLanes=0,s.pendingProps=o):s=rs(o,i,0,null),t=ns(t,i,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Ki(n),e.memoizedState=Yi,t):Ji(e,o));if(null!==(o=t.memoizedState)){if(null!==(r=o.dehydrated)){if(l)return 256&e.flags?(e.flags&=-257,to(t,e,n,Error(a(422)))):null!==e.memoizedState?(e.child=t.child,e.flags|=128,null):(s=i.fallback,o=e.mode,i=rs({mode:"visible",children:i.children},o,0,null),(s=ns(s,o,n,null)).flags|=2,i.return=e,s.return=e,i.sibling=s,e.child=i,0!==(1&e.mode)&&or(e,t.child,null,n),e.child.memoizedState=Ki(n),e.memoizedState=Yi,s);if(0===(1&e.mode))e=to(t,e,n,null);else if(Ft(r))e=to(t,e,n,Error(a(419)));else if(i=0!==(n&t.childLanes),Li||i){if(null!==(i=Ko)){switch(n&-n){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}0!==(i=0!==(s&(i.suspendedLanes|n))?0:s)&&i!==o.retryLane&&(o.retryLane=i,Sa(t,i,-1))}La(),e=to(t,e,n,Error(a(421)))}else Lt(r)?(e.flags|=128,e.child=t.child,e=Ya.bind(null,t),Ut(r,e),e=null):(n=o.treeContext,Z&&(Wn=Vt(r),Vn=e,Gn=!0,qn=null,Hn=!1,null!==n&&(Nn[On++]=Ln,Nn[On++]=Fn,Nn[On++]=Dn,Ln=n.id,Fn=n.overflow,Dn=e)),(e=Ji(e,e.pendingProps.children)).flags|=4096);return e}return s?(i=$i(t,e,i.children,i.fallback,n),s=e.child,o=t.child.memoizedState,s.memoizedState=null===o?Ki(n):{baseLanes:o.baseLanes|n,cachePool:null},s.childLanes=t.childLanes&~n,e.memoizedState=Yi,i):(n=Qi(t,e,i.children,n),e.memoizedState=null,n)}return s?(i=$i(t,e,i.children,i.fallback,n),s=e.child,o=t.child.memoizedState,s.memoizedState=null===o?Ki(n):{baseLanes:o.baseLanes|n,cachePool:null},s.childLanes=t.childLanes&~n,e.memoizedState=Yi,i):(n=Qi(t,e,i.children,n),e.memoizedState=null,n)}function Ji(t,e){return(e=rs({mode:"visible",children:e},t.mode,0,null)).return=t,t.child=e}function Qi(t,e,n,r){var i=t.child;return t=i.sibling,n=ts(i,{mode:"visible",children:n}),0===(1&e.mode)&&(n.lanes=r),n.return=e,n.sibling=null,null!==t&&(null===(r=e.deletions)?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n}function $i(t,e,n,r,i){var o=e.mode,a=(t=t.child).sibling,s={mode:"hidden",children:n};return 0===(1&o)&&e.child!==t?((n=e.child).childLanes=0,n.pendingProps=s,e.deletions=null):(n=ts(t,s)).subtreeFlags=14680064&t.subtreeFlags,null!==a?r=ts(a,r):(r=ns(r,o,i,null)).flags|=2,r.return=e,n.return=e,n.sibling=r,e.child=n,r}function to(t,e,n,r){return null!==r&&tr(r),or(e,t.child,null,n),(t=Ji(e,e.pendingProps.children)).flags|=2,e.memoizedState=null,t}function eo(t,e,n){t.lanes|=e;var r=t.alternate;null!==r&&(r.lanes|=e),cn(t.return,e,n)}function no(t,e,n,r,i){var o=t.memoizedState;null===o?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function ro(t,e,n){var r=e.pendingProps,i=r.revealOrder,o=r.tail;if(Fi(t,e,r.children,n),0!==(2&(r=gr.current)))r=1&r|2,e.flags|=128;else{if(null!==t&&0!==(128&t.flags))t:for(t=e.child;null!==t;){if(13===t.tag)null!==t.memoizedState&&eo(t,n,e);else if(19===t.tag)eo(t,n,e);else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break t;for(;null===t.sibling;){if(null===t.return||t.return===e)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(le(gr,r),0===(1&e.mode))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;null!==n;)null!==(t=n.alternate)&&null===yr(t)&&(i=n),n=n.sibling;null===(n=i)?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),no(e,!1,i,n,o);break;case"backwards":for(n=null,i=e.child,e.child=null;null!==i;){if(null!==(t=i.alternate)&&null===yr(t)){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}no(e,!0,n,null,o);break;case"together":no(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function io(t,e,n){if(null!==t&&(e.dependencies=t.dependencies),na|=e.lanes,0===(n&e.childLanes))return null;if(null!==t&&e.child!==t.child)throw Error(a(153));if(null!==e.child){for(n=ts(t=e.child,t.pendingProps),e.child=n,n.return=e;null!==t.sibling;)t=t.sibling,(n=n.sibling=ts(t,t.pendingProps)).return=e;n.sibling=null}return e.child}function oo(t,e){switch(jn(e),e.tag){case 1:return fe(e.type)&&me(),65536&(t=e.flags)?(e.flags=-65537&t|128,e):null;case 3:return pr(),se(he),se(ue),br(),0!==(65536&(t=e.flags))&&0===(128&t)?(e.flags=-65537&t|128,e):null;case 5:return mr(e),null;case 13:if(se(gr),null!==(t=e.memoizedState)&&null!==t.dehydrated){if(null===e.alternate)throw Error(a(340));$n()}return 65536&(t=e.flags)?(e.flags=-65537&t|128,e):null;case 19:return se(gr),null;case 4:return pr(),null;case 10:return ln(e.type._context),null;case 22:case 23:return Pa(),null;default:return null}}var ao=!1,so=!1,lo="function"===typeof WeakSet?WeakSet:Set,co=null;function uo(t,e){var n=t.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Ha(t,e,r)}else n.current=null}function ho(t,e,n){try{n()}catch(r){Ha(t,e,r)}}var po=!1;function fo(t,e,n){var r=e.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&t)===t){var o=i.destroy;i.destroy=void 0,void 0!==o&&ho(e,n,o)}i=i.next}while(i!==r)}}function mo(t,e){if(null!==(e=null!==(e=e.updateQueue)?e.lastEffect:null)){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function go(t){var e=t.ref;if(null!==e){var n=t.stateNode;if(5===t.tag)t=N(n);else t=n;"function"===typeof e?e(t):e.current=t}}function yo(t,e,n){if(Ge&&"function"===typeof Ge.onCommitFiberUnmount)try{Ge.onCommitFiberUnmount(We,e)}catch(a){}switch(e.tag){case 0:case 11:case 14:case 15:if(null!==(t=e.updateQueue)&&null!==(t=t.lastEffect)){var r=t=t.next;do{var i=r,o=i.destroy;i=i.tag,void 0!==o&&(0!==(2&i)||0!==(4&i))&&ho(e,n,o),r=r.next}while(r!==t)}break;case 1:if(uo(e,n),"function"===typeof(t=e.stateNode).componentWillUnmount)try{t.props=e.memoizedProps,t.state=e.memoizedState,t.componentWillUnmount()}catch(a){Ha(e,n,a)}break;case 5:uo(e,n);break;case 4:Y?Eo(t,e,n):K&&K&&(e=e.stateNode.containerInfo,n=Ct(e),It(e,n))}}function vo(t,e,n){for(var r=e;;)if(yo(t,r,n),null===r.child||Y&&4===r.tag){if(r===e)break;for(;null===r.sibling;){if(null===r.return||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}else r.child.return=r,r=r.child}function bo(t){var e=t.alternate;null!==e&&(t.alternate=null,bo(e)),t.child=null,t.deletions=null,t.sibling=null,5===t.tag&&(null!==(e=t.stateNode)&&tt(e)),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function xo(t){return 5===t.tag||3===t.tag||4===t.tag}function _o(t){t:for(;;){for(;null===t.sibling;){if(null===t.return||xo(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;5!==t.tag&&6!==t.tag&&18!==t.tag;){if(2&t.flags)continue t;if(null===t.child||4===t.tag)continue t;t.child.return=t,t=t.child}if(!(2&t.flags))return t.stateNode}}function wo(t){if(Y){t:{for(var e=t.return;null!==e;){if(xo(e))break t;e=e.return}throw Error(a(160))}var n=e;switch(n.tag){case 5:e=n.stateNode,32&n.flags&&(xt(e),n.flags&=-33),To(t,n=_o(t),e);break;case 3:case 4:e=n.stateNode.containerInfo,So(t,n=_o(t),e);break;default:throw Error(a(161))}}}function So(t,e,n){var r=t.tag;if(5===r||6===r)t=t.stateNode,e?yt(n,t,e):dt(n,t);else if(4!==r&&null!==(t=t.child))for(So(t,e,n),t=t.sibling;null!==t;)So(t,e,n),t=t.sibling}function To(t,e,n){var r=t.tag;if(5===r||6===r)t=t.stateNode,e?gt(n,t,e):ht(n,t);else if(4!==r&&null!==(t=t.child))for(To(t,e,n),t=t.sibling;null!==t;)To(t,e,n),t=t.sibling}function Eo(t,e,n){for(var r,i,o=e,s=!1;;){if(!s){s=o.return;t:for(;;){if(null===s)throw Error(a(160));switch(r=s.stateNode,s.tag){case 5:i=!1;break t;case 3:case 4:r=r.containerInfo,i=!0;break t}s=s.return}s=!0}if(5===o.tag||6===o.tag)vo(t,o,n),i?bt(r,o.stateNode):vt(r,o.stateNode);else if(18===o.tag)i?Zt(r,o.stateNode):Kt(r,o.stateNode);else if(4===o.tag){if(null!==o.child){r=o.stateNode.containerInfo,i=!0,o.child.return=o,o=o.child;continue}}else if(yo(t,o,n),null!==o.child){o.child.return=o,o=o.child;continue}if(o===e)break;for(;null===o.sibling;){if(null===o.return||o.return===e)return;4===(o=o.return).tag&&(s=!1)}o.sibling.return=o.return,o=o.sibling}}function Mo(t,e){if(Y){switch(e.tag){case 0:case 11:case 14:case 15:return fo(3,e,e.return),mo(3,e),void fo(5,e,e.return);case 1:case 12:case 17:return;case 5:var n=e.stateNode;if(null!=n){var r=e.memoizedProps;t=null!==t?t.memoizedProps:r;var i=e.type,o=e.updateQueue;e.updateQueue=null,null!==o&&mt(n,o,i,t,r,e)}return;case 6:if(null===e.stateNode)throw Error(a(162));return n=e.memoizedProps,void pt(e.stateNode,null!==t?t.memoizedProps:n,n);case 3:return void(Z&&null!==t&&t.memoizedState.isDehydrated&&Xt(e.stateNode.containerInfo));case 13:case 19:return void Co(e)}throw Error(a(163))}switch(e.tag){case 0:case 11:case 14:case 15:return fo(3,e,e.return),mo(3,e),void fo(5,e,e.return);case 12:case 22:case 23:return;case 13:case 19:return void Co(e);case 3:Z&&null!==t&&t.memoizedState.isDehydrated&&Xt(e.stateNode.containerInfo)}t:if(K){switch(e.tag){case 1:case 5:case 6:break t;case 3:case 4:e=e.stateNode,It(e.containerInfo,e.pendingChildren);break t}throw Error(a(163))}}function Co(t){var e=t.updateQueue;if(null!==e){t.updateQueue=null;var n=t.stateNode;null===n&&(n=t.stateNode=new lo),e.forEach((function(e){var r=Ka.bind(null,t,e);n.has(e)||(n.add(e),e.then(r,r))}))}}function Ao(t,e,n){co=t,ko(t,e,n)}function ko(t,e,n){for(var r=0!==(1&t.mode);null!==co;){var i=co,o=i.child;if(22===i.tag&&r){var a=null!==i.memoizedState||ao;if(!a){var s=i.alternate,l=null!==s&&null!==s.memoizedState||so;s=ao;var c=so;if(ao=a,(so=l)&&!c)for(co=i;null!==co;)l=(a=co).child,22===a.tag&&null!==a.memoizedState?Po(i):null!==l?(l.return=a,co=l):Po(i);for(;null!==o;)co=o,ko(o,e,n),o=o.sibling;co=i,ao=s,so=c}Io(t)}else 0!==(8772&i.subtreeFlags)&&null!==o?(o.return=i,co=o):Io(t)}}function Io(t){for(;null!==co;){var e=co;if(0!==(8772&e.flags)){var n=e.alternate;try{if(0!==(8772&e.flags))switch(e.tag){case 0:case 11:case 15:so||mo(5,e);break;case 1:var r=e.stateNode;if(4&e.flags&&!so)if(null===n)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:tn(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;null!==o&&_n(e,o,r);break;case 3:var s=e.updateQueue;if(null!==s){if(n=null,null!==e.child)switch(e.child.tag){case 5:n=N(e.child.stateNode);break;case 1:n=e.child.stateNode}_n(e,s,n)}break;case 5:var l=e.stateNode;null===n&&4&e.flags&&ft(l,e.type,e.memoizedProps,e);break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:break;case 13:if(Z&&null===e.memoizedState){var c=e.alternate;if(null!==c){var u=c.memoizedState;if(null!==u){var h=u.dehydrated;null!==h&&Yt(h)}}}break;default:throw Error(a(163))}so||512&e.flags&&go(e)}catch(d){Ha(e,e.return,d)}}if(e===t){co=null;break}if(null!==(n=e.sibling)){n.return=e.return,co=n;break}co=e.return}}function Ro(t){for(;null!==co;){var e=co;if(e===t){co=null;break}var n=e.sibling;if(null!==n){n.return=e.return,co=n;break}co=e.return}}function Po(t){for(;null!==co;){var e=co;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{mo(4,e)}catch(l){Ha(e,n,l)}break;case 1:var r=e.stateNode;if("function"===typeof r.componentDidMount){var i=e.return;try{r.componentDidMount()}catch(l){Ha(e,i,l)}}var o=e.return;try{go(e)}catch(l){Ha(e,o,l)}break;case 5:var a=e.return;try{go(e)}catch(l){Ha(e,a,l)}}}catch(l){Ha(e,e.return,l)}if(e===t){co=null;break}var s=e.sibling;if(null!==s){s.return=e.return,co=s;break}co=e.return}}var No=0,Oo=1,Do=2,Lo=3,Fo=4;if("function"===typeof Symbol&&Symbol.for){var Uo=Symbol.for;No=Uo("selector.component"),Oo=Uo("selector.has_pseudo_class"),Do=Uo("selector.role"),Lo=Uo("selector.test_id"),Fo=Uo("selector.text")}function Bo(t){var e=J(t);if(null!=e){if("string"!==typeof e.memoizedProps["data-testname"])throw Error(a(364));return e}if(null===(t=it(t)))throw Error(a(362));return t.stateNode.current}function zo(t,e){switch(e.$$typeof){case No:if(t.type===e.value)return!0;break;case Oo:t:{e=e.value,t=[t,0];for(var n=0;n<t.length;){var r=t[n++],i=t[n++],o=e[i];if(5!==r.tag||!st(r)){for(;null!=o&&zo(r,o);)o=e[++i];if(i===e.length){e=!0;break t}for(r=r.child;null!==r;)t.push(r,i),r=r.sibling}}e=!1}return e;case Do:if(5===t.tag&&lt(t.stateNode,e.value))return!0;break;case Fo:if((5===t.tag||6===t.tag)&&(null!==(t=at(t))&&0<=t.indexOf(e.value)))return!0;break;case Lo:if(5===t.tag&&("string"===typeof(t=t.memoizedProps["data-testname"])&&t.toLowerCase()===e.value.toLowerCase()))return!0;break;default:throw Error(a(365))}return!1}function jo(t){switch(t.$$typeof){case No:return"<"+(S(t.value)||"Unknown")+">";case Oo:return":has("+(jo(t)||"")+")";case Do:return'[role="'+t.value+'"]';case Fo:return'"'+t.value+'"';case Lo:return'[data-testname="'+t.value+'"]';default:throw Error(a(365))}}function Vo(t,e){var n=[];t=[t,0];for(var r=0;r<t.length;){var i=t[r++],o=t[r++],a=e[o];if(5!==i.tag||!st(i)){for(;null!=a&&zo(i,a);)a=e[++o];if(o===e.length)n.push(i);else for(i=i.child;null!==i;)t.push(i,o),i=i.sibling}}return n}function Wo(t,e){if(!rt)throw Error(a(363));t=Vo(t=Bo(t),e),e=[],t=Array.from(t);for(var n=0;n<t.length;){var r=t[n++];if(5===r.tag)st(r)||e.push(r.stateNode);else for(r=r.child;null!==r;)t.push(r),r=r.sibling}return e}var Go=Math.ceil,Ho=s.ReactCurrentDispatcher,qo=s.ReactCurrentOwner,Xo=s.ReactCurrentBatchConfig,Yo=0,Ko=null,Zo=null,Jo=0,Qo=0,$o=ae(0),ta=0,ea=null,na=0,ra=0,ia=0,oa=null,aa=null,sa=0,la=1/0;function ca(){la=Ue()+500}var ua,ha=!1,da=null,pa=null,fa=!1,ma=null,ga=0,ya=0,va=null,ba=-1,xa=0;function _a(){return 0!==(6&Yo)?Ue():-1!==ba?ba:ba=Ue()}function wa(t){return 0===(1&t.mode)?1:0!==(2&Yo)&&0!==Jo?Jo&-Jo:null!==Je.transition?(0===xa&&(t=Se,0===(4194240&(Se<<=1))&&(Se=64),xa=t),xa):0!==(t=Pe)?t:$()}function Sa(t,e,n){if(50<ya)throw ya=0,va=null,Error(a(185));var r=Ta(t,e);return null===r?null:(Ie(r,e,n),0!==(2&Yo)&&r===Ko||(r===Ko&&(0===(2&Yo)&&(ra|=e),4===ta&&ka(r,Jo)),Ea(r,n),1===e&&0===Yo&&0===(1&t.mode)&&(ca(),Xe&&Ze())),r)}function Ta(t,e){t.lanes|=e;var n=t.alternate;for(null!==n&&(n.lanes|=e),n=t,t=t.return;null!==t;)t.childLanes|=e,null!==(n=t.alternate)&&(n.childLanes|=e),n=t,t=t.return;return 3===n.tag?n.stateNode:null}function Ea(t,e){var n=t.callbackNode;!function(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,o=t.pendingLanes;0<o;){var a=31-xe(o),s=1<<a,l=i[a];-1===l?0!==(s&n)&&0===(s&r)||(i[a]=Ce(s,e)):l<=e&&(t.expiredLanes|=s),o&=~s}}(t,e);var r=Me(t,t===Ko?Jo:0);if(0===r)null!==n&&De(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(null!=n&&De(n),1===e)0===t.tag?function(t){Xe=!0,Ke(t)}(Ia.bind(null,t)):Ke(Ia.bind(null,t)),et?nt((function(){0===Yo&&Ze()})):Oe(Be,Ze),n=null;else{switch(Ne(r)){case 1:n=Be;break;case 4:n=ze;break;case 16:default:n=je;break;case 536870912:n=Ve}n=Za(n,Ma.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Ma(t,e){if(ba=-1,xa=0,0!==(6&Yo))throw Error(a(327));var n=t.callbackNode;if(Wa()&&t.callbackNode!==n)return null;var r=Me(t,t===Ko?Jo:0);if(0===r)return null;if(0!==(30&r)||0!==(r&t.expiredLanes)||e)e=Fa(t,r);else{e=r;var i=Yo;Yo|=2;var o=Da();for(Ko===t&&Jo===e||(ca(),Na(t,e));;)try{Ba();break}catch(l){Oa(t,l)}an(),Ho.current=o,Yo=i,null!==Zo?e=0:(Ko=null,Jo=0,e=ta)}if(0!==e){if(2===e&&(0!==(i=Ae(t))&&(r=i,e=Ca(t,i))),1===e)throw n=ea,Na(t,0),ka(t,r),Ea(t,Ue()),n;if(6===e)ka(t,r);else{if(i=t.current.alternate,0===(30&r)&&!function(t){for(var e=t;;){if(16384&e.flags){var n=e.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!He(o(),i))return!1}catch(s){return!1}}}if(n=e.child,16384&e.subtreeFlags&&null!==n)n.return=e,e=n;else{if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}(i)&&(2===(e=Fa(t,r))&&(0!==(o=Ae(t))&&(r=o,e=Ca(t,o))),1===e))throw n=ea,Na(t,0),ka(t,r),Ea(t,Ue()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(a(345));case 2:case 5:Va(t,aa);break;case 3:if(ka(t,r),(130023424&r)===r&&10<(e=sa+500-Ue())){if(0!==Me(t,0))break;if(((i=t.suspendedLanes)&r)!==r){_a(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=G(Va.bind(null,t,aa),e);break}Va(t,aa);break;case 4:if(ka(t,r),(4194240&r)===r)break;for(e=t.eventTimes,i=-1;0<r;){var s=31-xe(r);o=1<<s,(s=e[s])>i&&(i=s),r&=~o}if(r=i,10<(r=(120>(r=Ue()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Go(r/1960))-r)){t.timeoutHandle=G(Va.bind(null,t,aa),r);break}Va(t,aa);break;default:throw Error(a(329))}}}return Ea(t,Ue()),t.callbackNode===n?Ma.bind(null,t):null}function Ca(t,e){var n=oa;return t.current.memoizedState.isDehydrated&&(Na(t,e).flags|=256),2!==(t=Fa(t,e))&&(e=aa,aa=n,null!==e&&Aa(e)),t}function Aa(t){null===aa?aa=t:aa.push.apply(aa,t)}function ka(t,e){for(e&=~ia,e&=~ra,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-xe(e),r=1<<n;t[n]=-1,e&=~r}}function Ia(t){if(0!==(6&Yo))throw Error(a(327));Wa();var e=Me(t,0);if(0===(1&e))return Ea(t,Ue()),null;var n=Fa(t,e);if(0!==t.tag&&2===n){var r=Ae(t);0!==r&&(e=r,n=Ca(t,r))}if(1===n)throw n=ea,Na(t,0),ka(t,e),Ea(t,Ue()),n;if(6===n)throw Error(a(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Va(t,aa),Ea(t,Ue()),null}function Ra(t){null!==ma&&0===ma.tag&&0===(6&Yo)&&Wa();var e=Yo;Yo|=1;var n=Xo.transition,r=Pe;try{if(Xo.transition=null,Pe=1,t)return t()}finally{Pe=r,Xo.transition=n,0===(6&(Yo=e))&&Ze()}}function Pa(){Qo=$o.current,se($o)}function Na(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==q&&(t.timeoutHandle=q,H(n)),null!==Zo)for(n=Zo.return;null!==n;){var r=n;switch(jn(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&me();break;case 3:pr(),se(he),se(ue),br();break;case 5:mr(r);break;case 4:pr();break;case 13:case 19:se(gr);break;case 10:ln(r.type._context);break;case 22:case 23:Pa()}n=n.return}if(Ko=t,Zo=t=ts(t.current,null),Jo=Qo=e,ta=0,ea=null,ia=ra=na=0,aa=oa=null,null!==dn){for(e=0;e<dn.length;e++)if(null!==(r=(n=dn[e]).interleaved)){n.interleaved=null;var i=r.next,o=n.pending;if(null!==o){var a=o.next;o.next=i,r.next=a}n.pending=r}dn=null}return t}function Oa(t,e){for(;;){var n=Zo;try{if(an(),xr.current=pi,Mr){for(var r=Sr.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}Mr=!1}if(wr=0,Er=Tr=Sr=null,Cr=!1,Ar=0,qo.current=null,null===n||null===n.return){ta=1,ea=e,Zo=null;break}t:{var o=t,s=n.return,l=n,c=e;if(e=Jo,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,h=l,d=h.tag;if(0===(1&h.mode)&&(0===d||11===d||15===d)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var f=Ci(s);if(null!==f){f.flags&=-257,Ai(f,s,l,0,e),1&f.mode&&Mi(o,u,e),c=u;var m=(e=f).updateQueue;if(null===m){var g=new Set;g.add(c),e.updateQueue=g}else m.add(c);break t}if(0===(1&e)){Mi(o,u,e),La();break t}c=Error(a(426))}else if(Gn&&1&l.mode){var y=Ci(s);if(null!==y){0===(65536&y.flags)&&(y.flags|=256),Ai(y,s,l,0,e),tr(c);break t}}o=c,4!==ta&&(ta=2),null===oa?oa=[o]:oa.push(o),c=yi(c,l),l=s;do{switch(l.tag){case 3:l.flags|=65536,e&=-e,l.lanes|=e,bn(l,Ti(0,c,e));break t;case 1:o=c;var v=l.type,b=l.stateNode;if(0===(128&l.flags)&&("function"===typeof v.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===pa||!pa.has(b)))){l.flags|=65536,e&=-e,l.lanes|=e,bn(l,Ei(l,o,e));break t}}l=l.return}while(null!==l)}ja(n)}catch(x){e=x,Zo===n&&null!==n&&(Zo=n=n.return);continue}break}}function Da(){var t=Ho.current;return Ho.current=pi,null===t?pi:t}function La(){0!==ta&&3!==ta&&2!==ta||(ta=4),null===Ko||0===(268435455&na)&&0===(268435455&ra)||ka(Ko,Jo)}function Fa(t,e){var n=Yo;Yo|=2;var r=Da();for(Ko===t&&Jo===e||Na(t,e);;)try{Ua();break}catch(i){Oa(t,i)}if(an(),Yo=n,Ho.current=r,null!==Zo)throw Error(a(261));return Ko=null,Jo=0,ta}function Ua(){for(;null!==Zo;)za(Zo)}function Ba(){for(;null!==Zo&&!Le();)za(Zo)}function za(t){var e=ua(t.alternate,t,Qo);t.memoizedProps=t.pendingProps,null===e?ja(t):Zo=e,qo.current=null}function ja(t){var e=t;do{var n=e.alternate;if(t=e.return,0===(32768&e.flags)){if(null!==(n=Oi(n,e,Qo)))return void(Zo=n)}else{if(null!==(n=oo(n,e)))return n.flags&=32767,void(Zo=n);if(null===t)return ta=6,void(Zo=null);t.flags|=32768,t.subtreeFlags=0,t.deletions=null}if(null!==(e=e.sibling))return void(Zo=e);Zo=e=t}while(null!==e);0===ta&&(ta=5)}function Va(t,e){var n=Pe,r=Xo.transition;try{Xo.transition=null,Pe=1,function(t,e,n){do{Wa()}while(null!==ma);if(0!==(6&Yo))throw Error(a(327));var r=t.finishedWork,i=t.finishedLanes;if(null===r)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(a(177));t.callbackNode=null,t.callbackPriority=0;var o=r.lanes|r.childLanes;if(function(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-xe(n),o=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~o}}(t,o),t===Ko&&(Zo=Ko=null,Jo=0),0===(2064&r.subtreeFlags)&&0===(2064&r.flags)||fa||(fa=!0,Za(je,(function(){return Wa(),null}))),o=0!==(15990&r.flags),0!==(15990&r.subtreeFlags)||o){o=Xo.transition,Xo.transition=null;var s=Pe;Pe=1;var l=Yo;Yo|=4,qo.current=null,function(t,e){for(L(t.containerInfo),co=e;null!==co;)if(e=(t=co).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,co=e;else for(;null!==co;){t=co;try{var n=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==n){var r=n.memoizedProps,i=n.memoizedState,o=t.stateNode,s=o.getSnapshotBeforeUpdate(t.elementType===t.type?r:tn(t.type,r),i);o.__reactInternalSnapshotBeforeUpdate=s}break;case 3:Y&&Et(t.stateNode.containerInfo);break;default:throw Error(a(163))}}catch(l){Ha(t,t.return,l)}if(null!==(e=t.sibling)){e.return=t.return,co=e;break}co=t.return}n=po,po=!1}(t,r),function(t,e){for(co=e;null!==co;){var n=(e=co).deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var o=t;Y?Eo(o,i,e):vo(o,i,e);var a=i.alternate;null!==a&&(a.return=null),i.return=null}catch(_){Ha(i,e,_)}}if(n=e.child,0!==(12854&e.subtreeFlags)&&null!==n)n.return=e,co=n;else for(;null!==co;){e=co;try{var s=e.flags;if(32&s&&Y&&xt(e.stateNode),512&s){var l=e.alternate;if(null!==l){var c=l.ref;null!==c&&("function"===typeof c?c(null):c.current=null)}}if(8192&s)switch(e.tag){case 13:if(null!==e.memoizedState){var u=e.alternate;null!==u&&null!==u.memoizedState||(sa=Ue())}break;case 22:var h=null!==e.memoizedState,d=e.alternate,p=null!==d&&null!==d.memoizedState;if(n=e,Y)t:if(r=n,i=h,o=null,Y)for(var f=r;;){if(5===f.tag){if(null===o){o=f;var m=f.stateNode;i?_t(m):St(f.stateNode,f.memoizedProps)}}else if(6===f.tag){if(null===o){var g=f.stateNode;i?wt(g):Tt(g,f.memoizedProps)}}else if((22!==f.tag&&23!==f.tag||null===f.memoizedState||f===r)&&null!==f.child){f.child.return=f,f=f.child;continue}if(f===r)break;for(;null===f.sibling;){if(null===f.return||f.return===r)break t;o===f&&(o=null),f=f.return}o===f&&(o=null),f.sibling.return=f.return,f=f.sibling}if(h&&!p&&0!==(1&n.mode)){co=n;for(var y=n.child;null!==y;){for(n=co=y;null!==co;){var v=(r=co).child;switch(r.tag){case 0:case 11:case 14:case 15:fo(4,r,r.return);break;case 1:uo(r,r.return);var b=r.stateNode;if("function"===typeof b.componentWillUnmount){var x=r.return;try{b.props=r.memoizedProps,b.state=r.memoizedState,b.componentWillUnmount()}catch(_){Ha(r,x,_)}}break;case 5:uo(r,r.return);break;case 22:if(null!==r.memoizedState){Ro(n);continue}}null!==v?(v.return=r,co=v):Ro(n)}y=y.sibling}}}switch(4102&s){case 2:wo(e),e.flags&=-3;break;case 6:wo(e),e.flags&=-3,Mo(e.alternate,e);break;case 4096:e.flags&=-4097;break;case 4100:e.flags&=-4097,Mo(e.alternate,e);break;case 4:Mo(e.alternate,e)}}catch(_){Ha(e,e.return,_)}if(null!==(n=e.sibling)){n.return=e.return,co=n;break}co=e.return}}}(t,r),F(t.containerInfo),t.current=r,Ao(r,t,i),Fe(),Yo=l,Pe=s,Xo.transition=o}else t.current=r;if(fa&&(fa=!1,ma=t,ga=i),o=t.pendingLanes,0===o&&(pa=null),function(t){if(Ge&&"function"===typeof Ge.onCommitFiberRoot)try{Ge.onCommitFiberRoot(We,t,void 0,128===(128&t.current.flags))}catch(e){}}(r.stateNode),Ea(t,Ue()),null!==e)for(n=t.onRecoverableError,r=0;r<e.length;r++)n(e[r]);if(ha)throw ha=!1,t=da,da=null,t;0!==(1&ga)&&0!==t.tag&&Wa(),o=t.pendingLanes,0!==(1&o)?t===va?ya++:(ya=0,va=t):ya=0,Ze()}(t,e,n)}finally{Xo.transition=r,Pe=n}return null}function Wa(){if(null!==ma){var t=Ne(ga),e=Xo.transition,n=Pe;try{if(Xo.transition=null,Pe=16>t?16:t,null===ma)var r=!1;else{if(t=ma,ma=null,ga=0,0!==(6&Yo))throw Error(a(331));var i=Yo;for(Yo|=4,co=t.current;null!==co;){var o=co,s=o.child;if(0!==(16&co.flags)){var l=o.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(co=u;null!==co;){var h=co;switch(h.tag){case 0:case 11:case 15:fo(8,h,o)}var d=h.child;if(null!==d)d.return=h,co=d;else for(;null!==co;){var p=(h=co).sibling,f=h.return;if(bo(h),h===u){co=null;break}if(null!==p){p.return=f,co=p;break}co=f}}}var m=o.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(null!==g)}}co=o}}if(0!==(2064&o.subtreeFlags)&&null!==s)s.return=o,co=s;else t:for(;null!==co;){if(0!==(2048&(o=co).flags))switch(o.tag){case 0:case 11:case 15:fo(9,o,o.return)}var v=o.sibling;if(null!==v){v.return=o.return,co=v;break t}co=o.return}}var b=t.current;for(co=b;null!==co;){var x=(s=co).child;if(0!==(2064&s.subtreeFlags)&&null!==x)x.return=s,co=x;else t:for(s=b;null!==co;){if(0!==(2048&(l=co).flags))try{switch(l.tag){case 0:case 11:case 15:mo(9,l)}}catch(w){Ha(l,l.return,w)}if(l===s){co=null;break t}var _=l.sibling;if(null!==_){_.return=l.return,co=_;break t}co=l.return}}if(Yo=i,Ze(),Ge&&"function"===typeof Ge.onPostCommitFiberRoot)try{Ge.onPostCommitFiberRoot(We,t)}catch(w){}r=!0}return r}finally{Pe=n,Xo.transition=e}}return!1}function Ga(t,e,n){yn(t,e=Ti(0,e=yi(n,e),1)),e=_a(),null!==(t=Ta(t,1))&&(Ie(t,1,e),Ea(t,e))}function Ha(t,e,n){if(3===t.tag)Ga(t,t,n);else for(;null!==e;){if(3===e.tag){Ga(e,t,n);break}if(1===e.tag){var r=e.stateNode;if("function"===typeof e.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===pa||!pa.has(r))){yn(e,t=Ei(e,t=yi(n,t),1)),t=_a(),null!==(e=Ta(e,1))&&(Ie(e,1,t),Ea(e,t));break}}e=e.return}}function qa(t,e,n){var r=t.pingCache;null!==r&&r.delete(e),e=_a(),t.pingedLanes|=t.suspendedLanes&n,Ko===t&&(Jo&n)===n&&(4===ta||3===ta&&(130023424&Jo)===Jo&&500>Ue()-sa?Na(t,0):ia|=n),Ea(t,e)}function Xa(t,e){0===e&&(0===(1&t.mode)?e=1:(e=Te,0===(130023424&(Te<<=1))&&(Te=4194304)));var n=_a();null!==(t=Ta(t,e))&&(Ie(t,e,n),Ea(t,n))}function Ya(t){var e=t.memoizedState,n=0;null!==e&&(n=e.retryLane),Xa(t,n)}function Ka(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(a(314))}null!==r&&r.delete(e),Xa(t,n)}function Za(t,e){return Oe(t,e)}function Ja(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Qa(t,e,n,r){return new Ja(t,e,n,r)}function $a(t){return!(!(t=t.prototype)||!t.isReactComponent)}function ts(t,e){var n=t.alternate;return null===n?((n=Qa(t.tag,e,t.key,t.mode)).elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&t.flags,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function es(t,e,n,r,i,o){var s=2;if(r=t,"function"===typeof t)$a(t)&&(s=1);else if("string"===typeof t)s=5;else t:switch(t){case u:return ns(n.children,i,o,e);case h:s=8,i|=8;break;case d:return(t=Qa(12,n,e,2|i)).elementType=d,t.lanes=o,t;case g:return(t=Qa(13,n,e,i)).elementType=g,t.lanes=o,t;case y:return(t=Qa(19,n,e,i)).elementType=y,t.lanes=o,t;case x:return rs(n,i,o,e);default:if("object"===typeof t&&null!==t)switch(t.$$typeof){case p:s=10;break t;case f:s=9;break t;case m:s=11;break t;case v:s=14;break t;case b:s=16,r=null;break t}throw Error(a(130,null==t?t:typeof t,""))}return(e=Qa(s,n,e,i)).elementType=t,e.type=r,e.lanes=o,e}function ns(t,e,n,r){return(t=Qa(7,t,r,e)).lanes=n,t}function rs(t,e,n,r){return(t=Qa(22,t,r,e)).elementType=x,t.lanes=n,t.stateNode={},t}function is(t,e,n){return(t=Qa(6,t,null,e)).lanes=n,t}function os(t,e,n){return(e=Qa(4,null!==t.children?t.children:[],t.key,e)).lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function as(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=q,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ke(0),this.expirationTimes=ke(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ke(0),this.identifierPrefix=r,this.onRecoverableError=i,Z&&(this.mutableSourceEagerHydrationData=null)}function ss(t,e,n,r,i,o,a,s,l){return t=new as(t,e,n,s,l),1===e?(e=1,!0===o&&(e|=8)):e=0,o=Qa(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null},fn(o),t}function ls(t){if(!t)return ce;t:{if(E(t=t._reactInternals)!==t||1!==t.tag)throw Error(a(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break t;case 1:if(fe(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break t}}e=e.return}while(null!==e);throw Error(a(171))}if(1===t.tag){var n=t.type;if(fe(n))return ye(t,n,e)}return e}function cs(t){var e=t._reactInternals;if(void 0===e){if("function"===typeof t.render)throw Error(a(188));throw t=Object.keys(t).join(","),Error(a(268,t))}return null===(t=A(e))?null:t.stateNode}function us(t,e){if(null!==(t=t.memoizedState)&&null!==t.dehydrated){var n=t.retryLane;t.retryLane=0!==n&&n<e?n:e}}function hs(t,e){us(t,e),(t=t.alternate)&&us(t,e)}function ds(t){return null===(t=A(t))?null:t.stateNode}function ps(){return null}return ua=function(t,e,n){if(null!==t)if(t.memoizedProps!==e.pendingProps||he.current)Li=!0;else{if(0===(t.lanes&n)&&0===(128&e.flags))return Li=!1,function(t,e,n){switch(e.tag){case 3:qi(e),$n();break;case 5:fr(e);break;case 1:fe(e.type)&&ve(e);break;case 4:dr(e,e.stateNode.containerInfo);break;case 10:sn(0,e.type._context,e.memoizedProps.value);break;case 13:var r=e.memoizedState;if(null!==r)return null!==r.dehydrated?(le(gr,1&gr.current),e.flags|=128,null):0!==(n&e.child.childLanes)?Zi(t,e,n):(le(gr,1&gr.current),null!==(t=io(t,e,n))?t.sibling:null);le(gr,1&gr.current);break;case 19:if(r=0!==(n&e.childLanes),0!==(128&t.flags)){if(r)return ro(t,e,n);e.flags|=128}var i=e.memoizedState;if(null!==i&&(i.rendering=null,i.tail=null,i.lastEffect=null),le(gr,gr.current),r)break;return null;case 22:case 23:return e.lanes=0,ji(t,e,n)}return io(t,e,n)}(t,e,n);Li=0!==(131072&t.flags)}else Li=!1,Gn&&0!==(1048576&e.flags)&&Bn(e,Pn,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2),t=e.pendingProps;var i=pe(e,ue.current);un(e,n),i=Pr(null,e,r,t,i,n);var o=Nr();return e.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(e.tag=1,e.memoizedState=null,e.updateQueue=null,fe(r)?(o=!0,ve(e)):o=!1,e.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,fn(e),i.updater=Tn,e.stateNode=i,i._reactInternals=e,An(e,r,t,n),e=Hi(null,e,r,!0,o,n)):(e.tag=0,Gn&&o&&zn(e),Fi(null,e,i,n),e=e.child),e;case 16:r=e.elementType;t:{switch(null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2),t=e.pendingProps,r=(i=r._init)(r._payload),e.type=r,i=e.tag=function(t){if("function"===typeof t)return $a(t)?1:0;if(void 0!==t&&null!==t){if((t=t.$$typeof)===m)return 11;if(t===v)return 14}return 2}(r),t=tn(r,t),i){case 0:e=Wi(null,e,r,t,n);break t;case 1:e=Gi(null,e,r,t,n);break t;case 11:e=Ui(null,e,r,t,n);break t;case 14:e=Bi(null,e,r,tn(r.type,t),n);break t}throw Error(a(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,Wi(t,e,r,i=e.elementType===r?i:tn(r,i),n);case 1:return r=e.type,i=e.pendingProps,Gi(t,e,r,i=e.elementType===r?i:tn(r,i),n);case 3:t:{if(qi(e),null===t)throw Error(a(387));r=e.pendingProps,i=(o=e.memoizedState).element,mn(t,e),xn(e,r,null,n);var s=e.memoizedState;if(r=s.element,Z&&o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:s.cache,transitions:s.transitions},e.updateQueue.baseState=o,e.memoizedState=o,256&e.flags){e=Xi(t,e,r,n,i=Error(a(423)));break t}if(r!==i){e=Xi(t,e,r,n,i=Error(a(424)));break t}for(Z&&(Wn=jt(e.stateNode.containerInfo),Vn=e,Gn=!0,qn=null,Hn=!1),n=ar(e,null,r,n),e.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if($n(),r===i){e=io(t,e,n);break t}Fi(t,e,r,n)}e=e.child}return e;case 5:return fr(e),null===t&&Zn(e),r=e.type,i=e.pendingProps,o=null!==t?t.memoizedProps:null,s=i.children,V(r,i)?s=null:null!==o&&V(r,o)&&(e.flags|=32),Vi(t,e),Fi(t,e,s,n),e.child;case 6:return null===t&&Zn(e),null;case 13:return Zi(t,e,n);case 4:return dr(e,e.stateNode.containerInfo),r=e.pendingProps,null===t?e.child=or(e,null,r,n):Fi(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,Ui(t,e,r,i=e.elementType===r?i:tn(r,i),n);case 7:return Fi(t,e,e.pendingProps,n),e.child;case 8:case 12:return Fi(t,e,e.pendingProps.children,n),e.child;case 10:t:{if(r=e.type._context,i=e.pendingProps,o=e.memoizedProps,sn(0,r,s=i.value),null!==o)if(He(o.value,s)){if(o.children===i.children&&!he.current){e=io(t,e,n);break t}}else for(null!==(o=e.child)&&(o.return=e);null!==o;){var l=o.dependencies;if(null!==l){s=o.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===o.tag){(c=gn(-1,n&-n)).tag=2;var u=o.updateQueue;if(null!==u){var h=(u=u.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),cn(o.return,n,e),l.lanes|=n;break}c=c.next}}else if(10===o.tag)s=o.type===e.type?null:o.child;else if(18===o.tag){if(null===(s=o.return))throw Error(a(341));s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),cn(s,n,e),s=o.sibling}else s=o.child;if(null!==s)s.return=o;else for(s=o;null!==s;){if(s===e){s=null;break}if(null!==(o=s.sibling)){o.return=s.return,s=o;break}s=s.return}o=s}Fi(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,un(e,n),r=r(i=hn(i)),e.flags|=1,Fi(t,e,r,n),e.child;case 14:return i=tn(r=e.type,e.pendingProps),Bi(t,e,r,i=tn(r.type,i),n);case 15:return zi(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:tn(r,i),null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2),e.tag=1,fe(r)?(t=!0,ve(e)):t=!1,un(e,n),Mn(e,r,i),An(e,r,i,n),Hi(null,e,r,!0,t,n);case 19:return ro(t,e,n);case 22:return ji(t,e,n)}throw Error(a(156,e.tag))},e.attemptContinuousHydration=function(t){13===t.tag&&(Sa(t,134217728,_a()),hs(t,134217728))},e.attemptHydrationAtCurrentPriority=function(t){if(13===t.tag){var e=_a(),n=wa(t);Sa(t,n,e),hs(t,n)}},e.attemptSynchronousHydration=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Ee(e.pendingLanes);0!==n&&(Re(e,1|n),Ea(e,Ue()),0===(6&Yo)&&(ca(),Ze()))}break;case 13:var r=_a();Ra((function(){return Sa(t,1,r)})),hs(t,1)}},e.batchedUpdates=function(t,e){var n=Yo;Yo|=1;try{return t(e)}finally{0===(Yo=n)&&(ca(),Xe&&Ze())}},e.createComponentSelector=function(t){return{$$typeof:No,value:t}},e.createContainer=function(t,e,n,r,i,o,a){return ss(t,e,!1,null,0,r,0,o,a)},e.createHasPseudoClassSelector=function(t){return{$$typeof:Oo,value:t}},e.createHydrationContainer=function(t,e,n,r,i,o,a,s,l){return(t=ss(n,r,!0,t,0,o,0,s,l)).context=ls(null),n=t.current,(o=gn(r=_a(),i=wa(n))).callback=void 0!==e&&null!==e?e:null,yn(n,o),t.current.lanes=i,Ie(t,i,r),Ea(t,r),t},e.createPortal=function(t,e,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:c,key:null==r?null:""+r,children:t,containerInfo:e,implementation:n}},e.createRoleSelector=function(t){return{$$typeof:Do,value:t}},e.createTestNameSelector=function(t){return{$$typeof:Lo,value:t}},e.createTextSelector=function(t){return{$$typeof:Fo,value:t}},e.deferredUpdates=function(t){var e=Pe,n=Xo.transition;try{return Xo.transition=null,Pe=16,t()}finally{Pe=e,Xo.transition=n}},e.discreteUpdates=function(t,e,n,r,i){var o=Pe,a=Xo.transition;try{return Xo.transition=null,Pe=1,t(e,n,r,i)}finally{Pe=o,Xo.transition=a,0===Yo&&ca()}},e.findAllNodes=Wo,e.findBoundingRects=function(t,e){if(!rt)throw Error(a(363));e=Wo(t,e),t=[];for(var n=0;n<e.length;n++)t.push(ot(e[n]));for(e=t.length-1;0<e;e--)for(var r=(n=t[e]).x,i=r+n.width,o=n.y,s=o+n.height,l=e-1;0<=l;l--)if(e!==l){var c=t[l],u=c.x,h=u+c.width,d=c.y,p=d+c.height;if(r>=u&&o>=d&&i<=h&&s<=p){t.splice(e,1);break}if(!(r!==u||n.width!==c.width||p<o||d>s)){d>o&&(c.height+=d-o,c.y=o),p<s&&(c.height=s-d),t.splice(e,1);break}if(!(o!==d||n.height!==c.height||h<r||u>i)){u>r&&(c.width+=u-r,c.x=r),h<i&&(c.width=i-u),t.splice(e,1);break}}return t},e.findHostInstance=cs,e.findHostInstanceWithNoPortals=function(t){return null===(t=null!==(t=C(t))?I(t):null)?null:t.stateNode},e.findHostInstanceWithWarning=function(t){return cs(t)},e.flushControlled=function(t){var e=Yo;Yo|=1;var n=Xo.transition,r=Pe;try{Xo.transition=null,Pe=1,t()}finally{Pe=r,Xo.transition=n,0===(Yo=e)&&(ca(),Ze())}},e.flushPassiveEffects=Wa,e.flushSync=Ra,e.focusWithin=function(t,e){if(!rt)throw Error(a(363));for(e=Vo(t=Bo(t),e),e=Array.from(e),t=0;t<e.length;){var n=e[t++];if(!st(n)){if(5===n.tag&&ct(n.stateNode))return!0;for(n=n.child;null!==n;)e.push(n),n=n.sibling}}return!1},e.getCurrentUpdatePriority=function(){return Pe},e.getFindAllNodesFailureDescription=function(t,e){if(!rt)throw Error(a(363));var n=0,r=[];t=[Bo(t),0];for(var i=0;i<t.length;){var o=t[i++],s=t[i++],l=e[s];if((5!==o.tag||!st(o))&&(zo(o,l)&&(r.push(jo(l)),++s>n&&(n=s)),s<e.length))for(o=o.child;null!==o;)t.push(o,s),o=o.sibling}if(n<e.length){for(t=[];n<e.length;n++)t.push(jo(e[n]));return"findAllNodes was able to match part of the selector:\n  "+r.join(" > ")+"\n\nNo matching component was found for:\n  "+t.join(" > ")}return null},e.getPublicRootInstance=function(t){return(t=t.current).child?5===t.child.tag?N(t.child.stateNode):t.child.stateNode:null},e.injectIntoDevTools=function(t){if(t={bundleType:t.bundleType,version:t.version,rendererPackageName:t.rendererPackageName,rendererConfig:t.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:s.ReactCurrentDispatcher,findHostInstanceByFiber:ds,findFiberByHostInstance:t.findFiberByHostInstance||ps,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},"undefined"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)t=!1;else{var e=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(e.isDisabled||!e.supportsFiber)t=!0;else{try{We=e.inject(t),Ge=e}catch(n){}t=!!e.checkDCE}}return t},e.isAlreadyRendering=function(){return!1},e.observeVisibleRects=function(t,e,n,r){if(!rt)throw Error(a(363));t=Wo(t,e);var i=ut(t,n,r).disconnect;return{disconnect:function(){i()}}},e.registerMutableSourceForHydration=function(t,e){var n=e._getVersion;n=n(e._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[e,n]:t.mutableSourceEagerHydrationData.push(e,n)},e.runWithPriority=function(t,e){var n=Pe;try{return Pe=t,e()}finally{Pe=n}},e.shouldError=function(){return null},e.shouldSuspend=function(){return!1},e.updateContainer=function(t,e,n,r){var i=e.current,o=_a(),a=wa(i);return n=ls(n),null===e.context?e.context=n:e.pendingContext=n,(e=gn(o,a)).payload={element:t},null!==(r=void 0===r?null:r)&&(e.callback=r),yn(i,e),null!==(t=Sa(i,a,o))&&vn(t,i,a),a},e}},205:(t,e,n)=>{"use strict";t.exports=n(302)},16:(t,e,n)=>{"use strict";t.exports=n(958)},29:function(t,e,n){var r;r=function(t){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s="./src/react-webcam.tsx")}({"./src/react-webcam.tsx":function(t,e,n){"use strict";n.r(e);var r=n("react"),i=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=function(){return o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},o.apply(this,arguments)},a=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function s(){return!(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)}"undefined"!==typeof window&&(void 0===navigator.mediaDevices&&(navigator.mediaDevices={}),void 0===navigator.mediaDevices.getUserMedia&&(navigator.mediaDevices.getUserMedia=function(t){var e=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return e?new Promise((function(n,r){e.call(navigator,t,n,r)})):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}));var l=function(t){function e(e){var n=t.call(this,e)||this;return n.canvas=null,n.ctx=null,n.requestUserMediaId=0,n.unmounted=!1,n.state={hasUserMedia:!1},n}return i(e,t),e.prototype.componentDidMount=function(){var t=this.state,e=this.props;this.unmounted=!1,s()?(t.hasUserMedia||this.requestUserMedia(),e.children&&"function"!=typeof e.children&&console.warn("children must be a function")):e.onUserMediaError("getUserMedia not supported")},e.prototype.componentDidUpdate=function(t){var e=this.props;if(s()){var n=JSON.stringify(t.audioConstraints)!==JSON.stringify(e.audioConstraints),r=JSON.stringify(t.videoConstraints)!==JSON.stringify(e.videoConstraints),i=t.minScreenshotWidth!==e.minScreenshotWidth,o=t.minScreenshotHeight!==e.minScreenshotHeight;(r||i||o)&&(this.canvas=null,this.ctx=null),(n||r)&&(this.stopAndCleanup(),this.requestUserMedia())}else e.onUserMediaError("getUserMedia not supported")},e.prototype.componentWillUnmount=function(){this.unmounted=!0,this.stopAndCleanup()},e.stopMediaStream=function(t){t&&(t.getVideoTracks&&t.getAudioTracks?(t.getVideoTracks().map((function(e){t.removeTrack(e),e.stop()})),t.getAudioTracks().map((function(e){t.removeTrack(e),e.stop()}))):t.stop())},e.prototype.stopAndCleanup=function(){var t=this.state;t.hasUserMedia&&(e.stopMediaStream(this.stream),t.src&&window.URL.revokeObjectURL(t.src))},e.prototype.getScreenshot=function(t){var e=this.state,n=this.props;if(!e.hasUserMedia)return null;var r=this.getCanvas(t);return r&&r.toDataURL(n.screenshotFormat,n.screenshotQuality)},e.prototype.getCanvas=function(t){var e=this.state,n=this.props;if(!this.video)return null;if(!e.hasUserMedia||!this.video.videoHeight)return null;if(!this.ctx){var r=this.video.videoWidth,i=this.video.videoHeight;if(!this.props.forceScreenshotSourceSize){var o=r/i;i=(r=n.minScreenshotWidth||this.video.clientWidth)/o,n.minScreenshotHeight&&i<n.minScreenshotHeight&&(r=(i=n.minScreenshotHeight)*o)}this.canvas=document.createElement("canvas"),this.canvas.width=(null===t||void 0===t?void 0:t.width)||r,this.canvas.height=(null===t||void 0===t?void 0:t.height)||i,this.ctx=this.canvas.getContext("2d")}var a=this.ctx,s=this.canvas;return a&&s&&(s.width=(null===t||void 0===t?void 0:t.width)||s.width,s.height=(null===t||void 0===t?void 0:t.height)||s.height,n.mirrored&&(a.translate(s.width,0),a.scale(-1,1)),a.imageSmoothingEnabled=n.imageSmoothing,a.drawImage(this.video,0,0,(null===t||void 0===t?void 0:t.width)||s.width,(null===t||void 0===t?void 0:t.height)||s.height),n.mirrored&&(a.scale(-1,1),a.translate(-s.width,0))),s},e.prototype.requestUserMedia=function(){var t=this,n=this.props,r=function(r,i){var o={video:"undefined"===typeof i||i};n.audio&&(o.audio="undefined"===typeof r||r),t.requestUserMediaId++;var a=t.requestUserMediaId;navigator.mediaDevices.getUserMedia(o).then((function(n){t.unmounted||a!==t.requestUserMediaId?e.stopMediaStream(n):t.handleUserMedia(null,n)})).catch((function(e){t.handleUserMedia(e)}))};if("mediaDevices"in navigator)r(n.audioConstraints,n.videoConstraints);else{var i=function(t){return{optional:[{sourceId:t}]}},o=function(t){var e=t.deviceId;return"string"===typeof e?e:Array.isArray(e)&&e.length>0?e[0]:"object"===typeof e&&e.ideal?e.ideal:null};MediaStreamTrack.getSources((function(t){var e=null,a=null;t.forEach((function(t){"audio"===t.kind?e=t.id:"video"===t.kind&&(a=t.id)}));var s=o(n.audioConstraints);s&&(e=s);var l=o(n.videoConstraints);l&&(a=l),r(i(e),i(a))}))}},e.prototype.handleUserMedia=function(t,e){var n=this.props;if(t||!e)return this.setState({hasUserMedia:!1}),void n.onUserMediaError(t);this.stream=e;try{this.video&&(this.video.srcObject=e),this.setState({hasUserMedia:!0})}catch(r){this.setState({hasUserMedia:!0,src:window.URL.createObjectURL(e)})}n.onUserMedia(e)},e.prototype.render=function(){var t=this,e=this.state,n=this.props,i=n.audio,s=(n.forceScreenshotSourceSize,n.disablePictureInPicture),l=(n.onUserMedia,n.onUserMediaError,n.screenshotFormat,n.screenshotQuality,n.minScreenshotWidth,n.minScreenshotHeight,n.audioConstraints,n.videoConstraints,n.imageSmoothing,n.mirrored),c=n.style,u=void 0===c?{}:c,h=n.children,d=a(n,["audio","forceScreenshotSourceSize","disablePictureInPicture","onUserMedia","onUserMediaError","screenshotFormat","screenshotQuality","minScreenshotWidth","minScreenshotHeight","audioConstraints","videoConstraints","imageSmoothing","mirrored","style","children"]),p=l?o(o({},u),{transform:(u.transform||"")+" scaleX(-1)"}):u,f={getScreenshot:this.getScreenshot.bind(this)};return r.createElement(r.Fragment,null,r.createElement("video",o({autoPlay:!0,disablePictureInPicture:s,src:e.src,muted:!i,playsInline:!0,ref:function(e){t.video=e},style:p},d)),h&&h(f))},e.defaultProps={audio:!1,disablePictureInPicture:!1,forceScreenshotSourceSize:!1,imageSmoothing:!0,mirrored:!1,onUserMedia:function(){},onUserMediaError:function(){},screenshotFormat:"image/webp",screenshotQuality:.92},e}(r.Component);e.default=l},react:function(e,n){e.exports=t}}).default},t.exports=r(n(43))},153:(t,e,n)=>{"use strict";var r=n(43),i=Symbol.for("react.element"),o=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(t,e,n){var r,o={},c=null,u=null;for(r in void 0!==n&&(c=""+n),void 0!==e.key&&(c=""+e.key),void 0!==e.ref&&(u=e.ref),e)a.call(e,r)&&!l.hasOwnProperty(r)&&(o[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps)void 0===o[r]&&(o[r]=e[r]);return{$$typeof:i,type:t,key:c,ref:u,props:o,_owner:s.current}}e.jsx=c,e.jsxs=c},202:(t,e)=>{"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),p=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function y(t,e,n){this.props=t,this.context=e,this.refs=g,this.updater=n||f}function v(){}function b(t,e,n){this.props=t,this.context=e,this.refs=g,this.updater=n||f}y.prototype.isReactComponent={},y.prototype.setState=function(t,e){if("object"!==typeof t&&"function"!==typeof t&&null!=t)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")},y.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},v.prototype=y.prototype;var x=b.prototype=new v;x.constructor=b,m(x,y.prototype),x.isPureReactComponent=!0;var _=Array.isArray,w=Object.prototype.hasOwnProperty,S={current:null},T={key:!0,ref:!0,__self:!0,__source:!0};function E(t,e,r){var i,o={},a=null,s=null;if(null!=e)for(i in void 0!==e.ref&&(s=e.ref),void 0!==e.key&&(a=""+e.key),e)w.call(e,i)&&!T.hasOwnProperty(i)&&(o[i]=e[i]);var l=arguments.length-2;if(1===l)o.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];o.children=c}if(t&&t.defaultProps)for(i in l=t.defaultProps)void 0===o[i]&&(o[i]=l[i]);return{$$typeof:n,type:t,key:a,ref:s,props:o,_owner:S.current}}function M(t){return"object"===typeof t&&null!==t&&t.$$typeof===n}var C=/\/+/g;function A(t,e){return"object"===typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,(function(t){return e[t]}))}(""+t.key):e.toString(36)}function k(t,e,i,o,a){var s=typeof t;"undefined"!==s&&"boolean"!==s||(t=null);var l=!1;if(null===t)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(t.$$typeof){case n:case r:l=!0}}if(l)return a=a(l=t),t=""===o?"."+A(l,0):o,_(a)?(i="",null!=t&&(i=t.replace(C,"$&/")+"/"),k(a,e,i,"",(function(t){return t}))):null!=a&&(M(a)&&(a=function(t,e){return{$$typeof:n,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(a,i+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(C,"$&/")+"/")+t)),e.push(a)),1;if(l=0,o=""===o?".":o+":",_(t))for(var c=0;c<t.length;c++){var u=o+A(s=t[c],c);l+=k(s,e,i,u,a)}else if(u=function(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=p&&t[p]||t["@@iterator"])?t:null}(t),"function"===typeof u)for(t=u.call(t),c=0;!(s=t.next()).done;)l+=k(s=s.value,e,i,u=o+A(s,c++),a);else if("object"===s)throw e=String(t),Error("Objects are not valid as a React child (found: "+("[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return l}function I(t,e,n){if(null==t)return t;var r=[],i=0;return k(t,r,"","",(function(t){return e.call(n,t,i++)})),r}function R(t){if(-1===t._status){var e=t._result;(e=e()).then((function(e){0!==t._status&&-1!==t._status||(t._status=1,t._result=e)}),(function(e){0!==t._status&&-1!==t._status||(t._status=2,t._result=e)})),-1===t._status&&(t._status=0,t._result=e)}if(1===t._status)return t._result.default;throw t._result}var P={current:null},N={transition:null},O={ReactCurrentDispatcher:P,ReactCurrentBatchConfig:N,ReactCurrentOwner:S};function D(){throw Error("act(...) is not supported in production builds of React.")}e.Children={map:I,forEach:function(t,e,n){I(t,(function(){e.apply(this,arguments)}),n)},count:function(t){var e=0;return I(t,(function(){e++})),e},toArray:function(t){return I(t,(function(t){return t}))||[]},only:function(t){if(!M(t))throw Error("React.Children.only expected to receive a single React element child.");return t}},e.Component=y,e.Fragment=i,e.Profiler=a,e.PureComponent=b,e.StrictMode=o,e.Suspense=u,e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=O,e.act=D,e.cloneElement=function(t,e,r){if(null===t||void 0===t)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var i=m({},t.props),o=t.key,a=t.ref,s=t._owner;if(null!=e){if(void 0!==e.ref&&(a=e.ref,s=S.current),void 0!==e.key&&(o=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)w.call(e,c)&&!T.hasOwnProperty(c)&&(i[c]=void 0===e[c]&&void 0!==l?l[c]:e[c])}var c=arguments.length-2;if(1===c)i.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];i.children=l}return{$$typeof:n,type:t.type,key:o,ref:a,props:i,_owner:s}},e.createContext=function(t){return(t={$$typeof:l,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:t},t.Consumer=t},e.createElement=E,e.createFactory=function(t){var e=E.bind(null,t);return e.type=t,e},e.createRef=function(){return{current:null}},e.forwardRef=function(t){return{$$typeof:c,render:t}},e.isValidElement=M,e.lazy=function(t){return{$$typeof:d,_payload:{_status:-1,_result:t},_init:R}},e.memo=function(t,e){return{$$typeof:h,type:t,compare:void 0===e?null:e}},e.startTransition=function(t){var e=N.transition;N.transition={};try{t()}finally{N.transition=e}},e.unstable_act=D,e.useCallback=function(t,e){return P.current.useCallback(t,e)},e.useContext=function(t){return P.current.useContext(t)},e.useDebugValue=function(){},e.useDeferredValue=function(t){return P.current.useDeferredValue(t)},e.useEffect=function(t,e){return P.current.useEffect(t,e)},e.useId=function(){return P.current.useId()},e.useImperativeHandle=function(t,e,n){return P.current.useImperativeHandle(t,e,n)},e.useInsertionEffect=function(t,e){return P.current.useInsertionEffect(t,e)},e.useLayoutEffect=function(t,e){return P.current.useLayoutEffect(t,e)},e.useMemo=function(t,e){return P.current.useMemo(t,e)},e.useReducer=function(t,e,n){return P.current.useReducer(t,e,n)},e.useRef=function(t){return P.current.useRef(t)},e.useState=function(t){return P.current.useState(t)},e.useSyncExternalStore=function(t,e,n){return P.current.useSyncExternalStore(t,e,n)},e.useTransition=function(){return P.current.useTransition()},e.version="18.3.1"},43:(t,e,n)=>{"use strict";t.exports=n(202)},579:(t,e,n)=>{"use strict";t.exports=n(153)},234:(t,e)=>{"use strict";function n(t,e){var n=t.length;t.push(e);t:for(;0<n;){var r=n-1>>>1,i=t[r];if(!(0<o(i,e)))break t;t[r]=e,t[n]=i,n=r}}function r(t){return 0===t.length?null:t[0]}function i(t){if(0===t.length)return null;var e=t[0],n=t.pop();if(n!==e){t[0]=n;t:for(var r=0,i=t.length,a=i>>>1;r<a;){var s=2*(r+1)-1,l=t[s],c=s+1,u=t[c];if(0>o(l,n))c<i&&0>o(u,l)?(t[r]=u,t[c]=n,r=c):(t[r]=l,t[s]=n,r=s);else{if(!(c<i&&0>o(u,n)))break t;t[r]=u,t[c]=n,r=c}}}return e}function o(t,e){var n=t.sortIndex-e.sortIndex;return 0!==n?n:t.id-e.id}if("object"===typeof performance&&"function"===typeof performance.now){var a=performance;e.unstable_now=function(){return a.now()}}else{var s=Date,l=s.now();e.unstable_now=function(){return s.now()-l}}var c=[],u=[],h=1,d=null,p=3,f=!1,m=!1,g=!1,y="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function x(t){for(var e=r(u);null!==e;){if(null===e.callback)i(u);else{if(!(e.startTime<=t))break;i(u),e.sortIndex=e.expirationTime,n(c,e)}e=r(u)}}function _(t){if(g=!1,x(t),!m)if(null!==r(c))m=!0,N(w);else{var e=r(u);null!==e&&O(_,e.startTime-t)}}function w(t,n){m=!1,g&&(g=!1,v(M),M=-1),f=!0;var o=p;try{for(x(n),d=r(c);null!==d&&(!(d.expirationTime>n)||t&&!k());){var a=d.callback;if("function"===typeof a){d.callback=null,p=d.priorityLevel;var s=a(d.expirationTime<=n);n=e.unstable_now(),"function"===typeof s?d.callback=s:d===r(c)&&i(c),x(n)}else i(c);d=r(c)}if(null!==d)var l=!0;else{var h=r(u);null!==h&&O(_,h.startTime-n),l=!1}return l}finally{d=null,p=o,f=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var S,T=!1,E=null,M=-1,C=5,A=-1;function k(){return!(e.unstable_now()-A<C)}function I(){if(null!==E){var t=e.unstable_now();A=t;var n=!0;try{n=E(!0,t)}finally{n?S():(T=!1,E=null)}}else T=!1}if("function"===typeof b)S=function(){b(I)};else if("undefined"!==typeof MessageChannel){var R=new MessageChannel,P=R.port2;R.port1.onmessage=I,S=function(){P.postMessage(null)}}else S=function(){y(I,0)};function N(t){E=t,T||(T=!0,S())}function O(t,n){M=y((function(){t(e.unstable_now())}),n)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(t){t.callback=null},e.unstable_continueExecution=function(){m||f||(m=!0,N(w))},e.unstable_forceFrameRate=function(t){0>t||125<t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<t?Math.floor(1e3/t):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(t){switch(p){case 1:case 2:case 3:var e=3;break;default:e=p}var n=p;p=e;try{return t()}finally{p=n}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var n=p;p=t;try{return e()}finally{p=n}},e.unstable_scheduleCallback=function(t,i,o){var a=e.unstable_now();switch("object"===typeof o&&null!==o?o="number"===typeof(o=o.delay)&&0<o?a+o:a:o=a,t){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return t={id:h++,callback:i,priorityLevel:t,startTime:o,expirationTime:s=o+s,sortIndex:-1},o>a?(t.sortIndex=o,n(u,t),null===r(c)&&t===r(u)&&(g?(v(M),M=-1):g=!0,O(_,o-a))):(t.sortIndex=s,n(c,t),m||f||(m=!0,N(w))),t},e.unstable_shouldYield=k,e.unstable_wrapCallback=function(t){var e=p;return function(){var n=p;p=e;try{return t.apply(this,arguments)}finally{p=n}}}},853:(t,e,n)=>{"use strict";t.exports=n(234)},334:(t,e,n)=>{var r=n(359),i=n(66),o=n(635),a=n(538),s=n(288),l=n(262),c=n(430);c.alea=r,c.xor128=i,c.xorwow=o,c.xorshift7=a,c.xor4096=s,c.tychei=l,t.exports=c},359:function(t,e,n){var r;!function(t,i,o){function a(t){var e=this,n=function(){var t=4022871197,e=function(e){e=String(e);for(var n=0;n<e.length;n++){var r=.02519603282416938*(t+=e.charCodeAt(n));r-=t=r>>>0,t=(r*=t)>>>0,t+=4294967296*(r-=t)}return 2.3283064365386963e-10*(t>>>0)};return e}();e.next=function(){var t=2091639*e.s0+2.3283064365386963e-10*e.c;return e.s0=e.s1,e.s1=e.s2,e.s2=t-(e.c=0|t)},e.c=1,e.s0=n(" "),e.s1=n(" "),e.s2=n(" "),e.s0-=n(t),e.s0<0&&(e.s0+=1),e.s1-=n(t),e.s1<0&&(e.s1+=1),e.s2-=n(t),e.s2<0&&(e.s2+=1),n=null}function s(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function l(t,e){var n=new a(t),r=e&&e.state,i=n.next;return i.int32=function(){return 4294967296*n.next()|0},i.double=function(){return i()+11102230246251565e-32*(2097152*i()|0)},i.quick=i,r&&("object"==typeof r&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=l:n.amdD&&n.amdO?void 0===(r=function(){return l}.call(e,n,e,i))||(i.exports=r):this.alea=l}(0,t=n.nmd(t),n.amdD)},262:function(t,e,n){var r;!function(t,i,o){function a(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,r=e.d,i=e.a;return t=t<<25^t>>>7^n,n=n-r|0,r=r<<24^r>>>8^i,i=i-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-r|0,e.d=r<<16^n>>>16^i,e.a=i-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var r=0;r<n.length+20;r++)e.b^=0|n.charCodeAt(r),e.next()}function s(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function l(t,e){var n=new a(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=l:n.amdD&&n.amdO?void 0===(r=function(){return l}.call(e,n,e,i))||(i.exports=r):this.tychei=l}(0,t=n.nmd(t),n.amdD)},66:function(t,e,n){var r;!function(t,i,o){function a(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),e.next()}function s(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function l(t,e){var n=new a(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=l:n.amdD&&n.amdO?void 0===(r=function(){return l}.call(e,n,e,i))||(i.exports=r):this.xor128=l}(0,t=n.nmd(t),n.amdD)},288:function(t,e,n){var r;!function(t,i,o){function a(t){var e=this;e.next=function(){var t,n,r=e.w,i=e.X,o=e.i;return e.w=r=r+1640531527|0,n=i[o+34&127],t=i[o=o+1&127],n^=n<<13,t^=t<<17,n^=n>>>15,t^=t>>>12,n=i[o]=n^t,e.i=o,n+(r^r>>>16)|0},function(t,e){var n,r,i,o,a,s=[],l=128;for(e===(0|e)?(r=e,e=null):(e+="\0",r=0,l=Math.max(l,e.length)),i=0,o=-32;o<l;++o)e&&(r^=e.charCodeAt((o+32)%e.length)),0===o&&(a=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,o>=0&&(a=a+1640531527|0,i=0==(n=s[127&o]^=r+a)?i+1:0);for(i>=128&&(s[127&(e&&e.length||0)]=-1),i=127,o=512;o>0;--o)r=s[i+34&127],n=s[i=i+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[i]=r^n;t.w=a,t.X=s,t.i=i}(e,t)}function s(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function l(t,e){null==t&&(t=+new Date);var n=new a(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&(r.X&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=l:n.amdD&&n.amdO?void 0===(r=function(){return l}.call(e,n,e,i))||(i.exports=r):this.xor4096=l}(0,t=n.nmd(t),n.amdD)},538:function(t,e,n){var r;!function(t,i,o){function a(t){var e=this;e.next=function(){var t,n,r=e.x,i=e.i;return t=r[i],n=(t^=t>>>7)^t<<24,n^=(t=r[i+1&7])^t>>>10,n^=(t=r[i+3&7])^t>>>3,n^=(t=r[i+4&7])^t<<7,t=r[i+7&7],n^=(t^=t<<13)^t<<9,r[i]=n,e.i=i+1&7,n},function(t,e){var n,r=[];if(e===(0|e))r[0]=e;else for(e=""+e,n=0;n<e.length;++n)r[7&n]=r[7&n]<<15^e.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],t.x=r,t.i=0,n=256;n>0;--n)t.next()}(e,t)}function s(t,e){return e.x=t.x.slice(),e.i=t.i,e}function l(t,e){null==t&&(t=+new Date);var n=new a(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&(r.x&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=l:n.amdD&&n.amdO?void 0===(r=function(){return l}.call(e,n,e,i))||(i.exports=r):this.xorshift7=l}(0,t=n.nmd(t),n.amdD)},635:function(t,e,n){var r;!function(t,i,o){function a(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),r==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function s(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function l(t,e){var n=new a(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=l:n.amdD&&n.amdO?void 0===(r=function(){return l}.call(e,n,e,i))||(i.exports=r):this.xorwow=l}(0,t=n.nmd(t),n.amdD)},430:function(t,e,n){var r;!function(i,o,a){var s,l=256,c=a.pow(l,6),u=a.pow(2,52),h=2*u,d=l-1;function p(t,e,n){var r=[],d=y(g((e=1==e?{entropy:!0}:e||{}).entropy?[t,v(o)]:null==t?function(){try{var t;return s&&(t=s.randomBytes)?t=t(l):(t=new Uint8Array(l),(i.crypto||i.msCrypto).getRandomValues(t)),v(t)}catch(r){var e=i.navigator,n=e&&e.plugins;return[+new Date,i,n,i.screen,v(o)]}}():t,3),r),p=new f(r),b=function(){for(var t=p.g(6),e=c,n=0;t<u;)t=(t+n)*l,e*=l,n=p.g(1);for(;t>=h;)t/=2,e/=2,n>>>=1;return(t+n)/e};return b.int32=function(){return 0|p.g(4)},b.quick=function(){return p.g(4)/4294967296},b.double=b,y(v(p.S),o),(e.pass||n||function(t,e,n,r){return r&&(r.S&&m(r,p),t.state=function(){return m(p,{})}),n?(a.random=t,e):t})(b,d,"global"in e?e.global:this==a,e.state)}function f(t){var e,n=t.length,r=this,i=0,o=r.i=r.j=0,a=r.S=[];for(n||(t=[n++]);i<l;)a[i]=i++;for(i=0;i<l;i++)a[i]=a[o=d&o+t[i%n]+(e=a[i])],a[o]=e;(r.g=function(t){for(var e,n=0,i=r.i,o=r.j,a=r.S;t--;)e=a[i=d&i+1],n=n*l+a[d&(a[i]=a[o=d&o+e])+(a[o]=e)];return r.i=i,r.j=o,n})(l)}function m(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function g(t,e){var n,r=[],i=typeof t;if(e&&"object"==i)for(n in t)try{r.push(g(t[n],e-1))}catch(o){}return r.length?r:"string"==i?t:t+"\0"}function y(t,e){for(var n,r=t+"",i=0;i<r.length;)e[d&i]=d&(n^=19*e[d&i])+r.charCodeAt(i++);return v(e)}function v(t){return String.fromCharCode.apply(0,t)}if(y(a.random(),o),t.exports){t.exports=p;try{s=n(996)}catch(b){}}else void 0===(r=function(){return p}.call(e,n,e,t))||(t.exports=r)}("undefined"!==typeof self?self:this,[],Math)},68:t=>{"use strict";t.exports=function(t,e,n){return 0===t.length?t:e?(n||t.sort(e),function(t,e){for(var n=1,r=t.length,i=t[0],o=t[0],a=1;a<r;++a)if(o=i,e(i=t[a],o)){if(a===n){n++;continue}t[n++]=i}return t.length=n,t}(t,e)):(n||t.sort(),function(t){for(var e=1,n=t.length,r=t[0],i=t[0],o=1;o<n;++o,i=r)if(i=r,(r=t[o])!==i){if(o===e){e++;continue}t[e++]=r}return t.length=e,t}(t))}},817:()=>{},590:()=>{},996:()=>{}},__webpack_module_cache__={};function __webpack_require__(t){var e=__webpack_module_cache__[t];if(void 0!==e)return e.exports;var n=__webpack_module_cache__[t]={id:t,loaded:!1,exports:{}};return __webpack_modules__[t].call(n.exports,n,n.exports,__webpack_require__),n.loaded=!0,n.exports}__webpack_require__.m=__webpack_modules__,__webpack_require__.amdD=function(){throw new Error("define cannot be used indirect")},__webpack_require__.amdO={},__webpack_require__.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return __webpack_require__.d(e,{a:e}),e},(()=>{var t,e=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__;__webpack_require__.t=function(n,r){if(1&r&&(n=this(n)),8&r)return n;if("object"===typeof n&&n){if(4&r&&n.__esModule)return n;if(16&r&&"function"===typeof n.then)return n}var i=Object.create(null);__webpack_require__.r(i);var o={};t=t||[null,e({}),e([]),e(e)];for(var a=2&r&&n;"object"==typeof a&&!~t.indexOf(a);a=e(a))Object.getOwnPropertyNames(a).forEach((t=>o[t]=()=>n[t]));return o.default=()=>n,__webpack_require__.d(i,o),i}})(),__webpack_require__.d=(t,e)=>{for(var n in e)__webpack_require__.o(e,n)&&!__webpack_require__.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},__webpack_require__.f={},__webpack_require__.e=t=>Promise.all(Object.keys(__webpack_require__.f).reduce(((e,n)=>(__webpack_require__.f[n](t,e),e)),[])),__webpack_require__.u=t=>"static/js/"+t+".4c96ad26.chunk.js",__webpack_require__.miniCssF=t=>{},__webpack_require__.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}(),__webpack_require__.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t={},e="alkasalissou.tech:";__webpack_require__.l=(n,r,i,o)=>{if(t[n])t[n].push(r);else{var a,s;if(void 0!==i)for(var l=document.getElementsByTagName("script"),c=0;c<l.length;c++){var u=l[c];if(u.getAttribute("src")==n||u.getAttribute("data-webpack")==e+i){a=u;break}}a||(s=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,__webpack_require__.nc&&a.setAttribute("nonce",__webpack_require__.nc),a.setAttribute("data-webpack",e+i),a.src=n),t[n]=[r];var h=(e,r)=>{a.onerror=a.onload=null,clearTimeout(d);var i=t[n];if(delete t[n],a.parentNode&&a.parentNode.removeChild(a),i&&i.forEach((t=>t(r))),e)return e(r)},d=setTimeout(h.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=h.bind(null,a.onerror),a.onload=h.bind(null,a.onload),s&&document.head.appendChild(a)}}})(),__webpack_require__.r=t=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},__webpack_require__.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),__webpack_require__.p="/",(()=>{var t={792:0};__webpack_require__.f.j=(e,n)=>{var r=__webpack_require__.o(t,e)?t[e]:void 0;if(0!==r)if(r)n.push(r[2]);else{var i=new Promise(((n,i)=>r=t[e]=[n,i]));n.push(r[2]=i);var o=__webpack_require__.p+__webpack_require__.u(e),a=new Error;__webpack_require__.l(o,(n=>{if(__webpack_require__.o(t,e)&&(0!==(r=t[e])&&(t[e]=void 0),r)){var i=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.src;a.message="Loading chunk "+e+" failed.\n("+i+": "+o+")",a.name="ChunkLoadError",a.type=i,a.request=o,r[1](a)}}),"chunk-"+e,e)}};var e=(e,n)=>{var r,i,o=n[0],a=n[1],s=n[2],l=0;if(o.some((e=>0!==t[e]))){for(r in a)__webpack_require__.o(a,r)&&(__webpack_require__.m[r]=a[r]);if(s)s(__webpack_require__)}for(e&&e(n);l<o.length;l++)i=o[l],__webpack_require__.o(t,i)&&t[i]&&t[i][0](),t[i]=0},n=self.webpackChunkalkasalissou_tech=self.webpackChunkalkasalissou_tech||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))})();var __webpack_exports__={};(()=>{"use strict";var t={};__webpack_require__.r(t),__webpack_require__.d(t,{ACESFilmicToneMapping:()=>Eh,AddEquation:()=>Gu,AddOperation:()=>xh,AdditiveAnimationBlendMode:()=>lp,AdditiveBlending:()=>zu,AgXToneMapping:()=>Ch,AlphaFormat:()=>ld,AlwaysCompare:()=>Yp,AlwaysDepth:()=>hh,AlwaysStencilFunc:()=>zp,AmbientLight:()=>FT,AnimationAction:()=>ME,AnimationClip:()=>sT,AnimationLoader:()=>gT,AnimationMixer:()=>AE,AnimationObjectGroup:()=>EE,AnimationUtils:()=>YS,ArcCurve:()=>dw,ArrayCamera:()=>hx,ArrowHelper:()=>xM,AttachedBindMode:()=>kh,Audio:()=>uE,AudioAnalyser:()=>gE,AudioContext:()=>JT,AudioListener:()=>cE,AudioLoader:()=>QT,AxesHelper:()=>_M,BackSide:()=>Lu,BasicDepthPacking:()=>dp,BasicShadowMap:()=>Ru,BatchedMesh:()=>L_,Bone:()=>r_,BooleanKeyframeTrack:()=>tT,Box2:()=>jE,Box3:()=>nm,Box3Helper:()=>mM,BoxGeometry:()=>py,BoxHelper:()=>fM,BufferAttribute:()=>Ig,BufferGeometry:()=>Xg,BufferGeometryLoader:()=>GT,ByteType:()=>Jh,Cache:()=>cT,Camera:()=>by,CameraHelper:()=>hM,CanvasTexture:()=>cw,CapsuleGeometry:()=>Nw,CatmullRomCurve3:()=>vw,CineonToneMapping:()=>Th,CircleGeometry:()=>Ow,ClampToEdgeWrapping:()=>Uh,Clock:()=>rE,Color:()=>vg,ColorKeyframeTrack:()=>eT,ColorManagement:()=>Df,CompressedArrayTexture:()=>sw,CompressedCubeTexture:()=>lw,CompressedTexture:()=>aw,CompressedTextureLoader:()=>yT,ConeGeometry:()=>Lw,ConstantAlphaFactor:()=>lh,ConstantColorFactor:()=>ah,CubeCamera:()=>Ey,CubeReflectionMapping:()=>Ph,CubeRefractionMapping:()=>Nh,CubeTexture:()=>My,CubeTextureLoader:()=>bT,CubeUVReflectionMapping:()=>Lh,CubicBezierCurve:()=>ww,CubicBezierCurve3:()=>Sw,CubicInterpolant:()=>ZS,CullFaceBack:()=>Au,CullFaceFront:()=>ku,CullFaceFrontBack:()=>Iu,CullFaceNone:()=>Cu,Curve:()=>uw,CurvePath:()=>Iw,CustomBlending:()=>Wu,CustomToneMapping:()=>Mh,CylinderGeometry:()=>Dw,Cylindrical:()=>BE,Data3DTexture:()=>Zf,DataArrayTexture:()=>Yf,DataTexture:()=>i_,DataTextureLoader:()=>xT,DataUtils:()=>Cg,DecrementStencilOp:()=>kp,DecrementWrapStencilOp:()=>Rp,DefaultLoadingManager:()=>hT,DepthFormat:()=>pd,DepthStencilFormat:()=>fd,DepthTexture:()=>xv,DetachedBindMode:()=>Ih,DirectionalLight:()=>LT,DirectionalLightHelper:()=>lM,DiscreteInterpolant:()=>QS,DisplayP3ColorSpace:()=>bp,DodecahedronGeometry:()=>Uw,DoubleSide:()=>Fu,DstAlphaFactor:()=>eh,DstColorFactor:()=>rh,DynamicCopyUsage:()=>nf,DynamicDrawUsage:()=>Zp,DynamicReadUsage:()=>$p,EdgesGeometry:()=>Ww,EllipseCurve:()=>hw,EqualCompare:()=>Wp,EqualDepth:()=>fh,EqualStencilFunc:()=>Dp,EquirectangularReflectionMapping:()=>Oh,EquirectangularRefractionMapping:()=>Dh,Euler:()=>Bm,EventDispatcher:()=>cf,ExtrudeGeometry:()=>bS,FileLoader:()=>mT,Float16BufferAttribute:()=>Ug,Float32BufferAttribute:()=>Bg,FloatType:()=>nd,Fog:()=>Sx,FogExp2:()=>wx,FramebufferTexture:()=>ow,FrontSide:()=>Du,Frustum:()=>Oy,GLBufferAttribute:()=>NE,GLSL1:()=>of,GLSL3:()=>af,GreaterCompare:()=>Hp,GreaterDepth:()=>gh,GreaterEqualCompare:()=>Xp,GreaterEqualDepth:()=>mh,GreaterEqualStencilFunc:()=>Bp,GreaterStencilFunc:()=>Fp,GridHelper:()=>rM,Group:()=>dx,HalfFloatType:()=>rd,HemisphereLight:()=>ST,HemisphereLightHelper:()=>nM,IcosahedronGeometry:()=>_S,ImageBitmapLoader:()=>KT,ImageLoader:()=>vT,ImageUtils:()=>Bf,IncrementStencilOp:()=>Ap,IncrementWrapStencilOp:()=>Ip,InstancedBufferAttribute:()=>l_,InstancedBufferGeometry:()=>WT,InstancedInterleavedBuffer:()=>PE,InstancedMesh:()=>g_,Int16BufferAttribute:()=>Og,Int32BufferAttribute:()=>Lg,Int8BufferAttribute:()=>Rg,IntType:()=>td,InterleavedBuffer:()=>Ex,InterleavedBufferAttribute:()=>Cx,Interpolant:()=>KS,InterpolateDiscrete:()=>ep,InterpolateLinear:()=>np,InterpolateSmooth:()=>rp,InvertStencilOp:()=>Pp,KeepStencilOp:()=>Mp,KeyframeTrack:()=>$S,LOD:()=>qx,LatheGeometry:()=>Pw,Layers:()=>zm,LessCompare:()=>Vp,LessDepth:()=>dh,LessEqualCompare:()=>Gp,LessEqualDepth:()=>ph,LessEqualStencilFunc:()=>Lp,LessStencilFunc:()=>Op,Light:()=>wT,LightProbe:()=>zT,Line:()=>H_,Line3:()=>GE,LineBasicMaterial:()=>F_,LineCurve:()=>Tw,LineCurve3:()=>Ew,LineDashedMaterial:()=>VS,LineLoop:()=>Z_,LineSegments:()=>K_,LinearDisplayP3ColorSpace:()=>xp,LinearFilter:()=>Hh,LinearInterpolant:()=>JS,LinearMipMapLinearFilter:()=>Kh,LinearMipMapNearestFilter:()=>Xh,LinearMipmapLinearFilter:()=>Yh,LinearMipmapNearestFilter:()=>qh,LinearSRGBColorSpace:()=>vp,LinearToneMapping:()=>wh,LinearTransfer:()=>_p,Loader:()=>dT,LoaderUtils:()=>VT,LoadingManager:()=>uT,LoopOnce:()=>Qd,LoopPingPong:()=>tp,LoopRepeat:()=>$d,LuminanceAlphaFormat:()=>dd,LuminanceFormat:()=>hd,MOUSE:()=>Eu,Material:()=>_g,MaterialLoader:()=>jT,MathUtils:()=>xf,Matrix3:()=>wf,Matrix4:()=>km,MaxEquation:()=>Yu,Mesh:()=>hy,MeshBasicMaterial:()=>wg,MeshDepthMaterial:()=>ox,MeshDistanceMaterial:()=>ax,MeshLambertMaterial:()=>zS,MeshMatcapMaterial:()=>jS,MeshNormalMaterial:()=>BS,MeshPhongMaterial:()=>FS,MeshPhysicalMaterial:()=>LS,MeshStandardMaterial:()=>DS,MeshToonMaterial:()=>US,MinEquation:()=>Xu,MirroredRepeatWrapping:()=>Bh,MixOperation:()=>bh,MultiplyBlending:()=>Vu,MultiplyOperation:()=>vh,NearestFilter:()=>zh,NearestMipMapLinearFilter:()=>Gh,NearestMipMapNearestFilter:()=>Vh,NearestMipmapLinearFilter:()=>Wh,NearestMipmapNearestFilter:()=>jh,NeutralToneMapping:()=>Ah,NeverCompare:()=>jp,NeverDepth:()=>uh,NeverStencilFunc:()=>Np,NoBlending:()=>Uu,NoColorSpace:()=>gp,NoToneMapping:()=>_h,NormalAnimationBlendMode:()=>sp,NormalBlending:()=>Bu,NotEqualCompare:()=>qp,NotEqualDepth:()=>yh,NotEqualStencilFunc:()=>Up,NumberKeyframeTrack:()=>nT,Object3D:()=>ng,ObjectLoader:()=>HT,ObjectSpaceNormalMap:()=>mp,OctahedronGeometry:()=>wS,OneFactor:()=>Zu,OneMinusConstantAlphaFactor:()=>ch,OneMinusConstantColorFactor:()=>sh,OneMinusDstAlphaFactor:()=>nh,OneMinusDstColorFactor:()=>ih,OneMinusSrcAlphaFactor:()=>th,OneMinusSrcColorFactor:()=>Qu,OrthographicCamera:()=>Zy,P3Primaries:()=>Tp,PCFShadowMap:()=>Pu,PCFSoftShadowMap:()=>Nu,PMREMGenerator:()=>lv,Path:()=>Rw,PerspectiveCamera:()=>Sy,Plane:()=>Ry,PlaneGeometry:()=>Fy,PlaneHelper:()=>gM,PointLight:()=>OT,PointLightHelper:()=>QE,Points:()=>nw,PointsMaterial:()=>J_,PolarGridHelper:()=>iM,PolyhedronGeometry:()=>Fw,PositionalAudio:()=>mE,PropertyBinding:()=>TE,PropertyMixer:()=>yE,QuadraticBezierCurve:()=>Mw,QuadraticBezierCurve3:()=>Cw,Quaternion:()=>Qf,QuaternionKeyframeTrack:()=>iT,QuaternionLinearInterpolant:()=>rT,RED_GREEN_RGTC2_Format:()=>Zd,RED_RGTC1_Format:()=>Yd,REVISION:()=>Tu,RGBADepthPacking:()=>pp,RGBAFormat:()=>ud,RGBAIntegerFormat:()=>bd,RGBA_ASTC_10x10_Format:()=>Vd,RGBA_ASTC_10x5_Format:()=>Bd,RGBA_ASTC_10x6_Format:()=>zd,RGBA_ASTC_10x8_Format:()=>jd,RGBA_ASTC_12x10_Format:()=>Wd,RGBA_ASTC_12x12_Format:()=>Gd,RGBA_ASTC_4x4_Format:()=>Rd,RGBA_ASTC_5x4_Format:()=>Pd,RGBA_ASTC_5x5_Format:()=>Nd,RGBA_ASTC_6x5_Format:()=>Od,RGBA_ASTC_6x6_Format:()=>Dd,RGBA_ASTC_8x5_Format:()=>Ld,RGBA_ASTC_8x6_Format:()=>Fd,RGBA_ASTC_8x8_Format:()=>Ud,RGBA_BPTC_Format:()=>Hd,RGBA_ETC2_EAC_Format:()=>Id,RGBA_PVRTC_2BPPV1_Format:()=>Cd,RGBA_PVRTC_4BPPV1_Format:()=>Md,RGBA_S3TC_DXT1_Format:()=>_d,RGBA_S3TC_DXT3_Format:()=>wd,RGBA_S3TC_DXT5_Format:()=>Sd,RGBFormat:()=>cd,RGB_BPTC_SIGNED_Format:()=>qd,RGB_BPTC_UNSIGNED_Format:()=>Xd,RGB_ETC1_Format:()=>Ad,RGB_ETC2_Format:()=>kd,RGB_PVRTC_2BPPV1_Format:()=>Ed,RGB_PVRTC_4BPPV1_Format:()=>Td,RGB_S3TC_DXT1_Format:()=>xd,RGFormat:()=>yd,RGIntegerFormat:()=>vd,RawShaderMaterial:()=>OS,Ray:()=>Am,Raycaster:()=>DE,Rec709Primaries:()=>Sp,RectAreaLight:()=>UT,RedFormat:()=>md,RedIntegerFormat:()=>gd,ReinhardToneMapping:()=>Sh,RenderTarget:()=>qf,RepeatWrapping:()=>Fh,ReplaceStencilOp:()=>Cp,ReverseSubtractEquation:()=>qu,RingGeometry:()=>SS,SIGNED_RED_GREEN_RGTC2_Format:()=>Jd,SIGNED_RED_RGTC1_Format:()=>Kd,SRGBColorSpace:()=>yp,SRGBTransfer:()=>wp,Scene:()=>Tx,ShaderChunk:()=>Uy,ShaderLib:()=>zy,ShaderMaterial:()=>vy,ShadowMaterial:()=>NS,Shape:()=>Gw,ShapeGeometry:()=>TS,ShapePath:()=>wM,ShapeUtils:()=>gS,ShortType:()=>Qh,Skeleton:()=>s_,SkeletonHelper:()=>ZE,SkinnedMesh:()=>n_,Source:()=>jf,Sphere:()=>xm,SphereGeometry:()=>ES,Spherical:()=>UE,SphericalHarmonics3:()=>BT,SplineCurve:()=>Aw,SpotLight:()=>kT,SpotLightHelper:()=>qE,Sprite:()=>Vx,SpriteMaterial:()=>Ax,SrcAlphaFactor:()=>$u,SrcAlphaSaturateFactor:()=>oh,SrcColorFactor:()=>Ju,StaticCopyUsage:()=>ef,StaticDrawUsage:()=>Kp,StaticReadUsage:()=>Qp,StereoCamera:()=>nE,StreamCopyUsage:()=>rf,StreamDrawUsage:()=>Jp,StreamReadUsage:()=>tf,StringKeyframeTrack:()=>oT,SubtractEquation:()=>Hu,SubtractiveBlending:()=>ju,TOUCH:()=>Mu,TangentSpaceNormalMap:()=>fp,TetrahedronGeometry:()=>MS,Texture:()=>Gf,TextureLoader:()=>_T,TorusGeometry:()=>CS,TorusKnotGeometry:()=>AS,Triangle:()=>pg,TriangleFanDrawMode:()=>hp,TriangleStripDrawMode:()=>up,TrianglesDrawMode:()=>cp,TubeGeometry:()=>kS,UVMapping:()=>Rh,Uint16BufferAttribute:()=>Dg,Uint32BufferAttribute:()=>Fg,Uint8BufferAttribute:()=>Pg,Uint8ClampedBufferAttribute:()=>Ng,Uniform:()=>kE,UniformsGroup:()=>RE,UniformsLib:()=>By,UniformsUtils:()=>yy,UnsignedByteType:()=>Zh,UnsignedInt248Type:()=>ad,UnsignedInt5999Type:()=>sd,UnsignedIntType:()=>ed,UnsignedShort4444Type:()=>id,UnsignedShort5551Type:()=>od,UnsignedShortType:()=>$h,VSMShadowMap:()=>Ou,Vector2:()=>_f,Vector3:()=>$f,Vector4:()=>Hf,VectorKeyframeTrack:()=>aT,VideoTexture:()=>iw,WebGL3DRenderTarget:()=>Jf,WebGLArrayRenderTarget:()=>Kf,WebGLCoordinateSystem:()=>sf,WebGLCubeRenderTarget:()=>Cy,WebGLMultipleRenderTargets:()=>SM,WebGLRenderTarget:()=>Xf,WebGLRenderer:()=>_x,WebGLUtils:()=>ux,WebGPUCoordinateSystem:()=>lf,WireframeGeometry:()=>IS,WrapAroundEnding:()=>ap,ZeroCurvatureEnding:()=>ip,ZeroFactor:()=>Ku,ZeroSlopeEnding:()=>op,ZeroStencilOp:()=>Ep,createCanvasElement:()=>Af});var e={};__webpack_require__.r(e),__webpack_require__.d(e,{axisBottom:()=>TO,axisLeft:()=>EO,axisRight:()=>SO,axisTop:()=>wO});var n={};__webpack_require__.r(n),__webpack_require__.d(n,{CompositeArrayBuffer:()=>nz,browserFiles:()=>jj,browserHTTPRequest:()=>Zj,concatenateArrayBuffers:()=>vz,copyModel:()=>rj,decodeWeights:()=>cz,decodeWeightsStream:()=>fz,encodeWeights:()=>lz,fromMemory:()=>tV,fromMemorySync:()=>eV,getLoadHandlers:()=>kz,getModelArtifactsForJSON:()=>wz,getModelArtifactsForJSONSync:()=>_z,getModelArtifactsInfoForJSON:()=>Sz,getSaveHandlers:()=>Az,getWeightSpecs:()=>Tz,http:()=>Kj,isHTTPScheme:()=>Xj,listModels:()=>ej,loadWeights:()=>Gj,moveModel:()=>ij,registerLoadRouter:()=>Cz,registerSaveRouter:()=>Mz,removeModel:()=>nj,weightsLoaderFactory:()=>Hj,withSaveHandler:()=>nV,withSaveHandlerSync:()=>rV});var r={};__webpack_require__.r(r),__webpack_require__.d(r,{assertParamsValid:()=>pV,computeFlatOffset:()=>MV,computeOutShape:()=>mV,getNormalizedAxes:()=>bV,isSliceContinous:()=>EV,maskToAxes:()=>fV,parseSliceParams:()=>CV,sliceInfo:()=>AV,startForAxis:()=>SV,startIndicesWithElidedDims:()=>xV,stopForAxis:()=>TV,stopIndicesWithElidedDims:()=>_V,stridesForAxis:()=>wV,stridesWithElidedDims:()=>gV});var i={};__webpack_require__.r(i),__webpack_require__.d(i,{conv2d:()=>jq,depthwiseConv2d:()=>Gq,matMul:()=>Hq});var o={};__webpack_require__.r(o),__webpack_require__.d(o,{collectGatherOpShapeInfo:()=>JY,computeOutShape:()=>ZY,segOpComputeOptimalWindowSize:()=>KY});var a={};__webpack_require__.r(a),__webpack_require__.d(a,{ERF_A1:()=>pY,ERF_A2:()=>fY,ERF_A3:()=>mY,ERF_A4:()=>gY,ERF_A5:()=>yY,ERF_P:()=>dY,PARALLELIZE_THRESHOLD:()=>eY,RowPartitionType:()=>ZX,SELU_SCALE:()=>hY,SELU_SCALEALPHA:()=>uY,applyActivation:()=>Bq,assertAndGetBroadcastShape:()=>Oj,assertAxesAreInnerMostDims:()=>eG,assertParamsConsistent:()=>YX,assignToTypedArray:()=>SY,axesAreInnerMostDims:()=>JW,calculateShapes:()=>mq,checkEinsumDimSizes:()=>PY,checkPadOnDimRoundingMode:()=>nW,combineLocations:()=>QW,combineRaggedTensorToTensorShapes:()=>JX,complexWithEvenIndex:()=>xY,complexWithOddIndex:()=>_Y,computeConv2DInfo:()=>HV,computeConv3DInfo:()=>qV,computeDefaultPad:()=>XV,computeDilation2DInfo:()=>VV,computeOptimalWindowSize:()=>nY,computeOutAndReduceShapes:()=>$W,computeOutShape:()=>KX,computePool2DInfo:()=>WV,computePool3DInfo:()=>GV,convertConv2DDataFormat:()=>eW,decodeEinsumEquation:()=>IY,eitherStridesOrDilationsAreOne:()=>$V,expandShapeToKeepDim:()=>tG,exponent:()=>EY,exponents:()=>TY,fromStringArrayToUint8:()=>$Y,fromUint8ToStringArray:()=>QY,getAxesPermutation:()=>nG,getBroadcastDims:()=>Pj,getComplexWithIndex:()=>wY,getEinsumComputePath:()=>NY,getEinsumPermutation:()=>RY,getFusedBiasGradient:()=>Uq,getFusedDyActivation:()=>Fq,getImageCenter:()=>rY,getInnerMostAxes:()=>iG,getPermuted:()=>oY,getRaggedRank:()=>$X,getReductionAxes:()=>Nj,getReshaped:()=>iY,getReshapedPermuted:()=>aY,getRowPartitionTypesHelper:()=>QX,getSliceBeginCoords:()=>sY,getSliceSize:()=>lY,getSparseFillEmptyRowsIndicesDenseShapeMismatch:()=>FY,getSparseFillEmptyRowsNegativeIndexErrorMessage:()=>UY,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:()=>BY,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:()=>VY,getSparseReshapeInputOutputMismatchErrorMessage:()=>GY,getSparseReshapeInputOutputMultipleErrorMessage:()=>WY,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:()=>zY,getSparseReshapeNegativeOutputDimErrorMessage:()=>jY,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:()=>YY,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:()=>HY,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:()=>qY,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:()=>XY,getUndoAxesPermutation:()=>rG,isIdentityPermutation:()=>OY,log:()=>AU,mergeRealAndImagArrays:()=>vY,prepareAndValidate:()=>cY,prepareSplitSize:()=>LY,segment_util:()=>o,shouldFuse:()=>zq,slice_util:()=>r,splitRealAndImagArrays:()=>bY,stridesOrDilationsArePositive:()=>tW,tupleValuesAreOne:()=>QV,upcastType:()=>AB,validateDefaultValueShape:()=>tY,validateInput:()=>fq,validateUpdateShape:()=>pq,warn:()=>CU});var s={};__webpack_require__.r(s),__webpack_require__.d(s,{json:()=>dK});var l={};__webpack_require__.r(l),__webpack_require__.d(l,{json:()=>pK});var c={};__webpack_require__.r(c),__webpack_require__.d(c,{json:()=>fK});var u={};__webpack_require__.r(u),__webpack_require__.d(u,{json:()=>mK});var h={};__webpack_require__.r(h),__webpack_require__.d(h,{json:()=>gK});var d={};__webpack_require__.r(d),__webpack_require__.d(d,{json:()=>yK});var p={};__webpack_require__.r(p),__webpack_require__.d(p,{json:()=>vK});var f={};__webpack_require__.r(f),__webpack_require__.d(f,{json:()=>bK});var m={};__webpack_require__.r(m),__webpack_require__.d(m,{json:()=>xK});var g={};__webpack_require__.r(g),__webpack_require__.d(g,{json:()=>_K});var y={};__webpack_require__.r(y),__webpack_require__.d(y,{json:()=>wK});var v={};__webpack_require__.r(v),__webpack_require__.d(v,{json:()=>SK});var b={};__webpack_require__.r(b),__webpack_require__.d(b,{json:()=>TK});var x={};__webpack_require__.r(x),__webpack_require__.d(x,{json:()=>EK});var _={};__webpack_require__.r(_),__webpack_require__.d(_,{json:()=>MK});var w={};__webpack_require__.r(w),__webpack_require__.d(w,{json:()=>CK});var S={};__webpack_require__.r(S),__webpack_require__.d(S,{json:()=>AK});var T={};__webpack_require__.r(T),__webpack_require__.d(T,{json:()=>kK});var E={};__webpack_require__.r(E),__webpack_require__.d(E,{json:()=>IK});var M={};__webpack_require__.r(M),__webpack_require__.d(M,{OP_SCOPE_SUFFIX:()=>ZB,abs:()=>Rj,acos:()=>IV,acosh:()=>RV,add:()=>pj,addN:()=>PV,all:()=>NV,any:()=>OV,argMax:()=>DV,argMin:()=>LV,asin:()=>FV,asinh:()=>UV,atan:()=>BV,atan2:()=>zV,atanh:()=>jV,avgPool:()=>iW,avgPool3d:()=>oW,basicLSTMCell:()=>hW,batchNorm:()=>pW,batchNorm2d:()=>fW,batchNorm3d:()=>mW,batchNorm4d:()=>gW,batchToSpaceND:()=>dW,bincount:()=>yW,bitwiseAnd:()=>vW,booleanMaskAsync:()=>Mq,broadcastArgs:()=>bW,broadcastTo:()=>xW,buffer:()=>cj,cast:()=>uj,ceil:()=>_W,clipByValue:()=>wW,clone:()=>hj,complex:()=>QB,concat:()=>aW,concat1d:()=>SW,concat2d:()=>TW,concat3d:()=>EW,concat4d:()=>MW,conv1d:()=>AW,conv2d:()=>CW,conv2dTranspose:()=>IW,conv3d:()=>RW,conv3dTranspose:()=>NW,cos:()=>OW,cosh:()=>DW,cosineWindow:()=>Oq,cumprod:()=>LW,cumsum:()=>FW,denseBincount:()=>UW,depthToSpace:()=>BW,depthwiseConv2d:()=>zW,diag:()=>jW,dilation2d:()=>VW,div:()=>mj,divNoNan:()=>HW,dot:()=>qW,dropout:()=>Pq,einsum:()=>XW,elu:()=>YW,enclosingPowerOfTwo:()=>Nq,ensureShape:()=>KW,equal:()=>WW,erf:()=>ZW,euclideanNorm:()=>uG,exp:()=>hG,expandDims:()=>dG,expm1:()=>pG,eye:()=>mG,fft:()=>JH,fill:()=>Aj,floor:()=>gG,floorDiv:()=>fj,fused:()=>i,gather:()=>yG,gatherND:()=>Rq,greater:()=>vG,greaterEqual:()=>bG,ifft:()=>QH,imag:()=>xG,image:()=>VX,inTopKAsync:()=>Dq,irfft:()=>$H,isFinite:()=>_G,isInf:()=>wG,isNaN:()=>SG,leakyRelu:()=>TG,less:()=>EG,lessEqual:()=>MG,linalg:()=>WX,linspace:()=>CG,localResponseNormalization:()=>AG,log:()=>kG,log1p:()=>IG,logSigmoid:()=>NG,logSoftmax:()=>OG,logSumExp:()=>DG,logicalAnd:()=>LG,logicalNot:()=>FG,logicalOr:()=>UG,logicalXor:()=>BG,losses:()=>GX,lowerBound:()=>VG,matMul:()=>sW,max:()=>oG,maxPool:()=>WG,maxPool3d:()=>GG,maxPoolWithArgmax:()=>HG,maximum:()=>Dj,mean:()=>qG,meshgrid:()=>KG,min:()=>aG,minimum:()=>ZG,mirrorPad:()=>JG,mod:()=>QG,moments:()=>$G,movingAverage:()=>Aq,mul:()=>gj,multiRNNCell:()=>tH,multinomial:()=>eH,neg:()=>RG,norm:()=>cG,notEqual:()=>nH,oneHot:()=>rH,ones:()=>YG,onesLike:()=>iH,op:()=>JB,outerProduct:()=>oH,pad:()=>aH,pad1d:()=>sH,pad2d:()=>lH,pad3d:()=>cH,pad4d:()=>uH,pool:()=>dH,pow:()=>kj,prelu:()=>pH,print:()=>dj,prod:()=>fH,raggedGather:()=>mH,raggedRange:()=>gH,raggedTensorToTensor:()=>yH,rand:()=>vH,randomGamma:()=>SH,randomNormal:()=>TH,randomStandardNormal:()=>EH,randomUniform:()=>MH,randomUniformInt:()=>CH,range:()=>AH,real:()=>kH,reciprocal:()=>IH,relu:()=>RH,relu6:()=>PH,reshape:()=>rW,reverse:()=>NH,reverse1d:()=>OH,reverse2d:()=>DH,reverse3d:()=>LH,reverse4d:()=>FH,rfft:()=>eq,round:()=>UH,rsqrt:()=>BH,scalar:()=>_j,scatterND:()=>kq,searchSorted:()=>jG,selu:()=>zH,separableConv2d:()=>jH,setdiff1dAsync:()=>VH,sigmoid:()=>lW,sign:()=>WH,signal:()=>jX,sin:()=>GH,sinh:()=>HH,slice:()=>cW,slice1d:()=>qH,slice2d:()=>XH,slice3d:()=>YH,slice4d:()=>KH,softmax:()=>ZH,softplus:()=>PG,spaceToBatchND:()=>hH,sparse:()=>HX,sparseToDense:()=>Iq,spectral:()=>zX,split:()=>tq,sqrt:()=>yj,square:()=>vj,squaredDifference:()=>nq,squeeze:()=>rq,stack:()=>iq,step:()=>oq,stridedSlice:()=>aq,string:()=>qX,sub:()=>Ij,sum:()=>sG,tan:()=>sq,tanh:()=>uW,tensor:()=>tz,tensor1d:()=>lq,tensor2d:()=>cq,tensor3d:()=>iV,tensor4d:()=>uq,tensor5d:()=>hq,tensor6d:()=>dq,tensorScatterUpdate:()=>gq,tile:()=>fG,topk:()=>yq,transpose:()=>Cq,truncatedNormal:()=>vq,unique:()=>bq,unsortedSegmentSum:()=>xq,unstack:()=>_q,upperBound:()=>wq,variable:()=>Sq,where:()=>GW,whereAsync:()=>Eq,zeros:()=>XG,zerosLike:()=>bj});var C={};__webpack_require__.r(C),__webpack_require__.d(C,{mx:()=>S$,XI:()=>E$,Nk:()=>M$,f6:()=>C$,ct:()=>b$,YG:()=>R$,hH:()=>P$,z3:()=>N$,sG:()=>O$,uM:()=>D$,vS:()=>L$,qB:()=>F$,GG:()=>U$,lg:()=>z$,rq:()=>B$,cu:()=>V$,WR:()=>j$,GE:()=>W$,px:()=>G$,jC:()=>H$,He:()=>q$,hE:()=>X$,BF:()=>Y$,Dk:()=>Z$,cl:()=>J$,_B:()=>$$,ub:()=>r0,_f:()=>o0,Ku:()=>u0,qy:()=>h0,Zy:()=>d0,bu:()=>p0,zv:()=>f0,dH:()=>p$,HS:()=>m0,yH:()=>g0,l3:()=>y0,z9:()=>v0,x6:()=>b0,_m:()=>x0,eW:()=>_0,GK:()=>S0,SP:()=>E0,yr:()=>M0,dl:()=>C0,Dw:()=>k0,xT:()=>P0,_X:()=>Q$,wz:()=>N0});var A,k=__webpack_require__(43),I=__webpack_require__.t(k,2),R=__webpack_require__(391),P=__webpack_require__(950),N=__webpack_require__.t(P,2);function O(){return O=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},O.apply(this,arguments)}!function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"}(A||(A={}));const D="popstate";function L(t,e){if(!1===t||null===t||"undefined"===typeof t)throw new Error(e)}function F(t,e){if(!t){"undefined"!==typeof console&&console.warn(e);try{throw new Error(e)}catch(n){}}}function U(t,e){return{usr:t.state,key:t.key,idx:e}}function B(t,e,n,r){return void 0===n&&(n=null),O({pathname:"string"===typeof t?t:t.pathname,search:"",hash:""},"string"===typeof e?j(e):e,{state:n,key:e&&e.key||r||Math.random().toString(36).substr(2,8)})}function z(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&"?"!==n&&(e+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(e+="#"===r.charAt(0)?r:"#"+r),e}function j(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function V(t,e,n,r){void 0===r&&(r={});let{window:i=document.defaultView,v5Compat:o=!1}=r,a=i.history,s=A.Pop,l=null,c=u();function u(){return(a.state||{idx:null}).idx}function h(){s=A.Pop;let t=u(),e=null==t?null:t-c;c=t,l&&l({action:s,location:p.location,delta:e})}function d(t){let e="null"!==i.location.origin?i.location.origin:i.location.href,n="string"===typeof t?t:z(t);return n=n.replace(/ $/,"%20"),L(e,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,e)}null==c&&(c=0,a.replaceState(O({},a.state,{idx:c}),""));let p={get action(){return s},get location(){return t(i,a)},listen(t){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(D,h),l=t,()=>{i.removeEventListener(D,h),l=null}},createHref:t=>e(i,t),createURL:d,encodeLocation(t){let e=d(t);return{pathname:e.pathname,search:e.search,hash:e.hash}},push:function(t,e){s=A.Push;let r=B(p.location,t,e);n&&n(r,t),c=u()+1;let h=U(r,c),d=p.createHref(r);try{a.pushState(h,"",d)}catch(oA){if(oA instanceof DOMException&&"DataCloneError"===oA.name)throw oA;i.location.assign(d)}o&&l&&l({action:s,location:p.location,delta:1})},replace:function(t,e){s=A.Replace;let r=B(p.location,t,e);n&&n(r,t),c=u();let i=U(r,c),h=p.createHref(r);a.replaceState(i,"",h),o&&l&&l({action:s,location:p.location,delta:0})},go:t=>a.go(t)};return p}var W;!function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"}(W||(W={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function G(t,e,n){void 0===n&&(n="/");let r=it(("string"===typeof e?j(e):e).pathname||"/",n);if(null==r)return null;let i=H(t);!function(t){t.sort(((t,e)=>t.score!==e.score?e.score-t.score:function(t,e){let n=t.length===e.length&&t.slice(0,-1).every(((t,n)=>t===e[n]));return n?t[t.length-1]-e[e.length-1]:0}(t.routesMeta.map((t=>t.childrenIndex)),e.routesMeta.map((t=>t.childrenIndex)))))}(i);let o=null;for(let a=0;null==o&&a<i.length;++a){let t=rt(r);o=et(i[a],t)}return o}function H(t,e,n,r){void 0===e&&(e=[]),void 0===n&&(n=[]),void 0===r&&(r="");let i=(t,i,o)=>{let a={relativePath:void 0===o?t.path||"":o,caseSensitive:!0===t.caseSensitive,childrenIndex:i,route:t};a.relativePath.startsWith("/")&&(L(a.relativePath.startsWith(r),'Absolute route path "'+a.relativePath+'" nested under path "'+r+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),a.relativePath=a.relativePath.slice(r.length));let s=ct([r,a.relativePath]),l=n.concat(a);t.children&&t.children.length>0&&(L(!0!==t.index,'Index routes must not have child routes. Please remove all child routes from route path "'+s+'".'),H(t.children,e,l,s)),(null!=t.path||t.index)&&e.push({path:s,score:tt(s,t.index),routesMeta:l})};return t.forEach(((t,e)=>{var n;if(""!==t.path&&null!=(n=t.path)&&n.includes("?"))for(let r of q(t.path))i(t,e,r);else i(t,e)})),e}function q(t){let e=t.split("/");if(0===e.length)return[];let[n,...r]=e,i=n.endsWith("?"),o=n.replace(/\?$/,"");if(0===r.length)return i?[o,""]:[o];let a=q(r.join("/")),s=[];return s.push(...a.map((t=>""===t?o:[o,t].join("/")))),i&&s.push(...a),s.map((e=>t.startsWith("/")&&""===e?"/":e))}const X=/^:[\w-]+$/,Y=3,K=2,Z=1,J=10,Q=-2,$=t=>"*"===t;function tt(t,e){let n=t.split("/"),r=n.length;return n.some($)&&(r+=Q),e&&(r+=K),n.filter((t=>!$(t))).reduce(((t,e)=>t+(X.test(e)?Y:""===e?Z:J)),r)}function et(t,e){let{routesMeta:n}=t,r={},i="/",o=[];for(let a=0;a<n.length;++a){let t=n[a],s=a===n.length-1,l="/"===i?e:e.slice(i.length)||"/",c=nt({path:t.relativePath,caseSensitive:t.caseSensitive,end:s},l);if(!c)return null;Object.assign(r,c.params);let u=t.route;o.push({params:r,pathname:ct([i,c.pathname]),pathnameBase:ut(ct([i,c.pathnameBase])),route:u}),"/"!==c.pathnameBase&&(i=ct([i,c.pathnameBase]))}return o}function nt(t,e){"string"===typeof t&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=function(t,e,n){void 0===e&&(e=!1);void 0===n&&(n=!0);F("*"===t||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were "'+t.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+t.replace(/\*$/,"/*")+'".');let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((t,e,n)=>(r.push({paramName:e,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")));t.endsWith("*")?(r.push({paramName:"*"}),i+="*"===t||"/*"===t?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":""!==t&&"/"!==t&&(i+="(?:(?=\\/|$))");let o=new RegExp(i,e?void 0:"i");return[o,r]}(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let o=i[0],a=o.replace(/(.)\/+$/,"$1"),s=i.slice(1),l=r.reduce(((t,e,n)=>{let{paramName:r,isOptional:i}=e;if("*"===r){let t=s[n]||"";a=o.slice(0,o.length-t.length).replace(/(.)\/+$/,"$1")}const l=s[n];return t[r]=i&&!l?void 0:(l||"").replace(/%2F/g,"/"),t}),{});return{params:l,pathname:o,pathnameBase:a,pattern:t}}function rt(t){try{return t.split("/").map((t=>decodeURIComponent(t).replace(/\//g,"%2F"))).join("/")}catch(oA){return F(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+oA+")."),t}}function it(t,e){if("/"===e)return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&"/"!==r?null:t.slice(n)||"/"}function ot(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified `to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function at(t){return t.filter(((t,e)=>0===e||t.route.path&&t.route.path.length>0))}function st(t,e){let n=at(t);return e?n.map(((e,n)=>n===t.length-1?e.pathname:e.pathnameBase)):n.map((t=>t.pathnameBase))}function lt(t,e,n,r){let i;void 0===r&&(r=!1),"string"===typeof t?i=j(t):(i=O({},t),L(!i.pathname||!i.pathname.includes("?"),ot("?","pathname","search",i)),L(!i.pathname||!i.pathname.includes("#"),ot("#","pathname","hash",i)),L(!i.search||!i.search.includes("#"),ot("#","search","hash",i)));let o,a=""===t||""===i.pathname,s=a?"/":i.pathname;if(null==s)o=n;else{let t=e.length-1;if(!r&&s.startsWith("..")){let e=s.split("/");for(;".."===e[0];)e.shift(),t-=1;i.pathname=e.join("/")}o=t>=0?e[t]:"/"}let l=function(t,e){void 0===e&&(e="/");let{pathname:n,search:r="",hash:i=""}="string"===typeof t?j(t):t,o=n?n.startsWith("/")?n:function(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach((t=>{".."===t?n.length>1&&n.pop():"."!==t&&n.push(t)})),n.length>1?n.join("/"):"/"}(n,e):e;return{pathname:o,search:ht(r),hash:dt(i)}}(i,o),c=s&&"/"!==s&&s.endsWith("/"),u=(a||"."===s)&&n.endsWith("/");return l.pathname.endsWith("/")||!c&&!u||(l.pathname+="/"),l}const ct=t=>t.join("/").replace(/\/\/+/g,"/"),ut=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),ht=t=>t&&"?"!==t?t.startsWith("?")?t:"?"+t:"",dt=t=>t&&"#"!==t?t.startsWith("#")?t:"#"+t:"";Error;function pt(t){return null!=t&&"number"===typeof t.status&&"string"===typeof t.statusText&&"boolean"===typeof t.internal&&"data"in t}const ft=["post","put","patch","delete"],mt=(new Set(ft),["get",...ft]);new Set(mt),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function gt(){return gt=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},gt.apply(this,arguments)}const yt=k.createContext(null);const vt=k.createContext(null);const bt=k.createContext(null);const xt=k.createContext(null);const _t=k.createContext({outlet:null,matches:[],isDataRoute:!1});const wt=k.createContext(null);function St(){return null!=k.useContext(xt)}function Tt(){return St()||L(!1),k.useContext(xt).location}function Et(t){k.useContext(bt).static||k.useLayoutEffect(t)}function Mt(){let{isDataRoute:t}=k.useContext(_t);return t?function(){let{router:t}=Lt(Ot.UseNavigateStable),e=Ut(Dt.UseNavigateStable),n=k.useRef(!1);Et((()=>{n.current=!0}));let r=k.useCallback((function(r,i){void 0===i&&(i={}),n.current&&("number"===typeof r?t.navigate(r):t.navigate(r,gt({fromRouteId:e},i)))}),[t,e]);return r}():function(){St()||L(!1);let t=k.useContext(yt),{basename:e,future:n,navigator:r}=k.useContext(bt),{matches:i}=k.useContext(_t),{pathname:o}=Tt(),a=JSON.stringify(st(i,n.v7_relativeSplatPath)),s=k.useRef(!1);Et((()=>{s.current=!0}));let l=k.useCallback((function(n,i){if(void 0===i&&(i={}),!s.current)return;if("number"===typeof n)return void r.go(n);let l=lt(n,JSON.parse(a),o,"path"===i.relative);null==t&&"/"!==e&&(l.pathname="/"===l.pathname?e:ct([e,l.pathname])),(i.replace?r.replace:r.push)(l,i.state,i)}),[e,r,a,o,t]);return l}()}function Ct(t,e){let{relative:n}=void 0===e?{}:e,{future:r}=k.useContext(bt),{matches:i}=k.useContext(_t),{pathname:o}=Tt(),a=JSON.stringify(st(i,r.v7_relativeSplatPath));return k.useMemo((()=>lt(t,JSON.parse(a),o,"path"===n)),[t,a,o,n])}function At(t,e,n,r){St()||L(!1);let{navigator:i}=k.useContext(bt),{matches:o}=k.useContext(_t),a=o[o.length-1],s=a?a.params:{},l=(a&&a.pathname,a?a.pathnameBase:"/");a&&a.route;let c,u=Tt();if(e){var h;let t="string"===typeof e?j(e):e;"/"===l||(null==(h=t.pathname)?void 0:h.startsWith(l))||L(!1),c=t}else c=u;let d=c.pathname||"/",p=d;if("/"!==l){let t=l.replace(/^\//,"").split("/");p="/"+d.replace(/^\//,"").split("/").slice(t.length).join("/")}let f=G(t,{pathname:p});let m=Nt(f&&f.map((t=>Object.assign({},t,{params:Object.assign({},s,t.params),pathname:ct([l,i.encodeLocation?i.encodeLocation(t.pathname).pathname:t.pathname]),pathnameBase:"/"===t.pathnameBase?l:ct([l,i.encodeLocation?i.encodeLocation(t.pathnameBase).pathname:t.pathnameBase])}))),o,n,r);return e&&m?k.createElement(xt.Provider,{value:{location:gt({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:A.Pop}},m):m}function kt(){let t=function(){var t;let e=k.useContext(wt),n=Ft(Dt.UseRouteError),r=Ut(Dt.UseRouteError);if(void 0!==e)return e;return null==(t=n.errors)?void 0:t[r]}(),e=pt(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:r};return k.createElement(k.Fragment,null,k.createElement("h2",null,"Unexpected Application Error!"),k.createElement("h3",{style:{fontStyle:"italic"}},e),n?k.createElement("pre",{style:i},n):null,null)}const It=k.createElement(kt,null);class Rt extends k.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||"idle"!==e.revalidation&&"idle"===t.revalidation?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:void 0!==t.error?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return void 0!==this.state.error?k.createElement(_t.Provider,{value:this.props.routeContext},k.createElement(wt.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Pt(t){let{routeContext:e,match:n,children:r}=t,i=k.useContext(yt);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),k.createElement(_t.Provider,{value:e},r)}function Nt(t,e,n,r){var i;if(void 0===e&&(e=[]),void 0===n&&(n=null),void 0===r&&(r=null),null==t){var o;if(null==(o=n)||!o.errors)return null;t=n.matches}let a=t,s=null==(i=n)?void 0:i.errors;if(null!=s){let t=a.findIndex((t=>t.route.id&&void 0!==(null==s?void 0:s[t.route.id])));t>=0||L(!1),a=a.slice(0,Math.min(a.length,t+1))}let l=!1,c=-1;if(n&&r&&r.v7_partialHydration)for(let u=0;u<a.length;u++){let t=a[u];if((t.route.HydrateFallback||t.route.hydrateFallbackElement)&&(c=u),t.route.id){let{loaderData:e,errors:r}=n,i=t.route.loader&&void 0===e[t.route.id]&&(!r||void 0===r[t.route.id]);if(t.route.lazy||i){l=!0,a=c>=0?a.slice(0,c+1):[a[0]];break}}}return a.reduceRight(((t,r,i)=>{let o,u=!1,h=null,d=null;var p;n&&(o=s&&r.route.id?s[r.route.id]:void 0,h=r.route.errorElement||It,l&&(c<0&&0===i?(p="route-fallback",!1||Bt[p]||(Bt[p]=!0),u=!0,d=null):c===i&&(u=!0,d=r.route.hydrateFallbackElement||null)));let f=e.concat(a.slice(0,i+1)),m=()=>{let e;return e=o?h:u?d:r.route.Component?k.createElement(r.route.Component,null):r.route.element?r.route.element:t,k.createElement(Pt,{match:r,routeContext:{outlet:t,matches:f,isDataRoute:null!=n},children:e})};return n&&(r.route.ErrorBoundary||r.route.errorElement||0===i)?k.createElement(Rt,{location:n.location,revalidation:n.revalidation,component:h,error:o,children:m(),routeContext:{outlet:null,matches:f,isDataRoute:!0}}):m()}),null)}var Ot=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(Ot||{}),Dt=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(Dt||{});function Lt(t){let e=k.useContext(yt);return e||L(!1),e}function Ft(t){let e=k.useContext(vt);return e||L(!1),e}function Ut(t){let e=function(t){let e=k.useContext(_t);return e||L(!1),e}(),n=e.matches[e.matches.length-1];return n.route.id||L(!1),n.route.id}const Bt={};I.startTransition;function zt(t){L(!1)}function jt(t){let{basename:e="/",children:n=null,location:r,navigationType:i=A.Pop,navigator:o,static:a=!1,future:s}=t;St()&&L(!1);let l=e.replace(/^\/*/,"/"),c=k.useMemo((()=>({basename:l,navigator:o,static:a,future:gt({v7_relativeSplatPath:!1},s)})),[l,s,o,a]);"string"===typeof r&&(r=j(r));let{pathname:u="/",search:h="",hash:d="",state:p=null,key:f="default"}=r,m=k.useMemo((()=>{let t=it(u,l);return null==t?null:{location:{pathname:t,search:h,hash:d,state:p,key:f},navigationType:i}}),[l,u,h,d,p,f,i]);return null==m?null:k.createElement(bt.Provider,{value:c},k.createElement(xt.Provider,{children:n,value:m}))}function Vt(t){let{children:e,location:n}=t;return At(Wt(e),n)}new Promise((()=>{}));k.Component;function Wt(t,e){void 0===e&&(e=[]);let n=[];return k.Children.forEach(t,((t,r)=>{if(!k.isValidElement(t))return;let i=[...e,r];if(t.type===k.Fragment)return void n.push.apply(n,Wt(t.props.children,i));t.type!==zt&&L(!1),t.props.index&&t.props.children&&L(!1);let o={id:t.props.id||i.join("-"),caseSensitive:t.props.caseSensitive,element:t.props.element,Component:t.props.Component,index:t.props.index,path:t.props.path,loader:t.props.loader,action:t.props.action,errorElement:t.props.errorElement,ErrorBoundary:t.props.ErrorBoundary,hasErrorBoundary:null!=t.props.ErrorBoundary||null!=t.props.errorElement,shouldRevalidate:t.props.shouldRevalidate,handle:t.props.handle,lazy:t.props.lazy};t.props.children&&(o.children=Wt(t.props.children,i)),n.push(o)})),n}function Gt(){return Gt=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Gt.apply(this,arguments)}function Ht(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);const qt=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"];try{window.__reactRouterVersion="6"}catch($7){}new Map;const Xt=I.startTransition;N.flushSync,I.useId;function Yt(t){let{basename:e,children:n,future:r,window:i}=t,o=k.useRef();var a;null==o.current&&(o.current=(void 0===(a={window:i,v5Compat:!0})&&(a={}),V((function(t,e){let{pathname:n,search:r,hash:i}=t.location;return B("",{pathname:n,search:r,hash:i},e.state&&e.state.usr||null,e.state&&e.state.key||"default")}),(function(t,e){return"string"===typeof e?e:z(e)}),null,a)));let s=o.current,[l,c]=k.useState({action:s.action,location:s.location}),{v7_startTransition:u}=r||{},h=k.useCallback((t=>{u&&Xt?Xt((()=>c(t))):c(t)}),[c,u]);return k.useLayoutEffect((()=>s.listen(h)),[s,h]),k.createElement(jt,{basename:e,children:n,location:l.location,navigationType:l.action,navigator:s,future:r})}const Kt="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,Zt=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Jt=k.forwardRef((function(t,e){let n,{onClick:r,relative:i,reloadDocument:o,replace:a,state:s,target:l,to:c,preventScrollReset:u,unstable_viewTransition:h}=t,d=Ht(t,qt),{basename:p}=k.useContext(bt),f=!1;if("string"===typeof c&&Zt.test(c)&&(n=c,Kt))try{let t=new URL(window.location.href),e=c.startsWith("//")?new URL(t.protocol+c):new URL(c),n=it(e.pathname,p);e.origin===t.origin&&null!=n?c=n+e.search+e.hash:f=!0}catch($7){}let m=function(t,e){let{relative:n}=void 0===e?{}:e;St()||L(!1);let{basename:r,navigator:i}=k.useContext(bt),{hash:o,pathname:a,search:s}=Ct(t,{relative:n}),l=a;return"/"!==r&&(l="/"===a?r:ct([r,a])),i.createHref({pathname:l,search:s,hash:o})}(c,{relative:i}),g=function(t,e){let{target:n,replace:r,state:i,preventScrollReset:o,relative:a,unstable_viewTransition:s}=void 0===e?{}:e,l=Mt(),c=Tt(),u=Ct(t,{relative:a});return k.useCallback((e=>{if(function(t,e){return 0===t.button&&(!e||"_self"===e)&&!function(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}(t)}(e,n)){e.preventDefault();let n=void 0!==r?r:z(c)===z(u);l(t,{replace:n,state:i,preventScrollReset:o,relative:a,unstable_viewTransition:s})}}),[c,l,u,r,i,n,t,o,a,s])}(c,{replace:a,state:s,target:l,preventScrollReset:u,relative:i,unstable_viewTransition:h});return k.createElement("a",Gt({},d,{href:n||m,onClick:f||o?r:function(t){r&&r(t),t.defaultPrevented||g(t)},ref:e,target:l}))}));var Qt,$t;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Qt||(Qt={})),function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"}($t||($t={}));const te=Object.freeze({left:0,top:0,width:16,height:16}),ee=Object.freeze({rotate:0,vFlip:!1,hFlip:!1}),ne=Object.freeze({...te,...ee}),re=Object.freeze({...ne,body:"",hidden:!1});function ie(t,e){const n=function(t,e){const n={};!t.hFlip!==!e.hFlip&&(n.hFlip=!0),!t.vFlip!==!e.vFlip&&(n.vFlip=!0);const r=((t.rotate||0)+(e.rotate||0))%4;return r&&(n.rotate=r),n}(t,e);for(const r in re)r in ee?r in t&&!(r in n)&&(n[r]=ee[r]):r in e?n[r]=e[r]:r in t&&(n[r]=t[r]);return n}function oe(t,e,n){const r=t.icons,i=t.aliases||Object.create(null);let o={};function a(t){o=ie(r[t]||i[t],o)}return a(e),n.forEach(a),ie(t,o)}function ae(t,e){const n=[];if("object"!==typeof t||"object"!==typeof t.icons)return n;t.not_found instanceof Array&&t.not_found.forEach((t=>{e(t,null),n.push(t)}));const r=function(t,e){const n=t.icons,r=t.aliases||Object.create(null),i=Object.create(null);return(e||Object.keys(n).concat(Object.keys(r))).forEach((function t(e){if(n[e])return i[e]=[];if(!(e in i)){i[e]=null;const n=r[e]&&r[e].parent,o=n&&t(n);o&&(i[e]=[n].concat(o))}return i[e]})),i}(t);for(const i in r){const o=r[i];o&&(e(i,oe(t,i,o)),n.push(i))}return n}const se=/^[a-z0-9]+(-[a-z0-9]+)*$/,le=function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";const i=t.split(":");if("@"===t.slice(0,1)){if(i.length<2||i.length>3)return null;r=i.shift().slice(1)}if(i.length>3||!i.length)return null;if(i.length>1){const t=i.pop(),n=i.pop(),o={provider:i.length>0?i[0]:r,prefix:n,name:t};return e&&!ce(o)?null:o}const o=i[0],a=o.split("-");if(a.length>1){const t={provider:r,prefix:a.shift(),name:a.join("-")};return e&&!ce(t)?null:t}if(n&&""===r){const t={provider:r,prefix:"",name:o};return e&&!ce(t,n)?null:t}return null},ce=(t,e)=>!!t&&!(""!==t.provider&&!t.provider.match(se)||!(e&&""===t.prefix||t.prefix.match(se))||!t.name.match(se)),ue={provider:"",aliases:{},not_found:{},...te};function he(t,e){for(const n in e)if(n in t&&typeof t[n]!==typeof e[n])return!1;return!0}function de(t){if("object"!==typeof t||null===t)return null;const e=t;if("string"!==typeof e.prefix||!t.icons||"object"!==typeof t.icons)return null;if(!he(t,ue))return null;const n=e.icons;for(const i in n){const t=n[i];if(!i.match(se)||"string"!==typeof t.body||!he(t,re))return null}const r=e.aliases||Object.create(null);for(const i in r){const t=r[i],e=t.parent;if(!i.match(se)||"string"!==typeof e||!n[e]&&!r[e]||!he(t,re))return null}return e}const pe=Object.create(null);function fe(t,e){const n=pe[t]||(pe[t]=Object.create(null));return n[e]||(n[e]=function(t,e){return{provider:t,prefix:e,icons:Object.create(null),missing:new Set}}(t,e))}function me(t,e){return de(e)?ae(e,((e,n)=>{n?t.icons[e]=n:t.missing.add(e)})):[]}let ge=!1;function ye(t){return"boolean"===typeof t&&(ge=t),ge}function ve(t){const e="string"===typeof t?le(t,!0,ge):t;if(e){const t=fe(e.provider,e.prefix),n=e.name;return t.icons[n]||(t.missing.has(n)?null:void 0)}}function be(t,e){if("object"!==typeof t)return!1;if("string"!==typeof e&&(e=t.provider||""),ge&&!e&&!t.prefix){let e=!1;return de(t)&&(t.prefix="",ae(t,((t,n)=>{n&&function(t,e){const n=le(t,!0,ge);return!!n&&function(t,e,n){try{if("string"===typeof n.body)return t.icons[e]={...n},!0}catch(r){}return!1}(fe(n.provider,n.prefix),n.name,e)}(t,n)&&(e=!0)}))),e}const n=t.prefix;if(!ce({provider:e,prefix:n,name:"a"}))return!1;return!!me(fe(e,n),t)}const xe=Object.freeze({width:null,height:null}),_e=Object.freeze({...xe,...ee}),we=/(-?[0-9.]*[0-9]+[0-9.]*)/g,Se=/^-?[0-9.]*[0-9]+[0-9.]*$/g;function Te(t,e,n){if(1===e)return t;if(n=n||100,"number"===typeof t)return Math.ceil(t*e*n)/n;if("string"!==typeof t)return t;const r=t.split(we);if(null===r||!r.length)return t;const i=[];let o=r.shift(),a=Se.test(o);for(;;){if(a){const t=parseFloat(o);isNaN(t)?i.push(o):i.push(Math.ceil(t*e*n)/n)}else i.push(o);if(o=r.shift(),void 0===o)return i.join("");a=!a}}const Ee=/\sid="(\S+)"/g,Me="IconifyId"+Date.now().toString(16)+(16777216*Math.random()|0).toString(16);let Ce=0;function Ae(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Me;const n=[];let r;for(;r=Ee.exec(t);)n.push(r[1]);if(!n.length)return t;const i="suffix"+(16777216*Math.random()|Date.now()).toString(16);return n.forEach((n=>{const r="function"===typeof e?e(n):e+(Ce++).toString(),o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");t=t.replace(new RegExp('([#;"])('+o+')([")]|\\.[a-z])',"g"),"$1"+r+i+"$3")})),t=t.replace(new RegExp(i,"g"),"")}const ke=Object.create(null);function Ie(t,e){ke[t]=e}function Re(t){return ke[t]||ke[""]}function Pe(t){let e;if("string"===typeof t.resources)e=[t.resources];else if(e=t.resources,!(e instanceof Array)||!e.length)return null;return{resources:e,path:t.path||"/",maxURL:t.maxURL||500,rotate:t.rotate||750,timeout:t.timeout||5e3,random:!0===t.random,index:t.index||0,dataAfterTimeout:!1!==t.dataAfterTimeout}}const Ne=Object.create(null),Oe=["https://api.simplesvg.com","https://api.unisvg.com"],De=[];for(;Oe.length>0;)1===Oe.length||Math.random()>.5?De.push(Oe.shift()):De.push(Oe.pop());function Le(t,e){const n=Pe(e);return null!==n&&(Ne[t]=n,!0)}function Fe(t){return Ne[t]}Ne[""]=Pe({resources:["https://api.iconify.design"].concat(De)});let Ue=(()=>{let t;try{if(t=fetch,"function"===typeof t)return t}catch(e){}})();const Be={prepare:(t,e,n)=>{const r=[],i=function(t,e){const n=Fe(t);if(!n)return 0;let r;if(n.maxURL){let t=0;n.resources.forEach((e=>{const n=e;t=Math.max(t,n.length)}));const i=e+".json?icons=";r=n.maxURL-t-n.path.length-i.length}else r=0;return r}(t,e),o="icons";let a={type:o,provider:t,prefix:e,icons:[]},s=0;return n.forEach(((n,l)=>{s+=n.length+1,s>=i&&l>0&&(r.push(a),a={type:o,provider:t,prefix:e,icons:[]},s=n.length),a.icons.push(n)})),r.push(a),r},send:(t,e,n)=>{if(!Ue)return void n("abort",424);let r=function(t){if("string"===typeof t){const e=Fe(t);if(e)return e.path}return"/"}(e.provider);switch(e.type){case"icons":{const t=e.prefix,n=e.icons.join(",");r+=t+".json?"+new URLSearchParams({icons:n}).toString();break}case"custom":{const t=e.uri;r+="/"===t.slice(0,1)?t.slice(1):t;break}default:return void n("abort",400)}let i=503;Ue(t+r).then((t=>{const e=t.status;if(200===e)return i=501,t.json();setTimeout((()=>{n(function(t){return 404===t}(e)?"abort":"next",e)}))})).then((t=>{"object"===typeof t&&null!==t?setTimeout((()=>{n("success",t)})):setTimeout((()=>{404===t?n("abort",t):n("next",i)}))})).catch((()=>{n("next",i)}))}};function ze(t,e){t.forEach((t=>{const n=t.loaderCallbacks;n&&(t.loaderCallbacks=n.filter((t=>t.id!==e)))}))}let je=0;var Ve={resources:[],index:0,timeout:2e3,rotate:750,random:!1,dataAfterTimeout:!1};function We(t,e,n,r){const i=t.resources.length,o=t.random?Math.floor(Math.random()*i):t.index;let a;if(t.random){let e=t.resources.slice(0);for(a=[];e.length>1;){const t=Math.floor(Math.random()*e.length);a.push(e[t]),e=e.slice(0,t).concat(e.slice(t+1))}a=a.concat(e)}else a=t.resources.slice(o).concat(t.resources.slice(0,o));const s=Date.now();let l,c="pending",u=0,h=null,d=[],p=[];function f(){h&&(clearTimeout(h),h=null)}function m(){"pending"===c&&(c="aborted"),f(),d.forEach((t=>{"pending"===t.status&&(t.status="aborted")})),d=[]}function g(t,e){e&&(p=[]),"function"===typeof t&&p.push(t)}function y(){c="failed",p.forEach((t=>{t(void 0,l)}))}function v(){d.forEach((t=>{"pending"===t.status&&(t.status="aborted")})),d=[]}function b(){if("pending"!==c)return;f();const r=a.shift();if(void 0===r)return d.length?void(h=setTimeout((()=>{f(),"pending"===c&&(v(),y())}),t.timeout)):void y();const i={status:"pending",resource:r,callback:(e,n)=>{!function(e,n,r){const i="success"!==n;switch(d=d.filter((t=>t!==e)),c){case"pending":break;case"failed":if(i||!t.dataAfterTimeout)return;break;default:return}if("abort"===n)return l=r,void y();if(i)return l=r,void(d.length||(a.length?b():y()));if(f(),v(),!t.random){const n=t.resources.indexOf(e.resource);-1!==n&&n!==t.index&&(t.index=n)}c="completed",p.forEach((t=>{t(r)}))}(i,e,n)}};d.push(i),u++,h=setTimeout(b,t.rotate),n(r,e,i.callback)}return"function"===typeof r&&p.push(r),setTimeout(b),function(){return{startTime:s,payload:e,status:c,queriesSent:u,queriesPending:d.length,subscribe:g,abort:m}}}function Ge(t){const e={...Ve,...t};let n=[];function r(){n=n.filter((t=>"pending"===t().status))}const i={query:function(t,i,o){const a=We(e,t,i,((t,e)=>{r(),o&&o(t,e)}));return n.push(a),a},find:function(t){return n.find((e=>t(e)))||null},setIndex:t=>{e.index=t},getIndex:()=>e.index,cleanup:r};return i}function He(){}const qe=Object.create(null);function Xe(t,e,n){let r,i;if("string"===typeof t){const e=Re(t);if(!e)return n(void 0,424),He;i=e.send;const o=function(t){if(!qe[t]){const e=Fe(t);if(!e)return;const n={config:e,redundancy:Ge(e)};qe[t]=n}return qe[t]}(t);o&&(r=o.redundancy)}else{const e=Pe(t);if(e){r=Ge(e);const n=Re(t.resources?t.resources[0]:"");n&&(i=n.send)}}return r&&i?r.query(e,i,n)().abort:(n(void 0,424),He)}const Ye="iconify2",Ke="iconify",Ze=Ke+"-count",Je=Ke+"-version",Qe=36e5,$e=168,tn=50;function en(t,e){try{return t.getItem(e)}catch(n){}}function nn(t,e,n){try{return t.setItem(e,n),!0}catch(r){}}function rn(t,e){try{t.removeItem(e)}catch(n){}}function on(t,e){return nn(t,Ze,e.toString())}function an(t){return parseInt(en(t,Ze))||0}const sn={local:!0,session:!0},ln={local:new Set,session:new Set};let cn=!1;let un="undefined"===typeof window?{}:window;function hn(t){const e=t+"Storage";try{if(un&&un[e]&&"number"===typeof un[e].length)return un[e]}catch(n){}sn[t]=!1}function dn(t,e){const n=hn(t);if(!n)return;const r=en(n,Je);if(r!==Ye){if(r){const t=an(n);for(let e=0;e<t;e++)rn(n,Ke+e.toString())}return nn(n,Je,Ye),void on(n,0)}const i=Math.floor(Date.now()/Qe)-$e,o=t=>{const r=Ke+t.toString(),o=en(n,r);if("string"===typeof o){try{const n=JSON.parse(o);if("object"===typeof n&&"number"===typeof n.cached&&n.cached>i&&"string"===typeof n.provider&&"object"===typeof n.data&&"string"===typeof n.data.prefix&&e(n,t))return!0}catch(a){}rn(n,r)}};let a=an(n);for(let s=a-1;s>=0;s--)o(s)||(s===a-1?(a--,on(n,a)):ln[t].add(s))}function pn(){if(!cn){cn=!0;for(const t in sn)dn(t,(t=>{const e=t.data,n=fe(t.provider,e.prefix);if(!me(n,e).length)return!1;const r=e.lastModified||-1;return n.lastModifiedCached=n.lastModifiedCached?Math.min(n.lastModifiedCached,r):r,!0}))}}function fn(t,e){function n(n){let r;if(!sn[n]||!(r=hn(n)))return;const i=ln[n];let o;if(i.size)i.delete(o=Array.from(i).shift());else if(o=an(r),o>=tn||!on(r,o+1))return;const a={cached:Math.floor(Date.now()/Qe),provider:t.provider,data:e};return nn(r,Ke+o.toString(),JSON.stringify(a))}cn||pn(),e.lastModified&&!function(t,e){const n=t.lastModifiedCached;if(n&&n>=e)return n===e;if(t.lastModifiedCached=e,n)for(const r in sn)dn(r,(n=>{const r=n.data;return n.provider!==t.provider||r.prefix!==t.prefix||r.lastModified===e}));return!0}(t,e.lastModified)||Object.keys(e.icons).length&&(e.not_found&&delete(e=Object.assign({},e)).not_found,n("local")||n("session"))}function mn(){}function gn(t){t.iconsLoaderFlag||(t.iconsLoaderFlag=!0,setTimeout((()=>{t.iconsLoaderFlag=!1,function(t){t.pendingCallbacksFlag||(t.pendingCallbacksFlag=!0,setTimeout((()=>{t.pendingCallbacksFlag=!1;const e=t.loaderCallbacks?t.loaderCallbacks.slice(0):[];if(!e.length)return;let n=!1;const r=t.provider,i=t.prefix;e.forEach((e=>{const o=e.icons,a=o.pending.length;o.pending=o.pending.filter((e=>{if(e.prefix!==i)return!0;const a=e.name;if(t.icons[a])o.loaded.push({provider:r,prefix:i,name:a});else{if(!t.missing.has(a))return n=!0,!0;o.missing.push({provider:r,prefix:i,name:a})}return!1})),o.pending.length!==a&&(n||ze([t],e.id),e.callback(o.loaded.slice(0),o.missing.slice(0),o.pending.slice(0),e.abort))}))})))}(t)})))}const yn=(t,e)=>{const n=function(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=[];return t.forEach((t=>{const i="string"===typeof t?le(t,e,n):t;i&&r.push(i)})),r}(t,!0,ye()),r=function(t){const e={loaded:[],missing:[],pending:[]},n=Object.create(null);t.sort(((t,e)=>t.provider!==e.provider?t.provider.localeCompare(e.provider):t.prefix!==e.prefix?t.prefix.localeCompare(e.prefix):t.name.localeCompare(e.name)));let r={provider:"",prefix:"",name:""};return t.forEach((t=>{if(r.name===t.name&&r.prefix===t.prefix&&r.provider===t.provider)return;r=t;const i=t.provider,o=t.prefix,a=t.name,s=n[i]||(n[i]=Object.create(null)),l=s[o]||(s[o]=fe(i,o));let c;c=a in l.icons?e.loaded:""===o||l.missing.has(a)?e.missing:e.pending;const u={provider:i,prefix:o,name:a};c.push(u)})),e}(n);if(!r.pending.length){let t=!0;return e&&setTimeout((()=>{t&&e(r.loaded,r.missing,r.pending,mn)})),()=>{t=!1}}const i=Object.create(null),o=[];let a,s;return r.pending.forEach((t=>{const{provider:e,prefix:n}=t;if(n===s&&e===a)return;a=e,s=n,o.push(fe(e,n));const r=i[e]||(i[e]=Object.create(null));r[n]||(r[n]=[])})),r.pending.forEach((t=>{const{provider:e,prefix:n,name:r}=t,o=fe(e,n),a=o.pendingIcons||(o.pendingIcons=new Set);a.has(r)||(a.add(r),i[e][n].push(r))})),o.forEach((t=>{const{provider:e,prefix:n}=t;i[e][n].length&&function(t,e){t.iconsToLoad?t.iconsToLoad=t.iconsToLoad.concat(e).sort():t.iconsToLoad=e,t.iconsQueueFlag||(t.iconsQueueFlag=!0,setTimeout((()=>{t.iconsQueueFlag=!1;const{provider:e,prefix:n}=t,r=t.iconsToLoad;let i;delete t.iconsToLoad,r&&(i=Re(e))&&i.prepare(e,n,r).forEach((n=>{Xe(e,n,(e=>{if("object"!==typeof e)n.icons.forEach((e=>{t.missing.add(e)}));else try{const n=me(t,e);if(!n.length)return;const r=t.pendingIcons;r&&n.forEach((t=>{r.delete(t)})),fn(t,e)}catch(r){console.error(r)}gn(t)}))}))})))}(t,i[e][n])})),e?function(t,e,n){const r=je++,i=ze.bind(null,n,r);if(!e.pending.length)return i;const o={id:r,icons:e,callback:t,abort:i};return n.forEach((t=>{(t.loaderCallbacks||(t.loaderCallbacks=[])).push(o)})),i}(e,r,o):mn};const vn=/[\s,]+/;function bn(t,e){e.split(vn).forEach((e=>{switch(e.trim()){case"horizontal":t.hFlip=!0;break;case"vertical":t.vFlip=!0}}))}function xn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=t.replace(/^-?[0-9.]*/,"");function r(t){for(;t<0;)t+=4;return t%4}if(""===n){const e=parseInt(t);return isNaN(e)?0:r(e)}if(n!==t){let e=0;switch(n){case"%":e=25;break;case"deg":e=90}if(e){let i=parseFloat(t.slice(0,t.length-n.length));return isNaN(i)?0:(i/=e,i%1===0?r(i):0)}}return e}let _n;function wn(t){return void 0===_n&&function(){try{_n=window.trustedTypes.createPolicy("iconify",{createHTML:t=>t})}catch(t){_n=null}}(),_n?_n.createHTML(t):t}const Sn={..._e,inline:!1},Tn={xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink","aria-hidden":!0,role:"img"},En={display:"inline-block"},Mn={backgroundColor:"currentColor"},Cn={backgroundColor:"transparent"},An={Image:"var(--svg)",Repeat:"no-repeat",Size:"100% 100%"},kn={WebkitMask:Mn,mask:Mn,background:Cn};for(const e9 in kn){const t=kn[e9];for(const e in An)t[e9+e]=An[e]}const In={...Sn,inline:!0};function Rn(t){return t+(t.match(/^[-0-9.]+$/)?"px":"")}const Pn=(t,e,n)=>{const r=e.inline?In:Sn,i=function(t,e){const n={...t};for(const r in e){const t=e[r],i=typeof t;r in xe?(null===t||t&&("string"===i||"number"===i))&&(n[r]=t):i===typeof n[r]&&(n[r]="rotate"===r?t%4:t)}return n}(r,e),o=e.mode||"svg",a={},s=e.style||{},l={..."svg"===o?Tn:{}};if(n){const t=le(n,!1,!0);if(t){const e=["iconify"],n=["provider","prefix"];for(const r of n)t[r]&&e.push("iconify--"+t[r]);l.className=e.join(" ")}}for(let y in e){const t=e[y];if(void 0!==t)switch(y){case"icon":case"style":case"children":case"onLoad":case"mode":case"ssr":break;case"_ref":l.ref=t;break;case"className":l[y]=(l[y]?l[y]+" ":"")+t;break;case"inline":case"hFlip":case"vFlip":i[y]=!0===t||"true"===t||1===t;break;case"flip":"string"===typeof t&&bn(i,t);break;case"color":a.color=t;break;case"rotate":"string"===typeof t?i[y]=xn(t):"number"===typeof t&&(i[y]=t);break;case"ariaHidden":case"aria-hidden":!0!==t&&"true"!==t&&delete l["aria-hidden"];break;default:void 0===r[y]&&(l[y]=t)}}const c=function(t,e){const n={...ne,...t},r={..._e,...e},i={left:n.left,top:n.top,width:n.width,height:n.height};let o=n.body;[n,r].forEach((t=>{const e=[],n=t.hFlip,r=t.vFlip;let a,s=t.rotate;switch(n?r?s+=2:(e.push("translate("+(i.width+i.left).toString()+" "+(0-i.top).toString()+")"),e.push("scale(-1 1)"),i.top=i.left=0):r&&(e.push("translate("+(0-i.left).toString()+" "+(i.height+i.top).toString()+")"),e.push("scale(1 -1)"),i.top=i.left=0),s<0&&(s-=4*Math.floor(s/4)),s%=4,s){case 1:a=i.height/2+i.top,e.unshift("rotate(90 "+a.toString()+" "+a.toString()+")");break;case 2:e.unshift("rotate(180 "+(i.width/2+i.left).toString()+" "+(i.height/2+i.top).toString()+")");break;case 3:a=i.width/2+i.left,e.unshift("rotate(-90 "+a.toString()+" "+a.toString()+")")}s%2===1&&(i.left!==i.top&&(a=i.left,i.left=i.top,i.top=a),i.width!==i.height&&(a=i.width,i.width=i.height,i.height=a)),e.length&&(o=function(t,e,n){const r=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"defs",n="";const r=t.indexOf("<"+e);for(;r>=0;){const i=t.indexOf(">",r),o=t.indexOf("</"+e);if(-1===i||-1===o)break;const a=t.indexOf(">",o);if(-1===a)break;n+=t.slice(i+1,o).trim(),t=t.slice(0,r).trim()+t.slice(a+1)}return{defs:n,content:t}}(t);return i=r.defs,o=e+r.content+n,i?"<defs>"+i+"</defs>"+o:o;var i,o}(o,'<g transform="'+e.join(" ")+'">',"</g>"))}));const a=r.width,s=r.height,l=i.width,c=i.height;let u,h;null===a?(h=null===s?"1em":"auto"===s?c:s,u=Te(h,l/c)):(u="auto"===a?l:a,h=null===s?Te(u,c/l):"auto"===s?c:s);const d={},p=(t,e)=>{(t=>"unset"===t||"undefined"===t||"none"===t)(e)||(d[t]=e.toString())};p("width",u),p("height",h);const f=[i.left,i.top,l,c];return d.viewBox=f.join(" "),{attributes:d,viewBox:f,body:o}}(t,i),u=c.attributes;if(i.inline&&(a.verticalAlign="-0.125em"),"svg"===o){l.style={...a,...s},Object.assign(l,u);let t=0,n=e.id;return"string"===typeof n&&(n=n.replace(/-/g,"_")),l.dangerouslySetInnerHTML={__html:wn(Ae(c.body,n?()=>n+"ID"+t++:"iconifyReact"))},(0,k.createElement)("svg",l)}const{body:h,width:d,height:p}=t,f="mask"===o||"bg"!==o&&-1!==h.indexOf("currentColor"),m=function(t,e){let n=-1===t.indexOf("xlink:")?"":' xmlns:xlink="http://www.w3.org/1999/xlink"';for(const r in e)n+=" "+r+'="'+e[r]+'"';return'<svg xmlns="http://www.w3.org/2000/svg"'+n+">"+t+"</svg>"}(h,{...u,width:d+"",height:p+""});var g;return l.style={...a,"--svg":(g=m,'url("'+function(t){return"data:image/svg+xml,"+function(t){return t.replace(/"/g,"'").replace(/%/g,"%25").replace(/#/g,"%23").replace(/</g,"%3C").replace(/>/g,"%3E").replace(/\s+/g," ")}(t)}(g)+'")'),width:Rn(u.width),height:Rn(u.height),...En,...f?Mn:Cn,...s},(0,k.createElement)("span",l)};if(ye(!0),Ie("",Be),"undefined"!==typeof document&&"undefined"!==typeof window){pn();const t=window;if(void 0!==t.IconifyPreload){const e=t.IconifyPreload,n="Invalid IconifyPreload syntax.";"object"===typeof e&&null!==e&&(e instanceof Array?e:[e]).forEach((t=>{try{("object"!==typeof t||null===t||t instanceof Array||"object"!==typeof t.icons||"string"!==typeof t.prefix||!be(t))&&console.error(n)}catch($7){console.error(n)}}))}if(void 0!==t.IconifyProviders){const e=t.IconifyProviders;if("object"===typeof e&&null!==e)for(let t in e){const n="IconifyProviders["+t+"] is invalid.";try{const r=e[t];if("object"!==typeof r||!r||void 0===r.resources)continue;Le(t,r)||console.error(n)}catch($7){console.error(n)}}}}function Nn(t){const[e,n]=(0,k.useState)(!!t.ssr),[r,i]=(0,k.useState)({});const[o,a]=(0,k.useState)(function(e){if(e){const e=t.icon;if("object"===typeof e)return{name:"",data:e};const n=ve(e);if(n)return{name:e,data:n}}return{name:""}}(!!t.ssr));function s(){const t=r.callback;t&&(t(),i({}))}function l(t){if(JSON.stringify(o)!==JSON.stringify(t))return s(),a(t),!0}function c(){var e;const n=t.icon;if("object"===typeof n)return void l({name:"",data:n});const r=ve(n);if(l({name:n,data:r}))if(void 0===r){const t=yn([n],c);i({callback:t})}else r&&(null===(e=t.onLoad)||void 0===e||e.call(t,n))}(0,k.useEffect)((()=>(n(!0),s)),[]),(0,k.useEffect)((()=>{e&&c()}),[t.icon,e]);const{name:u,data:h}=o;return h?Pn({...ne,...h},t,u):t.children?t.children:(0,k.createElement)("span",{})}const On=(0,k.forwardRef)(((t,e)=>Nn({...t,_ref:e})));(0,k.forwardRef)(((t,e)=>Nn({inline:!0,...t,_ref:e})));var Dn=__webpack_require__(579);const Ln=t=>{let{setNavBarHeight:e}=t;const[n,r]=(0,k.useState)(!1),i=(0,k.useRef)(null),o=()=>{r(!n)};return(0,k.useEffect)((()=>{i.current&&e(i.current.offsetHeight)}),[e]),(0,Dn.jsxs)("div",{ref:i,className:"navbar bg-base-100 fixed top-0 left-0 w-full z-50",children:[(0,Dn.jsx)("div",{className:"navbar-start",children:(0,Dn.jsx)(Jt,{to:"/",children:(0,Dn.jsxs)("div",{className:"btn btn-ghost text-xl",children:[(0,Dn.jsx)(On,{icon:"gravity-ui:terminal"}),"Mahamadou"]})})}),(0,Dn.jsx)("div",{className:"navbar-center hidden lg:flex",children:(0,Dn.jsxs)("ul",{className:"menu menu-horizontal px-1",children:[(0,Dn.jsx)("li",{className:"text-xl mx-5 font-bold",children:(0,Dn.jsx)(Jt,{to:"/resume",children:"Resume"})}),(0,Dn.jsxs)("li",{className:"text-xl mx-5 font-bold relative",children:[(0,Dn.jsxs)("button",{onClick:o,className:"flex items-center space-x-1",children:[(0,Dn.jsx)("span",{children:"Projects"}),(0,Dn.jsx)(On,{icon:n?"mdi:chevron-up":"mdi:chevron-down"})]}),n&&(0,Dn.jsxs)("ul",{className:"absolute shadow-lg p-2 mt-10 space-y-2 rounded-lg z-10 bg-slate-700",children:[(0,Dn.jsx)("li",{className:"text-base",onClick:o,children:(0,Dn.jsx)(Jt,{to:"/projects/computervision",children:"Computer Vision"})}),(0,Dn.jsx)("li",{className:"text-base",onClick:o,children:(0,Dn.jsx)(Jt,{to:"/projects/nlp",children:"NLP"})}),(0,Dn.jsx)("li",{className:"text-base",onClick:o,children:(0,Dn.jsx)(Jt,{to:"/projects/dataviz",children:"Data Viz"})})]})]})]})})]})};function Fn(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{l(r.next(t))}catch(t){o(t)}}function s(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((r=r.apply(t,e||[])).next())}))}function Un(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function Bn(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function zn(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function jn(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))}function Vn(t,e,n,r,i){for(var o=[],a=5;a<arguments.length;a++)o[a-5]=arguments[a];return Fn(this,void 0,void 0,(function(){var a,s,l,c,u,h;return Un(this,(function(d){switch(d.label){case 0:d.trys.push([0,12,13,14]),a=Bn(o),s=a.next(),d.label=1;case 1:if(s.done)return[3,11];switch(typeof(l=s.value)){case"string":return[3,2];case"number":return[3,4];case"function":return[3,6]}return[3,8];case 2:return[4,Wn(t,e,l,n,r,i)];case 3:return d.sent(),[3,10];case 4:return[4,Gn(l)];case 5:return d.sent(),[3,10];case 6:return[4,l.apply(void 0,jn([t,e,n,r,i],zn(o),!1))];case 7:return d.sent(),[3,10];case 8:return[4,l];case 9:d.sent(),d.label=10;case 10:return s=a.next(),[3,1];case 11:return[3,14];case 12:return c=d.sent(),u={error:c},[3,14];case 13:try{s&&!s.done&&(h=a.return)&&h.call(a)}finally{if(u)throw u.error}return[7];case 14:return[2]}}))}))}function Wn(t,e,n,r,i,o){return Fn(this,void 0,void 0,(function(){var a,s;return Un(this,(function(l){switch(l.label){case 0:return a=t.textContent||"",s=function(t,e){var n=zn(e).slice(0);return jn(jn([],zn(t),!1),[NaN],!1).findIndex((function(t,e){return n[e]!==t}))}(a,n),[4,Hn(t,jn(jn([],zn(Xn(a,e,s)),!1),zn(qn(n,e,s)),!1),r,i,o)];case 1:return l.sent(),[2]}}))}))}function Gn(t){return Fn(this,void 0,void 0,(function(){return Un(this,(function(e){switch(e.label){case 0:return[4,new Promise((function(e){return setTimeout(e,t)}))];case 1:return e.sent(),[2]}}))}))}function Hn(t,e,n,r,i){return Fn(this,void 0,void 0,(function(){var o,a,s,l,c,u,h,d,p,f,m,g,y;return Un(this,(function(v){switch(v.label){case 0:if(o=e,i){for(a=0,s=1;s<e.length;s++)if(l=zn([e[s-1],e[s]],2),c=l[0],(u=l[1]).length>c.length||""===u){a=s;break}o=e.slice(a,e.length)}v.label=1;case 1:v.trys.push([1,6,7,8]),h=Bn(function(t){var e,n,r,i,o,a,s;return Un(this,(function(l){switch(l.label){case 0:e=function(t){return Un(this,(function(e){switch(e.label){case 0:return[4,{op:function(e){return requestAnimationFrame((function(){return e.textContent=t}))},opCode:function(e){var n=e.textContent||"";return""===t||n.length>t.length?"DELETE":"WRITING"}}];case 1:return e.sent(),[2]}}))},l.label=1;case 1:l.trys.push([1,6,7,8]),n=Bn(t),r=n.next(),l.label=2;case 2:return r.done?[3,5]:(i=r.value,[5,e(i)]);case 3:l.sent(),l.label=4;case 4:return r=n.next(),[3,2];case 5:return[3,8];case 6:return o=l.sent(),a={error:o},[3,8];case 7:try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(a)throw a.error}return[7];case 8:return[2]}}))}(o)),d=h.next(),v.label=2;case 2:return d.done?[3,5]:(p=d.value,f="WRITING"===p.opCode(t)?n+n*(Math.random()-.5):r+r*(Math.random()-.5),p.op(t),[4,Gn(f)]);case 3:v.sent(),v.label=4;case 4:return d=h.next(),[3,2];case 5:return[3,8];case 6:return m=v.sent(),g={error:m},[3,8];case 7:try{d&&!d.done&&(y=h.return)&&y.call(h)}finally{if(g)throw g.error}return[7];case 8:return[2]}}))}))}function qn(t,e,n){var r,i;return void 0===n&&(n=0),Un(this,(function(o){switch(o.label){case 0:r=e(t),i=r.length,o.label=1;case 1:return n<i?[4,r.slice(0,++n).join("")]:[3,3];case 2:return o.sent(),[3,1];case 3:return[2]}}))}function Xn(t,e,n){var r,i;return void 0===n&&(n=0),Un(this,(function(o){switch(o.label){case 0:r=e(t),i=r.length,o.label=1;case 1:return i>n?[4,r.slice(0,--i).join("")]:[3,3];case 2:return o.sent(),[3,1];case 3:return[2]}}))}!function(t,e){void 0===e&&(e={});var n=e.insertAt;if(t&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===n&&r.firstChild?r.insertBefore(i,r.firstChild):r.appendChild(i),i.styleSheet?i.styleSheet.cssText=t:i.appendChild(document.createTextNode(t))}}(".index-module_type__E-SaG::after {\n  content: '|';\n  animation: index-module_cursor__PQg0P 1.1s infinite step-start;\n}\n\n@keyframes index-module_cursor__PQg0P {\n  50% {\n    opacity: 0;\n  }\n}\n");var Yn=(0,k.memo)((0,k.forwardRef)((function(t,e){var n=t.sequence,r=t.repeat,i=t.className,o=t.speed,a=void 0===o?40:o,s=t.deletionSpeed,l=t.omitDeletionAnimation,c=void 0!==l&&l,u=t.preRenderFirstString,h=void 0!==u&&u,d=t.wrapper,p=void 0===d?"span":d,f=t.splitter,m=void 0===f?function(t){return jn([],zn(t),!1)}:f,g=t.cursor,y=void 0===g||g,v=t.style,b=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}(t,["sequence","repeat","className","speed","deletionSpeed","omitDeletionAnimation","preRenderFirstString","wrapper","splitter","cursor","style"]),x=b["aria-label"],_=b["aria-hidden"],w=b.role;s||(s=a);var S=new Array(2).fill(40);[a,s].forEach((function(t,e){switch(typeof t){case"number":S[e]=Math.abs(t-100);break;case"object":var n=t.type,r=t.value;if("number"!=typeof r)break;"keyStrokeDelayInMs"===n&&(S[e]=r)}}));var T,E,M,C,A,I,R=S[0],P=S[1],N=function(t,e){void 0===e&&(e=null);var n=(0,k.useRef)(e);return(0,k.useEffect)((function(){t&&("function"==typeof t?t(n.current):t.current=n.current)}),[t]),n}(e),O="index-module_type__E-SaG";T=i?"".concat(y?O+" ":"").concat(i):y?O:"",E=(0,k.useRef)((function(){var t,e=n;r===1/0?t=Vn:"number"==typeof r&&(e=Array(1+r).fill(n).flat());var i=t?jn(jn([],zn(e),!1),[t],!1):jn([],zn(e),!1);return Vn.apply(void 0,jn([N.current,m,R,P,c],zn(i),!1)),function(){N.current}})),M=(0,k.useRef)(),C=(0,k.useRef)(!1),A=(0,k.useRef)(!1),I=zn((0,k.useState)(0),2)[1],C.current&&(A.current=!0),(0,k.useEffect)((function(){return C.current||(M.current=E.current(),C.current=!0),I((function(t){return t+1})),function(){A.current&&M.current&&M.current()}}),[]);var D=p,L=h?n.find((function(t){return"string"==typeof t}))||"":null;return k.createElement(D,{"aria-hidden":_,"aria-label":x,role:w,style:v,className:T,children:x?k.createElement("span",{"aria-hidden":"true",ref:N,children:L}):L,ref:x?void 0:N})})),(function(t,e){return!0}));const Kn=(0,k.createContext)({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"}),Zn=(0,k.createContext)({}),Jn=(0,k.createContext)(null),Qn="undefined"!==typeof document,$n=Qn?k.useLayoutEffect:k.useEffect,tr=(0,k.createContext)({strict:!1}),er=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),nr="data-"+er("framerAppearId"),rr=!1,ir=!1;class or{constructor(){this.order=[],this.scheduled=new Set}add(t){if(!this.scheduled.has(t))return this.scheduled.add(t),this.order.push(t),!0}remove(t){const e=this.order.indexOf(t);-1!==e&&(this.order.splice(e,1),this.scheduled.delete(t))}clear(){this.order.length=0,this.scheduled.clear()}}const ar=["read","resolveKeyframes","update","preRender","render","postRender"];function sr(t,e){let n=!1,r=!0;const i={delta:0,timestamp:0,isProcessing:!1},o=ar.reduce(((t,e)=>(t[e]=function(t){let e=new or,n=new or,r=0,i=!1,o=!1;const a=new WeakSet,s={schedule:function(t){const o=arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&i,s=o?e:n;return arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&a.add(t),s.add(t)&&o&&i&&(r=e.order.length),t},cancel:t=>{n.remove(t),a.delete(t)},process:l=>{if(i)o=!0;else{if(i=!0,[e,n]=[n,e],n.clear(),r=e.order.length,r)for(let n=0;n<r;n++){const r=e.order[n];a.has(r)&&(s.schedule(r),t()),r(l)}i=!1,o&&(o=!1,s.process(l))}}};return s}((()=>n=!0)),t)),{}),a=t=>{o[t].process(i)},s=()=>{const o=ir?i.timestamp:performance.now();n=!1,i.delta=r?1e3/60:Math.max(Math.min(o-i.timestamp,40),1),i.timestamp=o,i.isProcessing=!0,ar.forEach(a),i.isProcessing=!1,n&&e&&(r=!1,t(s))},l=ar.reduce(((e,a)=>{const l=o[a];return e[a]=function(e){let o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n||(n=!0,r=!0,i.isProcessing||t(s)),l.schedule(e,o,a)},e}),{});return{schedule:l,cancel:t=>ar.forEach((e=>o[e].cancel(t))),state:i,steps:o}}const{schedule:lr,cancel:cr}=sr(queueMicrotask,!1);function ur(t){return t&&"object"===typeof t&&Object.prototype.hasOwnProperty.call(t,"current")}const hr=(0,k.createContext)({});let dr=!1;function pr(t,e,n,r,i){const{visualElement:o}=(0,k.useContext)(Zn),a=(0,k.useContext)(tr),s=(0,k.useContext)(Jn),l=(0,k.useContext)(Kn).reducedMotion,c=(0,k.useRef)();r=r||a.renderer,!c.current&&r&&(c.current=r(t,{visualState:e,parent:o,props:n,presenceContext:s,blockInitialAnimation:!!s&&!1===s.initial,reducedMotionConfig:l}));const u=c.current,h=(0,k.useContext)(hr);!u||u.projection||!i||"html"!==u.type&&"svg"!==u.type||function(t,e,n,r){const{layoutId:i,layout:o,drag:a,dragConstraints:s,layoutScroll:l,layoutRoot:c}=e;t.projection=new n(t.latestValues,e["data-framer-portal-id"]?void 0:mr(t.parent)),t.projection.setOptions({layoutId:i,layout:o,alwaysMeasureLayout:Boolean(a)||s&&ur(s),visualElement:t,scheduleRender:()=>t.scheduleRender(),animationType:"string"===typeof o?o:"both",initialPromotionConfig:r,layoutScroll:l,layoutRoot:c})}(c.current,n,i,h),(0,k.useInsertionEffect)((()=>{u&&u.update(n,s)}));const d=(0,k.useRef)(Boolean(n[nr]&&!window.HandoffComplete));return $n((()=>{u&&(u.updateFeatures(),lr.render(u.render),d.current&&u.animationState&&u.animationState.animateChanges())})),(0,k.useEffect)((()=>{u&&(!d.current&&u.animationState&&u.animationState.animateChanges(),d.current&&(d.current=!1,dr||(dr=!0,queueMicrotask(fr))))})),u}function fr(){window.HandoffComplete=!0}function mr(t){if(t)return!1!==t.options.allowProjection?t.projection:mr(t.parent)}function gr(t,e,n){return(0,k.useCallback)((r=>{r&&t.mount&&t.mount(r),e&&(r?e.mount(r):e.unmount()),n&&("function"===typeof n?n(r):ur(n)&&(n.current=r))}),[e])}function yr(t){return"string"===typeof t||Array.isArray(t)}function vr(t){return null!==t&&"object"===typeof t&&"function"===typeof t.start}const br=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],xr=["initial",...br];function _r(t){return vr(t.animate)||xr.some((e=>yr(t[e])))}function wr(t){return Boolean(_r(t)||t.variants)}function Sr(t){const{initial:e,animate:n}=function(t,e){if(_r(t)){const{initial:e,animate:n}=t;return{initial:!1===e||yr(e)?e:void 0,animate:yr(n)?n:void 0}}return!1!==t.inherit?e:{}}(t,(0,k.useContext)(Zn));return(0,k.useMemo)((()=>({initial:e,animate:n})),[Tr(e),Tr(n)])}function Tr(t){return Array.isArray(t)?t.join(" "):t}const Er={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Mr={};for(const e9 in Er)Mr[e9]={isEnabled:t=>Er[e9].some((e=>!!t[e]))};const Cr=(0,k.createContext)({}),Ar=Symbol.for("motionComponentSymbol");function kr(t){let{preloadedFeatures:e,createVisualElement:n,useRender:r,useVisualState:i,Component:o}=t;e&&function(t){for(const e in t)Mr[e]={...Mr[e],...t[e]}}(e);const a=(0,k.forwardRef)((function(t,e){let a;const s={...(0,k.useContext)(Kn),...t,layoutId:Ir(t)},{isStatic:l}=s,c=Sr(t),u=i(t,l);if(!l&&Qn){!function(t,e){(0,k.useContext)(tr).strict;0}();const t=function(t){const{drag:e,layout:n}=Mr;if(!e&&!n)return{};const r={...e,...n};return{MeasureLayout:(null===e||void 0===e?void 0:e.isEnabled(t))||(null===n||void 0===n?void 0:n.isEnabled(t))?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}(s);a=t.MeasureLayout,c.visualElement=pr(o,u,s,n,t.ProjectionNode)}return(0,Dn.jsxs)(Zn.Provider,{value:c,children:[a&&c.visualElement?(0,Dn.jsx)(a,{visualElement:c.visualElement,...s}):null,r(o,t,gr(u,c.visualElement,e),u,l,c.visualElement)]})}));return a[Ar]=o,a}function Ir(t){let{layoutId:e}=t;const n=(0,k.useContext)(Cr).id;return n&&void 0!==e?n+"-"+e:e}function Rr(t){function e(e){return kr(t(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}if("undefined"===typeof Proxy)return e;const n=new Map;return new Proxy(e,{get:(t,r)=>(n.has(r)||n.set(r,e(r)),n.get(r))})}const Pr=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Nr(t){return"string"===typeof t&&!t.includes("-")&&!!(Pr.indexOf(t)>-1||/[A-Z]/u.test(t))}const Or={};const Dr=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Lr=new Set(Dr);function Fr(t,e){let{layout:n,layoutId:r}=e;return Lr.has(t)||t.startsWith("origin")||(n||void 0!==r)&&(!!Or[t]||"opacity"===t)}const Ur=t=>Boolean(t&&t.getVelocity),Br={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},zr=Dr.length;const jr=t=>e=>"string"===typeof e&&e.startsWith(t),Vr=jr("--"),Wr=jr("var(--"),Gr=t=>!!Wr(t)&&Hr.test(t.split("/*")[0].trim()),Hr=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,qr=(t,e)=>e&&"number"===typeof t?e.transform(t):t,Xr=(t,e,n)=>n>e?e:n<t?t:n,Yr={test:t=>"number"===typeof t,parse:parseFloat,transform:t=>t},Kr={...Yr,transform:t=>Xr(0,1,t)},Zr={...Yr,default:1},Jr=t=>Math.round(1e5*t)/1e5,Qr=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu,$r=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu,ti=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu;function ei(t){return"string"===typeof t}const ni=t=>({test:e=>ei(e)&&e.endsWith(t)&&1===e.split(" ").length,parse:parseFloat,transform:e=>"".concat(e).concat(t)}),ri=ni("deg"),ii=ni("%"),oi=ni("px"),ai=ni("vh"),si=ni("vw"),li={...ii,parse:t=>ii.parse(t)/100,transform:t=>ii.transform(100*t)},ci={...Yr,transform:Math.round},ui={borderWidth:oi,borderTopWidth:oi,borderRightWidth:oi,borderBottomWidth:oi,borderLeftWidth:oi,borderRadius:oi,radius:oi,borderTopLeftRadius:oi,borderTopRightRadius:oi,borderBottomRightRadius:oi,borderBottomLeftRadius:oi,width:oi,maxWidth:oi,height:oi,maxHeight:oi,size:oi,top:oi,right:oi,bottom:oi,left:oi,padding:oi,paddingTop:oi,paddingRight:oi,paddingBottom:oi,paddingLeft:oi,margin:oi,marginTop:oi,marginRight:oi,marginBottom:oi,marginLeft:oi,rotate:ri,rotateX:ri,rotateY:ri,rotateZ:ri,scale:Zr,scaleX:Zr,scaleY:Zr,scaleZ:Zr,skew:ri,skewX:ri,skewY:ri,distance:oi,translateX:oi,translateY:oi,translateZ:oi,x:oi,y:oi,z:oi,perspective:oi,transformPerspective:oi,opacity:Kr,originX:li,originY:li,originZ:oi,zIndex:ci,backgroundPositionX:oi,backgroundPositionY:oi,fillOpacity:Kr,strokeOpacity:Kr,numOctaves:ci};function hi(t,e,n,r){const{style:i,vars:o,transform:a,transformOrigin:s}=t;let l=!1,c=!1,u=!0;for(const h in e){const t=e[h];if(Vr(h)){o[h]=t;continue}const n=ui[h],r=qr(t,n);if(Lr.has(h)){if(l=!0,a[h]=r,!u)continue;t!==(n.default||0)&&(u=!1)}else h.startsWith("origin")?(c=!0,s[h]=r):i[h]=r}if(e.transform||(l||r?i.transform=function(t,e,n,r){let{enableHardwareAcceleration:i=!0,allowTransformNone:o=!0}=e,a="";for(let s=0;s<zr;s++){const e=Dr[s];if(void 0!==t[e]){const n=Br[e]||e;a+="".concat(n,"(").concat(t[e],") ")}}return i&&!t.z&&(a+="translateZ(0)"),a=a.trim(),r?a=r(t,n?"":a):o&&n&&(a="none"),a}(t.transform,n,u,r):i.transform&&(i.transform="none")),c){const{originX:t="50%",originY:e="50%",originZ:n=0}=s;i.transformOrigin="".concat(t," ").concat(e," ").concat(n)}}const di=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function pi(t,e,n){for(const r in e)Ur(e[r])||Fr(r,n)||(t[r]=e[r])}function fi(t,e,n){const r={};return pi(r,t.style||{},t),Object.assign(r,function(t,e,n){let{transformTemplate:r}=t;return(0,k.useMemo)((()=>{const t=di();return hi(t,e,{enableHardwareAcceleration:!n},r),Object.assign({},t.vars,t.style)}),[e])}(t,e,n)),r}function mi(t,e,n){const r={},i=fi(t,e,n);return t.drag&&!1!==t.dragListener&&(r.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=!0===t.drag?"none":"pan-".concat("x"===t.drag?"y":"x")),void 0===t.tabIndex&&(t.onTap||t.onTapStart||t.whileTap)&&(r.tabIndex=0),r.style=i,r}const gi=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function yi(t){return t.startsWith("while")||t.startsWith("drag")&&"draggable"!==t||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||gi.has(t)}let vi=t=>!yi(t);try{(bi=require("@emotion/is-prop-valid").default)&&(vi=t=>t.startsWith("on")?!yi(t):bi(t))}catch(XC){}var bi;function xi(t,e,n){return"string"===typeof t?t:oi.transform(e+n*t)}const _i={offset:"stroke-dashoffset",array:"stroke-dasharray"},wi={offset:"strokeDashoffset",array:"strokeDasharray"};function Si(t,e,n,r,i){let{attrX:o,attrY:a,attrScale:s,originX:l,originY:c,pathLength:u,pathSpacing:h=1,pathOffset:d=0,...p}=e;if(hi(t,p,n,i),r)return void(t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox));t.attrs=t.style,t.style={};const{attrs:f,style:m,dimensions:g}=t;f.transform&&(g&&(m.transform=f.transform),delete f.transform),g&&(void 0!==l||void 0!==c||m.transform)&&(m.transformOrigin=function(t,e,n){const r=xi(e,t.x,t.width),i=xi(n,t.y,t.height);return"".concat(r," ").concat(i)}(g,void 0!==l?l:.5,void 0!==c?c:.5)),void 0!==o&&(f.x=o),void 0!==a&&(f.y=a),void 0!==s&&(f.scale=s),void 0!==u&&function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];t.pathLength=1;const o=i?_i:wi;t[o.offset]=oi.transform(-r);const a=oi.transform(e),s=oi.transform(n);t[o.array]="".concat(a," ").concat(s)}(f,u,h,d,!1)}const Ti=()=>({...di(),attrs:{}}),Ei=t=>"string"===typeof t&&"svg"===t.toLowerCase();function Mi(t,e,n,r){const i=(0,k.useMemo)((()=>{const n=Ti();return Si(n,e,{enableHardwareAcceleration:!1},Ei(r),t.transformTemplate),{...n.attrs,style:{...n.style}}}),[e]);if(t.style){const e={};pi(e,t.style,t),i.style={...e,...i.style}}return i}function Ci(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(e,n,r,i,o)=>{let{latestValues:a}=i;const s=(Nr(e)?Mi:mi)(n,a,o,e),l=function(t,e,n){const r={};for(const i in t)"values"===i&&"object"===typeof t.values||(vi(i)||!0===n&&yi(i)||!e&&!yi(i)||t.draggable&&i.startsWith("onDrag"))&&(r[i]=t[i]);return r}(n,"string"===typeof e,t),c=e!==k.Fragment?{...l,...s,ref:r}:{},{children:u}=n,h=(0,k.useMemo)((()=>Ur(u)?u.get():u),[u]);return(0,k.createElement)(e,{...c,children:h})}}function Ai(t,e,n,r){let{style:i,vars:o}=e;Object.assign(t.style,i,r&&r.getProjectionStyles(n));for(const a in o)t.style.setProperty(a,o[a])}const ki=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function Ii(t,e,n,r){Ai(t,e,void 0,r);for(const i in e.attrs)t.setAttribute(ki.has(i)?i:er(i),e.attrs[i])}function Ri(t,e,n){var r;const{style:i}=t,o={};for(const a in i)(Ur(i[a])||e.style&&Ur(e.style[a])||Fr(a,t)||void 0!==(null===(r=null===n||void 0===n?void 0:n.getValue(a))||void 0===r?void 0:r.liveStyle))&&(o[a]=i[a]);return o}function Pi(t,e,n){const r=Ri(t,e,n);for(const i in t)if(Ur(t[i])||Ur(e[i])){r[-1!==Dr.indexOf(i)?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i]=t[i]}return r}function Ni(t){const e=[{},{}];return null===t||void 0===t||t.values.forEach(((t,n)=>{e[0][n]=t.get(),e[1][n]=t.getVelocity()})),e}function Oi(t,e,n,r){if("function"===typeof e){const[i,o]=Ni(r);e=e(void 0!==n?n:t.custom,i,o)}if("string"===typeof e&&(e=t.variants&&t.variants[e]),"function"===typeof e){const[i,o]=Ni(r);e=e(void 0!==n?n:t.custom,i,o)}return e}const Di=t=>Array.isArray(t),Li=t=>Boolean(t&&"object"===typeof t&&t.mix&&t.toValue),Fi=t=>Di(t)?t[t.length-1]||0:t;function Ui(t){const e=Ur(t)?t.get():t;return Li(e)?e.toValue():e}const Bi=t=>(e,n)=>{const r=(0,k.useContext)(Zn),i=(0,k.useContext)(Jn),o=()=>function(t,e,n,r){let{scrapeMotionValuesFromProps:i,createRenderState:o,onMount:a}=t;const s={latestValues:zi(e,n,r,i),renderState:o()};return a&&(s.mount=t=>a(e,t,s)),s}(t,e,r,i);return n?o():function(t){const e=(0,k.useRef)(null);return null===e.current&&(e.current=t()),e.current}(o)};function zi(t,e,n,r){const i={},o=r(t,{});for(const d in o)i[d]=Ui(o[d]);let{initial:a,animate:s}=t;const l=_r(t),c=wr(t);e&&c&&!l&&!1!==t.inherit&&(void 0===a&&(a=e.initial),void 0===s&&(s=e.animate));let u=!!n&&!1===n.initial;u=u||!1===a;const h=u?s:a;if(h&&"boolean"!==typeof h&&!vr(h)){(Array.isArray(h)?h:[h]).forEach((e=>{const n=Oi(t,e);if(!n)return;const{transitionEnd:r,transition:o,...a}=n;for(const t in a){let e=a[t];if(Array.isArray(e)){e=e[u?e.length-1:0]}null!==e&&(i[t]=e)}for(const t in r)i[t]=r[t]}))}return i}const ji=t=>t,{schedule:Vi,cancel:Wi,state:Gi,steps:Hi}=sr("undefined"!==typeof requestAnimationFrame?requestAnimationFrame:ji,!0),qi={useVisualState:Bi({scrapeMotionValuesFromProps:Pi,createRenderState:Ti,onMount:(t,e,n)=>{let{renderState:r,latestValues:i}=n;Vi.read((()=>{try{r.dimensions="function"===typeof e.getBBox?e.getBBox():e.getBoundingClientRect()}catch($7){r.dimensions={x:0,y:0,width:0,height:0}}})),Vi.render((()=>{Si(r,i,{enableHardwareAcceleration:!1},Ei(e.tagName),t.transformTemplate),Ii(e,r)}))}})},Xi={useVisualState:Bi({scrapeMotionValuesFromProps:Ri,createRenderState:di})};function Yi(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{passive:!0};return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n)}const Ki=t=>"mouse"===t.pointerType?"number"!==typeof t.button||t.button<=0:!1!==t.isPrimary;function Zi(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"page";return{point:{x:t["".concat(e,"X")],y:t["".concat(e,"Y")]}}}const Ji=t=>e=>Ki(e)&&t(e,Zi(e));function Qi(t,e,n,r){return Yi(t,e,Ji(n),r)}const $i=(t,e)=>n=>e(t(n)),to=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.reduce($i)};function eo(t){let e=null;return()=>{const n=()=>{e=null};return null===e&&(e=t,n)}}const no=eo("dragHorizontal"),ro=eo("dragVertical");function io(t){let e=!1;if("y"===t)e=ro();else if("x"===t)e=no();else{const t=no(),n=ro();t&&n?e=()=>{t(),n()}:(t&&t(),n&&n())}return e}function oo(){const t=io(!0);return!t||(t(),!1)}class ao{constructor(t){this.isMounted=!1,this.node=t}update(){}}function so(t,e){const n=e?"pointerenter":"pointerleave",r=e?"onHoverStart":"onHoverEnd";return Qi(t.current,n,((n,i)=>{if("touch"===n.pointerType||oo())return;const o=t.getProps();t.animationState&&o.whileHover&&t.animationState.setActive("whileHover",e);const a=o[r];a&&Vi.postRender((()=>a(n,i)))}),{passive:!t.getProps()[r]})}const lo=(t,e)=>!!e&&(t===e||lo(t,e.parentElement));function co(t,e){if(!e)return;const n=new PointerEvent("pointer"+t);e(n,Zi(n))}const uo=new WeakMap,ho=new WeakMap,po=t=>{const e=uo.get(t.target);e&&e(t)},fo=t=>{t.forEach(po)};function mo(t,e,n){const r=function(t){let{root:e,...n}=t;const r=e||document;ho.has(r)||ho.set(r,{});const i=ho.get(r),o=JSON.stringify(n);return i[o]||(i[o]=new IntersectionObserver(fo,{root:e,...n})),i[o]}(e);return uo.set(t,n),r.observe(t),()=>{uo.delete(t),r.unobserve(t)}}const go={some:0,all:1};const yo={inView:{Feature:class extends ao{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:e,margin:n,amount:r="some",once:i}=t,o={root:e?e.current:void 0,rootMargin:n,threshold:"number"===typeof r?r:go[r]};return mo(this.node.current,o,(t=>{const{isIntersecting:e}=t;if(this.isInView===e)return;if(this.isInView=e,i&&!e&&this.hasEnteredView)return;e&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",e);const{onViewportEnter:n,onViewportLeave:r}=this.node.getProps(),o=e?n:r;o&&o(t)}))}mount(){this.startObserver()}update(){if("undefined"===typeof IntersectionObserver)return;const{props:t,prevProps:e}=this.node,n=["amount","margin","root"].some(function(t){let{viewport:e={}}=t,{viewport:n={}}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t=>e[t]!==n[t]}(t,e));n&&this.startObserver()}unmount(){}}},tap:{Feature:class extends ao{constructor(){super(...arguments),this.removeStartListeners=ji,this.removeEndListeners=ji,this.removeAccessibleListeners=ji,this.startPointerPress=(t,e)=>{if(this.isPressing)return;this.removeEndListeners();const n=this.node.getProps(),r=Qi(window,"pointerup",((t,e)=>{if(!this.checkPressEnd())return;const{onTap:n,onTapCancel:r,globalTapTarget:i}=this.node.getProps(),o=i||lo(this.node.current,t.target)?n:r;o&&Vi.update((()=>o(t,e)))}),{passive:!(n.onTap||n.onPointerUp)}),i=Qi(window,"pointercancel",((t,e)=>this.cancelPress(t,e)),{passive:!(n.onTapCancel||n.onPointerCancel)});this.removeEndListeners=to(r,i),this.startPress(t,e)},this.startAccessiblePress=()=>{const t=Yi(this.node.current,"keydown",(t=>{if("Enter"!==t.key||this.isPressing)return;this.removeEndListeners(),this.removeEndListeners=Yi(this.node.current,"keyup",(t=>{"Enter"===t.key&&this.checkPressEnd()&&co("up",((t,e)=>{const{onTap:n}=this.node.getProps();n&&Vi.postRender((()=>n(t,e)))}))})),co("down",((t,e)=>{this.startPress(t,e)}))})),e=Yi(this.node.current,"blur",(()=>{this.isPressing&&co("cancel",((t,e)=>this.cancelPress(t,e)))}));this.removeAccessibleListeners=to(t,e)}}startPress(t,e){this.isPressing=!0;const{onTapStart:n,whileTap:r}=this.node.getProps();r&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),n&&Vi.postRender((()=>n(t,e)))}checkPressEnd(){this.removeEndListeners(),this.isPressing=!1;return this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!oo()}cancelPress(t,e){if(!this.checkPressEnd())return;const{onTapCancel:n}=this.node.getProps();n&&Vi.postRender((()=>n(t,e)))}mount(){const t=this.node.getProps(),e=Qi(t.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(t.onTapStart||t.onPointerStart)}),n=Yi(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=to(e,n)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}},focus:{Feature:class extends ao{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch($7){t=!0}t&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){this.isActive&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=to(Yi(this.node.current,"focus",(()=>this.onFocus())),Yi(this.node.current,"blur",(()=>this.onBlur())))}unmount(){}}},hover:{Feature:class extends ao{mount(){this.unmount=to(so(this.node,!0),so(this.node,!1))}unmount(){}}}};function vo(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}function bo(t,e,n){const r=t.getProps();return Oi(r,e,void 0!==n?n:r.custom,t)}const xo=t=>1e3*t,_o=t=>t/1e3,wo={type:"spring",stiffness:500,damping:25,restSpeed:10},So={type:"keyframes",duration:.8},To={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Eo=(t,e)=>{let{keyframes:n}=e;return n.length>2?So:Lr.has(t)?t.startsWith("scale")?{type:"spring",stiffness:550,damping:0===n[1]?2*Math.sqrt(550):30,restSpeed:10}:wo:To};function Mo(t,e){return t[e]||t.default||t}const Co=!1,Ao=t=>null!==t;function ko(t,e,n){let{repeat:r,repeatType:i="loop"}=e;const o=t.filter(Ao),a=r&&"loop"!==i&&r%2===1?0:o.length-1;return a&&void 0!==n?n:o[a]}let Io;function Ro(){Io=void 0}const Po={now:()=>(void 0===Io&&Po.set(Gi.isProcessing||ir?Gi.timestamp:performance.now()),Io),set:t=>{Io=t,queueMicrotask(Ro)}},No=t=>/^0[^.\s]+$/u.test(t);function Oo(t){return"number"===typeof t?0===t:null===t||("none"===t||"0"===t||No(t))}let Do=ji,Lo=ji;const Fo=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t),Uo=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Bo(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;Lo(n<=4,'Max CSS variable fallback depth detected in property "'.concat(t,'". This may indicate a circular fallback dependency.'));const[r,i]=function(t){const e=Uo.exec(t);if(!e)return[,];const[,n,r,i]=e;return["--".concat(null!==n&&void 0!==n?n:r),i]}(t);if(!r)return;const o=window.getComputedStyle(e).getPropertyValue(r);if(o){const t=o.trim();return Fo(t)?parseFloat(t):t}return Gr(i)?Bo(i,e,n+1):i}const zo=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),jo=t=>t===Yr||t===oi,Vo=(t,e)=>parseFloat(t.split(", ")[e]),Wo=(t,e)=>(n,r)=>{let{transform:i}=r;if("none"===i||!i)return 0;const o=i.match(/^matrix3d\((.+)\)$/u);if(o)return Vo(o[1],e);{const e=i.match(/^matrix\((.+)\)$/u);return e?Vo(e[1],t):0}},Go=new Set(["x","y","z"]),Ho=Dr.filter((t=>!Go.has(t)));const qo={width:(t,e)=>{let{x:n}=t,{paddingLeft:r="0",paddingRight:i="0"}=e;return n.max-n.min-parseFloat(r)-parseFloat(i)},height:(t,e)=>{let{y:n}=t,{paddingTop:r="0",paddingBottom:i="0"}=e;return n.max-n.min-parseFloat(r)-parseFloat(i)},top:(t,e)=>{let{top:n}=e;return parseFloat(n)},left:(t,e)=>{let{left:n}=e;return parseFloat(n)},bottom:(t,e)=>{let{y:n}=t,{top:r}=e;return parseFloat(r)+(n.max-n.min)},right:(t,e)=>{let{x:n}=t,{left:r}=e;return parseFloat(r)+(n.max-n.min)},x:Wo(4,13),y:Wo(5,14)};qo.translateX=qo.x,qo.translateY=qo.y;const Xo=t=>e=>e.test(t),Yo=[Yr,oi,ii,ri,si,ai,{test:t=>"auto"===t,parse:t=>t}],Ko=t=>Yo.find(Xo(t)),Zo=new Set;let Jo=!1,Qo=!1;function $o(){if(Qo){const t=Array.from(Zo).filter((t=>t.needsMeasurement)),e=new Set(t.map((t=>t.element))),n=new Map;e.forEach((t=>{const e=function(t){const e=[];return Ho.forEach((n=>{const r=t.getValue(n);void 0!==r&&(e.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))})),e}(t);e.length&&(n.set(t,e),t.render())})),t.forEach((t=>t.measureInitialState())),e.forEach((t=>{t.render();const e=n.get(t);e&&e.forEach((e=>{let[n,r]=e;var i;null===(i=t.getValue(n))||void 0===i||i.set(r)}))})),t.forEach((t=>t.measureEndState())),t.forEach((t=>{void 0!==t.suspendedScrollY&&window.scrollTo(0,t.suspendedScrollY)}))}Qo=!1,Jo=!1,Zo.forEach((t=>t.complete())),Zo.clear()}function ta(){Zo.forEach((t=>{t.readKeyframes(),t.needsMeasurement&&(Qo=!0)}))}class ea{constructor(t,e,n,r,i){let o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...t],this.onComplete=e,this.name=n,this.motionValue=r,this.element=i,this.isAsync=o}scheduleResolve(){this.isScheduled=!0,this.isAsync?(Zo.add(this),Jo||(Jo=!0,Vi.read(ta),Vi.resolveKeyframes($o))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:e,element:n,motionValue:r}=this;for(let i=0;i<t.length;i++)if(null===t[i])if(0===i){const i=null===r||void 0===r?void 0:r.get(),o=t[t.length-1];if(void 0!==i)t[0]=i;else if(n&&e){const r=n.readValue(e,o);void 0!==r&&null!==r&&(t[0]=r)}void 0===t[0]&&(t[0]=o),r&&void 0===i&&r.set(t[0])}else t[i]=t[i-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),Zo.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,Zo.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const na=(t,e)=>n=>Boolean(ei(n)&&ti.test(n)&&n.startsWith(t)||e&&Object.prototype.hasOwnProperty.call(n,e)),ra=(t,e,n)=>r=>{if(!ei(r))return r;const[i,o,a,s]=r.match(Qr);return{[t]:parseFloat(i),[e]:parseFloat(o),[n]:parseFloat(a),alpha:void 0!==s?parseFloat(s):1}},ia={...Yr,transform:t=>Math.round((t=>Xr(0,255,t))(t))},oa={test:na("rgb","red"),parse:ra("red","green","blue"),transform:t=>{let{red:e,green:n,blue:r,alpha:i=1}=t;return"rgba("+ia.transform(e)+", "+ia.transform(n)+", "+ia.transform(r)+", "+Jr(Kr.transform(i))+")"}};const aa={test:na("#"),parse:function(t){let e="",n="",r="",i="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),r=t.substring(5,7),i=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),r=t.substring(3,4),i=t.substring(4,5),e+=e,n+=n,r+=r,i+=i),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}},transform:oa.transform},sa={test:na("hsl","hue"),parse:ra("hue","saturation","lightness"),transform:t=>{let{hue:e,saturation:n,lightness:r,alpha:i=1}=t;return"hsla("+Math.round(e)+", "+ii.transform(Jr(n))+", "+ii.transform(Jr(r))+", "+Jr(Kr.transform(i))+")"}},la={test:t=>oa.test(t)||aa.test(t)||sa.test(t),parse:t=>oa.test(t)?oa.parse(t):sa.test(t)?sa.parse(t):aa.parse(t),transform:t=>ei(t)?t:t.hasOwnProperty("red")?oa.transform(t):sa.transform(t)};const ca="number",ua="color",ha="var",da="var(",pa="${}",fa=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function ma(t){const e=t.toString(),n=[],r={color:[],number:[],var:[]},i=[];let o=0;const a=e.replace(fa,(t=>(la.test(t)?(r.color.push(o),i.push(ua),n.push(la.parse(t))):t.startsWith(da)?(r.var.push(o),i.push(ha),n.push(t)):(r.number.push(o),i.push(ca),n.push(parseFloat(t))),++o,pa))).split(pa);return{values:n,split:a,indexes:r,types:i}}function ga(t){return ma(t).values}function ya(t){const{split:e,types:n}=ma(t),r=e.length;return t=>{let i="";for(let o=0;o<r;o++)if(i+=e[o],void 0!==t[o]){const e=n[o];i+=e===ca?Jr(t[o]):e===ua?la.transform(t[o]):t[o]}return i}}const va=t=>"number"===typeof t?0:t;const ba={test:function(t){var e,n;return isNaN(t)&&ei(t)&&((null===(e=t.match(Qr))||void 0===e?void 0:e.length)||0)+((null===(n=t.match($r))||void 0===n?void 0:n.length)||0)>0},parse:ga,createTransformer:ya,getAnimatableNone:function(t){const e=ga(t);return ya(t)(e.map(va))}},xa=new Set(["brightness","contrast","saturate","opacity"]);function _a(t){const[e,n]=t.slice(0,-1).split("(");if("drop-shadow"===e)return t;const[r]=n.match(Qr)||[];if(!r)return t;const i=n.replace(r,"");let o=xa.has(e)?1:0;return r!==n&&(o*=100),e+"("+o+i+")"}const wa=/\b([a-z-]*)\(.*?\)/gu,Sa={...ba,getAnimatableNone:t=>{const e=t.match(wa);return e?e.map(_a).join(" "):t}},Ta={...ui,color:la,backgroundColor:la,outlineColor:la,fill:la,stroke:la,borderColor:la,borderTopColor:la,borderRightColor:la,borderBottomColor:la,borderLeftColor:la,filter:Sa,WebkitFilter:Sa},Ea=t=>Ta[t];function Ma(t,e){let n=Ea(t);return n!==Sa&&(n=ba),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const Ca=new Set(["auto","none","0"]);class Aa extends ea{constructor(t,e,n,r){super(t,e,n,r,null===r||void 0===r?void 0:r.owner,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:e,name:n}=this;if(!e.current)return;super.readKeyframes();for(let s=0;s<t.length;s++){let n=t[s];if("string"===typeof n&&(n=n.trim(),Gr(n))){const r=Bo(n,e.current);void 0!==r&&(t[s]=r),s===t.length-1&&(this.finalKeyframe=n)}}if(this.resolveNoneKeyframes(),!zo.has(n)||2!==t.length)return;const[r,i]=t,o=Ko(r),a=Ko(i);if(o!==a)if(jo(o)&&jo(a))for(let s=0;s<t.length;s++){const e=t[s];"string"===typeof e&&(t[s]=parseFloat(e))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:e}=this,n=[];for(let r=0;r<t.length;r++)Oo(t[r])&&n.push(r);n.length&&function(t,e,n){let r,i=0;for(;i<t.length&&!r;){const e=t[i];"string"===typeof e&&!Ca.has(e)&&ma(e).values.length&&(r=t[i]),i++}if(r&&n)for(const o of e)t[o]=Ma(n,r)}(t,n,e)}measureInitialState(){const{element:t,unresolvedKeyframes:e,name:n}=this;if(!t.current)return;"height"===n&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=qo[n](t.measureViewportBox(),window.getComputedStyle(t.current)),e[0]=this.measuredOrigin;const r=e[e.length-1];void 0!==r&&t.getValue(n,r).jump(r,!1)}measureEndState(){var t;const{element:e,name:n,unresolvedKeyframes:r}=this;if(!e.current)return;const i=e.getValue(n);i&&i.jump(this.measuredOrigin,!1);const o=r.length-1,a=r[o];r[o]=qo[n](e.measureViewportBox(),window.getComputedStyle(e.current)),null!==a&&void 0===this.finalKeyframe&&(this.finalKeyframe=a),(null===(t=this.removedTransforms)||void 0===t?void 0:t.length)&&this.removedTransforms.forEach((t=>{let[n,r]=t;e.getValue(n).set(r)})),this.resolveNoneKeyframes()}}function ka(t){let e;return()=>(void 0===e&&(e=t()),e)}const Ia=(t,e)=>"zIndex"!==e&&(!("number"!==typeof t&&!Array.isArray(t))||!("string"!==typeof t||!ba.test(t)&&"0"!==t||t.startsWith("url(")));class Ra{constructor(t){let{autoplay:e=!0,delay:n=0,type:r="keyframes",repeat:i=0,repeatDelay:o=0,repeatType:a="loop",...s}=t;this.isStopped=!1,this.hasAttemptedResolve=!1,this.options={autoplay:e,delay:n,type:r,repeat:i,repeatDelay:o,repeatType:a,...s},this.updateFinishedPromise()}get resolved(){return this._resolved||this.hasAttemptedResolve||(ta(),$o()),this._resolved}onKeyframesResolved(t,e){this.hasAttemptedResolve=!0;const{name:n,type:r,velocity:i,delay:o,onComplete:a,onUpdate:s,isGenerator:l}=this.options;if(!l&&!function(t,e,n,r){const i=t[0];if(null===i)return!1;if("display"===e||"visibility"===e)return!0;const o=t[t.length-1],a=Ia(i,e),s=Ia(o,e);return Do(a===s,"You are trying to animate ".concat(e,' from "').concat(i,'" to "').concat(o,'". ').concat(i," is not an animatable value - to enable this animation set ").concat(i," to a value animatable to ").concat(o," via the `style` property.")),!(!a||!s)&&(function(t){const e=t[0];if(1===t.length)return!0;for(let n=0;n<t.length;n++)if(t[n]!==e)return!0}(t)||"spring"===n&&r)}(t,n,r,i)){if(Co||!o)return null===s||void 0===s||s(ko(t,this.options,e)),null===a||void 0===a||a(),void this.resolveFinishedPromise();this.options.duration=0}const c=this.initPlayback(t,e);!1!==c&&(this._resolved={keyframes:t,finalKeyframe:e,...c},this.onPostResolved())}onPostResolved(){}then(t,e){return this.currentFinishedPromise.then(t,e)}updateFinishedPromise(){this.currentFinishedPromise=new Promise((t=>{this.resolveFinishedPromise=t}))}}function Pa(t,e){return e?t*(1e3/e):0}const Na=5;function Oa(t,e,n){const r=Math.max(e-Na,0);return Pa(n-t(r),e-r)}const Da=.001,La=.01,Fa=10,Ua=.05,Ba=1;function za(t){let e,n,{duration:r=800,bounce:i=.25,velocity:o=0,mass:a=1}=t;Do(r<=xo(Fa),"Spring duration must be 10 seconds or less");let s=1-i;s=Xr(Ua,Ba,s),r=Xr(La,Fa,_o(r)),s<1?(e=t=>{const e=t*s,n=e*r,i=e-o,a=Va(t,s),l=Math.exp(-n);return Da-i/a*l},n=t=>{const n=t*s*r,i=n*o+o,a=Math.pow(s,2)*Math.pow(t,2)*r,l=Math.exp(-n),c=Va(Math.pow(t,2),s);return(-e(t)+Da>0?-1:1)*((i-a)*l)/c}):(e=t=>Math.exp(-t*r)*((t-o)*r+1)-Da,n=t=>Math.exp(-t*r)*(r*r*(o-t)));const l=function(t,e,n){let r=n;for(let i=1;i<ja;i++)r-=t(r)/e(r);return r}(e,n,5/r);if(r=xo(r),isNaN(l))return{stiffness:100,damping:10,duration:r};{const t=Math.pow(l,2)*a;return{stiffness:t,damping:2*s*Math.sqrt(a*t),duration:r}}}const ja=12;function Va(t,e){return t*Math.sqrt(1-e*e)}const Wa=["duration","bounce"],Ga=["stiffness","damping","mass"];function Ha(t,e){return e.some((e=>void 0!==t[e]))}function qa(t){let{keyframes:e,restDelta:n,restSpeed:r,...i}=t;const o=e[0],a=e[e.length-1],s={done:!1,value:o},{stiffness:l,damping:c,mass:u,duration:h,velocity:d,isResolvedFromDuration:p}=function(t){let e={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...t};if(!Ha(t,Ga)&&Ha(t,Wa)){const n=za(t);e={...e,...n,mass:1},e.isResolvedFromDuration=!0}return e}({...i,velocity:-_o(i.velocity||0)}),f=d||0,m=c/(2*Math.sqrt(l*u)),g=a-o,y=_o(Math.sqrt(l/u)),v=Math.abs(g)<5;let b;if(r||(r=v?.01:2),n||(n=v?.005:.5),m<1){const t=Va(y,m);b=e=>{const n=Math.exp(-m*y*e);return a-n*((f+m*y*g)/t*Math.sin(t*e)+g*Math.cos(t*e))}}else if(1===m)b=t=>a-Math.exp(-y*t)*(g+(f+y*g)*t);else{const t=y*Math.sqrt(m*m-1);b=e=>{const n=Math.exp(-m*y*e),r=Math.min(t*e,300);return a-n*((f+m*y*g)*Math.sinh(r)+t*g*Math.cosh(r))/t}}return{calculatedDuration:p&&h||null,next:t=>{const e=b(t);if(p)s.done=t>=h;else{let i=f;0!==t&&(i=m<1?Oa(b,t,e):0);const o=Math.abs(i)<=r,l=Math.abs(a-e)<=n;s.done=o&&l}return s.value=s.done?a:e,s}}}function Xa(t){let{keyframes:e,velocity:n=0,power:r=.8,timeConstant:i=325,bounceDamping:o=10,bounceStiffness:a=500,modifyTarget:s,min:l,max:c,restDelta:u=.5,restSpeed:h}=t;const d=e[0],p={done:!1,value:d},f=t=>void 0===l?c:void 0===c||Math.abs(l-t)<Math.abs(c-t)?l:c;let m=r*n;const g=d+m,y=void 0===s?g:s(g);y!==g&&(m=y-d);const v=t=>-m*Math.exp(-t/i),b=t=>y+v(t),x=t=>{const e=v(t),n=b(t);p.done=Math.abs(e)<=u,p.value=p.done?y:n};let _,w;const S=t=>{(t=>void 0!==l&&t<l||void 0!==c&&t>c)(p.value)&&(_=t,w=qa({keyframes:[p.value,f(p.value)],velocity:Oa(b,t,p.value),damping:o,stiffness:a,restDelta:u,restSpeed:h}))};return S(0),{calculatedDuration:null,next:t=>{let e=!1;return w||void 0!==_||(e=!0,x(t),S(t)),void 0!==_&&t>=_?w.next(t-_):(!e&&x(t),p)}}}const Ya=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,Ka=1e-7,Za=12;function Ja(t,e,n,r){if(t===e&&n===r)return ji;const i=e=>function(t,e,n,r,i){let o,a,s=0;do{a=e+(n-e)/2,o=Ya(a,r,i)-t,o>0?n=a:e=a}while(Math.abs(o)>Ka&&++s<Za);return a}(e,0,1,t,n);return t=>0===t||1===t?t:Ya(i(t),e,r)}const Qa=Ja(.42,0,1,1),$a=Ja(0,0,.58,1),ts=Ja(.42,0,.58,1),es=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,ns=t=>e=>1-t(1-e),rs=t=>1-Math.sin(Math.acos(t)),is=ns(rs),os=es(rs),as=Ja(.33,1.53,.69,.99),ss=ns(as),ls=es(ss),cs={linear:ji,easeIn:Qa,easeInOut:ts,easeOut:$a,circIn:rs,circInOut:os,circOut:is,backIn:ss,backInOut:ls,backOut:as,anticipate:t=>(t*=2)<1?.5*ss(t):.5*(2-Math.pow(2,-10*(t-1)))},us=t=>{if(Array.isArray(t)){Lo(4===t.length,"Cubic bezier arrays must contain four numerical values.");const[e,n,r,i]=t;return Ja(e,n,r,i)}return"string"===typeof t?(Lo(void 0!==cs[t],"Invalid easing type '".concat(t,"'")),cs[t]):t},hs=(t,e,n)=>{const r=e-t;return 0===r?1:(n-t)/r},ds=(t,e,n)=>t+(e-t)*n;function ps(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function fs(t,e){return n=>n>0?e:t}const ms=(t,e,n)=>{const r=t*t,i=n*(e*e-r)+r;return i<0?0:Math.sqrt(i)},gs=[aa,oa,sa];function ys(t){const e=(t=>gs.find((e=>e.test(t))))(t);if(Do(Boolean(e),"'".concat(t,"' is not an animatable color. Use the equivalent color code instead.")),!Boolean(e))return!1;let n=e.parse(t);return e===sa&&(n=function(t){let{hue:e,saturation:n,lightness:r,alpha:i}=t;e/=360,n/=100,r/=100;let o=0,a=0,s=0;if(n){const t=r<.5?r*(1+n):r+n-r*n,i=2*r-t;o=ps(i,t,e+1/3),a=ps(i,t,e),s=ps(i,t,e-1/3)}else o=a=s=r;return{red:Math.round(255*o),green:Math.round(255*a),blue:Math.round(255*s),alpha:i}}(n)),n}const vs=(t,e)=>{const n=ys(t),r=ys(e);if(!n||!r)return fs(t,e);const i={...n};return t=>(i.red=ms(n.red,r.red,t),i.green=ms(n.green,r.green,t),i.blue=ms(n.blue,r.blue,t),i.alpha=ds(n.alpha,r.alpha,t),oa.transform(i))},bs=new Set(["none","hidden"]);function xs(t,e){return n=>ds(t,e,n)}function _s(t){return"number"===typeof t?xs:"string"===typeof t?Gr(t)?fs:la.test(t)?vs:Ts:Array.isArray(t)?ws:"object"===typeof t?la.test(t)?vs:Ss:fs}function ws(t,e){const n=[...t],r=n.length,i=t.map(((t,n)=>_s(t)(t,e[n])));return t=>{for(let e=0;e<r;e++)n[e]=i[e](t);return n}}function Ss(t,e){const n={...t,...e},r={};for(const i in n)void 0!==t[i]&&void 0!==e[i]&&(r[i]=_s(t[i])(t[i],e[i]));return t=>{for(const e in r)n[e]=r[e](t);return n}}const Ts=(t,e)=>{const n=ba.createTransformer(e),r=ma(t),i=ma(e);return r.indexes.var.length===i.indexes.var.length&&r.indexes.color.length===i.indexes.color.length&&r.indexes.number.length>=i.indexes.number.length?bs.has(t)&&!i.values.length||bs.has(e)&&!r.values.length?function(t,e){return bs.has(t)?n=>n<=0?t:e:n=>n>=1?e:t}(t,e):to(ws(function(t,e){var n;const r=[],i={color:0,var:0,number:0};for(let o=0;o<e.values.length;o++){const a=e.types[o],s=t.indexes[a][i[a]],l=null!==(n=t.values[s])&&void 0!==n?n:0;r[o]=l,i[a]++}return r}(r,i),i.values),n):(Do(!0,"Complex values '".concat(t,"' and '").concat(e,"' too different to mix. Ensure all colors are of the same type, and that each contains the same quantity of number and color values. Falling back to instant transition.")),fs(t,e))};function Es(t,e,n){if("number"===typeof t&&"number"===typeof e&&"number"===typeof n)return ds(t,e,n);return _s(t)(t,e)}function Ms(t,e){let{clamp:n=!0,ease:r,mixer:i}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=t.length;if(Lo(o===e.length,"Both input and output ranges must be the same length"),1===o)return()=>e[0];if(2===o&&t[0]===t[1])return()=>e[1];t[0]>t[o-1]&&(t=[...t].reverse(),e=[...e].reverse());const a=function(t,e,n){const r=[],i=n||Es,o=t.length-1;for(let a=0;a<o;a++){let n=i(t[a],t[a+1]);if(e){const t=Array.isArray(e)?e[a]||ji:e;n=to(t,n)}r.push(n)}return r}(e,r,i),s=a.length,l=e=>{let n=0;if(s>1)for(;n<t.length-2&&!(e<t[n+1]);n++);const r=hs(t[n],t[n+1],e);return a[n](r)};return n?e=>l(Xr(t[0],t[o-1],e)):l}function Cs(t){const e=[0];return function(t,e){const n=t[t.length-1];for(let r=1;r<=e;r++){const i=hs(0,e,r);t.push(ds(n,1,i))}}(e,t.length-1),e}function As(t){let{duration:e=300,keyframes:n,times:r,ease:i="easeInOut"}=t;const o=(t=>Array.isArray(t)&&"number"!==typeof t[0])(i)?i.map(us):us(i),a={done:!1,value:n[0]},s=function(t,e){return t.map((t=>t*e))}(r&&r.length===n.length?r:Cs(n),e),l=Ms(s,n,{ease:Array.isArray(o)?o:(c=n,u=o,c.map((()=>u||ts)).splice(0,c.length-1))});var c,u;return{calculatedDuration:e,next:t=>(a.value=l(t),a.done=t>=e,a)}}const ks=t=>{const e=e=>{let{timestamp:n}=e;return t(n)};return{start:()=>Vi.update(e,!0),stop:()=>Wi(e),now:()=>Gi.isProcessing?Gi.timestamp:Po.now()}},Is={decay:Xa,inertia:Xa,tween:As,keyframes:As,spring:qa},Rs=t=>t/100;class Ps extends Ra{constructor(t){let{KeyframeResolver:e=ea,...n}=t;super(n),this.holdTime=null,this.startTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,"idle"===this.state)return;this.teardown();const{onStop:t}=this.options;t&&t()};const{name:r,motionValue:i,keyframes:o}=this.options,a=(t,e)=>this.onKeyframesResolved(t,e);r&&i&&i.owner?this.resolver=i.owner.resolveKeyframes(o,a,r,i):this.resolver=new e(o,a,r,i),this.resolver.scheduleResolve()}initPlayback(t){const{type:e="keyframes",repeat:n=0,repeatDelay:r=0,repeatType:i,velocity:o=0}=this.options,a=Is[e]||As;let s,l;a!==As&&"number"!==typeof t[0]&&(s=to(Rs,Es(t[0],t[1])),t=[0,100]);const c=a({...this.options,keyframes:t});"mirror"===i&&(l=a({...this.options,keyframes:[...t].reverse(),velocity:-o})),null===c.calculatedDuration&&(c.calculatedDuration=function(t){let e=0,n=t.next(e);for(;!n.done&&e<2e4;)e+=50,n=t.next(e);return e>=2e4?1/0:e}(c));const{calculatedDuration:u}=c,h=u+r;return{generator:c,mirroredGenerator:l,mapPercentToKeyframes:s,calculatedDuration:u,resolvedDuration:h,totalDuration:h*(n+1)-r}}onPostResolved(){const{autoplay:t=!0}=this.options;this.play(),"paused"!==this.pendingPlayState&&t?this.state=this.pendingPlayState:this.pause()}tick(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{resolved:n}=this;if(!n){const{keyframes:t}=this.options;return{done:!0,value:t[t.length-1]}}const{finalKeyframe:r,generator:i,mirroredGenerator:o,mapPercentToKeyframes:a,keyframes:s,calculatedDuration:l,totalDuration:c,resolvedDuration:u}=n;if(null===this.startTime)return i.next(0);const{delay:h,repeat:d,repeatType:p,repeatDelay:f,onUpdate:m}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-c/this.speed,this.startTime)),e?this.currentTime=t:null!==this.holdTime?this.currentTime=this.holdTime:this.currentTime=Math.round(t-this.startTime)*this.speed;const g=this.currentTime-h*(this.speed>=0?1:-1),y=this.speed>=0?g<0:g>c;this.currentTime=Math.max(g,0),"finished"===this.state&&null===this.holdTime&&(this.currentTime=c);let v=this.currentTime,b=i;if(d){const t=Math.min(this.currentTime,c)/u;let e=Math.floor(t),n=t%1;!n&&t>=1&&(n=1),1===n&&e--,e=Math.min(e,d+1);Boolean(e%2)&&("reverse"===p?(n=1-n,f&&(n-=f/u)):"mirror"===p&&(b=o)),v=Xr(0,1,n)*u}const x=y?{done:!1,value:s[0]}:b.next(v);a&&(x.value=a(x.value));let{done:_}=x;y||null===l||(_=this.speed>=0?this.currentTime>=c:this.currentTime<=0);const w=null===this.holdTime&&("finished"===this.state||"running"===this.state&&_);return w&&void 0!==r&&(x.value=ko(s,this.options,r)),m&&m(x.value),w&&this.finish(),x}get duration(){const{resolved:t}=this;return t?_o(t.calculatedDuration):0}get time(){return _o(this.currentTime)}set time(t){t=xo(t),this.currentTime=t,null!==this.holdTime||0===this.speed?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.speed)}get speed(){return this.playbackSpeed}set speed(t){const e=this.playbackSpeed!==t;this.playbackSpeed=t,e&&(this.time=_o(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved)return void(this.pendingPlayState="running");if(this.isStopped)return;const{driver:t=ks,onPlay:e}=this.options;this.driver||(this.driver=t((t=>this.tick(t)))),e&&e();const n=this.driver.now();null!==this.holdTime?this.startTime=n-this.holdTime:this.startTime&&"finished"!==this.state||(this.startTime=n),"finished"===this.state&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var t;this._resolved?(this.state="paused",this.holdTime=null!==(t=this.currentTime)&&void 0!==t?t:0):this.pendingPlayState="paused"}complete(){"running"!==this.state&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:t}=this.options;t&&t()}cancel(){null!==this.cancelTime&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}}const Ns=t=>Array.isArray(t)&&"number"===typeof t[0];function Os(t){return Boolean(!t||"string"===typeof t&&t in Ls||Ns(t)||Array.isArray(t)&&t.every(Os))}const Ds=t=>{let[e,n,r,i]=t;return"cubic-bezier(".concat(e,", ").concat(n,", ").concat(r,", ").concat(i,")")},Ls={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Ds([0,.65,.55,1]),circOut:Ds([.55,0,1,.45]),backIn:Ds([.31,.01,.66,-.59]),backOut:Ds([.33,1.53,.69,.99])};function Fs(t){return Us(t)||Ls.easeOut}function Us(t){return t?Ns(t)?Ds(t):Array.isArray(t)?t.map(Fs):Ls[t]:void 0}const Bs=ka((()=>Object.hasOwnProperty.call(Element.prototype,"animate"))),zs=new Set(["opacity","clipPath","filter","transform"]);class js extends Ra{constructor(t){super(t);const{name:e,motionValue:n,keyframes:r}=this.options;this.resolver=new Aa(r,((t,e)=>this.onKeyframesResolved(t,e)),e,n),this.resolver.scheduleResolve()}initPlayback(t,e){var n;let{duration:r=300,times:i,ease:o,type:a,motionValue:s,name:l}=this.options;if(!(null===(n=s.owner)||void 0===n?void 0:n.current))return!1;if("spring"===(c=this.options).type||"backgroundColor"===c.name||!Os(c.ease)){const{onComplete:e,onUpdate:n,motionValue:s,...l}=this.options,c=function(t,e){const n=new Ps({...e,keyframes:t,repeat:0,delay:0,isGenerator:!0});let r={done:!1,value:t[0]};const i=[];let o=0;for(;!r.done&&o<2e4;)r=n.sample(o),i.push(r.value),o+=10;return{times:void 0,keyframes:i,duration:o-10,ease:"linear"}}(t,l);1===(t=c.keyframes).length&&(t[1]=t[0]),r=c.duration,i=c.times,o=c.ease,a="keyframes"}var c;const u=function(t,e,n){let{delay:r=0,duration:i=300,repeat:o=0,repeatType:a="loop",ease:s,times:l}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const c={[e]:n};l&&(c.offset=l);const u=Us(s);return Array.isArray(u)&&(c.easing=u),t.animate(c,{delay:r,duration:i,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:o+1,direction:"reverse"===a?"alternate":"normal"})}(s.owner.current,l,t,{...this.options,duration:r,times:i,ease:o});return u.startTime=Po.now(),this.pendingTimeline?(u.timeline=this.pendingTimeline,this.pendingTimeline=void 0):u.onfinish=()=>{const{onComplete:n}=this.options;s.set(ko(t,this.options,e)),n&&n(),this.cancel(),this.resolveFinishedPromise()},{animation:u,duration:r,times:i,type:a,ease:o,keyframes:t}}get duration(){const{resolved:t}=this;if(!t)return 0;const{duration:e}=t;return _o(e)}get time(){const{resolved:t}=this;if(!t)return 0;const{animation:e}=t;return _o(e.currentTime||0)}set time(t){const{resolved:e}=this;if(!e)return;const{animation:n}=e;n.currentTime=xo(t)}get speed(){const{resolved:t}=this;if(!t)return 1;const{animation:e}=t;return e.playbackRate}set speed(t){const{resolved:e}=this;if(!e)return;const{animation:n}=e;n.playbackRate=t}get state(){const{resolved:t}=this;if(!t)return"idle";const{animation:e}=t;return e.playState}attachTimeline(t){if(this._resolved){const{resolved:e}=this;if(!e)return ji;const{animation:n}=e;n.timeline=t,n.onfinish=null}else this.pendingTimeline=t;return ji}play(){if(this.isStopped)return;const{resolved:t}=this;if(!t)return;const{animation:e}=t;"finished"===e.playState&&this.updateFinishedPromise(),e.play()}pause(){const{resolved:t}=this;if(!t)return;const{animation:e}=t;e.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,"idle"===this.state)return;const{resolved:t}=this;if(!t)return;const{animation:e,keyframes:n,duration:r,type:i,ease:o,times:a}=t;if("idle"!==e.playState&&"finished"!==e.playState){if(this.time){const{motionValue:t,onUpdate:e,onComplete:s,...l}=this.options,c=new Ps({...l,keyframes:n,duration:r,type:i,ease:o,times:a,isGenerator:!0}),u=xo(this.time);t.setWithVelocity(c.sample(u-10).value,c.sample(u).value,10)}this.cancel()}}complete(){const{resolved:t}=this;t&&t.animation.finish()}cancel(){const{resolved:t}=this;t&&t.animation.cancel()}static supports(t){const{motionValue:e,name:n,repeatDelay:r,repeatType:i,damping:o,type:a}=t;return Bs()&&n&&zs.has(n)&&e&&e.owner&&e.owner.current instanceof HTMLElement&&!e.owner.getProps().onUpdate&&!r&&"mirror"!==i&&0!==o&&"inertia"!==a}}const Vs=ka((()=>void 0!==window.ScrollTimeline));class Ws{constructor(t){this.stop=()=>this.runAll("stop"),this.animations=t.filter(Boolean)}then(t,e){return Promise.all(this.animations).then(t).catch(e)}getAll(t){return this.animations[0][t]}setAll(t,e){for(let n=0;n<this.animations.length;n++)this.animations[n][t]=e}attachTimeline(t){const e=this.animations.map((e=>{if(!Vs()||!e.attachTimeline)return e.pause(),function(t,e){let n;const r=()=>{const{currentTime:r}=e,i=(null===r?0:r.value)/100;n!==i&&t(i),n=i};return Vi.update(r,!0),()=>Wi(r)}((t=>{e.time=e.duration*t}),t);e.attachTimeline(t)}));return()=>{e.forEach(((t,e)=>{t&&t(),this.animations[e].stop()}))}}get time(){return this.getAll("time")}set time(t){this.setAll("time",t)}get speed(){return this.getAll("speed")}set speed(t){this.setAll("speed",t)}get duration(){let t=0;for(let e=0;e<this.animations.length;e++)t=Math.max(t,this.animations[e].duration);return t}runAll(t){this.animations.forEach((e=>e[t]()))}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}const Gs=function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4?arguments[4]:void 0,o=arguments.length>5?arguments[5]:void 0;return a=>{const s=Mo(r,t)||{},l=s.delay||r.delay||0;let{elapsed:c=0}=r;c-=xo(l);let u={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:e.getVelocity(),...s,delay:-c,onUpdate:t=>{e.set(t),s.onUpdate&&s.onUpdate(t)},onComplete:()=>{a(),s.onComplete&&s.onComplete()},name:t,motionValue:e,element:o?void 0:i};(function(t){let{when:e,delay:n,delayChildren:r,staggerChildren:i,staggerDirection:o,repeat:a,repeatType:s,repeatDelay:l,from:c,elapsed:u,...h}=t;return!!Object.keys(h).length})(s)||(u={...u,...Eo(t,u)}),u.duration&&(u.duration=xo(u.duration)),u.repeatDelay&&(u.repeatDelay=xo(u.repeatDelay)),void 0!==u.from&&(u.keyframes[0]=u.from);let h=!1;if((!1===u.type||0===u.duration&&!u.repeatDelay)&&(u.duration=0,0===u.delay&&(h=!0)),(Co||rr)&&(h=!0,u.duration=0,u.delay=0),h&&!o&&void 0!==e.get()){const t=ko(u.keyframes,s);if(void 0!==t)return Vi.update((()=>{u.onUpdate(t),u.onComplete()})),new Ws([])}return!o&&js.supports(u)?new js(u):new Ps(u)}};function Hs(t){return Boolean(Ur(t)&&t.add)}function qs(t,e){-1===t.indexOf(e)&&t.push(e)}function Xs(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class Ys{constructor(){this.subscriptions=[]}add(t){return qs(this.subscriptions,t),()=>Xs(this.subscriptions,t)}notify(t,e,n){const r=this.subscriptions.length;if(r)if(1===r)this.subscriptions[0](t,e,n);else for(let i=0;i<r;i++){const r=this.subscriptions[i];r&&r(t,e,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Ks={current:void 0};class Zs{constructor(t){var e=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.version="11.2.12",this.canTrackVelocity=null,this.events={},this.updateAndNotify=function(t){let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const r=Po.now();e.updatedAt!==r&&e.setPrevFrameValue(),e.prev=e.current,e.setCurrent(t),e.current!==e.prev&&e.events.change&&e.events.change.notify(e.current),n&&e.events.renderRequest&&e.events.renderRequest.notify(e.current)},this.hasAnimated=!1,this.setCurrent(t),this.owner=n.owner}setCurrent(t){this.current=t,this.updatedAt=Po.now(),null===this.canTrackVelocity&&void 0!==t&&(this.canTrackVelocity=(t=>!isNaN(parseFloat(t)))(this.current))}setPrevFrameValue(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.current;this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,e){this.events[t]||(this.events[t]=new Ys);const n=this.events[t].add(e);return"change"===t?()=>{n(),Vi.read((()=>{this.events.change.getSize()||this.stop()}))}:n}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,e){this.passiveEffect=t,this.stopPassiveEffect=e}set(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e&&this.passiveEffect?this.passiveEffect(t,this.updateAndNotify):this.updateAndNotify(t,e)}setWithVelocity(t,e,n){this.set(e),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-n}jump(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,e&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return Ks.current&&Ks.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){const t=Po.now();if(!this.canTrackVelocity||void 0===this.prevFrameValue||t-this.updatedAt>30)return 0;const e=Math.min(this.updatedAt-this.prevUpdatedAt,30);return Pa(parseFloat(this.current)-parseFloat(this.prevFrameValue),e)}start(t){return this.stop(),new Promise((e=>{this.hasAnimated=!0,this.animation=t(e),this.events.animationStart&&this.events.animationStart.notify()})).then((()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()}))}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Js(t,e){return new Zs(t,e)}function Qs(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,Js(n))}function $s(t){return t.getProps()[nr]}function tl(t,e){let{protectedKeys:n,needsAnimating:r}=t;const i=n.hasOwnProperty(e)&&!0!==r[e];return r[e]=!1,i}function el(t,e){let{delay:n=0,transitionOverride:r,type:i}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var o;let{transition:a=t.getDefaultTransition(),transitionEnd:s,...l}=e;const c=t.getValue("willChange");r&&(a=r);const u=[],h=i&&t.animationState&&t.animationState.getState()[i];for(const d in l){const e=t.getValue(d,null!==(o=t.latestValues[d])&&void 0!==o?o:null),r=l[d];if(void 0===r||h&&tl(h,d))continue;const i={delay:n,elapsed:0,...Mo(a||{},d)};let s=!1;if(window.HandoffAppearAnimations){const n=$s(t);if(n){const t=window.HandoffAppearAnimations(n,d,e,Vi);null!==t&&(i.elapsed=t,s=!0)}}e.start(Gs(d,e,r,t.shouldReduceMotion&&Lr.has(d)?{type:!1}:i,t,s));const p=e.animation;p&&(Hs(c)&&(c.add(d),p.then((()=>c.remove(d)))),u.push(p))}return s&&Promise.all(u).then((()=>{Vi.update((()=>{s&&function(t,e){const n=bo(t,e);let{transitionEnd:r={},transition:i={},...o}=n||{};o={...o,...r};for(const a in o)Qs(t,a,Fi(o[a]))}(t,s)}))})),u}function nl(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var r;const i=bo(t,e,"exit"===n.type?null===(r=t.presenceContext)||void 0===r?void 0:r.custom:void 0);let{transition:o=t.getDefaultTransition()||{}}=i||{};n.transitionOverride&&(o=n.transitionOverride);const a=i?()=>Promise.all(el(t,i,n)):()=>Promise.resolve(),s=t.variantChildren&&t.variantChildren.size?function(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const{delayChildren:i=0,staggerChildren:a,staggerDirection:s}=o;return function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,o=arguments.length>5?arguments[5]:void 0;const a=[],s=(t.variantChildren.size-1)*r,l=1===i?function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)*r}:function(){return s-(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)*r};return Array.from(t.variantChildren).sort(rl).forEach(((t,r)=>{t.notify("AnimationStart",e),a.push(nl(t,e,{...o,delay:n+l(r)}).then((()=>t.notify("AnimationComplete",e))))})),Promise.all(a)}(t,e,i+r,a,s,n)}:()=>Promise.resolve(),{when:l}=o;if(l){const[t,e]="beforeChildren"===l?[a,s]:[s,a];return t().then((()=>e()))}return Promise.all([a(),s(n.delay)])}function rl(t,e){return t.sortNodePosition(e)}const il=[...br].reverse(),ol=br.length;function al(t){return e=>Promise.all(e.map((e=>{let{animation:n,options:r}=e;return function(t,e){let n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t.notify("AnimationStart",e),Array.isArray(e)){const i=e.map((e=>nl(t,e,r)));n=Promise.all(i)}else if("string"===typeof e)n=nl(t,e,r);else{const i="function"===typeof e?bo(t,e,r.custom):e;n=Promise.all(el(t,i,r))}return n.then((()=>{Vi.postRender((()=>{t.notify("AnimationComplete",e)}))}))}(t,n,r)})))}function sl(t,e){return"string"===typeof e?e!==t:!!Array.isArray(e)&&!vo(e,t)}function ll(){return{isActive:arguments.length>0&&void 0!==arguments[0]&&arguments[0],protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function cl(){return{animate:ll(!0),whileInView:ll(),whileHover:ll(),whileTap:ll(),whileDrag:ll(),whileFocus:ll(),exit:ll()}}let ul=0;const hl={animation:{Feature:class extends ao{constructor(t){super(t),t.animationState||(t.animationState=function(t){let e=al(t),n=cl(),r=!0;const i=e=>(n,r)=>{var i;const o=bo(t,r,"exit"===e?null===(i=t.presenceContext)||void 0===i?void 0:i.custom:void 0);if(o){const{transition:t,transitionEnd:e,...r}=o;n={...n,...r,...e}}return n};function o(o){const a=t.getProps(),s=t.getVariantContext(!0)||{},l=[],c=new Set;let u={},h=1/0;for(let e=0;e<ol;e++){const d=il[e],p=n[d],f=void 0!==a[d]?a[d]:s[d],m=yr(f),g=d===o?p.isActive:null;!1===g&&(h=e);let y=f===s[d]&&f!==a[d]&&m;if(y&&r&&t.manuallyAnimateOnMount&&(y=!1),p.protectedKeys={...u},!p.isActive&&null===g||!f&&!p.prevProp||vr(f)||"boolean"===typeof f)continue;let v=sl(p.prevProp,f)||d===o&&p.isActive&&!y&&m||e>h&&m,b=!1;const x=Array.isArray(f)?f:[f];let _=x.reduce(i(d),{});!1===g&&(_={});const{prevResolvedValues:w={}}=p,S={...w,..._},T=e=>{v=!0,c.has(e)&&(b=!0,c.delete(e)),p.needsAnimating[e]=!0;const n=t.getValue(e);n&&(n.liveStyle=!1)};for(const t in S){const e=_[t],n=w[t];if(u.hasOwnProperty(t))continue;let r=!1;r=Di(e)&&Di(n)?!vo(e,n):e!==n,r?void 0!==e&&null!==e?T(t):c.add(t):void 0!==e&&c.has(t)?T(t):p.protectedKeys[t]=!0}p.prevProp=f,p.prevResolvedValues=_,p.isActive&&(u={...u,..._}),r&&t.blockInitialAnimation&&(v=!1),!v||y&&!b||l.push(...x.map((t=>({animation:t,options:{type:d}}))))}if(c.size){const e={};c.forEach((n=>{const r=t.getBaseTarget(n),i=t.getValue(n);i&&(i.liveStyle=!0),e[n]=null!==r&&void 0!==r?r:null})),l.push({animation:e})}let d=Boolean(l.length);return!r||!1!==a.initial&&a.initial!==a.animate||t.manuallyAnimateOnMount||(d=!1),r=!1,d?e(l):Promise.resolve()}return{animateChanges:o,setActive:function(e,r){var i;if(n[e].isActive===r)return Promise.resolve();null===(i=t.variantChildren)||void 0===i||i.forEach((t=>{var n;return null===(n=t.animationState)||void 0===n?void 0:n.setActive(e,r)})),n[e].isActive=r;const a=o(e);for(const t in n)n[t].protectedKeys={};return a},setAnimateFunction:function(n){e=n(t)},getState:()=>n,reset:()=>{n=cl(),r=!0}}}(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();vr(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:e}=this.node.prevProps||{};t!==e&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),null===(t=this.unmountControls)||void 0===t||t.call(this)}}},exit:{Feature:class extends ao{constructor(){super(...arguments),this.id=ul++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:e}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===n)return;const r=this.node.animationState.setActive("exit",!t);e&&!t&&r.then((()=>e(this.id)))}mount(){const{register:t}=this.node.presenceContext||{};t&&(this.unmount=t(this.id))}unmount(){}}}},dl=(t,e)=>Math.abs(t-e);class pl{constructor(t,e){let{transformPagePoint:n,contextWindow:r,dragSnapToOrigin:i=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!this.lastMoveEvent||!this.lastMoveEventInfo)return;const t=gl(this.lastMoveEventInfo,this.history),e=null!==this.startEvent,n=function(t,e){const n=dl(t.x,e.x),r=dl(t.y,e.y);return Math.sqrt(n**2+r**2)}(t.offset,{x:0,y:0})>=3;if(!e&&!n)return;const{point:r}=t,{timestamp:i}=Gi;this.history.push({...r,timestamp:i});const{onStart:o,onMove:a}=this.handlers;e||(o&&o(this.lastMoveEvent,t),this.startEvent=this.lastMoveEvent),a&&a(this.lastMoveEvent,t)},this.handlePointerMove=(t,e)=>{this.lastMoveEvent=t,this.lastMoveEventInfo=fl(e,this.transformPagePoint),Vi.update(this.updatePoint,!0)},this.handlePointerUp=(t,e)=>{this.end();const{onEnd:n,onSessionEnd:r,resumeAnimation:i}=this.handlers;if(this.dragSnapToOrigin&&i&&i(),!this.lastMoveEvent||!this.lastMoveEventInfo)return;const o=gl("pointercancel"===t.type?this.lastMoveEventInfo:fl(e,this.transformPagePoint),this.history);this.startEvent&&n&&n(t,o),r&&r(t,o)},!Ki(t))return;this.dragSnapToOrigin=i,this.handlers=e,this.transformPagePoint=n,this.contextWindow=r||window;const o=fl(Zi(t),this.transformPagePoint),{point:a}=o,{timestamp:s}=Gi;this.history=[{...a,timestamp:s}];const{onSessionStart:l}=e;l&&l(t,gl(o,this.history)),this.removeListeners=to(Qi(this.contextWindow,"pointermove",this.handlePointerMove),Qi(this.contextWindow,"pointerup",this.handlePointerUp),Qi(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),Wi(this.updatePoint)}}function fl(t,e){return e?{point:e(t.point)}:t}function ml(t,e){return{x:t.x-e.x,y:t.y-e.y}}function gl(t,e){let{point:n}=t;return{point:n,delta:ml(n,vl(e)),offset:ml(n,yl(e)),velocity:bl(e,.1)}}function yl(t){return t[0]}function vl(t){return t[t.length-1]}function bl(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,r=null;const i=vl(t);for(;n>=0&&(r=t[n],!(i.timestamp-r.timestamp>xo(e)));)n--;if(!r)return{x:0,y:0};const o=_o(i.timestamp-r.timestamp);if(0===o)return{x:0,y:0};const a={x:(i.x-r.x)/o,y:(i.y-r.y)/o};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}function xl(t){return t.max-t.min}function _l(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.01;return Math.abs(t-e)<=n}function wl(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;t.origin=r,t.originPoint=ds(e.min,e.max,t.origin),t.scale=xl(n)/xl(e),(_l(t.scale,1,1e-4)||isNaN(t.scale))&&(t.scale=1),t.translate=ds(n.min,n.max,t.origin)-t.originPoint,(_l(t.translate)||isNaN(t.translate))&&(t.translate=0)}function Sl(t,e,n,r){wl(t.x,e.x,n.x,r?r.originX:void 0),wl(t.y,e.y,n.y,r?r.originY:void 0)}function Tl(t,e,n){t.min=n.min+e.min,t.max=t.min+xl(e)}function El(t,e,n){t.min=e.min-n.min,t.max=t.min+xl(e)}function Ml(t,e,n){El(t.x,e.x,n.x),El(t.y,e.y,n.y)}function Cl(t,e,n){return{min:void 0!==e?t.min+e:void 0,max:void 0!==n?t.max+n-(t.max-t.min):void 0}}function Al(t,e){let n=e.min-t.min,r=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,r]=[r,n]),{min:n,max:r}}const kl=.35;function Il(t,e,n){return{min:Rl(t,e),max:Rl(t,n)}}function Rl(t,e){return"number"===typeof t?t:t[e]||0}const Pl=()=>({x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}}),Nl=()=>({x:{min:0,max:0},y:{min:0,max:0}});function Ol(t){return[t("x"),t("y")]}function Dl(t){let{top:e,left:n,right:r,bottom:i}=t;return{x:{min:n,max:r},y:{min:e,max:i}}}function Ll(t){return void 0===t||1===t}function Fl(t){let{scale:e,scaleX:n,scaleY:r}=t;return!Ll(e)||!Ll(n)||!Ll(r)}function Ul(t){return Fl(t)||Bl(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function Bl(t){return zl(t.x)||zl(t.y)}function zl(t){return t&&"0%"!==t}function jl(t,e,n){return n+e*(t-n)}function Vl(t,e,n,r,i){return void 0!==i&&(t=jl(t,i,r)),jl(t,n,r)+e}function Wl(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;t.min=Vl(t.min,e,n,r,i),t.max=Vl(t.max,e,n,r,i)}function Gl(t,e){let{x:n,y:r}=e;Wl(t.x,n.translate,n.scale,n.originPoint),Wl(t.y,r.translate,r.scale,r.originPoint)}function Hl(t){return Number.isInteger(t)||t>1.0000000000001||t<.999999999999?t:1}function ql(t,e){t.min=t.min+e,t.max=t.max+e}function Xl(t,e,n){let[r,i,o]=n;const a=void 0!==e[o]?e[o]:.5,s=ds(t.min,t.max,a);Wl(t,e[r],e[i],s,e.scale)}const Yl=["x","scaleX","originX"],Kl=["y","scaleY","originY"];function Zl(t,e){Xl(t.x,e,Yl),Xl(t.y,e,Kl)}function Jl(t,e){return Dl(function(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),r=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}(t.getBoundingClientRect(),e))}const Ql=t=>{let{current:e}=t;return e?e.ownerDocument.defaultView:null},$l=new WeakMap;class tc{constructor(t){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Nl(),this.visualElement=t}start(t){let{snapToCursor:e=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{presenceContext:n}=this.visualElement;if(n&&!1===n.isPresent)return;const{dragSnapToOrigin:r}=this.getProps();this.panSession=new pl(t,{onSessionStart:t=>{const{dragSnapToOrigin:n}=this.getProps();n?this.pauseAnimation():this.stopAnimation(),e&&this.snapToCursor(Zi(t,"page").point)},onStart:(t,e)=>{const{drag:n,dragPropagation:r,onDragStart:i}=this.getProps();if(n&&!r&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=io(n),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Ol((t=>{let e=this.getAxisMotionValue(t).get()||0;if(ii.test(e)){const{projection:n}=this.visualElement;if(n&&n.layout){const r=n.layout.layoutBox[t];if(r){e=xl(r)*(parseFloat(e)/100)}}}this.originPoint[t]=e})),i&&Vi.postRender((()=>i(t,e)));const{animationState:o}=this.visualElement;o&&o.setActive("whileDrag",!0)},onMove:(t,e)=>{const{dragPropagation:n,dragDirectionLock:r,onDirectionLock:i,onDrag:o}=this.getProps();if(!n&&!this.openGlobalLock)return;const{offset:a}=e;if(r&&null===this.currentDirection)return this.currentDirection=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=null;Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x");return n}(a),void(null!==this.currentDirection&&i&&i(this.currentDirection));this.updateAxis("x",e.point,a),this.updateAxis("y",e.point,a),this.visualElement.render(),o&&o(t,e)},onSessionEnd:(t,e)=>this.stop(t,e),resumeAnimation:()=>Ol((t=>{var e;return"paused"===this.getAnimationState(t)&&(null===(e=this.getAxisMotionValue(t).animation)||void 0===e?void 0:e.play())}))},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:r,contextWindow:Ql(this.visualElement)})}stop(t,e){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:r}=e;this.startAnimation(r);const{onDragEnd:i}=this.getProps();i&&Vi.postRender((()=>i(t,e)))}cancel(){this.isDragging=!1;const{projection:t,animationState:e}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),e&&e.setActive("whileDrag",!1)}updateAxis(t,e,n){const{drag:r}=this.getProps();if(!n||!ec(t,r,this.currentDirection))return;const i=this.getAxisMotionValue(t);let o=this.originPoint[t]+n[t];this.constraints&&this.constraints[t]&&(o=function(t,e,n){let{min:r,max:i}=e;return void 0!==r&&t<r?t=n?ds(r,t,n.min):Math.max(t,r):void 0!==i&&t>i&&(t=n?ds(i,t,n.max):Math.min(t,i)),t}(o,this.constraints[t],this.elastic[t])),i.set(o)}resolveConstraints(){var t;const{dragConstraints:e,dragElastic:n}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):null===(t=this.visualElement.projection)||void 0===t?void 0:t.layout,i=this.constraints;e&&ur(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):this.constraints=!(!e||!r)&&function(t,e){let{top:n,left:r,bottom:i,right:o}=e;return{x:Cl(t.x,r,o),y:Cl(t.y,n,i)}}(r.layoutBox,e),this.elastic=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:kl;return!1===t?t=0:!0===t&&(t=kl),{x:Il(t,"left","right"),y:Il(t,"top","bottom")}}(n),i!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&Ol((t=>{!1!==this.constraints&&this.getAxisMotionValue(t)&&(this.constraints[t]=function(t,e){const n={};return void 0!==e.min&&(n.min=e.min-t.min),void 0!==e.max&&(n.max=e.max-t.min),n}(r.layoutBox[t],this.constraints[t]))}))}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:e}=this.getProps();if(!t||!ur(t))return!1;const n=t.current;Lo(null!==n,"If `dragConstraints` is set as a React ref, that ref must be passed to another component's `ref` prop.");const{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const i=function(t,e,n){const r=Jl(t,n),{scroll:i}=e;return i&&(ql(r.x,i.offset.x),ql(r.y,i.offset.y)),r}(n,r.root,this.visualElement.getTransformPagePoint());let o=function(t,e){return{x:Al(t.x,e.x),y:Al(t.y,e.y)}}(r.layout.layoutBox,i);if(e){const t=e(function(t){let{x:e,y:n}=t;return{top:n.min,right:e.max,bottom:n.max,left:e.min}}(o));this.hasMutatedConstraints=!!t,t&&(o=Dl(t))}return o}startAnimation(t){const{drag:e,dragMomentum:n,dragElastic:r,dragTransition:i,dragSnapToOrigin:o,onDragTransitionEnd:a}=this.getProps(),s=this.constraints||{},l=Ol((a=>{if(!ec(a,e,this.currentDirection))return;let l=s&&s[a]||{};o&&(l={min:0,max:0});const c=r?200:1e6,u=r?40:1e7,h={type:"inertia",velocity:n?t[a]:0,bounceStiffness:c,bounceDamping:u,timeConstant:750,restDelta:1,restSpeed:10,...i,...l};return this.startAxisValueAnimation(a,h)}));return Promise.all(l).then(a)}startAxisValueAnimation(t,e){const n=this.getAxisMotionValue(t);return n.start(Gs(t,n,0,e,this.visualElement))}stopAnimation(){Ol((t=>this.getAxisMotionValue(t).stop()))}pauseAnimation(){Ol((t=>{var e;return null===(e=this.getAxisMotionValue(t).animation)||void 0===e?void 0:e.pause()}))}getAnimationState(t){var e;return null===(e=this.getAxisMotionValue(t).animation)||void 0===e?void 0:e.state}getAxisMotionValue(t){const e="_drag".concat(t.toUpperCase()),n=this.visualElement.getProps(),r=n[e];return r||this.visualElement.getValue(t,(n.initial?n.initial[t]:void 0)||0)}snapToCursor(t){Ol((e=>{const{drag:n}=this.getProps();if(!ec(e,n,this.currentDirection))return;const{projection:r}=this.visualElement,i=this.getAxisMotionValue(e);if(r&&r.layout){const{min:n,max:o}=r.layout.layoutBox[e];i.set(t[e]-ds(n,o,.5))}}))}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:e}=this.getProps(),{projection:n}=this.visualElement;if(!ur(e)||!n||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};Ol((t=>{const e=this.getAxisMotionValue(t);if(e&&!1!==this.constraints){const n=e.get();r[t]=function(t,e){let n=.5;const r=xl(t),i=xl(e);return i>r?n=hs(e.min,e.max-r,t.min):r>i&&(n=hs(t.min,t.max-i,e.min)),Xr(0,1,n)}({min:n,max:n},this.constraints[t])}}));const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),Ol((e=>{if(!ec(e,t,null))return;const n=this.getAxisMotionValue(e),{min:i,max:o}=this.constraints[e];n.set(ds(i,o,r[e]))}))}addListeners(){if(!this.visualElement.current)return;$l.set(this.visualElement,this);const t=Qi(this.visualElement.current,"pointerdown",(t=>{const{drag:e,dragListener:n=!0}=this.getProps();e&&n&&this.start(t)})),e=()=>{const{dragConstraints:t}=this.getProps();ur(t)&&t.current&&(this.constraints=this.resolveRefConstraints())},{projection:n}=this.visualElement,r=n.addEventListener("measure",e);n&&!n.layout&&(n.root&&n.root.updateScroll(),n.updateLayout()),Vi.read(e);const i=Yi(window,"resize",(()=>this.scalePositionWithinConstraints())),o=n.addEventListener("didUpdate",(t=>{let{delta:e,hasLayoutChanged:n}=t;this.isDragging&&n&&(Ol((t=>{const n=this.getAxisMotionValue(t);n&&(this.originPoint[t]+=e[t].translate,n.set(n.get()+e[t].translate))})),this.visualElement.render())}));return()=>{i(),t(),r(),o&&o()}}getProps(){const t=this.visualElement.getProps(),{drag:e=!1,dragDirectionLock:n=!1,dragPropagation:r=!1,dragConstraints:i=!1,dragElastic:o=kl,dragMomentum:a=!0}=t;return{...t,drag:e,dragDirectionLock:n,dragPropagation:r,dragConstraints:i,dragElastic:o,dragMomentum:a}}}function ec(t,e,n){return(!0===e||e===t)&&(null===n||n===t)}const nc=t=>(e,n)=>{t&&Vi.postRender((()=>t(e,n)))};const rc={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function ic(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const oc={correct:(t,e)=>{if(!e.target)return t;if("string"===typeof t){if(!oi.test(t))return t;t=parseFloat(t)}const n=ic(t,e.target.x),r=ic(t,e.target.y);return"".concat(n,"% ").concat(r,"%")}},ac={correct:(t,e)=>{let{treeScale:n,projectionDelta:r}=e;const i=t,o=ba.parse(t);if(o.length>5)return i;const a=ba.createTransformer(t),s="number"!==typeof o[0]?1:0,l=r.x.scale*n.x,c=r.y.scale*n.y;o[0+s]/=l,o[1+s]/=c;const u=ds(l,c,.5);return"number"===typeof o[2+s]&&(o[2+s]/=u),"number"===typeof o[3+s]&&(o[3+s]/=u),a(o)}};class sc extends k.Component{componentDidMount(){const{visualElement:t,layoutGroup:e,switchLayoutGroup:n,layoutId:r}=this.props,{projection:i}=t;var o;o=cc,Object.assign(Or,o),i&&(e.group&&e.group.add(i),n&&n.register&&r&&n.register(i),i.root.didUpdate(),i.addEventListener("animationComplete",(()=>{this.safeToRemove()})),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),rc.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:e,visualElement:n,drag:r,isPresent:i}=this.props,o=n.projection;return o?(o.isPresent=i,r||t.layoutDependency!==e||void 0===e?o.willUpdate():this.safeToRemove(),t.isPresent!==i&&(i?o.promote():o.relegate()||Vi.postRender((()=>{const t=o.getStack();t&&t.members.length||this.safeToRemove()}))),null):null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),lr.postRender((()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()})))}componentWillUnmount(){const{visualElement:t,layoutGroup:e,switchLayoutGroup:n}=this.props,{projection:r}=t;r&&(r.scheduleCheckAfterUnmount(),e&&e.group&&e.group.remove(r),n&&n.deregister&&n.deregister(r))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function lc(t){const[e,n]=function(){const t=(0,k.useContext)(Jn);if(null===t)return[!0,null];const{isPresent:e,onExitComplete:n,register:r}=t,i=(0,k.useId)();return(0,k.useEffect)((()=>r(i)),[]),!e&&n?[!1,()=>n&&n(i)]:[!0]}(),r=(0,k.useContext)(Cr);return(0,Dn.jsx)(sc,{...t,layoutGroup:r,switchLayoutGroup:(0,k.useContext)(hr),isPresent:e,safeToRemove:n})}const cc={borderRadius:{...oc,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:oc,borderTopRightRadius:oc,borderBottomLeftRadius:oc,borderBottomRightRadius:oc,boxShadow:ac},uc=["TopLeft","TopRight","BottomLeft","BottomRight"],hc=uc.length,dc=t=>"string"===typeof t?parseFloat(t):t,pc=t=>"number"===typeof t||oi.test(t);function fc(t,e){return void 0!==t[e]?t[e]:t.borderRadius}const mc=yc(0,.5,is),gc=yc(.5,.95,ji);function yc(t,e,n){return r=>r<t?0:r>e?1:n(hs(t,e,r))}function vc(t,e){t.min=e.min,t.max=e.max}function bc(t,e){vc(t.x,e.x),vc(t.y,e.y)}function xc(t,e,n,r,i){return t=jl(t-=e,1/n,r),void 0!==i&&(t=jl(t,1/i,r)),t}function _c(t,e,n,r,i){let[o,a,s]=n;!function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,i=arguments.length>4?arguments[4]:void 0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:t,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:t;ii.test(e)&&(e=parseFloat(e),e=ds(a.min,a.max,e/100)-a.min);if("number"!==typeof e)return;let s=ds(o.min,o.max,r);t===o&&(s-=e),t.min=xc(t.min,e,n,s,i),t.max=xc(t.max,e,n,s,i)}(t,e[o],e[a],e[s],e.scale,r,i)}const wc=["x","scaleX","originX"],Sc=["y","scaleY","originY"];function Tc(t,e,n,r){_c(t.x,e,wc,n?n.x:void 0,r?r.x:void 0),_c(t.y,e,Sc,n?n.y:void 0,r?r.y:void 0)}function Ec(t){return 0===t.translate&&1===t.scale}function Mc(t){return Ec(t.x)&&Ec(t.y)}function Cc(t,e){return Math.round(t.x.min)===Math.round(e.x.min)&&Math.round(t.x.max)===Math.round(e.x.max)&&Math.round(t.y.min)===Math.round(e.y.min)&&Math.round(t.y.max)===Math.round(e.y.max)}function Ac(t){return xl(t.x)/xl(t.y)}class kc{constructor(){this.members=[]}add(t){qs(this.members,t),t.scheduleRender()}remove(t){if(Xs(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(t){const e=this.members.findIndex((e=>t===e));if(0===e)return!1;let n;for(let r=e;r>=0;r--){const t=this.members[r];if(!1!==t.isPresent){n=t;break}}return!!n&&(this.promote(n),!0)}promote(t,e){const n=this.lead;if(t!==n&&(this.prevLead=n,this.lead=t,t.show(),n)){n.instance&&n.scheduleRender(),t.scheduleRender(),t.resumeFrom=n,e&&(t.resumeFrom.preserveOpacity=!0),n.snapshot&&(t.snapshot=n.snapshot,t.snapshot.latestValues=n.animationValues||n.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:r}=t.options;!1===r&&n.hide()}}exitAnimationComplete(){this.members.forEach((t=>{const{options:e,resumingFrom:n}=t;e.onExitComplete&&e.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()}))}scheduleRender(){this.members.forEach((t=>{t.instance&&t.scheduleRender(!1)}))}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function Ic(t,e,n){let r="";const i=t.x.translate/e.x,o=t.y.translate/e.y,a=(null===n||void 0===n?void 0:n.z)||0;if((i||o||a)&&(r="translate3d(".concat(i,"px, ").concat(o,"px, ").concat(a,"px) ")),1===e.x&&1===e.y||(r+="scale(".concat(1/e.x,", ").concat(1/e.y,") ")),n){const{transformPerspective:t,rotate:e,rotateX:i,rotateY:o,skewX:a,skewY:s}=n;t&&(r="perspective(".concat(t,"px) ").concat(r)),e&&(r+="rotate(".concat(e,"deg) ")),i&&(r+="rotateX(".concat(i,"deg) ")),o&&(r+="rotateY(".concat(o,"deg) ")),a&&(r+="skewX(".concat(a,"deg) ")),s&&(r+="skewY(".concat(s,"deg) "))}const s=t.x.scale*e.x,l=t.y.scale*e.y;return 1===s&&1===l||(r+="scale(".concat(s,", ").concat(l,")")),r||"none"}const Rc=(t,e)=>t.depth-e.depth;class Pc{constructor(){this.children=[],this.isDirty=!1}add(t){qs(this.children,t),this.isDirty=!0}remove(t){Xs(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(Rc),this.isDirty=!1,this.children.forEach(t)}}const Nc=["","X","Y","Z"],Oc={visibility:"hidden"};let Dc=0;const Lc={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function Fc(t,e,n,r){const{latestValues:i}=e;i[t]&&(n[t]=i[t],e.setStaticValue(t,0),r&&(r[t]=0))}function Uc(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return!1;const{visualElement:e}=t.options;return!!e&&(!!$s(e)||!(!t.parent||t.parent.hasCheckedOptimisedAppear)&&Uc(t.parent))}function Bc(t){let{attachResizeListener:e,defaultParent:n,measureScroll:r,checkIsScrollRoot:i,resetTransform:o}=t;return class{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null===n||void 0===n?void 0:n();this.id=Dc++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Lc.totalNodes=Lc.resolvedTargetDeltas=Lc.recalculatedProjection=0,this.nodes.forEach(Vc),this.nodes.forEach(Kc),this.nodes.forEach(Zc),this.nodes.forEach(Wc),function(t){window.MotionDebug&&window.MotionDebug.record(t)}(Lc)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=t,this.root=e?e.root||e:this,this.path=e?[...e.path,e]:[],this.parent=e,this.depth=e?e.depth+1:0;for(let n=0;n<this.path.length;n++)this.path[n].shouldResetTransform=!0;this.root===this&&(this.nodes=new Pc)}addEventListener(t,e){return this.eventHandlers.has(t)||this.eventHandlers.set(t,new Ys),this.eventHandlers.get(t).add(e)}notifyListeners(t){const e=this.eventHandlers.get(t);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];e&&e.notify(...r)}hasListeners(t){return this.eventHandlers.has(t)}mount(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.root.hasTreeAnimated;if(this.instance)return;var r;this.isSVG=(r=t)instanceof SVGElement&&"svg"!==r.tagName,this.instance=t;const{layoutId:i,layout:o,visualElement:a}=this.options;if(a&&!a.current&&a.mount(t),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),n&&(o||i)&&(this.isLayoutDirty=!0),e){let n;const r=()=>this.root.updateBlockedByResize=!1;e(t,(()=>{this.root.updateBlockedByResize=!0,n&&n(),n=function(t,e){const n=Po.now(),r=i=>{let{timestamp:o}=i;const a=o-n;a>=e&&(Wi(r),t(a-e))};return Vi.read(r,!0),()=>Wi(r)}(r,250),rc.hasAnimatedSinceResize&&(rc.hasAnimatedSinceResize=!1,this.nodes.forEach(Yc))}))}i&&this.root.registerSharedNode(i,this),!1!==this.options.animate&&a&&(i||o)&&this.addEventListener("didUpdate",(t=>{let{delta:e,hasLayoutChanged:n,hasRelativeTargetChanged:r,layout:i}=t;if(this.isTreeAnimationBlocked())return this.target=void 0,void(this.relativeTarget=void 0);const o=this.options.transition||a.getDefaultTransition()||nu,{onLayoutAnimationStart:s,onLayoutAnimationComplete:l}=a.getProps(),c=!this.targetLayout||!Cc(this.targetLayout,i)||r,u=!n&&r;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||u||n&&(c||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(e,u);const t={...Mo(o,"layout"),onPlay:s,onComplete:l};(a.shouldReduceMotion||this.options.layoutRoot)&&(t.delay=0,t.type=!1),this.startAnimation(t)}else n||Yc(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=i}))}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const t=this.getStack();t&&t.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Wi(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Jc),this.animationId++)}getTransformTemplate(){const{visualElement:t}=this.options;return t&&t.getProps().transformTemplate}willUpdate(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked())return void(this.options.onExitComplete&&this.options.onExitComplete());if(window.HandoffCancelAllAnimations&&Uc(this)&&window.HandoffCancelAllAnimations(),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let i=0;i<this.path.length;i++){const t=this.path[i];t.shouldResetTransform=!0,t.updateScroll("snapshot"),t.options.layoutRoot&&t.willUpdate(!1)}const{layoutId:e,layout:n}=this.options;if(void 0===e&&!n)return;const r=this.getTransformTemplate();this.prevTransformTemplateValue=r?r(this.latestValues,""):void 0,this.updateSnapshot(),t&&this.notifyListeners("willUpdate")}update(){this.updateScheduled=!1;if(this.isUpdateBlocked())return this.unblockUpdate(),this.clearAllSnapshots(),void this.nodes.forEach(Hc);this.isUpdating||this.nodes.forEach(qc),this.isUpdating=!1,this.nodes.forEach(Xc),this.nodes.forEach(zc),this.nodes.forEach(jc),this.clearAllSnapshots();const t=Po.now();Gi.delta=Xr(0,1e3/60,t-Gi.timestamp),Gi.timestamp=t,Gi.isProcessing=!0,Hi.update.process(Gi),Hi.preRender.process(Gi),Hi.render.process(Gi),Gi.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,lr.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(Gc),this.sharedNodes.forEach(Qc)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Vi.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Vi.postRender((()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()}))}updateSnapshot(){!this.snapshot&&this.instance&&(this.snapshot=this.measure())}updateLayout(){if(!this.instance)return;if(this.updateScroll(),(!this.options.alwaysMeasureLayout||!this.isLead())&&!this.isLayoutDirty)return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let n=0;n<this.path.length;n++){this.path[n].updateScroll()}const t=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Nl(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:e}=this.options;e&&e.notify("LayoutMeasure",this.layout.layoutBox,t?t.layoutBox:void 0)}updateScroll(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"measure",e=Boolean(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===t&&(e=!1),e&&(this.scroll={animationId:this.root.animationId,phase:t,isRoot:i(this.instance),offset:r(this.instance)})}resetTransform(){if(!o)return;const t=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,e=this.projectionDelta&&!Mc(this.projectionDelta),n=this.getTransformTemplate(),r=n?n(this.latestValues,""):void 0,i=r!==this.prevTransformTemplateValue;t&&(e||Ul(this.latestValues)||i)&&(o(this.instance,r),this.shouldResetTransform=!1,this.scheduleRender())}measure(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const e=this.measurePageBox();let n=this.removeElementScroll(e);var r;return t&&(n=this.removeTransform(n)),ou((r=n).x),ou(r.y),{animationId:this.root.animationId,measuredBox:e,layoutBox:n,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:t}=this.options;if(!t)return Nl();const e=t.measureViewportBox(),{scroll:n}=this.root;return n&&(ql(e.x,n.offset.x),ql(e.y,n.offset.y)),e}removeElementScroll(t){const e=Nl();bc(e,t);for(let n=0;n<this.path.length;n++){const r=this.path[n],{scroll:i,options:o}=r;if(r!==this.root&&i&&o.layoutScroll){if(i.isRoot){bc(e,t);const{scroll:n}=this.root;n&&(ql(e.x,-n.offset.x),ql(e.y,-n.offset.y))}ql(e.x,i.offset.x),ql(e.y,i.offset.y)}}return e}applyTransform(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=Nl();bc(n,t);for(let r=0;r<this.path.length;r++){const t=this.path[r];!e&&t.options.layoutScroll&&t.scroll&&t!==t.root&&Zl(n,{x:-t.scroll.offset.x,y:-t.scroll.offset.y}),Ul(t.latestValues)&&Zl(n,t.latestValues)}return Ul(this.latestValues)&&Zl(n,this.latestValues),n}removeTransform(t){const e=Nl();bc(e,t);for(let n=0;n<this.path.length;n++){const t=this.path[n];if(!t.instance)continue;if(!Ul(t.latestValues))continue;Fl(t.latestValues)&&t.updateSnapshot();const r=Nl();bc(r,t.measurePageBox()),Tc(e,t.latestValues,t.snapshot?t.snapshot.layoutBox:void 0,r)}return Ul(this.latestValues)&&Tc(e,this.latestValues),e}setTargetDelta(t){this.targetDelta=t,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(t){this.options={...this.options,...t,crossfade:void 0===t.crossfade||t.crossfade}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Gi.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];var e;const n=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=n.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=n.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=n.isSharedProjectionDirty);const r=Boolean(this.resumingFrom)||this!==n;if(!(t||r&&this.isSharedProjectionDirty||this.isProjectionDirty||(null===(e=this.parent)||void 0===e?void 0:e.isProjectionDirty)||this.attemptToResolveRelativeTarget))return;const{layout:i,layoutId:o}=this.options;if(this.layout&&(i||o)){if(this.resolvedRelativeTargetAt=Gi.timestamp,!this.targetDelta&&!this.relativeTarget){const t=this.getClosestProjectingParent();t&&t.layout&&1!==this.animationProgress?(this.relativeParent=t,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Nl(),this.relativeTargetOrigin=Nl(),Ml(this.relativeTargetOrigin,this.layout.layoutBox,t.layout.layoutBox),bc(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(this.relativeTarget||this.targetDelta){var a,s,l;if(this.target||(this.target=Nl(),this.targetWithTransforms=Nl()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),a=this.target,s=this.relativeTarget,l=this.relativeParent.target,Tl(a.x,s.x,l.x),Tl(a.y,s.y,l.y)):this.targetDelta?(Boolean(this.resumingFrom)?this.target=this.applyTransform(this.layout.layoutBox):bc(this.target,this.layout.layoutBox),Gl(this.target,this.targetDelta)):bc(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const t=this.getClosestProjectingParent();t&&Boolean(t.resumingFrom)===Boolean(this.resumingFrom)&&!t.options.layoutScroll&&t.target&&1!==this.animationProgress?(this.relativeParent=t,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Nl(),this.relativeTargetOrigin=Nl(),Ml(this.relativeTargetOrigin,this.target,t.target),bc(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Lc.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(this.parent&&!Fl(this.parent.latestValues)&&!Bl(this.parent.latestValues))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return Boolean((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var t;const e=this.getLead(),n=Boolean(this.resumingFrom)||this!==e;let r=!0;if((this.isProjectionDirty||(null===(t=this.parent)||void 0===t?void 0:t.isProjectionDirty))&&(r=!1),n&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(r=!1),this.resolvedRelativeTargetAt===Gi.timestamp&&(r=!1),r)return;const{layout:i,layoutId:o}=this.options;if(this.isTreeAnimating=Boolean(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!i&&!o)return;bc(this.layoutCorrected,this.layout.layoutBox);const a=this.treeScale.x,s=this.treeScale.y;!function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=n.length;if(!i)return;let o,a;e.x=e.y=1;for(let s=0;s<i;s++){o=n[s],a=o.projectionDelta;const i=o.instance;i&&i.style&&"contents"===i.style.display||(r&&o.options.layoutScroll&&o.scroll&&o!==o.root&&Zl(t,{x:-o.scroll.offset.x,y:-o.scroll.offset.y}),a&&(e.x*=a.x.scale,e.y*=a.y.scale,Gl(t,a)),r&&Ul(o.latestValues)&&Zl(t,o.latestValues))}e.x=Hl(e.x),e.y=Hl(e.y)}(this.layoutCorrected,this.treeScale,this.path,n),!e.layout||e.target||1===this.treeScale.x&&1===this.treeScale.y||(e.target=e.layout.layoutBox,e.targetWithTransforms=Nl());const{target:l}=e;if(!l)return void(this.projectionTransform&&(this.projectionDelta=Pl(),this.projectionTransform="none",this.scheduleRender()));this.projectionDelta||(this.projectionDelta=Pl(),this.projectionDeltaWithTransform=Pl());const c=this.projectionTransform;Sl(this.projectionDelta,this.layoutCorrected,l,this.latestValues),this.projectionTransform=Ic(this.projectionDelta,this.treeScale),this.projectionTransform===c&&this.treeScale.x===a&&this.treeScale.y===s||(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",l)),Lc.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.options.scheduleRender&&this.options.scheduleRender(),t){const t=this.getStack();t&&t.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this.snapshot,r=n?n.latestValues:{},i={...this.latestValues},o=Pl();this.relativeParent&&this.relativeParent.options.layoutRoot||(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!e;const a=Nl(),s=(n?n.source:void 0)!==(this.layout?this.layout.source:void 0),l=this.getStack(),c=!l||l.members.length<=1,u=Boolean(s&&!c&&!0===this.options.crossfade&&!this.path.some(eu));let h;this.animationProgress=0,this.mixTargetDelta=e=>{const n=e/1e3;$c(o.x,t.x,n),$c(o.y,t.y,n),this.setTargetDelta(o),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Ml(a,this.layout.layoutBox,this.relativeParent.layout.layoutBox),function(t,e,n,r){tu(t.x,e.x,n.x,r),tu(t.y,e.y,n.y,r)}(this.relativeTarget,this.relativeTargetOrigin,a,n),h&&function(t,e){return t.x.min===e.x.min&&t.x.max===e.x.max&&t.y.min===e.y.min&&t.y.max===e.y.max}(this.relativeTarget,h)&&(this.isProjectionDirty=!1),h||(h=Nl()),bc(h,this.relativeTarget)),s&&(this.animationValues=i,function(t,e,n,r,i,o){i?(t.opacity=ds(0,void 0!==n.opacity?n.opacity:1,mc(r)),t.opacityExit=ds(void 0!==e.opacity?e.opacity:1,0,gc(r))):o&&(t.opacity=ds(void 0!==e.opacity?e.opacity:1,void 0!==n.opacity?n.opacity:1,r));for(let a=0;a<hc;a++){const i="border".concat(uc[a],"Radius");let o=fc(e,i),s=fc(n,i);void 0===o&&void 0===s||(o||(o=0),s||(s=0),0===o||0===s||pc(o)===pc(s)?(t[i]=Math.max(ds(dc(o),dc(s),r),0),(ii.test(s)||ii.test(o))&&(t[i]+="%")):t[i]=s)}(e.rotate||n.rotate)&&(t.rotate=ds(e.rotate||0,n.rotate||0,r))}(i,r,this.latestValues,n,u,c)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=n},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(t){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Wi(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Vi.update((()=>{rc.hasAnimatedSinceResize=!0,this.currentAnimation=function(t,e,n){const r=Ur(t)?t:Js(t);return r.start(Gs("",r,e,n)),r.animation}(0,1e3,{...t,onUpdate:e=>{this.mixTargetDelta(e),t.onUpdate&&t.onUpdate(e)},onComplete:()=>{t.onComplete&&t.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0}))}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const t=this.getStack();t&&t.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(1e3),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const t=this.getLead();let{targetWithTransforms:e,target:n,layout:r,latestValues:i}=t;if(e&&n&&r){if(this!==t&&this.layout&&r&&au(this.options.animationType,this.layout.layoutBox,r.layoutBox)){n=this.target||Nl();const e=xl(this.layout.layoutBox.x);n.x.min=t.target.x.min,n.x.max=n.x.min+e;const r=xl(this.layout.layoutBox.y);n.y.min=t.target.y.min,n.y.max=n.y.min+r}bc(e,n),Zl(e,i),Sl(this.projectionDeltaWithTransform,this.layoutCorrected,e,i)}}registerSharedNode(t,e){this.sharedNodes.has(t)||this.sharedNodes.set(t,new kc);this.sharedNodes.get(t).add(e);const n=e.options.initialPromotionConfig;e.promote({transition:n?n.transition:void 0,preserveFollowOpacity:n&&n.shouldPreserveFollowOpacity?n.shouldPreserveFollowOpacity(e):void 0})}isLead(){const t=this.getStack();return!t||t.lead===this}getLead(){var t;const{layoutId:e}=this.options;return e&&(null===(t=this.getStack())||void 0===t?void 0:t.lead)||this}getPrevLead(){var t;const{layoutId:e}=this.options;return e?null===(t=this.getStack())||void 0===t?void 0:t.prevLead:void 0}getStack(){const{layoutId:t}=this.options;if(t)return this.root.sharedNodes.get(t)}promote(){let{needsReset:t,transition:e,preserveFollowOpacity:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const r=this.getStack();r&&r.promote(this,n),t&&(this.projectionDelta=void 0,this.needsReset=!0),e&&this.setOptions({transition:e})}relegate(){const t=this.getStack();return!!t&&t.relegate(this)}resetSkewAndRotation(){const{visualElement:t}=this.options;if(!t)return;let e=!1;const{latestValues:n}=t;if((n.z||n.rotate||n.rotateX||n.rotateY||n.rotateZ||n.skewX||n.skewY)&&(e=!0),!e)return;const r={};n.z&&Fc("z",t,r,this.animationValues);for(let i=0;i<Nc.length;i++)Fc("rotate".concat(Nc[i]),t,r,this.animationValues),Fc("skew".concat(Nc[i]),t,r,this.animationValues);t.render();for(const i in r)t.setStaticValue(i,r[i]),this.animationValues&&(this.animationValues[i]=r[i]);t.scheduleRender()}getProjectionStyles(t){var e,n;if(!this.instance||this.isSVG)return;if(!this.isVisible)return Oc;const r={visibility:""},i=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,r.opacity="",r.pointerEvents=Ui(null===t||void 0===t?void 0:t.pointerEvents)||"",r.transform=i?i(this.latestValues,""):"none",r;const o=this.getLead();if(!this.projectionDelta||!this.layout||!o.target){const e={};return this.options.layoutId&&(e.opacity=void 0!==this.latestValues.opacity?this.latestValues.opacity:1,e.pointerEvents=Ui(null===t||void 0===t?void 0:t.pointerEvents)||""),this.hasProjected&&!Ul(this.latestValues)&&(e.transform=i?i({},""):"none",this.hasProjected=!1),e}const a=o.animationValues||o.latestValues;this.applyTransformsToTarget(),r.transform=Ic(this.projectionDeltaWithTransform,this.treeScale,a),i&&(r.transform=i(a,r.transform));const{x:s,y:l}=this.projectionDelta;r.transformOrigin="".concat(100*s.origin,"% ").concat(100*l.origin,"% 0"),o.animationValues?r.opacity=o===this?null!==(n=null!==(e=a.opacity)&&void 0!==e?e:this.latestValues.opacity)&&void 0!==n?n:1:this.preserveOpacity?this.latestValues.opacity:a.opacityExit:r.opacity=o===this?void 0!==a.opacity?a.opacity:"":void 0!==a.opacityExit?a.opacityExit:0;for(const c in Or){if(void 0===a[c])continue;const{correct:t,applyTo:e}=Or[c],n="none"===r.transform?a[c]:t(a[c],o);if(e){const t=e.length;for(let i=0;i<t;i++)r[e[i]]=n}else r[c]=n}return this.options.layoutId&&(r.pointerEvents=o===this?Ui(null===t||void 0===t?void 0:t.pointerEvents)||"":"none"),r}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach((t=>{var e;return null===(e=t.currentAnimation)||void 0===e?void 0:e.stop()})),this.root.nodes.forEach(Hc),this.root.sharedNodes.clear()}}}function zc(t){t.updateLayout()}function jc(t){var e;const n=(null===(e=t.resumeFrom)||void 0===e?void 0:e.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&n&&t.hasListeners("didUpdate")){const{layoutBox:e,measuredBox:r}=t.layout,{animationType:i}=t.options,o=n.source!==t.layout.source;"size"===i?Ol((t=>{const r=o?n.measuredBox[t]:n.layoutBox[t],i=xl(r);r.min=e[t].min,r.max=r.min+i})):au(i,n.layoutBox,e)&&Ol((r=>{const i=o?n.measuredBox[r]:n.layoutBox[r],a=xl(e[r]);i.max=i.min+a,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[r].max=t.relativeTarget[r].min+a)}));const a=Pl();Sl(a,e,n.layoutBox);const s=Pl();o?Sl(s,t.applyTransform(r,!0),n.measuredBox):Sl(s,e,n.layoutBox);const l=!Mc(a);let c=!1;if(!t.resumeFrom){const r=t.getClosestProjectingParent();if(r&&!r.resumeFrom){const{snapshot:i,layout:o}=r;if(i&&o){const a=Nl();Ml(a,n.layoutBox,i.layoutBox);const s=Nl();Ml(s,e,o.layoutBox),Cc(a,s)||(c=!0),r.options.layoutRoot&&(t.relativeTarget=s,t.relativeTargetOrigin=a,t.relativeParent=r)}}}t.notifyListeners("didUpdate",{layout:e,snapshot:n,delta:s,layoutDelta:a,hasLayoutChanged:l,hasRelativeTargetChanged:c})}else if(t.isLead()){const{onExitComplete:e}=t.options;e&&e()}t.options.transition=void 0}function Vc(t){Lc.totalNodes++,t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=Boolean(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function Wc(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function Gc(t){t.clearSnapshot()}function Hc(t){t.clearMeasurements()}function qc(t){t.isLayoutDirty=!1}function Xc(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function Yc(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function Kc(t){t.resolveTargetDelta()}function Zc(t){t.calcProjection()}function Jc(t){t.resetSkewAndRotation()}function Qc(t){t.removeLeadSnapshot()}function $c(t,e,n){t.translate=ds(e.translate,0,n),t.scale=ds(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function tu(t,e,n,r){t.min=ds(e.min,n.min,r),t.max=ds(e.max,n.max,r)}function eu(t){return t.animationValues&&void 0!==t.animationValues.opacityExit}const nu={duration:.45,ease:[.4,0,.1,1]},ru=t=>"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),iu=ru("applewebkit/")&&!ru("chrome/")?Math.round:ji;function ou(t){t.min=iu(t.min),t.max=iu(t.max)}function au(t,e,n){return"position"===t||"preserve-aspect"===t&&!_l(Ac(e),Ac(n),.2)}const su=Bc({attachResizeListener:(t,e)=>Yi(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),lu={current:void 0},cu=Bc({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!lu.current){const t=new su({});t.mount(window),t.setOptions({layoutScroll:!0}),lu.current=t}return lu.current},resetTransform:(t,e)=>{t.style.transform=void 0!==e?e:"none"},checkIsScrollRoot:t=>Boolean("fixed"===window.getComputedStyle(t).position)}),uu={pan:{Feature:class extends ao{constructor(){super(...arguments),this.removePointerDownListener=ji}onPointerDown(t){this.session=new pl(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:Ql(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:e,onPan:n,onPanEnd:r}=this.node.getProps();return{onSessionStart:nc(t),onStart:nc(e),onMove:n,onEnd:(t,e)=>{delete this.session,r&&Vi.postRender((()=>r(t,e)))}}}mount(){this.removePointerDownListener=Qi(this.node.current,"pointerdown",(t=>this.onPointerDown(t)))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}},drag:{Feature:class extends ao{constructor(t){super(t),this.removeGroupControls=ji,this.removeListeners=ji,this.controls=new tc(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||ji}unmount(){this.removeGroupControls(),this.removeListeners()}},ProjectionNode:cu,MeasureLayout:lc}},hu={current:null},du={current:!1};const pu=new WeakMap,fu=[...Yo,la,ba],mu=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],gu=xr.length;class yu{scrapeMotionValuesFromProps(t,e,n){return{}}constructor(t){let{parent:e,props:n,presenceContext:r,reducedMotionConfig:i,blockInitialAnimation:o,visualState:a}=t,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.resolveKeyframes=(t,e,n,r)=>new this.KeyframeResolver(t,e,n,r,this),this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=ea,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>Vi.render(this.render,!1,!0);const{latestValues:l,renderState:c}=a;this.latestValues=l,this.baseTarget={...l},this.initialValues=n.initial?{...l}:{},this.renderState=c,this.parent=e,this.props=n,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=s,this.blockInitialAnimation=Boolean(o),this.isControllingVariants=_r(n),this.isVariantNode=wr(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=Boolean(e&&e.current);const{willChange:u,...h}=this.scrapeMotionValuesFromProps(n,{},this);for(const d in h){const t=h[d];void 0!==l[d]&&Ur(t)&&(t.set(l[d],!1),Hs(u)&&u.add(d))}}mount(t){this.current=t,pu.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach(((t,e)=>this.bindToMotionValue(e,t))),du.current||function(){if(du.current=!0,Qn)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>hu.current=t.matches;t.addListener(e),e()}else hu.current=!1}(),this.shouldReduceMotion="never"!==this.reducedMotionConfig&&("always"===this.reducedMotionConfig||hu.current),this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){pu.delete(this.current),this.projection&&this.projection.unmount(),Wi(this.notifyUpdate),Wi(this.render),this.valueSubscriptions.forEach((t=>t())),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const e=this.features[t];e&&(e.unmount(),e.isMounted=!1)}this.current=null}bindToMotionValue(t,e){const n=Lr.has(t),r=e.on("change",(e=>{this.latestValues[t]=e,this.props.onUpdate&&Vi.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0)})),i=e.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(t,(()=>{r(),i(),e.owner&&e.stop()}))}sortNodePosition(t){return this.current&&this.sortInstanceNodePosition&&this.type===t.type?this.sortInstanceNodePosition(this.current,t.current):0}updateFeatures(){let t="animation";for(t in Mr){const e=Mr[t];if(!e)continue;const{isEnabled:n,Feature:r}=e;if(!this.features[t]&&r&&n(this.props)&&(this.features[t]=new r(this)),this.features[t]){const e=this.features[t];e.isMounted?e.update():(e.mount(),e.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Nl()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,e){this.latestValues[t]=e}update(t,e){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=e;for(let n=0;n<mu.length;n++){const e=mu[n];this.propEventSubscriptions[e]&&(this.propEventSubscriptions[e](),delete this.propEventSubscriptions[e]);const r=t["on"+e];r&&(this.propEventSubscriptions[e]=this.on(e,r))}this.prevMotionValues=function(t,e,n){const{willChange:r}=e;for(const i in e){const o=e[i],a=n[i];if(Ur(o))t.addValue(i,o),Hs(r)&&r.add(i);else if(Ur(a))t.addValue(i,Js(o,{owner:t})),Hs(r)&&r.remove(i);else if(a!==o)if(t.hasValue(i)){const e=t.getValue(i);!0===e.liveStyle?e.jump(o):e.hasAnimated||e.set(o)}else{const e=t.getStaticValue(i);t.addValue(i,Js(void 0!==e?e:o,{owner:t}))}}for(const i in n)void 0===e[i]&&t.removeValue(i);return e}(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0])return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const t=this.parent&&this.parent.getVariantContext()||{};return void 0!==this.props.initial&&(t.initial=this.props.initial),t}const t={};for(let e=0;e<gu;e++){const n=xr[e],r=this.props[n];(yr(r)||!1===r)&&(t[n]=r)}return t}addVariantChild(t){const e=this.getClosestVariantNode();if(e)return e.variantChildren&&e.variantChildren.add(t),()=>e.variantChildren.delete(t)}addValue(t,e){const n=this.values.get(t);e!==n&&(n&&this.removeValue(t),this.bindToMotionValue(t,e),this.values.set(t,e),this.latestValues[t]=e.get())}removeValue(t){this.values.delete(t);const e=this.valueSubscriptions.get(t);e&&(e(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,e){if(this.props.values&&this.props.values[t])return this.props.values[t];let n=this.values.get(t);return void 0===n&&void 0!==e&&(n=Js(null===e?void 0:e,{owner:this}),this.addValue(t,n)),n}readValue(t,e){var n;let r=void 0===this.latestValues[t]&&this.current?null!==(n=this.getBaseTargetFromProps(this.props,t))&&void 0!==n?n:this.readValueFromInstance(this.current,t,this.options):this.latestValues[t];return void 0!==r&&null!==r&&("string"===typeof r&&(Fo(r)||No(r))?r=parseFloat(r):!(t=>fu.find(Xo(t)))(r)&&ba.test(e)&&(r=Ma(t,e)),this.setBaseTarget(t,Ur(r)?r.get():r)),Ur(r)?r.get():r}setBaseTarget(t,e){this.baseTarget[t]=e}getBaseTarget(t){var e;const{initial:n}=this.props;let r;if("string"===typeof n||"object"===typeof n){const i=Oi(this.props,n,null===(e=this.presenceContext)||void 0===e?void 0:e.custom);i&&(r=i[t])}if(n&&void 0!==r)return r;const i=this.getBaseTargetFromProps(this.props,t);return void 0===i||Ur(i)?void 0!==this.initialValues[t]&&void 0===r?void 0:this.baseTarget[t]:i}on(t,e){return this.events[t]||(this.events[t]=new Ys),this.events[t].add(e)}notify(t){if(this.events[t]){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];this.events[t].notify(...n)}}}class vu extends yu{constructor(){super(...arguments),this.KeyframeResolver=Aa}sortInstanceNodePosition(t,e){return 2&t.compareDocumentPosition(e)?1:-1}getBaseTargetFromProps(t,e){return t.style?t.style[e]:void 0}removeValueFromRenderState(t,e){let{vars:n,style:r}=e;delete n[t],delete r[t]}}class bu extends vu{constructor(){super(...arguments),this.type="html"}readValueFromInstance(t,e){if(Lr.has(e)){const t=Ea(e);return t&&t.default||0}{const r=(n=t,window.getComputedStyle(n)),i=(Vr(e)?r.getPropertyValue(e):r[e])||0;return"string"===typeof i?i.trim():i}var n}measureInstanceViewportBox(t,e){let{transformPagePoint:n}=e;return Jl(t,n)}build(t,e,n,r){hi(t,e,n,r.transformTemplate)}scrapeMotionValuesFromProps(t,e,n){return Ri(t,e,n)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;Ur(t)&&(this.childSubscription=t.on("change",(t=>{this.current&&(this.current.textContent="".concat(t))})))}renderInstance(t,e,n,r){Ai(t,e,n,r)}}class xu extends vu{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(t,e){return t[e]}readValueFromInstance(t,e){if(Lr.has(e)){const t=Ea(e);return t&&t.default||0}return e=ki.has(e)?e:er(e),t.getAttribute(e)}measureInstanceViewportBox(){return Nl()}scrapeMotionValuesFromProps(t,e,n){return Pi(t,e,n)}build(t,e,n,r){Si(t,e,n,this.isSVGTag,r.transformTemplate)}renderInstance(t,e,n,r){Ii(t,e,0,r)}mount(t){this.isSVGTag=Ei(t.tagName),super.mount(t)}}const _u=(t,e)=>Nr(t)?new xu(e,{enableHardwareAcceleration:!1}):new bu(e,{allowProjection:t!==k.Fragment,enableHardwareAcceleration:!0}),wu={...hl,...yo,...uu,...{layout:{ProjectionNode:cu,MeasureLayout:lc}}},Su=Rr(((t,e)=>function(t,e,n,r){let{forwardMotionProps:i=!1}=e;return{...Nr(t)?qi:Xi,preloadedFeatures:n,useRender:Ci(i),createVisualElement:r,Component:t}}(t,e,wu,_u)));const Tu="165",Eu={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Mu={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},Cu=0,Au=1,ku=2,Iu=3,Ru=0,Pu=1,Nu=2,Ou=3,Du=0,Lu=1,Fu=2,Uu=0,Bu=1,zu=2,ju=3,Vu=4,Wu=5,Gu=100,Hu=101,qu=102,Xu=103,Yu=104,Ku=200,Zu=201,Ju=202,Qu=203,$u=204,th=205,eh=206,nh=207,rh=208,ih=209,oh=210,ah=211,sh=212,lh=213,ch=214,uh=0,hh=1,dh=2,ph=3,fh=4,mh=5,gh=6,yh=7,vh=0,bh=1,xh=2,_h=0,wh=1,Sh=2,Th=3,Eh=4,Mh=5,Ch=6,Ah=7,kh="attached",Ih="detached",Rh=300,Ph=301,Nh=302,Oh=303,Dh=304,Lh=306,Fh=1e3,Uh=1001,Bh=1002,zh=1003,jh=1004,Vh=1004,Wh=1005,Gh=1005,Hh=1006,qh=1007,Xh=1007,Yh=1008,Kh=1008,Zh=1009,Jh=1010,Qh=1011,$h=1012,td=1013,ed=1014,nd=1015,rd=1016,id=1017,od=1018,ad=1020,sd=35902,ld=1021,cd=1022,ud=1023,hd=1024,dd=1025,pd=1026,fd=1027,md=1028,gd=1029,yd=1030,vd=1031,bd=1033,xd=33776,_d=33777,wd=33778,Sd=33779,Td=35840,Ed=35841,Md=35842,Cd=35843,Ad=36196,kd=37492,Id=37496,Rd=37808,Pd=37809,Nd=37810,Od=37811,Dd=37812,Ld=37813,Fd=37814,Ud=37815,Bd=37816,zd=37817,jd=37818,Vd=37819,Wd=37820,Gd=37821,Hd=36492,qd=36494,Xd=36495,Yd=36283,Kd=36284,Zd=36285,Jd=36286,Qd=2200,$d=2201,tp=2202,ep=2300,np=2301,rp=2302,ip=2400,op=2401,ap=2402,sp=2500,lp=2501,cp=0,up=1,hp=2,dp=3200,pp=3201,fp=0,mp=1,gp="",yp="srgb",vp="srgb-linear",bp="display-p3",xp="display-p3-linear",_p="linear",wp="srgb",Sp="rec709",Tp="p3",Ep=0,Mp=7680,Cp=7681,Ap=7682,kp=7683,Ip=34055,Rp=34056,Pp=5386,Np=512,Op=513,Dp=514,Lp=515,Fp=516,Up=517,Bp=518,zp=519,jp=512,Vp=513,Wp=514,Gp=515,Hp=516,qp=517,Xp=518,Yp=519,Kp=35044,Zp=35048,Jp=35040,Qp=35045,$p=35049,tf=35041,ef=35046,nf=35050,rf=35042,of="100",af="300 es",sf=2e3,lf=2001;class cf{addEventListener(t,e){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)}hasEventListener(t,e){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(e)}removeEventListener(t,e){if(void 0===this._listeners)return;const n=this._listeners[t];if(void 0!==n){const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}dispatchEvent(t){if(void 0===this._listeners)return;const e=this._listeners[t.type];if(void 0!==e){t.target=this;const n=e.slice(0);for(let e=0,r=n.length;e<r;e++)n[e].call(this,t);t.target=null}}}const uf=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let hf=1234567;const df=Math.PI/180,pf=180/Math.PI;function ff(){const t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(uf[255&t]+uf[t>>8&255]+uf[t>>16&255]+uf[t>>24&255]+"-"+uf[255&e]+uf[e>>8&255]+"-"+uf[e>>16&15|64]+uf[e>>24&255]+"-"+uf[63&n|128]+uf[n>>8&255]+"-"+uf[n>>16&255]+uf[n>>24&255]+uf[255&r]+uf[r>>8&255]+uf[r>>16&255]+uf[r>>24&255]).toLowerCase()}function mf(t,e,n){return Math.max(e,Math.min(n,t))}function gf(t,e){return(t%e+e)%e}function yf(t,e,n){return(1-n)*t+n*e}function vf(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return t/4294967295;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int32Array:return Math.max(t/2147483647,-1);case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function bf(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return Math.round(4294967295*t);case Uint16Array:return Math.round(65535*t);case Uint8Array:return Math.round(255*t);case Int32Array:return Math.round(2147483647*t);case Int16Array:return Math.round(32767*t);case Int8Array:return Math.round(127*t);default:throw new Error("Invalid component type.")}}const xf={DEG2RAD:df,RAD2DEG:pf,generateUUID:ff,clamp:mf,euclideanModulo:gf,mapLinear:function(t,e,n,r,i){return r+(t-e)*(i-r)/(n-e)},inverseLerp:function(t,e,n){return t!==e?(n-t)/(e-t):0},lerp:yf,damp:function(t,e,n,r){return yf(t,e,1-Math.exp(-n*r))},pingpong:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return e-Math.abs(gf(t,2*e)-e)},smoothstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*(3-2*t)},smootherstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},seededRandom:function(t){void 0!==t&&(hf=t);let e=hf+=1831565813;return e=Math.imul(e^e>>>15,1|e),e^=e+Math.imul(e^e>>>7,61|e),((e^e>>>14)>>>0)/4294967296},degToRad:function(t){return t*df},radToDeg:function(t){return t*pf},isPowerOfTwo:function(t){return 0===(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,e,n,r,i){const o=Math.cos,a=Math.sin,s=o(n/2),l=a(n/2),c=o((e+r)/2),u=a((e+r)/2),h=o((e-r)/2),d=a((e-r)/2),p=o((r-e)/2),f=a((r-e)/2);switch(i){case"XYX":t.set(s*u,l*h,l*d,s*c);break;case"YZY":t.set(l*d,s*u,l*h,s*c);break;case"ZXZ":t.set(l*h,l*d,s*u,s*c);break;case"XZX":t.set(s*u,l*f,l*p,s*c);break;case"YXY":t.set(l*p,s*u,l*f,s*c);break;case"ZYZ":t.set(l*f,l*p,s*u,s*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}},normalize:bf,denormalize:vf};class _f{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;_f.prototype.isVector2=!0,this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const e=this.x,n=this.y,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6],this.y=r[1]*e+r[4]*n+r[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;const n=this.dot(t)/e;return Math.acos(mf(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y;return e*e+n*n}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=t[e],this.y=t[e+1],this}toArray(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){const n=Math.cos(e),r=Math.sin(e),i=this.x-t.x,o=this.y-t.y;return this.x=i*n-o*r+t.x,this.y=i*r+o*n+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class wf{constructor(t,e,n,r,i,o,a,s,l){wf.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==t&&this.set(t,e,n,r,i,o,a,s,l)}set(t,e,n,r,i,o,a,s,l){const c=this.elements;return c[0]=t,c[1]=r,c[2]=a,c[3]=e,c[4]=i,c[5]=s,c[6]=n,c[7]=o,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this}extractBasis(t,e,n){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,r=e.elements,i=this.elements,o=n[0],a=n[3],s=n[6],l=n[1],c=n[4],u=n[7],h=n[2],d=n[5],p=n[8],f=r[0],m=r[3],g=r[6],y=r[1],v=r[4],b=r[7],x=r[2],_=r[5],w=r[8];return i[0]=o*f+a*y+s*x,i[3]=o*m+a*v+s*_,i[6]=o*g+a*b+s*w,i[1]=l*f+c*y+u*x,i[4]=l*m+c*v+u*_,i[7]=l*g+c*b+u*w,i[2]=h*f+d*y+p*x,i[5]=h*m+d*v+p*_,i[8]=h*g+d*b+p*w,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],l=t[7],c=t[8];return e*o*c-e*a*l-n*i*c+n*a*s+r*i*l-r*o*s}invert(){const t=this.elements,e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],l=t[7],c=t[8],u=c*o-a*l,h=a*s-c*i,d=l*i-o*s,p=e*u+n*h+r*d;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const f=1/p;return t[0]=u*f,t[1]=(r*l-c*n)*f,t[2]=(a*n-r*o)*f,t[3]=h*f,t[4]=(c*e-r*s)*f,t[5]=(r*i-a*e)*f,t[6]=d*f,t[7]=(n*s-l*e)*f,t[8]=(o*e-n*i)*f,this}transpose(){let t;const e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,n,r,i,o,a){const s=Math.cos(i),l=Math.sin(i);return this.set(n*s,n*l,-n*(s*o+l*a)+o+t,-r*l,r*s,-r*(-l*o+s*a)+a+e,0,0,1),this}scale(t,e){return this.premultiply(Sf.makeScale(t,e)),this}rotate(t){return this.premultiply(Sf.makeRotation(-t)),this}translate(t,e){return this.premultiply(Sf.makeTranslation(t,e)),this}makeTranslation(t,e){return t.isVector2?this.set(1,0,t.x,0,1,t.y,0,0,1):this.set(1,0,t,0,1,e,0,0,1),this}makeRotation(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,n,e,0,0,0,1),this}makeScale(t,e){return this.set(t,0,0,0,e,0,0,0,1),this}equals(t){const e=this.elements,n=t.elements;for(let r=0;r<9;r++)if(e[r]!==n[r])return!1;return!0}fromArray(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<9;n++)this.elements[n]=t[n+e];return this}toArray(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}clone(){return(new this.constructor).fromArray(this.elements)}}const Sf=new wf;function Tf(t){for(let e=t.length-1;e>=0;--e)if(t[e]>=65535)return!0;return!1}const Ef={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function Mf(t,e){return new Ef[t](e)}function Cf(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}function Af(){const t=Cf("canvas");return t.style.display="block",t}const kf={};function If(t){t in kf||(kf[t]=!0,console.warn(t))}const Rf=(new wf).set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),Pf=(new wf).set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),Nf={[vp]:{transfer:_p,primaries:Sp,toReference:t=>t,fromReference:t=>t},[yp]:{transfer:wp,primaries:Sp,toReference:t=>t.convertSRGBToLinear(),fromReference:t=>t.convertLinearToSRGB()},[xp]:{transfer:_p,primaries:Tp,toReference:t=>t.applyMatrix3(Pf),fromReference:t=>t.applyMatrix3(Rf)},[bp]:{transfer:wp,primaries:Tp,toReference:t=>t.convertSRGBToLinear().applyMatrix3(Pf),fromReference:t=>t.applyMatrix3(Rf).convertLinearToSRGB()}},Of=new Set([vp,xp]),Df={enabled:!0,_workingColorSpace:vp,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(t){if(!Of.has(t))throw new Error('Unsupported working color space, "'.concat(t,'".'));this._workingColorSpace=t},convert:function(t,e,n){if(!1===this.enabled||e===n||!e||!n)return t;const r=Nf[e].toReference;return(0,Nf[n].fromReference)(r(t))},fromWorkingColorSpace:function(t,e){return this.convert(t,this._workingColorSpace,e)},toWorkingColorSpace:function(t,e){return this.convert(t,e,this._workingColorSpace)},getPrimaries:function(t){return Nf[t].primaries},getTransfer:function(t){return t===gp?_p:Nf[t].transfer}};function Lf(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function Ff(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}let Uf;class Bf{static getDataURL(t){if(/^data:/i.test(t.src))return t.src;if("undefined"===typeof HTMLCanvasElement)return t.src;let e;if(t instanceof HTMLCanvasElement)e=t;else{void 0===Uf&&(Uf=Cf("canvas")),Uf.width=t.width,Uf.height=t.height;const n=Uf.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height),e=Uf}return e.width>2048||e.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",t),e.toDataURL("image/jpeg",.6)):e.toDataURL("image/png")}static sRGBToLinear(t){if("undefined"!==typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&t instanceof ImageBitmap){const e=Cf("canvas");e.width=t.width,e.height=t.height;const n=e.getContext("2d");n.drawImage(t,0,0,t.width,t.height);const r=n.getImageData(0,0,t.width,t.height),i=r.data;for(let t=0;t<i.length;t++)i[t]=255*Lf(i[t]/255);return n.putImageData(r,0,0),e}if(t.data){const e=t.data.slice(0);for(let t=0;t<e.length;t++)e instanceof Uint8Array||e instanceof Uint8ClampedArray?e[t]=Math.floor(255*Lf(e[t]/255)):e[t]=Lf(e[t]);return{data:e,width:t.width,height:t.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),t}}let zf=0;class jf{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.isSource=!0,Object.defineProperty(this,"id",{value:zf++}),this.uuid=ff(),this.data=t,this.dataReady=!0,this.version=0}set needsUpdate(t){!0===t&&this.version++}toJSON(t){const e=void 0===t||"string"===typeof t;if(!e&&void 0!==t.images[this.uuid])return t.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(null!==r){let t;if(Array.isArray(r)){t=[];for(let e=0,n=r.length;e<n;e++)r[e].isDataTexture?t.push(Vf(r[e].image)):t.push(Vf(r[e]))}else t=Vf(r);n.url=t}return e||(t.images[this.uuid]=n),n}}function Vf(t){return"undefined"!==typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&t instanceof ImageBitmap?Bf.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Wf=0;class Gf extends cf{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Gf.DEFAULT_IMAGE,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Gf.DEFAULT_MAPPING,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Uh,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Uh,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Hh,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Yh,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:ud,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:Zh,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:Gf.DEFAULT_ANISOTROPY,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:gp;super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Wf++}),this.uuid=ff(),this.name="",this.source=new jf(t),this.mipmaps=[],this.mapping=e,this.channel=0,this.wrapS=n,this.wrapT=r,this.magFilter=i,this.minFilter=o,this.anisotropy=l,this.format=a,this.internalFormat=null,this.type=s,this.offset=new _f(0,0),this.repeat=new _f(1,1),this.center=new _f(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new wf,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(t){void 0===t&&(t=null),this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const e=void 0===t||"string"===typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const n={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),e||(t.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==Rh)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case Fh:t.x=t.x-Math.floor(t.x);break;case Uh:t.x=t.x<0?0:1;break;case Bh:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case Fh:t.y=t.y-Math.floor(t.y);break;case Uh:t.y=t.y<0?0:1;break;case Bh:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(t){!0===t&&this.pmremVersion++}}Gf.DEFAULT_IMAGE=null,Gf.DEFAULT_MAPPING=Rh,Gf.DEFAULT_ANISOTROPY=1;class Hf{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;Hf.prototype.isVector4=!0,this.x=t,this.y=e,this.z=n,this.w=r}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,e,n,r){return this.x=t,this.y=e,this.z=n,this.w=r,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const e=this.x,n=this.y,r=this.z,i=this.w,o=t.elements;return this.x=o[0]*e+o[4]*n+o[8]*r+o[12]*i,this.y=o[1]*e+o[5]*n+o[9]*r+o[13]*i,this.z=o[2]*e+o[6]*n+o[10]*r+o[14]*i,this.w=o[3]*e+o[7]*n+o[11]*r+o[15]*i,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this}setAxisAngleFromRotationMatrix(t){let e,n,r,i;const o=.01,a=.1,s=t.elements,l=s[0],c=s[4],u=s[8],h=s[1],d=s[5],p=s[9],f=s[2],m=s[6],g=s[10];if(Math.abs(c-h)<o&&Math.abs(u-f)<o&&Math.abs(p-m)<o){if(Math.abs(c+h)<a&&Math.abs(u+f)<a&&Math.abs(p+m)<a&&Math.abs(l+d+g-3)<a)return this.set(1,0,0,0),this;e=Math.PI;const t=(l+1)/2,s=(d+1)/2,y=(g+1)/2,v=(c+h)/4,b=(u+f)/4,x=(p+m)/4;return t>s&&t>y?t<o?(n=0,r=.707106781,i=.707106781):(n=Math.sqrt(t),r=v/n,i=b/n):s>y?s<o?(n=.707106781,r=0,i=.707106781):(r=Math.sqrt(s),n=v/r,i=x/r):y<o?(n=.707106781,r=.707106781,i=0):(i=Math.sqrt(y),n=b/i,r=x/i),this.set(n,r,i,e),this}let y=Math.sqrt((m-p)*(m-p)+(u-f)*(u-f)+(h-c)*(h-c));return Math.abs(y)<.001&&(y=1),this.x=(m-p)/y,this.y=(u-f)/y,this.z=(h-c)/y,this.w=Math.acos((l+d+g-1)/2),this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this.w=t.w+(e.w-t.w)*n,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this}toArray(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class qf extends cf{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super(),this.isRenderTarget=!0,this.width=t,this.height=e,this.depth=1,this.scissor=new Hf(0,0,t,e),this.scissorTest=!1,this.viewport=new Hf(0,0,t,e);const r={width:t,height:e,depth:1};n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Hh,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},n);const i=new Gf(r,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace);i.flipY=!1,i.generateMipmaps=n.generateMipmaps,i.internalFormat=n.internalFormat,this.textures=[];const o=n.count;for(let a=0;a<o;a++)this.textures[a]=i.clone(),this.textures[a].isRenderTargetTexture=!0;this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this.depthTexture=n.depthTexture,this.samples=n.samples}get texture(){return this.textures[0]}set texture(t){this.textures[0]=t}setSize(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(this.width!==t||this.height!==e||this.depth!==n){this.width=t,this.height=e,this.depth=n;for(let r=0,i=this.textures.length;r<i;r++)this.textures[r].image.width=t,this.textures[r].image.height=e,this.textures[r].image.depth=n;this.dispose()}this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)}clone(){return(new this.constructor).copy(this)}copy(t){this.width=t.width,this.height=t.height,this.depth=t.depth,this.scissor.copy(t.scissor),this.scissorTest=t.scissorTest,this.viewport.copy(t.viewport),this.textures.length=0;for(let n=0,r=t.textures.length;n<r;n++)this.textures[n]=t.textures[n].clone(),this.textures[n].isRenderTargetTexture=!0;const e=Object.assign({},t.texture.image);return this.texture.source=new jf(e),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.resolveDepthBuffer=t.resolveDepthBuffer,this.resolveStencilBuffer=t.resolveStencilBuffer,null!==t.depthTexture&&(this.depthTexture=t.depthTexture.clone()),this.samples=t.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Xf extends qf{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}),this.isWebGLRenderTarget=!0}}class Yf extends Gf{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(null),this.isDataArrayTexture=!0,this.image={data:t,width:e,height:n,depth:r},this.magFilter=zh,this.minFilter=zh,this.wrapR=Uh,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(t){this.layerUpdates.add(t)}clearLayerUpdates(){this.layerUpdates.clear()}}class Kf extends Xf{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;super(t,e,arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new Yf(null,t,e,n),this.texture.isRenderTargetTexture=!0}}class Zf extends Gf{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(null),this.isData3DTexture=!0,this.image={data:t,width:e,height:n,depth:r},this.magFilter=zh,this.minFilter=zh,this.wrapR=Uh,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Jf extends Xf{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;super(t,e,arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new Zf(null,t,e,n),this.texture.isRenderTargetTexture=!0}}class Qf{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this.isQuaternion=!0,this._x=t,this._y=e,this._z=n,this._w=r}static slerpFlat(t,e,n,r,i,o,a){let s=n[r+0],l=n[r+1],c=n[r+2],u=n[r+3];const h=i[o+0],d=i[o+1],p=i[o+2],f=i[o+3];if(0===a)return t[e+0]=s,t[e+1]=l,t[e+2]=c,void(t[e+3]=u);if(1===a)return t[e+0]=h,t[e+1]=d,t[e+2]=p,void(t[e+3]=f);if(u!==f||s!==h||l!==d||c!==p){let t=1-a;const e=s*h+l*d+c*p+u*f,n=e>=0?1:-1,r=1-e*e;if(r>Number.EPSILON){const i=Math.sqrt(r),o=Math.atan2(i,e*n);t=Math.sin(t*o)/i,a=Math.sin(a*o)/i}const i=a*n;if(s=s*t+h*i,l=l*t+d*i,c=c*t+p*i,u=u*t+f*i,t===1-a){const t=1/Math.sqrt(s*s+l*l+c*c+u*u);s*=t,l*=t,c*=t,u*=t}}t[e]=s,t[e+1]=l,t[e+2]=c,t[e+3]=u}static multiplyQuaternionsFlat(t,e,n,r,i,o){const a=n[r],s=n[r+1],l=n[r+2],c=n[r+3],u=i[o],h=i[o+1],d=i[o+2],p=i[o+3];return t[e]=a*p+c*u+s*d-l*h,t[e+1]=s*p+c*h+l*u-a*d,t[e+2]=l*p+c*d+a*h-s*u,t[e+3]=c*p-a*u-s*h-l*d,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=t._x,r=t._y,i=t._z,o=t._order,a=Math.cos,s=Math.sin,l=a(n/2),c=a(r/2),u=a(i/2),h=s(n/2),d=s(r/2),p=s(i/2);switch(o){case"XYZ":this._x=h*c*u+l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u-h*d*p;break;case"YXZ":this._x=h*c*u+l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u+h*d*p;break;case"ZXY":this._x=h*c*u-l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u-h*d*p;break;case"ZYX":this._x=h*c*u-l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u+h*d*p;break;case"YZX":this._x=h*c*u+l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u-h*d*p;break;case"XZY":this._x=h*c*u-l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u+h*d*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return!0===e&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const n=e/2,r=Math.sin(n);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,n=e[0],r=e[4],i=e[8],o=e[1],a=e[5],s=e[9],l=e[2],c=e[6],u=e[10],h=n+a+u;if(h>0){const t=.5/Math.sqrt(h+1);this._w=.25/t,this._x=(c-s)*t,this._y=(i-l)*t,this._z=(o-r)*t}else if(n>a&&n>u){const t=2*Math.sqrt(1+n-a-u);this._w=(c-s)/t,this._x=.25*t,this._y=(r+o)/t,this._z=(i+l)/t}else if(a>u){const t=2*Math.sqrt(1+a-n-u);this._w=(i-l)/t,this._x=(r+o)/t,this._y=.25*t,this._z=(s+c)/t}else{const t=2*Math.sqrt(1+u-n-a);this._w=(o-r)/t,this._x=(i+l)/t,this._y=(s+c)/t,this._z=.25*t}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let n=t.dot(e)+1;return n<Number.EPSILON?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(mf(this.dot(t),-1,1)))}rotateTowards(t,e){const n=this.angleTo(t);if(0===n)return this;const r=Math.min(1,e/n);return this.slerp(t,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t){return this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const n=t._x,r=t._y,i=t._z,o=t._w,a=e._x,s=e._y,l=e._z,c=e._w;return this._x=n*c+o*a+r*l-i*s,this._y=r*c+o*s+i*a-n*l,this._z=i*c+o*l+n*s-r*a,this._w=o*c-n*a-r*s-i*l,this._onChangeCallback(),this}slerp(t,e){if(0===e)return this;if(1===e)return this.copy(t);const n=this._x,r=this._y,i=this._z,o=this._w;let a=o*t._w+n*t._x+r*t._y+i*t._z;if(a<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),a>=1)return this._w=o,this._x=n,this._y=r,this._z=i,this;const s=1-a*a;if(s<=Number.EPSILON){const t=1-e;return this._w=t*o+e*this._w,this._x=t*n+e*this._x,this._y=t*r+e*this._y,this._z=t*i+e*this._z,this.normalize(),this}const l=Math.sqrt(s),c=Math.atan2(l,a),u=Math.sin((1-e)*c)/l,h=Math.sin(e*c)/l;return this._w=o*u+this._w*h,this._x=n*u+this._x*h,this._y=r*u+this._y*h,this._z=i*u+this._z*h,this._onChangeCallback(),this}slerpQuaternions(t,e,n){return this.copy(t).slerp(e,n)}random(){const t=2*Math.PI*Math.random(),e=2*Math.PI*Math.random(),n=Math.random(),r=Math.sqrt(1-n),i=Math.sqrt(n);return this.set(r*Math.sin(t),r*Math.cos(t),i*Math.sin(e),i*Math.cos(e))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class $f{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;$f.prototype.isVector3=!0,this.x=t,this.y=e,this.z=n}set(t,e,n){return void 0===n&&(n=this.z),this.x=t,this.y=e,this.z=n,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return this.applyQuaternion(em.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(em.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[3]*n+i[6]*r,this.y=i[1]*e+i[4]*n+i[7]*r,this.z=i[2]*e+i[5]*n+i[8]*r,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,n=this.y,r=this.z,i=t.elements,o=1/(i[3]*e+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*e+i[4]*n+i[8]*r+i[12])*o,this.y=(i[1]*e+i[5]*n+i[9]*r+i[13])*o,this.z=(i[2]*e+i[6]*n+i[10]*r+i[14])*o,this}applyQuaternion(t){const e=this.x,n=this.y,r=this.z,i=t.x,o=t.y,a=t.z,s=t.w,l=2*(o*r-a*n),c=2*(a*e-i*r),u=2*(i*n-o*e);return this.x=e+s*l+o*u-a*c,this.y=n+s*c+a*l-i*u,this.z=r+s*u+i*c-o*l,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[4]*n+i[8]*r,this.y=i[1]*e+i[5]*n+i[9]*r,this.z=i[2]*e+i[6]*n+i[10]*r,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this}cross(t){return this.crossVectors(this,t)}crossVectors(t,e){const n=t.x,r=t.y,i=t.z,o=e.x,a=e.y,s=e.z;return this.x=r*s-i*a,this.y=i*o-n*s,this.z=n*a-r*o,this}projectOnVector(t){const e=t.lengthSq();if(0===e)return this.set(0,0,0);const n=t.dot(this)/e;return this.copy(t).multiplyScalar(n)}projectOnPlane(t){return tm.copy(this).projectOnVector(t),this.sub(tm)}reflect(t){return this.sub(tm.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;const n=this.dot(t)/e;return Math.acos(mf(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y,r=this.z-t.z;return e*e+n*n+r*r}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,n){const r=Math.sin(e)*t;return this.x=r*Math.sin(n),this.y=Math.cos(e)*t,this.z=r*Math.cos(n),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),r=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=r,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,4*e)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,3*e)}setFromEuler(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}setFromColor(t){return this.x=t.r,this.y=t.g,this.z=t.b,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=Math.random()*Math.PI*2,e=2*Math.random()-1,n=Math.sqrt(1-e*e);return this.x=n*Math.cos(t),this.y=e,this.z=n*Math.sin(t),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const tm=new $f,em=new Qf;class nm{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new $f(1/0,1/0,1/0),e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new $f(-1/0,-1/0,-1/0);this.isBox3=!0,this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e+=3)this.expandByPoint(im.fromArray(t,e));return this}setFromBufferAttribute(t){this.makeEmpty();for(let e=0,n=t.count;e<n;e++)this.expandByPoint(im.fromBufferAttribute(t,e));return this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const n=im.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}setFromObject(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.makeEmpty(),this.expandByObject(t,e)}clone(){return(new this.constructor).copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t.updateWorldMatrix(!1,!1);const n=t.geometry;if(void 0!==n){const r=n.getAttribute("position");if(!0===e&&void 0!==r&&!0!==t.isInstancedMesh)for(let e=0,n=r.count;e<n;e++)!0===t.isMesh?t.getVertexPosition(e,im):im.fromBufferAttribute(r,e),im.applyMatrix4(t.matrixWorld),this.expandByPoint(im);else void 0!==t.boundingBox?(null===t.boundingBox&&t.computeBoundingBox(),om.copy(t.boundingBox)):(null===n.boundingBox&&n.computeBoundingBox(),om.copy(n.boundingBox)),om.applyMatrix4(t.matrixWorld),this.union(om)}const r=t.children;for(let i=0,o=r.length;i<o;i++)this.expandByObject(r[i],e);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,im),im.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=-t.constant&&n>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(dm),pm.subVectors(this.max,dm),am.subVectors(t.a,dm),sm.subVectors(t.b,dm),lm.subVectors(t.c,dm),cm.subVectors(sm,am),um.subVectors(lm,sm),hm.subVectors(am,lm);let e=[0,-cm.z,cm.y,0,-um.z,um.y,0,-hm.z,hm.y,cm.z,0,-cm.x,um.z,0,-um.x,hm.z,0,-hm.x,-cm.y,cm.x,0,-um.y,um.x,0,-hm.y,hm.x,0];return!!gm(e,am,sm,lm,pm)&&(e=[1,0,0,0,1,0,0,0,1],!!gm(e,am,sm,lm,pm)&&(fm.crossVectors(cm,um),e=[fm.x,fm.y,fm.z],gm(e,am,sm,lm,pm)))}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return this.clampPoint(t,im).distanceTo(t)}getBoundingSphere(t){return this.isEmpty()?t.makeEmpty():(this.getCenter(t.center),t.radius=.5*this.getSize(im).length()),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()||(rm[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),rm[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),rm[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),rm[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),rm[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),rm[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),rm[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),rm[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(rm)),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}const rm=[new $f,new $f,new $f,new $f,new $f,new $f,new $f,new $f],im=new $f,om=new nm,am=new $f,sm=new $f,lm=new $f,cm=new $f,um=new $f,hm=new $f,dm=new $f,pm=new $f,fm=new $f,mm=new $f;function gm(t,e,n,r,i){for(let o=0,a=t.length-3;o<=a;o+=3){mm.fromArray(t,o);const a=i.x*Math.abs(mm.x)+i.y*Math.abs(mm.y)+i.z*Math.abs(mm.z),s=e.dot(mm),l=n.dot(mm),c=r.dot(mm);if(Math.max(-Math.max(s,l,c),Math.min(s,l,c))>a)return!1}return!0}const ym=new nm,vm=new $f,bm=new $f;class xm{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new $f,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;this.isSphere=!0,this.center=t,this.radius=e}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){const n=this.center;void 0!==e?n.copy(e):ym.setFromPoints(t).getCenter(n);let r=0;for(let i=0,o=t.length;i<o;i++)r=Math.max(r,n.distanceToSquared(t[i]));return this.radius=Math.sqrt(r),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){const n=this.center.distanceToSquared(t);return e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){if(this.isEmpty())return this.center.copy(t),this.radius=0,this;vm.subVectors(t,this.center);const e=vm.lengthSq();if(e>this.radius*this.radius){const t=Math.sqrt(e),n=.5*(t-this.radius);this.center.addScaledVector(vm,n/t),this.radius+=n}return this}union(t){return t.isEmpty()?this:this.isEmpty()?(this.copy(t),this):(!0===this.center.equals(t.center)?this.radius=Math.max(this.radius,t.radius):(bm.subVectors(t.center,this.center).setLength(t.radius),this.expandByPoint(vm.copy(t.center).add(bm)),this.expandByPoint(vm.copy(t.center).sub(bm))),this)}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const _m=new $f,wm=new $f,Sm=new $f,Tm=new $f,Em=new $f,Mm=new $f,Cm=new $f;class Am{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new $f,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new $f(0,0,-1);this.origin=t,this.direction=e}set(t,e){return this.origin.copy(t),this.direction.copy(e),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,e){return e.copy(this.origin).addScaledVector(this.direction,t)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,_m)),this}closestPointToPoint(t,e){e.subVectors(t,this.origin);const n=e.dot(this.direction);return n<0?e.copy(this.origin):e.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const e=_m.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(_m.copy(this.origin).addScaledVector(this.direction,e),_m.distanceToSquared(t))}distanceSqToSegment(t,e,n,r){wm.copy(t).add(e).multiplyScalar(.5),Sm.copy(e).sub(t).normalize(),Tm.copy(this.origin).sub(wm);const i=.5*t.distanceTo(e),o=-this.direction.dot(Sm),a=Tm.dot(this.direction),s=-Tm.dot(Sm),l=Tm.lengthSq(),c=Math.abs(1-o*o);let u,h,d,p;if(c>0)if(u=o*s-a,h=o*a-s,p=i*c,u>=0)if(h>=-p)if(h<=p){const t=1/c;u*=t,h*=t,d=u*(u+o*h+2*a)+h*(o*u+h+2*s)+l}else h=i,u=Math.max(0,-(o*h+a)),d=-u*u+h*(h+2*s)+l;else h=-i,u=Math.max(0,-(o*h+a)),d=-u*u+h*(h+2*s)+l;else h<=-p?(u=Math.max(0,-(-o*i+a)),h=u>0?-i:Math.min(Math.max(-i,-s),i),d=-u*u+h*(h+2*s)+l):h<=p?(u=0,h=Math.min(Math.max(-i,-s),i),d=h*(h+2*s)+l):(u=Math.max(0,-(o*i+a)),h=u>0?i:Math.min(Math.max(-i,-s),i),d=-u*u+h*(h+2*s)+l);else h=o>0?-i:i,u=Math.max(0,-(o*h+a)),d=-u*u+h*(h+2*s)+l;return n&&n.copy(this.origin).addScaledVector(this.direction,u),r&&r.copy(wm).addScaledVector(Sm,h),d}intersectSphere(t,e){_m.subVectors(t.center,this.origin);const n=_m.dot(this.direction),r=_m.dot(_m)-n*n,i=t.radius*t.radius;if(r>i)return null;const o=Math.sqrt(i-r),a=n-o,s=n+o;return s<0?null:a<0?this.at(s,e):this.at(a,e)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null}intersectPlane(t,e){const n=this.distanceToPlane(t);return null===n?null:this.at(n,e)}intersectsPlane(t){const e=t.distanceToPoint(this.origin);if(0===e)return!0;return t.normal.dot(this.direction)*e<0}intersectBox(t,e){let n,r,i,o,a,s;const l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,h=this.origin;return l>=0?(n=(t.min.x-h.x)*l,r=(t.max.x-h.x)*l):(n=(t.max.x-h.x)*l,r=(t.min.x-h.x)*l),c>=0?(i=(t.min.y-h.y)*c,o=(t.max.y-h.y)*c):(i=(t.max.y-h.y)*c,o=(t.min.y-h.y)*c),n>o||i>r?null:((i>n||isNaN(n))&&(n=i),(o<r||isNaN(r))&&(r=o),u>=0?(a=(t.min.z-h.z)*u,s=(t.max.z-h.z)*u):(a=(t.max.z-h.z)*u,s=(t.min.z-h.z)*u),n>s||a>r?null:((a>n||n!==n)&&(n=a),(s<r||r!==r)&&(r=s),r<0?null:this.at(n>=0?n:r,e)))}intersectsBox(t){return null!==this.intersectBox(t,_m)}intersectTriangle(t,e,n,r,i){Em.subVectors(e,t),Mm.subVectors(n,t),Cm.crossVectors(Em,Mm);let o,a=this.direction.dot(Cm);if(a>0){if(r)return null;o=1}else{if(!(a<0))return null;o=-1,a=-a}Tm.subVectors(this.origin,t);const s=o*this.direction.dot(Mm.crossVectors(Tm,Mm));if(s<0)return null;const l=o*this.direction.dot(Em.cross(Tm));if(l<0)return null;if(s+l>a)return null;const c=-o*Tm.dot(Cm);return c<0?null:this.at(c/a,i)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class km{constructor(t,e,n,r,i,o,a,s,l,c,u,h,d,p,f,m){km.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==t&&this.set(t,e,n,r,i,o,a,s,l,c,u,h,d,p,f,m)}set(t,e,n,r,i,o,a,s,l,c,u,h,d,p,f,m){const g=this.elements;return g[0]=t,g[4]=e,g[8]=n,g[12]=r,g[1]=i,g[5]=o,g[9]=a,g[13]=s,g[2]=l,g[6]=c,g[10]=u,g[14]=h,g[3]=d,g[7]=p,g[11]=f,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new km).fromArray(this.elements)}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this}copyPosition(t){const e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this}setFromMatrix3(t){const e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this}extractRotation(t){const e=this.elements,n=t.elements,r=1/Im.setFromMatrixColumn(t,0).length(),i=1/Im.setFromMatrixColumn(t,1).length(),o=1/Im.setFromMatrixColumn(t,2).length();return e[0]=n[0]*r,e[1]=n[1]*r,e[2]=n[2]*r,e[3]=0,e[4]=n[4]*i,e[5]=n[5]*i,e[6]=n[6]*i,e[7]=0,e[8]=n[8]*o,e[9]=n[9]*o,e[10]=n[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){const e=this.elements,n=t.x,r=t.y,i=t.z,o=Math.cos(n),a=Math.sin(n),s=Math.cos(r),l=Math.sin(r),c=Math.cos(i),u=Math.sin(i);if("XYZ"===t.order){const t=o*c,n=o*u,r=a*c,i=a*u;e[0]=s*c,e[4]=-s*u,e[8]=l,e[1]=n+r*l,e[5]=t-i*l,e[9]=-a*s,e[2]=i-t*l,e[6]=r+n*l,e[10]=o*s}else if("YXZ"===t.order){const t=s*c,n=s*u,r=l*c,i=l*u;e[0]=t+i*a,e[4]=r*a-n,e[8]=o*l,e[1]=o*u,e[5]=o*c,e[9]=-a,e[2]=n*a-r,e[6]=i+t*a,e[10]=o*s}else if("ZXY"===t.order){const t=s*c,n=s*u,r=l*c,i=l*u;e[0]=t-i*a,e[4]=-o*u,e[8]=r+n*a,e[1]=n+r*a,e[5]=o*c,e[9]=i-t*a,e[2]=-o*l,e[6]=a,e[10]=o*s}else if("ZYX"===t.order){const t=o*c,n=o*u,r=a*c,i=a*u;e[0]=s*c,e[4]=r*l-n,e[8]=t*l+i,e[1]=s*u,e[5]=i*l+t,e[9]=n*l-r,e[2]=-l,e[6]=a*s,e[10]=o*s}else if("YZX"===t.order){const t=o*s,n=o*l,r=a*s,i=a*l;e[0]=s*c,e[4]=i-t*u,e[8]=r*u+n,e[1]=u,e[5]=o*c,e[9]=-a*c,e[2]=-l*c,e[6]=n*u+r,e[10]=t-i*u}else if("XZY"===t.order){const t=o*s,n=o*l,r=a*s,i=a*l;e[0]=s*c,e[4]=-u,e[8]=l*c,e[1]=t*u+i,e[5]=o*c,e[9]=n*u-r,e[2]=r*u-n,e[6]=a*c,e[10]=i*u+t}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(Pm,t,Nm)}lookAt(t,e,n){const r=this.elements;return Lm.subVectors(t,e),0===Lm.lengthSq()&&(Lm.z=1),Lm.normalize(),Om.crossVectors(n,Lm),0===Om.lengthSq()&&(1===Math.abs(n.z)?Lm.x+=1e-4:Lm.z+=1e-4,Lm.normalize(),Om.crossVectors(n,Lm)),Om.normalize(),Dm.crossVectors(Lm,Om),r[0]=Om.x,r[4]=Dm.x,r[8]=Lm.x,r[1]=Om.y,r[5]=Dm.y,r[9]=Lm.y,r[2]=Om.z,r[6]=Dm.z,r[10]=Lm.z,this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,r=e.elements,i=this.elements,o=n[0],a=n[4],s=n[8],l=n[12],c=n[1],u=n[5],h=n[9],d=n[13],p=n[2],f=n[6],m=n[10],g=n[14],y=n[3],v=n[7],b=n[11],x=n[15],_=r[0],w=r[4],S=r[8],T=r[12],E=r[1],M=r[5],C=r[9],A=r[13],k=r[2],I=r[6],R=r[10],P=r[14],N=r[3],O=r[7],D=r[11],L=r[15];return i[0]=o*_+a*E+s*k+l*N,i[4]=o*w+a*M+s*I+l*O,i[8]=o*S+a*C+s*R+l*D,i[12]=o*T+a*A+s*P+l*L,i[1]=c*_+u*E+h*k+d*N,i[5]=c*w+u*M+h*I+d*O,i[9]=c*S+u*C+h*R+d*D,i[13]=c*T+u*A+h*P+d*L,i[2]=p*_+f*E+m*k+g*N,i[6]=p*w+f*M+m*I+g*O,i[10]=p*S+f*C+m*R+g*D,i[14]=p*T+f*A+m*P+g*L,i[3]=y*_+v*E+b*k+x*N,i[7]=y*w+v*M+b*I+x*O,i[11]=y*S+v*C+b*R+x*D,i[15]=y*T+v*A+b*P+x*L,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[4],r=t[8],i=t[12],o=t[1],a=t[5],s=t[9],l=t[13],c=t[2],u=t[6],h=t[10],d=t[14];return t[3]*(+i*s*u-r*l*u-i*a*h+n*l*h+r*a*d-n*s*d)+t[7]*(+e*s*d-e*l*h+i*o*h-r*o*d+r*l*c-i*s*c)+t[11]*(+e*l*u-e*a*d-i*o*u+n*o*d+i*a*c-n*l*c)+t[15]*(-r*a*c-e*s*u+e*a*h+r*o*u-n*o*h+n*s*c)}transpose(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,n){const r=this.elements;return t.isVector3?(r[12]=t.x,r[13]=t.y,r[14]=t.z):(r[12]=t,r[13]=e,r[14]=n),this}invert(){const t=this.elements,e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],l=t[7],c=t[8],u=t[9],h=t[10],d=t[11],p=t[12],f=t[13],m=t[14],g=t[15],y=u*m*l-f*h*l+f*s*d-a*m*d-u*s*g+a*h*g,v=p*h*l-c*m*l-p*s*d+o*m*d+c*s*g-o*h*g,b=c*f*l-p*u*l+p*a*d-o*f*d-c*a*g+o*u*g,x=p*u*s-c*f*s-p*a*h+o*f*h+c*a*m-o*u*m,_=e*y+n*v+r*b+i*x;if(0===_)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const w=1/_;return t[0]=y*w,t[1]=(f*h*i-u*m*i-f*r*d+n*m*d+u*r*g-n*h*g)*w,t[2]=(a*m*i-f*s*i+f*r*l-n*m*l-a*r*g+n*s*g)*w,t[3]=(u*s*i-a*h*i-u*r*l+n*h*l+a*r*d-n*s*d)*w,t[4]=v*w,t[5]=(c*m*i-p*h*i+p*r*d-e*m*d-c*r*g+e*h*g)*w,t[6]=(p*s*i-o*m*i-p*r*l+e*m*l+o*r*g-e*s*g)*w,t[7]=(o*h*i-c*s*i+c*r*l-e*h*l-o*r*d+e*s*d)*w,t[8]=b*w,t[9]=(p*u*i-c*f*i-p*n*d+e*f*d+c*n*g-e*u*g)*w,t[10]=(o*f*i-p*a*i+p*n*l-e*f*l-o*n*g+e*a*g)*w,t[11]=(c*a*i-o*u*i-c*n*l+e*u*l+o*n*d-e*a*d)*w,t[12]=x*w,t[13]=(c*f*r-p*u*r+p*n*h-e*f*h-c*n*m+e*u*m)*w,t[14]=(p*a*r-o*f*r-p*n*s+e*f*s+o*n*m-e*a*m)*w,t[15]=(o*u*r-c*a*r+c*n*s-e*u*s-o*n*h+e*a*h)*w,this}scale(t){const e=this.elements,n=t.x,r=t.y,i=t.z;return e[0]*=n,e[4]*=r,e[8]*=i,e[1]*=n,e[5]*=r,e[9]*=i,e[2]*=n,e[6]*=r,e[10]*=i,e[3]*=n,e[7]*=r,e[11]*=i,this}getMaxScaleOnAxis(){const t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],r=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,r))}makeTranslation(t,e,n){return t.isVector3?this.set(1,0,0,t.x,0,1,0,t.y,0,0,1,t.z,0,0,0,1):this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this}makeRotationX(t){const e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this}makeRotationY(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this}makeRotationZ(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){const n=Math.cos(e),r=Math.sin(e),i=1-n,o=t.x,a=t.y,s=t.z,l=i*o,c=i*a;return this.set(l*o+n,l*a-r*s,l*s+r*a,0,l*a+r*s,c*a+n,c*s-r*o,0,l*s-r*a,c*s+r*o,i*s*s+n,0,0,0,0,1),this}makeScale(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this}makeShear(t,e,n,r,i,o){return this.set(1,n,i,0,t,1,o,0,e,r,1,0,0,0,0,1),this}compose(t,e,n){const r=this.elements,i=e._x,o=e._y,a=e._z,s=e._w,l=i+i,c=o+o,u=a+a,h=i*l,d=i*c,p=i*u,f=o*c,m=o*u,g=a*u,y=s*l,v=s*c,b=s*u,x=n.x,_=n.y,w=n.z;return r[0]=(1-(f+g))*x,r[1]=(d+b)*x,r[2]=(p-v)*x,r[3]=0,r[4]=(d-b)*_,r[5]=(1-(h+g))*_,r[6]=(m+y)*_,r[7]=0,r[8]=(p+v)*w,r[9]=(m-y)*w,r[10]=(1-(h+f))*w,r[11]=0,r[12]=t.x,r[13]=t.y,r[14]=t.z,r[15]=1,this}decompose(t,e,n){const r=this.elements;let i=Im.set(r[0],r[1],r[2]).length();const o=Im.set(r[4],r[5],r[6]).length(),a=Im.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),t.x=r[12],t.y=r[13],t.z=r[14],Rm.copy(this);const s=1/i,l=1/o,c=1/a;return Rm.elements[0]*=s,Rm.elements[1]*=s,Rm.elements[2]*=s,Rm.elements[4]*=l,Rm.elements[5]*=l,Rm.elements[6]*=l,Rm.elements[8]*=c,Rm.elements[9]*=c,Rm.elements[10]*=c,e.setFromRotationMatrix(Rm),n.x=i,n.y=o,n.z=a,this}makePerspective(t,e,n,r,i,o){let a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:sf;const s=this.elements,l=2*i/(e-t),c=2*i/(n-r),u=(e+t)/(e-t),h=(n+r)/(n-r);let d,p;if(a===sf)d=-(o+i)/(o-i),p=-2*o*i/(o-i);else{if(a!==lf)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);d=-o/(o-i),p=-o*i/(o-i)}return s[0]=l,s[4]=0,s[8]=u,s[12]=0,s[1]=0,s[5]=c,s[9]=h,s[13]=0,s[2]=0,s[6]=0,s[10]=d,s[14]=p,s[3]=0,s[7]=0,s[11]=-1,s[15]=0,this}makeOrthographic(t,e,n,r,i,o){let a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:sf;const s=this.elements,l=1/(e-t),c=1/(n-r),u=1/(o-i),h=(e+t)*l,d=(n+r)*c;let p,f;if(a===sf)p=(o+i)*u,f=-2*u;else{if(a!==lf)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);p=i*u,f=-1*u}return s[0]=2*l,s[4]=0,s[8]=0,s[12]=-h,s[1]=0,s[5]=2*c,s[9]=0,s[13]=-d,s[2]=0,s[6]=0,s[10]=f,s[14]=-p,s[3]=0,s[7]=0,s[11]=0,s[15]=1,this}equals(t){const e=this.elements,n=t.elements;for(let r=0;r<16;r++)if(e[r]!==n[r])return!1;return!0}fromArray(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<16;n++)this.elements[n]=t[n+e];return this}toArray(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}}const Im=new $f,Rm=new km,Pm=new $f(0,0,0),Nm=new $f(1,1,1),Om=new $f,Dm=new $f,Lm=new $f,Fm=new km,Um=new Qf;class Bm{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Bm.DEFAULT_ORDER;this.isEuler=!0,this._x=t,this._y=e,this._z=n,this._order=r}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this._order;return this._x=t,this._y=e,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=t.elements,i=r[0],o=r[4],a=r[8],s=r[1],l=r[5],c=r[9],u=r[2],h=r[6],d=r[10];switch(e){case"XYZ":this._y=Math.asin(mf(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-o,i)):(this._x=Math.atan2(h,l),this._z=0);break;case"YXZ":this._x=Math.asin(-mf(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(a,d),this._z=Math.atan2(s,l)):(this._y=Math.atan2(-u,i),this._z=0);break;case"ZXY":this._x=Math.asin(mf(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-u,d),this._z=Math.atan2(-o,l)):(this._y=0,this._z=Math.atan2(s,i));break;case"ZYX":this._y=Math.asin(-mf(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(h,d),this._z=Math.atan2(s,i)):(this._x=0,this._z=Math.atan2(-o,l));break;case"YZX":this._z=Math.asin(mf(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-u,i)):(this._x=0,this._y=Math.atan2(a,d));break;case"XZY":this._z=Math.asin(-mf(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(h,l),this._y=Math.atan2(a,i)):(this._x=Math.atan2(-c,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,!0===n&&this._onChangeCallback(),this}setFromQuaternion(t,e,n){return Fm.makeRotationFromQuaternion(t),this.setFromRotationMatrix(Fm,e,n)}setFromVector3(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order;return this.set(t.x,t.y,t.z,e)}reorder(t){return Um.setFromEuler(this),this.setFromQuaternion(Um,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Bm.DEFAULT_ORDER="XYZ";class zm{constructor(){this.mask=1}set(t){this.mask=1<<t>>>0}enable(t){this.mask|=1<<t}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t}disable(t){this.mask&=~(1<<t)}disableAll(){this.mask=0}test(t){return 0!==(this.mask&t.mask)}isEnabled(t){return 0!==(this.mask&1<<t)}}let jm=0;const Vm=new $f,Wm=new Qf,Gm=new km,Hm=new $f,qm=new $f,Xm=new $f,Ym=new Qf,Km=new $f(1,0,0),Zm=new $f(0,1,0),Jm=new $f(0,0,1),Qm={type:"added"},$m={type:"removed"},tg={type:"childadded",child:null},eg={type:"childremoved",child:null};class ng extends cf{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:jm++}),this.uuid=ff(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=ng.DEFAULT_UP.clone();const t=new $f,e=new Bm,n=new Qf,r=new $f(1,1,1);e._onChange((function(){n.setFromEuler(e,!1)})),n._onChange((function(){e.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new km},normalMatrix:{value:new wf}}),this.matrix=new km,this.matrixWorld=new km,this.matrixAutoUpdate=ng.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=ng.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new zm,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,e){this.quaternion.setFromAxisAngle(t,e)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,e){return Wm.setFromAxisAngle(t,e),this.quaternion.multiply(Wm),this}rotateOnWorldAxis(t,e){return Wm.setFromAxisAngle(t,e),this.quaternion.premultiply(Wm),this}rotateX(t){return this.rotateOnAxis(Km,t)}rotateY(t){return this.rotateOnAxis(Zm,t)}rotateZ(t){return this.rotateOnAxis(Jm,t)}translateOnAxis(t,e){return Vm.copy(t).applyQuaternion(this.quaternion),this.position.add(Vm.multiplyScalar(e)),this}translateX(t){return this.translateOnAxis(Km,t)}translateY(t){return this.translateOnAxis(Zm,t)}translateZ(t){return this.translateOnAxis(Jm,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(Gm.copy(this.matrixWorld).invert())}lookAt(t,e,n){t.isVector3?Hm.copy(t):Hm.set(t,e,n);const r=this.parent;this.updateWorldMatrix(!0,!1),qm.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Gm.lookAt(qm,Hm,this.up):Gm.lookAt(Hm,qm,this.up),this.quaternion.setFromRotationMatrix(Gm),r&&(Gm.extractRotation(r.matrixWorld),Wm.setFromRotationMatrix(Gm),this.quaternion.premultiply(Wm.invert()))}add(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.removeFromParent(),t.parent=this,this.children.push(t),t.dispatchEvent(Qm),tg.child=t,this.dispatchEvent(tg),tg.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}const e=this.children.indexOf(t);return-1!==e&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent($m),eg.child=t,this.dispatchEvent(eg),eg.child=null),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),Gm.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),Gm.multiply(t.parent.matrixWorld)),t.applyMatrix4(Gm),t.removeFromParent(),t.parent=this,this.children.push(t),t.updateWorldMatrix(!1,!0),t.dispatchEvent(Qm),tg.child=t,this.dispatchEvent(tg),tg.child=null,this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,e){if(this[t]===e)return this;for(let n=0,r=this.children.length;n<r;n++){const r=this.children[n].getObjectByProperty(t,e);if(void 0!==r)return r}}getObjectsByProperty(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this[t]===e&&n.push(this);const r=this.children;for(let i=0,o=r.length;i<o;i++)r[i].getObjectsByProperty(t,e,n);return n}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(qm,t,Xm),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(qm,Ym,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()}raycast(){}traverse(t){t(this);const e=this.children;for(let n=0,r=e.length;n<r;n++)e[n].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const e=this.children;for(let n=0,r=e.length;n<r;n++)e[n].traverseVisible(t)}traverseAncestors(t){const e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const e=this.children;for(let n=0,r=e.length;n<r;n++){const r=e[n];!0!==r.matrixWorldAutoUpdate&&!0!==t||r.updateMatrixWorld(t)}}updateWorldMatrix(t,e){const n=this.parent;if(!0===t&&null!==n&&!0===n.matrixWorldAutoUpdate&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===e){const t=this.children;for(let e=0,n=t.length;e<n;e++){const n=t[e];!0===n.matrixWorldAutoUpdate&&n.updateWorldMatrix(!1,!0)}}}toJSON(t){const e=void 0===t||"string"===typeof t,n={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const r={};function i(e,n){return void 0===e[n.uuid]&&(e[n.uuid]=n.toJSON(t)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.visibility=this._visibility,r.active=this._active,r.bounds=this._bounds.map((t=>({boxInitialized:t.boxInitialized,boxMin:t.box.min.toArray(),boxMax:t.box.max.toArray(),sphereInitialized:t.sphereInitialized,sphereRadius:t.sphere.radius,sphereCenter:t.sphere.center.toArray()}))),r.maxGeometryCount=this._maxGeometryCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.geometryCount=this._geometryCount,r.matricesTexture=this._matricesTexture.toJSON(t),null!==this._colorsTexture&&(r.colorsTexture=this._colorsTexture.toJSON(t)),null!==this.boundingSphere&&(r.boundingSphere={center:r.boundingSphere.center.toArray(),radius:r.boundingSphere.radius}),null!==this.boundingBox&&(r.boundingBox={min:r.boundingBox.min.toArray(),max:r.boundingBox.max.toArray()})),this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(r.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=i(t.geometries,this.geometry);const e=this.geometry.parameters;if(void 0!==e&&void 0!==e.shapes){const n=e.shapes;if(Array.isArray(n))for(let e=0,r=n.length;e<r;e++){const r=n[e];i(t.shapes,r)}else i(t.shapes,n)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(i(t.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const e=[];for(let n=0,r=this.material.length;n<r;n++)e.push(i(t.materials,this.material[n]));r.material=e}else r.material=i(t.materials,this.material);if(this.children.length>0){r.children=[];for(let e=0;e<this.children.length;e++)r.children.push(this.children[e].toJSON(t).object)}if(this.animations.length>0){r.animations=[];for(let e=0;e<this.animations.length;e++){const n=this.animations[e];r.animations.push(i(t.animations,n))}}if(e){const e=o(t.geometries),r=o(t.materials),i=o(t.textures),a=o(t.images),s=o(t.shapes),l=o(t.skeletons),c=o(t.animations),u=o(t.nodes);e.length>0&&(n.geometries=e),r.length>0&&(n.materials=r),i.length>0&&(n.textures=i),a.length>0&&(n.images=a),s.length>0&&(n.shapes=s),l.length>0&&(n.skeletons=l),c.length>0&&(n.animations=c),u.length>0&&(n.nodes=u)}return n.object=r,n;function o(t){const e=[];for(const n in t){const r=t[n];delete r.metadata,e.push(r)}return e}}clone(t){return(new this.constructor).copy(this,t)}copy(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(let n=0;n<t.children.length;n++){const e=t.children[n];this.add(e.clone())}return this}}ng.DEFAULT_UP=new $f(0,1,0),ng.DEFAULT_MATRIX_AUTO_UPDATE=!0,ng.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const rg=new $f,ig=new $f,og=new $f,ag=new $f,sg=new $f,lg=new $f,cg=new $f,ug=new $f,hg=new $f,dg=new $f;class pg{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new $f,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new $f,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new $f;this.a=t,this.b=e,this.c=n}static getNormal(t,e,n,r){r.subVectors(n,e),rg.subVectors(t,e),r.cross(rg);const i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)}static getBarycoord(t,e,n,r,i){rg.subVectors(r,e),ig.subVectors(n,e),og.subVectors(t,e);const o=rg.dot(rg),a=rg.dot(ig),s=rg.dot(og),l=ig.dot(ig),c=ig.dot(og),u=o*l-a*a;if(0===u)return i.set(0,0,0),null;const h=1/u,d=(l*s-a*c)*h,p=(o*c-a*s)*h;return i.set(1-d-p,p,d)}static containsPoint(t,e,n,r){return null!==this.getBarycoord(t,e,n,r,ag)&&(ag.x>=0&&ag.y>=0&&ag.x+ag.y<=1)}static getInterpolation(t,e,n,r,i,o,a,s){return null===this.getBarycoord(t,e,n,r,ag)?(s.x=0,s.y=0,"z"in s&&(s.z=0),"w"in s&&(s.w=0),null):(s.setScalar(0),s.addScaledVector(i,ag.x),s.addScaledVector(o,ag.y),s.addScaledVector(a,ag.z),s)}static isFrontFacing(t,e,n,r){return rg.subVectors(n,e),ig.subVectors(t,e),rg.cross(ig).dot(r)<0}set(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this}setFromPointsAndIndices(t,e,n,r){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[r]),this}setFromAttributeAndIndices(t,e,n,r){return this.a.fromBufferAttribute(t,e),this.b.fromBufferAttribute(t,n),this.c.fromBufferAttribute(t,r),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return rg.subVectors(this.c,this.b),ig.subVectors(this.a,this.b),.5*rg.cross(ig).length()}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return pg.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,e){return pg.getBarycoord(t,this.a,this.b,this.c,e)}getInterpolation(t,e,n,r,i){return pg.getInterpolation(t,this.a,this.b,this.c,e,n,r,i)}containsPoint(t){return pg.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return pg.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,e){const n=this.a,r=this.b,i=this.c;let o,a;sg.subVectors(r,n),lg.subVectors(i,n),ug.subVectors(t,n);const s=sg.dot(ug),l=lg.dot(ug);if(s<=0&&l<=0)return e.copy(n);hg.subVectors(t,r);const c=sg.dot(hg),u=lg.dot(hg);if(c>=0&&u<=c)return e.copy(r);const h=s*u-c*l;if(h<=0&&s>=0&&c<=0)return o=s/(s-c),e.copy(n).addScaledVector(sg,o);dg.subVectors(t,i);const d=sg.dot(dg),p=lg.dot(dg);if(p>=0&&d<=p)return e.copy(i);const f=d*l-s*p;if(f<=0&&l>=0&&p<=0)return a=l/(l-p),e.copy(n).addScaledVector(lg,a);const m=c*p-d*u;if(m<=0&&u-c>=0&&d-p>=0)return cg.subVectors(i,r),a=(u-c)/(u-c+(d-p)),e.copy(r).addScaledVector(cg,a);const g=1/(m+f+h);return o=f*g,a=h*g,e.copy(n).addScaledVector(sg,o).addScaledVector(lg,a)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}const fg={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},mg={h:0,s:0,l:0},gg={h:0,s:0,l:0};function yg(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+6*(e-t)*(2/3-n):t}class vg{constructor(t,e,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(t,e,n)}set(t,e,n){if(void 0===e&&void 0===n){const e=t;e&&e.isColor?this.copy(e):"number"===typeof e?this.setHex(e):"string"===typeof e&&this.setStyle(e)}else this.setRGB(t,e,n);return this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:yp;return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,Df.toWorkingColorSpace(this,e),this}setRGB(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Df.workingColorSpace;return this.r=t,this.g=e,this.b=n,Df.toWorkingColorSpace(this,r),this}setHSL(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Df.workingColorSpace;if(t=gf(t,1),e=mf(e,0,1),n=mf(n,0,1),0===e)this.r=this.g=this.b=n;else{const r=n<=.5?n*(1+e):n+e-n*e,i=2*n-r;this.r=yg(i,r,t+1/3),this.g=yg(i,r,t),this.b=yg(i,r,t-1/3)}return Df.toWorkingColorSpace(this,r),this}setStyle(t){let e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:yp;function r(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}if(e=/^(\w+)\(([^\)]*)\)/.exec(t)){let i;const o=e[1],a=e[2];switch(o){case"rgb":case"rgba":if(i=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return r(i[4]),this.setRGB(Math.min(255,parseInt(i[1],10))/255,Math.min(255,parseInt(i[2],10))/255,Math.min(255,parseInt(i[3],10))/255,n);if(i=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return r(i[4]),this.setRGB(Math.min(100,parseInt(i[1],10))/100,Math.min(100,parseInt(i[2],10))/100,Math.min(100,parseInt(i[3],10))/100,n);break;case"hsl":case"hsla":if(i=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return r(i[4]),this.setHSL(parseFloat(i[1])/360,parseFloat(i[2])/100,parseFloat(i[3])/100,n);break;default:console.warn("THREE.Color: Unknown color model "+t)}}else if(e=/^\#([A-Fa-f\d]+)$/.exec(t)){const r=e[1],i=r.length;if(3===i)return this.setRGB(parseInt(r.charAt(0),16)/15,parseInt(r.charAt(1),16)/15,parseInt(r.charAt(2),16)/15,n);if(6===i)return this.setHex(parseInt(r,16),n);console.warn("THREE.Color: Invalid hex color "+t)}else if(t&&t.length>0)return this.setColorName(t,n);return this}setColorName(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:yp;const n=fg[t.toLowerCase()];return void 0!==n?this.setHex(n,e):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=Lf(t.r),this.g=Lf(t.g),this.b=Lf(t.b),this}copyLinearToSRGB(t){return this.r=Ff(t.r),this.g=Ff(t.g),this.b=Ff(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:yp;return Df.fromWorkingColorSpace(bg.copy(this),t),65536*Math.round(mf(255*bg.r,0,255))+256*Math.round(mf(255*bg.g,0,255))+Math.round(mf(255*bg.b,0,255))}getHexString(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:yp;return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Df.workingColorSpace;Df.fromWorkingColorSpace(bg.copy(this),e);const n=bg.r,r=bg.g,i=bg.b,o=Math.max(n,r,i),a=Math.min(n,r,i);let s,l;const c=(a+o)/2;if(a===o)s=0,l=0;else{const t=o-a;switch(l=c<=.5?t/(o+a):t/(2-o-a),o){case n:s=(r-i)/t+(r<i?6:0);break;case r:s=(i-n)/t+2;break;case i:s=(n-r)/t+4}s/=6}return t.h=s,t.s=l,t.l=c,t}getRGB(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Df.workingColorSpace;return Df.fromWorkingColorSpace(bg.copy(this),e),t.r=bg.r,t.g=bg.g,t.b=bg.b,t}getStyle(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:yp;Df.fromWorkingColorSpace(bg.copy(this),t);const e=bg.r,n=bg.g,r=bg.b;return t!==yp?"color(".concat(t," ").concat(e.toFixed(3)," ").concat(n.toFixed(3)," ").concat(r.toFixed(3),")"):"rgb(".concat(Math.round(255*e),",").concat(Math.round(255*n),",").concat(Math.round(255*r),")")}offsetHSL(t,e,n){return this.getHSL(mg),this.setHSL(mg.h+t,mg.s+e,mg.l+n)}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}lerpColors(t,e,n){return this.r=t.r+(e.r-t.r)*n,this.g=t.g+(e.g-t.g)*n,this.b=t.b+(e.b-t.b)*n,this}lerpHSL(t,e){this.getHSL(mg),t.getHSL(gg);const n=yf(mg.h,gg.h,e),r=yf(mg.s,gg.s,e),i=yf(mg.l,gg.l,e);return this.setHSL(n,r,i),this}setFromVector3(t){return this.r=t.x,this.g=t.y,this.b=t.z,this}applyMatrix3(t){const e=this.r,n=this.g,r=this.b,i=t.elements;return this.r=i[0]*e+i[3]*n+i[6]*r,this.g=i[1]*e+i[4]*n+i[7]*r,this.b=i[2]*e+i[5]*n+i[8]*r,this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}toArray(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}fromBufferAttribute(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const bg=new vg;vg.NAMES=fg;let xg=0;class _g extends cf{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:xg++}),this.uuid=ff(),this.name="",this.type="Material",this.blending=Bu,this.side=Du,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=$u,this.blendDst=th,this.blendEquation=Gu,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new vg(0,0,0),this.blendAlpha=0,this.depthFunc=ph,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=zp,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Mp,this.stencilZFail=Mp,this.stencilZPass=Mp,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!==t>0&&this.version++,this._alphaTest=t}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(void 0!==t)for(const e in t){const n=t[e];if(void 0===n){console.warn("THREE.Material: parameter '".concat(e,"' has value of undefined."));continue}const r=this[e];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[e]=n:console.warn("THREE.Material: '".concat(e,"' is not a property of THREE.").concat(this.type,"."))}}toJSON(t){const e=void 0===t||"string"===typeof t;e&&(t={textures:{},images:{}});const n={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function r(t){const e=[];for(const n in t){const r=t[n];delete r.metadata,e.push(r)}return e}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),void 0!==this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.dispersion&&(n.dispersion=this.dispersion),void 0!==this.iridescence&&(n.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(n.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(t).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(t).uuid),void 0!==this.anisotropy&&(n.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(t).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(t).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapRotation&&(n.envMapRotation=this.envMapRotation.toArray()),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(t).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(t).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==Bu&&(n.blending=this.blending),this.side!==Du&&(n.side=this.side),!0===this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=!0),this.blendSrc!==$u&&(n.blendSrc=this.blendSrc),this.blendDst!==th&&(n.blendDst=this.blendDst),this.blendEquation!==Gu&&(n.blendEquation=this.blendEquation),null!==this.blendSrcAlpha&&(n.blendSrcAlpha=this.blendSrcAlpha),null!==this.blendDstAlpha&&(n.blendDstAlpha=this.blendDstAlpha),null!==this.blendEquationAlpha&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),0!==this.blendAlpha&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==ph&&(n.depthFunc=this.depthFunc),!1===this.depthTest&&(n.depthTest=this.depthTest),!1===this.depthWrite&&(n.depthWrite=this.depthWrite),!1===this.colorWrite&&(n.colorWrite=this.colorWrite),255!==this.stencilWriteMask&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==zp&&(n.stencilFunc=this.stencilFunc),0!==this.stencilRef&&(n.stencilRef=this.stencilRef),255!==this.stencilFuncMask&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Mp&&(n.stencilFail=this.stencilFail),this.stencilZFail!==Mp&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==Mp&&(n.stencilZPass=this.stencilZPass),!0===this.stencilWrite&&(n.stencilWrite=this.stencilWrite),void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaHash&&(n.alphaHash=!0),!0===this.alphaToCoverage&&(n.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=!0),!0===this.forceSinglePass&&(n.forceSinglePass=!0),!0===this.wireframe&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=!0),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),!1===this.fog&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData),e){const e=r(t.textures),i=r(t.images);e.length>0&&(n.textures=e),i.length>0&&(n.images=i)}return n}clone(){return(new this.constructor).copy(this)}copy(t){this.name=t.name,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.blendColor.copy(t.blendColor),this.blendAlpha=t.blendAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const e=t.clippingPlanes;let n=null;if(null!==e){const t=e.length;n=new Array(t);for(let r=0;r!==t;++r)n[r]=e[r].clone()}return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaHash=t.alphaHash,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.forceSinglePass=t.forceSinglePass,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){!0===t&&this.version++}}class wg extends _g{constructor(t){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new vg(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Bm,this.combine=vh,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapRotation.copy(t.envMapRotation),this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}}const Sg=Tg();function Tg(){const t=new ArrayBuffer(4),e=new Float32Array(t),n=new Uint32Array(t),r=new Uint32Array(512),i=new Uint32Array(512);for(let l=0;l<256;++l){const t=l-127;t<-27?(r[l]=0,r[256|l]=32768,i[l]=24,i[256|l]=24):t<-14?(r[l]=1024>>-t-14,r[256|l]=1024>>-t-14|32768,i[l]=-t-1,i[256|l]=-t-1):t<=15?(r[l]=t+15<<10,r[256|l]=t+15<<10|32768,i[l]=13,i[256|l]=13):t<128?(r[l]=31744,r[256|l]=64512,i[l]=24,i[256|l]=24):(r[l]=31744,r[256|l]=64512,i[l]=13,i[256|l]=13)}const o=new Uint32Array(2048),a=new Uint32Array(64),s=new Uint32Array(64);for(let l=1;l<1024;++l){let t=l<<13,e=0;for(;0===(8388608&t);)t<<=1,e-=8388608;t&=-8388609,e+=947912704,o[l]=t|e}for(let l=1024;l<2048;++l)o[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)a[l]=l<<23;a[31]=1199570944,a[32]=2147483648;for(let l=33;l<63;++l)a[l]=2147483648+(l-32<<23);a[63]=3347054592;for(let l=1;l<64;++l)32!==l&&(s[l]=1024);return{floatView:e,uint32View:n,baseTable:r,shiftTable:i,mantissaTable:o,exponentTable:a,offsetTable:s}}function Eg(t){Math.abs(t)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),t=mf(t,-65504,65504),Sg.floatView[0]=t;const e=Sg.uint32View[0],n=e>>23&511;return Sg.baseTable[n]+((8388607&e)>>Sg.shiftTable[n])}function Mg(t){const e=t>>10;return Sg.uint32View[0]=Sg.mantissaTable[Sg.offsetTable[e]+(1023&t)]+Sg.exponentTable[e],Sg.floatView[0]}const Cg={toHalfFloat:Eg,fromHalfFloat:Mg},Ag=new $f,kg=new _f;class Ig{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=n,this.usage=Kp,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=nd,this.version=0}onUploadCallback(){}set needsUpdate(t){!0===t&&this.version++}get updateRange(){return If("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(t){return this.usage=t,this}addUpdateRange(t,e){this.updateRanges.push({start:t,count:e})}clearUpdateRanges(){this.updateRanges.length=0}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this.gpuType=t.gpuType,this}copyAt(t,e,n){t*=this.itemSize,n*=e.itemSize;for(let r=0,i=this.itemSize;r<i;r++)this.array[t+r]=e.array[n+r];return this}copyArray(t){return this.array.set(t),this}applyMatrix3(t){if(2===this.itemSize)for(let e=0,n=this.count;e<n;e++)kg.fromBufferAttribute(this,e),kg.applyMatrix3(t),this.setXY(e,kg.x,kg.y);else if(3===this.itemSize)for(let e=0,n=this.count;e<n;e++)Ag.fromBufferAttribute(this,e),Ag.applyMatrix3(t),this.setXYZ(e,Ag.x,Ag.y,Ag.z);return this}applyMatrix4(t){for(let e=0,n=this.count;e<n;e++)Ag.fromBufferAttribute(this,e),Ag.applyMatrix4(t),this.setXYZ(e,Ag.x,Ag.y,Ag.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)Ag.fromBufferAttribute(this,e),Ag.applyNormalMatrix(t),this.setXYZ(e,Ag.x,Ag.y,Ag.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)Ag.fromBufferAttribute(this,e),Ag.transformDirection(t),this.setXYZ(e,Ag.x,Ag.y,Ag.z);return this}set(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(t,e),this}getComponent(t,e){let n=this.array[t*this.itemSize+e];return this.normalized&&(n=vf(n,this.array)),n}setComponent(t,e,n){return this.normalized&&(n=bf(n,this.array)),this.array[t*this.itemSize+e]=n,this}getX(t){let e=this.array[t*this.itemSize];return this.normalized&&(e=vf(e,this.array)),e}setX(t,e){return this.normalized&&(e=bf(e,this.array)),this.array[t*this.itemSize]=e,this}getY(t){let e=this.array[t*this.itemSize+1];return this.normalized&&(e=vf(e,this.array)),e}setY(t,e){return this.normalized&&(e=bf(e,this.array)),this.array[t*this.itemSize+1]=e,this}getZ(t){let e=this.array[t*this.itemSize+2];return this.normalized&&(e=vf(e,this.array)),e}setZ(t,e){return this.normalized&&(e=bf(e,this.array)),this.array[t*this.itemSize+2]=e,this}getW(t){let e=this.array[t*this.itemSize+3];return this.normalized&&(e=vf(e,this.array)),e}setW(t,e){return this.normalized&&(e=bf(e,this.array)),this.array[t*this.itemSize+3]=e,this}setXY(t,e,n){return t*=this.itemSize,this.normalized&&(e=bf(e,this.array),n=bf(n,this.array)),this.array[t+0]=e,this.array[t+1]=n,this}setXYZ(t,e,n,r){return t*=this.itemSize,this.normalized&&(e=bf(e,this.array),n=bf(n,this.array),r=bf(r,this.array)),this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this}setXYZW(t,e,n,r,i){return t*=this.itemSize,this.normalized&&(e=bf(e,this.array),n=bf(n,this.array),r=bf(r,this.array),i=bf(i,this.array)),this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this.array[t+3]=i,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(t.name=this.name),this.usage!==Kp&&(t.usage=this.usage),t}}class Rg extends Ig{constructor(t,e,n){super(new Int8Array(t),e,n)}}class Pg extends Ig{constructor(t,e,n){super(new Uint8Array(t),e,n)}}class Ng extends Ig{constructor(t,e,n){super(new Uint8ClampedArray(t),e,n)}}class Og extends Ig{constructor(t,e,n){super(new Int16Array(t),e,n)}}class Dg extends Ig{constructor(t,e,n){super(new Uint16Array(t),e,n)}}class Lg extends Ig{constructor(t,e,n){super(new Int32Array(t),e,n)}}class Fg extends Ig{constructor(t,e,n){super(new Uint32Array(t),e,n)}}class Ug extends Ig{constructor(t,e,n){super(new Uint16Array(t),e,n),this.isFloat16BufferAttribute=!0}getX(t){let e=Mg(this.array[t*this.itemSize]);return this.normalized&&(e=vf(e,this.array)),e}setX(t,e){return this.normalized&&(e=bf(e,this.array)),this.array[t*this.itemSize]=Eg(e),this}getY(t){let e=Mg(this.array[t*this.itemSize+1]);return this.normalized&&(e=vf(e,this.array)),e}setY(t,e){return this.normalized&&(e=bf(e,this.array)),this.array[t*this.itemSize+1]=Eg(e),this}getZ(t){let e=Mg(this.array[t*this.itemSize+2]);return this.normalized&&(e=vf(e,this.array)),e}setZ(t,e){return this.normalized&&(e=bf(e,this.array)),this.array[t*this.itemSize+2]=Eg(e),this}getW(t){let e=Mg(this.array[t*this.itemSize+3]);return this.normalized&&(e=vf(e,this.array)),e}setW(t,e){return this.normalized&&(e=bf(e,this.array)),this.array[t*this.itemSize+3]=Eg(e),this}setXY(t,e,n){return t*=this.itemSize,this.normalized&&(e=bf(e,this.array),n=bf(n,this.array)),this.array[t+0]=Eg(e),this.array[t+1]=Eg(n),this}setXYZ(t,e,n,r){return t*=this.itemSize,this.normalized&&(e=bf(e,this.array),n=bf(n,this.array),r=bf(r,this.array)),this.array[t+0]=Eg(e),this.array[t+1]=Eg(n),this.array[t+2]=Eg(r),this}setXYZW(t,e,n,r,i){return t*=this.itemSize,this.normalized&&(e=bf(e,this.array),n=bf(n,this.array),r=bf(r,this.array),i=bf(i,this.array)),this.array[t+0]=Eg(e),this.array[t+1]=Eg(n),this.array[t+2]=Eg(r),this.array[t+3]=Eg(i),this}}class Bg extends Ig{constructor(t,e,n){super(new Float32Array(t),e,n)}}let zg=0;const jg=new km,Vg=new ng,Wg=new $f,Gg=new nm,Hg=new nm,qg=new $f;class Xg extends cf{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:zg++}),this.uuid=ff(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(Tf(t)?Fg:Dg)(t,1):this.index=t,this}getAttribute(t){return this.attributes[t]}setAttribute(t,e){return this.attributes[t]=e,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return void 0!==this.attributes[t]}addGroup(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.groups.push({start:t,count:e,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(t,e){this.drawRange.start=t,this.drawRange.count=e}applyMatrix4(t){const e=this.attributes.position;void 0!==e&&(e.applyMatrix4(t),e.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const e=(new wf).getNormalMatrix(t);n.applyNormalMatrix(e),n.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(t),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(t){return jg.makeRotationFromQuaternion(t),this.applyMatrix4(jg),this}rotateX(t){return jg.makeRotationX(t),this.applyMatrix4(jg),this}rotateY(t){return jg.makeRotationY(t),this.applyMatrix4(jg),this}rotateZ(t){return jg.makeRotationZ(t),this.applyMatrix4(jg),this}translate(t,e,n){return jg.makeTranslation(t,e,n),this.applyMatrix4(jg),this}scale(t,e,n){return jg.makeScale(t,e,n),this.applyMatrix4(jg),this}lookAt(t){return Vg.lookAt(t),Vg.updateMatrix(),this.applyMatrix4(Vg.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Wg).negate(),this.translate(Wg.x,Wg.y,Wg.z),this}setFromPoints(t){const e=[];for(let n=0,r=t.length;n<r;n++){const r=t[n];e.push(r.x,r.y,r.z||0)}return this.setAttribute("position",new Bg(e,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new nm);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),void this.boundingBox.set(new $f(-1/0,-1/0,-1/0),new $f(1/0,1/0,1/0));if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e)for(let n=0,r=e.length;n<r;n++){const t=e[n];Gg.setFromBufferAttribute(t),this.morphTargetsRelative?(qg.addVectors(this.boundingBox.min,Gg.min),this.boundingBox.expandByPoint(qg),qg.addVectors(this.boundingBox.max,Gg.max),this.boundingBox.expandByPoint(qg)):(this.boundingBox.expandByPoint(Gg.min),this.boundingBox.expandByPoint(Gg.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new xm);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),void this.boundingSphere.set(new $f,1/0);if(t){const n=this.boundingSphere.center;if(Gg.setFromBufferAttribute(t),e)for(let t=0,i=e.length;t<i;t++){const n=e[t];Hg.setFromBufferAttribute(n),this.morphTargetsRelative?(qg.addVectors(Gg.min,Hg.min),Gg.expandByPoint(qg),qg.addVectors(Gg.max,Hg.max),Gg.expandByPoint(qg)):(Gg.expandByPoint(Hg.min),Gg.expandByPoint(Hg.max))}Gg.getCenter(n);let r=0;for(let e=0,i=t.count;e<i;e++)qg.fromBufferAttribute(t,e),r=Math.max(r,n.distanceToSquared(qg));if(e)for(let i=0,o=e.length;i<o;i++){const o=e[i],a=this.morphTargetsRelative;for(let e=0,i=o.count;e<i;e++)qg.fromBufferAttribute(o,e),a&&(Wg.fromBufferAttribute(t,e),qg.add(Wg)),r=Math.max(r,n.distanceToSquared(qg))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const t=this.index,e=this.attributes;if(null===t||void 0===e.position||void 0===e.normal||void 0===e.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=e.position,r=e.normal,i=e.uv;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new Ig(new Float32Array(4*n.count),4));const o=this.getAttribute("tangent"),a=[],s=[];for(let S=0;S<n.count;S++)a[S]=new $f,s[S]=new $f;const l=new $f,c=new $f,u=new $f,h=new _f,d=new _f,p=new _f,f=new $f,m=new $f;function g(t,e,r){l.fromBufferAttribute(n,t),c.fromBufferAttribute(n,e),u.fromBufferAttribute(n,r),h.fromBufferAttribute(i,t),d.fromBufferAttribute(i,e),p.fromBufferAttribute(i,r),c.sub(l),u.sub(l),d.sub(h),p.sub(h);const o=1/(d.x*p.y-p.x*d.y);isFinite(o)&&(f.copy(c).multiplyScalar(p.y).addScaledVector(u,-d.y).multiplyScalar(o),m.copy(u).multiplyScalar(d.x).addScaledVector(c,-p.x).multiplyScalar(o),a[t].add(f),a[e].add(f),a[r].add(f),s[t].add(m),s[e].add(m),s[r].add(m))}let y=this.groups;0===y.length&&(y=[{start:0,count:t.count}]);for(let S=0,T=y.length;S<T;++S){const e=y[S],n=e.start;for(let r=n,i=n+e.count;r<i;r+=3)g(t.getX(r+0),t.getX(r+1),t.getX(r+2))}const v=new $f,b=new $f,x=new $f,_=new $f;function w(t){x.fromBufferAttribute(r,t),_.copy(x);const e=a[t];v.copy(e),v.sub(x.multiplyScalar(x.dot(e))).normalize(),b.crossVectors(_,e);const n=b.dot(s[t])<0?-1:1;o.setXYZW(t,v.x,v.y,v.z,n)}for(let S=0,T=y.length;S<T;++S){const e=y[S],n=e.start;for(let r=n,i=n+e.count;r<i;r+=3)w(t.getX(r+0)),w(t.getX(r+1)),w(t.getX(r+2))}}computeVertexNormals(){const t=this.index,e=this.getAttribute("position");if(void 0!==e){let n=this.getAttribute("normal");if(void 0===n)n=new Ig(new Float32Array(3*e.count),3),this.setAttribute("normal",n);else for(let t=0,e=n.count;t<e;t++)n.setXYZ(t,0,0,0);const r=new $f,i=new $f,o=new $f,a=new $f,s=new $f,l=new $f,c=new $f,u=new $f;if(t)for(let h=0,d=t.count;h<d;h+=3){const d=t.getX(h+0),p=t.getX(h+1),f=t.getX(h+2);r.fromBufferAttribute(e,d),i.fromBufferAttribute(e,p),o.fromBufferAttribute(e,f),c.subVectors(o,i),u.subVectors(r,i),c.cross(u),a.fromBufferAttribute(n,d),s.fromBufferAttribute(n,p),l.fromBufferAttribute(n,f),a.add(c),s.add(c),l.add(c),n.setXYZ(d,a.x,a.y,a.z),n.setXYZ(p,s.x,s.y,s.z),n.setXYZ(f,l.x,l.y,l.z)}else for(let t=0,h=e.count;t<h;t+=3)r.fromBufferAttribute(e,t+0),i.fromBufferAttribute(e,t+1),o.fromBufferAttribute(e,t+2),c.subVectors(o,i),u.subVectors(r,i),c.cross(u),n.setXYZ(t+0,c.x,c.y,c.z),n.setXYZ(t+1,c.x,c.y,c.z),n.setXYZ(t+2,c.x,c.y,c.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const t=this.attributes.normal;for(let e=0,n=t.count;e<n;e++)qg.fromBufferAttribute(t,e),qg.normalize(),t.setXYZ(e,qg.x,qg.y,qg.z)}toNonIndexed(){function t(t,e){const n=t.array,r=t.itemSize,i=t.normalized,o=new n.constructor(e.length*r);let a=0,s=0;for(let l=0,c=e.length;l<c;l++){a=t.isInterleavedBufferAttribute?e[l]*t.data.stride+t.offset:e[l]*r;for(let t=0;t<r;t++)o[s++]=n[a++]}return new Ig(o,r,i)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const e=new Xg,n=this.index.array,r=this.attributes;for(const a in r){const i=t(r[a],n);e.setAttribute(a,i)}const i=this.morphAttributes;for(const a in i){const r=[],o=i[a];for(let e=0,i=o.length;e<i;e++){const i=t(o[e],n);r.push(i)}e.morphAttributes[a]=r}e.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,s=o.length;a<s;a++){const t=o[a];e.addGroup(t.start,t.count,t.materialIndex)}return e}toJSON(){const t={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),void 0!==this.parameters){const e=this.parameters;for(const n in e)void 0!==e[n]&&(t[n]=e[n]);return t}t.data={attributes:{}};const e=this.index;null!==e&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});const n=this.attributes;for(const s in n){const e=n[s];t.data.attributes[s]=e.toJSON(t.data)}const r={};let i=!1;for(const s in this.morphAttributes){const e=this.morphAttributes[s],n=[];for(let r=0,i=e.length;r<i;r++){const i=e[r];n.push(i.toJSON(t.data))}n.length>0&&(r[s]=n,i=!0)}i&&(t.data.morphAttributes=r,t.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(t.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return null!==a&&(t.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),t}clone(){return(new this.constructor).copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const e={};this.name=t.name;const n=t.index;null!==n&&this.setIndex(n.clone(e));const r=t.attributes;for(const l in r){const t=r[l];this.setAttribute(l,t.clone(e))}const i=t.morphAttributes;for(const l in i){const t=[],n=i[l];for(let r=0,i=n.length;r<i;r++)t.push(n[r].clone(e));this.morphAttributes[l]=t}this.morphTargetsRelative=t.morphTargetsRelative;const o=t.groups;for(let l=0,c=o.length;l<c;l++){const t=o[l];this.addGroup(t.start,t.count,t.materialIndex)}const a=t.boundingBox;null!==a&&(this.boundingBox=a.clone());const s=t.boundingSphere;return null!==s&&(this.boundingSphere=s.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const Yg=new km,Kg=new Am,Zg=new xm,Jg=new $f,Qg=new $f,$g=new $f,ty=new $f,ey=new $f,ny=new $f,ry=new _f,iy=new _f,oy=new _f,ay=new $f,sy=new $f,ly=new $f,cy=new $f,uy=new $f;class hy extends ng{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Xg,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new wg;super(),this.isMesh=!0,this.type="Mesh",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=Array.isArray(t.material)?t.material.slice():t.material,this.geometry=t.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,e=Object.keys(t);if(e.length>0){const n=t[e[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,e=n.length;t<e;t++){const e=n[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[e]=t}}}}getVertexPosition(t,e){const n=this.geometry,r=n.attributes.position,i=n.morphAttributes.position,o=n.morphTargetsRelative;e.fromBufferAttribute(r,t);const a=this.morphTargetInfluences;if(i&&a){ny.set(0,0,0);for(let n=0,r=i.length;n<r;n++){const r=a[n],s=i[n];0!==r&&(ey.fromBufferAttribute(s,t),o?ny.addScaledVector(ey,r):ny.addScaledVector(ey.sub(e),r))}e.add(ny)}return e}raycast(t,e){const n=this.geometry,r=this.material,i=this.matrixWorld;if(void 0!==r){if(null===n.boundingSphere&&n.computeBoundingSphere(),Zg.copy(n.boundingSphere),Zg.applyMatrix4(i),Kg.copy(t.ray).recast(t.near),!1===Zg.containsPoint(Kg.origin)){if(null===Kg.intersectSphere(Zg,Jg))return;if(Kg.origin.distanceToSquared(Jg)>(t.far-t.near)**2)return}Yg.copy(i).invert(),Kg.copy(t.ray).applyMatrix4(Yg),null!==n.boundingBox&&!1===Kg.intersectsBox(n.boundingBox)||this._computeIntersections(t,e,Kg)}}_computeIntersections(t,e,n){let r;const i=this.geometry,o=this.material,a=i.index,s=i.attributes.position,l=i.attributes.uv,c=i.attributes.uv1,u=i.attributes.normal,h=i.groups,d=i.drawRange;if(null!==a)if(Array.isArray(o))for(let p=0,f=h.length;p<f;p++){const i=h[p],s=o[i.materialIndex];for(let o=Math.max(i.start,d.start),h=Math.min(a.count,Math.min(i.start+i.count,d.start+d.count));o<h;o+=3){r=dy(this,s,t,n,l,c,u,a.getX(o),a.getX(o+1),a.getX(o+2)),r&&(r.faceIndex=Math.floor(o/3),r.face.materialIndex=i.materialIndex,e.push(r))}}else{for(let i=Math.max(0,d.start),s=Math.min(a.count,d.start+d.count);i<s;i+=3){r=dy(this,o,t,n,l,c,u,a.getX(i),a.getX(i+1),a.getX(i+2)),r&&(r.faceIndex=Math.floor(i/3),e.push(r))}}else if(void 0!==s)if(Array.isArray(o))for(let p=0,f=h.length;p<f;p++){const i=h[p],a=o[i.materialIndex];for(let o=Math.max(i.start,d.start),h=Math.min(s.count,Math.min(i.start+i.count,d.start+d.count));o<h;o+=3){r=dy(this,a,t,n,l,c,u,o,o+1,o+2),r&&(r.faceIndex=Math.floor(o/3),r.face.materialIndex=i.materialIndex,e.push(r))}}else{for(let i=Math.max(0,d.start),a=Math.min(s.count,d.start+d.count);i<a;i+=3){r=dy(this,o,t,n,l,c,u,i,i+1,i+2),r&&(r.faceIndex=Math.floor(i/3),e.push(r))}}}}function dy(t,e,n,r,i,o,a,s,l,c){t.getVertexPosition(s,Qg),t.getVertexPosition(l,$g),t.getVertexPosition(c,ty);const u=function(t,e,n,r,i,o,a,s){let l;if(l=e.side===Lu?r.intersectTriangle(a,o,i,!0,s):r.intersectTriangle(i,o,a,e.side===Du,s),null===l)return null;uy.copy(s),uy.applyMatrix4(t.matrixWorld);const c=n.ray.origin.distanceTo(uy);return c<n.near||c>n.far?null:{distance:c,point:uy.clone(),object:t}}(t,e,n,r,Qg,$g,ty,cy);if(u){i&&(ry.fromBufferAttribute(i,s),iy.fromBufferAttribute(i,l),oy.fromBufferAttribute(i,c),u.uv=pg.getInterpolation(cy,Qg,$g,ty,ry,iy,oy,new _f)),o&&(ry.fromBufferAttribute(o,s),iy.fromBufferAttribute(o,l),oy.fromBufferAttribute(o,c),u.uv1=pg.getInterpolation(cy,Qg,$g,ty,ry,iy,oy,new _f)),a&&(ay.fromBufferAttribute(a,s),sy.fromBufferAttribute(a,l),ly.fromBufferAttribute(a,c),u.normal=pg.getInterpolation(cy,Qg,$g,ty,ay,sy,ly,new $f),u.normal.dot(r.direction)>0&&u.normal.multiplyScalar(-1));const t={a:s,b:l,c:c,normal:new $f,materialIndex:0};pg.getNormal(Qg,$g,ty,t.normal),u.face=t}return u}class py extends Xg{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;super(),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:r,heightSegments:i,depthSegments:o};const a=this;r=Math.floor(r),i=Math.floor(i),o=Math.floor(o);const s=[],l=[],c=[],u=[];let h=0,d=0;function p(t,e,n,r,i,o,p,f,m,g,y){const v=o/m,b=p/g,x=o/2,_=p/2,w=f/2,S=m+1,T=g+1;let E=0,M=0;const C=new $f;for(let a=0;a<T;a++){const o=a*b-_;for(let s=0;s<S;s++){const h=s*v-x;C[t]=h*r,C[e]=o*i,C[n]=w,l.push(C.x,C.y,C.z),C[t]=0,C[e]=0,C[n]=f>0?1:-1,c.push(C.x,C.y,C.z),u.push(s/m),u.push(1-a/g),E+=1}}for(let a=0;a<g;a++)for(let t=0;t<m;t++){const e=h+t+S*a,n=h+t+S*(a+1),r=h+(t+1)+S*(a+1),i=h+(t+1)+S*a;s.push(e,n,i),s.push(n,r,i),M+=6}a.addGroup(d,M,y),d+=M,h+=E}p("z","y","x",-1,-1,n,e,t,o,i,0),p("z","y","x",1,-1,n,e,-t,o,i,1),p("x","z","y",1,1,t,n,e,r,o,2),p("x","z","y",1,-1,t,n,-e,r,o,3),p("x","y","z",1,-1,t,e,n,r,i,4),p("x","y","z",-1,-1,t,e,-n,r,i,5),this.setIndex(s),this.setAttribute("position",new Bg(l,3)),this.setAttribute("normal",new Bg(c,3)),this.setAttribute("uv",new Bg(u,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new py(t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments)}}function fy(t){const e={};for(const n in t){e[n]={};for(const r in t[n]){const i=t[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[n][r]=null):e[n][r]=i.clone():Array.isArray(i)?e[n][r]=i.slice():e[n][r]=i}}return e}function my(t){const e={};for(let n=0;n<t.length;n++){const r=fy(t[n]);for(const t in r)e[t]=r[t]}return e}function gy(t){const e=t.getRenderTarget();return null===e?t.outputColorSpace:!0===e.isXRRenderTarget?e.texture.colorSpace:Df.workingColorSpace}const yy={clone:fy,merge:my};class vy extends _g{constructor(t){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==t&&this.setValues(t)}copy(t){return super.copy(t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=fy(t.uniforms),this.uniformsGroups=function(t){const e=[];for(let n=0;n<t.length;n++)e.push(t[n].clone());return e}(t.uniformsGroups),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.fog=t.fog,this.lights=t.lights,this.clipping=t.clipping,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this}toJSON(t){const e=super.toJSON(t);e.glslVersion=this.glslVersion,e.uniforms={};for(const r in this.uniforms){const n=this.uniforms[r].value;n&&n.isTexture?e.uniforms[r]={type:"t",value:n.toJSON(t).uuid}:n&&n.isColor?e.uniforms[r]={type:"c",value:n.getHex()}:n&&n.isVector2?e.uniforms[r]={type:"v2",value:n.toArray()}:n&&n.isVector3?e.uniforms[r]={type:"v3",value:n.toArray()}:n&&n.isVector4?e.uniforms[r]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?e.uniforms[r]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?e.uniforms[r]={type:"m4",value:n.toArray()}:e.uniforms[r]={value:n}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e.lights=this.lights,e.clipping=this.clipping;const n={};for(const r in this.extensions)!0===this.extensions[r]&&(n[r]=!0);return Object.keys(n).length>0&&(e.extensions=n),e}}class by extends ng{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new km,this.projectionMatrix=new km,this.projectionMatrixInverse=new km,this.coordinateSystem=sf}copy(t,e){return super.copy(t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this.coordinateSystem=t.coordinateSystem,this}getWorldDirection(t){return super.getWorldDirection(t).negate()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,e){super.updateWorldMatrix(t,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}const xy=new $f,_y=new _f,wy=new _f;class Sy extends by{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2e3;super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=e,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this}setFocalLength(t){const e=.5*this.getFilmHeight()/t;this.fov=2*pf*Math.atan(e),this.updateProjectionMatrix()}getFocalLength(){const t=Math.tan(.5*df*this.fov);return.5*this.getFilmHeight()/t}getEffectiveFOV(){return 2*pf*Math.atan(Math.tan(.5*df*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(t,e,n){xy.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),e.set(xy.x,xy.y).multiplyScalar(-t/xy.z),xy.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(xy.x,xy.y).multiplyScalar(-t/xy.z)}getViewSize(t,e){return this.getViewBounds(t,_y,wy),e.subVectors(wy,_y)}setViewOffset(t,e,n,r,i,o){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=this.near;let e=t*Math.tan(.5*df*this.fov)/this.zoom,n=2*e,r=this.aspect*n,i=-.5*r;const o=this.view;if(null!==this.view&&this.view.enabled){const t=o.fullWidth,a=o.fullHeight;i+=o.offsetX*r/t,e-=o.offsetY*n/a,r*=o.width/t,n*=o.height/a}const a=this.filmOffset;0!==a&&(i+=t*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,e,e-n,t,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}const Ty=-90;class Ey extends ng{constructor(t,e,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new Sy(Ty,1,t,e);r.layers=this.layers,this.add(r);const i=new Sy(Ty,1,t,e);i.layers=this.layers,this.add(i);const o=new Sy(Ty,1,t,e);o.layers=this.layers,this.add(o);const a=new Sy(Ty,1,t,e);a.layers=this.layers,this.add(a);const s=new Sy(Ty,1,t,e);s.layers=this.layers,this.add(s);const l=new Sy(Ty,1,t,e);l.layers=this.layers,this.add(l)}updateCoordinateSystem(){const t=this.coordinateSystem,e=this.children.concat(),[n,r,i,o,a,s]=e;for(const l of e)this.remove(l);if(t===sf)n.up.set(0,1,0),n.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),i.up.set(0,0,-1),i.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),s.up.set(0,1,0),s.lookAt(0,0,-1);else{if(t!==lf)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+t);n.up.set(0,-1,0),n.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),i.up.set(0,0,1),i.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),s.up.set(0,-1,0),s.lookAt(0,0,-1)}for(const l of e)this.add(l),l.updateMatrixWorld()}update(t,e){null===this.parent&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:r}=this;this.coordinateSystem!==t.coordinateSystem&&(this.coordinateSystem=t.coordinateSystem,this.updateCoordinateSystem());const[i,o,a,s,l,c]=this.children,u=t.getRenderTarget(),h=t.getActiveCubeFace(),d=t.getActiveMipmapLevel(),p=t.xr.enabled;t.xr.enabled=!1;const f=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,t.setRenderTarget(n,0,r),t.render(e,i),t.setRenderTarget(n,1,r),t.render(e,o),t.setRenderTarget(n,2,r),t.render(e,a),t.setRenderTarget(n,3,r),t.render(e,s),t.setRenderTarget(n,4,r),t.render(e,l),n.texture.generateMipmaps=f,t.setRenderTarget(n,5,r),t.render(e,c),t.setRenderTarget(u,h,d),t.xr.enabled=p,n.texture.needsPMREMUpdate=!0}}class My extends Gf{constructor(t,e,n,r,i,o,a,s,l,c){super(t=void 0!==t?t:[],e=void 0!==e?e:Ph,n,r,i,o,a,s,l,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(t){this.image=t}}class Cy extends Xf{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(t,t,e),this.isWebGLCubeRenderTarget=!0;const n={width:t,height:t,depth:1},r=[n,n,n,n,n,n];this.texture=new My(r,e.mapping,e.wrapS,e.wrapT,e.magFilter,e.minFilter,e.format,e.type,e.anisotropy,e.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==e.generateMipmaps&&e.generateMipmaps,this.texture.minFilter=void 0!==e.minFilter?e.minFilter:Hh}fromEquirectangularTexture(t,e){this.texture.type=e.type,this.texture.colorSpace=e.colorSpace,this.texture.generateMipmaps=e.generateMipmaps,this.texture.minFilter=e.minFilter,this.texture.magFilter=e.magFilter;const n={tEquirect:{value:null}},r="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",o=new py(5,5,5),a=new vy({name:"CubemapFromEquirect",uniforms:fy(n),vertexShader:r,fragmentShader:i,side:Lu,blending:Uu});a.uniforms.tEquirect.value=e;const s=new hy(o,a),l=e.minFilter;e.minFilter===Yh&&(e.minFilter=Hh);return new Ey(1,10,this).update(t,s),e.minFilter=l,s.geometry.dispose(),s.material.dispose(),this}clear(t,e,n,r){const i=t.getRenderTarget();for(let o=0;o<6;o++)t.setRenderTarget(this,o),t.clear(e,n,r);t.setRenderTarget(i)}}const Ay=new $f,ky=new $f,Iy=new wf;class Ry{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new $f(1,0,0),e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.isPlane=!0,this.normal=t,this.constant=e}set(t,e){return this.normal.copy(t),this.constant=e,this}setComponents(t,e,n,r){return this.normal.set(t,e,n),this.constant=r,this}setFromNormalAndCoplanarPoint(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this}setFromCoplanarPoints(t,e,n){const r=Ay.subVectors(n,e).cross(ky.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(r,t),this}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){const t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,e){return e.copy(t).addScaledVector(this.normal,-this.distanceToPoint(t))}intersectLine(t,e){const n=t.delta(Ay),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(t.start)?e.copy(t.start):null;const i=-(t.start.dot(this.normal)+this.constant)/r;return i<0||i>1?null:e.copy(t.start).addScaledVector(n,i)}intersectsLine(t){const e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return e<0&&n>0||n<0&&e>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,e){const n=e||Iy.getNormalMatrix(t),r=this.coplanarPoint(Ay).applyMatrix4(t),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const Py=new xm,Ny=new $f;class Oy{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ry,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ry,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Ry,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Ry,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new Ry,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:new Ry;this.planes=[t,e,n,r,i,o]}set(t,e,n,r,i,o){const a=this.planes;return a[0].copy(t),a[1].copy(e),a[2].copy(n),a[3].copy(r),a[4].copy(i),a[5].copy(o),this}copy(t){const e=this.planes;for(let n=0;n<6;n++)e[n].copy(t.planes[n]);return this}setFromProjectionMatrix(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:sf;const n=this.planes,r=t.elements,i=r[0],o=r[1],a=r[2],s=r[3],l=r[4],c=r[5],u=r[6],h=r[7],d=r[8],p=r[9],f=r[10],m=r[11],g=r[12],y=r[13],v=r[14],b=r[15];if(n[0].setComponents(s-i,h-l,m-d,b-g).normalize(),n[1].setComponents(s+i,h+l,m+d,b+g).normalize(),n[2].setComponents(s+o,h+c,m+p,b+y).normalize(),n[3].setComponents(s-o,h-c,m-p,b-y).normalize(),n[4].setComponents(s-a,h-u,m-f,b-v).normalize(),e===sf)n[5].setComponents(s+a,h+u,m+f,b+v).normalize();else{if(e!==lf)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+e);n[5].setComponents(a,u,f,v).normalize()}return this}intersectsObject(t){if(void 0!==t.boundingSphere)null===t.boundingSphere&&t.computeBoundingSphere(),Py.copy(t.boundingSphere).applyMatrix4(t.matrixWorld);else{const e=t.geometry;null===e.boundingSphere&&e.computeBoundingSphere(),Py.copy(e.boundingSphere).applyMatrix4(t.matrixWorld)}return this.intersectsSphere(Py)}intersectsSprite(t){return Py.center.set(0,0,0),Py.radius=.7071067811865476,Py.applyMatrix4(t.matrixWorld),this.intersectsSphere(Py)}intersectsSphere(t){const e=this.planes,n=t.center,r=-t.radius;for(let i=0;i<6;i++){if(e[i].distanceToPoint(n)<r)return!1}return!0}intersectsBox(t){const e=this.planes;for(let n=0;n<6;n++){const r=e[n];if(Ny.x=r.normal.x>0?t.max.x:t.min.x,Ny.y=r.normal.y>0?t.max.y:t.min.y,Ny.z=r.normal.z>0?t.max.z:t.min.z,r.distanceToPoint(Ny)<0)return!1}return!0}containsPoint(t){const e=this.planes;for(let n=0;n<6;n++)if(e[n].distanceToPoint(t)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function Dy(){let t=null,e=!1,n=null,r=null;function i(e,o){n(e,o),r=t.requestAnimationFrame(i)}return{start:function(){!0!==e&&null!==n&&(r=t.requestAnimationFrame(i),e=!0)},stop:function(){t.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(t){n=t},setContext:function(e){t=e}}}function Ly(t){const e=new WeakMap;return{get:function(t){return t.isInterleavedBufferAttribute&&(t=t.data),e.get(t)},remove:function(n){n.isInterleavedBufferAttribute&&(n=n.data);const r=e.get(n);r&&(t.deleteBuffer(r.buffer),e.delete(n))},update:function(n,r){if(n.isGLBufferAttribute){const t=e.get(n);return void((!t||t.version<n.version)&&e.set(n,{buffer:n.buffer,type:n.type,bytesPerElement:n.elementSize,version:n.version}))}n.isInterleavedBufferAttribute&&(n=n.data);const i=e.get(n);if(void 0===i)e.set(n,function(e,n){const r=e.array,i=e.usage,o=r.byteLength,a=t.createBuffer();let s;if(t.bindBuffer(n,a),t.bufferData(n,r,i),e.onUploadCallback(),r instanceof Float32Array)s=t.FLOAT;else if(r instanceof Uint16Array)s=e.isFloat16BufferAttribute?t.HALF_FLOAT:t.UNSIGNED_SHORT;else if(r instanceof Int16Array)s=t.SHORT;else if(r instanceof Uint32Array)s=t.UNSIGNED_INT;else if(r instanceof Int32Array)s=t.INT;else if(r instanceof Int8Array)s=t.BYTE;else if(r instanceof Uint8Array)s=t.UNSIGNED_BYTE;else{if(!(r instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+r);s=t.UNSIGNED_BYTE}return{buffer:a,type:s,bytesPerElement:r.BYTES_PER_ELEMENT,version:e.version,size:o}}(n,r));else if(i.version<n.version){if(i.size!==n.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");!function(e,n,r){const i=n.array,o=n._updateRange,a=n.updateRanges;if(t.bindBuffer(r,e),-1===o.count&&0===a.length&&t.bufferSubData(r,0,i),0!==a.length){for(let e=0,n=a.length;e<n;e++){const n=a[e];t.bufferSubData(r,n.start*i.BYTES_PER_ELEMENT,i,n.start,n.count)}n.clearUpdateRanges()}-1!==o.count&&(t.bufferSubData(r,o.offset*i.BYTES_PER_ELEMENT,i,o.offset,o.count),o.count=-1),n.onUploadCallback()}(i.buffer,n,r),i.version=n.version}}}}class Fy extends Xg{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:r};const i=t/2,o=e/2,a=Math.floor(n),s=Math.floor(r),l=a+1,c=s+1,u=t/a,h=e/s,d=[],p=[],f=[],m=[];for(let g=0;g<c;g++){const t=g*h-o;for(let e=0;e<l;e++){const n=e*u-i;p.push(n,-t,0),f.push(0,0,1),m.push(e/a),m.push(1-g/s)}}for(let g=0;g<s;g++)for(let t=0;t<a;t++){const e=t+l*g,n=t+l*(g+1),r=t+1+l*(g+1),i=t+1+l*g;d.push(e,n,i),d.push(n,r,i)}this.setIndex(d),this.setAttribute("position",new Bg(p,3)),this.setAttribute("normal",new Bg(f,3)),this.setAttribute("uv",new Bg(m,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new Fy(t.width,t.height,t.widthSegments,t.heightSegments)}}const Uy={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\t#ifdef ALPHA_TO_COVERAGE\n\tdiffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );\n\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\tif ( diffuseColor.a < alphaTest ) discard;\n\t#endif\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_CLEARCOAT ) \n\t\tclearcoatSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_SHEEN ) \n\t\tsheenSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",batching_pars_vertex:"#ifdef USE_BATCHING\n\tattribute float batchId;\n\tuniform highp sampler2D batchingTexture;\n\tmat4 getBatchingMatrix( const in float i ) {\n\t\tint size = textureSize( batchingTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif\n#ifdef USE_BATCHING_COLOR\n\tuniform sampler2D batchingColorTexture;\n\tvec3 getBatchingColor( const in float i ) {\n\t\tint size = textureSize( batchingColorTexture, 0 ).x;\n\t\tint j = int( i );\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\treturn texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;\n\t}\n#endif",batching_vertex:"#ifdef USE_BATCHING\n\tmat4 batchingMatrix = getBatchingMatrix( batchId );\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );\n\t\tvec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#ifdef ALPHA_TO_COVERAGE\n\t\tfloat distanceToPlane, distanceGradient;\n\t\tfloat clipOpacity = 1.0;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\tclipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\tif ( clipOpacity == 0.0 ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tfloat unionClipOpacity = 1.0;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\t\tunionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tclipOpacity *= 1.0 - unionClipOpacity;\n\t\t#endif\n\t\tdiffuseColor.a *= clipOpacity;\n\t\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tbool clipped = true;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tif ( clipped ) discard;\n\t\t#endif\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif\n#ifdef USE_BATCHING_COLOR\n\tvec3 batchingColor = getBatchingColor( batchId );\n\tvColor.xyz *= batchingColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = objectTangent;\n#endif\n#ifdef USE_BATCHING\n\tmat3 bm = mat3( batchingMatrix );\n\ttransformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );\n\ttransformedNormal = bm * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = bm * transformedTangent;\n\t#endif\n#endif\n#ifdef USE_INSTANCING\n\tmat3 im = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );\n\ttransformedNormal = im * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = im * transformedTangent;\n\t#endif\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\ttransformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"\nconst mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(\n\tvec3( 0.8224621, 0.177538, 0.0 ),\n\tvec3( 0.0331941, 0.9668058, 0.0 ),\n\tvec3( 0.0170827, 0.0723974, 0.9105199 )\n);\nconst mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.2249401, - 0.2249404, 0.0 ),\n\tvec3( - 0.0420569, 1.0420571, 0.0 ),\n\tvec3( - 0.0196376, - 0.0786361, 1.0982735 )\n);\nvec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );\n}\nvec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );\n}\nvec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn sRGBTransferOETF( value );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform mat3 envMapRotation;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif ( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_DISPERSION\n\tmaterial.dispersion = dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tif( material.anisotropy == 0.0 ) {\n\t\tanisotropyV = vec2( 1.0, 0.0 );\n\t} else {\n\t\tanisotropyV /= material.anisotropy;\n\t\tmaterial.anisotropy = saturate( material.anisotropy );\n\t}\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\tfloat dispersion;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecularDirect = vec3( 0.0 );\nvec3 clearcoatSpecularIndirect = vec3( 0.0 );\nvec3 sheenSpecularDirect = vec3( 0.0 );\nvec3 sheenSpecularIndirect = vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometryNormal;\n\t\tvec3 viewDir = geometryViewDir;\n\t\tvec3 position = geometryPosition;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal = vec3( 0.0 );\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF )\n\tgl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\tvFragDepth = 1.0 + gl_Position.w;\n\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphinstance_vertex:"#ifdef USE_INSTANCING_MORPH\n\tfloat morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\tfloat morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tmorphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;\n\t}\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_INSTANCING_MORPH\n\t\tuniform float morphTargetBaseInfluence;\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t#endif\n\tuniform sampler2DArray morphTargetsTexture;\n\tuniform ivec2 morphTargetsTextureSize;\n\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t}\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_BATCHING\n\tmvPosition = batchingMatrix * mvPosition;\n#endif\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tfloat shadow = 1.0;\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\t\n\t\tfloat lightToPositionLength = length( lightToPosition );\n\t\tif ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {\n\t\t\tfloat dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\t\tdp += shadowBias;\n\t\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\t\tshadow = (\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t\t) * ( 1.0 / 9.0 );\n\t\t\t#else\n\t\t\t\tshadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tint size = textureSize( boneTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nconst mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.6605, - 0.1246, - 0.0182 ),\n\tvec3( - 0.5876, 1.1329, - 0.1006 ),\n\tvec3( - 0.0728, - 0.0083, 1.1187 )\n);\nconst mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(\n\tvec3( 0.6274, 0.0691, 0.0164 ),\n\tvec3( 0.3293, 0.9195, 0.0880 ),\n\tvec3( 0.0433, 0.0113, 0.8956 )\n);\nvec3 agxDefaultContrastApprox( vec3 x ) {\n\tvec3 x2 = x * x;\n\tvec3 x4 = x2 * x2;\n\treturn + 15.5 * x4 * x2\n\t\t- 40.14 * x4 * x\n\t\t+ 31.96 * x4\n\t\t- 6.868 * x2 * x\n\t\t+ 0.4298 * x2\n\t\t+ 0.1191 * x\n\t\t- 0.00232;\n}\nvec3 AgXToneMapping( vec3 color ) {\n\tconst mat3 AgXInsetMatrix = mat3(\n\t\tvec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),\n\t\tvec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),\n\t\tvec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )\n\t);\n\tconst mat3 AgXOutsetMatrix = mat3(\n\t\tvec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),\n\t\tvec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),\n\t\tvec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )\n\t);\n\tconst float AgxMinEv = - 12.47393;\tconst float AgxMaxEv = 4.026069;\n\tcolor *= toneMappingExposure;\n\tcolor = LINEAR_SRGB_TO_LINEAR_REC2020 * color;\n\tcolor = AgXInsetMatrix * color;\n\tcolor = max( color, 1e-10 );\tcolor = log2( color );\n\tcolor = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );\n\tcolor = clamp( color, 0.0, 1.0 );\n\tcolor = agxDefaultContrastApprox( color );\n\tcolor = AgXOutsetMatrix * color;\n\tcolor = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );\n\tcolor = LINEAR_REC2020_TO_LINEAR_SRGB * color;\n\tcolor = clamp( color, 0.0, 1.0 );\n\treturn color;\n}\nvec3 NeutralToneMapping( vec3 color ) {\n\tconst float StartCompression = 0.8 - 0.04;\n\tconst float Desaturation = 0.15;\n\tcolor *= toneMappingExposure;\n\tfloat x = min( color.r, min( color.g, color.b ) );\n\tfloat offset = x < 0.08 ? x - 6.25 * x * x : 0.04;\n\tcolor -= offset;\n\tfloat peak = max( color.r, max( color.g, color.b ) );\n\tif ( peak < StartCompression ) return color;\n\tfloat d = 1. - StartCompression;\n\tfloat newPeak = 1. - d * d / ( peak + d - StartCompression );\n\tcolor *= newPeak / peak;\n\tfloat g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );\n\treturn mix( color, vec3( newPeak ), g );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec4 transmittedLight;\n\t\tvec3 transmittance;\n\t\t#ifdef USE_DISPERSION\n\t\t\tfloat halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;\n\t\t\tvec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );\n\t\t\tfor ( int i = 0; i < 3; i ++ ) {\n\t\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );\n\t\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\n\t\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\t\trefractionCoords += 1.0;\n\t\t\t\trefractionCoords /= 2.0;\n\t\t\n\t\t\t\tvec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );\n\t\t\t\ttransmittedLight[ i ] = transmissionSample[ i ];\n\t\t\t\ttransmittedLight.a += transmissionSample.a;\n\t\t\t\ttransmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];\n\t\t\t}\n\t\t\ttransmittedLight.a /= 3.0;\n\t\t\n\t\t#else\n\t\t\n\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\trefractionCoords += 1.0;\n\t\t\trefractionCoords /= 2.0;\n\t\t\ttransmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\t\ttransmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\t\n\t\t#endif\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_BATCHING\n\t\tworldPosition = batchingMatrix * worldPosition;\n\t#endif\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nuniform mat3 backgroundRotation;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_DISPERSION\n\tuniform float dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},By={common:{diffuse:{value:new vg(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new wf},alphaMap:{value:null},alphaMapTransform:{value:new wf},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new wf}},envmap:{envMap:{value:null},envMapRotation:{value:new wf},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new wf}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new wf}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new wf},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new wf},normalScale:{value:new _f(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new wf},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new wf}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new wf}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new wf}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new vg(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new vg(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new wf},alphaTest:{value:0},uvTransform:{value:new wf}},sprite:{diffuse:{value:new vg(16777215)},opacity:{value:1},center:{value:new _f(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new wf},alphaMap:{value:null},alphaMapTransform:{value:new wf},alphaTest:{value:0}}},zy={basic:{uniforms:my([By.common,By.specularmap,By.envmap,By.aomap,By.lightmap,By.fog]),vertexShader:Uy.meshbasic_vert,fragmentShader:Uy.meshbasic_frag},lambert:{uniforms:my([By.common,By.specularmap,By.envmap,By.aomap,By.lightmap,By.emissivemap,By.bumpmap,By.normalmap,By.displacementmap,By.fog,By.lights,{emissive:{value:new vg(0)}}]),vertexShader:Uy.meshlambert_vert,fragmentShader:Uy.meshlambert_frag},phong:{uniforms:my([By.common,By.specularmap,By.envmap,By.aomap,By.lightmap,By.emissivemap,By.bumpmap,By.normalmap,By.displacementmap,By.fog,By.lights,{emissive:{value:new vg(0)},specular:{value:new vg(1118481)},shininess:{value:30}}]),vertexShader:Uy.meshphong_vert,fragmentShader:Uy.meshphong_frag},standard:{uniforms:my([By.common,By.envmap,By.aomap,By.lightmap,By.emissivemap,By.bumpmap,By.normalmap,By.displacementmap,By.roughnessmap,By.metalnessmap,By.fog,By.lights,{emissive:{value:new vg(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Uy.meshphysical_vert,fragmentShader:Uy.meshphysical_frag},toon:{uniforms:my([By.common,By.aomap,By.lightmap,By.emissivemap,By.bumpmap,By.normalmap,By.displacementmap,By.gradientmap,By.fog,By.lights,{emissive:{value:new vg(0)}}]),vertexShader:Uy.meshtoon_vert,fragmentShader:Uy.meshtoon_frag},matcap:{uniforms:my([By.common,By.bumpmap,By.normalmap,By.displacementmap,By.fog,{matcap:{value:null}}]),vertexShader:Uy.meshmatcap_vert,fragmentShader:Uy.meshmatcap_frag},points:{uniforms:my([By.points,By.fog]),vertexShader:Uy.points_vert,fragmentShader:Uy.points_frag},dashed:{uniforms:my([By.common,By.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Uy.linedashed_vert,fragmentShader:Uy.linedashed_frag},depth:{uniforms:my([By.common,By.displacementmap]),vertexShader:Uy.depth_vert,fragmentShader:Uy.depth_frag},normal:{uniforms:my([By.common,By.bumpmap,By.normalmap,By.displacementmap,{opacity:{value:1}}]),vertexShader:Uy.meshnormal_vert,fragmentShader:Uy.meshnormal_frag},sprite:{uniforms:my([By.sprite,By.fog]),vertexShader:Uy.sprite_vert,fragmentShader:Uy.sprite_frag},background:{uniforms:{uvTransform:{value:new wf},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Uy.background_vert,fragmentShader:Uy.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new wf}},vertexShader:Uy.backgroundCube_vert,fragmentShader:Uy.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Uy.cube_vert,fragmentShader:Uy.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Uy.equirect_vert,fragmentShader:Uy.equirect_frag},distanceRGBA:{uniforms:my([By.common,By.displacementmap,{referencePosition:{value:new $f},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Uy.distanceRGBA_vert,fragmentShader:Uy.distanceRGBA_frag},shadow:{uniforms:my([By.lights,By.fog,{color:{value:new vg(0)},opacity:{value:1}}]),vertexShader:Uy.shadow_vert,fragmentShader:Uy.shadow_frag}};zy.physical={uniforms:my([zy.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new wf},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new wf},clearcoatNormalScale:{value:new _f(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new wf},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new wf},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new wf},sheen:{value:0},sheenColor:{value:new vg(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new wf},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new wf},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new wf},transmissionSamplerSize:{value:new _f},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new wf},attenuationDistance:{value:0},attenuationColor:{value:new vg(0)},specularColor:{value:new vg(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new wf},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new wf},anisotropyVector:{value:new _f},anisotropyMap:{value:null},anisotropyMapTransform:{value:new wf}}]),vertexShader:Uy.meshphysical_vert,fragmentShader:Uy.meshphysical_frag};const jy={r:0,b:0,g:0},Vy=new Bm,Wy=new km;function Gy(t,e,n,r,i,o,a){const s=new vg(0);let l,c,u=!0===o?0:1,h=null,d=0,p=null;function f(t){let r=!0===t.isScene?t.background:null;if(r&&r.isTexture){r=(t.backgroundBlurriness>0?n:e).get(r)}return r}function m(e,n){e.getRGB(jy,gy(t)),r.buffers.color.setClear(jy.r,jy.g,jy.b,n,a)}return{getClearColor:function(){return s},setClearColor:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;s.set(t),u=e,m(s,u)},getClearAlpha:function(){return u},setClearAlpha:function(t){u=t,m(s,u)},render:function(e){let n=!1;const i=f(e);null===i?m(s,u):i&&i.isColor&&(m(i,1),n=!0);const o=t.xr.getEnvironmentBlendMode();"additive"===o?r.buffers.color.setClear(0,0,0,1,a):"alpha-blend"===o&&r.buffers.color.setClear(0,0,0,0,a),(t.autoClear||n)&&(r.buffers.depth.setTest(!0),r.buffers.depth.setMask(!0),r.buffers.color.setMask(!0),t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil))},addToRenderList:function(e,n){const r=f(n);r&&(r.isCubeTexture||r.mapping===Lh)?(void 0===c&&(c=new hy(new py(1,1,1),new vy({name:"BackgroundCubeMaterial",uniforms:fy(zy.backgroundCube.uniforms),vertexShader:zy.backgroundCube.vertexShader,fragmentShader:zy.backgroundCube.fragmentShader,side:Lu,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),c.geometry.deleteAttribute("uv"),c.onBeforeRender=function(t,e,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(c.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(c)),Vy.copy(n.backgroundRotation),Vy.x*=-1,Vy.y*=-1,Vy.z*=-1,r.isCubeTexture&&!1===r.isRenderTargetTexture&&(Vy.y*=-1,Vy.z*=-1),c.material.uniforms.envMap.value=r,c.material.uniforms.flipEnvMap.value=r.isCubeTexture&&!1===r.isRenderTargetTexture?-1:1,c.material.uniforms.backgroundBlurriness.value=n.backgroundBlurriness,c.material.uniforms.backgroundIntensity.value=n.backgroundIntensity,c.material.uniforms.backgroundRotation.value.setFromMatrix4(Wy.makeRotationFromEuler(Vy)),c.material.toneMapped=Df.getTransfer(r.colorSpace)!==wp,h===r&&d===r.version&&p===t.toneMapping||(c.material.needsUpdate=!0,h=r,d=r.version,p=t.toneMapping),c.layers.enableAll(),e.unshift(c,c.geometry,c.material,0,0,null)):r&&r.isTexture&&(void 0===l&&(l=new hy(new Fy(2,2),new vy({name:"BackgroundMaterial",uniforms:fy(zy.background.uniforms),vertexShader:zy.background.vertexShader,fragmentShader:zy.background.fragmentShader,side:Du,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(l)),l.material.uniforms.t2D.value=r,l.material.uniforms.backgroundIntensity.value=n.backgroundIntensity,l.material.toneMapped=Df.getTransfer(r.colorSpace)!==wp,!0===r.matrixAutoUpdate&&r.updateMatrix(),l.material.uniforms.uvTransform.value.copy(r.matrix),h===r&&d===r.version&&p===t.toneMapping||(l.material.needsUpdate=!0,h=r,d=r.version,p=t.toneMapping),l.layers.enableAll(),e.unshift(l,l.geometry,l.material,0,0,null))}}}function Hy(t,e){const n=t.getParameter(t.MAX_VERTEX_ATTRIBS),r={},i=c(null);let o=i,a=!1;function s(e){return t.bindVertexArray(e)}function l(e){return t.deleteVertexArray(e)}function c(t){const e=[],r=[],i=[];for(let o=0;o<n;o++)e[o]=0,r[o]=0,i[o]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:e,enabledAttributes:r,attributeDivisors:i,object:t,attributes:{},index:null}}function u(){const t=o.newAttributes;for(let e=0,n=t.length;e<n;e++)t[e]=0}function h(t){d(t,0)}function d(e,n){const r=o.newAttributes,i=o.enabledAttributes,a=o.attributeDivisors;r[e]=1,0===i[e]&&(t.enableVertexAttribArray(e),i[e]=1),a[e]!==n&&(t.vertexAttribDivisor(e,n),a[e]=n)}function p(){const e=o.newAttributes,n=o.enabledAttributes;for(let r=0,i=n.length;r<i;r++)n[r]!==e[r]&&(t.disableVertexAttribArray(r),n[r]=0)}function f(e,n,r,i,o,a,s){!0===s?t.vertexAttribIPointer(e,n,r,o,a):t.vertexAttribPointer(e,n,r,i,o,a)}function m(){g(),a=!0,o!==i&&(o=i,s(o.object))}function g(){i.geometry=null,i.program=null,i.wireframe=!1}return{setup:function(n,i,l,m,g){let y=!1;const v=function(e,n,i){const o=!0===i.wireframe;let a=r[e.id];void 0===a&&(a={},r[e.id]=a);let s=a[n.id];void 0===s&&(s={},a[n.id]=s);let l=s[o];void 0===l&&(l=c(t.createVertexArray()),s[o]=l);return l}(m,l,i);o!==v&&(o=v,s(o.object)),y=function(t,e,n,r){const i=o.attributes,a=e.attributes;let s=0;const l=n.getAttributes();for(const o in l){if(l[o].location>=0){const e=i[o];let n=a[o];if(void 0===n&&("instanceMatrix"===o&&t.instanceMatrix&&(n=t.instanceMatrix),"instanceColor"===o&&t.instanceColor&&(n=t.instanceColor)),void 0===e)return!0;if(e.attribute!==n)return!0;if(n&&e.data!==n.data)return!0;s++}}return o.attributesNum!==s||o.index!==r}(n,m,l,g),y&&function(t,e,n,r){const i={},a=e.attributes;let s=0;const l=n.getAttributes();for(const o in l){if(l[o].location>=0){let e=a[o];void 0===e&&("instanceMatrix"===o&&t.instanceMatrix&&(e=t.instanceMatrix),"instanceColor"===o&&t.instanceColor&&(e=t.instanceColor));const n={};n.attribute=e,e&&e.data&&(n.data=e.data),i[o]=n,s++}}o.attributes=i,o.attributesNum=s,o.index=r}(n,m,l,g),null!==g&&e.update(g,t.ELEMENT_ARRAY_BUFFER),(y||a)&&(a=!1,function(n,r,i,o){u();const a=o.attributes,s=i.getAttributes(),l=r.defaultAttributeValues;for(const c in s){const r=s[c];if(r.location>=0){let i=a[c];if(void 0===i&&("instanceMatrix"===c&&n.instanceMatrix&&(i=n.instanceMatrix),"instanceColor"===c&&n.instanceColor&&(i=n.instanceColor)),void 0!==i){const a=i.normalized,s=i.itemSize,l=e.get(i);if(void 0===l)continue;const c=l.buffer,u=l.type,p=l.bytesPerElement,m=u===t.INT||u===t.UNSIGNED_INT||i.gpuType===td;if(i.isInterleavedBufferAttribute){const e=i.data,l=e.stride,g=i.offset;if(e.isInstancedInterleavedBuffer){for(let t=0;t<r.locationSize;t++)d(r.location+t,e.meshPerAttribute);!0!==n.isInstancedMesh&&void 0===o._maxInstanceCount&&(o._maxInstanceCount=e.meshPerAttribute*e.count)}else for(let t=0;t<r.locationSize;t++)h(r.location+t);t.bindBuffer(t.ARRAY_BUFFER,c);for(let t=0;t<r.locationSize;t++)f(r.location+t,s/r.locationSize,u,a,l*p,(g+s/r.locationSize*t)*p,m)}else{if(i.isInstancedBufferAttribute){for(let t=0;t<r.locationSize;t++)d(r.location+t,i.meshPerAttribute);!0!==n.isInstancedMesh&&void 0===o._maxInstanceCount&&(o._maxInstanceCount=i.meshPerAttribute*i.count)}else for(let t=0;t<r.locationSize;t++)h(r.location+t);t.bindBuffer(t.ARRAY_BUFFER,c);for(let t=0;t<r.locationSize;t++)f(r.location+t,s/r.locationSize,u,a,s*p,s/r.locationSize*t*p,m)}}else if(void 0!==l){const e=l[c];if(void 0!==e)switch(e.length){case 2:t.vertexAttrib2fv(r.location,e);break;case 3:t.vertexAttrib3fv(r.location,e);break;case 4:t.vertexAttrib4fv(r.location,e);break;default:t.vertexAttrib1fv(r.location,e)}}}}p()}(n,i,l,m),null!==g&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e.get(g).buffer))},reset:m,resetDefaultState:g,dispose:function(){m();for(const t in r){const e=r[t];for(const t in e){const n=e[t];for(const t in n)l(n[t].object),delete n[t];delete e[t]}delete r[t]}},releaseStatesOfGeometry:function(t){if(void 0===r[t.id])return;const e=r[t.id];for(const n in e){const t=e[n];for(const e in t)l(t[e].object),delete t[e];delete e[n]}delete r[t.id]},releaseStatesOfProgram:function(t){for(const e in r){const n=r[e];if(void 0===n[t.id])continue;const i=n[t.id];for(const t in i)l(i[t].object),delete i[t];delete n[t.id]}},initAttributes:u,enableAttribute:h,disableUnusedAttributes:p}}function qy(t,e,n){let r;function i(e,i,o){0!==o&&(t.drawArraysInstanced(r,e,i,o),n.update(i,r,o))}this.setMode=function(t){r=t},this.render=function(e,i){t.drawArrays(r,e,i),n.update(i,r,1)},this.renderInstances=i,this.renderMultiDraw=function(t,i,o){if(0===o)return;const a=e.get("WEBGL_multi_draw");if(null===a)for(let e=0;e<o;e++)this.render(t[e],i[e]);else{a.multiDrawArraysWEBGL(r,t,0,i,0,o);let e=0;for(let t=0;t<o;t++)e+=i[t];n.update(e,r,1)}},this.renderMultiDrawInstances=function(t,o,a,s){if(0===a)return;const l=e.get("WEBGL_multi_draw");if(null===l)for(let e=0;e<t.length;e++)i(t[e],o[e],s[e]);else{l.multiDrawArraysInstancedWEBGL(r,t,0,o,0,s,0,a);let e=0;for(let t=0;t<a;t++)e+=o[t];for(let t=0;t<s.length;t++)n.update(e,r,s[t])}}}function Xy(t,e,n,r){let i;function o(e){if("highp"===e){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let a=void 0!==n.precision?n.precision:"highp";const s=o(a);s!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",s,"instead."),a=s);const l=!0===n.logarithmicDepthBuffer,c=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),u=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS);return{isWebGL2:!0,getMaxAnisotropy:function(){if(void 0!==i)return i;if(!0===e.has("EXT_texture_filter_anisotropic")){const n=e.get("EXT_texture_filter_anisotropic");i=t.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:o,textureFormatReadable:function(e){return e===ud||r.convert(e)===t.getParameter(t.IMPLEMENTATION_COLOR_READ_FORMAT)},textureTypeReadable:function(n){const i=n===rd&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(n!==Zh&&r.convert(n)!==t.getParameter(t.IMPLEMENTATION_COLOR_READ_TYPE)&&n!==nd&&!i)},precision:a,logarithmicDepthBuffer:l,maxTextures:c,maxVertexTextures:u,maxTextureSize:t.getParameter(t.MAX_TEXTURE_SIZE),maxCubemapSize:t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),maxAttributes:t.getParameter(t.MAX_VERTEX_ATTRIBS),maxVertexUniforms:t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),maxVaryings:t.getParameter(t.MAX_VARYING_VECTORS),maxFragmentUniforms:t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),vertexTextures:u>0,maxSamples:t.getParameter(t.MAX_SAMPLES)}}function Yy(t){const e=this;let n=null,r=0,i=!1,o=!1;const a=new Ry,s=new wf,l={value:null,needsUpdate:!1};function c(t,n,r,i){const o=null!==t?t.length:0;let c=null;if(0!==o){if(c=l.value,!0!==i||null===c){const e=r+4*o,i=n.matrixWorldInverse;s.getNormalMatrix(i),(null===c||c.length<e)&&(c=new Float32Array(e));for(let n=0,l=r;n!==o;++n,l+=4)a.copy(t[n]).applyMatrix4(i,s),a.normal.toArray(c,l),c[l+3]=a.constant}l.value=c,l.needsUpdate=!0}return e.numPlanes=o,e.numIntersection=0,c}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(t,e){const n=0!==t.length||e||0!==r||i;return i=e,r=t.length,n},this.beginShadows=function(){o=!0,c(null)},this.endShadows=function(){o=!1},this.setGlobalState=function(t,e){n=c(t,e,0)},this.setState=function(a,s,u){const h=a.clippingPlanes,d=a.clipIntersection,p=a.clipShadows,f=t.get(a);if(!i||null===h||0===h.length||o&&!p)o?c(null):function(){l.value!==n&&(l.value=n,l.needsUpdate=r>0);e.numPlanes=r,e.numIntersection=0}();else{const t=o?0:r,e=4*t;let i=f.clippingState||null;l.value=i,i=c(h,s,e,u);for(let r=0;r!==e;++r)i[r]=n[r];f.clippingState=i,this.numIntersection=d?this.numPlanes:0,this.numPlanes+=t}}}function Ky(t){let e=new WeakMap;function n(t,e){return e===Oh?t.mapping=Ph:e===Dh&&(t.mapping=Nh),t}function r(t){const n=t.target;n.removeEventListener("dispose",r);const i=e.get(n);void 0!==i&&(e.delete(n),i.dispose())}return{get:function(i){if(i&&i.isTexture){const o=i.mapping;if(o===Oh||o===Dh){if(e.has(i)){return n(e.get(i).texture,i.mapping)}{const o=i.image;if(o&&o.height>0){const a=new Cy(o.height);return a.fromEquirectangularTexture(t,i),e.set(i,a),i.addEventListener("dispose",r),n(a.texture,i.mapping)}return null}}}return i},dispose:function(){e=new WeakMap}}}class Zy extends by{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.1,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2e3;super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=n,this.bottom=r,this.near=i,this.far=o,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this}setViewOffset(t,e,n,r,i,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let i=n-t,o=n+t,a=r+e,s=r-e;if(null!==this.view&&this.view.enabled){const t=(this.right-this.left)/this.view.fullWidth/this.zoom,e=(this.top-this.bottom)/this.view.fullHeight/this.zoom;i+=t*this.view.offsetX,o=i+t*this.view.width,a-=e*this.view.offsetY,s=a-e*this.view.height}this.projectionMatrix.makeOrthographic(i,o,a,s,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}const Jy=[.125,.215,.35,.446,.526,.582],Qy=20,$y=new Zy,tv=new vg;let ev=null,nv=0,rv=0,iv=!1;const ov=(1+Math.sqrt(5))/2,av=1/ov,sv=[new $f(-ov,av,0),new $f(ov,av,0),new $f(-av,0,ov),new $f(av,0,ov),new $f(0,ov,-av),new $f(0,ov,av),new $f(-1,1,-1),new $f(1,1,-1),new $f(-1,1,1),new $f(1,1,1)];class lv{constructor(t){this._renderer=t,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100;ev=this._renderer.getRenderTarget(),nv=this._renderer.getActiveCubeFace(),rv=this._renderer.getActiveMipmapLevel(),iv=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(256);const i=this._allocateTargets();return i.depthBuffer=!0,this._sceneToCubeUV(t,n,r,i),e>0&&this._blur(i,0,0,e),this._applyPMREM(i),this._cleanup(i),i}fromEquirectangular(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._fromTexture(t,e)}fromCubemap(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._fromTexture(t,e)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=dv(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=hv(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(t){this._lodMax=Math.floor(Math.log2(t)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let t=0;t<this._lodPlanes.length;t++)this._lodPlanes[t].dispose()}_cleanup(t){this._renderer.setRenderTarget(ev,nv,rv),this._renderer.xr.enabled=iv,t.scissorTest=!1,uv(t,0,0,t.width,t.height)}_fromTexture(t,e){t.mapping===Ph||t.mapping===Nh?this._setSize(0===t.image.length?16:t.image[0].width||t.image[0].image.width):this._setSize(t.image.width/4),ev=this._renderer.getRenderTarget(),nv=this._renderer.getActiveCubeFace(),rv=this._renderer.getActiveMipmapLevel(),iv=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const n=e||this._allocateTargets();return this._textureToCubeUV(t,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const t=3*Math.max(this._cubeSize,112),e=4*this._cubeSize,n={magFilter:Hh,minFilter:Hh,generateMipmaps:!1,type:rd,format:ud,colorSpace:vp,depthBuffer:!1},r=cv(t,e,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==t||this._pingPongRenderTarget.height!==e){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=cv(t,e,n);const{_lodMax:r}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function(t){const e=[],n=[],r=[];let i=t;const o=t-4+1+Jy.length;for(let a=0;a<o;a++){const o=Math.pow(2,i);n.push(o);let s=1/o;a>t-4?s=Jy[a-t+4-1]:0===a&&(s=0),r.push(s);const l=1/(o-2),c=-l,u=1+l,h=[c,c,u,c,u,u,c,c,u,u,c,u],d=6,p=6,f=3,m=2,g=1,y=new Float32Array(f*p*d),v=new Float32Array(m*p*d),b=new Float32Array(g*p*d);for(let t=0;t<d;t++){const e=t%3*2/3-1,n=t>2?0:-1,r=[e,n,0,e+2/3,n,0,e+2/3,n+1,0,e,n,0,e+2/3,n+1,0,e,n+1,0];y.set(r,f*p*t),v.set(h,m*p*t);const i=[t,t,t,t,t,t];b.set(i,g*p*t)}const x=new Xg;x.setAttribute("position",new Ig(y,f)),x.setAttribute("uv",new Ig(v,m)),x.setAttribute("faceIndex",new Ig(b,g)),e.push(x),i>4&&i--}return{lodPlanes:e,sizeLods:n,sigmas:r}}(r)),this._blurMaterial=function(t,e,n){const r=new Float32Array(Qy),i=new $f(0,1,0),o=new vy({name:"SphericalGaussianBlur",defines:{n:Qy,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:"".concat(t,".0")},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:Uu,depthTest:!1,depthWrite:!1});return o}(r,t,e)}return r}_compileMaterial(t){const e=new hy(this._lodPlanes[0],t);this._renderer.compile(e,$y)}_sceneToCubeUV(t,e,n,r){const i=new Sy(90,1,e,n),o=[1,-1,1,1,1,1],a=[1,1,1,-1,-1,-1],s=this._renderer,l=s.autoClear,c=s.toneMapping;s.getClearColor(tv),s.toneMapping=_h,s.autoClear=!1;const u=new wg({name:"PMREM.Background",side:Lu,depthWrite:!1,depthTest:!1}),h=new hy(new py,u);let d=!1;const p=t.background;p?p.isColor&&(u.color.copy(p),t.background=null,d=!0):(u.color.copy(tv),d=!0);for(let f=0;f<6;f++){const e=f%3;0===e?(i.up.set(0,o[f],0),i.lookAt(a[f],0,0)):1===e?(i.up.set(0,0,o[f]),i.lookAt(0,a[f],0)):(i.up.set(0,o[f],0),i.lookAt(0,0,a[f]));const n=this._cubeSize;uv(r,e*n,f>2?n:0,n,n),s.setRenderTarget(r),d&&s.render(h,i),s.render(t,i)}h.geometry.dispose(),h.material.dispose(),s.toneMapping=c,s.autoClear=l,t.background=p}_textureToCubeUV(t,e){const n=this._renderer,r=t.mapping===Ph||t.mapping===Nh;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=dv()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===t.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=hv());const i=r?this._cubemapMaterial:this._equirectMaterial,o=new hy(this._lodPlanes[0],i);i.uniforms.envMap.value=t;const a=this._cubeSize;uv(e,0,0,3*a,2*a),n.setRenderTarget(e),n.render(o,$y)}_applyPMREM(t){const e=this._renderer,n=e.autoClear;e.autoClear=!1;const r=this._lodPlanes.length;for(let i=1;i<r;i++){const e=Math.sqrt(this._sigmas[i]*this._sigmas[i]-this._sigmas[i-1]*this._sigmas[i-1]),n=sv[(r-i-1)%sv.length];this._blur(t,i-1,i,e,n)}e.autoClear=n}_blur(t,e,n,r,i){const o=this._pingPongRenderTarget;this._halfBlur(t,o,e,n,r,"latitudinal",i),this._halfBlur(o,t,n,n,r,"longitudinal",i)}_halfBlur(t,e,n,r,i,o,a){const s=this._renderer,l=this._blurMaterial;"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");const c=new hy(this._lodPlanes[r],l),u=l.uniforms,h=this._sizeLods[n]-1,d=isFinite(i)?Math.PI/(2*h):2*Math.PI/39,p=i/d,f=isFinite(i)?1+Math.floor(3*p):Qy;f>Qy&&console.warn("sigmaRadians, ".concat(i,", is too large and will clip, as it requested ").concat(f," samples when the maximum is set to ").concat(Qy));const m=[];let g=0;for(let b=0;b<Qy;++b){const t=b/p,e=Math.exp(-t*t/2);m.push(e),0===b?g+=e:b<f&&(g+=2*e)}for(let b=0;b<m.length;b++)m[b]=m[b]/g;u.envMap.value=t.texture,u.samples.value=f,u.weights.value=m,u.latitudinal.value="latitudinal"===o,a&&(u.poleAxis.value=a);const{_lodMax:y}=this;u.dTheta.value=d,u.mipInt.value=y-n;const v=this._sizeLods[r];uv(e,3*v*(r>y-4?r-y+4:0),4*(this._cubeSize-v),3*v,2*v),s.setRenderTarget(e),s.render(c,$y)}}function cv(t,e,n){const r=new Xf(t,e,n);return r.texture.mapping=Lh,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function uv(t,e,n,r,i){t.viewport.set(e,n,r,i),t.scissor.set(e,n,r,i)}function hv(){return new vy({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:Uu,depthTest:!1,depthWrite:!1})}function dv(){return new vy({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:Uu,depthTest:!1,depthWrite:!1})}function pv(t){let e=new WeakMap,n=null;function r(t){const n=t.target;n.removeEventListener("dispose",r);const i=e.get(n);void 0!==i&&(e.delete(n),i.dispose())}return{get:function(i){if(i&&i.isTexture){const o=i.mapping,a=o===Oh||o===Dh,s=o===Ph||o===Nh;if(a||s){let o=e.get(i);const l=void 0!==o?o.texture.pmremVersion:0;if(i.isRenderTargetTexture&&i.pmremVersion!==l)return null===n&&(n=new lv(t)),o=a?n.fromEquirectangular(i,o):n.fromCubemap(i,o),o.texture.pmremVersion=i.pmremVersion,e.set(i,o),o.texture;if(void 0!==o)return o.texture;{const l=i.image;return a&&l&&l.height>0||s&&l&&function(t){let e=0;const n=6;for(let r=0;r<n;r++)void 0!==t[r]&&e++;return e===n}(l)?(null===n&&(n=new lv(t)),o=a?n.fromEquirectangular(i):n.fromCubemap(i),o.texture.pmremVersion=i.pmremVersion,e.set(i,o),i.addEventListener("dispose",r),o.texture):null}}}return i},dispose:function(){e=new WeakMap,null!==n&&(n.dispose(),n=null)}}}function fv(t){const e={};function n(n){if(void 0!==e[n])return e[n];let r;switch(n){case"WEBGL_depth_texture":r=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=t.getExtension(n)}return e[n]=r,r}return{has:function(t){return null!==n(t)},init:function(){n("EXT_color_buffer_float"),n("WEBGL_clip_cull_distance"),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture"),n("WEBGL_render_shared_exponent")},get:function(t){const e=n(t);return null===e&&If("THREE.WebGLRenderer: "+t+" extension not supported."),e}}}function mv(t,e,n,r){const i={},o=new WeakMap;function a(t){const s=t.target;null!==s.index&&e.remove(s.index);for(const n in s.attributes)e.remove(s.attributes[n]);for(const n in s.morphAttributes){const t=s.morphAttributes[n];for(let n=0,r=t.length;n<r;n++)e.remove(t[n])}s.removeEventListener("dispose",a),delete i[s.id];const l=o.get(s);l&&(e.remove(l),o.delete(s)),r.releaseStatesOfGeometry(s),!0===s.isInstancedBufferGeometry&&delete s._maxInstanceCount,n.memory.geometries--}function s(t){const n=[],r=t.index,i=t.attributes.position;let a=0;if(null!==r){const t=r.array;a=r.version;for(let e=0,r=t.length;e<r;e+=3){const r=t[e+0],i=t[e+1],o=t[e+2];n.push(r,i,i,o,o,r)}}else{if(void 0===i)return;{const t=i.array;a=i.version;for(let e=0,r=t.length/3-1;e<r;e+=3){const t=e+0,r=e+1,i=e+2;n.push(t,r,r,i,i,t)}}}const s=new(Tf(n)?Fg:Dg)(n,1);s.version=a;const l=o.get(t);l&&e.remove(l),o.set(t,s)}return{get:function(t,e){return!0===i[e.id]||(e.addEventListener("dispose",a),i[e.id]=!0,n.memory.geometries++),e},update:function(n){const r=n.attributes;for(const o in r)e.update(r[o],t.ARRAY_BUFFER);const i=n.morphAttributes;for(const o in i){const n=i[o];for(let r=0,i=n.length;r<i;r++)e.update(n[r],t.ARRAY_BUFFER)}},getWireframeAttribute:function(t){const e=o.get(t);if(e){const n=t.index;null!==n&&e.version<n.version&&s(t)}else s(t);return o.get(t)}}}function gv(t,e,n){let r,i,o;function a(e,a,s){0!==s&&(t.drawElementsInstanced(r,a,i,e*o,s),n.update(a,r,s))}this.setMode=function(t){r=t},this.setIndex=function(t){i=t.type,o=t.bytesPerElement},this.render=function(e,a){t.drawElements(r,a,i,e*o),n.update(a,r,1)},this.renderInstances=a,this.renderMultiDraw=function(t,a,s){if(0===s)return;const l=e.get("WEBGL_multi_draw");if(null===l)for(let e=0;e<s;e++)this.render(t[e]/o,a[e]);else{l.multiDrawElementsWEBGL(r,a,0,i,t,0,s);let e=0;for(let t=0;t<s;t++)e+=a[t];n.update(e,r,1)}},this.renderMultiDrawInstances=function(t,s,l,c){if(0===l)return;const u=e.get("WEBGL_multi_draw");if(null===u)for(let e=0;e<t.length;e++)a(t[e]/o,s[e],c[e]);else{u.multiDrawElementsInstancedWEBGL(r,s,0,i,t,0,c,0,l);let e=0;for(let t=0;t<l;t++)e+=s[t];for(let t=0;t<c.length;t++)n.update(e,r,c[t])}}}function yv(t){const e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function(){e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function(n,r,i){switch(e.calls++,r){case t.TRIANGLES:e.triangles+=i*(n/3);break;case t.LINES:e.lines+=i*(n/2);break;case t.LINE_STRIP:e.lines+=i*(n-1);break;case t.LINE_LOOP:e.lines+=i*n;break;case t.POINTS:e.points+=i*n;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",r)}}}}function vv(t,e,n){const r=new WeakMap,i=new Hf;return{update:function(o,a,s){const l=o.morphTargetInfluences,c=a.morphAttributes.position||a.morphAttributes.normal||a.morphAttributes.color,u=void 0!==c?c.length:0;let h=r.get(a);if(void 0===h||h.count!==u){void 0!==h&&h.texture.dispose();const d=void 0!==a.morphAttributes.position,p=void 0!==a.morphAttributes.normal,f=void 0!==a.morphAttributes.color,m=a.morphAttributes.position||[],g=a.morphAttributes.normal||[],y=a.morphAttributes.color||[];let v=0;!0===d&&(v=1),!0===p&&(v=2),!0===f&&(v=3);let b=a.attributes.position.count*v,x=1;b>e.maxTextureSize&&(x=Math.ceil(b/e.maxTextureSize),b=e.maxTextureSize);const _=new Float32Array(b*x*4*u),w=new Yf(_,b,x,u);w.type=nd,w.needsUpdate=!0;const S=4*v;for(let E=0;E<u;E++){const M=m[E],C=g[E],A=y[E],k=b*x*4*E;for(let I=0;I<M.count;I++){const R=I*S;!0===d&&(i.fromBufferAttribute(M,I),_[k+R+0]=i.x,_[k+R+1]=i.y,_[k+R+2]=i.z,_[k+R+3]=0),!0===p&&(i.fromBufferAttribute(C,I),_[k+R+4]=i.x,_[k+R+5]=i.y,_[k+R+6]=i.z,_[k+R+7]=0),!0===f&&(i.fromBufferAttribute(A,I),_[k+R+8]=i.x,_[k+R+9]=i.y,_[k+R+10]=i.z,_[k+R+11]=4===A.itemSize?i.w:1)}}function T(){w.dispose(),r.delete(a),a.removeEventListener("dispose",T)}h={count:u,texture:w,size:new _f(b,x)},r.set(a,h),a.addEventListener("dispose",T)}if(!0===o.isInstancedMesh&&null!==o.morphTexture)s.getUniforms().setValue(t,"morphTexture",o.morphTexture,n);else{let P=0;for(let O=0;O<l.length;O++)P+=l[O];const N=a.morphTargetsRelative?1:1-P;s.getUniforms().setValue(t,"morphTargetBaseInfluence",N),s.getUniforms().setValue(t,"morphTargetInfluences",l)}s.getUniforms().setValue(t,"morphTargetsTexture",h.texture,n),s.getUniforms().setValue(t,"morphTargetsTextureSize",h.size)}}}function bv(t,e,n,r){let i=new WeakMap;function o(t){const e=t.target;e.removeEventListener("dispose",o),n.remove(e.instanceMatrix),null!==e.instanceColor&&n.remove(e.instanceColor)}return{update:function(a){const s=r.render.frame,l=a.geometry,c=e.get(a,l);if(i.get(c)!==s&&(e.update(c),i.set(c,s)),a.isInstancedMesh&&(!1===a.hasEventListener("dispose",o)&&a.addEventListener("dispose",o),i.get(a)!==s&&(n.update(a.instanceMatrix,t.ARRAY_BUFFER),null!==a.instanceColor&&n.update(a.instanceColor,t.ARRAY_BUFFER),i.set(a,s))),a.isSkinnedMesh){const t=a.skeleton;i.get(t)!==s&&(t.update(),i.set(t,s))}return c},dispose:function(){i=new WeakMap}}}class xv extends Gf{constructor(t,e,n,r,i,o,a,s,l){let c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:pd;if(c!==pd&&c!==fd)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&c===pd&&(n=ed),void 0===n&&c===fd&&(n=ad),super(null,r,i,o,a,s,c,n,l),this.isDepthTexture=!0,this.image={width:t,height:e},this.magFilter=void 0!==a?a:zh,this.minFilter=void 0!==s?s:zh,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(t){return super.copy(t),this.compareFunction=t.compareFunction,this}toJSON(t){const e=super.toJSON(t);return null!==this.compareFunction&&(e.compareFunction=this.compareFunction),e}}const _v=new Gf,wv=new xv(1,1);wv.compareFunction=Gp;const Sv=new Yf,Tv=new Zf,Ev=new My,Mv=[],Cv=[],Av=new Float32Array(16),kv=new Float32Array(9),Iv=new Float32Array(4);function Rv(t,e,n){const r=t[0];if(r<=0||r>0)return t;const i=e*n;let o=Mv[i];if(void 0===o&&(o=new Float32Array(i),Mv[i]=o),0!==e){r.toArray(o,0);for(let r=1,i=0;r!==e;++r)i+=n,t[r].toArray(o,i)}return o}function Pv(t,e){if(t.length!==e.length)return!1;for(let n=0,r=t.length;n<r;n++)if(t[n]!==e[n])return!1;return!0}function Nv(t,e){for(let n=0,r=e.length;n<r;n++)t[n]=e[n]}function Ov(t,e){let n=Cv[e];void 0===n&&(n=new Int32Array(e),Cv[e]=n);for(let r=0;r!==e;++r)n[r]=t.allocateTextureUnit();return n}function Dv(t,e){const n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function Lv(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y||(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Pv(n,e))return;t.uniform2fv(this.addr,e),Nv(n,e)}}function Fv(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z||(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(void 0!==e.r)n[0]===e.r&&n[1]===e.g&&n[2]===e.b||(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(Pv(n,e))return;t.uniform3fv(this.addr,e),Nv(n,e)}}function Uv(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z&&n[3]===e.w||(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Pv(n,e))return;t.uniform4fv(this.addr,e),Nv(n,e)}}function Bv(t,e){const n=this.cache,r=e.elements;if(void 0===r){if(Pv(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),Nv(n,e)}else{if(Pv(n,r))return;Iv.set(r),t.uniformMatrix2fv(this.addr,!1,Iv),Nv(n,r)}}function zv(t,e){const n=this.cache,r=e.elements;if(void 0===r){if(Pv(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),Nv(n,e)}else{if(Pv(n,r))return;kv.set(r),t.uniformMatrix3fv(this.addr,!1,kv),Nv(n,r)}}function jv(t,e){const n=this.cache,r=e.elements;if(void 0===r){if(Pv(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),Nv(n,e)}else{if(Pv(n,r))return;Av.set(r),t.uniformMatrix4fv(this.addr,!1,Av),Nv(n,r)}}function Vv(t,e){const n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function Wv(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y||(t.uniform2i(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Pv(n,e))return;t.uniform2iv(this.addr,e),Nv(n,e)}}function Gv(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z||(t.uniform3i(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(Pv(n,e))return;t.uniform3iv(this.addr,e),Nv(n,e)}}function Hv(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z&&n[3]===e.w||(t.uniform4i(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Pv(n,e))return;t.uniform4iv(this.addr,e),Nv(n,e)}}function qv(t,e){const n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function Xv(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y||(t.uniform2ui(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Pv(n,e))return;t.uniform2uiv(this.addr,e),Nv(n,e)}}function Yv(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z||(t.uniform3ui(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(Pv(n,e))return;t.uniform3uiv(this.addr,e),Nv(n,e)}}function Kv(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z&&n[3]===e.w||(t.uniform4ui(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Pv(n,e))return;t.uniform4uiv(this.addr,e),Nv(n,e)}}function Zv(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i);const o=this.type===t.SAMPLER_2D_SHADOW?wv:_v;n.setTexture2D(e||o,i)}function Jv(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(e||Tv,i)}function Qv(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTextureCube(e||Ev,i)}function $v(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(e||Sv,i)}function tb(t,e){t.uniform1fv(this.addr,e)}function eb(t,e){const n=Rv(e,this.size,2);t.uniform2fv(this.addr,n)}function nb(t,e){const n=Rv(e,this.size,3);t.uniform3fv(this.addr,n)}function rb(t,e){const n=Rv(e,this.size,4);t.uniform4fv(this.addr,n)}function ib(t,e){const n=Rv(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function ob(t,e){const n=Rv(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function ab(t,e){const n=Rv(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function sb(t,e){t.uniform1iv(this.addr,e)}function lb(t,e){t.uniform2iv(this.addr,e)}function cb(t,e){t.uniform3iv(this.addr,e)}function ub(t,e){t.uniform4iv(this.addr,e)}function hb(t,e){t.uniform1uiv(this.addr,e)}function db(t,e){t.uniform2uiv(this.addr,e)}function pb(t,e){t.uniform3uiv(this.addr,e)}function fb(t,e){t.uniform4uiv(this.addr,e)}function mb(t,e,n){const r=this.cache,i=e.length,o=Ov(n,i);Pv(r,o)||(t.uniform1iv(this.addr,o),Nv(r,o));for(let a=0;a!==i;++a)n.setTexture2D(e[a]||_v,o[a])}function gb(t,e,n){const r=this.cache,i=e.length,o=Ov(n,i);Pv(r,o)||(t.uniform1iv(this.addr,o),Nv(r,o));for(let a=0;a!==i;++a)n.setTexture3D(e[a]||Tv,o[a])}function yb(t,e,n){const r=this.cache,i=e.length,o=Ov(n,i);Pv(r,o)||(t.uniform1iv(this.addr,o),Nv(r,o));for(let a=0;a!==i;++a)n.setTextureCube(e[a]||Ev,o[a])}function vb(t,e,n){const r=this.cache,i=e.length,o=Ov(n,i);Pv(r,o)||(t.uniform1iv(this.addr,o),Nv(r,o));for(let a=0;a!==i;++a)n.setTexture2DArray(e[a]||Sv,o[a])}class bb{constructor(t,e,n){this.id=t,this.addr=n,this.cache=[],this.type=e.type,this.setValue=function(t){switch(t){case 5126:return Dv;case 35664:return Lv;case 35665:return Fv;case 35666:return Uv;case 35674:return Bv;case 35675:return zv;case 35676:return jv;case 5124:case 35670:return Vv;case 35667:case 35671:return Wv;case 35668:case 35672:return Gv;case 35669:case 35673:return Hv;case 5125:return qv;case 36294:return Xv;case 36295:return Yv;case 36296:return Kv;case 35678:case 36198:case 36298:case 36306:case 35682:return Zv;case 35679:case 36299:case 36307:return Jv;case 35680:case 36300:case 36308:case 36293:return Qv;case 36289:case 36303:case 36311:case 36292:return $v}}(e.type)}}class xb{constructor(t,e,n){this.id=t,this.addr=n,this.cache=[],this.type=e.type,this.size=e.size,this.setValue=function(t){switch(t){case 5126:return tb;case 35664:return eb;case 35665:return nb;case 35666:return rb;case 35674:return ib;case 35675:return ob;case 35676:return ab;case 5124:case 35670:return sb;case 35667:case 35671:return lb;case 35668:case 35672:return cb;case 35669:case 35673:return ub;case 5125:return hb;case 36294:return db;case 36295:return pb;case 36296:return fb;case 35678:case 36198:case 36298:case 36306:case 35682:return mb;case 35679:case 36299:case 36307:return gb;case 35680:case 36300:case 36308:case 36293:return yb;case 36289:case 36303:case 36311:case 36292:return vb}}(e.type)}}class _b{constructor(t){this.id=t,this.seq=[],this.map={}}setValue(t,e,n){const r=this.seq;for(let i=0,o=r.length;i!==o;++i){const o=r[i];o.setValue(t,e[o.id],n)}}}const wb=/(\w+)(\])?(\[|\.)?/g;function Sb(t,e){t.seq.push(e),t.map[e.id]=e}function Tb(t,e,n){const r=t.name,i=r.length;for(wb.lastIndex=0;;){const o=wb.exec(r),a=wb.lastIndex;let s=o[1];const l="]"===o[2],c=o[3];if(l&&(s|=0),void 0===c||"["===c&&a+2===i){Sb(n,void 0===c?new bb(s,t,e):new xb(s,t,e));break}{let t=n.map[s];void 0===t&&(t=new _b(s),Sb(n,t)),n=t}}}class Eb{constructor(t,e){this.seq=[],this.map={};const n=t.getProgramParameter(e,t.ACTIVE_UNIFORMS);for(let r=0;r<n;++r){const n=t.getActiveUniform(e,r);Tb(n,t.getUniformLocation(e,n.name),this)}}setValue(t,e,n,r){const i=this.map[e];void 0!==i&&i.setValue(t,n,r)}setOptional(t,e,n){const r=e[n];void 0!==r&&this.setValue(t,n,r)}static upload(t,e,n,r){for(let i=0,o=e.length;i!==o;++i){const o=e[i],a=n[o.id];!1!==a.needsUpdate&&o.setValue(t,a.value,r)}}static seqWithValue(t,e){const n=[];for(let r=0,i=t.length;r!==i;++r){const i=t[r];i.id in e&&n.push(i)}return n}}function Mb(t,e,n){const r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),r}const Cb=37297;let Ab=0;function kb(t,e,n){const r=t.getShaderParameter(e,t.COMPILE_STATUS),i=t.getShaderInfoLog(e).trim();if(r&&""===i)return"";const o=/ERROR: 0:(\d+)/.exec(i);if(o){const r=parseInt(o[1]);return n.toUpperCase()+"\n\n"+i+"\n\n"+function(t,e){const n=t.split("\n"),r=[],i=Math.max(e-6,0),o=Math.min(e+6,n.length);for(let a=i;a<o;a++){const t=a+1;r.push("".concat(t===e?">":" "," ").concat(t,": ").concat(n[a]))}return r.join("\n")}(t.getShaderSource(e),r)}return i}function Ib(t,e){const n=function(t){const e=Df.getPrimaries(Df.workingColorSpace),n=Df.getPrimaries(t);let r;switch(e===n?r="":e===Tp&&n===Sp?r="LinearDisplayP3ToLinearSRGB":e===Sp&&n===Tp&&(r="LinearSRGBToLinearDisplayP3"),t){case vp:case xp:return[r,"LinearTransferOETF"];case yp:case bp:return[r,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",t),[r,"LinearTransferOETF"]}}(e);return"vec4 ".concat(t,"( vec4 value ) { return ").concat(n[0],"( ").concat(n[1],"( value ) ); }")}function Rb(t,e){let n;switch(e){case wh:n="Linear";break;case Sh:n="Reinhard";break;case Th:n="OptimizedCineon";break;case Eh:n="ACESFilmic";break;case Ch:n="AgX";break;case Ah:n="Neutral";break;case Mh:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),n="Linear"}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function Pb(t){return""!==t}function Nb(t,e){const n=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function Ob(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const Db=/^[ \t]*#include +<([\w\d./]+)>/gm;function Lb(t){return t.replace(Db,Ub)}const Fb=new Map;function Ub(t,e){let n=Uy[e];if(void 0===n){const t=Fb.get(e);if(void 0===t)throw new Error("Can not resolve #include <"+e+">");n=Uy[t],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,t)}return Lb(n)}const Bb=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function zb(t){return t.replace(Bb,jb)}function jb(t,e,n,r){let i="";for(let o=parseInt(e);o<parseInt(n);o++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return i}function Vb(t){let e="precision ".concat(t.precision," float;\n\tprecision ").concat(t.precision," int;\n\tprecision ").concat(t.precision," sampler2D;\n\tprecision ").concat(t.precision," samplerCube;\n\tprecision ").concat(t.precision," sampler3D;\n\tprecision ").concat(t.precision," sampler2DArray;\n\tprecision ").concat(t.precision," sampler2DShadow;\n\tprecision ").concat(t.precision," samplerCubeShadow;\n\tprecision ").concat(t.precision," sampler2DArrayShadow;\n\tprecision ").concat(t.precision," isampler2D;\n\tprecision ").concat(t.precision," isampler3D;\n\tprecision ").concat(t.precision," isamplerCube;\n\tprecision ").concat(t.precision," isampler2DArray;\n\tprecision ").concat(t.precision," usampler2D;\n\tprecision ").concat(t.precision," usampler3D;\n\tprecision ").concat(t.precision," usamplerCube;\n\tprecision ").concat(t.precision," usampler2DArray;\n\t");return"highp"===t.precision?e+="\n#define HIGH_PRECISION":"mediump"===t.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===t.precision&&(e+="\n#define LOW_PRECISION"),e}function Wb(t,e,n,r){const i=t.getContext(),o=n.defines;let a=n.vertexShader,s=n.fragmentShader;const l=function(t){let e="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===Pu?e="SHADOWMAP_TYPE_PCF":t.shadowMapType===Nu?e="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===Ou&&(e="SHADOWMAP_TYPE_VSM"),e}(n),c=function(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case Ph:case Nh:e="ENVMAP_TYPE_CUBE";break;case Lh:e="ENVMAP_TYPE_CUBE_UV"}return e}(n),u=function(t){let e="ENVMAP_MODE_REFLECTION";t.envMap&&t.envMapMode===Nh&&(e="ENVMAP_MODE_REFRACTION");return e}(n),h=function(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case vh:e="ENVMAP_BLENDING_MULTIPLY";break;case bh:e="ENVMAP_BLENDING_MIX";break;case xh:e="ENVMAP_BLENDING_ADD"}return e}(n),d=function(t){const e=t.envMapCubeUVHeight;if(null===e)return null;const n=Math.log2(e)-2,r=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,n),112)),texelHeight:r,maxMip:n}}(n),p=function(t){return[t.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",t.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(Pb).join("\n")}(n),f=function(t){const e=[];for(const n in t){const r=t[n];!1!==r&&e.push("#define "+n+" "+r)}return e.join("\n")}(o),m=i.createProgram();let g,y,v=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?(g=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,f].filter(Pb).join("\n"),g.length>0&&(g+="\n"),y=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,f].filter(Pb).join("\n"),y.length>0&&(y+="\n")):(g=[Vb(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,f,n.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",n.batching?"#define USE_BATCHING":"",n.batchingColor?"#define USE_BATCHING_COLOR":"",n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.instancingMorph?"#define USE_INSTANCING_MORPH":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+u:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+n.anisotropyMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents&&!1===n.flatShading?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.morphColors?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","\tuniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Pb).join("\n"),y=[Vb(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,f,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+c:"",n.envMap?"#define "+u:"",n.envMap?"#define "+h:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.dispersion?"#define USE_DISPERSION":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents&&!1===n.flatShading?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor||n.batchingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==_h?"#define TONE_MAPPING":"",n.toneMapping!==_h?Uy.tonemapping_pars_fragment:"",n.toneMapping!==_h?Rb("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",Uy.colorspace_pars_fragment,Ib("linearToOutputTexel",n.outputColorSpace),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(Pb).join("\n")),a=Lb(a),a=Nb(a,n),a=Ob(a,n),s=Lb(s),s=Nb(s,n),s=Ob(s,n),a=zb(a),s=zb(s),!0!==n.isRawShaderMaterial&&(v="#version 300 es\n",g=[p,"#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+g,y=["#define varying in",n.glslVersion===af?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===af?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+y);const b=v+g+a,x=v+y+s,_=Mb(i,i.VERTEX_SHADER,b),w=Mb(i,i.FRAGMENT_SHADER,x);function S(e){if(t.debug.checkShaderErrors){const n=i.getProgramInfoLog(m).trim(),r=i.getShaderInfoLog(_).trim(),o=i.getShaderInfoLog(w).trim();let a=!0,s=!0;if(!1===i.getProgramParameter(m,i.LINK_STATUS))if(a=!1,"function"===typeof t.debug.onShaderError)t.debug.onShaderError(i,m,_,w);else{const t=kb(i,_,"vertex"),r=kb(i,w,"fragment");console.error("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(m,i.VALIDATE_STATUS)+"\n\nMaterial Name: "+e.name+"\nMaterial Type: "+e.type+"\n\nProgram Info Log: "+n+"\n"+t+"\n"+r)}else""!==n?console.warn("THREE.WebGLProgram: Program Info Log:",n):""!==r&&""!==o||(s=!1);s&&(e.diagnostics={runnable:a,programLog:n,vertexShader:{log:r,prefix:g},fragmentShader:{log:o,prefix:y}})}i.deleteShader(_),i.deleteShader(w),T=new Eb(i,m),E=function(t,e){const n={},r=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let i=0;i<r;i++){const r=t.getActiveAttrib(e,i),o=r.name;let a=1;r.type===t.FLOAT_MAT2&&(a=2),r.type===t.FLOAT_MAT3&&(a=3),r.type===t.FLOAT_MAT4&&(a=4),n[o]={type:r.type,location:t.getAttribLocation(e,o),locationSize:a}}return n}(i,m)}let T,E;i.attachShader(m,_),i.attachShader(m,w),void 0!==n.index0AttributeName?i.bindAttribLocation(m,0,n.index0AttributeName):!0===n.morphTargets&&i.bindAttribLocation(m,0,"position"),i.linkProgram(m),this.getUniforms=function(){return void 0===T&&S(this),T},this.getAttributes=function(){return void 0===E&&S(this),E};let M=!1===n.rendererExtensionParallelShaderCompile;return this.isReady=function(){return!1===M&&(M=i.getProgramParameter(m,Cb)),M},this.destroy=function(){r.releaseStatesOfProgram(this),i.deleteProgram(m),this.program=void 0},this.type=n.shaderType,this.name=n.shaderName,this.id=Ab++,this.cacheKey=e,this.usedTimes=1,this.program=m,this.vertexShader=_,this.fragmentShader=w,this}let Gb=0;class Hb{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(t){const e=t.vertexShader,n=t.fragmentShader,r=this._getShaderStage(e),i=this._getShaderStage(n),o=this._getShaderCacheForMaterial(t);return!1===o.has(r)&&(o.add(r),r.usedTimes++),!1===o.has(i)&&(o.add(i),i.usedTimes++),this}remove(t){const e=this.materialCache.get(t);for(const n of e)n.usedTimes--,0===n.usedTimes&&this.shaderCache.delete(n.code);return this.materialCache.delete(t),this}getVertexShaderID(t){return this._getShaderStage(t.vertexShader).id}getFragmentShaderID(t){return this._getShaderStage(t.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(t){const e=this.materialCache;let n=e.get(t);return void 0===n&&(n=new Set,e.set(t,n)),n}_getShaderStage(t){const e=this.shaderCache;let n=e.get(t);return void 0===n&&(n=new qb(t),e.set(t,n)),n}}class qb{constructor(t){this.id=Gb++,this.code=t,this.usedTimes=0}}function Xb(t,e,n,r,i,o,a){const s=new zm,l=new Hb,c=new Set,u=[],h=i.logarithmicDepthBuffer,d=i.vertexTextures;let p=i.precision;const f={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function m(t){return c.add(t),0===t?"uv":"uv".concat(t)}return{getParameters:function(o,s,u,g,y){const v=g.fog,b=y.geometry,x=o.isMeshStandardMaterial?g.environment:null,_=(o.isMeshStandardMaterial?n:e).get(o.envMap||x),w=_&&_.mapping===Lh?_.image.height:null,S=f[o.type];null!==o.precision&&(p=i.getMaxPrecision(o.precision),p!==o.precision&&console.warn("THREE.WebGLProgram.getParameters:",o.precision,"not supported, using",p,"instead."));const T=b.morphAttributes.position||b.morphAttributes.normal||b.morphAttributes.color,E=void 0!==T?T.length:0;let M,C,A,k,I=0;if(void 0!==b.morphAttributes.position&&(I=1),void 0!==b.morphAttributes.normal&&(I=2),void 0!==b.morphAttributes.color&&(I=3),S){const t=zy[S];M=t.vertexShader,C=t.fragmentShader}else M=o.vertexShader,C=o.fragmentShader,l.update(o),A=l.getVertexShaderID(o),k=l.getFragmentShaderID(o);const R=t.getRenderTarget(),P=!0===y.isInstancedMesh,N=!0===y.isBatchedMesh,O=!!o.map,D=!!o.matcap,L=!!_,F=!!o.aoMap,U=!!o.lightMap,B=!!o.bumpMap,z=!!o.normalMap,j=!!o.displacementMap,V=!!o.emissiveMap,W=!!o.metalnessMap,G=!!o.roughnessMap,H=o.anisotropy>0,q=o.clearcoat>0,X=o.dispersion>0,Y=o.iridescence>0,K=o.sheen>0,Z=o.transmission>0,J=H&&!!o.anisotropyMap,Q=q&&!!o.clearcoatMap,$=q&&!!o.clearcoatNormalMap,tt=q&&!!o.clearcoatRoughnessMap,et=Y&&!!o.iridescenceMap,nt=Y&&!!o.iridescenceThicknessMap,rt=K&&!!o.sheenColorMap,it=K&&!!o.sheenRoughnessMap,ot=!!o.specularMap,at=!!o.specularColorMap,st=!!o.specularIntensityMap,lt=Z&&!!o.transmissionMap,ct=Z&&!!o.thicknessMap,ut=!!o.gradientMap,ht=!!o.alphaMap,dt=o.alphaTest>0,pt=!!o.alphaHash,ft=!!o.extensions;let mt=_h;o.toneMapped&&(null!==R&&!0!==R.isXRRenderTarget||(mt=t.toneMapping));const gt={shaderID:S,shaderType:o.type,shaderName:o.name,vertexShader:M,fragmentShader:C,defines:o.defines,customVertexShaderID:A,customFragmentShaderID:k,isRawShaderMaterial:!0===o.isRawShaderMaterial,glslVersion:o.glslVersion,precision:p,batching:N,batchingColor:N&&null!==y._colorsTexture,instancing:P,instancingColor:P&&null!==y.instanceColor,instancingMorph:P&&null!==y.morphTexture,supportsVertexTextures:d,outputColorSpace:null===R?t.outputColorSpace:!0===R.isXRRenderTarget?R.texture.colorSpace:vp,alphaToCoverage:!!o.alphaToCoverage,map:O,matcap:D,envMap:L,envMapMode:L&&_.mapping,envMapCubeUVHeight:w,aoMap:F,lightMap:U,bumpMap:B,normalMap:z,displacementMap:d&&j,emissiveMap:V,normalMapObjectSpace:z&&o.normalMapType===mp,normalMapTangentSpace:z&&o.normalMapType===fp,metalnessMap:W,roughnessMap:G,anisotropy:H,anisotropyMap:J,clearcoat:q,clearcoatMap:Q,clearcoatNormalMap:$,clearcoatRoughnessMap:tt,dispersion:X,iridescence:Y,iridescenceMap:et,iridescenceThicknessMap:nt,sheen:K,sheenColorMap:rt,sheenRoughnessMap:it,specularMap:ot,specularColorMap:at,specularIntensityMap:st,transmission:Z,transmissionMap:lt,thicknessMap:ct,gradientMap:ut,opaque:!1===o.transparent&&o.blending===Bu&&!1===o.alphaToCoverage,alphaMap:ht,alphaTest:dt,alphaHash:pt,combine:o.combine,mapUv:O&&m(o.map.channel),aoMapUv:F&&m(o.aoMap.channel),lightMapUv:U&&m(o.lightMap.channel),bumpMapUv:B&&m(o.bumpMap.channel),normalMapUv:z&&m(o.normalMap.channel),displacementMapUv:j&&m(o.displacementMap.channel),emissiveMapUv:V&&m(o.emissiveMap.channel),metalnessMapUv:W&&m(o.metalnessMap.channel),roughnessMapUv:G&&m(o.roughnessMap.channel),anisotropyMapUv:J&&m(o.anisotropyMap.channel),clearcoatMapUv:Q&&m(o.clearcoatMap.channel),clearcoatNormalMapUv:$&&m(o.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:tt&&m(o.clearcoatRoughnessMap.channel),iridescenceMapUv:et&&m(o.iridescenceMap.channel),iridescenceThicknessMapUv:nt&&m(o.iridescenceThicknessMap.channel),sheenColorMapUv:rt&&m(o.sheenColorMap.channel),sheenRoughnessMapUv:it&&m(o.sheenRoughnessMap.channel),specularMapUv:ot&&m(o.specularMap.channel),specularColorMapUv:at&&m(o.specularColorMap.channel),specularIntensityMapUv:st&&m(o.specularIntensityMap.channel),transmissionMapUv:lt&&m(o.transmissionMap.channel),thicknessMapUv:ct&&m(o.thicknessMap.channel),alphaMapUv:ht&&m(o.alphaMap.channel),vertexTangents:!!b.attributes.tangent&&(z||H),vertexColors:o.vertexColors,vertexAlphas:!0===o.vertexColors&&!!b.attributes.color&&4===b.attributes.color.itemSize,pointsUvs:!0===y.isPoints&&!!b.attributes.uv&&(O||ht),fog:!!v,useFog:!0===o.fog,fogExp2:!!v&&v.isFogExp2,flatShading:!0===o.flatShading,sizeAttenuation:!0===o.sizeAttenuation,logarithmicDepthBuffer:h,skinning:!0===y.isSkinnedMesh,morphTargets:void 0!==b.morphAttributes.position,morphNormals:void 0!==b.morphAttributes.normal,morphColors:void 0!==b.morphAttributes.color,morphTargetsCount:E,morphTextureStride:I,numDirLights:s.directional.length,numPointLights:s.point.length,numSpotLights:s.spot.length,numSpotLightMaps:s.spotLightMap.length,numRectAreaLights:s.rectArea.length,numHemiLights:s.hemi.length,numDirLightShadows:s.directionalShadowMap.length,numPointLightShadows:s.pointShadowMap.length,numSpotLightShadows:s.spotShadowMap.length,numSpotLightShadowsWithMaps:s.numSpotLightShadowsWithMaps,numLightProbes:s.numLightProbes,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:o.dithering,shadowMapEnabled:t.shadowMap.enabled&&u.length>0,shadowMapType:t.shadowMap.type,toneMapping:mt,decodeVideoTexture:O&&!0===o.map.isVideoTexture&&Df.getTransfer(o.map.colorSpace)===wp,premultipliedAlpha:o.premultipliedAlpha,doubleSided:o.side===Fu,flipSided:o.side===Lu,useDepthPacking:o.depthPacking>=0,depthPacking:o.depthPacking||0,index0AttributeName:o.index0AttributeName,extensionClipCullDistance:ft&&!0===o.extensions.clipCullDistance&&r.has("WEBGL_clip_cull_distance"),extensionMultiDraw:ft&&!0===o.extensions.multiDraw&&r.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:r.has("KHR_parallel_shader_compile"),customProgramCacheKey:o.customProgramCacheKey()};return gt.vertexUv1s=c.has(1),gt.vertexUv2s=c.has(2),gt.vertexUv3s=c.has(3),c.clear(),gt},getProgramCacheKey:function(e){const n=[];if(e.shaderID?n.push(e.shaderID):(n.push(e.customVertexShaderID),n.push(e.customFragmentShaderID)),void 0!==e.defines)for(const t in e.defines)n.push(t),n.push(e.defines[t]);return!1===e.isRawShaderMaterial&&(!function(t,e){t.push(e.precision),t.push(e.outputColorSpace),t.push(e.envMapMode),t.push(e.envMapCubeUVHeight),t.push(e.mapUv),t.push(e.alphaMapUv),t.push(e.lightMapUv),t.push(e.aoMapUv),t.push(e.bumpMapUv),t.push(e.normalMapUv),t.push(e.displacementMapUv),t.push(e.emissiveMapUv),t.push(e.metalnessMapUv),t.push(e.roughnessMapUv),t.push(e.anisotropyMapUv),t.push(e.clearcoatMapUv),t.push(e.clearcoatNormalMapUv),t.push(e.clearcoatRoughnessMapUv),t.push(e.iridescenceMapUv),t.push(e.iridescenceThicknessMapUv),t.push(e.sheenColorMapUv),t.push(e.sheenRoughnessMapUv),t.push(e.specularMapUv),t.push(e.specularColorMapUv),t.push(e.specularIntensityMapUv),t.push(e.transmissionMapUv),t.push(e.thicknessMapUv),t.push(e.combine),t.push(e.fogExp2),t.push(e.sizeAttenuation),t.push(e.morphTargetsCount),t.push(e.morphAttributeCount),t.push(e.numDirLights),t.push(e.numPointLights),t.push(e.numSpotLights),t.push(e.numSpotLightMaps),t.push(e.numHemiLights),t.push(e.numRectAreaLights),t.push(e.numDirLightShadows),t.push(e.numPointLightShadows),t.push(e.numSpotLightShadows),t.push(e.numSpotLightShadowsWithMaps),t.push(e.numLightProbes),t.push(e.shadowMapType),t.push(e.toneMapping),t.push(e.numClippingPlanes),t.push(e.numClipIntersection),t.push(e.depthPacking)}(n,e),function(t,e){s.disableAll(),e.supportsVertexTextures&&s.enable(0);e.instancing&&s.enable(1);e.instancingColor&&s.enable(2);e.instancingMorph&&s.enable(3);e.matcap&&s.enable(4);e.envMap&&s.enable(5);e.normalMapObjectSpace&&s.enable(6);e.normalMapTangentSpace&&s.enable(7);e.clearcoat&&s.enable(8);e.iridescence&&s.enable(9);e.alphaTest&&s.enable(10);e.vertexColors&&s.enable(11);e.vertexAlphas&&s.enable(12);e.vertexUv1s&&s.enable(13);e.vertexUv2s&&s.enable(14);e.vertexUv3s&&s.enable(15);e.vertexTangents&&s.enable(16);e.anisotropy&&s.enable(17);e.alphaHash&&s.enable(18);e.batching&&s.enable(19);e.dispersion&&s.enable(20);e.batchingColor&&s.enable(21);t.push(s.mask),s.disableAll(),e.fog&&s.enable(0);e.useFog&&s.enable(1);e.flatShading&&s.enable(2);e.logarithmicDepthBuffer&&s.enable(3);e.skinning&&s.enable(4);e.morphTargets&&s.enable(5);e.morphNormals&&s.enable(6);e.morphColors&&s.enable(7);e.premultipliedAlpha&&s.enable(8);e.shadowMapEnabled&&s.enable(9);e.doubleSided&&s.enable(10);e.flipSided&&s.enable(11);e.useDepthPacking&&s.enable(12);e.dithering&&s.enable(13);e.transmission&&s.enable(14);e.sheen&&s.enable(15);e.opaque&&s.enable(16);e.pointsUvs&&s.enable(17);e.decodeVideoTexture&&s.enable(18);e.alphaToCoverage&&s.enable(19);t.push(s.mask)}(n,e),n.push(t.outputColorSpace)),n.push(e.customProgramCacheKey),n.join()},getUniforms:function(t){const e=f[t.type];let n;if(e){const t=zy[e];n=yy.clone(t.uniforms)}else n=t.uniforms;return n},acquireProgram:function(e,n){let r;for(let t=0,i=u.length;t<i;t++){const e=u[t];if(e.cacheKey===n){r=e,++r.usedTimes;break}}return void 0===r&&(r=new Wb(t,n,e,o),u.push(r)),r},releaseProgram:function(t){if(0===--t.usedTimes){const e=u.indexOf(t);u[e]=u[u.length-1],u.pop(),t.destroy()}},releaseShaderCache:function(t){l.remove(t)},programs:u,dispose:function(){l.dispose()}}}function Yb(){let t=new WeakMap;return{get:function(e){let n=t.get(e);return void 0===n&&(n={},t.set(e,n)),n},remove:function(e){t.delete(e)},update:function(e,n,r){t.get(e)[n]=r},dispose:function(){t=new WeakMap}}}function Kb(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function Zb(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function Jb(){const t=[];let e=0;const n=[],r=[],i=[];function o(n,r,i,o,a,s){let l=t[e];return void 0===l?(l={id:n.id,object:n,geometry:r,material:i,groupOrder:o,renderOrder:n.renderOrder,z:a,group:s},t[e]=l):(l.id=n.id,l.object=n,l.geometry=r,l.material=i,l.groupOrder=o,l.renderOrder=n.renderOrder,l.z=a,l.group=s),e++,l}return{opaque:n,transmissive:r,transparent:i,init:function(){e=0,n.length=0,r.length=0,i.length=0},push:function(t,e,a,s,l,c){const u=o(t,e,a,s,l,c);a.transmission>0?r.push(u):!0===a.transparent?i.push(u):n.push(u)},unshift:function(t,e,a,s,l,c){const u=o(t,e,a,s,l,c);a.transmission>0?r.unshift(u):!0===a.transparent?i.unshift(u):n.unshift(u)},finish:function(){for(let n=e,r=t.length;n<r;n++){const e=t[n];if(null===e.id)break;e.id=null,e.object=null,e.geometry=null,e.material=null,e.group=null}},sort:function(t,e){n.length>1&&n.sort(t||Kb),r.length>1&&r.sort(e||Zb),i.length>1&&i.sort(e||Zb)}}}function Qb(){let t=new WeakMap;return{get:function(e,n){const r=t.get(e);let i;return void 0===r?(i=new Jb,t.set(e,[i])):n>=r.length?(i=new Jb,r.push(i)):i=r[n],i},dispose:function(){t=new WeakMap}}}function $b(){const t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];let n;switch(e.type){case"DirectionalLight":n={direction:new $f,color:new vg};break;case"SpotLight":n={position:new $f,direction:new $f,color:new vg,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new $f,color:new vg,distance:0,decay:0};break;case"HemisphereLight":n={direction:new $f,skyColor:new vg,groundColor:new vg};break;case"RectAreaLight":n={color:new vg,position:new $f,halfWidth:new $f,halfHeight:new $f}}return t[e.id]=n,n}}}let tx=0;function ex(t,e){return(e.castShadow?2:0)-(t.castShadow?2:0)+(e.map?1:0)-(t.map?1:0)}function nx(t){const e=new $b,n=function(){const t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];let n;switch(e.type){case"DirectionalLight":case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new _f};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new _f,shadowCameraNear:1,shadowCameraFar:1e3}}return t[e.id]=n,n}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let s=0;s<9;s++)r.probe.push(new $f);const i=new $f,o=new km,a=new km;return{setup:function(i){let o=0,a=0,s=0;for(let t=0;t<9;t++)r.probe[t].set(0,0,0);let l=0,c=0,u=0,h=0,d=0,p=0,f=0,m=0,g=0,y=0,v=0;i.sort(ex);for(let t=0,x=i.length;t<x;t++){const b=i[t],x=b.color,_=b.intensity,w=b.distance,S=b.shadow&&b.shadow.map?b.shadow.map.texture:null;if(b.isAmbientLight)o+=x.r*_,a+=x.g*_,s+=x.b*_;else if(b.isLightProbe){for(let t=0;t<9;t++)r.probe[t].addScaledVector(b.sh.coefficients[t],_);v++}else if(b.isDirectionalLight){const t=e.get(b);if(t.color.copy(b.color).multiplyScalar(b.intensity),b.castShadow){const t=b.shadow,e=n.get(b);e.shadowBias=t.bias,e.shadowNormalBias=t.normalBias,e.shadowRadius=t.radius,e.shadowMapSize=t.mapSize,r.directionalShadow[l]=e,r.directionalShadowMap[l]=S,r.directionalShadowMatrix[l]=b.shadow.matrix,p++}r.directional[l]=t,l++}else if(b.isSpotLight){const t=e.get(b);t.position.setFromMatrixPosition(b.matrixWorld),t.color.copy(x).multiplyScalar(_),t.distance=w,t.coneCos=Math.cos(b.angle),t.penumbraCos=Math.cos(b.angle*(1-b.penumbra)),t.decay=b.decay,r.spot[u]=t;const i=b.shadow;if(b.map&&(r.spotLightMap[g]=b.map,g++,i.updateMatrices(b),b.castShadow&&y++),r.spotLightMatrix[u]=i.matrix,b.castShadow){const t=n.get(b);t.shadowBias=i.bias,t.shadowNormalBias=i.normalBias,t.shadowRadius=i.radius,t.shadowMapSize=i.mapSize,r.spotShadow[u]=t,r.spotShadowMap[u]=S,m++}u++}else if(b.isRectAreaLight){const t=e.get(b);t.color.copy(x).multiplyScalar(_),t.halfWidth.set(.5*b.width,0,0),t.halfHeight.set(0,.5*b.height,0),r.rectArea[h]=t,h++}else if(b.isPointLight){const t=e.get(b);if(t.color.copy(b.color).multiplyScalar(b.intensity),t.distance=b.distance,t.decay=b.decay,b.castShadow){const t=b.shadow,e=n.get(b);e.shadowBias=t.bias,e.shadowNormalBias=t.normalBias,e.shadowRadius=t.radius,e.shadowMapSize=t.mapSize,e.shadowCameraNear=t.camera.near,e.shadowCameraFar=t.camera.far,r.pointShadow[c]=e,r.pointShadowMap[c]=S,r.pointShadowMatrix[c]=b.shadow.matrix,f++}r.point[c]=t,c++}else if(b.isHemisphereLight){const t=e.get(b);t.skyColor.copy(b.color).multiplyScalar(_),t.groundColor.copy(b.groundColor).multiplyScalar(_),r.hemi[d]=t,d++}}h>0&&(!0===t.has("OES_texture_float_linear")?(r.rectAreaLTC1=By.LTC_FLOAT_1,r.rectAreaLTC2=By.LTC_FLOAT_2):(r.rectAreaLTC1=By.LTC_HALF_1,r.rectAreaLTC2=By.LTC_HALF_2)),r.ambient[0]=o,r.ambient[1]=a,r.ambient[2]=s;const b=r.hash;b.directionalLength===l&&b.pointLength===c&&b.spotLength===u&&b.rectAreaLength===h&&b.hemiLength===d&&b.numDirectionalShadows===p&&b.numPointShadows===f&&b.numSpotShadows===m&&b.numSpotMaps===g&&b.numLightProbes===v||(r.directional.length=l,r.spot.length=u,r.rectArea.length=h,r.point.length=c,r.hemi.length=d,r.directionalShadow.length=p,r.directionalShadowMap.length=p,r.pointShadow.length=f,r.pointShadowMap.length=f,r.spotShadow.length=m,r.spotShadowMap.length=m,r.directionalShadowMatrix.length=p,r.pointShadowMatrix.length=f,r.spotLightMatrix.length=m+g-y,r.spotLightMap.length=g,r.numSpotLightShadowsWithMaps=y,r.numLightProbes=v,b.directionalLength=l,b.pointLength=c,b.spotLength=u,b.rectAreaLength=h,b.hemiLength=d,b.numDirectionalShadows=p,b.numPointShadows=f,b.numSpotShadows=m,b.numSpotMaps=g,b.numLightProbes=v,r.version=tx++)},setupView:function(t,e){let n=0,s=0,l=0,c=0,u=0;const h=e.matrixWorldInverse;for(let d=0,p=t.length;d<p;d++){const e=t[d];if(e.isDirectionalLight){const t=r.directional[n];t.direction.setFromMatrixPosition(e.matrixWorld),i.setFromMatrixPosition(e.target.matrixWorld),t.direction.sub(i),t.direction.transformDirection(h),n++}else if(e.isSpotLight){const t=r.spot[l];t.position.setFromMatrixPosition(e.matrixWorld),t.position.applyMatrix4(h),t.direction.setFromMatrixPosition(e.matrixWorld),i.setFromMatrixPosition(e.target.matrixWorld),t.direction.sub(i),t.direction.transformDirection(h),l++}else if(e.isRectAreaLight){const t=r.rectArea[c];t.position.setFromMatrixPosition(e.matrixWorld),t.position.applyMatrix4(h),a.identity(),o.copy(e.matrixWorld),o.premultiply(h),a.extractRotation(o),t.halfWidth.set(.5*e.width,0,0),t.halfHeight.set(0,.5*e.height,0),t.halfWidth.applyMatrix4(a),t.halfHeight.applyMatrix4(a),c++}else if(e.isPointLight){const t=r.point[s];t.position.setFromMatrixPosition(e.matrixWorld),t.position.applyMatrix4(h),s++}else if(e.isHemisphereLight){const t=r.hemi[u];t.direction.setFromMatrixPosition(e.matrixWorld),t.direction.transformDirection(h),u++}}},state:r}}function rx(t){const e=new nx(t),n=[],r=[];const i={lightsArray:n,shadowsArray:r,camera:null,lights:e,transmissionRenderTarget:{}};return{init:function(t){i.camera=t,n.length=0,r.length=0},state:i,setupLights:function(){e.setup(n)},setupLightsView:function(t){e.setupView(n,t)},pushLight:function(t){n.push(t)},pushShadow:function(t){r.push(t)}}}function ix(t){let e=new WeakMap;return{get:function(n){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const i=e.get(n);let o;return void 0===i?(o=new rx(t),e.set(n,[o])):r>=i.length?(o=new rx(t),i.push(o)):o=i[r],o},dispose:function(){e=new WeakMap}}}class ox extends _g{constructor(t){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=dp,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(t)}copy(t){return super.copy(t),this.depthPacking=t.depthPacking,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this}}class ax extends _g{constructor(t){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(t)}copy(t){return super.copy(t),this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this}}function sx(t,e,n){let r=new Oy;const i=new _f,o=new _f,a=new Hf,s=new ox({depthPacking:pp}),l=new ax,c={},u=n.maxTextureSize,h={[Du]:Lu,[Lu]:Du,[Fu]:Fu},d=new vy({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new _f},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),p=d.clone();p.defines.HORIZONTAL_PASS=1;const f=new Xg;f.setAttribute("position",new Ig(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const m=new hy(f,d),g=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Pu;let y=this.type;function v(n,r){const o=e.update(m);d.defines.VSM_SAMPLES!==n.blurSamples&&(d.defines.VSM_SAMPLES=n.blurSamples,p.defines.VSM_SAMPLES=n.blurSamples,d.needsUpdate=!0,p.needsUpdate=!0),null===n.mapPass&&(n.mapPass=new Xf(i.x,i.y)),d.uniforms.shadow_pass.value=n.map.texture,d.uniforms.resolution.value=n.mapSize,d.uniforms.radius.value=n.radius,t.setRenderTarget(n.mapPass),t.clear(),t.renderBufferDirect(r,null,o,d,m,null),p.uniforms.shadow_pass.value=n.mapPass.texture,p.uniforms.resolution.value=n.mapSize,p.uniforms.radius.value=n.radius,t.setRenderTarget(n.map),t.clear(),t.renderBufferDirect(r,null,o,p,m,null)}function b(e,n,r,i){let o=null;const a=!0===r.isPointLight?e.customDistanceMaterial:e.customDepthMaterial;if(void 0!==a)o=a;else if(o=!0===r.isPointLight?l:s,t.localClippingEnabled&&!0===n.clipShadows&&Array.isArray(n.clippingPlanes)&&0!==n.clippingPlanes.length||n.displacementMap&&0!==n.displacementScale||n.alphaMap&&n.alphaTest>0||n.map&&n.alphaTest>0){const t=o.uuid,e=n.uuid;let r=c[t];void 0===r&&(r={},c[t]=r);let i=r[e];void 0===i&&(i=o.clone(),r[e]=i,n.addEventListener("dispose",_)),o=i}if(o.visible=n.visible,o.wireframe=n.wireframe,o.side=i===Ou?null!==n.shadowSide?n.shadowSide:n.side:null!==n.shadowSide?n.shadowSide:h[n.side],o.alphaMap=n.alphaMap,o.alphaTest=n.alphaTest,o.map=n.map,o.clipShadows=n.clipShadows,o.clippingPlanes=n.clippingPlanes,o.clipIntersection=n.clipIntersection,o.displacementMap=n.displacementMap,o.displacementScale=n.displacementScale,o.displacementBias=n.displacementBias,o.wireframeLinewidth=n.wireframeLinewidth,o.linewidth=n.linewidth,!0===r.isPointLight&&!0===o.isMeshDistanceMaterial){t.properties.get(o).light=r}return o}function x(n,i,o,a,s){if(!1===n.visible)return;if(n.layers.test(i.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&s===Ou)&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(o.matrixWorldInverse,n.matrixWorld);const r=e.update(n),l=n.material;if(Array.isArray(l)){const e=r.groups;for(let c=0,u=e.length;c<u;c++){const u=e[c],h=l[u.materialIndex];if(h&&h.visible){const e=b(n,h,a,s);n.onBeforeShadow(t,n,i,o,r,e,u),t.renderBufferDirect(o,null,r,e,n,u),n.onAfterShadow(t,n,i,o,r,e,u)}}}else if(l.visible){const e=b(n,l,a,s);n.onBeforeShadow(t,n,i,o,r,e,null),t.renderBufferDirect(o,null,r,e,n,null),n.onAfterShadow(t,n,i,o,r,e,null)}}const l=n.children;for(let t=0,e=l.length;t<e;t++)x(l[t],i,o,a,s)}function _(t){t.target.removeEventListener("dispose",_);for(const e in c){const n=c[e],r=t.target.uuid;if(r in n){n[r].dispose(),delete n[r]}}}this.render=function(e,n,s){if(!1===g.enabled)return;if(!1===g.autoUpdate&&!1===g.needsUpdate)return;if(0===e.length)return;const l=t.getRenderTarget(),c=t.getActiveCubeFace(),h=t.getActiveMipmapLevel(),d=t.state;d.setBlending(Uu),d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);const p=y!==Ou&&this.type===Ou,f=y===Ou&&this.type!==Ou;for(let m=0,g=e.length;m<g;m++){const l=e[m],c=l.shadow;if(void 0===c){console.warn("THREE.WebGLShadowMap:",l,"has no shadow.");continue}if(!1===c.autoUpdate&&!1===c.needsUpdate)continue;i.copy(c.mapSize);const h=c.getFrameExtents();if(i.multiply(h),o.copy(c.mapSize),(i.x>u||i.y>u)&&(i.x>u&&(o.x=Math.floor(u/h.x),i.x=o.x*h.x,c.mapSize.x=o.x),i.y>u&&(o.y=Math.floor(u/h.y),i.y=o.y*h.y,c.mapSize.y=o.y)),null===c.map||!0===p||!0===f){const t=this.type!==Ou?{minFilter:zh,magFilter:zh}:{};null!==c.map&&c.map.dispose(),c.map=new Xf(i.x,i.y,t),c.map.texture.name=l.name+".shadowMap",c.camera.updateProjectionMatrix()}t.setRenderTarget(c.map),t.clear();const g=c.getViewportCount();for(let t=0;t<g;t++){const e=c.getViewport(t);a.set(o.x*e.x,o.y*e.y,o.x*e.z,o.y*e.w),d.viewport(a),c.updateMatrices(l,t),r=c.getFrustum(),x(n,s,c.camera,l,this.type)}!0!==c.isPointLightShadow&&this.type===Ou&&v(c,s),c.needsUpdate=!1}y=this.type,g.needsUpdate=!1,t.setRenderTarget(l,c,h)}}function lx(t){const e=new function(){let e=!1;const n=new Hf;let r=null;const i=new Hf(0,0,0,0);return{setMask:function(n){r===n||e||(t.colorMask(n,n,n,n),r=n)},setLocked:function(t){e=t},setClear:function(e,r,o,a,s){!0===s&&(e*=a,r*=a,o*=a),n.set(e,r,o,a),!1===i.equals(n)&&(t.clearColor(e,r,o,a),i.copy(n))},reset:function(){e=!1,r=null,i.set(-1,0,0,0)}}},n=new function(){let e=!1,n=null,r=null,i=null;return{setTest:function(e){e?B(t.DEPTH_TEST):z(t.DEPTH_TEST)},setMask:function(r){n===r||e||(t.depthMask(r),n=r)},setFunc:function(e){if(r!==e){switch(e){case uh:t.depthFunc(t.NEVER);break;case hh:t.depthFunc(t.ALWAYS);break;case dh:t.depthFunc(t.LESS);break;case ph:t.depthFunc(t.LEQUAL);break;case fh:t.depthFunc(t.EQUAL);break;case mh:t.depthFunc(t.GEQUAL);break;case gh:t.depthFunc(t.GREATER);break;case yh:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}r=e}},setLocked:function(t){e=t},setClear:function(e){i!==e&&(t.clearDepth(e),i=e)},reset:function(){e=!1,n=null,r=null,i=null}}},r=new function(){let e=!1,n=null,r=null,i=null,o=null,a=null,s=null,l=null,c=null;return{setTest:function(n){e||(n?B(t.STENCIL_TEST):z(t.STENCIL_TEST))},setMask:function(r){n===r||e||(t.stencilMask(r),n=r)},setFunc:function(e,n,a){r===e&&i===n&&o===a||(t.stencilFunc(e,n,a),r=e,i=n,o=a)},setOp:function(e,n,r){a===e&&s===n&&l===r||(t.stencilOp(e,n,r),a=e,s=n,l=r)},setLocked:function(t){e=t},setClear:function(e){c!==e&&(t.clearStencil(e),c=e)},reset:function(){e=!1,n=null,r=null,i=null,o=null,a=null,s=null,l=null,c=null}}},i=new WeakMap,o=new WeakMap;let a={},s={},l=new WeakMap,c=[],u=null,h=!1,d=null,p=null,f=null,m=null,g=null,y=null,v=null,b=new vg(0,0,0),x=0,_=!1,w=null,S=null,T=null,E=null,M=null;const C=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let A=!1,k=0;const I=t.getParameter(t.VERSION);-1!==I.indexOf("WebGL")?(k=parseFloat(/^WebGL (\d)/.exec(I)[1]),A=k>=1):-1!==I.indexOf("OpenGL ES")&&(k=parseFloat(/^OpenGL ES (\d)/.exec(I)[1]),A=k>=2);let R=null,P={};const N=t.getParameter(t.SCISSOR_BOX),O=t.getParameter(t.VIEWPORT),D=(new Hf).fromArray(N),L=(new Hf).fromArray(O);function F(e,n,r,i){const o=new Uint8Array(4),a=t.createTexture();t.bindTexture(e,a),t.texParameteri(e,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(e,t.TEXTURE_MAG_FILTER,t.NEAREST);for(let s=0;s<r;s++)e===t.TEXTURE_3D||e===t.TEXTURE_2D_ARRAY?t.texImage3D(n,0,t.RGBA,1,1,i,0,t.RGBA,t.UNSIGNED_BYTE,o):t.texImage2D(n+s,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,o);return a}const U={};function B(e){!0!==a[e]&&(t.enable(e),a[e]=!0)}function z(e){!1!==a[e]&&(t.disable(e),a[e]=!1)}U[t.TEXTURE_2D]=F(t.TEXTURE_2D,t.TEXTURE_2D,1),U[t.TEXTURE_CUBE_MAP]=F(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),U[t.TEXTURE_2D_ARRAY]=F(t.TEXTURE_2D_ARRAY,t.TEXTURE_2D_ARRAY,1,1),U[t.TEXTURE_3D]=F(t.TEXTURE_3D,t.TEXTURE_3D,1,1),e.setClear(0,0,0,1),n.setClear(1),r.setClear(0),B(t.DEPTH_TEST),n.setFunc(ph),G(!1),H(Au),B(t.CULL_FACE),W(Uu);const j={[Gu]:t.FUNC_ADD,[Hu]:t.FUNC_SUBTRACT,[qu]:t.FUNC_REVERSE_SUBTRACT};j[Xu]=t.MIN,j[Yu]=t.MAX;const V={[Ku]:t.ZERO,[Zu]:t.ONE,[Ju]:t.SRC_COLOR,[$u]:t.SRC_ALPHA,[oh]:t.SRC_ALPHA_SATURATE,[rh]:t.DST_COLOR,[eh]:t.DST_ALPHA,[Qu]:t.ONE_MINUS_SRC_COLOR,[th]:t.ONE_MINUS_SRC_ALPHA,[ih]:t.ONE_MINUS_DST_COLOR,[nh]:t.ONE_MINUS_DST_ALPHA,[ah]:t.CONSTANT_COLOR,[sh]:t.ONE_MINUS_CONSTANT_COLOR,[lh]:t.CONSTANT_ALPHA,[ch]:t.ONE_MINUS_CONSTANT_ALPHA};function W(e,n,r,i,o,a,s,l,c,u){if(e!==Uu){if(!1===h&&(B(t.BLEND),h=!0),e===Wu)o=o||n,a=a||r,s=s||i,n===p&&o===g||(t.blendEquationSeparate(j[n],j[o]),p=n,g=o),r===f&&i===m&&a===y&&s===v||(t.blendFuncSeparate(V[r],V[i],V[a],V[s]),f=r,m=i,y=a,v=s),!1!==l.equals(b)&&c===x||(t.blendColor(l.r,l.g,l.b,c),b.copy(l),x=c),d=e,_=!1;else if(e!==d||u!==_){if(p===Gu&&g===Gu||(t.blendEquation(t.FUNC_ADD),p=Gu,g=Gu),u)switch(e){case Bu:t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case zu:t.blendFunc(t.ONE,t.ONE);break;case ju:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case Vu:t.blendFuncSeparate(t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}else switch(e){case Bu:t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case zu:t.blendFunc(t.SRC_ALPHA,t.ONE);break;case ju:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case Vu:t.blendFunc(t.ZERO,t.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}f=null,m=null,y=null,v=null,b.set(0,0,0),x=0,d=e,_=u}}else!0===h&&(z(t.BLEND),h=!1)}function G(e){w!==e&&(e?t.frontFace(t.CW):t.frontFace(t.CCW),w=e)}function H(e){e!==Cu?(B(t.CULL_FACE),e!==S&&(e===Au?t.cullFace(t.BACK):e===ku?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):z(t.CULL_FACE),S=e}function q(e,n,r){e?(B(t.POLYGON_OFFSET_FILL),E===n&&M===r||(t.polygonOffset(n,r),E=n,M=r)):z(t.POLYGON_OFFSET_FILL)}return{buffers:{color:e,depth:n,stencil:r},enable:B,disable:z,bindFramebuffer:function(e,n){return s[e]!==n&&(t.bindFramebuffer(e,n),s[e]=n,e===t.DRAW_FRAMEBUFFER&&(s[t.FRAMEBUFFER]=n),e===t.FRAMEBUFFER&&(s[t.DRAW_FRAMEBUFFER]=n),!0)},drawBuffers:function(e,n){let r=c,i=!1;if(e){r=l.get(n),void 0===r&&(r=[],l.set(n,r));const o=e.textures;if(r.length!==o.length||r[0]!==t.COLOR_ATTACHMENT0){for(let e=0,n=o.length;e<n;e++)r[e]=t.COLOR_ATTACHMENT0+e;r.length=o.length,i=!0}}else r[0]!==t.BACK&&(r[0]=t.BACK,i=!0);i&&t.drawBuffers(r)},useProgram:function(e){return u!==e&&(t.useProgram(e),u=e,!0)},setBlending:W,setMaterial:function(i,o){i.side===Fu?z(t.CULL_FACE):B(t.CULL_FACE);let a=i.side===Lu;o&&(a=!a),G(a),i.blending===Bu&&!1===i.transparent?W(Uu):W(i.blending,i.blendEquation,i.blendSrc,i.blendDst,i.blendEquationAlpha,i.blendSrcAlpha,i.blendDstAlpha,i.blendColor,i.blendAlpha,i.premultipliedAlpha),n.setFunc(i.depthFunc),n.setTest(i.depthTest),n.setMask(i.depthWrite),e.setMask(i.colorWrite);const s=i.stencilWrite;r.setTest(s),s&&(r.setMask(i.stencilWriteMask),r.setFunc(i.stencilFunc,i.stencilRef,i.stencilFuncMask),r.setOp(i.stencilFail,i.stencilZFail,i.stencilZPass)),q(i.polygonOffset,i.polygonOffsetFactor,i.polygonOffsetUnits),!0===i.alphaToCoverage?B(t.SAMPLE_ALPHA_TO_COVERAGE):z(t.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:G,setCullFace:H,setLineWidth:function(e){e!==T&&(A&&t.lineWidth(e),T=e)},setPolygonOffset:q,setScissorTest:function(e){e?B(t.SCISSOR_TEST):z(t.SCISSOR_TEST)},activeTexture:function(e){void 0===e&&(e=t.TEXTURE0+C-1),R!==e&&(t.activeTexture(e),R=e)},bindTexture:function(e,n,r){void 0===r&&(r=null===R?t.TEXTURE0+C-1:R);let i=P[r];void 0===i&&(i={type:void 0,texture:void 0},P[r]=i),i.type===e&&i.texture===n||(R!==r&&(t.activeTexture(r),R=r),t.bindTexture(e,n||U[e]),i.type=e,i.texture=n)},unbindTexture:function(){const e=P[R];void 0!==e&&void 0!==e.type&&(t.bindTexture(e.type,null),e.type=void 0,e.texture=void 0)},compressedTexImage2D:function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(oA){console.error("THREE.WebGLState:",oA)}},compressedTexImage3D:function(){try{t.compressedTexImage3D.apply(t,arguments)}catch(oA){console.error("THREE.WebGLState:",oA)}},texImage2D:function(){try{t.texImage2D.apply(t,arguments)}catch(oA){console.error("THREE.WebGLState:",oA)}},texImage3D:function(){try{t.texImage3D.apply(t,arguments)}catch(oA){console.error("THREE.WebGLState:",oA)}},updateUBOMapping:function(e,n){let r=o.get(n);void 0===r&&(r=new WeakMap,o.set(n,r));let i=r.get(e);void 0===i&&(i=t.getUniformBlockIndex(n,e.name),r.set(e,i))},uniformBlockBinding:function(e,n){const r=o.get(n).get(e);i.get(n)!==r&&(t.uniformBlockBinding(n,r,e.__bindingPointIndex),i.set(n,r))},texStorage2D:function(){try{t.texStorage2D.apply(t,arguments)}catch(oA){console.error("THREE.WebGLState:",oA)}},texStorage3D:function(){try{t.texStorage3D.apply(t,arguments)}catch(oA){console.error("THREE.WebGLState:",oA)}},texSubImage2D:function(){try{t.texSubImage2D.apply(t,arguments)}catch(oA){console.error("THREE.WebGLState:",oA)}},texSubImage3D:function(){try{t.texSubImage3D.apply(t,arguments)}catch(oA){console.error("THREE.WebGLState:",oA)}},compressedTexSubImage2D:function(){try{t.compressedTexSubImage2D.apply(t,arguments)}catch(oA){console.error("THREE.WebGLState:",oA)}},compressedTexSubImage3D:function(){try{t.compressedTexSubImage3D.apply(t,arguments)}catch(oA){console.error("THREE.WebGLState:",oA)}},scissor:function(e){!1===D.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),D.copy(e))},viewport:function(e){!1===L.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),L.copy(e))},reset:function(){t.disable(t.BLEND),t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SCISSOR_TEST),t.disable(t.STENCIL_TEST),t.disable(t.SAMPLE_ALPHA_TO_COVERAGE),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ZERO),t.blendFuncSeparate(t.ONE,t.ZERO,t.ONE,t.ZERO),t.blendColor(0,0,0,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(t.LESS),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(t.ALWAYS,0,4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.clearStencil(0),t.cullFace(t.BACK),t.frontFace(t.CCW),t.polygonOffset(0,0),t.activeTexture(t.TEXTURE0),t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),t.bindFramebuffer(t.READ_FRAMEBUFFER,null),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),a={},R=null,P={},s={},l=new WeakMap,c=[],u=null,h=!1,d=null,p=null,f=null,m=null,g=null,y=null,v=null,b=new vg(0,0,0),x=0,_=!1,w=null,S=null,T=null,E=null,M=null,D.set(0,0,t.canvas.width,t.canvas.height),L.set(0,0,t.canvas.width,t.canvas.height),e.reset(),n.reset(),r.reset()}}}function cx(t,e,n,r,i,o,a){const s=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,l="undefined"!==typeof navigator&&/OculusBrowser/g.test(navigator.userAgent),c=new _f,u=new WeakMap;let h;const d=new WeakMap;let p=!1;try{p="undefined"!==typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(j){}function f(t,e){return p?new OffscreenCanvas(t,e):Cf("canvas")}function m(t,e,n){let r=1;const i=z(t);if((i.width>n||i.height>n)&&(r=n/Math.max(i.width,i.height)),r<1){if("undefined"!==typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&t instanceof ImageBitmap||"undefined"!==typeof VideoFrame&&t instanceof VideoFrame){const n=Math.floor(r*i.width),o=Math.floor(r*i.height);void 0===h&&(h=f(n,o));const a=e?f(n,o):h;a.width=n,a.height=o;return a.getContext("2d").drawImage(t,0,0,n,o),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+i.width+"x"+i.height+") to ("+n+"x"+o+")."),a}return"data"in t&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+i.width+"x"+i.height+")."),t}return t}function g(t){return t.generateMipmaps&&t.minFilter!==zh&&t.minFilter!==Hh}function y(e){t.generateMipmap(e)}function v(n,r,i,o){let a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(null!==n){if(void 0!==t[n])return t[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}let s=r;if(r===t.RED&&(i===t.FLOAT&&(s=t.R32F),i===t.HALF_FLOAT&&(s=t.R16F),i===t.UNSIGNED_BYTE&&(s=t.R8)),r===t.RED_INTEGER&&(i===t.UNSIGNED_BYTE&&(s=t.R8UI),i===t.UNSIGNED_SHORT&&(s=t.R16UI),i===t.UNSIGNED_INT&&(s=t.R32UI),i===t.BYTE&&(s=t.R8I),i===t.SHORT&&(s=t.R16I),i===t.INT&&(s=t.R32I)),r===t.RG&&(i===t.FLOAT&&(s=t.RG32F),i===t.HALF_FLOAT&&(s=t.RG16F),i===t.UNSIGNED_BYTE&&(s=t.RG8)),r===t.RG_INTEGER&&(i===t.UNSIGNED_BYTE&&(s=t.RG8UI),i===t.UNSIGNED_SHORT&&(s=t.RG16UI),i===t.UNSIGNED_INT&&(s=t.RG32UI),i===t.BYTE&&(s=t.RG8I),i===t.SHORT&&(s=t.RG16I),i===t.INT&&(s=t.RG32I)),r===t.RGB&&i===t.UNSIGNED_INT_5_9_9_9_REV&&(s=t.RGB9_E5),r===t.RGBA){const e=a?_p:Df.getTransfer(o);i===t.FLOAT&&(s=t.RGBA32F),i===t.HALF_FLOAT&&(s=t.RGBA16F),i===t.UNSIGNED_BYTE&&(s=e===wp?t.SRGB8_ALPHA8:t.RGBA8),i===t.UNSIGNED_SHORT_4_4_4_4&&(s=t.RGBA4),i===t.UNSIGNED_SHORT_5_5_5_1&&(s=t.RGB5_A1)}return s!==t.R16F&&s!==t.R32F&&s!==t.RG16F&&s!==t.RG32F&&s!==t.RGBA16F&&s!==t.RGBA32F||e.get("EXT_color_buffer_float"),s}function b(e,n){let r;return e?null===n||n===ed||n===ad?r=t.DEPTH24_STENCIL8:n===nd?r=t.DEPTH32F_STENCIL8:n===$h&&(r=t.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):null===n||n===ed||n===ad?r=t.DEPTH_COMPONENT24:n===nd?r=t.DEPTH_COMPONENT32F:n===$h&&(r=t.DEPTH_COMPONENT16),r}function x(t,e){return!0===g(t)||t.isFramebufferTexture&&t.minFilter!==zh&&t.minFilter!==Hh?Math.log2(Math.max(e.width,e.height))+1:void 0!==t.mipmaps&&t.mipmaps.length>0?t.mipmaps.length:t.isCompressedTexture&&Array.isArray(t.image)?e.mipmaps.length:1}function _(t){const e=t.target;e.removeEventListener("dispose",_),function(t){const e=r.get(t);if(void 0===e.__webglInit)return;const n=t.source,i=d.get(n);if(i){const r=i[e.__cacheKey];r.usedTimes--,0===r.usedTimes&&S(t),0===Object.keys(i).length&&d.delete(n)}r.remove(t)}(e),e.isVideoTexture&&u.delete(e)}function w(e){const n=e.target;n.removeEventListener("dispose",w),function(e){const n=r.get(e);e.depthTexture&&e.depthTexture.dispose();if(e.isWebGLCubeRenderTarget)for(let r=0;r<6;r++){if(Array.isArray(n.__webglFramebuffer[r]))for(let e=0;e<n.__webglFramebuffer[r].length;e++)t.deleteFramebuffer(n.__webglFramebuffer[r][e]);else t.deleteFramebuffer(n.__webglFramebuffer[r]);n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer[r])}else{if(Array.isArray(n.__webglFramebuffer))for(let e=0;e<n.__webglFramebuffer.length;e++)t.deleteFramebuffer(n.__webglFramebuffer[e]);else t.deleteFramebuffer(n.__webglFramebuffer);if(n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer),n.__webglMultisampledFramebuffer&&t.deleteFramebuffer(n.__webglMultisampledFramebuffer),n.__webglColorRenderbuffer)for(let e=0;e<n.__webglColorRenderbuffer.length;e++)n.__webglColorRenderbuffer[e]&&t.deleteRenderbuffer(n.__webglColorRenderbuffer[e]);n.__webglDepthRenderbuffer&&t.deleteRenderbuffer(n.__webglDepthRenderbuffer)}const i=e.textures;for(let o=0,s=i.length;o<s;o++){const e=r.get(i[o]);e.__webglTexture&&(t.deleteTexture(e.__webglTexture),a.memory.textures--),r.remove(i[o])}r.remove(e)}(n)}function S(e){const n=r.get(e);t.deleteTexture(n.__webglTexture);const i=e.source;delete d.get(i)[n.__cacheKey],a.memory.textures--}let T=0;function E(e,i){const o=r.get(e);if(e.isVideoTexture&&function(t){const e=a.render.frame;u.get(t)!==e&&(u.set(t,e),t.update())}(e),!1===e.isRenderTargetTexture&&e.version>0&&o.__version!==e.version){const t=e.image;if(null===t)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==t.complete)return void R(o,e,i);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.bindTexture(t.TEXTURE_2D,o.__webglTexture,t.TEXTURE0+i)}const M={[Fh]:t.REPEAT,[Uh]:t.CLAMP_TO_EDGE,[Bh]:t.MIRRORED_REPEAT},C={[zh]:t.NEAREST,[jh]:t.NEAREST_MIPMAP_NEAREST,[Wh]:t.NEAREST_MIPMAP_LINEAR,[Hh]:t.LINEAR,[qh]:t.LINEAR_MIPMAP_NEAREST,[Yh]:t.LINEAR_MIPMAP_LINEAR},A={[jp]:t.NEVER,[Yp]:t.ALWAYS,[Vp]:t.LESS,[Gp]:t.LEQUAL,[Wp]:t.EQUAL,[Xp]:t.GEQUAL,[Hp]:t.GREATER,[qp]:t.NOTEQUAL};function k(n,o){if(o.type!==nd||!1!==e.has("OES_texture_float_linear")||o.magFilter!==Hh&&o.magFilter!==qh&&o.magFilter!==Wh&&o.magFilter!==Yh&&o.minFilter!==Hh&&o.minFilter!==qh&&o.minFilter!==Wh&&o.minFilter!==Yh||console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),t.texParameteri(n,t.TEXTURE_WRAP_S,M[o.wrapS]),t.texParameteri(n,t.TEXTURE_WRAP_T,M[o.wrapT]),n!==t.TEXTURE_3D&&n!==t.TEXTURE_2D_ARRAY||t.texParameteri(n,t.TEXTURE_WRAP_R,M[o.wrapR]),t.texParameteri(n,t.TEXTURE_MAG_FILTER,C[o.magFilter]),t.texParameteri(n,t.TEXTURE_MIN_FILTER,C[o.minFilter]),o.compareFunction&&(t.texParameteri(n,t.TEXTURE_COMPARE_MODE,t.COMPARE_REF_TO_TEXTURE),t.texParameteri(n,t.TEXTURE_COMPARE_FUNC,A[o.compareFunction])),!0===e.has("EXT_texture_filter_anisotropic")){if(o.magFilter===zh)return;if(o.minFilter!==Wh&&o.minFilter!==Yh)return;if(o.type===nd&&!1===e.has("OES_texture_float_linear"))return;if(o.anisotropy>1||r.get(o).__currentAnisotropy){const a=e.get("EXT_texture_filter_anisotropic");t.texParameterf(n,a.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(o.anisotropy,i.getMaxAnisotropy())),r.get(o).__currentAnisotropy=o.anisotropy}}}function I(e,n){let r=!1;void 0===e.__webglInit&&(e.__webglInit=!0,n.addEventListener("dispose",_));const i=n.source;let o=d.get(i);void 0===o&&(o={},d.set(i,o));const s=function(t){const e=[];return e.push(t.wrapS),e.push(t.wrapT),e.push(t.wrapR||0),e.push(t.magFilter),e.push(t.minFilter),e.push(t.anisotropy),e.push(t.internalFormat),e.push(t.format),e.push(t.type),e.push(t.generateMipmaps),e.push(t.premultiplyAlpha),e.push(t.flipY),e.push(t.unpackAlignment),e.push(t.colorSpace),e.join()}(n);if(s!==e.__cacheKey){void 0===o[s]&&(o[s]={texture:t.createTexture(),usedTimes:0},a.memory.textures++,r=!0),o[s].usedTimes++;const i=o[e.__cacheKey];void 0!==i&&(o[e.__cacheKey].usedTimes--,0===i.usedTimes&&S(n)),e.__cacheKey=s,e.__webglTexture=o[s].texture}return r}function R(e,a,s){let l=t.TEXTURE_2D;(a.isDataArrayTexture||a.isCompressedArrayTexture)&&(l=t.TEXTURE_2D_ARRAY),a.isData3DTexture&&(l=t.TEXTURE_3D);const c=I(e,a),u=a.source;n.bindTexture(l,e.__webglTexture,t.TEXTURE0+s);const h=r.get(u);if(u.version!==h.__version||!0===c){n.activeTexture(t.TEXTURE0+s);const e=Df.getPrimaries(Df.workingColorSpace),r=a.colorSpace===gp?null:Df.getPrimaries(a.colorSpace),d=a.colorSpace===gp||e===r?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,a.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,a.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,d);let p=m(a.image,!1,i.maxTextureSize);p=B(a,p);const f=o.convert(a.format,a.colorSpace),_=o.convert(a.type);let w,S=v(a.internalFormat,f,_,a.colorSpace,a.isVideoTexture);k(l,a);const T=a.mipmaps,E=!0!==a.isVideoTexture,M=void 0===h.__version||!0===c,C=u.dataReady,A=x(a,p);if(a.isDepthTexture)S=b(a.format===fd,a.type),M&&(E?n.texStorage2D(t.TEXTURE_2D,1,S,p.width,p.height):n.texImage2D(t.TEXTURE_2D,0,S,p.width,p.height,0,f,_,null));else if(a.isDataTexture)if(T.length>0){E&&M&&n.texStorage2D(t.TEXTURE_2D,A,S,T[0].width,T[0].height);for(let e=0,r=T.length;e<r;e++)w=T[e],E?C&&n.texSubImage2D(t.TEXTURE_2D,e,0,0,w.width,w.height,f,_,w.data):n.texImage2D(t.TEXTURE_2D,e,S,w.width,w.height,0,f,_,w.data);a.generateMipmaps=!1}else E?(M&&n.texStorage2D(t.TEXTURE_2D,A,S,p.width,p.height),C&&n.texSubImage2D(t.TEXTURE_2D,0,0,0,p.width,p.height,f,_,p.data)):n.texImage2D(t.TEXTURE_2D,0,S,p.width,p.height,0,f,_,p.data);else if(a.isCompressedTexture)if(a.isCompressedArrayTexture){E&&M&&n.texStorage3D(t.TEXTURE_2D_ARRAY,A,S,T[0].width,T[0].height,p.depth);for(let e=0,r=T.length;e<r;e++)if(w=T[e],a.format!==ud)if(null!==f)if(E){if(C)if(a.layerUpdates.size>0){for(const r of a.layerUpdates){const i=w.width*w.height;n.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,e,0,0,r,w.width,w.height,1,f,w.data.slice(i*r,i*(r+1)),0,0)}a.clearLayerUpdates()}else n.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,e,0,0,0,w.width,w.height,p.depth,f,w.data,0,0)}else n.compressedTexImage3D(t.TEXTURE_2D_ARRAY,e,S,w.width,w.height,p.depth,0,w.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else E?C&&n.texSubImage3D(t.TEXTURE_2D_ARRAY,e,0,0,0,w.width,w.height,p.depth,f,_,w.data):n.texImage3D(t.TEXTURE_2D_ARRAY,e,S,w.width,w.height,p.depth,0,f,_,w.data)}else{E&&M&&n.texStorage2D(t.TEXTURE_2D,A,S,T[0].width,T[0].height);for(let e=0,r=T.length;e<r;e++)w=T[e],a.format!==ud?null!==f?E?C&&n.compressedTexSubImage2D(t.TEXTURE_2D,e,0,0,w.width,w.height,f,w.data):n.compressedTexImage2D(t.TEXTURE_2D,e,S,w.width,w.height,0,w.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):E?C&&n.texSubImage2D(t.TEXTURE_2D,e,0,0,w.width,w.height,f,_,w.data):n.texImage2D(t.TEXTURE_2D,e,S,w.width,w.height,0,f,_,w.data)}else if(a.isDataArrayTexture)if(E){if(M&&n.texStorage3D(t.TEXTURE_2D_ARRAY,A,S,p.width,p.height,p.depth),C)if(a.layerUpdates.size>0){let e;switch(_){case t.UNSIGNED_BYTE:switch(f){case t.ALPHA:case t.LUMINANCE:e=1;break;case t.LUMINANCE_ALPHA:e=2;break;case t.RGB:e=3;break;case t.RGBA:e=4;break;default:throw new Error("Unknown texel size for format ".concat(f,"."))}break;case t.UNSIGNED_SHORT_4_4_4_4:case t.UNSIGNED_SHORT_5_5_5_1:case t.UNSIGNED_SHORT_5_6_5:e=1;break;default:throw new Error("Unknown texel size for type ".concat(_,"."))}const r=p.width*p.height*e;for(const i of a.layerUpdates)n.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,i,p.width,p.height,1,f,_,p.data.slice(r*i,r*(i+1)));a.clearLayerUpdates()}else n.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,0,p.width,p.height,p.depth,f,_,p.data)}else n.texImage3D(t.TEXTURE_2D_ARRAY,0,S,p.width,p.height,p.depth,0,f,_,p.data);else if(a.isData3DTexture)E?(M&&n.texStorage3D(t.TEXTURE_3D,A,S,p.width,p.height,p.depth),C&&n.texSubImage3D(t.TEXTURE_3D,0,0,0,0,p.width,p.height,p.depth,f,_,p.data)):n.texImage3D(t.TEXTURE_3D,0,S,p.width,p.height,p.depth,0,f,_,p.data);else if(a.isFramebufferTexture){if(M)if(E)n.texStorage2D(t.TEXTURE_2D,A,S,p.width,p.height);else{let e=p.width,r=p.height;for(let i=0;i<A;i++)n.texImage2D(t.TEXTURE_2D,i,S,e,r,0,f,_,null),e>>=1,r>>=1}}else if(T.length>0){if(E&&M){const e=z(T[0]);n.texStorage2D(t.TEXTURE_2D,A,S,e.width,e.height)}for(let e=0,r=T.length;e<r;e++)w=T[e],E?C&&n.texSubImage2D(t.TEXTURE_2D,e,0,0,f,_,w):n.texImage2D(t.TEXTURE_2D,e,S,f,_,w);a.generateMipmaps=!1}else if(E){if(M){const e=z(p);n.texStorage2D(t.TEXTURE_2D,A,S,e.width,e.height)}C&&n.texSubImage2D(t.TEXTURE_2D,0,0,0,f,_,p)}else n.texImage2D(t.TEXTURE_2D,0,S,f,_,p);g(a)&&y(l),h.__version=u.version,a.onUpdate&&a.onUpdate(a)}e.__version=a.version}function P(e,i,a,l,c,u){const h=o.convert(a.format,a.colorSpace),d=o.convert(a.type),p=v(a.internalFormat,h,d,a.colorSpace);if(!r.get(i).__hasExternalTextures){const e=Math.max(1,i.width>>u),r=Math.max(1,i.height>>u);c===t.TEXTURE_3D||c===t.TEXTURE_2D_ARRAY?n.texImage3D(c,u,p,e,r,i.depth,0,h,d,null):n.texImage2D(c,u,p,e,r,0,h,d,null)}n.bindFramebuffer(t.FRAMEBUFFER,e),U(i)?s.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,l,c,r.get(a).__webglTexture,0,F(i)):(c===t.TEXTURE_2D||c>=t.TEXTURE_CUBE_MAP_POSITIVE_X&&c<=t.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&t.framebufferTexture2D(t.FRAMEBUFFER,l,c,r.get(a).__webglTexture,u),n.bindFramebuffer(t.FRAMEBUFFER,null)}function N(e,n,r){if(t.bindRenderbuffer(t.RENDERBUFFER,e),n.depthBuffer){const i=n.depthTexture,o=i&&i.isDepthTexture?i.type:null,a=b(n.stencilBuffer,o),l=n.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,c=F(n);U(n)?s.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,c,a,n.width,n.height):r?t.renderbufferStorageMultisample(t.RENDERBUFFER,c,a,n.width,n.height):t.renderbufferStorage(t.RENDERBUFFER,a,n.width,n.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,l,t.RENDERBUFFER,e)}else{const e=n.textures;for(let i=0;i<e.length;i++){const a=e[i],l=o.convert(a.format,a.colorSpace),c=o.convert(a.type),u=v(a.internalFormat,l,c,a.colorSpace),h=F(n);r&&!1===U(n)?t.renderbufferStorageMultisample(t.RENDERBUFFER,h,u,n.width,n.height):U(n)?s.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,h,u,n.width,n.height):t.renderbufferStorage(t.RENDERBUFFER,u,n.width,n.height)}}t.bindRenderbuffer(t.RENDERBUFFER,null)}function O(e){const i=r.get(e),o=!0===e.isWebGLCubeRenderTarget;if(e.depthTexture&&!i.__autoAllocateDepthBuffer){if(o)throw new Error("target.depthTexture not supported in Cube render targets");!function(e,i){if(i&&i.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(t.FRAMEBUFFER,e),!i.depthTexture||!i.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");r.get(i.depthTexture).__webglTexture&&i.depthTexture.image.width===i.width&&i.depthTexture.image.height===i.height||(i.depthTexture.image.width=i.width,i.depthTexture.image.height=i.height,i.depthTexture.needsUpdate=!0),E(i.depthTexture,0);const o=r.get(i.depthTexture).__webglTexture,a=F(i);if(i.depthTexture.format===pd)U(i)?s.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,o,0,a):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,o,0);else{if(i.depthTexture.format!==fd)throw new Error("Unknown depthTexture format");U(i)?s.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,o,0,a):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,o,0)}}(i.__webglFramebuffer,e)}else if(o){i.__webglDepthbuffer=[];for(let r=0;r<6;r++)n.bindFramebuffer(t.FRAMEBUFFER,i.__webglFramebuffer[r]),i.__webglDepthbuffer[r]=t.createRenderbuffer(),N(i.__webglDepthbuffer[r],e,!1)}else n.bindFramebuffer(t.FRAMEBUFFER,i.__webglFramebuffer),i.__webglDepthbuffer=t.createRenderbuffer(),N(i.__webglDepthbuffer,e,!1);n.bindFramebuffer(t.FRAMEBUFFER,null)}const D=[],L=[];function F(t){return Math.min(i.maxSamples,t.samples)}function U(t){const n=r.get(t);return t.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==n.__useRenderToTexture}function B(t,e){const n=t.colorSpace,r=t.format,i=t.type;return!0===t.isCompressedTexture||!0===t.isVideoTexture||n!==vp&&n!==gp&&(Df.getTransfer(n)===wp?r===ud&&i===Zh||console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",n)),e}function z(t){return"undefined"!==typeof HTMLImageElement&&t instanceof HTMLImageElement?(c.width=t.naturalWidth||t.width,c.height=t.naturalHeight||t.height):"undefined"!==typeof VideoFrame&&t instanceof VideoFrame?(c.width=t.displayWidth,c.height=t.displayHeight):(c.width=t.width,c.height=t.height),c}this.allocateTextureUnit=function(){const t=T;return t>=i.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+t+" texture units while this GPU supports only "+i.maxTextures),T+=1,t},this.resetTextureUnits=function(){T=0},this.setTexture2D=E,this.setTexture2DArray=function(e,i){const o=r.get(e);e.version>0&&o.__version!==e.version?R(o,e,i):n.bindTexture(t.TEXTURE_2D_ARRAY,o.__webglTexture,t.TEXTURE0+i)},this.setTexture3D=function(e,i){const o=r.get(e);e.version>0&&o.__version!==e.version?R(o,e,i):n.bindTexture(t.TEXTURE_3D,o.__webglTexture,t.TEXTURE0+i)},this.setTextureCube=function(e,a){const s=r.get(e);e.version>0&&s.__version!==e.version?function(e,a,s){if(6!==a.image.length)return;const l=I(e,a),c=a.source;n.bindTexture(t.TEXTURE_CUBE_MAP,e.__webglTexture,t.TEXTURE0+s);const u=r.get(c);if(c.version!==u.__version||!0===l){n.activeTexture(t.TEXTURE0+s);const e=Df.getPrimaries(Df.workingColorSpace),r=a.colorSpace===gp?null:Df.getPrimaries(a.colorSpace),h=a.colorSpace===gp||e===r?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,a.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,a.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,h);const d=a.isCompressedTexture||a.image[0].isCompressedTexture,p=a.image[0]&&a.image[0].isDataTexture,f=[];for(let t=0;t<6;t++)f[t]=d||p?p?a.image[t].image:a.image[t]:m(a.image[t],!0,i.maxCubemapSize),f[t]=B(a,f[t]);const b=f[0],_=o.convert(a.format,a.colorSpace),w=o.convert(a.type),S=v(a.internalFormat,_,w,a.colorSpace),T=!0!==a.isVideoTexture,E=void 0===u.__version||!0===l,M=c.dataReady;let C,A=x(a,b);if(k(t.TEXTURE_CUBE_MAP,a),d){T&&E&&n.texStorage2D(t.TEXTURE_CUBE_MAP,A,S,b.width,b.height);for(let e=0;e<6;e++){C=f[e].mipmaps;for(let r=0;r<C.length;r++){const i=C[r];a.format!==ud?null!==_?T?M&&n.compressedTexSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,r,0,0,i.width,i.height,_,i.data):n.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,r,S,i.width,i.height,0,i.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):T?M&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,r,0,0,i.width,i.height,_,w,i.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,r,S,i.width,i.height,0,_,w,i.data)}}}else{if(C=a.mipmaps,T&&E){C.length>0&&A++;const e=z(f[0]);n.texStorage2D(t.TEXTURE_CUBE_MAP,A,S,e.width,e.height)}for(let e=0;e<6;e++)if(p){T?M&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,0,0,f[e].width,f[e].height,_,w,f[e].data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,S,f[e].width,f[e].height,0,_,w,f[e].data);for(let r=0;r<C.length;r++){const i=C[r].image[e].image;T?M&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,r+1,0,0,i.width,i.height,_,w,i.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,r+1,S,i.width,i.height,0,_,w,i.data)}}else{T?M&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,0,0,_,w,f[e]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,S,_,w,f[e]);for(let r=0;r<C.length;r++){const i=C[r];T?M&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,r+1,0,0,_,w,i.image[e]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,r+1,S,_,w,i.image[e])}}}g(a)&&y(t.TEXTURE_CUBE_MAP),u.__version=c.version,a.onUpdate&&a.onUpdate(a)}e.__version=a.version}(s,e,a):n.bindTexture(t.TEXTURE_CUBE_MAP,s.__webglTexture,t.TEXTURE0+a)},this.rebindTextures=function(e,n,i){const o=r.get(e);void 0!==n&&P(o.__webglFramebuffer,e,e.texture,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,0),void 0!==i&&O(e)},this.setupRenderTarget=function(e){const i=e.texture,s=r.get(e),l=r.get(i);e.addEventListener("dispose",w);const c=e.textures,u=!0===e.isWebGLCubeRenderTarget,h=c.length>1;if(h||(void 0===l.__webglTexture&&(l.__webglTexture=t.createTexture()),l.__version=i.version,a.memory.textures++),u){s.__webglFramebuffer=[];for(let e=0;e<6;e++)if(i.mipmaps&&i.mipmaps.length>0){s.__webglFramebuffer[e]=[];for(let n=0;n<i.mipmaps.length;n++)s.__webglFramebuffer[e][n]=t.createFramebuffer()}else s.__webglFramebuffer[e]=t.createFramebuffer()}else{if(i.mipmaps&&i.mipmaps.length>0){s.__webglFramebuffer=[];for(let e=0;e<i.mipmaps.length;e++)s.__webglFramebuffer[e]=t.createFramebuffer()}else s.__webglFramebuffer=t.createFramebuffer();if(h)for(let e=0,n=c.length;e<n;e++){const n=r.get(c[e]);void 0===n.__webglTexture&&(n.__webglTexture=t.createTexture(),a.memory.textures++)}if(e.samples>0&&!1===U(e)){s.__webglMultisampledFramebuffer=t.createFramebuffer(),s.__webglColorRenderbuffer=[],n.bindFramebuffer(t.FRAMEBUFFER,s.__webglMultisampledFramebuffer);for(let n=0;n<c.length;n++){const r=c[n];s.__webglColorRenderbuffer[n]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,s.__webglColorRenderbuffer[n]);const i=o.convert(r.format,r.colorSpace),a=o.convert(r.type),l=v(r.internalFormat,i,a,r.colorSpace,!0===e.isXRRenderTarget),u=F(e);t.renderbufferStorageMultisample(t.RENDERBUFFER,u,l,e.width,e.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+n,t.RENDERBUFFER,s.__webglColorRenderbuffer[n])}t.bindRenderbuffer(t.RENDERBUFFER,null),e.depthBuffer&&(s.__webglDepthRenderbuffer=t.createRenderbuffer(),N(s.__webglDepthRenderbuffer,e,!0)),n.bindFramebuffer(t.FRAMEBUFFER,null)}}if(u){n.bindTexture(t.TEXTURE_CUBE_MAP,l.__webglTexture),k(t.TEXTURE_CUBE_MAP,i);for(let n=0;n<6;n++)if(i.mipmaps&&i.mipmaps.length>0)for(let r=0;r<i.mipmaps.length;r++)P(s.__webglFramebuffer[n][r],e,i,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+n,r);else P(s.__webglFramebuffer[n],e,i,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0);g(i)&&y(t.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(h){for(let i=0,o=c.length;i<o;i++){const o=c[i],a=r.get(o);n.bindTexture(t.TEXTURE_2D,a.__webglTexture),k(t.TEXTURE_2D,o),P(s.__webglFramebuffer,e,o,t.COLOR_ATTACHMENT0+i,t.TEXTURE_2D,0),g(o)&&y(t.TEXTURE_2D)}n.unbindTexture()}else{let r=t.TEXTURE_2D;if((e.isWebGL3DRenderTarget||e.isWebGLArrayRenderTarget)&&(r=e.isWebGL3DRenderTarget?t.TEXTURE_3D:t.TEXTURE_2D_ARRAY),n.bindTexture(r,l.__webglTexture),k(r,i),i.mipmaps&&i.mipmaps.length>0)for(let n=0;n<i.mipmaps.length;n++)P(s.__webglFramebuffer[n],e,i,t.COLOR_ATTACHMENT0,r,n);else P(s.__webglFramebuffer,e,i,t.COLOR_ATTACHMENT0,r,0);g(i)&&y(r),n.unbindTexture()}e.depthBuffer&&O(e)},this.updateRenderTargetMipmap=function(e){const i=e.textures;for(let o=0,a=i.length;o<a;o++){const a=i[o];if(g(a)){const i=e.isWebGLCubeRenderTarget?t.TEXTURE_CUBE_MAP:t.TEXTURE_2D,o=r.get(a).__webglTexture;n.bindTexture(i,o),y(i),n.unbindTexture()}}},this.updateMultisampleRenderTarget=function(e){if(e.samples>0)if(!1===U(e)){const i=e.textures,o=e.width,a=e.height;let s=t.COLOR_BUFFER_BIT;const c=e.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,u=r.get(e),h=i.length>1;if(h)for(let e=0;e<i.length;e++)n.bindFramebuffer(t.FRAMEBUFFER,u.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+e,t.RENDERBUFFER,null),n.bindFramebuffer(t.FRAMEBUFFER,u.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+e,t.TEXTURE_2D,null,0);n.bindFramebuffer(t.READ_FRAMEBUFFER,u.__webglMultisampledFramebuffer),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,u.__webglFramebuffer);for(let n=0;n<i.length;n++){if(e.resolveDepthBuffer&&(e.depthBuffer&&(s|=t.DEPTH_BUFFER_BIT),e.stencilBuffer&&e.resolveStencilBuffer&&(s|=t.STENCIL_BUFFER_BIT)),h){t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,u.__webglColorRenderbuffer[n]);const e=r.get(i[n]).__webglTexture;t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0)}t.blitFramebuffer(0,0,o,a,0,0,o,a,s,t.NEAREST),!0===l&&(D.length=0,L.length=0,D.push(t.COLOR_ATTACHMENT0+n),e.depthBuffer&&!1===e.resolveDepthBuffer&&(D.push(c),L.push(c),t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,L)),t.invalidateFramebuffer(t.READ_FRAMEBUFFER,D))}if(n.bindFramebuffer(t.READ_FRAMEBUFFER,null),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),h)for(let e=0;e<i.length;e++){n.bindFramebuffer(t.FRAMEBUFFER,u.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+e,t.RENDERBUFFER,u.__webglColorRenderbuffer[e]);const o=r.get(i[e]).__webglTexture;n.bindFramebuffer(t.FRAMEBUFFER,u.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+e,t.TEXTURE_2D,o,0)}n.bindFramebuffer(t.DRAW_FRAMEBUFFER,u.__webglMultisampledFramebuffer)}else if(e.depthBuffer&&!1===e.resolveDepthBuffer&&l){const n=e.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,[n])}},this.setupDepthRenderbuffer=O,this.setupFrameBufferTexture=P,this.useMultisampledRTT=U}function ux(t,e){return{convert:function(n){let r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:gp;const o=Df.getTransfer(i);if(n===Zh)return t.UNSIGNED_BYTE;if(n===id)return t.UNSIGNED_SHORT_4_4_4_4;if(n===od)return t.UNSIGNED_SHORT_5_5_5_1;if(n===sd)return t.UNSIGNED_INT_5_9_9_9_REV;if(n===Jh)return t.BYTE;if(n===Qh)return t.SHORT;if(n===$h)return t.UNSIGNED_SHORT;if(n===td)return t.INT;if(n===ed)return t.UNSIGNED_INT;if(n===nd)return t.FLOAT;if(n===rd)return t.HALF_FLOAT;if(n===ld)return t.ALPHA;if(n===cd)return t.RGB;if(n===ud)return t.RGBA;if(n===hd)return t.LUMINANCE;if(n===dd)return t.LUMINANCE_ALPHA;if(n===pd)return t.DEPTH_COMPONENT;if(n===fd)return t.DEPTH_STENCIL;if(n===md)return t.RED;if(n===gd)return t.RED_INTEGER;if(n===yd)return t.RG;if(n===vd)return t.RG_INTEGER;if(n===bd)return t.RGBA_INTEGER;if(n===xd||n===_d||n===wd||n===Sd)if(o===wp){if(r=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===r)return null;if(n===xd)return r.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===_d)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===wd)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===Sd)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(r=e.get("WEBGL_compressed_texture_s3tc"),null===r)return null;if(n===xd)return r.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===_d)return r.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===wd)return r.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===Sd)return r.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(n===Td||n===Ed||n===Md||n===Cd){if(r=e.get("WEBGL_compressed_texture_pvrtc"),null===r)return null;if(n===Td)return r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===Ed)return r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===Md)return r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===Cd)return r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(n===Ad||n===kd||n===Id){if(r=e.get("WEBGL_compressed_texture_etc"),null===r)return null;if(n===Ad||n===kd)return o===wp?r.COMPRESSED_SRGB8_ETC2:r.COMPRESSED_RGB8_ETC2;if(n===Id)return o===wp?r.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:r.COMPRESSED_RGBA8_ETC2_EAC}if(n===Rd||n===Pd||n===Nd||n===Od||n===Dd||n===Ld||n===Fd||n===Ud||n===Bd||n===zd||n===jd||n===Vd||n===Wd||n===Gd){if(r=e.get("WEBGL_compressed_texture_astc"),null===r)return null;if(n===Rd)return o===wp?r.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:r.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===Pd)return o===wp?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:r.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===Nd)return o===wp?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:r.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===Od)return o===wp?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:r.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===Dd)return o===wp?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:r.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===Ld)return o===wp?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:r.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===Fd)return o===wp?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:r.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===Ud)return o===wp?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:r.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===Bd)return o===wp?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:r.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===zd)return o===wp?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:r.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===jd)return o===wp?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:r.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===Vd)return o===wp?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:r.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===Wd)return o===wp?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:r.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===Gd)return o===wp?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:r.COMPRESSED_RGBA_ASTC_12x12_KHR}if(n===Hd||n===qd||n===Xd){if(r=e.get("EXT_texture_compression_bptc"),null===r)return null;if(n===Hd)return o===wp?r.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:r.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===qd)return r.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===Xd)return r.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(n===Yd||n===Kd||n===Zd||n===Jd){if(r=e.get("EXT_texture_compression_rgtc"),null===r)return null;if(n===Hd)return r.COMPRESSED_RED_RGTC1_EXT;if(n===Kd)return r.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===Zd)return r.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===Jd)return r.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return n===ad?t.UNSIGNED_INT_24_8:void 0!==t[n]?t[n]:null}}}class hx extends Sy{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];super(),this.isArrayCamera=!0,this.cameras=t}}class dx extends ng{constructor(){super(),this.isGroup=!0,this.type="Group"}}const px={type:"move"};class fx{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new dx,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new dx,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new $f,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new $f),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new dx,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new $f,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new $f),this._grip}dispatchEvent(t){return null!==this._targetRay&&this._targetRay.dispatchEvent(t),null!==this._grip&&this._grip.dispatchEvent(t),null!==this._hand&&this._hand.dispatchEvent(t),this}connect(t){if(t&&t.hand){const e=this._hand;if(e)for(const n of t.hand.values())this._getHandJoint(e,n)}return this.dispatchEvent({type:"connected",data:t}),this}disconnect(t){return this.dispatchEvent({type:"disconnected",data:t}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(t,e,n){let r=null,i=null,o=null;const a=this._targetRay,s=this._grip,l=this._hand;if(t&&"visible-blurred"!==e.session.visibilityState){if(l&&t.hand){o=!0;for(const o of t.hand.values()){const t=e.getJointPose(o,n),r=this._getHandJoint(l,o);null!==t&&(r.matrix.fromArray(t.transform.matrix),r.matrix.decompose(r.position,r.rotation,r.scale),r.matrixWorldNeedsUpdate=!0,r.jointRadius=t.radius),r.visible=null!==t}const r=l.joints["index-finger-tip"],i=l.joints["thumb-tip"],a=r.position.distanceTo(i.position),s=.02,c=.005;l.inputState.pinching&&a>s+c?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!l.inputState.pinching&&a<=s-c&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else null!==s&&t.gripSpace&&(i=e.getPose(t.gripSpace,n),null!==i&&(s.matrix.fromArray(i.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),s.matrixWorldNeedsUpdate=!0,i.linearVelocity?(s.hasLinearVelocity=!0,s.linearVelocity.copy(i.linearVelocity)):s.hasLinearVelocity=!1,i.angularVelocity?(s.hasAngularVelocity=!0,s.angularVelocity.copy(i.angularVelocity)):s.hasAngularVelocity=!1));null!==a&&(r=e.getPose(t.targetRaySpace,n),null===r&&null!==i&&(r=i),null!==r&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(px)))}return null!==a&&(a.visible=null!==r),null!==s&&(s.visible=null!==i),null!==l&&(l.visible=null!==o),this}_getHandJoint(t,e){if(void 0===t.joints[e.jointName]){const n=new dx;n.matrixAutoUpdate=!1,n.visible=!1,t.joints[e.jointName]=n,t.add(n)}return t.joints[e.jointName]}}class mx{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(t,e,n){if(null===this.texture){const r=new Gf;t.properties.get(r).__webglTexture=e.texture,e.depthNear==n.depthNear&&e.depthFar==n.depthFar||(this.depthNear=e.depthNear,this.depthFar=e.depthFar),this.texture=r}}getMesh(t){if(null!==this.texture&&null===this.mesh){const e=t.cameras[0].viewport,n=new vy({vertexShader:"\nvoid main() {\n\n\tgl_Position = vec4( position, 1.0 );\n\n}",fragmentShader:"\nuniform sampler2DArray depthColor;\nuniform float depthWidth;\nuniform float depthHeight;\n\nvoid main() {\n\n\tvec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );\n\n\tif ( coord.x >= 1.0 ) {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;\n\n\t} else {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;\n\n\t}\n\n}",uniforms:{depthColor:{value:this.texture},depthWidth:{value:e.z},depthHeight:{value:e.w}}});this.mesh=new hy(new Fy(20,20),n)}return this.mesh}reset(){this.texture=null,this.mesh=null}}class gx extends cf{constructor(t,e){super();const n=this;let r=null,i=1,o=null,a="local-floor",s=1,l=null,c=null,u=null,h=null,d=null,p=null;const f=new mx,m=e.getContextAttributes();let g=null,y=null;const v=[],b=[],x=new _f;let _=null;const w=new Sy;w.layers.enable(1),w.viewport=new Hf;const S=new Sy;S.layers.enable(2),S.viewport=new Hf;const T=[w,S],E=new hx;E.layers.enable(1),E.layers.enable(2);let M=null,C=null;function A(t){const e=b.indexOf(t.inputSource);if(-1===e)return;const n=v[e];void 0!==n&&(n.update(t.inputSource,t.frame,l||o),n.dispatchEvent({type:t.type,data:t.inputSource}))}function k(){r.removeEventListener("select",A),r.removeEventListener("selectstart",A),r.removeEventListener("selectend",A),r.removeEventListener("squeeze",A),r.removeEventListener("squeezestart",A),r.removeEventListener("squeezeend",A),r.removeEventListener("end",k),r.removeEventListener("inputsourceschange",I);for(let t=0;t<v.length;t++){const e=b[t];null!==e&&(b[t]=null,v[t].disconnect(e))}M=null,C=null,f.reset(),t.setRenderTarget(g),d=null,h=null,u=null,r=null,y=null,D.stop(),n.isPresenting=!1,t.setPixelRatio(_),t.setSize(x.width,x.height,!1),n.dispatchEvent({type:"sessionend"})}function I(t){for(let e=0;e<t.removed.length;e++){const n=t.removed[e],r=b.indexOf(n);r>=0&&(b[r]=null,v[r].disconnect(n))}for(let e=0;e<t.added.length;e++){const n=t.added[e];let r=b.indexOf(n);if(-1===r){for(let t=0;t<v.length;t++){if(t>=b.length){b.push(n),r=t;break}if(null===b[t]){b[t]=n,r=t;break}}if(-1===r)break}const i=v[r];i&&i.connect(n)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(t){let e=v[t];return void 0===e&&(e=new fx,v[t]=e),e.getTargetRaySpace()},this.getControllerGrip=function(t){let e=v[t];return void 0===e&&(e=new fx,v[t]=e),e.getGripSpace()},this.getHand=function(t){let e=v[t];return void 0===e&&(e=new fx,v[t]=e),e.getHandSpace()},this.setFramebufferScaleFactor=function(t){i=t,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(t){a=t,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||o},this.setReferenceSpace=function(t){l=t},this.getBaseLayer=function(){return null!==h?h:d},this.getBinding=function(){return u},this.getFrame=function(){return p},this.getSession=function(){return r},this.setSession=async function(c){if(r=c,null!==r){if(g=t.getRenderTarget(),r.addEventListener("select",A),r.addEventListener("selectstart",A),r.addEventListener("selectend",A),r.addEventListener("squeeze",A),r.addEventListener("squeezestart",A),r.addEventListener("squeezeend",A),r.addEventListener("end",k),r.addEventListener("inputsourceschange",I),!0!==m.xrCompatible&&await e.makeXRCompatible(),_=t.getPixelRatio(),t.getSize(x),void 0===r.renderState.layers){const n={antialias:m.antialias,alpha:!0,depth:m.depth,stencil:m.stencil,framebufferScaleFactor:i};d=new XRWebGLLayer(r,e,n),r.updateRenderState({baseLayer:d}),t.setPixelRatio(1),t.setSize(d.framebufferWidth,d.framebufferHeight,!1),y=new Xf(d.framebufferWidth,d.framebufferHeight,{format:ud,type:Zh,colorSpace:t.outputColorSpace,stencilBuffer:m.stencil})}else{let n=null,o=null,a=null;m.depth&&(a=m.stencil?e.DEPTH24_STENCIL8:e.DEPTH_COMPONENT24,n=m.stencil?fd:pd,o=m.stencil?ad:ed);const s={colorFormat:e.RGBA8,depthFormat:a,scaleFactor:i};u=new XRWebGLBinding(r,e),h=u.createProjectionLayer(s),r.updateRenderState({layers:[h]}),t.setPixelRatio(1),t.setSize(h.textureWidth,h.textureHeight,!1),y=new Xf(h.textureWidth,h.textureHeight,{format:ud,type:Zh,depthTexture:new xv(h.textureWidth,h.textureHeight,o,void 0,void 0,void 0,void 0,void 0,void 0,n),stencilBuffer:m.stencil,colorSpace:t.outputColorSpace,samples:m.antialias?4:0,resolveDepthBuffer:!1===h.ignoreDepthValues})}y.isXRRenderTarget=!0,this.setFoveation(s),l=null,o=await r.requestReferenceSpace(a),D.setContext(r),D.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(null!==r)return r.environmentBlendMode};const R=new $f,P=new $f;function N(t,e){null===e?t.matrixWorld.copy(t.matrix):t.matrixWorld.multiplyMatrices(e.matrixWorld,t.matrix),t.matrixWorldInverse.copy(t.matrixWorld).invert()}this.updateCamera=function(t){if(null===r)return;null!==f.texture&&(t.near=f.depthNear,t.far=f.depthFar),E.near=S.near=w.near=t.near,E.far=S.far=w.far=t.far,M===E.near&&C===E.far||(r.updateRenderState({depthNear:E.near,depthFar:E.far}),M=E.near,C=E.far,w.near=M,w.far=C,S.near=M,S.far=C,w.updateProjectionMatrix(),S.updateProjectionMatrix(),t.updateProjectionMatrix());const e=t.parent,n=E.cameras;N(E,e);for(let r=0;r<n.length;r++)N(n[r],e);2===n.length?function(t,e,n){R.setFromMatrixPosition(e.matrixWorld),P.setFromMatrixPosition(n.matrixWorld);const r=R.distanceTo(P),i=e.projectionMatrix.elements,o=n.projectionMatrix.elements,a=i[14]/(i[10]-1),s=i[14]/(i[10]+1),l=(i[9]+1)/i[5],c=(i[9]-1)/i[5],u=(i[8]-1)/i[0],h=(o[8]+1)/o[0],d=a*u,p=a*h,f=r/(-u+h),m=f*-u;e.matrixWorld.decompose(t.position,t.quaternion,t.scale),t.translateX(m),t.translateZ(f),t.matrixWorld.compose(t.position,t.quaternion,t.scale),t.matrixWorldInverse.copy(t.matrixWorld).invert();const g=a+f,y=s+f,v=d-m,b=p+(r-m),x=l*s/y*g,_=c*s/y*g;t.projectionMatrix.makePerspective(v,b,x,_,g,y),t.projectionMatrixInverse.copy(t.projectionMatrix).invert()}(E,w,S):E.projectionMatrix.copy(w.projectionMatrix),function(t,e,n){null===n?t.matrix.copy(e.matrixWorld):(t.matrix.copy(n.matrixWorld),t.matrix.invert(),t.matrix.multiply(e.matrixWorld));t.matrix.decompose(t.position,t.quaternion,t.scale),t.updateMatrixWorld(!0),t.projectionMatrix.copy(e.projectionMatrix),t.projectionMatrixInverse.copy(e.projectionMatrixInverse),t.isPerspectiveCamera&&(t.fov=2*pf*Math.atan(1/t.projectionMatrix.elements[5]),t.zoom=1)}(t,E,e)},this.getCamera=function(){return E},this.getFoveation=function(){if(null!==h||null!==d)return s},this.setFoveation=function(t){s=t,null!==h&&(h.fixedFoveation=t),null!==d&&void 0!==d.fixedFoveation&&(d.fixedFoveation=t)},this.hasDepthSensing=function(){return null!==f.texture},this.getDepthSensingMesh=function(){return f.getMesh(E)};let O=null;const D=new Dy;D.setAnimationLoop((function(e,i){if(c=i.getViewerPose(l||o),p=i,null!==c){const e=c.views;null!==d&&(t.setRenderTargetFramebuffer(y,d.framebuffer),t.setRenderTarget(y));let n=!1;e.length!==E.cameras.length&&(E.cameras.length=0,n=!0);for(let r=0;r<e.length;r++){const i=e[r];let o=null;if(null!==d)o=d.getViewport(i);else{const e=u.getViewSubImage(h,i);o=e.viewport,0===r&&(t.setRenderTargetTextures(y,e.colorTexture,h.ignoreDepthValues?void 0:e.depthStencilTexture),t.setRenderTarget(y))}let a=T[r];void 0===a&&(a=new Sy,a.layers.enable(r),a.viewport=new Hf,T[r]=a),a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.quaternion,a.scale),a.projectionMatrix.fromArray(i.projectionMatrix),a.projectionMatrixInverse.copy(a.projectionMatrix).invert(),a.viewport.set(o.x,o.y,o.width,o.height),0===r&&(E.matrix.copy(a.matrix),E.matrix.decompose(E.position,E.quaternion,E.scale)),!0===n&&E.cameras.push(a)}const i=r.enabledFeatures;if(i&&i.includes("depth-sensing")){const n=u.getDepthInformation(e[0]);n&&n.isValid&&n.texture&&f.init(t,n,r.renderState)}}for(let t=0;t<v.length;t++){const e=b[t],n=v[t];null!==e&&void 0!==n&&n.update(e,i,l||o)}O&&O(e,i),i.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:i}),p=null})),this.setAnimationLoop=function(t){O=t},this.dispose=function(){}}}const yx=new Bm,vx=new km;function bx(t,e){function n(t,e){!0===t.matrixAutoUpdate&&t.updateMatrix(),e.value.copy(t.matrix)}function r(t,r){t.opacity.value=r.opacity,r.color&&t.diffuse.value.copy(r.color),r.emissive&&t.emissive.value.copy(r.emissive).multiplyScalar(r.emissiveIntensity),r.map&&(t.map.value=r.map,n(r.map,t.mapTransform)),r.alphaMap&&(t.alphaMap.value=r.alphaMap,n(r.alphaMap,t.alphaMapTransform)),r.bumpMap&&(t.bumpMap.value=r.bumpMap,n(r.bumpMap,t.bumpMapTransform),t.bumpScale.value=r.bumpScale,r.side===Lu&&(t.bumpScale.value*=-1)),r.normalMap&&(t.normalMap.value=r.normalMap,n(r.normalMap,t.normalMapTransform),t.normalScale.value.copy(r.normalScale),r.side===Lu&&t.normalScale.value.negate()),r.displacementMap&&(t.displacementMap.value=r.displacementMap,n(r.displacementMap,t.displacementMapTransform),t.displacementScale.value=r.displacementScale,t.displacementBias.value=r.displacementBias),r.emissiveMap&&(t.emissiveMap.value=r.emissiveMap,n(r.emissiveMap,t.emissiveMapTransform)),r.specularMap&&(t.specularMap.value=r.specularMap,n(r.specularMap,t.specularMapTransform)),r.alphaTest>0&&(t.alphaTest.value=r.alphaTest);const i=e.get(r),o=i.envMap,a=i.envMapRotation;o&&(t.envMap.value=o,yx.copy(a),yx.x*=-1,yx.y*=-1,yx.z*=-1,o.isCubeTexture&&!1===o.isRenderTargetTexture&&(yx.y*=-1,yx.z*=-1),t.envMapRotation.value.setFromMatrix4(vx.makeRotationFromEuler(yx)),t.flipEnvMap.value=o.isCubeTexture&&!1===o.isRenderTargetTexture?-1:1,t.reflectivity.value=r.reflectivity,t.ior.value=r.ior,t.refractionRatio.value=r.refractionRatio),r.lightMap&&(t.lightMap.value=r.lightMap,t.lightMapIntensity.value=r.lightMapIntensity,n(r.lightMap,t.lightMapTransform)),r.aoMap&&(t.aoMap.value=r.aoMap,t.aoMapIntensity.value=r.aoMapIntensity,n(r.aoMap,t.aoMapTransform))}return{refreshFogUniforms:function(e,n){n.color.getRGB(e.fogColor.value,gy(t)),n.isFog?(e.fogNear.value=n.near,e.fogFar.value=n.far):n.isFogExp2&&(e.fogDensity.value=n.density)},refreshMaterialUniforms:function(t,i,o,a,s){i.isMeshBasicMaterial||i.isMeshLambertMaterial?r(t,i):i.isMeshToonMaterial?(r(t,i),function(t,e){e.gradientMap&&(t.gradientMap.value=e.gradientMap)}(t,i)):i.isMeshPhongMaterial?(r(t,i),function(t,e){t.specular.value.copy(e.specular),t.shininess.value=Math.max(e.shininess,1e-4)}(t,i)):i.isMeshStandardMaterial?(r(t,i),function(t,e){t.metalness.value=e.metalness,e.metalnessMap&&(t.metalnessMap.value=e.metalnessMap,n(e.metalnessMap,t.metalnessMapTransform));t.roughness.value=e.roughness,e.roughnessMap&&(t.roughnessMap.value=e.roughnessMap,n(e.roughnessMap,t.roughnessMapTransform));e.envMap&&(t.envMapIntensity.value=e.envMapIntensity)}(t,i),i.isMeshPhysicalMaterial&&function(t,e,r){t.ior.value=e.ior,e.sheen>0&&(t.sheenColor.value.copy(e.sheenColor).multiplyScalar(e.sheen),t.sheenRoughness.value=e.sheenRoughness,e.sheenColorMap&&(t.sheenColorMap.value=e.sheenColorMap,n(e.sheenColorMap,t.sheenColorMapTransform)),e.sheenRoughnessMap&&(t.sheenRoughnessMap.value=e.sheenRoughnessMap,n(e.sheenRoughnessMap,t.sheenRoughnessMapTransform)));e.clearcoat>0&&(t.clearcoat.value=e.clearcoat,t.clearcoatRoughness.value=e.clearcoatRoughness,e.clearcoatMap&&(t.clearcoatMap.value=e.clearcoatMap,n(e.clearcoatMap,t.clearcoatMapTransform)),e.clearcoatRoughnessMap&&(t.clearcoatRoughnessMap.value=e.clearcoatRoughnessMap,n(e.clearcoatRoughnessMap,t.clearcoatRoughnessMapTransform)),e.clearcoatNormalMap&&(t.clearcoatNormalMap.value=e.clearcoatNormalMap,n(e.clearcoatNormalMap,t.clearcoatNormalMapTransform),t.clearcoatNormalScale.value.copy(e.clearcoatNormalScale),e.side===Lu&&t.clearcoatNormalScale.value.negate()));e.dispersion>0&&(t.dispersion.value=e.dispersion);e.iridescence>0&&(t.iridescence.value=e.iridescence,t.iridescenceIOR.value=e.iridescenceIOR,t.iridescenceThicknessMinimum.value=e.iridescenceThicknessRange[0],t.iridescenceThicknessMaximum.value=e.iridescenceThicknessRange[1],e.iridescenceMap&&(t.iridescenceMap.value=e.iridescenceMap,n(e.iridescenceMap,t.iridescenceMapTransform)),e.iridescenceThicknessMap&&(t.iridescenceThicknessMap.value=e.iridescenceThicknessMap,n(e.iridescenceThicknessMap,t.iridescenceThicknessMapTransform)));e.transmission>0&&(t.transmission.value=e.transmission,t.transmissionSamplerMap.value=r.texture,t.transmissionSamplerSize.value.set(r.width,r.height),e.transmissionMap&&(t.transmissionMap.value=e.transmissionMap,n(e.transmissionMap,t.transmissionMapTransform)),t.thickness.value=e.thickness,e.thicknessMap&&(t.thicknessMap.value=e.thicknessMap,n(e.thicknessMap,t.thicknessMapTransform)),t.attenuationDistance.value=e.attenuationDistance,t.attenuationColor.value.copy(e.attenuationColor));e.anisotropy>0&&(t.anisotropyVector.value.set(e.anisotropy*Math.cos(e.anisotropyRotation),e.anisotropy*Math.sin(e.anisotropyRotation)),e.anisotropyMap&&(t.anisotropyMap.value=e.anisotropyMap,n(e.anisotropyMap,t.anisotropyMapTransform)));t.specularIntensity.value=e.specularIntensity,t.specularColor.value.copy(e.specularColor),e.specularColorMap&&(t.specularColorMap.value=e.specularColorMap,n(e.specularColorMap,t.specularColorMapTransform));e.specularIntensityMap&&(t.specularIntensityMap.value=e.specularIntensityMap,n(e.specularIntensityMap,t.specularIntensityMapTransform))}(t,i,s)):i.isMeshMatcapMaterial?(r(t,i),function(t,e){e.matcap&&(t.matcap.value=e.matcap)}(t,i)):i.isMeshDepthMaterial?r(t,i):i.isMeshDistanceMaterial?(r(t,i),function(t,n){const r=e.get(n).light;t.referencePosition.value.setFromMatrixPosition(r.matrixWorld),t.nearDistance.value=r.shadow.camera.near,t.farDistance.value=r.shadow.camera.far}(t,i)):i.isMeshNormalMaterial?r(t,i):i.isLineBasicMaterial?(function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,e.map&&(t.map.value=e.map,n(e.map,t.mapTransform))}(t,i),i.isLineDashedMaterial&&function(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}(t,i)):i.isPointsMaterial?function(t,e,r,i){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.size.value=e.size*r,t.scale.value=.5*i,e.map&&(t.map.value=e.map,n(e.map,t.uvTransform));e.alphaMap&&(t.alphaMap.value=e.alphaMap,n(e.alphaMap,t.alphaMapTransform));e.alphaTest>0&&(t.alphaTest.value=e.alphaTest)}(t,i,o,a):i.isSpriteMaterial?function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.rotation.value=e.rotation,e.map&&(t.map.value=e.map,n(e.map,t.mapTransform));e.alphaMap&&(t.alphaMap.value=e.alphaMap,n(e.alphaMap,t.alphaMapTransform));e.alphaTest>0&&(t.alphaTest.value=e.alphaTest)}(t,i):i.isShadowMaterial?(t.color.value.copy(i.color),t.opacity.value=i.opacity):i.isShaderMaterial&&(i.uniformsNeedUpdate=!1)}}}function xx(t,e,n,r){let i={},o={},a=[];const s=t.getParameter(t.MAX_UNIFORM_BUFFER_BINDINGS);function l(t,e,n,r){const i=t.value,o=e+"_"+n;if(void 0===r[o])return r[o]="number"===typeof i||"boolean"===typeof i?i:i.clone(),!0;{const t=r[o];if("number"===typeof i||"boolean"===typeof i){if(t!==i)return r[o]=i,!0}else if(!1===t.equals(i))return t.copy(i),!0}return!1}function c(t){const e={boundary:0,storage:0};return"number"===typeof t||"boolean"===typeof t?(e.boundary=4,e.storage=4):t.isVector2?(e.boundary=8,e.storage=8):t.isVector3||t.isColor?(e.boundary=16,e.storage=12):t.isVector4?(e.boundary=16,e.storage=16):t.isMatrix3?(e.boundary=48,e.storage=48):t.isMatrix4?(e.boundary=64,e.storage=64):t.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",t),e}function u(e){const n=e.target;n.removeEventListener("dispose",u);const r=a.indexOf(n.__bindingPointIndex);a.splice(r,1),t.deleteBuffer(i[n.id]),delete i[n.id],delete o[n.id]}return{bind:function(t,e){const n=e.program;r.uniformBlockBinding(t,n)},update:function(n,h){let d=i[n.id];void 0===d&&(!function(t){const e=t.uniforms;let n=0;const r=16;for(let o=0,a=e.length;o<a;o++){const t=Array.isArray(e[o])?e[o]:[e[o]];for(let e=0,i=t.length;e<i;e++){const i=t[e],o=Array.isArray(i.value)?i.value:[i.value];for(let t=0,e=o.length;t<e;t++){const e=c(o[t]),a=n%r;0!==a&&r-a<e.boundary&&(n+=r-a),i.__data=new Float32Array(e.storage/Float32Array.BYTES_PER_ELEMENT),i.__offset=n,n+=e.storage}}}const i=n%r;i>0&&(n+=r-i);t.__size=n,t.__cache={}}(n),d=function(e){const n=function(){for(let t=0;t<s;t++)if(-1===a.indexOf(t))return a.push(t),t;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();e.__bindingPointIndex=n;const r=t.createBuffer(),i=e.__size,o=e.usage;return t.bindBuffer(t.UNIFORM_BUFFER,r),t.bufferData(t.UNIFORM_BUFFER,i,o),t.bindBuffer(t.UNIFORM_BUFFER,null),t.bindBufferBase(t.UNIFORM_BUFFER,n,r),r}(n),i[n.id]=d,n.addEventListener("dispose",u));const p=h.program;r.updateUBOMapping(n,p);const f=e.render.frame;o[n.id]!==f&&(!function(e){const n=i[e.id],r=e.uniforms,o=e.__cache;t.bindBuffer(t.UNIFORM_BUFFER,n);for(let i=0,a=r.length;i<a;i++){const e=Array.isArray(r[i])?r[i]:[r[i]];for(let n=0,r=e.length;n<r;n++){const r=e[n];if(!0===l(r,i,n,o)){const e=r.__offset,n=Array.isArray(r.value)?r.value:[r.value];let i=0;for(let o=0;o<n.length;o++){const a=n[o],s=c(a);"number"===typeof a||"boolean"===typeof a?(r.__data[0]=a,t.bufferSubData(t.UNIFORM_BUFFER,e+i,r.__data)):a.isMatrix3?(r.__data[0]=a.elements[0],r.__data[1]=a.elements[1],r.__data[2]=a.elements[2],r.__data[3]=0,r.__data[4]=a.elements[3],r.__data[5]=a.elements[4],r.__data[6]=a.elements[5],r.__data[7]=0,r.__data[8]=a.elements[6],r.__data[9]=a.elements[7],r.__data[10]=a.elements[8],r.__data[11]=0):(a.toArray(r.__data,i),i+=s.storage/Float32Array.BYTES_PER_ELEMENT)}t.bufferSubData(t.UNIFORM_BUFFER,e,r.__data)}}}t.bindBuffer(t.UNIFORM_BUFFER,null)}(n),o[n.id]=f)},dispose:function(){for(const e in i)t.deleteBuffer(i[e]);a=[],i={},o={}}}}class _x{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{canvas:e=Af(),context:n=null,depth:r=!0,stencil:i=!1,alpha:o=!1,antialias:a=!1,premultipliedAlpha:s=!0,preserveDrawingBuffer:l=!1,powerPreference:c="default",failIfMajorPerformanceCaveat:u=!1}=t;let h;if(this.isWebGLRenderer=!0,null!==n){if("undefined"!==typeof WebGLRenderingContext&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");h=n.getContextAttributes().alpha}else h=o;const d=new Uint32Array(4),p=new Int32Array(4);let f=null,m=null;const g=[],y=[];this.domElement=e,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=yp,this.toneMapping=_h,this.toneMappingExposure=1;const v=this;let b=!1,x=0,_=0,w=null,S=-1,T=null;const E=new Hf,M=new Hf;let C=null;const A=new vg(0);let k=0,I=e.width,R=e.height,P=1,N=null,O=null;const D=new Hf(0,0,I,R),L=new Hf(0,0,I,R);let F=!1;const U=new Oy;let B=!1,z=!1;const j=new km,V=new $f,W={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let G=!1;function H(){return null===w?P:1}let q,X,Y,K,Z,J,Q,$,tt,et,nt,rt,it,ot,at,st,lt,ct,ut,ht,dt,pt,ft,mt,gt=n;function yt(t,n){return e.getContext(t,n)}try{const t={alpha:!0,depth:r,stencil:i,antialias:a,premultipliedAlpha:s,preserveDrawingBuffer:l,powerPreference:c,failIfMajorPerformanceCaveat:u};if("setAttribute"in e&&e.setAttribute("data-engine","three.js r".concat(Tu)),e.addEventListener("webglcontextlost",xt,!1),e.addEventListener("webglcontextrestored",_t,!1),e.addEventListener("webglcontextcreationerror",wt,!1),null===gt){const e="webgl2";if(gt=yt(e,t),null===gt)throw yt(e)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(oA){throw console.error("THREE.WebGLRenderer: "+oA.message),oA}function vt(){q=new fv(gt),q.init(),pt=new ux(gt,q),X=new Xy(gt,q,t,pt),Y=new lx(gt),K=new yv(gt),Z=new Yb,J=new cx(gt,q,Y,Z,X,pt,K),Q=new Ky(v),$=new pv(v),tt=new Ly(gt),ft=new Hy(gt,tt),et=new mv(gt,tt,K,ft),nt=new bv(gt,et,tt,K),ut=new vv(gt,X,J),st=new Yy(Z),rt=new Xb(v,Q,$,q,X,ft,st),it=new bx(v,Z),ot=new Qb,at=new ix(q),ct=new Gy(v,Q,$,Y,nt,h,s),lt=new sx(v,nt,X),mt=new xx(gt,K,X,Y),ht=new qy(gt,q,K),dt=new gv(gt,q,K),K.programs=rt.programs,v.capabilities=X,v.extensions=q,v.properties=Z,v.renderLists=ot,v.shadowMap=lt,v.state=Y,v.info=K}vt();const bt=new gx(v,gt);function xt(t){t.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),b=!0}function _t(){console.log("THREE.WebGLRenderer: Context Restored."),b=!1;const t=K.autoReset,e=lt.enabled,n=lt.autoUpdate,r=lt.needsUpdate,i=lt.type;vt(),K.autoReset=t,lt.enabled=e,lt.autoUpdate=n,lt.needsUpdate=r,lt.type=i}function wt(t){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",t.statusMessage)}function St(t){const e=t.target;e.removeEventListener("dispose",St),function(t){(function(t){const e=Z.get(t).programs;void 0!==e&&(e.forEach((function(t){rt.releaseProgram(t)})),t.isShaderMaterial&&rt.releaseShaderCache(t))})(t),Z.remove(t)}(e)}function Tt(t,e,n){!0===t.transparent&&t.side===Fu&&!1===t.forceSinglePass?(t.side=Lu,t.needsUpdate=!0,Ot(t,e,n),t.side=Du,t.needsUpdate=!0,Ot(t,e,n),t.side=Fu):Ot(t,e,n)}this.xr=bt,this.getContext=function(){return gt},this.getContextAttributes=function(){return gt.getContextAttributes()},this.forceContextLoss=function(){const t=q.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){const t=q.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return P},this.setPixelRatio=function(t){void 0!==t&&(P=t,this.setSize(I,R,!1))},this.getSize=function(t){return t.set(I,R)},this.setSize=function(t,n){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];bt.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(I=t,R=n,e.width=Math.floor(t*P),e.height=Math.floor(n*P),!0===r&&(e.style.width=t+"px",e.style.height=n+"px"),this.setViewport(0,0,t,n))},this.getDrawingBufferSize=function(t){return t.set(I*P,R*P).floor()},this.setDrawingBufferSize=function(t,n,r){I=t,R=n,P=r,e.width=Math.floor(t*r),e.height=Math.floor(n*r),this.setViewport(0,0,t,n)},this.getCurrentViewport=function(t){return t.copy(E)},this.getViewport=function(t){return t.copy(D)},this.setViewport=function(t,e,n,r){t.isVector4?D.set(t.x,t.y,t.z,t.w):D.set(t,e,n,r),Y.viewport(E.copy(D).multiplyScalar(P).round())},this.getScissor=function(t){return t.copy(L)},this.setScissor=function(t,e,n,r){t.isVector4?L.set(t.x,t.y,t.z,t.w):L.set(t,e,n,r),Y.scissor(M.copy(L).multiplyScalar(P).round())},this.getScissorTest=function(){return F},this.setScissorTest=function(t){Y.setScissorTest(F=t)},this.setOpaqueSort=function(t){N=t},this.setTransparentSort=function(t){O=t},this.getClearColor=function(t){return t.copy(ct.getClearColor())},this.setClearColor=function(){ct.setClearColor.apply(ct,arguments)},this.getClearAlpha=function(){return ct.getClearAlpha()},this.setClearAlpha=function(){ct.setClearAlpha.apply(ct,arguments)},this.clear=function(){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],e=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=0;if(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]){let t=!1;if(null!==w){const e=w.texture.format;t=e===bd||e===vd||e===gd}if(t){const t=w.texture.type,e=t===Zh||t===ed||t===$h||t===ad||t===id||t===od,n=ct.getClearColor(),r=ct.getClearAlpha(),i=n.r,o=n.g,a=n.b;e?(d[0]=i,d[1]=o,d[2]=a,d[3]=r,gt.clearBufferuiv(gt.COLOR,0,d)):(p[0]=i,p[1]=o,p[2]=a,p[3]=r,gt.clearBufferiv(gt.COLOR,0,p))}else n|=gt.COLOR_BUFFER_BIT}t&&(n|=gt.DEPTH_BUFFER_BIT),e&&(n|=gt.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),gt.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",xt,!1),e.removeEventListener("webglcontextrestored",_t,!1),e.removeEventListener("webglcontextcreationerror",wt,!1),ot.dispose(),at.dispose(),Z.dispose(),Q.dispose(),$.dispose(),nt.dispose(),ft.dispose(),mt.dispose(),rt.dispose(),bt.dispose(),bt.removeEventListener("sessionstart",Mt),bt.removeEventListener("sessionend",Ct),At.stop()},this.renderBufferDirect=function(t,e,n,r,i,o){null===e&&(e=W);const a=i.isMesh&&i.matrixWorld.determinant()<0,s=function(t,e,n,r,i){!0!==e.isScene&&(e=W);J.resetTextureUnits();const o=e.fog,a=r.isMeshStandardMaterial?e.environment:null,s=null===w?v.outputColorSpace:!0===w.isXRRenderTarget?w.texture.colorSpace:vp,l=(r.isMeshStandardMaterial?$:Q).get(r.envMap||a),c=!0===r.vertexColors&&!!n.attributes.color&&4===n.attributes.color.itemSize,u=!!n.attributes.tangent&&(!!r.normalMap||r.anisotropy>0),h=!!n.morphAttributes.position,d=!!n.morphAttributes.normal,p=!!n.morphAttributes.color;let f=_h;r.toneMapped&&(null!==w&&!0!==w.isXRRenderTarget||(f=v.toneMapping));const g=n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color,y=void 0!==g?g.length:0,b=Z.get(r),x=m.state.lights;if(!0===B&&(!0===z||t!==T)){const e=t===T&&r.id===S;st.setState(r,t,e)}let _=!1;r.version===b.__version?b.needsLights&&b.lightsStateVersion!==x.state.version||b.outputColorSpace!==s||i.isBatchedMesh&&!1===b.batching?_=!0:i.isBatchedMesh||!0!==b.batching?i.isBatchedMesh&&!0===b.batchingColor&&null===i.colorTexture||i.isBatchedMesh&&!1===b.batchingColor&&null!==i.colorTexture||i.isInstancedMesh&&!1===b.instancing?_=!0:i.isInstancedMesh||!0!==b.instancing?i.isSkinnedMesh&&!1===b.skinning?_=!0:i.isSkinnedMesh||!0!==b.skinning?i.isInstancedMesh&&!0===b.instancingColor&&null===i.instanceColor||i.isInstancedMesh&&!1===b.instancingColor&&null!==i.instanceColor||i.isInstancedMesh&&!0===b.instancingMorph&&null===i.morphTexture||i.isInstancedMesh&&!1===b.instancingMorph&&null!==i.morphTexture||b.envMap!==l||!0===r.fog&&b.fog!==o?_=!0:void 0===b.numClippingPlanes||b.numClippingPlanes===st.numPlanes&&b.numIntersection===st.numIntersection?(b.vertexAlphas!==c||b.vertexTangents!==u||b.morphTargets!==h||b.morphNormals!==d||b.morphColors!==p||b.toneMapping!==f||b.morphTargetsCount!==y)&&(_=!0):_=!0:_=!0:_=!0:_=!0:(_=!0,b.__version=r.version);let E=b.currentProgram;!0===_&&(E=Ot(r,e,i));let M=!1,C=!1,A=!1;const k=E.getUniforms(),I=b.uniforms;Y.useProgram(E.program)&&(M=!0,C=!0,A=!0);r.id!==S&&(S=r.id,C=!0);if(M||T!==t){k.setValue(gt,"projectionMatrix",t.projectionMatrix),k.setValue(gt,"viewMatrix",t.matrixWorldInverse);const e=k.map.cameraPosition;void 0!==e&&e.setValue(gt,V.setFromMatrixPosition(t.matrixWorld)),X.logarithmicDepthBuffer&&k.setValue(gt,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),(r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial)&&k.setValue(gt,"isOrthographic",!0===t.isOrthographicCamera),T!==t&&(T=t,C=!0,A=!0)}if(i.isSkinnedMesh){k.setOptional(gt,i,"bindMatrix"),k.setOptional(gt,i,"bindMatrixInverse");const t=i.skeleton;t&&(null===t.boneTexture&&t.computeBoneTexture(),k.setValue(gt,"boneTexture",t.boneTexture,J))}i.isBatchedMesh&&(k.setOptional(gt,i,"batchingTexture"),k.setValue(gt,"batchingTexture",i._matricesTexture,J),k.setOptional(gt,i,"batchingColorTexture"),null!==i._colorsTexture&&k.setValue(gt,"batchingColorTexture",i._colorsTexture,J));const N=n.morphAttributes;void 0===N.position&&void 0===N.normal&&void 0===N.color||ut.update(i,n,E);(C||b.receiveShadow!==i.receiveShadow)&&(b.receiveShadow=i.receiveShadow,k.setValue(gt,"receiveShadow",i.receiveShadow));r.isMeshGouraudMaterial&&null!==r.envMap&&(I.envMap.value=l,I.flipEnvMap.value=l.isCubeTexture&&!1===l.isRenderTargetTexture?-1:1);r.isMeshStandardMaterial&&null===r.envMap&&null!==e.environment&&(I.envMapIntensity.value=e.environmentIntensity);C&&(k.setValue(gt,"toneMappingExposure",v.toneMappingExposure),b.needsLights&&function(t,e){t.ambientLightColor.needsUpdate=e,t.lightProbe.needsUpdate=e,t.directionalLights.needsUpdate=e,t.directionalLightShadows.needsUpdate=e,t.pointLights.needsUpdate=e,t.pointLightShadows.needsUpdate=e,t.spotLights.needsUpdate=e,t.spotLightShadows.needsUpdate=e,t.rectAreaLights.needsUpdate=e,t.hemisphereLights.needsUpdate=e}(I,A),o&&!0===r.fog&&it.refreshFogUniforms(I,o),it.refreshMaterialUniforms(I,r,P,R,m.state.transmissionRenderTarget[t.id]),Eb.upload(gt,Dt(b),I,J));r.isShaderMaterial&&!0===r.uniformsNeedUpdate&&(Eb.upload(gt,Dt(b),I,J),r.uniformsNeedUpdate=!1);r.isSpriteMaterial&&k.setValue(gt,"center",i.center);if(k.setValue(gt,"modelViewMatrix",i.modelViewMatrix),k.setValue(gt,"normalMatrix",i.normalMatrix),k.setValue(gt,"modelMatrix",i.matrixWorld),r.isShaderMaterial||r.isRawShaderMaterial){const t=r.uniformsGroups;for(let e=0,n=t.length;e<n;e++){const n=t[e];mt.update(n,E),mt.bind(n,E)}}return E}(t,e,n,r,i);Y.setMaterial(r,a);let l=n.index,c=1;if(!0===r.wireframe){if(l=et.getWireframeAttribute(n),void 0===l)return;c=2}const u=n.drawRange,h=n.attributes.position;let d=u.start*c,p=(u.start+u.count)*c;null!==o&&(d=Math.max(d,o.start*c),p=Math.min(p,(o.start+o.count)*c)),null!==l?(d=Math.max(d,0),p=Math.min(p,l.count)):void 0!==h&&null!==h&&(d=Math.max(d,0),p=Math.min(p,h.count));const f=p-d;if(f<0||f===1/0)return;let g;ft.setup(i,r,s,n,l);let y=ht;if(null!==l&&(g=tt.get(l),y=dt,y.setIndex(g)),i.isMesh)!0===r.wireframe?(Y.setLineWidth(r.wireframeLinewidth*H()),y.setMode(gt.LINES)):y.setMode(gt.TRIANGLES);else if(i.isLine){let t=r.linewidth;void 0===t&&(t=1),Y.setLineWidth(t*H()),i.isLineSegments?y.setMode(gt.LINES):i.isLineLoop?y.setMode(gt.LINE_LOOP):y.setMode(gt.LINE_STRIP)}else i.isPoints?y.setMode(gt.POINTS):i.isSprite&&y.setMode(gt.TRIANGLES);if(i.isBatchedMesh)null!==i._multiDrawInstances?y.renderMultiDrawInstances(i._multiDrawStarts,i._multiDrawCounts,i._multiDrawCount,i._multiDrawInstances):y.renderMultiDraw(i._multiDrawStarts,i._multiDrawCounts,i._multiDrawCount);else if(i.isInstancedMesh)y.renderInstances(d,f,i.count);else if(n.isInstancedBufferGeometry){const t=void 0!==n._maxInstanceCount?n._maxInstanceCount:1/0,e=Math.min(n.instanceCount,t);y.renderInstances(d,f,e)}else y.render(d,f)},this.compile=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;null===n&&(n=t),m=at.get(n),m.init(e),y.push(m),n.traverseVisible((function(t){t.isLight&&t.layers.test(e.layers)&&(m.pushLight(t),t.castShadow&&m.pushShadow(t))})),t!==n&&t.traverseVisible((function(t){t.isLight&&t.layers.test(e.layers)&&(m.pushLight(t),t.castShadow&&m.pushShadow(t))})),m.setupLights();const r=new Set;return t.traverse((function(t){const e=t.material;if(e)if(Array.isArray(e))for(let i=0;i<e.length;i++){const o=e[i];Tt(o,n,t),r.add(o)}else Tt(e,n,t),r.add(e)})),y.pop(),m=null,r},this.compileAsync=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const r=this.compile(t,e,n);return new Promise((e=>{function n(){r.forEach((function(t){Z.get(t).currentProgram.isReady()&&r.delete(t)})),0!==r.size?setTimeout(n,10):e(t)}null!==q.get("KHR_parallel_shader_compile")?n():setTimeout(n,10)}))};let Et=null;function Mt(){At.stop()}function Ct(){At.start()}const At=new Dy;function kt(t,e,n,r){if(!1===t.visible)return;if(t.layers.test(e.layers))if(t.isGroup)n=t.renderOrder;else if(t.isLOD)!0===t.autoUpdate&&t.update(e);else if(t.isLight)m.pushLight(t),t.castShadow&&m.pushShadow(t);else if(t.isSprite){if(!t.frustumCulled||U.intersectsSprite(t)){r&&V.setFromMatrixPosition(t.matrixWorld).applyMatrix4(j);const e=nt.update(t),i=t.material;i.visible&&f.push(t,e,i,n,V.z,null)}}else if((t.isMesh||t.isLine||t.isPoints)&&(!t.frustumCulled||U.intersectsObject(t))){const e=nt.update(t),i=t.material;if(r&&(void 0!==t.boundingSphere?(null===t.boundingSphere&&t.computeBoundingSphere(),V.copy(t.boundingSphere.center)):(null===e.boundingSphere&&e.computeBoundingSphere(),V.copy(e.boundingSphere.center)),V.applyMatrix4(t.matrixWorld).applyMatrix4(j)),Array.isArray(i)){const r=e.groups;for(let o=0,a=r.length;o<a;o++){const a=r[o],s=i[a.materialIndex];s&&s.visible&&f.push(t,e,s,n,V.z,a)}}else i.visible&&f.push(t,e,i,n,V.z,null)}const i=t.children;for(let o=0,a=i.length;o<a;o++)kt(i[o],e,n,r)}function It(t,e,n,r){const i=t.opaque,o=t.transmissive,a=t.transparent;m.setupLightsView(n),!0===B&&st.setGlobalState(v.clippingPlanes,n),r&&Y.viewport(E.copy(r)),i.length>0&&Pt(i,e,n),o.length>0&&Pt(o,e,n),a.length>0&&Pt(a,e,n),Y.buffers.depth.setTest(!0),Y.buffers.depth.setMask(!0),Y.buffers.color.setMask(!0),Y.setPolygonOffset(!1)}function Rt(t,e,n,r){if(null!==(!0===n.isScene?n.overrideMaterial:null))return;void 0===m.state.transmissionRenderTarget[r.id]&&(m.state.transmissionRenderTarget[r.id]=new Xf(1,1,{generateMipmaps:!0,type:q.has("EXT_color_buffer_half_float")||q.has("EXT_color_buffer_float")?rd:Zh,minFilter:Yh,samples:4,stencilBuffer:i,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:Df.workingColorSpace}));const o=m.state.transmissionRenderTarget[r.id],a=r.viewport||E;o.setSize(a.z,a.w);const s=v.getRenderTarget();v.setRenderTarget(o),v.getClearColor(A),k=v.getClearAlpha(),k<1&&v.setClearColor(16777215,.5),G?ct.render(n):v.clear();const l=v.toneMapping;v.toneMapping=_h;const c=r.viewport;if(void 0!==r.viewport&&(r.viewport=void 0),m.setupLightsView(r),!0===B&&st.setGlobalState(v.clippingPlanes,r),Pt(t,n,r),J.updateMultisampleRenderTarget(o),J.updateRenderTargetMipmap(o),!1===q.has("WEBGL_multisampled_render_to_texture")){let t=!1;for(let i=0,o=e.length;i<o;i++){const o=e[i],a=o.object,s=o.geometry,l=o.material,c=o.group;if(l.side===Fu&&a.layers.test(r.layers)){const e=l.side;l.side=Lu,l.needsUpdate=!0,Nt(a,n,r,s,l,c),l.side=e,l.needsUpdate=!0,t=!0}}!0===t&&(J.updateMultisampleRenderTarget(o),J.updateRenderTargetMipmap(o))}v.setRenderTarget(s),v.setClearColor(A,k),void 0!==c&&(r.viewport=c),v.toneMapping=l}function Pt(t,e,n){const r=!0===e.isScene?e.overrideMaterial:null;for(let i=0,o=t.length;i<o;i++){const o=t[i],a=o.object,s=o.geometry,l=null===r?o.material:r,c=o.group;a.layers.test(n.layers)&&Nt(a,e,n,s,l,c)}}function Nt(t,e,n,r,i,o){t.onBeforeRender(v,e,n,r,i,o),t.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),i.onBeforeRender(v,e,n,r,t,o),!0===i.transparent&&i.side===Fu&&!1===i.forceSinglePass?(i.side=Lu,i.needsUpdate=!0,v.renderBufferDirect(n,e,r,i,t,o),i.side=Du,i.needsUpdate=!0,v.renderBufferDirect(n,e,r,i,t,o),i.side=Fu):v.renderBufferDirect(n,e,r,i,t,o),t.onAfterRender(v,e,n,r,i,o)}function Ot(t,e,n){!0!==e.isScene&&(e=W);const r=Z.get(t),i=m.state.lights,o=m.state.shadowsArray,a=i.state.version,s=rt.getParameters(t,i.state,o,e,n),l=rt.getProgramCacheKey(s);let c=r.programs;r.environment=t.isMeshStandardMaterial?e.environment:null,r.fog=e.fog,r.envMap=(t.isMeshStandardMaterial?$:Q).get(t.envMap||r.environment),r.envMapRotation=null!==r.environment&&null===t.envMap?e.environmentRotation:t.envMapRotation,void 0===c&&(t.addEventListener("dispose",St),c=new Map,r.programs=c);let u=c.get(l);if(void 0!==u){if(r.currentProgram===u&&r.lightsStateVersion===a)return Lt(t,s),u}else s.uniforms=rt.getUniforms(t),t.onBuild(n,s,v),t.onBeforeCompile(s,v),u=rt.acquireProgram(s,l),c.set(l,u),r.uniforms=s.uniforms;const h=r.uniforms;return(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(h.clippingPlanes=st.uniform),Lt(t,s),r.needsLights=function(t){return t.isMeshLambertMaterial||t.isMeshToonMaterial||t.isMeshPhongMaterial||t.isMeshStandardMaterial||t.isShadowMaterial||t.isShaderMaterial&&!0===t.lights}(t),r.lightsStateVersion=a,r.needsLights&&(h.ambientLightColor.value=i.state.ambient,h.lightProbe.value=i.state.probe,h.directionalLights.value=i.state.directional,h.directionalLightShadows.value=i.state.directionalShadow,h.spotLights.value=i.state.spot,h.spotLightShadows.value=i.state.spotShadow,h.rectAreaLights.value=i.state.rectArea,h.ltc_1.value=i.state.rectAreaLTC1,h.ltc_2.value=i.state.rectAreaLTC2,h.pointLights.value=i.state.point,h.pointLightShadows.value=i.state.pointShadow,h.hemisphereLights.value=i.state.hemi,h.directionalShadowMap.value=i.state.directionalShadowMap,h.directionalShadowMatrix.value=i.state.directionalShadowMatrix,h.spotShadowMap.value=i.state.spotShadowMap,h.spotLightMatrix.value=i.state.spotLightMatrix,h.spotLightMap.value=i.state.spotLightMap,h.pointShadowMap.value=i.state.pointShadowMap,h.pointShadowMatrix.value=i.state.pointShadowMatrix),r.currentProgram=u,r.uniformsList=null,u}function Dt(t){if(null===t.uniformsList){const e=t.currentProgram.getUniforms();t.uniformsList=Eb.seqWithValue(e.seq,t.uniforms)}return t.uniformsList}function Lt(t,e){const n=Z.get(t);n.outputColorSpace=e.outputColorSpace,n.batching=e.batching,n.batchingColor=e.batchingColor,n.instancing=e.instancing,n.instancingColor=e.instancingColor,n.instancingMorph=e.instancingMorph,n.skinning=e.skinning,n.morphTargets=e.morphTargets,n.morphNormals=e.morphNormals,n.morphColors=e.morphColors,n.morphTargetsCount=e.morphTargetsCount,n.numClippingPlanes=e.numClippingPlanes,n.numIntersection=e.numClipIntersection,n.vertexAlphas=e.vertexAlphas,n.vertexTangents=e.vertexTangents,n.toneMapping=e.toneMapping}At.setAnimationLoop((function(t){Et&&Et(t)})),"undefined"!==typeof self&&At.setContext(self),this.setAnimationLoop=function(t){Et=t,bt.setAnimationLoop(t),null===t?At.stop():At.start()},bt.addEventListener("sessionstart",Mt),bt.addEventListener("sessionend",Ct),this.render=function(t,e){if(void 0!==e&&!0!==e.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===b)return;if(!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),null===e.parent&&!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),!0===bt.enabled&&!0===bt.isPresenting&&(!0===bt.cameraAutoUpdate&&bt.updateCamera(e),e=bt.getCamera()),!0===t.isScene&&t.onBeforeRender(v,t,e,w),m=at.get(t,y.length),m.init(e),y.push(m),j.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),U.setFromProjectionMatrix(j),z=this.localClippingEnabled,B=st.init(this.clippingPlanes,z),f=ot.get(t,g.length),f.init(),g.push(f),!0===bt.enabled&&!0===bt.isPresenting){const t=v.xr.getDepthSensingMesh();null!==t&&kt(t,e,-1/0,v.sortObjects)}kt(t,e,0,v.sortObjects),f.finish(),!0===v.sortObjects&&f.sort(N,O),G=!1===bt.enabled||!1===bt.isPresenting||!1===bt.hasDepthSensing(),G&&ct.addToRenderList(f,t),this.info.render.frame++,!0===B&&st.beginShadows();const n=m.state.shadowsArray;lt.render(n,t,e),!0===B&&st.endShadows(),!0===this.info.autoReset&&this.info.reset();const r=f.opaque,i=f.transmissive;if(m.setupLights(),e.isArrayCamera){const n=e.cameras;if(i.length>0)for(let e=0,o=n.length;e<o;e++){Rt(r,i,t,n[e])}G&&ct.render(t);for(let e=0,r=n.length;e<r;e++){const r=n[e];It(f,t,r,r.viewport)}}else i.length>0&&Rt(r,i,t,e),G&&ct.render(t),It(f,t,e);null!==w&&(J.updateMultisampleRenderTarget(w),J.updateRenderTargetMipmap(w)),!0===t.isScene&&t.onAfterRender(v,t,e),ft.resetDefaultState(),S=-1,T=null,y.pop(),y.length>0?(m=y[y.length-1],!0===B&&st.setGlobalState(v.clippingPlanes,m.state.camera)):m=null,g.pop(),f=g.length>0?g[g.length-1]:null},this.getActiveCubeFace=function(){return x},this.getActiveMipmapLevel=function(){return _},this.getRenderTarget=function(){return w},this.setRenderTargetTextures=function(t,e,n){Z.get(t.texture).__webglTexture=e,Z.get(t.depthTexture).__webglTexture=n;const r=Z.get(t);r.__hasExternalTextures=!0,r.__autoAllocateDepthBuffer=void 0===n,r.__autoAllocateDepthBuffer||!0===q.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),r.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(t,e){const n=Z.get(t);n.__webglFramebuffer=e,n.__useDefaultFramebuffer=void 0===e},this.setRenderTarget=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;w=t,x=e,_=n;let r=!0,i=null,o=!1,a=!1;if(t){const s=Z.get(t);void 0!==s.__useDefaultFramebuffer?(Y.bindFramebuffer(gt.FRAMEBUFFER,null),r=!1):void 0===s.__webglFramebuffer?J.setupRenderTarget(t):s.__hasExternalTextures&&J.rebindTextures(t,Z.get(t.texture).__webglTexture,Z.get(t.depthTexture).__webglTexture);const l=t.texture;(l.isData3DTexture||l.isDataArrayTexture||l.isCompressedArrayTexture)&&(a=!0);const c=Z.get(t).__webglFramebuffer;t.isWebGLCubeRenderTarget?(i=Array.isArray(c[e])?c[e][n]:c[e],o=!0):i=t.samples>0&&!1===J.useMultisampledRTT(t)?Z.get(t).__webglMultisampledFramebuffer:Array.isArray(c)?c[n]:c,E.copy(t.viewport),M.copy(t.scissor),C=t.scissorTest}else E.copy(D).multiplyScalar(P).floor(),M.copy(L).multiplyScalar(P).floor(),C=F;if(Y.bindFramebuffer(gt.FRAMEBUFFER,i)&&r&&Y.drawBuffers(t,i),Y.viewport(E),Y.scissor(M),Y.setScissorTest(C),o){const r=Z.get(t.texture);gt.framebufferTexture2D(gt.FRAMEBUFFER,gt.COLOR_ATTACHMENT0,gt.TEXTURE_CUBE_MAP_POSITIVE_X+e,r.__webglTexture,n)}else if(a){const r=Z.get(t.texture),i=e||0;gt.framebufferTextureLayer(gt.FRAMEBUFFER,gt.COLOR_ATTACHMENT0,r.__webglTexture,n||0,i)}S=-1},this.readRenderTargetPixels=function(t,e,n,r,i,o,a){if(!t||!t.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let s=Z.get(t).__webglFramebuffer;if(t.isWebGLCubeRenderTarget&&void 0!==a&&(s=s[a]),s){Y.bindFramebuffer(gt.FRAMEBUFFER,s);try{const a=t.texture,s=a.format,l=a.type;if(!X.textureFormatReadable(s))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!X.textureTypeReadable(l))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");e>=0&&e<=t.width-r&&n>=0&&n<=t.height-i&&gt.readPixels(e,n,r,i,pt.convert(s),pt.convert(l),o)}finally{const t=null!==w?Z.get(w).__webglFramebuffer:null;Y.bindFramebuffer(gt.FRAMEBUFFER,t)}}},this.readRenderTargetPixelsAsync=async function(t,e,n,r,i,o,a){if(!t||!t.isWebGLRenderTarget)throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let s=Z.get(t).__webglFramebuffer;if(t.isWebGLCubeRenderTarget&&void 0!==a&&(s=s[a]),s){Y.bindFramebuffer(gt.FRAMEBUFFER,s);try{const a=t.texture,s=a.format,l=a.type;if(!X.textureFormatReadable(s))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!X.textureTypeReadable(l))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");if(e>=0&&e<=t.width-r&&n>=0&&n<=t.height-i){const t=gt.createBuffer();gt.bindBuffer(gt.PIXEL_PACK_BUFFER,t),gt.bufferData(gt.PIXEL_PACK_BUFFER,o.byteLength,gt.STREAM_READ),gt.readPixels(e,n,r,i,pt.convert(s),pt.convert(l),0),gt.flush();const a=gt.fenceSync(gt.SYNC_GPU_COMMANDS_COMPLETE,0);await function(t,e,n){return new Promise((function(r,i){setTimeout((function o(){switch(t.clientWaitSync(e,t.SYNC_FLUSH_COMMANDS_BIT,0)){case t.WAIT_FAILED:i();break;case t.TIMEOUT_EXPIRED:setTimeout(o,n);break;default:r()}}),n)}))}(gt,a,4);try{gt.bindBuffer(gt.PIXEL_PACK_BUFFER,t),gt.getBufferSubData(gt.PIXEL_PACK_BUFFER,0,o)}finally{gt.deleteBuffer(t),gt.deleteSync(a)}return o}}finally{const t=null!==w?Z.get(w).__webglFramebuffer:null;Y.bindFramebuffer(gt.FRAMEBUFFER,t)}}},this.copyFramebufferToTexture=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;!0!==t.isTexture&&(console.warn("WebGLRenderer: copyFramebufferToTexture function signature has changed."),e=arguments[0]||null,t=arguments[1]);const r=Math.pow(2,-n),i=Math.floor(t.image.width*r),o=Math.floor(t.image.height*r),a=null!==e?e.x:0,s=null!==e?e.y:0;J.setTexture2D(t,0),gt.copyTexSubImage2D(gt.TEXTURE_2D,n,0,0,a,s,i,o),Y.unbindTexture()},this.copyTextureToTexture=function(t,e){let n,r,i,o,a,s,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;!0!==t.isTexture&&(console.warn("WebGLRenderer: copyTextureToTexture function signature has changed."),c=arguments[0]||null,t=arguments[1],e=arguments[2],u=arguments[3]||0,l=null),null!==l?(n=l.max.x-l.min.x,r=l.max.y-l.min.y,i=l.min.x,o=l.min.y):(n=t.image.width,r=t.image.height,i=0,o=0),null!==c?(a=c.x,s=c.y):(a=0,s=0);const h=pt.convert(e.format),d=pt.convert(e.type);J.setTexture2D(e,0),gt.pixelStorei(gt.UNPACK_FLIP_Y_WEBGL,e.flipY),gt.pixelStorei(gt.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha),gt.pixelStorei(gt.UNPACK_ALIGNMENT,e.unpackAlignment);const p=gt.getParameter(gt.UNPACK_ROW_LENGTH),f=gt.getParameter(gt.UNPACK_IMAGE_HEIGHT),m=gt.getParameter(gt.UNPACK_SKIP_PIXELS),g=gt.getParameter(gt.UNPACK_SKIP_ROWS),y=gt.getParameter(gt.UNPACK_SKIP_IMAGES),v=t.isCompressedTexture?t.mipmaps[u]:t.image;gt.pixelStorei(gt.UNPACK_ROW_LENGTH,v.width),gt.pixelStorei(gt.UNPACK_IMAGE_HEIGHT,v.height),gt.pixelStorei(gt.UNPACK_SKIP_PIXELS,i),gt.pixelStorei(gt.UNPACK_SKIP_ROWS,o),t.isDataTexture?gt.texSubImage2D(gt.TEXTURE_2D,u,a,s,n,r,h,d,v.data):t.isCompressedTexture?gt.compressedTexSubImage2D(gt.TEXTURE_2D,u,a,s,v.width,v.height,h,v.data):gt.texSubImage2D(gt.TEXTURE_2D,u,a,s,h,d,v),gt.pixelStorei(gt.UNPACK_ROW_LENGTH,p),gt.pixelStorei(gt.UNPACK_IMAGE_HEIGHT,f),gt.pixelStorei(gt.UNPACK_SKIP_PIXELS,m),gt.pixelStorei(gt.UNPACK_SKIP_ROWS,g),gt.pixelStorei(gt.UNPACK_SKIP_IMAGES,y),0===u&&e.generateMipmaps&&gt.generateMipmap(gt.TEXTURE_2D),Y.unbindTexture()},this.copyTextureToTexture3D=function(t,e){let n,r,i,o,a,s,l,c,u,h=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,p=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;!0!==t.isTexture&&(console.warn("WebGLRenderer: copyTextureToTexture3D function signature has changed."),h=arguments[0]||null,d=arguments[1]||null,t=arguments[2],e=arguments[3],p=arguments[4]||0);const f=t.isCompressedTexture?t.mipmaps[p]:t.image;null!==h?(n=h.max.x-h.min.x,r=h.max.y-h.min.y,i=h.max.z-h.min.z,o=h.min.x,a=h.min.y,s=h.min.z):(n=f.width,r=f.height,i=f.depth,o=0,a=0,s=0),null!==d?(l=d.x,c=d.y,u=d.z):(l=0,c=0,u=0);const m=pt.convert(e.format),g=pt.convert(e.type);let y;if(e.isData3DTexture)J.setTexture3D(e,0),y=gt.TEXTURE_3D;else{if(!e.isDataArrayTexture&&!e.isCompressedArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");J.setTexture2DArray(e,0),y=gt.TEXTURE_2D_ARRAY}gt.pixelStorei(gt.UNPACK_FLIP_Y_WEBGL,e.flipY),gt.pixelStorei(gt.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha),gt.pixelStorei(gt.UNPACK_ALIGNMENT,e.unpackAlignment);const v=gt.getParameter(gt.UNPACK_ROW_LENGTH),b=gt.getParameter(gt.UNPACK_IMAGE_HEIGHT),x=gt.getParameter(gt.UNPACK_SKIP_PIXELS),_=gt.getParameter(gt.UNPACK_SKIP_ROWS),w=gt.getParameter(gt.UNPACK_SKIP_IMAGES);gt.pixelStorei(gt.UNPACK_ROW_LENGTH,f.width),gt.pixelStorei(gt.UNPACK_IMAGE_HEIGHT,f.height),gt.pixelStorei(gt.UNPACK_SKIP_PIXELS,o),gt.pixelStorei(gt.UNPACK_SKIP_ROWS,a),gt.pixelStorei(gt.UNPACK_SKIP_IMAGES,s),t.isDataTexture||t.isData3DTexture?gt.texSubImage3D(y,p,l,c,u,n,r,i,m,g,f.data):e.isCompressedArrayTexture?gt.compressedTexSubImage3D(y,p,l,c,u,n,r,i,m,f.data):gt.texSubImage3D(y,p,l,c,u,n,r,i,m,g,f),gt.pixelStorei(gt.UNPACK_ROW_LENGTH,v),gt.pixelStorei(gt.UNPACK_IMAGE_HEIGHT,b),gt.pixelStorei(gt.UNPACK_SKIP_PIXELS,x),gt.pixelStorei(gt.UNPACK_SKIP_ROWS,_),gt.pixelStorei(gt.UNPACK_SKIP_IMAGES,w),0===p&&e.generateMipmaps&&gt.generateMipmap(y),Y.unbindTexture()},this.initRenderTarget=function(t){void 0===Z.get(t).__webglFramebuffer&&J.setupRenderTarget(t)},this.initTexture=function(t){t.isCubeTexture?J.setTextureCube(t,0):t.isData3DTexture?J.setTexture3D(t,0):t.isDataArrayTexture||t.isCompressedArrayTexture?J.setTexture2DArray(t,0):J.setTexture2D(t,0),Y.unbindTexture()},this.resetState=function(){x=0,_=0,w=null,Y.reset(),ft.reset()},"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return sf}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(t){this._outputColorSpace=t;const e=this.getContext();e.drawingBufferColorSpace=t===bp?"display-p3":"srgb",e.unpackColorSpace=Df.workingColorSpace===xp?"display-p3":"srgb"}}class wx{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:25e-5;this.isFogExp2=!0,this.name="",this.color=new vg(t),this.density=e}clone(){return new wx(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class Sx{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;this.isFog=!0,this.name="",this.color=new vg(t),this.near=e,this.far=n}clone(){return new Sx(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class Tx extends ng{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Bm,this.environmentIntensity=1,this.environmentRotation=new Bm,this.overrideMaterial=null,"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(t,e){return super.copy(t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),this.backgroundBlurriness=t.backgroundBlurriness,this.backgroundIntensity=t.backgroundIntensity,this.backgroundRotation.copy(t.backgroundRotation),this.environmentIntensity=t.environmentIntensity,this.environmentRotation.copy(t.environmentRotation),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.matrixAutoUpdate=t.matrixAutoUpdate,this}toJSON(t){const e=super.toJSON(t);return null!==this.fog&&(e.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(e.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(e.object.backgroundIntensity=this.backgroundIntensity),e.object.backgroundRotation=this.backgroundRotation.toArray(),1!==this.environmentIntensity&&(e.object.environmentIntensity=this.environmentIntensity),e.object.environmentRotation=this.environmentRotation.toArray(),e}}class Ex{constructor(t,e){this.isInterleavedBuffer=!0,this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.usage=Kp,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=ff()}onUploadCallback(){}set needsUpdate(t){!0===t&&this.version++}get updateRange(){return If("THREE.InterleavedBuffer: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(t){return this.usage=t,this}addUpdateRange(t,e){this.updateRanges.push({start:t,count:e})}clearUpdateRanges(){this.updateRanges.length=0}copy(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this}copyAt(t,e,n){t*=this.stride,n*=e.stride;for(let r=0,i=this.stride;r<i;r++)this.array[t+r]=e.array[n+r];return this}set(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(t,e),this}clone(t){void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=ff()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const e=new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(e,this.stride);return n.setUsage(this.usage),n}onUpload(t){return this.onUploadCallback=t,this}toJSON(t){return void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=ff()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Mx=new $f;class Cx{constructor(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.isInterleavedBufferAttribute=!0,this.name="",this.data=t,this.itemSize=e,this.offset=n,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(t){this.data.needsUpdate=t}applyMatrix4(t){for(let e=0,n=this.data.count;e<n;e++)Mx.fromBufferAttribute(this,e),Mx.applyMatrix4(t),this.setXYZ(e,Mx.x,Mx.y,Mx.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)Mx.fromBufferAttribute(this,e),Mx.applyNormalMatrix(t),this.setXYZ(e,Mx.x,Mx.y,Mx.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)Mx.fromBufferAttribute(this,e),Mx.transformDirection(t),this.setXYZ(e,Mx.x,Mx.y,Mx.z);return this}getComponent(t,e){let n=this.array[t*this.data.stride+this.offset+e];return this.normalized&&(n=vf(n,this.array)),n}setComponent(t,e,n){return this.normalized&&(n=bf(n,this.array)),this.data.array[t*this.data.stride+this.offset+e]=n,this}setX(t,e){return this.normalized&&(e=bf(e,this.array)),this.data.array[t*this.data.stride+this.offset]=e,this}setY(t,e){return this.normalized&&(e=bf(e,this.array)),this.data.array[t*this.data.stride+this.offset+1]=e,this}setZ(t,e){return this.normalized&&(e=bf(e,this.array)),this.data.array[t*this.data.stride+this.offset+2]=e,this}setW(t,e){return this.normalized&&(e=bf(e,this.array)),this.data.array[t*this.data.stride+this.offset+3]=e,this}getX(t){let e=this.data.array[t*this.data.stride+this.offset];return this.normalized&&(e=vf(e,this.array)),e}getY(t){let e=this.data.array[t*this.data.stride+this.offset+1];return this.normalized&&(e=vf(e,this.array)),e}getZ(t){let e=this.data.array[t*this.data.stride+this.offset+2];return this.normalized&&(e=vf(e,this.array)),e}getW(t){let e=this.data.array[t*this.data.stride+this.offset+3];return this.normalized&&(e=vf(e,this.array)),e}setXY(t,e,n){return t=t*this.data.stride+this.offset,this.normalized&&(e=bf(e,this.array),n=bf(n,this.array)),this.data.array[t+0]=e,this.data.array[t+1]=n,this}setXYZ(t,e,n,r){return t=t*this.data.stride+this.offset,this.normalized&&(e=bf(e,this.array),n=bf(n,this.array),r=bf(r,this.array)),this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this}setXYZW(t,e,n,r,i){return t=t*this.data.stride+this.offset,this.normalized&&(e=bf(e,this.array),n=bf(n,this.array),r=bf(r,this.array),i=bf(i,this.array)),this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this.data.array[t+3]=i,this}clone(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let e=0;e<this.count;e++){const n=e*this.data.stride+this.offset;for(let e=0;e<this.itemSize;e++)t.push(this.data.array[n+e])}return new Ig(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new Cx(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let e=0;e<this.count;e++){const n=e*this.data.stride+this.offset;for(let e=0;e<this.itemSize;e++)t.push(this.data.array[n+e])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class Ax extends _g{constructor(t){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new vg(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this.fog=t.fog,this}}let kx;const Ix=new $f,Rx=new $f,Px=new $f,Nx=new _f,Ox=new _f,Dx=new km,Lx=new $f,Fx=new $f,Ux=new $f,Bx=new _f,zx=new _f,jx=new _f;class Vx extends ng{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ax;if(super(),this.isSprite=!0,this.type="Sprite",void 0===kx){kx=new Xg;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),e=new Ex(t,5);kx.setIndex([0,1,2,0,2,3]),kx.setAttribute("position",new Cx(e,3,0,!1)),kx.setAttribute("uv",new Cx(e,2,3,!1))}this.geometry=kx,this.material=t,this.center=new _f(.5,.5)}raycast(t,e){null===t.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Rx.setFromMatrixScale(this.matrixWorld),Dx.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),Px.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Rx.multiplyScalar(-Px.z);const n=this.material.rotation;let r,i;0!==n&&(i=Math.cos(n),r=Math.sin(n));const o=this.center;Wx(Lx.set(-.5,-.5,0),Px,o,Rx,r,i),Wx(Fx.set(.5,-.5,0),Px,o,Rx,r,i),Wx(Ux.set(.5,.5,0),Px,o,Rx,r,i),Bx.set(0,0),zx.set(1,0),jx.set(1,1);let a=t.ray.intersectTriangle(Lx,Fx,Ux,!1,Ix);if(null===a&&(Wx(Fx.set(-.5,.5,0),Px,o,Rx,r,i),zx.set(0,1),a=t.ray.intersectTriangle(Lx,Ux,Fx,!1,Ix),null===a))return;const s=t.ray.origin.distanceTo(Ix);s<t.near||s>t.far||e.push({distance:s,point:Ix.clone(),uv:pg.getInterpolation(Ix,Lx,Fx,Ux,Bx,zx,jx,new _f),face:null,object:this})}copy(t,e){return super.copy(t,e),void 0!==t.center&&this.center.copy(t.center),this.material=t.material,this}}function Wx(t,e,n,r,i,o){Nx.subVectors(t,n).addScalar(.5).multiply(r),void 0!==i?(Ox.x=o*Nx.x-i*Nx.y,Ox.y=i*Nx.x+o*Nx.y):Ox.copy(Nx),t.copy(e),t.x+=Ox.x,t.y+=Ox.y,t.applyMatrix4(Dx)}const Gx=new $f,Hx=new $f;class qx extends ng{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(t){super.copy(t,!1);const e=t.levels;for(let n=0,r=e.length;n<r;n++){const t=e[n];this.addLevel(t.object.clone(),t.distance,t.hysteresis)}return this.autoUpdate=t.autoUpdate,this}addLevel(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;e=Math.abs(e);const r=this.levels;let i;for(i=0;i<r.length&&!(e<r[i].distance);i++);return r.splice(i,0,{distance:e,hysteresis:n,object:t}),this.add(t),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(t){const e=this.levels;if(e.length>0){let n,r;for(n=1,r=e.length;n<r;n++){let r=e[n].distance;if(e[n].object.visible&&(r-=r*e[n].hysteresis),t<r)break}return e[n-1].object}return null}raycast(t,e){if(this.levels.length>0){Gx.setFromMatrixPosition(this.matrixWorld);const n=t.ray.origin.distanceTo(Gx);this.getObjectForDistance(n).raycast(t,e)}}update(t){const e=this.levels;if(e.length>1){Gx.setFromMatrixPosition(t.matrixWorld),Hx.setFromMatrixPosition(this.matrixWorld);const n=Gx.distanceTo(Hx)/t.zoom;let r,i;for(e[0].object.visible=!0,r=1,i=e.length;r<i;r++){let t=e[r].distance;if(e[r].object.visible&&(t-=t*e[r].hysteresis),!(n>=t))break;e[r-1].object.visible=!1,e[r].object.visible=!0}for(this._currentLevel=r-1;r<i;r++)e[r].object.visible=!1}}toJSON(t){const e=super.toJSON(t);!1===this.autoUpdate&&(e.object.autoUpdate=!1),e.object.levels=[];const n=this.levels;for(let r=0,i=n.length;r<i;r++){const t=n[r];e.object.levels.push({object:t.object.uuid,distance:t.distance,hysteresis:t.hysteresis})}return e}}const Xx=new $f,Yx=new Hf,Kx=new Hf,Zx=new $f,Jx=new km,Qx=new $f,$x=new xm,t_=new km,e_=new Am;class n_ extends hy{constructor(t,e){super(t,e),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=kh,this.bindMatrix=new km,this.bindMatrixInverse=new km,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const t=this.geometry;null===this.boundingBox&&(this.boundingBox=new nm),this.boundingBox.makeEmpty();const e=t.getAttribute("position");for(let n=0;n<e.count;n++)this.getVertexPosition(n,Qx),this.boundingBox.expandByPoint(Qx)}computeBoundingSphere(){const t=this.geometry;null===this.boundingSphere&&(this.boundingSphere=new xm),this.boundingSphere.makeEmpty();const e=t.getAttribute("position");for(let n=0;n<e.count;n++)this.getVertexPosition(n,Qx),this.boundingSphere.expandByPoint(Qx)}copy(t,e){return super.copy(t,e),this.bindMode=t.bindMode,this.bindMatrix.copy(t.bindMatrix),this.bindMatrixInverse.copy(t.bindMatrixInverse),this.skeleton=t.skeleton,null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this}raycast(t,e){const n=this.material,r=this.matrixWorld;void 0!==n&&(null===this.boundingSphere&&this.computeBoundingSphere(),$x.copy(this.boundingSphere),$x.applyMatrix4(r),!1!==t.ray.intersectsSphere($x)&&(t_.copy(r).invert(),e_.copy(t.ray).applyMatrix4(t_),null!==this.boundingBox&&!1===e_.intersectsBox(this.boundingBox)||this._computeIntersections(t,e,e_)))}getVertexPosition(t,e){return super.getVertexPosition(t,e),this.applyBoneTransform(t,e),e}bind(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.copy(e).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const t=new Hf,e=this.geometry.attributes.skinWeight;for(let n=0,r=e.count;n<r;n++){t.fromBufferAttribute(e,n);const r=1/t.manhattanLength();r!==1/0?t.multiplyScalar(r):t.set(1,0,0,0),e.setXYZW(n,t.x,t.y,t.z,t.w)}}updateMatrixWorld(t){super.updateMatrixWorld(t),this.bindMode===kh?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===Ih?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(t,e){const n=this.skeleton,r=this.geometry;Yx.fromBufferAttribute(r.attributes.skinIndex,t),Kx.fromBufferAttribute(r.attributes.skinWeight,t),Xx.copy(e).applyMatrix4(this.bindMatrix),e.set(0,0,0);for(let i=0;i<4;i++){const t=Kx.getComponent(i);if(0!==t){const r=Yx.getComponent(i);Jx.multiplyMatrices(n.bones[r].matrixWorld,n.boneInverses[r]),e.addScaledVector(Zx.copy(Xx).applyMatrix4(Jx),t)}}return e.applyMatrix4(this.bindMatrixInverse)}}class r_ extends ng{constructor(){super(),this.isBone=!0,this.type="Bone"}}class i_ extends Gf{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;super(null,arguments.length>5?arguments[5]:void 0,arguments.length>6?arguments[6]:void 0,arguments.length>7?arguments[7]:void 0,arguments.length>8&&void 0!==arguments[8]?arguments[8]:zh,arguments.length>9&&void 0!==arguments[9]?arguments[9]:zh,arguments.length>3?arguments[3]:void 0,arguments.length>4?arguments[4]:void 0,arguments.length>10?arguments[10]:void 0,arguments.length>11?arguments[11]:void 0),this.isDataTexture=!0,this.image={data:t,width:e,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const o_=new km,a_=new km;class s_{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.uuid=ff(),this.bones=t.slice(0),this.boneInverses=e,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const t=this.bones,e=this.boneInverses;if(this.boneMatrices=new Float32Array(16*t.length),0===e.length)this.calculateInverses();else if(t.length!==e.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let t=0,e=this.bones.length;t<e;t++)this.boneInverses.push(new km)}}calculateInverses(){this.boneInverses.length=0;for(let t=0,e=this.bones.length;t<e;t++){const e=new km;this.bones[t]&&e.copy(this.bones[t].matrixWorld).invert(),this.boneInverses.push(e)}}pose(){for(let t=0,e=this.bones.length;t<e;t++){const e=this.bones[t];e&&e.matrixWorld.copy(this.boneInverses[t]).invert()}for(let t=0,e=this.bones.length;t<e;t++){const e=this.bones[t];e&&(e.parent&&e.parent.isBone?(e.matrix.copy(e.parent.matrixWorld).invert(),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))}}update(){const t=this.bones,e=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let i=0,o=t.length;i<o;i++){const r=t[i]?t[i].matrixWorld:a_;o_.multiplyMatrices(r,e[i]),o_.toArray(n,16*i)}null!==r&&(r.needsUpdate=!0)}clone(){return new s_(this.bones,this.boneInverses)}computeBoneTexture(){let t=Math.sqrt(4*this.bones.length);t=4*Math.ceil(t/4),t=Math.max(t,4);const e=new Float32Array(t*t*4);e.set(this.boneMatrices);const n=new i_(e,t,t,ud,nd);return n.needsUpdate=!0,this.boneMatrices=e,this.boneTexture=n,this}getBoneByName(t){for(let e=0,n=this.bones.length;e<n;e++){const n=this.bones[e];if(n.name===t)return n}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(t,e){this.uuid=t.uuid;for(let n=0,r=t.bones.length;n<r;n++){const r=t.bones[n];let i=e[r];void 0===i&&(console.warn("THREE.Skeleton: No bone found with UUID:",r),i=new r_),this.bones.push(i),this.boneInverses.push((new km).fromArray(t.boneInverses[n]))}return this.init(),this}toJSON(){const t={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};t.uuid=this.uuid;const e=this.bones,n=this.boneInverses;for(let r=0,i=e.length;r<i;r++){const i=e[r];t.bones.push(i.uuid);const o=n[r];t.boneInverses.push(o.toArray())}return t}}class l_ extends Ig{constructor(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(t,e,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}toJSON(){const t=super.toJSON();return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}const c_=new km,u_=new km,h_=[],d_=new nm,p_=new km,f_=new hy,m_=new xm;class g_ extends hy{constructor(t,e,n){super(t,e),this.isInstancedMesh=!0,this.instanceMatrix=new l_(new Float32Array(16*n),16),this.instanceColor=null,this.morphTexture=null,this.count=n,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<n;r++)this.setMatrixAt(r,p_)}computeBoundingBox(){const t=this.geometry,e=this.count;null===this.boundingBox&&(this.boundingBox=new nm),null===t.boundingBox&&t.computeBoundingBox(),this.boundingBox.makeEmpty();for(let n=0;n<e;n++)this.getMatrixAt(n,c_),d_.copy(t.boundingBox).applyMatrix4(c_),this.boundingBox.union(d_)}computeBoundingSphere(){const t=this.geometry,e=this.count;null===this.boundingSphere&&(this.boundingSphere=new xm),null===t.boundingSphere&&t.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let n=0;n<e;n++)this.getMatrixAt(n,c_),m_.copy(t.boundingSphere).applyMatrix4(c_),this.boundingSphere.union(m_)}copy(t,e){return super.copy(t,e),this.instanceMatrix.copy(t.instanceMatrix),null!==t.morphTexture&&(this.morphTexture=t.morphTexture.clone()),null!==t.instanceColor&&(this.instanceColor=t.instanceColor.clone()),this.count=t.count,null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this}getColorAt(t,e){e.fromArray(this.instanceColor.array,3*t)}getMatrixAt(t,e){e.fromArray(this.instanceMatrix.array,16*t)}getMorphAt(t,e){const n=e.morphTargetInfluences,r=this.morphTexture.source.data.data,i=t*(n.length+1)+1;for(let o=0;o<n.length;o++)n[o]=r[i+o]}raycast(t,e){const n=this.matrixWorld,r=this.count;if(f_.geometry=this.geometry,f_.material=this.material,void 0!==f_.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),m_.copy(this.boundingSphere),m_.applyMatrix4(n),!1!==t.ray.intersectsSphere(m_)))for(let i=0;i<r;i++){this.getMatrixAt(i,c_),u_.multiplyMatrices(n,c_),f_.matrixWorld=u_,f_.raycast(t,h_);for(let t=0,n=h_.length;t<n;t++){const n=h_[t];n.instanceId=i,n.object=this,e.push(n)}h_.length=0}}setColorAt(t,e){null===this.instanceColor&&(this.instanceColor=new l_(new Float32Array(3*this.instanceMatrix.count),3)),e.toArray(this.instanceColor.array,3*t)}setMatrixAt(t,e){e.toArray(this.instanceMatrix.array,16*t)}setMorphAt(t,e){const n=e.morphTargetInfluences,r=n.length+1;null===this.morphTexture&&(this.morphTexture=new i_(new Float32Array(r*this.count),r,this.count,md,nd));const i=this.morphTexture.source.data.data;let o=0;for(let l=0;l<n.length;l++)o+=n[l];const a=this.geometry.morphTargetsRelative?1:1-o,s=r*t;i[s]=a,i.set(n,s+1)}updateMorphTargets(){}dispose(){return this.dispatchEvent({type:"dispose"}),null!==this.morphTexture&&(this.morphTexture.dispose(),this.morphTexture=null),this}}function y_(t,e){return t.z-e.z}function v_(t,e){return e.z-t.z}class b_{constructor(){this.index=0,this.pool=[],this.list=[]}push(t,e){const n=this.pool,r=this.list;this.index>=n.length&&n.push({start:-1,count:-1,z:-1});const i=n[this.index];r.push(i),this.index++,i.start=t.start,i.count=t.count,i.z=e}reset(){this.list.length=0,this.index=0}}const x_="batchId",__=new km,w_=new km,S_=new km,T_=new vg(1,1,1),E_=new km,M_=new Oy,C_=new nm,A_=new xm,k_=new $f,I_=new $f,R_=new $f,P_=new b_,N_=new hy,O_=[];function D_(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=e.itemSize;if(t.isInterleavedBufferAttribute||t.array.constructor!==e.array.constructor){const i=t.count;for(let o=0;o<i;o++)for(let i=0;i<r;i++)e.setComponent(o+n,i,t.getComponent(o,i))}else e.array.set(t.array,n*r);e.needsUpdate=!0}class L_ extends hy{get maxGeometryCount(){return this._maxGeometryCount}constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2*e,r=arguments.length>3?arguments[3]:void 0;super(new Xg,r),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._drawRanges=[],this._reservedRanges=[],this._visibility=[],this._active=[],this._bounds=[],this._maxGeometryCount=t,this._maxVertexCount=e,this._maxIndexCount=n,this._geometryInitialized=!1,this._geometryCount=0,this._multiDrawCounts=new Int32Array(t),this._multiDrawStarts=new Int32Array(t),this._multiDrawCount=0,this._multiDrawInstances=null,this._visibilityChanged=!0,this._matricesTexture=null,this._initMatricesTexture(),this._colorsTexture=null}_initMatricesTexture(){let t=Math.sqrt(4*this._maxGeometryCount);t=4*Math.ceil(t/4),t=Math.max(t,4);const e=new Float32Array(t*t*4),n=new i_(e,t,t,ud,nd);this._matricesTexture=n}_initColorsTexture(){let t=Math.sqrt(this._maxGeometryCount);t=Math.ceil(t);const e=new Float32Array(t*t*4).fill(1),n=new i_(e,t,t,ud,nd);n.colorSpace=Df.workingColorSpace,this._colorsTexture=n}_initializeGeometry(t){const e=this.geometry,n=this._maxVertexCount,r=this._maxGeometryCount,i=this._maxIndexCount;if(!1===this._geometryInitialized){for(const r in t.attributes){const i=t.getAttribute(r),{array:o,itemSize:a,normalized:s}=i,l=new o.constructor(n*a),c=new Ig(l,a,s);e.setAttribute(r,c)}if(null!==t.getIndex()){const t=n>65536?new Uint32Array(i):new Uint16Array(i);e.setIndex(new Ig(t,1))}const o=r>65536?new Uint32Array(n):new Uint16Array(n);e.setAttribute(x_,new Ig(o,1)),this._geometryInitialized=!0}}_validateGeometry(t){if(t.getAttribute(x_))throw new Error('BatchedMesh: Geometry cannot use attribute "'.concat(x_,'"'));const e=this.geometry;if(Boolean(t.getIndex())!==Boolean(e.getIndex()))throw new Error('BatchedMesh: All geometries must consistently have "index".');for(const n in e.attributes){if(n===x_)continue;if(!t.hasAttribute(n))throw new Error('BatchedMesh: Added geometry missing "'.concat(n,'". All geometries must have consistent attributes.'));const r=t.getAttribute(n),i=e.getAttribute(n);if(r.itemSize!==i.itemSize||r.normalized!==i.normalized)throw new Error("BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}setCustomSort(t){return this.customSort=t,this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new nm);const t=this._geometryCount,e=this.boundingBox,n=this._active;e.makeEmpty();for(let r=0;r<t;r++)!1!==n[r]&&(this.getMatrixAt(r,__),this.getBoundingBoxAt(r,C_).applyMatrix4(__),e.union(C_))}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new xm);const t=this._geometryCount,e=this.boundingSphere,n=this._active;e.makeEmpty();for(let r=0;r<t;r++)!1!==n[r]&&(this.getMatrixAt(r,__),this.getBoundingSphereAt(r,A_).applyMatrix4(__),e.union(A_))}addGeometry(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(this._initializeGeometry(t),this._validateGeometry(t),this._geometryCount>=this._maxGeometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");const r={vertexStart:-1,vertexCount:-1,indexStart:-1,indexCount:-1};let i=null;const o=this._reservedRanges,a=this._drawRanges,s=this._bounds;0!==this._geometryCount&&(i=o[o.length-1]),r.vertexCount=-1===e?t.getAttribute("position").count:e,r.vertexStart=null===i?0:i.vertexStart+i.vertexCount;const l=t.getIndex(),c=null!==l;if(c&&(r.indexCount=-1===n?l.count:n,r.indexStart=null===i?0:i.indexStart+i.indexCount),-1!==r.indexStart&&r.indexStart+r.indexCount>this._maxIndexCount||r.vertexStart+r.vertexCount>this._maxVertexCount)throw new Error("BatchedMesh: Reserved space request exceeds the maximum buffer size.");const u=this._visibility,h=this._active,d=this._matricesTexture,p=this._matricesTexture.image.data,f=this._colorsTexture;u.push(!0),h.push(!0);const m=this._geometryCount;this._geometryCount++,S_.toArray(p,16*m),d.needsUpdate=!0,null!==f&&(T_.toArray(f.image.data,4*m),f.needsUpdate=!0),o.push(r),a.push({start:c?r.indexStart:r.vertexStart,count:-1}),s.push({boxInitialized:!1,box:new nm,sphereInitialized:!1,sphere:new xm});const g=this.geometry.getAttribute(x_);for(let y=0;y<r.vertexCount;y++)g.setX(r.vertexStart+y,m);return g.needsUpdate=!0,this.setGeometryAt(m,t),m}setGeometryAt(t,e){if(t>=this._geometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");this._validateGeometry(e);const n=this.geometry,r=null!==n.getIndex(),i=n.getIndex(),o=e.getIndex(),a=this._reservedRanges[t];if(r&&o.count>a.indexCount||e.attributes.position.count>a.vertexCount)throw new Error("BatchedMesh: Reserved space not large enough for provided geometry.");const s=a.vertexStart,l=a.vertexCount;for(const d in n.attributes){if(d===x_)continue;const t=e.getAttribute(d),r=n.getAttribute(d);D_(t,r,s);const i=t.itemSize;for(let e=t.count,n=l;e<n;e++){const t=s+e;for(let e=0;e<i;e++)r.setComponent(t,e,0)}r.needsUpdate=!0,r.addUpdateRange(s*i,l*i)}if(r){const t=a.indexStart;for(let e=0;e<o.count;e++)i.setX(t+e,s+o.getX(e));for(let e=o.count,n=a.indexCount;e<n;e++)i.setX(t+e,s);i.needsUpdate=!0,i.addUpdateRange(t,a.indexCount)}const c=this._bounds[t];null!==e.boundingBox?(c.box.copy(e.boundingBox),c.boxInitialized=!0):c.boxInitialized=!1,null!==e.boundingSphere?(c.sphere.copy(e.boundingSphere),c.sphereInitialized=!0):c.sphereInitialized=!1;const u=this._drawRanges[t],h=e.getAttribute("position");return u.count=r?o.count:h.count,this._visibilityChanged=!0,t}deleteGeometry(t){const e=this._active;return t>=e.length||!1===e[t]||(e[t]=!1,this._visibilityChanged=!0),this}getInstanceCountAt(t){return null===this._multiDrawInstances?null:this._multiDrawInstances[t]}setInstanceCountAt(t,e){return null===this._multiDrawInstances&&(this._multiDrawInstances=new Int32Array(this._maxGeometryCount).fill(1)),this._multiDrawInstances[t]=e,t}getBoundingBoxAt(t,e){if(!1===this._active[t])return null;const n=this._bounds[t],r=n.box,i=this.geometry;if(!1===n.boxInitialized){r.makeEmpty();const e=i.index,o=i.attributes.position,a=this._drawRanges[t];for(let t=a.start,n=a.start+a.count;t<n;t++){let n=t;e&&(n=e.getX(n)),r.expandByPoint(k_.fromBufferAttribute(o,n))}n.boxInitialized=!0}return e.copy(r),e}getBoundingSphereAt(t,e){if(!1===this._active[t])return null;const n=this._bounds[t],r=n.sphere,i=this.geometry;if(!1===n.sphereInitialized){r.makeEmpty(),this.getBoundingBoxAt(t,C_),C_.getCenter(r.center);const e=i.index,o=i.attributes.position,a=this._drawRanges[t];let s=0;for(let t=a.start,n=a.start+a.count;t<n;t++){let n=t;e&&(n=e.getX(n)),k_.fromBufferAttribute(o,n),s=Math.max(s,r.center.distanceToSquared(k_))}r.radius=Math.sqrt(s),n.sphereInitialized=!0}return e.copy(r),e}setMatrixAt(t,e){const n=this._active,r=this._matricesTexture,i=this._matricesTexture.image.data;return t>=this._geometryCount||!1===n[t]||(e.toArray(i,16*t),r.needsUpdate=!0),this}getMatrixAt(t,e){const n=this._active,r=this._matricesTexture.image.data;return t>=this._geometryCount||!1===n[t]?null:e.fromArray(r,16*t)}setColorAt(t,e){null===this._colorsTexture&&this._initColorsTexture();const n=this._active,r=this._colorsTexture,i=this._colorsTexture.image.data;return t>=this._geometryCount||!1===n[t]||(e.toArray(i,4*t),r.needsUpdate=!0),this}getColorAt(t,e){const n=this._active,r=this._colorsTexture.image.data;return t>=this._geometryCount||!1===n[t]?null:e.fromArray(r,4*t)}setVisibleAt(t,e){const n=this._visibility,r=this._active;return t>=this._geometryCount||!1===r[t]||n[t]===e||(n[t]=e,this._visibilityChanged=!0),this}getVisibleAt(t){const e=this._visibility,n=this._active;return!(t>=this._geometryCount||!1===n[t])&&e[t]}raycast(t,e){const n=this._visibility,r=this._active,i=this._drawRanges,o=this._geometryCount,a=this.matrixWorld,s=this.geometry;N_.material=this.material,N_.geometry.index=s.index,N_.geometry.attributes=s.attributes,null===N_.geometry.boundingBox&&(N_.geometry.boundingBox=new nm),null===N_.geometry.boundingSphere&&(N_.geometry.boundingSphere=new xm);for(let l=0;l<o;l++){if(!n[l]||!r[l])continue;const o=i[l];N_.geometry.setDrawRange(o.start,o.count),this.getMatrixAt(l,N_.matrixWorld).premultiply(a),this.getBoundingBoxAt(l,N_.geometry.boundingBox),this.getBoundingSphereAt(l,N_.geometry.boundingSphere),N_.raycast(t,O_);for(let t=0,n=O_.length;t<n;t++){const n=O_[t];n.object=this,n.batchId=l,e.push(n)}O_.length=0}N_.material=null,N_.geometry.index=null,N_.geometry.attributes={},N_.geometry.setDrawRange(0,1/0)}copy(t){return super.copy(t),this.geometry=t.geometry.clone(),this.perObjectFrustumCulled=t.perObjectFrustumCulled,this.sortObjects=t.sortObjects,this.boundingBox=null!==t.boundingBox?t.boundingBox.clone():null,this.boundingSphere=null!==t.boundingSphere?t.boundingSphere.clone():null,this._drawRanges=t._drawRanges.map((t=>({...t}))),this._reservedRanges=t._reservedRanges.map((t=>({...t}))),this._visibility=t._visibility.slice(),this._active=t._active.slice(),this._bounds=t._bounds.map((t=>({boxInitialized:t.boxInitialized,box:t.box.clone(),sphereInitialized:t.sphereInitialized,sphere:t.sphere.clone()}))),this._maxGeometryCount=t._maxGeometryCount,this._maxVertexCount=t._maxVertexCount,this._maxIndexCount=t._maxIndexCount,this._geometryInitialized=t._geometryInitialized,this._geometryCount=t._geometryCount,this._multiDrawCounts=t._multiDrawCounts.slice(),this._multiDrawStarts=t._multiDrawStarts.slice(),this._matricesTexture=t._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.slice(),null!==this._colorsTexture&&(this._colorsTexture=t._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.slice()),this}dispose(){return this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,null!==this._colorsTexture&&(this._colorsTexture.dispose(),this._colorsTexture=null),this}onBeforeRender(t,e,n,r,i){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const o=r.getIndex(),a=null===o?1:o.array.BYTES_PER_ELEMENT,s=this._active,l=this._visibility,c=this._multiDrawStarts,u=this._multiDrawCounts,h=this._drawRanges,d=this.perObjectFrustumCulled;d&&(E_.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse).multiply(this.matrixWorld),M_.setFromProjectionMatrix(E_,t.coordinateSystem));let p=0;if(this.sortObjects){w_.copy(this.matrixWorld).invert(),k_.setFromMatrixPosition(n.matrixWorld).applyMatrix4(w_),I_.set(0,0,-1).transformDirection(n.matrixWorld).transformDirection(w_);for(let n=0,r=l.length;n<r;n++)if(l[n]&&s[n]){this.getMatrixAt(n,__),this.getBoundingSphereAt(n,A_).applyMatrix4(__);let t=!1;if(d&&(t=!M_.intersectsSphere(A_)),!t){const t=R_.subVectors(A_.center,k_).dot(I_);P_.push(h[n],t)}}const t=P_.list,e=this.customSort;null===e?t.sort(i.transparent?v_:y_):e.call(this,t,n);for(let n=0,r=t.length;n<r;n++){const e=t[n];c[p]=e.start*a,u[p]=e.count,p++}P_.reset()}else for(let f=0,m=l.length;f<m;f++)if(l[f]&&s[f]){let t=!1;if(d&&(this.getMatrixAt(f,__),this.getBoundingSphereAt(f,A_).applyMatrix4(__),t=!M_.intersectsSphere(A_)),!t){const t=h[f];c[p]=t.start*a,u[p]=t.count,p++}}this._multiDrawCount=p,this._visibilityChanged=!1}onBeforeShadow(t,e,n,r,i,o){this.onBeforeRender(t,null,r,i,o)}}class F_ extends _g{constructor(t){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new vg(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.fog=t.fog,this}}const U_=new $f,B_=new $f,z_=new km,j_=new Am,V_=new xm,W_=new $f,G_=new $f;class H_ extends ng{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Xg,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new F_;super(),this.isLine=!0,this.type="Line",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),this.material=Array.isArray(t.material)?t.material.slice():t.material,this.geometry=t.geometry,this}computeLineDistances(){const t=this.geometry;if(null===t.index){const e=t.attributes.position,n=[0];for(let t=1,r=e.count;t<r;t++)U_.fromBufferAttribute(e,t-1),B_.fromBufferAttribute(e,t),n[t]=n[t-1],n[t]+=U_.distanceTo(B_);t.setAttribute("lineDistance",new Bg(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(t,e){const n=this.geometry,r=this.matrixWorld,i=t.params.Line.threshold,o=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),V_.copy(n.boundingSphere),V_.applyMatrix4(r),V_.radius+=i,!1===t.ray.intersectsSphere(V_))return;z_.copy(r).invert(),j_.copy(t.ray).applyMatrix4(z_);const a=i/((this.scale.x+this.scale.y+this.scale.z)/3),s=a*a,l=this.isLineSegments?2:1,c=n.index,u=n.attributes.position;if(null!==c){const n=Math.max(0,o.start),r=Math.min(c.count,o.start+o.count);for(let i=n,o=r-1;i<o;i+=l){const n=c.getX(i),r=c.getX(i+1),o=q_(this,t,j_,s,n,r);o&&e.push(o)}if(this.isLineLoop){const i=c.getX(r-1),o=c.getX(n),a=q_(this,t,j_,s,i,o);a&&e.push(a)}}else{const n=Math.max(0,o.start),r=Math.min(u.count,o.start+o.count);for(let i=n,o=r-1;i<o;i+=l){const n=q_(this,t,j_,s,i,i+1);n&&e.push(n)}if(this.isLineLoop){const i=q_(this,t,j_,s,r-1,n);i&&e.push(i)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,e=Object.keys(t);if(e.length>0){const n=t[e[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,e=n.length;t<e;t++){const e=n[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[e]=t}}}}}function q_(t,e,n,r,i,o){const a=t.geometry.attributes.position;U_.fromBufferAttribute(a,i),B_.fromBufferAttribute(a,o);if(n.distanceSqToSegment(U_,B_,W_,G_)>r)return;W_.applyMatrix4(t.matrixWorld);const s=e.ray.origin.distanceTo(W_);return s<e.near||s>e.far?void 0:{distance:s,point:G_.clone().applyMatrix4(t.matrixWorld),index:i,face:null,faceIndex:null,object:t}}const X_=new $f,Y_=new $f;class K_ extends H_{constructor(t,e){super(t,e),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const t=this.geometry;if(null===t.index){const e=t.attributes.position,n=[];for(let t=0,r=e.count;t<r;t+=2)X_.fromBufferAttribute(e,t),Y_.fromBufferAttribute(e,t+1),n[t]=0===t?0:n[t-1],n[t+1]=n[t]+X_.distanceTo(Y_);t.setAttribute("lineDistance",new Bg(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class Z_ extends H_{constructor(t,e){super(t,e),this.isLineLoop=!0,this.type="LineLoop"}}class J_ extends _g{constructor(t){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new vg(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.fog=t.fog,this}}const Q_=new km,$_=new Am,tw=new xm,ew=new $f;class nw extends ng{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Xg,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new J_;super(),this.isPoints=!0,this.type="Points",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),this.material=Array.isArray(t.material)?t.material.slice():t.material,this.geometry=t.geometry,this}raycast(t,e){const n=this.geometry,r=this.matrixWorld,i=t.params.Points.threshold,o=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),tw.copy(n.boundingSphere),tw.applyMatrix4(r),tw.radius+=i,!1===t.ray.intersectsSphere(tw))return;Q_.copy(r).invert(),$_.copy(t.ray).applyMatrix4(Q_);const a=i/((this.scale.x+this.scale.y+this.scale.z)/3),s=a*a,l=n.index,c=n.attributes.position;if(null!==l){for(let n=Math.max(0,o.start),i=Math.min(l.count,o.start+o.count);n<i;n++){const i=l.getX(n);ew.fromBufferAttribute(c,i),rw(ew,i,s,r,t,e,this)}}else{for(let n=Math.max(0,o.start),i=Math.min(c.count,o.start+o.count);n<i;n++)ew.fromBufferAttribute(c,n),rw(ew,n,s,r,t,e,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,e=Object.keys(t);if(e.length>0){const n=t[e[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,e=n.length;t<e;t++){const e=n[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[e]=t}}}}}function rw(t,e,n,r,i,o,a){const s=$_.distanceSqToPoint(t);if(s<n){const n=new $f;$_.closestPointToPoint(t,n),n.applyMatrix4(r);const l=i.ray.origin.distanceTo(n);if(l<i.near||l>i.far)return;o.push({distance:l,distanceToRay:Math.sqrt(s),point:n,index:e,face:null,object:a})}}class iw extends Gf{constructor(t,e,n,r,i,o,a,s,l){super(t,e,n,r,i,o,a,s,l),this.isVideoTexture=!0,this.minFilter=void 0!==o?o:Hh,this.magFilter=void 0!==i?i:Hh,this.generateMipmaps=!1;const c=this;"requestVideoFrameCallback"in t&&t.requestVideoFrameCallback((function e(){c.needsUpdate=!0,t.requestVideoFrameCallback(e)}))}clone(){return new this.constructor(this.image).copy(this)}update(){const t=this.image;!1==="requestVideoFrameCallback"in t&&t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class ow extends Gf{constructor(t,e){super({width:t,height:e}),this.isFramebufferTexture=!0,this.magFilter=zh,this.minFilter=zh,this.generateMipmaps=!1,this.needsUpdate=!0}}class aw extends Gf{constructor(t,e,n,r,i,o,a,s,l,c,u,h){super(null,o,a,s,l,c,r,i,u,h),this.isCompressedTexture=!0,this.image={width:e,height:n},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}}class sw extends aw{constructor(t,e,n,r,i,o){super(t,e,n,i,o),this.isCompressedArrayTexture=!0,this.image.depth=r,this.wrapR=Uh,this.layerUpdates=new Set}addLayerUpdates(t){this.layerUpdates.add(t)}clearLayerUpdates(){this.layerUpdates.clear()}}class lw extends aw{constructor(t,e,n){super(void 0,t[0].width,t[0].height,e,n,Ph),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=t}}class cw extends Gf{constructor(t,e,n,r,i,o,a,s,l){super(t,e,n,r,i,o,a,s,l),this.isCanvasTexture=!0,this.needsUpdate=!0}}class uw{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(t,e){const n=this.getUtoTmapping(t);return this.getPoint(n,e)}getPoints(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;const e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return e}getSpacedPoints(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;const e=[];for(let n=0;n<=t;n++)e.push(this.getPointAt(n/t));return e}getLength(){const t=this.getLengths();return t[t.length-1]}getLengths(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.arcLengthDivisions;if(this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const e=[];let n,r=this.getPoint(0),i=0;e.push(0);for(let o=1;o<=t;o++)n=this.getPoint(o/t),i+=n.distanceTo(r),e.push(i),r=n;return this.cacheArcLengths=e,e}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(t,e){const n=this.getLengths();let r=0;const i=n.length;let o;o=e||t*n[i-1];let a,s=0,l=i-1;for(;s<=l;)if(r=Math.floor(s+(l-s)/2),a=n[r]-o,a<0)s=r+1;else{if(!(a>0)){l=r;break}l=r-1}if(r=l,n[r]===o)return r/(i-1);const c=n[r];return(r+(o-c)/(n[r+1]-c))/(i-1)}getTangent(t,e){const n=1e-4;let r=t-n,i=t+n;r<0&&(r=0),i>1&&(i=1);const o=this.getPoint(r),a=this.getPoint(i),s=e||(o.isVector2?new _f:new $f);return s.copy(a).sub(o).normalize(),s}getTangentAt(t,e){const n=this.getUtoTmapping(t);return this.getTangent(n,e)}computeFrenetFrames(t,e){const n=new $f,r=[],i=[],o=[],a=new $f,s=new km;for(let d=0;d<=t;d++){const e=d/t;r[d]=this.getTangentAt(e,new $f)}i[0]=new $f,o[0]=new $f;let l=Number.MAX_VALUE;const c=Math.abs(r[0].x),u=Math.abs(r[0].y),h=Math.abs(r[0].z);c<=l&&(l=c,n.set(1,0,0)),u<=l&&(l=u,n.set(0,1,0)),h<=l&&n.set(0,0,1),a.crossVectors(r[0],n).normalize(),i[0].crossVectors(r[0],a),o[0].crossVectors(r[0],i[0]);for(let d=1;d<=t;d++){if(i[d]=i[d-1].clone(),o[d]=o[d-1].clone(),a.crossVectors(r[d-1],r[d]),a.length()>Number.EPSILON){a.normalize();const t=Math.acos(mf(r[d-1].dot(r[d]),-1,1));i[d].applyMatrix4(s.makeRotationAxis(a,t))}o[d].crossVectors(r[d],i[d])}if(!0===e){let e=Math.acos(mf(i[0].dot(i[t]),-1,1));e/=t,r[0].dot(a.crossVectors(i[0],i[t]))>0&&(e=-e);for(let n=1;n<=t;n++)i[n].applyMatrix4(s.makeRotationAxis(r[n],e*n)),o[n].crossVectors(r[n],i[n])}return{tangents:r,normals:i,binormals:o}}clone(){return(new this.constructor).copy(this)}copy(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}toJSON(){const t={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t}fromJSON(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}class hw extends uw{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2*Math.PI,a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=t,this.aY=e,this.xRadius=n,this.yRadius=r,this.aStartAngle=i,this.aEndAngle=o,this.aClockwise=a,this.aRotation=s}getPoint(t){const e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new _f,n=2*Math.PI;let r=this.aEndAngle-this.aStartAngle;const i=Math.abs(r)<Number.EPSILON;for(;r<0;)r+=n;for(;r>n;)r-=n;r<Number.EPSILON&&(r=i?0:n),!0!==this.aClockwise||i||(r===n?r=-n:r-=n);const o=this.aStartAngle+t*r;let a=this.aX+this.xRadius*Math.cos(o),s=this.aY+this.yRadius*Math.sin(o);if(0!==this.aRotation){const t=Math.cos(this.aRotation),e=Math.sin(this.aRotation),n=a-this.aX,r=s-this.aY;a=n*t-r*e+this.aX,s=n*e+r*t+this.aY}return e.set(a,s)}copy(t){return super.copy(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}toJSON(){const t=super.toJSON();return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t}fromJSON(t){return super.fromJSON(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}}class dw extends hw{constructor(t,e,n,r,i,o){super(t,e,n,n,r,i,o),this.isArcCurve=!0,this.type="ArcCurve"}}function pw(){let t=0,e=0,n=0,r=0;function i(i,o,a,s){t=i,e=a,n=-3*i+3*o-2*a-s,r=2*i-2*o+a+s}return{initCatmullRom:function(t,e,n,r,o){i(e,n,o*(n-t),o*(r-e))},initNonuniformCatmullRom:function(t,e,n,r,o,a,s){let l=(e-t)/o-(n-t)/(o+a)+(n-e)/a,c=(n-e)/a-(r-e)/(a+s)+(r-n)/s;l*=a,c*=a,i(e,n,l,c)},calc:function(i){const o=i*i;return t+e*i+n*o+r*(o*i)}}}const fw=new $f,mw=new pw,gw=new pw,yw=new pw;class vw extends uw{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"centripetal",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=t,this.closed=e,this.curveType=n,this.tension=r}getPoint(t){const e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new $f,n=this.points,r=n.length,i=(r-(this.closed?0:1))*t;let o,a,s=Math.floor(i),l=i-s;this.closed?s+=s>0?0:(Math.floor(Math.abs(s)/r)+1)*r:0===l&&s===r-1&&(s=r-2,l=1),this.closed||s>0?o=n[(s-1)%r]:(fw.subVectors(n[0],n[1]).add(n[0]),o=fw);const c=n[s%r],u=n[(s+1)%r];if(this.closed||s+2<r?a=n[(s+2)%r]:(fw.subVectors(n[r-1],n[r-2]).add(n[r-1]),a=fw),"centripetal"===this.curveType||"chordal"===this.curveType){const t="chordal"===this.curveType?.5:.25;let e=Math.pow(o.distanceToSquared(c),t),n=Math.pow(c.distanceToSquared(u),t),r=Math.pow(u.distanceToSquared(a),t);n<1e-4&&(n=1),e<1e-4&&(e=n),r<1e-4&&(r=n),mw.initNonuniformCatmullRom(o.x,c.x,u.x,a.x,e,n,r),gw.initNonuniformCatmullRom(o.y,c.y,u.y,a.y,e,n,r),yw.initNonuniformCatmullRom(o.z,c.z,u.z,a.z,e,n,r)}else"catmullrom"===this.curveType&&(mw.initCatmullRom(o.x,c.x,u.x,a.x,this.tension),gw.initCatmullRom(o.y,c.y,u.y,a.y,this.tension),yw.initCatmullRom(o.z,c.z,u.z,a.z,this.tension));return e.set(mw.calc(l),gw.calc(l),yw.calc(l)),e}copy(t){super.copy(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push(n.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,n=this.points.length;e<n;e++){const n=this.points[e];t.points.push(n.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push((new $f).fromArray(n))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}}function bw(t,e,n,r,i){const o=.5*(r-e),a=.5*(i-n),s=t*t;return(2*n-2*r+o+a)*(t*s)+(-3*n+3*r-2*o-a)*s+o*t+n}function xw(t,e,n,r){return function(t,e){const n=1-t;return n*n*e}(t,e)+function(t,e){return 2*(1-t)*t*e}(t,n)+function(t,e){return t*t*e}(t,r)}function _w(t,e,n,r,i){return function(t,e){const n=1-t;return n*n*n*e}(t,e)+function(t,e){const n=1-t;return 3*n*n*t*e}(t,n)+function(t,e){return 3*(1-t)*t*t*e}(t,r)+function(t,e){return t*t*t*e}(t,i)}class ww extends uw{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new _f,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new _f,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new _f,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new _f;super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=t,this.v1=e,this.v2=n,this.v3=r}getPoint(t){const e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new _f,n=this.v0,r=this.v1,i=this.v2,o=this.v3;return e.set(_w(t,n.x,r.x,i.x,o.x),_w(t,n.y,r.y,i.y,o.y)),e}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}class Sw extends uw{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new $f,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new $f,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new $f,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new $f;super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=t,this.v1=e,this.v2=n,this.v3=r}getPoint(t){const e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new $f,n=this.v0,r=this.v1,i=this.v2,o=this.v3;return e.set(_w(t,n.x,r.x,i.x,o.x),_w(t,n.y,r.y,i.y,o.y),_w(t,n.z,r.z,i.z,o.z)),e}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}class Tw extends uw{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new _f,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new _f;super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=t,this.v2=e}getPoint(t){const e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new _f;return 1===t?e.copy(this.v2):(e.copy(this.v2).sub(this.v1),e.multiplyScalar(t).add(this.v1)),e}getPointAt(t,e){return this.getPoint(t,e)}getTangent(t){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:new _f).subVectors(this.v2,this.v1).normalize()}getTangentAt(t,e){return this.getTangent(t,e)}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class Ew extends uw{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new $f,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new $f;super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=t,this.v2=e}getPoint(t){const e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new $f;return 1===t?e.copy(this.v2):(e.copy(this.v2).sub(this.v1),e.multiplyScalar(t).add(this.v1)),e}getPointAt(t,e){return this.getPoint(t,e)}getTangent(t){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:new $f).subVectors(this.v2,this.v1).normalize()}getTangentAt(t,e){return this.getTangent(t,e)}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class Mw extends uw{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new _f,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new _f,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new _f;super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=t,this.v1=e,this.v2=n}getPoint(t){const e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new _f,n=this.v0,r=this.v1,i=this.v2;return e.set(xw(t,n.x,r.x,i.x),xw(t,n.y,r.y,i.y)),e}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class Cw extends uw{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new $f,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new $f,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new $f;super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=t,this.v1=e,this.v2=n}getPoint(t){const e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new $f,n=this.v0,r=this.v1,i=this.v2;return e.set(xw(t,n.x,r.x,i.x),xw(t,n.y,r.y,i.y),xw(t,n.z,r.z,i.z)),e}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class Aw extends uw{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=t}getPoint(t){const e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new _f,n=this.points,r=(n.length-1)*t,i=Math.floor(r),o=r-i,a=n[0===i?i:i-1],s=n[i],l=n[i>n.length-2?n.length-1:i+1],c=n[i>n.length-3?n.length-1:i+2];return e.set(bw(o,a.x,s.x,l.x,c.x),bw(o,a.y,s.y,l.y,c.y)),e}copy(t){super.copy(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push(n.clone())}return this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,n=this.points.length;e<n;e++){const n=this.points[e];t.points.push(n.toArray())}return t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push((new _f).fromArray(n))}return this}}var kw=Object.freeze({__proto__:null,ArcCurve:dw,CatmullRomCurve3:vw,CubicBezierCurve:ww,CubicBezierCurve3:Sw,EllipseCurve:hw,LineCurve:Tw,LineCurve3:Ew,QuadraticBezierCurve:Mw,QuadraticBezierCurve3:Cw,SplineCurve:Aw});class Iw extends uw{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(t){this.curves.push(t)}closePath(){const t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);if(!t.equals(e)){const n=!0===t.isVector2?"LineCurve":"LineCurve3";this.curves.push(new kw[n](e,t))}return this}getPoint(t,e){const n=t*this.getLength(),r=this.getCurveLengths();let i=0;for(;i<r.length;){if(r[i]>=n){const t=r[i]-n,o=this.curves[i],a=o.getLength(),s=0===a?0:1-t/a;return o.getPointAt(s,e)}i++}return null}getLength(){const t=this.getCurveLengths();return t[t.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const t=[];let e=0;for(let n=0,r=this.curves.length;n<r;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t,t}getSpacedPoints(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:40;const e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e}getPoints(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12;const e=[];let n;for(let r=0,i=this.curves;r<i.length;r++){const o=i[r],a=o.isEllipseCurve?2*t:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?t*o.points.length:t,s=o.getPoints(a);for(let t=0;t<s.length;t++){const r=s[t];n&&n.equals(r)||(e.push(r),n=r)}}return this.autoClose&&e.length>1&&!e[e.length-1].equals(e[0])&&e.push(e[0]),e}copy(t){super.copy(t),this.curves=[];for(let e=0,n=t.curves.length;e<n;e++){const n=t.curves[e];this.curves.push(n.clone())}return this.autoClose=t.autoClose,this}toJSON(){const t=super.toJSON();t.autoClose=this.autoClose,t.curves=[];for(let e=0,n=this.curves.length;e<n;e++){const n=this.curves[e];t.curves.push(n.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.autoClose=t.autoClose,this.curves=[];for(let e=0,n=t.curves.length;e<n;e++){const n=t.curves[e];this.curves.push((new kw[n.type]).fromJSON(n))}return this}}class Rw extends Iw{constructor(t){super(),this.type="Path",this.currentPoint=new _f,t&&this.setFromPoints(t)}setFromPoints(t){this.moveTo(t[0].x,t[0].y);for(let e=1,n=t.length;e<n;e++)this.lineTo(t[e].x,t[e].y);return this}moveTo(t,e){return this.currentPoint.set(t,e),this}lineTo(t,e){const n=new Tw(this.currentPoint.clone(),new _f(t,e));return this.curves.push(n),this.currentPoint.set(t,e),this}quadraticCurveTo(t,e,n,r){const i=new Mw(this.currentPoint.clone(),new _f(t,e),new _f(n,r));return this.curves.push(i),this.currentPoint.set(n,r),this}bezierCurveTo(t,e,n,r,i,o){const a=new ww(this.currentPoint.clone(),new _f(t,e),new _f(n,r),new _f(i,o));return this.curves.push(a),this.currentPoint.set(i,o),this}splineThru(t){const e=[this.currentPoint.clone()].concat(t),n=new Aw(e);return this.curves.push(n),this.currentPoint.copy(t[t.length-1]),this}arc(t,e,n,r,i,o){const a=this.currentPoint.x,s=this.currentPoint.y;return this.absarc(t+a,e+s,n,r,i,o),this}absarc(t,e,n,r,i,o){return this.absellipse(t,e,n,n,r,i,o),this}ellipse(t,e,n,r,i,o,a,s){const l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(t+l,e+c,n,r,i,o,a,s),this}absellipse(t,e,n,r,i,o,a,s){const l=new hw(t,e,n,r,i,o,a,s);if(this.curves.length>0){const t=l.getPoint(0);t.equals(this.currentPoint)||this.lineTo(t.x,t.y)}this.curves.push(l);const c=l.getPoint(1);return this.currentPoint.copy(c),this}copy(t){return super.copy(t),this.currentPoint.copy(t.currentPoint),this}toJSON(){const t=super.toJSON();return t.currentPoint=this.currentPoint.toArray(),t}fromJSON(t){return super.fromJSON(t),this.currentPoint.fromArray(t.currentPoint),this}}class Pw extends Xg{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[new _f(0,-.5),new _f(.5,0),new _f(0,.5)],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2*Math.PI;super(),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:r},e=Math.floor(e),r=mf(r,0,2*Math.PI);const i=[],o=[],a=[],s=[],l=[],c=1/e,u=new $f,h=new _f,d=new $f,p=new $f,f=new $f;let m=0,g=0;for(let y=0;y<=t.length-1;y++)switch(y){case 0:m=t[y+1].x-t[y].x,g=t[y+1].y-t[y].y,d.x=1*g,d.y=-m,d.z=0*g,f.copy(d),d.normalize(),s.push(d.x,d.y,d.z);break;case t.length-1:s.push(f.x,f.y,f.z);break;default:m=t[y+1].x-t[y].x,g=t[y+1].y-t[y].y,d.x=1*g,d.y=-m,d.z=0*g,p.copy(d),d.x+=f.x,d.y+=f.y,d.z+=f.z,d.normalize(),s.push(d.x,d.y,d.z),f.copy(p)}for(let y=0;y<=e;y++){const i=n+y*c*r,d=Math.sin(i),p=Math.cos(i);for(let n=0;n<=t.length-1;n++){u.x=t[n].x*d,u.y=t[n].y,u.z=t[n].x*p,o.push(u.x,u.y,u.z),h.x=y/e,h.y=n/(t.length-1),a.push(h.x,h.y);const r=s[3*n+0]*d,i=s[3*n+1],c=s[3*n+0]*p;l.push(r,i,c)}}for(let y=0;y<e;y++)for(let e=0;e<t.length-1;e++){const n=e+y*t.length,r=n,o=n+t.length,a=n+t.length+1,s=n+1;i.push(r,o,s),i.push(a,s,o)}this.setIndex(i),this.setAttribute("position",new Bg(o,3)),this.setAttribute("uv",new Bg(a,2)),this.setAttribute("normal",new Bg(l,3))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new Pw(t.points,t.segments,t.phiStart,t.phiLength)}}class Nw extends Pw{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8;const i=new Rw;i.absarc(0,-e/2,t,1.5*Math.PI,0),i.absarc(0,e/2,t,0,.5*Math.PI),super(i.getPoints(n),r),this.type="CapsuleGeometry",this.parameters={radius:t,length:e,capSegments:n,radialSegments:r}}static fromJSON(t){return new Nw(t.radius,t.length,t.capSegments,t.radialSegments)}}class Ow extends Xg{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2*Math.PI;super(),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:r},e=Math.max(3,e);const i=[],o=[],a=[],s=[],l=new $f,c=new _f;o.push(0,0,0),a.push(0,0,1),s.push(.5,.5);for(let u=0,h=3;u<=e;u++,h+=3){const i=n+u/e*r;l.x=t*Math.cos(i),l.y=t*Math.sin(i),o.push(l.x,l.y,l.z),a.push(0,0,1),c.x=(o[h]/t+1)/2,c.y=(o[h+1]/t+1)/2,s.push(c.x,c.y)}for(let u=1;u<=e;u++)i.push(u,u+1,0);this.setIndex(i),this.setAttribute("position",new Bg(o,3)),this.setAttribute("normal",new Bg(a,3)),this.setAttribute("uv",new Bg(s,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new Ow(t.radius,t.segments,t.thetaStart,t.thetaLength)}}class Dw extends Xg{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:32,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:2*Math.PI;super(),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:r,heightSegments:i,openEnded:o,thetaStart:a,thetaLength:s};const l=this;r=Math.floor(r),i=Math.floor(i);const c=[],u=[],h=[],d=[];let p=0;const f=[],m=n/2;let g=0;function y(n){const i=p,o=new _f,f=new $f;let y=0;const v=!0===n?t:e,b=!0===n?1:-1;for(let t=1;t<=r;t++)u.push(0,m*b,0),h.push(0,b,0),d.push(.5,.5),p++;const x=p;for(let t=0;t<=r;t++){const e=t/r*s+a,n=Math.cos(e),i=Math.sin(e);f.x=v*i,f.y=m*b,f.z=v*n,u.push(f.x,f.y,f.z),h.push(0,b,0),o.x=.5*n+.5,o.y=.5*i*b+.5,d.push(o.x,o.y),p++}for(let t=0;t<r;t++){const e=i+t,r=x+t;!0===n?c.push(r,r+1,e):c.push(r+1,r,e),y+=3}l.addGroup(g,y,!0===n?1:2),g+=y}!function(){const o=new $f,y=new $f;let v=0;const b=(e-t)/n;for(let l=0;l<=i;l++){const c=[],g=l/i,v=g*(e-t)+t;for(let t=0;t<=r;t++){const e=t/r,i=e*s+a,l=Math.sin(i),f=Math.cos(i);y.x=v*l,y.y=-g*n+m,y.z=v*f,u.push(y.x,y.y,y.z),o.set(l,b,f).normalize(),h.push(o.x,o.y,o.z),d.push(e,1-g),c.push(p++)}f.push(c)}for(let t=0;t<r;t++)for(let e=0;e<i;e++){const n=f[e][t],r=f[e+1][t],i=f[e+1][t+1],o=f[e][t+1];c.push(n,r,o),c.push(r,i,o),v+=6}l.addGroup(g,v,0),g+=v}(),!1===o&&(t>0&&y(!0),e>0&&y(!1)),this.setIndex(c),this.setAttribute("position",new Bg(u,3)),this.setAttribute("normal",new Bg(h,3)),this.setAttribute("uv",new Bg(d,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new Dw(t.radiusTop,t.radiusBottom,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength)}}class Lw extends Dw{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:32,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:2*Math.PI;super(0,t,e,n,r,i,o,a),this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:o,thetaLength:a}}static fromJSON(t){return new Lw(t.radius,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength)}}class Fw extends Xg{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;super(),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:r};const i=[],o=[];function a(t,e,n,r){const i=r+1,o=[];for(let a=0;a<=i;a++){o[a]=[];const r=t.clone().lerp(n,a/i),s=e.clone().lerp(n,a/i),l=i-a;for(let t=0;t<=l;t++)o[a][t]=0===t&&a===i?r:r.clone().lerp(s,t/l)}for(let a=0;a<i;a++)for(let t=0;t<2*(i-a)-1;t++){const e=Math.floor(t/2);t%2===0?(s(o[a][e+1]),s(o[a+1][e]),s(o[a][e])):(s(o[a][e+1]),s(o[a+1][e+1]),s(o[a+1][e]))}}function s(t){i.push(t.x,t.y,t.z)}function l(e,n){const r=3*e;n.x=t[r+0],n.y=t[r+1],n.z=t[r+2]}function c(t,e,n,r){r<0&&1===t.x&&(o[e]=t.x-1),0===n.x&&0===n.z&&(o[e]=r/2/Math.PI+.5)}function u(t){return Math.atan2(t.z,-t.x)}!function(t){const n=new $f,r=new $f,i=new $f;for(let o=0;o<e.length;o+=3)l(e[o+0],n),l(e[o+1],r),l(e[o+2],i),a(n,r,i,t)}(r),function(t){const e=new $f;for(let n=0;n<i.length;n+=3)e.x=i[n+0],e.y=i[n+1],e.z=i[n+2],e.normalize().multiplyScalar(t),i[n+0]=e.x,i[n+1]=e.y,i[n+2]=e.z}(n),function(){const t=new $f;for(let n=0;n<i.length;n+=3){t.x=i[n+0],t.y=i[n+1],t.z=i[n+2];const r=u(t)/2/Math.PI+.5,a=(e=t,Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))/Math.PI+.5);o.push(r,1-a)}var e;(function(){const t=new $f,e=new $f,n=new $f,r=new $f,a=new _f,s=new _f,l=new _f;for(let h=0,d=0;h<i.length;h+=9,d+=6){t.set(i[h+0],i[h+1],i[h+2]),e.set(i[h+3],i[h+4],i[h+5]),n.set(i[h+6],i[h+7],i[h+8]),a.set(o[d+0],o[d+1]),s.set(o[d+2],o[d+3]),l.set(o[d+4],o[d+5]),r.copy(t).add(e).add(n).divideScalar(3);const p=u(r);c(a,d+0,t,p),c(s,d+2,e,p),c(l,d+4,n,p)}})(),function(){for(let t=0;t<o.length;t+=6){const e=o[t+0],n=o[t+2],r=o[t+4],i=Math.max(e,n,r),a=Math.min(e,n,r);i>.9&&a<.1&&(e<.2&&(o[t+0]+=1),n<.2&&(o[t+2]+=1),r<.2&&(o[t+4]+=1))}}()}(),this.setAttribute("position",new Bg(i,3)),this.setAttribute("normal",new Bg(i.slice(),3)),this.setAttribute("uv",new Bg(o,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new Fw(t.vertices,t.indices,t.radius,t.details)}}class Uw extends Fw{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=(1+Math.sqrt(5))/2,r=1/n;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,e),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e}}static fromJSON(t){return new Uw(t.radius,t.detail)}}const Bw=new $f,zw=new $f,jw=new $f,Vw=new pg;class Ww extends Xg{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(super(),this.type="EdgesGeometry",this.parameters={geometry:t,thresholdAngle:e},null!==t){const n=4,r=Math.pow(10,n),i=Math.cos(df*e),o=t.getIndex(),a=t.getAttribute("position"),s=o?o.count:a.count,l=[0,0,0],c=["a","b","c"],u=new Array(3),h={},d=[];for(let t=0;t<s;t+=3){o?(l[0]=o.getX(t),l[1]=o.getX(t+1),l[2]=o.getX(t+2)):(l[0]=t,l[1]=t+1,l[2]=t+2);const{a:e,b:n,c:s}=Vw;if(e.fromBufferAttribute(a,l[0]),n.fromBufferAttribute(a,l[1]),s.fromBufferAttribute(a,l[2]),Vw.getNormal(jw),u[0]="".concat(Math.round(e.x*r),",").concat(Math.round(e.y*r),",").concat(Math.round(e.z*r)),u[1]="".concat(Math.round(n.x*r),",").concat(Math.round(n.y*r),",").concat(Math.round(n.z*r)),u[2]="".concat(Math.round(s.x*r),",").concat(Math.round(s.y*r),",").concat(Math.round(s.z*r)),u[0]!==u[1]&&u[1]!==u[2]&&u[2]!==u[0])for(let t=0;t<3;t++){const e=(t+1)%3,n=u[t],r=u[e],o=Vw[c[t]],a=Vw[c[e]],s="".concat(n,"_").concat(r),p="".concat(r,"_").concat(n);p in h&&h[p]?(jw.dot(h[p].normal)<=i&&(d.push(o.x,o.y,o.z),d.push(a.x,a.y,a.z)),h[p]=null):s in h||(h[s]={index0:l[t],index1:l[e],normal:jw.clone()})}}for(const t in h)if(h[t]){const{index0:e,index1:n}=h[t];Bw.fromBufferAttribute(a,e),zw.fromBufferAttribute(a,n),d.push(Bw.x,Bw.y,Bw.z),d.push(zw.x,zw.y,zw.z)}this.setAttribute("position",new Bg(d,3))}}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}}class Gw extends Rw{constructor(t){super(t),this.uuid=ff(),this.type="Shape",this.holes=[]}getPointsHoles(t){const e=[];for(let n=0,r=this.holes.length;n<r;n++)e[n]=this.holes[n].getPoints(t);return e}extractPoints(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}}copy(t){super.copy(t),this.holes=[];for(let e=0,n=t.holes.length;e<n;e++){const n=t.holes[e];this.holes.push(n.clone())}return this}toJSON(){const t=super.toJSON();t.uuid=this.uuid,t.holes=[];for(let e=0,n=this.holes.length;e<n;e++){const n=this.holes[e];t.holes.push(n.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.uuid=t.uuid,this.holes=[];for(let e=0,n=t.holes.length;e<n;e++){const n=t.holes[e];this.holes.push((new Rw).fromJSON(n))}return this}}const Hw=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;const r=e&&e.length,i=r?e[0]*n:t.length;let o=qw(t,0,i,n,!0);const a=[];if(!o||o.next===o.prev)return a;let s,l,c,u,h,d,p;if(r&&(o=function(t,e,n,r){const i=[];let o,a,s,l,c;for(o=0,a=e.length;o<a;o++)s=e[o]*r,l=o<a-1?e[o+1]*r:t.length,c=qw(t,s,l,r,!1),c===c.next&&(c.steiner=!0),i.push(rS(c));for(i.sort($w),o=0;o<i.length;o++)n=tS(i[o],n);return n}(t,e,o,n)),t.length>80*n){s=c=t[0],l=u=t[1];for(let e=n;e<i;e+=n)h=t[e],d=t[e+1],h<s&&(s=h),d<l&&(l=d),h>c&&(c=h),d>u&&(u=d);p=Math.max(c-s,u-l),p=0!==p?32767/p:0}return Yw(o,a,n,s,l,p,0),a};function qw(t,e,n,r,i){let o,a;if(i===function(t,e,n,r){let i=0;for(let o=e,a=n-r;o<n;o+=r)i+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return i}(t,e,n,r)>0)for(o=e;o<n;o+=r)a=pS(o,t[o],t[o+1],a);else for(o=n-r;o>=e;o-=r)a=pS(o,t[o],t[o+1],a);return a&&sS(a,a.next)&&(fS(a),a=a.next),a}function Xw(t,e){if(!t)return t;e||(e=t);let n,r=t;do{if(n=!1,r.steiner||!sS(r,r.next)&&0!==aS(r.prev,r,r.next))r=r.next;else{if(fS(r),r=e=r.prev,r===r.next)break;n=!0}}while(n||r!==e);return e}function Yw(t,e,n,r,i,o,a){if(!t)return;!a&&o&&function(t,e,n,r){let i=t;do{0===i.z&&(i.z=nS(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){let e,n,r,i,o,a,s,l,c=1;do{for(n=t,t=null,o=null,a=0;n;){for(a++,r=n,s=0,e=0;e<c&&(s++,r=r.nextZ,r);e++);for(l=c;s>0||l>0&&r;)0!==s&&(0===l||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,l--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,c*=2}while(a>1)}(i)}(t,r,i,o);let s,l,c=t;for(;t.prev!==t.next;)if(s=t.prev,l=t.next,o?Zw(t,r,i,o):Kw(t))e.push(s.i/n|0),e.push(t.i/n|0),e.push(l.i/n|0),fS(t),t=l.next,c=l.next;else if((t=l)===c){a?1===a?Yw(t=Jw(Xw(t),e,n),e,n,r,i,o,2):2===a&&Qw(t,e,n,r,i,o):Yw(Xw(t),e,n,r,i,o,1);break}}function Kw(t){const e=t.prev,n=t,r=t.next;if(aS(e,n,r)>=0)return!1;const i=e.x,o=n.x,a=r.x,s=e.y,l=n.y,c=r.y,u=i<o?i<a?i:a:o<a?o:a,h=s<l?s<c?s:c:l<c?l:c,d=i>o?i>a?i:a:o>a?o:a,p=s>l?s>c?s:c:l>c?l:c;let f=r.next;for(;f!==e;){if(f.x>=u&&f.x<=d&&f.y>=h&&f.y<=p&&iS(i,s,o,l,a,c,f.x,f.y)&&aS(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function Zw(t,e,n,r){const i=t.prev,o=t,a=t.next;if(aS(i,o,a)>=0)return!1;const s=i.x,l=o.x,c=a.x,u=i.y,h=o.y,d=a.y,p=s<l?s<c?s:c:l<c?l:c,f=u<h?u<d?u:d:h<d?h:d,m=s>l?s>c?s:c:l>c?l:c,g=u>h?u>d?u:d:h>d?h:d,y=nS(p,f,e,n,r),v=nS(m,g,e,n,r);let b=t.prevZ,x=t.nextZ;for(;b&&b.z>=y&&x&&x.z<=v;){if(b.x>=p&&b.x<=m&&b.y>=f&&b.y<=g&&b!==i&&b!==a&&iS(s,u,l,h,c,d,b.x,b.y)&&aS(b.prev,b,b.next)>=0)return!1;if(b=b.prevZ,x.x>=p&&x.x<=m&&x.y>=f&&x.y<=g&&x!==i&&x!==a&&iS(s,u,l,h,c,d,x.x,x.y)&&aS(x.prev,x,x.next)>=0)return!1;x=x.nextZ}for(;b&&b.z>=y;){if(b.x>=p&&b.x<=m&&b.y>=f&&b.y<=g&&b!==i&&b!==a&&iS(s,u,l,h,c,d,b.x,b.y)&&aS(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;x&&x.z<=v;){if(x.x>=p&&x.x<=m&&x.y>=f&&x.y<=g&&x!==i&&x!==a&&iS(s,u,l,h,c,d,x.x,x.y)&&aS(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function Jw(t,e,n){let r=t;do{const i=r.prev,o=r.next.next;!sS(i,o)&&lS(i,r,r.next,o)&&hS(i,o)&&hS(o,i)&&(e.push(i.i/n|0),e.push(r.i/n|0),e.push(o.i/n|0),fS(r),fS(r.next),r=t=o),r=r.next}while(r!==t);return Xw(r)}function Qw(t,e,n,r,i,o){let a=t;do{let t=a.next.next;for(;t!==a.prev;){if(a.i!==t.i&&oS(a,t)){let s=dS(a,t);return a=Xw(a,a.next),s=Xw(s,s.next),Yw(a,e,n,r,i,o,0),void Yw(s,e,n,r,i,o,0)}t=t.next}a=a.next}while(a!==t)}function $w(t,e){return t.x-e.x}function tS(t,e){const n=function(t,e){let n,r=e,i=-1/0;const o=t.x,a=t.y;do{if(a<=r.y&&a>=r.next.y&&r.next.y!==r.y){const t=r.x+(a-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(t<=o&&t>i&&(i=t,n=r.x<r.next.x?r:r.next,t===o))return n}r=r.next}while(r!==e);if(!n)return null;const s=n,l=n.x,c=n.y;let u,h=1/0;r=n;do{o>=r.x&&r.x>=l&&o!==r.x&&iS(a<c?o:i,a,l,c,a<c?i:o,a,r.x,r.y)&&(u=Math.abs(a-r.y)/(o-r.x),hS(r,t)&&(u<h||u===h&&(r.x>n.x||r.x===n.x&&eS(n,r)))&&(n=r,h=u)),r=r.next}while(r!==s);return n}(t,e);if(!n)return e;const r=dS(n,t);return Xw(r,r.next),Xw(n,n.next)}function eS(t,e){return aS(t.prev,t,e.prev)<0&&aS(e.next,t,t.next)<0}function nS(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*i|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function rS(t){let e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function iS(t,e,n,r,i,o,a,s){return(i-a)*(e-s)>=(t-a)*(o-s)&&(t-a)*(r-s)>=(n-a)*(e-s)&&(n-a)*(o-s)>=(i-a)*(r-s)}function oS(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&lS(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(hS(t,e)&&hS(e,t)&&function(t,e){let n=t,r=!1;const i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!==n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(aS(t.prev,t,e.prev)||aS(t,e.prev,e))||sS(t,e)&&aS(t.prev,t,t.next)>0&&aS(e.prev,e,e.next)>0)}function aS(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function sS(t,e){return t.x===e.x&&t.y===e.y}function lS(t,e,n,r){const i=uS(aS(t,e,n)),o=uS(aS(t,e,r)),a=uS(aS(n,r,t)),s=uS(aS(n,r,e));return i!==o&&a!==s||(!(0!==i||!cS(t,n,e))||(!(0!==o||!cS(t,r,e))||(!(0!==a||!cS(n,t,r))||!(0!==s||!cS(n,e,r)))))}function cS(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function uS(t){return t>0?1:t<0?-1:0}function hS(t,e){return aS(t.prev,t,t.next)<0?aS(t,e,t.next)>=0&&aS(t,t.prev,e)>=0:aS(t,e,t.prev)<0||aS(t,t.next,e)<0}function dS(t,e){const n=new mS(t.i,t.x,t.y),r=new mS(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function pS(t,e,n,r){const i=new mS(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function fS(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function mS(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}class gS{static area(t){const e=t.length;let n=0;for(let r=e-1,i=0;i<e;r=i++)n+=t[r].x*t[i].y-t[i].x*t[r].y;return.5*n}static isClockWise(t){return gS.area(t)<0}static triangulateShape(t,e){const n=[],r=[],i=[];yS(t),vS(n,t);let o=t.length;e.forEach(yS);for(let s=0;s<e.length;s++)r.push(o),o+=e[s].length,vS(n,e[s]);const a=Hw(n,r);for(let s=0;s<a.length;s+=3)i.push(a.slice(s,s+3));return i}}function yS(t){const e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function vS(t,e){for(let n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}class bS extends Xg{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Gw([new _f(.5,.5),new _f(-.5,.5),new _f(-.5,-.5),new _f(.5,-.5)]),e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},t=Array.isArray(t)?t:[t];const n=this,r=[],i=[];for(let a=0,s=t.length;a<s;a++){o(t[a])}function o(t){const o=[],a=void 0!==e.curveSegments?e.curveSegments:12,s=void 0!==e.steps?e.steps:1,l=void 0!==e.depth?e.depth:1;let c=void 0===e.bevelEnabled||e.bevelEnabled,u=void 0!==e.bevelThickness?e.bevelThickness:.2,h=void 0!==e.bevelSize?e.bevelSize:u-.1,d=void 0!==e.bevelOffset?e.bevelOffset:0,p=void 0!==e.bevelSegments?e.bevelSegments:3;const f=e.extrudePath,m=void 0!==e.UVGenerator?e.UVGenerator:xS;let g,y,v,b,x,_=!1;f&&(g=f.getSpacedPoints(s),_=!0,c=!1,y=f.computeFrenetFrames(s,!1),v=new $f,b=new $f,x=new $f),c||(p=0,u=0,h=0,d=0);const w=t.extractPoints(a);let S=w.shape;const T=w.holes;if(!gS.isClockWise(S)){S=S.reverse();for(let t=0,e=T.length;t<e;t++){const e=T[t];gS.isClockWise(e)&&(T[t]=e.reverse())}}const E=gS.triangulateShape(S,T),M=S;for(let e=0,n=T.length;e<n;e++){const t=T[e];S=S.concat(t)}function C(t,e,n){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().addScaledVector(e,n)}const A=S.length,k=E.length;function I(t,e,n){let r,i,o;const a=t.x-e.x,s=t.y-e.y,l=n.x-t.x,c=n.y-t.y,u=a*a+s*s,h=a*c-s*l;if(Math.abs(h)>Number.EPSILON){const h=Math.sqrt(u),d=Math.sqrt(l*l+c*c),p=e.x-s/h,f=e.y+a/h,m=((n.x-c/d-p)*c-(n.y+l/d-f)*l)/(a*c-s*l);r=p+a*m-t.x,i=f+s*m-t.y;const g=r*r+i*i;if(g<=2)return new _f(r,i);o=Math.sqrt(g/2)}else{let t=!1;a>Number.EPSILON?l>Number.EPSILON&&(t=!0):a<-Number.EPSILON?l<-Number.EPSILON&&(t=!0):Math.sign(s)===Math.sign(c)&&(t=!0),t?(r=-s,i=a,o=Math.sqrt(u)):(r=a,i=s,o=Math.sqrt(u/2))}return new _f(r/o,i/o)}const R=[];for(let e=0,n=M.length,r=n-1,i=e+1;e<n;e++,r++,i++)r===n&&(r=0),i===n&&(i=0),R[e]=I(M[e],M[r],M[i]);const P=[];let N,O=R.concat();for(let e=0,n=T.length;e<n;e++){const t=T[e];N=[];for(let e=0,n=t.length,r=n-1,i=e+1;e<n;e++,r++,i++)r===n&&(r=0),i===n&&(i=0),N[e]=I(t[e],t[r],t[i]);P.push(N),O=O.concat(N)}for(let e=0;e<p;e++){const t=e/p,n=u*Math.cos(t*Math.PI/2),r=h*Math.sin(t*Math.PI/2)+d;for(let e=0,i=M.length;e<i;e++){const t=C(M[e],R[e],r);F(t.x,t.y,-n)}for(let e=0,i=T.length;e<i;e++){const t=T[e];N=P[e];for(let e=0,i=t.length;e<i;e++){const i=C(t[e],N[e],r);F(i.x,i.y,-n)}}}const D=h+d;for(let e=0;e<A;e++){const t=c?C(S[e],O[e],D):S[e];_?(b.copy(y.normals[0]).multiplyScalar(t.x),v.copy(y.binormals[0]).multiplyScalar(t.y),x.copy(g[0]).add(b).add(v),F(x.x,x.y,x.z)):F(t.x,t.y,0)}for(let e=1;e<=s;e++)for(let t=0;t<A;t++){const n=c?C(S[t],O[t],D):S[t];_?(b.copy(y.normals[e]).multiplyScalar(n.x),v.copy(y.binormals[e]).multiplyScalar(n.y),x.copy(g[e]).add(b).add(v),F(x.x,x.y,x.z)):F(n.x,n.y,l/s*e)}for(let e=p-1;e>=0;e--){const t=e/p,n=u*Math.cos(t*Math.PI/2),r=h*Math.sin(t*Math.PI/2)+d;for(let e=0,i=M.length;e<i;e++){const t=C(M[e],R[e],r);F(t.x,t.y,l+n)}for(let e=0,i=T.length;e<i;e++){const t=T[e];N=P[e];for(let e=0,i=t.length;e<i;e++){const i=C(t[e],N[e],r);_?F(i.x,i.y+g[s-1].y,g[s-1].x+n):F(i.x,i.y,l+n)}}}function L(t,e){let n=t.length;for(;--n>=0;){const r=n;let i=n-1;i<0&&(i=t.length-1);for(let t=0,n=s+2*p;t<n;t++){const n=A*t,o=A*(t+1);B(e+r+n,e+i+n,e+i+o,e+r+o)}}}function F(t,e,n){o.push(t),o.push(e),o.push(n)}function U(t,e,i){z(t),z(e),z(i);const o=r.length/3,a=m.generateTopUV(n,r,o-3,o-2,o-1);j(a[0]),j(a[1]),j(a[2])}function B(t,e,i,o){z(t),z(e),z(o),z(e),z(i),z(o);const a=r.length/3,s=m.generateSideWallUV(n,r,a-6,a-3,a-2,a-1);j(s[0]),j(s[1]),j(s[3]),j(s[1]),j(s[2]),j(s[3])}function z(t){r.push(o[3*t+0]),r.push(o[3*t+1]),r.push(o[3*t+2])}function j(t){i.push(t.x),i.push(t.y)}!function(){const t=r.length/3;if(c){let t=0,e=A*t;for(let n=0;n<k;n++){const t=E[n];U(t[2]+e,t[1]+e,t[0]+e)}t=s+2*p,e=A*t;for(let n=0;n<k;n++){const t=E[n];U(t[0]+e,t[1]+e,t[2]+e)}}else{for(let t=0;t<k;t++){const e=E[t];U(e[2],e[1],e[0])}for(let t=0;t<k;t++){const e=E[t];U(e[0]+A*s,e[1]+A*s,e[2]+A*s)}}n.addGroup(t,r.length/3-t,0)}(),function(){const t=r.length/3;let e=0;L(M,e),e+=M.length;for(let n=0,r=T.length;n<r;n++){const t=T[n];L(t,e),e+=t.length}n.addGroup(t,r.length/3-t,1)}()}this.setAttribute("position",new Bg(r,3)),this.setAttribute("uv",new Bg(i,2)),this.computeVertexNormals()}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}toJSON(){const t=super.toJSON();return function(t,e,n){if(n.shapes=[],Array.isArray(t))for(let r=0,i=t.length;r<i;r++){const e=t[r];n.shapes.push(e.uuid)}else n.shapes.push(t.uuid);n.options=Object.assign({},e),void 0!==e.extrudePath&&(n.options.extrudePath=e.extrudePath.toJSON());return n}(this.parameters.shapes,this.parameters.options,t)}static fromJSON(t,e){const n=[];for(let i=0,o=t.shapes.length;i<o;i++){const r=e[t.shapes[i]];n.push(r)}const r=t.options.extrudePath;return void 0!==r&&(t.options.extrudePath=(new kw[r.type]).fromJSON(r)),new bS(n,t.options)}}const xS={generateTopUV:function(t,e,n,r,i){const o=e[3*n],a=e[3*n+1],s=e[3*r],l=e[3*r+1],c=e[3*i],u=e[3*i+1];return[new _f(o,a),new _f(s,l),new _f(c,u)]},generateSideWallUV:function(t,e,n,r,i,o){const a=e[3*n],s=e[3*n+1],l=e[3*n+2],c=e[3*r],u=e[3*r+1],h=e[3*r+2],d=e[3*i],p=e[3*i+1],f=e[3*i+2],m=e[3*o],g=e[3*o+1],y=e[3*o+2];return Math.abs(s-u)<Math.abs(a-c)?[new _f(a,1-l),new _f(c,1-h),new _f(d,1-f),new _f(m,1-y)]:[new _f(s,1-l),new _f(u,1-h),new _f(p,1-f),new _f(g,1-y)]}};class _S extends Fw{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=(1+Math.sqrt(5))/2;super([-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,e),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e}}static fromJSON(t){return new _S(t.radius,t.detail)}}class wS extends Fw{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,e),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e}}static fromJSON(t){return new wS(t.radius,t.detail)}}class SS extends Xg{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:32,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2*Math.PI;super(),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:o},n=Math.max(3,n),r=Math.max(1,r);const a=[],s=[],l=[],c=[];let u=t;const h=(e-t)/r,d=new $f,p=new _f;for(let f=0;f<=r;f++){for(let t=0;t<=n;t++){const r=i+t/n*o;d.x=u*Math.cos(r),d.y=u*Math.sin(r),s.push(d.x,d.y,d.z),l.push(0,0,1),p.x=(d.x/e+1)/2,p.y=(d.y/e+1)/2,c.push(p.x,p.y)}u+=h}for(let f=0;f<r;f++){const t=f*(n+1);for(let e=0;e<n;e++){const r=e+t,i=r,o=r+n+1,s=r+n+2,l=r+1;a.push(i,o,l),a.push(o,s,l)}}this.setIndex(a),this.setAttribute("position",new Bg(s,3)),this.setAttribute("normal",new Bg(l,3)),this.setAttribute("uv",new Bg(c,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new SS(t.innerRadius,t.outerRadius,t.thetaSegments,t.phiSegments,t.thetaStart,t.thetaLength)}}class TS extends Xg{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Gw([new _f(0,.5),new _f(-.5,-.5),new _f(.5,-.5)]),e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12;super(),this.type="ShapeGeometry",this.parameters={shapes:t,curveSegments:e};const n=[],r=[],i=[],o=[];let a=0,s=0;if(!1===Array.isArray(t))l(t);else for(let c=0;c<t.length;c++)l(t[c]),this.addGroup(a,s,c),a+=s,s=0;function l(t){const a=r.length/3,l=t.extractPoints(e);let c=l.shape;const u=l.holes;!1===gS.isClockWise(c)&&(c=c.reverse());for(let e=0,n=u.length;e<n;e++){const t=u[e];!0===gS.isClockWise(t)&&(u[e]=t.reverse())}const h=gS.triangulateShape(c,u);for(let e=0,n=u.length;e<n;e++){const t=u[e];c=c.concat(t)}for(let e=0,n=c.length;e<n;e++){const t=c[e];r.push(t.x,t.y,0),i.push(0,0,1),o.push(t.x,t.y)}for(let e=0,r=h.length;e<r;e++){const t=h[e],r=t[0]+a,i=t[1]+a,o=t[2]+a;n.push(r,i,o),s+=3}}this.setIndex(n),this.setAttribute("position",new Bg(r,3)),this.setAttribute("normal",new Bg(i,3)),this.setAttribute("uv",new Bg(o,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}toJSON(){const t=super.toJSON();return function(t,e){if(e.shapes=[],Array.isArray(t))for(let n=0,r=t.length;n<r;n++){const r=t[n];e.shapes.push(r.uuid)}else e.shapes.push(t.uuid);return e}(this.parameters.shapes,t)}static fromJSON(t,e){const n=[];for(let r=0,i=t.shapes.length;r<i;r++){const i=e[t.shapes[r]];n.push(i)}return new TS(n,t.curveSegments)}}class ES extends Xg{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Math.PI;super(),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:r,phiLength:i,thetaStart:o,thetaLength:a},e=Math.max(3,Math.floor(e)),n=Math.max(2,Math.floor(n));const s=Math.min(o+a,Math.PI);let l=0;const c=[],u=new $f,h=new $f,d=[],p=[],f=[],m=[];for(let g=0;g<=n;g++){const d=[],y=g/n;let v=0;0===g&&0===o?v=.5/e:g===n&&s===Math.PI&&(v=-.5/e);for(let n=0;n<=e;n++){const s=n/e;u.x=-t*Math.cos(r+s*i)*Math.sin(o+y*a),u.y=t*Math.cos(o+y*a),u.z=t*Math.sin(r+s*i)*Math.sin(o+y*a),p.push(u.x,u.y,u.z),h.copy(u).normalize(),f.push(h.x,h.y,h.z),m.push(s+v,1-y),d.push(l++)}c.push(d)}for(let g=0;g<n;g++)for(let t=0;t<e;t++){const e=c[g][t+1],r=c[g][t],i=c[g+1][t],a=c[g+1][t+1];(0!==g||o>0)&&d.push(e,r,a),(g!==n-1||s<Math.PI)&&d.push(r,i,a)}this.setIndex(d),this.setAttribute("position",new Bg(p,3)),this.setAttribute("normal",new Bg(f,3)),this.setAttribute("uv",new Bg(m,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new ES(t.radius,t.widthSegments,t.heightSegments,t.phiStart,t.phiLength,t.thetaStart,t.thetaLength)}}class MS extends Fw{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,e),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e}}static fromJSON(t){return new MS(t.radius,t.detail)}}class CS extends Xg{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:48,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI;super(),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:r,arc:i},n=Math.floor(n),r=Math.floor(r);const o=[],a=[],s=[],l=[],c=new $f,u=new $f,h=new $f;for(let d=0;d<=n;d++)for(let o=0;o<=r;o++){const p=o/r*i,f=d/n*Math.PI*2;u.x=(t+e*Math.cos(f))*Math.cos(p),u.y=(t+e*Math.cos(f))*Math.sin(p),u.z=e*Math.sin(f),a.push(u.x,u.y,u.z),c.x=t*Math.cos(p),c.y=t*Math.sin(p),h.subVectors(u,c).normalize(),s.push(h.x,h.y,h.z),l.push(o/r),l.push(d/n)}for(let d=1;d<=n;d++)for(let t=1;t<=r;t++){const e=(r+1)*d+t-1,n=(r+1)*(d-1)+t-1,i=(r+1)*(d-1)+t,a=(r+1)*d+t;o.push(e,n,a),o.push(n,i,a)}this.setIndex(o),this.setAttribute("position",new Bg(a,3)),this.setAttribute("normal",new Bg(s,3)),this.setAttribute("uv",new Bg(l,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new CS(t.radius,t.tube,t.radialSegments,t.tubularSegments,t.arc)}}class AS extends Xg{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:64,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:3;super(),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:r,p:i,q:o},n=Math.floor(n),r=Math.floor(r);const a=[],s=[],l=[],c=[],u=new $f,h=new $f,d=new $f,p=new $f,f=new $f,m=new $f,g=new $f;for(let v=0;v<=n;++v){const a=v/n*i*Math.PI*2;y(a,i,o,t,d),y(a+.01,i,o,t,p),m.subVectors(p,d),g.addVectors(p,d),f.crossVectors(m,g),g.crossVectors(f,m),f.normalize(),g.normalize();for(let t=0;t<=r;++t){const i=t/r*Math.PI*2,o=-e*Math.cos(i),a=e*Math.sin(i);u.x=d.x+(o*g.x+a*f.x),u.y=d.y+(o*g.y+a*f.y),u.z=d.z+(o*g.z+a*f.z),s.push(u.x,u.y,u.z),h.subVectors(u,d).normalize(),l.push(h.x,h.y,h.z),c.push(v/n),c.push(t/r)}}for(let v=1;v<=n;v++)for(let t=1;t<=r;t++){const e=(r+1)*(v-1)+(t-1),n=(r+1)*v+(t-1),i=(r+1)*v+t,o=(r+1)*(v-1)+t;a.push(e,n,o),a.push(n,i,o)}function y(t,e,n,r,i){const o=Math.cos(t),a=Math.sin(t),s=n/e*t,l=Math.cos(s);i.x=r*(2+l)*.5*o,i.y=r*(2+l)*a*.5,i.z=r*Math.sin(s)*.5}this.setIndex(a),this.setAttribute("position",new Bg(s,3)),this.setAttribute("normal",new Bg(l,3)),this.setAttribute("uv",new Bg(c,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new AS(t.radius,t.tube,t.tubularSegments,t.radialSegments,t.p,t.q)}}class kS extends Xg{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Cw(new $f(-1,-1,0),new $f(-1,1,0),new $f(1,1,0)),e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:64,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];super(),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:e,radius:n,radialSegments:r,closed:i};const o=t.computeFrenetFrames(e,i);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const a=new $f,s=new $f,l=new _f;let c=new $f;const u=[],h=[],d=[],p=[];function f(i){c=t.getPointAt(i/e,c);const l=o.normals[i],d=o.binormals[i];for(let t=0;t<=r;t++){const e=t/r*Math.PI*2,i=Math.sin(e),o=-Math.cos(e);s.x=o*l.x+i*d.x,s.y=o*l.y+i*d.y,s.z=o*l.z+i*d.z,s.normalize(),h.push(s.x,s.y,s.z),a.x=c.x+n*s.x,a.y=c.y+n*s.y,a.z=c.z+n*s.z,u.push(a.x,a.y,a.z)}}!function(){for(let t=0;t<e;t++)f(t);f(!1===i?e:0),function(){for(let t=0;t<=e;t++)for(let n=0;n<=r;n++)l.x=t/e,l.y=n/r,d.push(l.x,l.y)}(),function(){for(let t=1;t<=e;t++)for(let e=1;e<=r;e++){const n=(r+1)*(t-1)+(e-1),i=(r+1)*t+(e-1),o=(r+1)*t+e,a=(r+1)*(t-1)+e;p.push(n,i,a),p.push(i,o,a)}}()}(),this.setIndex(p),this.setAttribute("position",new Bg(u,3)),this.setAttribute("normal",new Bg(h,3)),this.setAttribute("uv",new Bg(d,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}toJSON(){const t=super.toJSON();return t.path=this.parameters.path.toJSON(),t}static fromJSON(t){return new kS((new kw[t.path.type]).fromJSON(t.path),t.tubularSegments,t.radius,t.radialSegments,t.closed)}}class IS extends Xg{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(super(),this.type="WireframeGeometry",this.parameters={geometry:t},null!==t){const e=[],n=new Set,r=new $f,i=new $f;if(null!==t.index){const o=t.attributes.position,a=t.index;let s=t.groups;0===s.length&&(s=[{start:0,count:a.count,materialIndex:0}]);for(let t=0,l=s.length;t<l;++t){const l=s[t],c=l.start;for(let t=c,s=c+l.count;t<s;t+=3)for(let l=0;l<3;l++){const s=a.getX(t+l),c=a.getX(t+(l+1)%3);r.fromBufferAttribute(o,s),i.fromBufferAttribute(o,c),!0===RS(r,i,n)&&(e.push(r.x,r.y,r.z),e.push(i.x,i.y,i.z))}}}else{const o=t.attributes.position;for(let t=0,a=o.count/3;t<a;t++)for(let s=0;s<3;s++){const a=3*t+s,l=3*t+(s+1)%3;r.fromBufferAttribute(o,a),i.fromBufferAttribute(o,l),!0===RS(r,i,n)&&(e.push(r.x,r.y,r.z),e.push(i.x,i.y,i.z))}}this.setAttribute("position",new Bg(e,3))}}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}}function RS(t,e,n){const r="".concat(t.x,",").concat(t.y,",").concat(t.z,"-").concat(e.x,",").concat(e.y,",").concat(e.z),i="".concat(e.x,",").concat(e.y,",").concat(e.z,"-").concat(t.x,",").concat(t.y,",").concat(t.z);return!0!==n.has(r)&&!0!==n.has(i)&&(n.add(r),n.add(i),!0)}var PS=Object.freeze({__proto__:null,BoxGeometry:py,CapsuleGeometry:Nw,CircleGeometry:Ow,ConeGeometry:Lw,CylinderGeometry:Dw,DodecahedronGeometry:Uw,EdgesGeometry:Ww,ExtrudeGeometry:bS,IcosahedronGeometry:_S,LatheGeometry:Pw,OctahedronGeometry:wS,PlaneGeometry:Fy,PolyhedronGeometry:Fw,RingGeometry:SS,ShapeGeometry:TS,SphereGeometry:ES,TetrahedronGeometry:MS,TorusGeometry:CS,TorusKnotGeometry:AS,TubeGeometry:kS,WireframeGeometry:IS});class NS extends _g{constructor(t){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new vg(0),this.transparent=!0,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.fog=t.fog,this}}class OS extends vy{constructor(t){super(t),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class DS extends _g{constructor(t){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new vg(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new vg(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=fp,this.normalScale=new _f(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Bm,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapRotation.copy(t.envMapRotation),this.envMapIntensity=t.envMapIntensity,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this.fog=t.fog,this}}class LS extends DS{constructor(t){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new _f(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return mf(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new vg(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new vg(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new vg(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(t)}get anisotropy(){return this._anisotropy}set anisotropy(t){this._anisotropy>0!==t>0&&this.version++,this._anisotropy=t}get clearcoat(){return this._clearcoat}set clearcoat(t){this._clearcoat>0!==t>0&&this.version++,this._clearcoat=t}get iridescence(){return this._iridescence}set iridescence(t){this._iridescence>0!==t>0&&this.version++,this._iridescence=t}get dispersion(){return this._dispersion}set dispersion(t){this._dispersion>0!==t>0&&this.version++,this._dispersion=t}get sheen(){return this._sheen}set sheen(t){this._sheen>0!==t>0&&this.version++,this._sheen=t}get transmission(){return this._transmission}set transmission(t){this._transmission>0!==t>0&&this.version++,this._transmission=t}copy(t){return super.copy(t),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=t.anisotropy,this.anisotropyRotation=t.anisotropyRotation,this.anisotropyMap=t.anisotropyMap,this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.dispersion=t.dispersion,this.ior=t.ior,this.iridescence=t.iridescence,this.iridescenceMap=t.iridescenceMap,this.iridescenceIOR=t.iridescenceIOR,this.iridescenceThicknessRange=[...t.iridescenceThicknessRange],this.iridescenceThicknessMap=t.iridescenceThicknessMap,this.sheen=t.sheen,this.sheenColor.copy(t.sheenColor),this.sheenColorMap=t.sheenColorMap,this.sheenRoughness=t.sheenRoughness,this.sheenRoughnessMap=t.sheenRoughnessMap,this.transmission=t.transmission,this.transmissionMap=t.transmissionMap,this.thickness=t.thickness,this.thicknessMap=t.thicknessMap,this.attenuationDistance=t.attenuationDistance,this.attenuationColor.copy(t.attenuationColor),this.specularIntensity=t.specularIntensity,this.specularIntensityMap=t.specularIntensityMap,this.specularColor.copy(t.specularColor),this.specularColorMap=t.specularColorMap,this}}class FS extends _g{constructor(t){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new vg(16777215),this.specular=new vg(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new vg(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=fp,this.normalScale=new _f(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Bm,this.combine=vh,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapRotation.copy(t.envMapRotation),this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this.fog=t.fog,this}}class US extends _g{constructor(t){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new vg(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new vg(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=fp,this.normalScale=new _f(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}}class BS extends _g{constructor(t){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=fp,this.normalScale=new _f(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.flatShading=t.flatShading,this}}class zS extends _g{constructor(t){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new vg(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new vg(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=fp,this.normalScale=new _f(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Bm,this.combine=vh,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapRotation.copy(t.envMapRotation),this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this.fog=t.fog,this}}class jS extends _g{constructor(t){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new vg(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=fp,this.normalScale=new _f(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.flatShading=t.flatShading,this.fog=t.fog,this}}class VS extends F_{constructor(t){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}copy(t){return super.copy(t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this}}function WS(t,e,n){return!t||!n&&t.constructor===e?t:"number"===typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)}function GS(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function HS(t){const e=t.length,n=new Array(e);for(let r=0;r!==e;++r)n[r]=r;return n.sort((function(e,n){return t[e]-t[n]})),n}function qS(t,e,n){const r=t.length,i=new t.constructor(r);for(let o=0,a=0;a!==r;++o){const r=n[o]*e;for(let n=0;n!==e;++n)i[a++]=t[r+n]}return i}function XS(t,e,n,r){let i=1,o=t[0];for(;void 0!==o&&void 0===o[r];)o=t[i++];if(void 0===o)return;let a=o[r];if(void 0!==a)if(Array.isArray(a))do{a=o[r],void 0!==a&&(e.push(o.time),n.push.apply(n,a)),o=t[i++]}while(void 0!==o);else if(void 0!==a.toArray)do{a=o[r],void 0!==a&&(e.push(o.time),a.toArray(n,n.length)),o=t[i++]}while(void 0!==o);else do{a=o[r],void 0!==a&&(e.push(o.time),n.push(a)),o=t[i++]}while(void 0!==o)}const YS={convertArray:WS,isTypedArray:GS,getKeyframeOrder:HS,sortedArray:qS,flattenJSON:XS,subclip:function(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:30;const o=t.clone();o.name=e;const a=[];for(let l=0;l<o.tracks.length;++l){const t=o.tracks[l],e=t.getValueSize(),s=[],c=[];for(let o=0;o<t.times.length;++o){const a=t.times[o]*i;if(!(a<n||a>=r)){s.push(t.times[o]);for(let n=0;n<e;++n)c.push(t.values[o*e+n])}}0!==s.length&&(t.times=WS(s,t.times.constructor),t.values=WS(c,t.values.constructor),a.push(t))}o.tracks=a;let s=1/0;for(let l=0;l<o.tracks.length;++l)s>o.tracks[l].times[0]&&(s=o.tracks[l].times[0]);for(let l=0;l<o.tracks.length;++l)o.tracks[l].shift(-1*s);return o.resetDuration(),o},makeClipAdditive:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:30;r<=0&&(r=30);const i=n.tracks.length,o=e/r;for(let a=0;a<i;++a){const e=n.tracks[a],r=e.ValueTypeName;if("bool"===r||"string"===r)continue;const i=t.tracks.find((function(t){return t.name===e.name&&t.ValueTypeName===r}));if(void 0===i)continue;let s=0;const l=e.getValueSize();e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(s=l/3);let c=0;const u=i.getValueSize();i.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(c=u/3);const h=e.times.length-1;let d;if(o<=e.times[0]){const t=s,n=l-s;d=e.values.slice(t,n)}else if(o>=e.times[h]){const t=h*l+s,n=t+l-s;d=e.values.slice(t,n)}else{const t=e.createInterpolant(),n=s,r=l-s;t.evaluate(o),d=t.resultBuffer.slice(n,r)}if("quaternion"===r){(new Qf).fromArray(d).normalize().conjugate().toArray(d)}const p=i.times.length;for(let t=0;t<p;++t){const e=t*u+c;if("quaternion"===r)Qf.multiplyQuaternionsFlat(i.values,e,d,0,i.values,e);else{const t=u-2*c;for(let n=0;n<t;++n)i.values[e+n]-=d[n]}}}return t.blendMode=lp,t}};class KS{constructor(t,e,n,r){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new e.constructor(n),this.sampleValues=e,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(t){const e=this.parameterPositions;let n=this._cachedIndex,r=e[n],i=e[n-1];t:{e:{let o;n:{r:if(!(t<r)){for(let o=n+2;;){if(void 0===r){if(t<i)break r;return n=e.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===o)break;if(i=r,r=e[++n],t<r)break e}o=e.length;break n}if(t>=i)break t;{const a=e[1];t<a&&(n=2,i=a);for(let o=n-2;;){if(void 0===i)return this._cachedIndex=0,this.copySampleValue_(0);if(n===o)break;if(r=i,i=e[--n-1],t>=i)break e}o=n,n=0}}for(;n<o;){const r=n+o>>>1;t<e[r]?o=r:n=r+1}if(r=e[n],i=e[n-1],void 0===i)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return n=e.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,t,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(t){const e=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=t*r;for(let o=0;o!==r;++o)e[o]=n[i+o];return e}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class ZS extends KS{constructor(t,e,n,r){super(t,e,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:ip,endingEnd:ip}}intervalChanged_(t,e,n){const r=this.parameterPositions;let i=t-2,o=t+1,a=r[i],s=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case op:i=t,a=2*e-n;break;case ap:i=r.length-2,a=e+r[i]-r[i+1];break;default:i=t,a=n}if(void 0===s)switch(this.getSettings_().endingEnd){case op:o=t,s=2*n-e;break;case ap:o=1,s=n+r[1]-r[0];break;default:o=t-1,s=e}const l=.5*(n-e),c=this.valueSize;this._weightPrev=l/(e-a),this._weightNext=l/(s-n),this._offsetPrev=i*c,this._offsetNext=o*c}interpolate_(t,e,n,r){const i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,l=s-a,c=this._offsetPrev,u=this._offsetNext,h=this._weightPrev,d=this._weightNext,p=(n-e)/(r-e),f=p*p,m=f*p,g=-h*m+2*h*f-h*p,y=(1+h)*m+(-1.5-2*h)*f+(-.5+h)*p+1,v=(-1-d)*m+(1.5+d)*f+.5*p,b=d*m-d*f;for(let x=0;x!==a;++x)i[x]=g*o[c+x]+y*o[l+x]+v*o[s+x]+b*o[u+x];return i}}class JS extends KS{constructor(t,e,n,r){super(t,e,n,r)}interpolate_(t,e,n,r){const i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,l=s-a,c=(n-e)/(r-e),u=1-c;for(let h=0;h!==a;++h)i[h]=o[l+h]*u+o[s+h]*c;return i}}class QS extends KS{constructor(t,e,n,r){super(t,e,n,r)}interpolate_(t){return this.copySampleValue_(t-1)}}class $S{constructor(t,e,n,r){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=WS(e,this.TimeBufferType),this.values=WS(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(t){const e=t.constructor;let n;if(e.toJSON!==this.toJSON)n=e.toJSON(t);else{n={name:t.name,times:WS(t.times,Array),values:WS(t.values,Array)};const e=t.getInterpolation();e!==t.DefaultInterpolation&&(n.interpolation=e)}return n.type=t.ValueTypeName,n}InterpolantFactoryMethodDiscrete(t){return new QS(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodLinear(t){return new JS(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodSmooth(t){return new ZS(this.times,this.values,this.getValueSize(),t)}setInterpolation(t){let e;switch(t){case ep:e=this.InterpolantFactoryMethodDiscrete;break;case np:e=this.InterpolantFactoryMethodLinear;break;case rp:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){const e="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(e);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",e),this}return this.createInterpolant=e,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return ep;case this.InterpolantFactoryMethodLinear:return np;case this.InterpolantFactoryMethodSmooth:return rp}}getValueSize(){return this.values.length/this.times.length}shift(t){if(0!==t){const e=this.times;for(let n=0,r=e.length;n!==r;++n)e[n]+=t}return this}scale(t){if(1!==t){const e=this.times;for(let n=0,r=e.length;n!==r;++n)e[n]*=t}return this}trim(t,e){const n=this.times,r=n.length;let i=0,o=r-1;for(;i!==r&&n[i]<t;)++i;for(;-1!==o&&n[o]>e;)--o;if(++o,0!==i||o!==r){i>=o&&(o=Math.max(o,1),i=o-1);const t=this.getValueSize();this.times=n.slice(i,o),this.values=this.values.slice(i*t,o*t)}return this}validate(){let t=!0;const e=this.getValueSize();e-Math.floor(e)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);const n=this.times,r=this.values,i=n.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);let o=null;for(let a=0;a!==i;a++){const e=n[a];if("number"===typeof e&&isNaN(e)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,e),t=!1;break}if(null!==o&&o>e){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,e,o),t=!1;break}o=e}if(void 0!==r&&GS(r))for(let a=0,s=r.length;a!==s;++a){const e=r[a];if(isNaN(e)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,e),t=!1;break}}return t}optimize(){const t=this.times.slice(),e=this.values.slice(),n=this.getValueSize(),r=this.getInterpolation()===rp,i=t.length-1;let o=1;for(let a=1;a<i;++a){let i=!1;const s=t[a];if(s!==t[a+1]&&(1!==a||s!==t[0]))if(r)i=!0;else{const t=a*n,r=t-n,o=t+n;for(let a=0;a!==n;++a){const n=e[t+a];if(n!==e[r+a]||n!==e[o+a]){i=!0;break}}}if(i){if(a!==o){t[o]=t[a];const r=a*n,i=o*n;for(let t=0;t!==n;++t)e[i+t]=e[r+t]}++o}}if(i>0){t[o]=t[i];for(let t=i*n,r=o*n,a=0;a!==n;++a)e[r+a]=e[t+a];++o}return o!==t.length?(this.times=t.slice(0,o),this.values=e.slice(0,o*n)):(this.times=t,this.values=e),this}clone(){const t=this.times.slice(),e=this.values.slice(),n=new(0,this.constructor)(this.name,t,e);return n.createInterpolant=this.createInterpolant,n}}$S.prototype.TimeBufferType=Float32Array,$S.prototype.ValueBufferType=Float32Array,$S.prototype.DefaultInterpolation=np;class tT extends $S{constructor(t,e,n){super(t,e,n)}}tT.prototype.ValueTypeName="bool",tT.prototype.ValueBufferType=Array,tT.prototype.DefaultInterpolation=ep,tT.prototype.InterpolantFactoryMethodLinear=void 0,tT.prototype.InterpolantFactoryMethodSmooth=void 0;class eT extends $S{}eT.prototype.ValueTypeName="color";class nT extends $S{}nT.prototype.ValueTypeName="number";class rT extends KS{constructor(t,e,n,r){super(t,e,n,r)}interpolate_(t,e,n,r){const i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=(n-e)/(r-e);let l=t*a;for(let c=l+a;l!==c;l+=4)Qf.slerpFlat(i,0,o,l-a,o,l,s);return i}}class iT extends $S{InterpolantFactoryMethodLinear(t){return new rT(this.times,this.values,this.getValueSize(),t)}}iT.prototype.ValueTypeName="quaternion",iT.prototype.InterpolantFactoryMethodSmooth=void 0;class oT extends $S{constructor(t,e,n){super(t,e,n)}}oT.prototype.ValueTypeName="string",oT.prototype.ValueBufferType=Array,oT.prototype.DefaultInterpolation=ep,oT.prototype.InterpolantFactoryMethodLinear=void 0,oT.prototype.InterpolantFactoryMethodSmooth=void 0;class aT extends $S{}aT.prototype.ValueTypeName="vector";class sT{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:sp;this.name=t,this.tracks=n,this.duration=e,this.blendMode=r,this.uuid=ff(),this.duration<0&&this.resetDuration()}static parse(t){const e=[],n=t.tracks,r=1/(t.fps||1);for(let o=0,a=n.length;o!==a;++o)e.push(lT(n[o]).scale(r));const i=new this(t.name,t.duration,e,t.blendMode);return i.uuid=t.uuid,i}static toJSON(t){const e=[],n=t.tracks,r={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid,blendMode:t.blendMode};for(let i=0,o=n.length;i!==o;++i)e.push($S.toJSON(n[i]));return r}static CreateFromMorphTargetSequence(t,e,n,r){const i=e.length,o=[];for(let a=0;a<i;a++){let t=[],s=[];t.push((a+i-1)%i,a,(a+1)%i),s.push(0,1,0);const l=HS(t);t=qS(t,1,l),s=qS(s,1,l),r||0!==t[0]||(t.push(i),s.push(s[0])),o.push(new nT(".morphTargetInfluences["+e[a].name+"]",t,s).scale(1/n))}return new this(t,-1,o)}static findByName(t,e){let n=t;if(!Array.isArray(t)){const e=t;n=e.geometry&&e.geometry.animations||e.animations}for(let r=0;r<n.length;r++)if(n[r].name===e)return n[r];return null}static CreateClipsFromMorphTargetSequences(t,e,n){const r={},i=/^([\w-]*?)([\d]+)$/;for(let a=0,s=t.length;a<s;a++){const e=t[a],n=e.name.match(i);if(n&&n.length>1){const t=n[1];let i=r[t];i||(r[t]=i=[]),i.push(e)}}const o=[];for(const a in r)o.push(this.CreateFromMorphTargetSequence(a,r[a],e,n));return o}static parseAnimation(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(t,e,n,r,i){if(0!==n.length){const o=[],a=[];XS(n,o,a,r),0!==o.length&&i.push(new t(e,o,a))}},r=[],i=t.name||"default",o=t.fps||30,a=t.blendMode;let s=t.length||-1;const l=t.hierarchy||[];for(let c=0;c<l.length;c++){const t=l[c].keys;if(t&&0!==t.length)if(t[0].morphTargets){const e={};let n;for(n=0;n<t.length;n++)if(t[n].morphTargets)for(let r=0;r<t[n].morphTargets.length;r++)e[t[n].morphTargets[r]]=-1;for(const i in e){const e=[],o=[];for(let r=0;r!==t[n].morphTargets.length;++r){const r=t[n];e.push(r.time),o.push(r.morphTarget===i?1:0)}r.push(new nT(".morphTargetInfluence["+i+"]",e,o))}s=e.length*o}else{const i=".bones["+e[c].name+"]";n(aT,i+".position",t,"pos",r),n(iT,i+".quaternion",t,"rot",r),n(aT,i+".scale",t,"scl",r)}}if(0===r.length)return null;return new this(i,s,r,a)}resetDuration(){let t=0;for(let e=0,n=this.tracks.length;e!==n;++e){const n=this.tracks[e];t=Math.max(t,n.times[n.times.length-1])}return this.duration=t,this}trim(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this}validate(){let t=!0;for(let e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t}optimize(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}clone(){const t=[];for(let e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new this.constructor(this.name,this.duration,t,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function lT(t){if(void 0===t.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return nT;case"vector":case"vector2":case"vector3":case"vector4":return aT;case"color":return eT;case"quaternion":return iT;case"bool":case"boolean":return tT;case"string":return oT}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}(t.type);if(void 0===t.times){const e=[],n=[];XS(t.keys,e,n,"value"),t.times=e,t.values=n}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}const cT={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};class uT{constructor(t,e,n){const r=this;let i,o=!1,a=0,s=0;const l=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(t){s++,!1===o&&void 0!==r.onStart&&r.onStart(t,a,s),o=!0},this.itemEnd=function(t){a++,void 0!==r.onProgress&&r.onProgress(t,a,s),a===s&&(o=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(t){void 0!==r.onError&&r.onError(t)},this.resolveURL=function(t){return i?i(t):t},this.setURLModifier=function(t){return i=t,this},this.addHandler=function(t,e){return l.push(t,e),this},this.removeHandler=function(t){const e=l.indexOf(t);return-1!==e&&l.splice(e,2),this},this.getHandler=function(t){for(let e=0,n=l.length;e<n;e+=2){const n=l[e],r=l[e+1];if(n.global&&(n.lastIndex=0),n.test(t))return r}return null}}}const hT=new uT;class dT{constructor(t){this.manager=void 0!==t?t:hT,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,e){const n=this;return new Promise((function(r,i){n.load(t,r,e,i)}))}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}dT.DEFAULT_MATERIAL_NAME="__DEFAULT";const pT={};class fT extends Error{constructor(t,e){super(t),this.response=e}}class mT extends dT{constructor(t){super(t)}load(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const i=cT.get(t);if(void 0!==i)return this.manager.itemStart(t),setTimeout((()=>{e&&e(i),this.manager.itemEnd(t)}),0),i;if(void 0!==pT[t])return void pT[t].push({onLoad:e,onProgress:n,onError:r});pT[t]=[],pT[t].push({onLoad:e,onProgress:n,onError:r});const o=new Request(t,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,s=this.responseType;fetch(o).then((e=>{if(200===e.status||0===e.status){if(0===e.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),"undefined"===typeof ReadableStream||void 0===e.body||void 0===e.body.getReader)return e;const n=pT[t],r=e.body.getReader(),i=e.headers.get("X-File-Size")||e.headers.get("Content-Length"),o=i?parseInt(i):0,a=0!==o;let s=0;const l=new ReadableStream({start(t){!function e(){r.read().then((r=>{let{done:i,value:l}=r;if(i)t.close();else{s+=l.byteLength;const r=new ProgressEvent("progress",{lengthComputable:a,loaded:s,total:o});for(let t=0,e=n.length;t<e;t++){const e=n[t];e.onProgress&&e.onProgress(r)}t.enqueue(l),e()}}),(e=>{t.error(e)}))}()}});return new Response(l)}throw new fT('fetch for "'.concat(e.url,'" responded with ').concat(e.status,": ").concat(e.statusText),e)})).then((t=>{switch(s){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"document":return t.text().then((t=>(new DOMParser).parseFromString(t,a)));case"json":return t.json();default:if(void 0===a)return t.text();{const e=/charset="?([^;"\s]*)"?/i.exec(a),n=e&&e[1]?e[1].toLowerCase():void 0,r=new TextDecoder(n);return t.arrayBuffer().then((t=>r.decode(t)))}}})).then((e=>{cT.add(t,e);const n=pT[t];delete pT[t];for(let t=0,r=n.length;t<r;t++){const r=n[t];r.onLoad&&r.onLoad(e)}})).catch((e=>{const n=pT[t];if(void 0===n)throw this.manager.itemError(t),e;delete pT[t];for(let t=0,r=n.length;t<r;t++){const r=n[t];r.onError&&r.onError(e)}this.manager.itemError(t)})).finally((()=>{this.manager.itemEnd(t)})),this.manager.itemStart(t)}setResponseType(t){return this.responseType=t,this}setMimeType(t){return this.mimeType=t,this}}class gT extends dT{constructor(t){super(t)}load(t,e,n,r){const i=this,o=new mT(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(t,(function(n){try{e(i.parse(JSON.parse(n)))}catch($7){r?r($7):console.error($7),i.manager.itemError(t)}}),n,r)}parse(t){const e=[];for(let n=0;n<t.length;n++){const r=sT.parse(t[n]);e.push(r)}return e}}class yT extends dT{constructor(t){super(t)}load(t,e,n,r){const i=this,o=[],a=new aw,s=new mT(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(i.withCredentials);let l=0;function c(c){s.load(t[c],(function(t){const n=i.parse(t,!0);o[c]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},l+=1,6===l&&(1===n.mipmapCount&&(a.minFilter=Hh),a.image=o,a.format=n.format,a.needsUpdate=!0,e&&e(a))}),n,r)}if(Array.isArray(t))for(let u=0,h=t.length;u<h;++u)c(u);else s.load(t,(function(t){const n=i.parse(t,!0);if(n.isCubemap){const t=n.mipmaps.length/n.mipmapCount;for(let e=0;e<t;e++){o[e]={mipmaps:[]};for(let t=0;t<n.mipmapCount;t++)o[e].mipmaps.push(n.mipmaps[e*n.mipmapCount+t]),o[e].format=n.format,o[e].width=n.width,o[e].height=n.height}a.image=o}else a.image.width=n.width,a.image.height=n.height,a.mipmaps=n.mipmaps;1===n.mipmapCount&&(a.minFilter=Hh),a.format=n.format,a.needsUpdate=!0,e&&e(a)}),n,r);return a}}class vT extends dT{constructor(t){super(t)}load(t,e,n,r){void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const i=this,o=cT.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout((function(){e&&e(o),i.manager.itemEnd(t)}),0),o;const a=Cf("img");function s(){c(),cT.add(t,this),e&&e(this),i.manager.itemEnd(t)}function l(e){c(),r&&r(e),i.manager.itemError(t),i.manager.itemEnd(t)}function c(){a.removeEventListener("load",s,!1),a.removeEventListener("error",l,!1)}return a.addEventListener("load",s,!1),a.addEventListener("error",l,!1),"data:"!==t.slice(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),i.manager.itemStart(t),a.src=t,a}}class bT extends dT{constructor(t){super(t)}load(t,e,n,r){const i=new My;i.colorSpace=yp;const o=new vT(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function s(n){o.load(t[n],(function(t){i.images[n]=t,a++,6===a&&(i.needsUpdate=!0,e&&e(i))}),void 0,r)}for(let l=0;l<t.length;++l)s(l);return i}}class xT extends dT{constructor(t){super(t)}load(t,e,n,r){const i=this,o=new i_,a=new mT(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(i.withCredentials),a.load(t,(function(t){let n;try{n=i.parse(t)}catch(oA){if(void 0===r)return void console.error(oA);r(oA)}void 0!==n.image?o.image=n.image:void 0!==n.data&&(o.image.width=n.width,o.image.height=n.height,o.image.data=n.data),o.wrapS=void 0!==n.wrapS?n.wrapS:Uh,o.wrapT=void 0!==n.wrapT?n.wrapT:Uh,o.magFilter=void 0!==n.magFilter?n.magFilter:Hh,o.minFilter=void 0!==n.minFilter?n.minFilter:Hh,o.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.colorSpace&&(o.colorSpace=n.colorSpace),void 0!==n.flipY&&(o.flipY=n.flipY),void 0!==n.format&&(o.format=n.format),void 0!==n.type&&(o.type=n.type),void 0!==n.mipmaps&&(o.mipmaps=n.mipmaps,o.minFilter=Yh),1===n.mipmapCount&&(o.minFilter=Hh),void 0!==n.generateMipmaps&&(o.generateMipmaps=n.generateMipmaps),o.needsUpdate=!0,e&&e(o,n)}),n,r),o}}class _T extends dT{constructor(t){super(t)}load(t,e,n,r){const i=new Gf,o=new vT(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(t,(function(t){i.image=t,i.needsUpdate=!0,void 0!==e&&e(i)}),n,r),i}}class wT extends ng{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;super(),this.isLight=!0,this.type="Light",this.color=new vg(t),this.intensity=e}dispose(){}copy(t,e){return super.copy(t,e),this.color.copy(t.color),this.intensity=t.intensity,this}toJSON(t){const e=super.toJSON(t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}class ST extends wT{constructor(t,e,n){super(t,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(ng.DEFAULT_UP),this.updateMatrix(),this.groundColor=new vg(e)}copy(t,e){return super.copy(t,e),this.groundColor.copy(t.groundColor),this}}const TT=new km,ET=new $f,MT=new $f;class CT{constructor(t){this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new _f(512,512),this.map=null,this.mapPass=null,this.matrix=new km,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Oy,this._frameExtents=new _f(1,1),this._viewportCount=1,this._viewports=[new Hf(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(t){const e=this.camera,n=this.matrix;ET.setFromMatrixPosition(t.matrixWorld),e.position.copy(ET),MT.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(MT),e.updateMatrixWorld(),TT.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(TT),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(TT)}getViewport(t){return this._viewports[t]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const t={};return 0!==this.bias&&(t.bias=this.bias),0!==this.normalBias&&(t.normalBias=this.normalBias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}class AT extends CT{constructor(){super(new Sy(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(t){const e=this.camera,n=2*pf*t.angle*this.focus,r=this.mapSize.width/this.mapSize.height,i=t.distance||e.far;n===e.fov&&r===e.aspect&&i===e.far||(e.fov=n,e.aspect=r,e.far=i,e.updateProjectionMatrix()),super.updateMatrices(t)}copy(t){return super.copy(t),this.focus=t.focus,this}}class kT extends wT{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Math.PI/3,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2;super(t,e),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(ng.DEFAULT_UP),this.updateMatrix(),this.target=new ng,this.distance=n,this.angle=r,this.penumbra=i,this.decay=o,this.map=null,this.shadow=new AT}get power(){return this.intensity*Math.PI}set power(t){this.intensity=t/Math.PI}dispose(){this.shadow.dispose()}copy(t,e){return super.copy(t,e),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}const IT=new km,RT=new $f,PT=new $f;class NT extends CT{constructor(){super(new Sy(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new _f(4,2),this._viewportCount=6,this._viewports=[new Hf(2,1,1,1),new Hf(0,1,1,1),new Hf(3,1,1,1),new Hf(1,1,1,1),new Hf(3,0,1,1),new Hf(1,0,1,1)],this._cubeDirections=[new $f(1,0,0),new $f(-1,0,0),new $f(0,0,1),new $f(0,0,-1),new $f(0,1,0),new $f(0,-1,0)],this._cubeUps=[new $f(0,1,0),new $f(0,1,0),new $f(0,1,0),new $f(0,1,0),new $f(0,0,1),new $f(0,0,-1)]}updateMatrices(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.camera,r=this.matrix,i=t.distance||n.far;i!==n.far&&(n.far=i,n.updateProjectionMatrix()),RT.setFromMatrixPosition(t.matrixWorld),n.position.copy(RT),PT.copy(n.position),PT.add(this._cubeDirections[e]),n.up.copy(this._cubeUps[e]),n.lookAt(PT),n.updateMatrixWorld(),r.makeTranslation(-RT.x,-RT.y,-RT.z),IT.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(IT)}}class OT extends wT{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2;super(t,e),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new NT}get power(){return 4*this.intensity*Math.PI}set power(t){this.intensity=t/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(t,e){return super.copy(t,e),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}class DT extends CT{constructor(){super(new Zy(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class LT extends wT{constructor(t,e){super(t,e),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(ng.DEFAULT_UP),this.updateMatrix(),this.target=new ng,this.shadow=new DT}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}class FT extends wT{constructor(t,e){super(t,e),this.isAmbientLight=!0,this.type="AmbientLight"}}class UT extends wT{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;super(t,e),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(t){this.intensity=t/(this.width*this.height*Math.PI)}copy(t){return super.copy(t),this.width=t.width,this.height=t.height,this}toJSON(t){const e=super.toJSON(t);return e.object.width=this.width,e.object.height=this.height,e}}class BT{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let t=0;t<9;t++)this.coefficients.push(new $f)}set(t){for(let e=0;e<9;e++)this.coefficients[e].copy(t[e]);return this}zero(){for(let t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this}getAt(t,e){const n=t.x,r=t.y,i=t.z,o=this.coefficients;return e.copy(o[0]).multiplyScalar(.282095),e.addScaledVector(o[1],.488603*r),e.addScaledVector(o[2],.488603*i),e.addScaledVector(o[3],.488603*n),e.addScaledVector(o[4],n*r*1.092548),e.addScaledVector(o[5],r*i*1.092548),e.addScaledVector(o[6],.315392*(3*i*i-1)),e.addScaledVector(o[7],n*i*1.092548),e.addScaledVector(o[8],.546274*(n*n-r*r)),e}getIrradianceAt(t,e){const n=t.x,r=t.y,i=t.z,o=this.coefficients;return e.copy(o[0]).multiplyScalar(.886227),e.addScaledVector(o[1],1.023328*r),e.addScaledVector(o[2],1.023328*i),e.addScaledVector(o[3],1.023328*n),e.addScaledVector(o[4],.858086*n*r),e.addScaledVector(o[5],.858086*r*i),e.addScaledVector(o[6],.743125*i*i-.247708),e.addScaledVector(o[7],.858086*n*i),e.addScaledVector(o[8],.429043*(n*n-r*r)),e}add(t){for(let e=0;e<9;e++)this.coefficients[e].add(t.coefficients[e]);return this}addScaledSH(t,e){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(t.coefficients[n],e);return this}scale(t){for(let e=0;e<9;e++)this.coefficients[e].multiplyScalar(t);return this}lerp(t,e){for(let n=0;n<9;n++)this.coefficients[n].lerp(t.coefficients[n],e);return this}equals(t){for(let e=0;e<9;e++)if(!this.coefficients[e].equals(t.coefficients[e]))return!1;return!0}copy(t){return this.set(t.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.coefficients;for(let r=0;r<9;r++)n[r].fromArray(t,e+3*r);return this}toArray(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.coefficients;for(let r=0;r<9;r++)n[r].toArray(t,e+3*r);return t}static getBasisAt(t,e){const n=t.x,r=t.y,i=t.z;e[0]=.282095,e[1]=.488603*r,e[2]=.488603*i,e[3]=.488603*n,e[4]=1.092548*n*r,e[5]=1.092548*r*i,e[6]=.315392*(3*i*i-1),e[7]=1.092548*n*i,e[8]=.546274*(n*n-r*r)}}class zT extends wT{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new BT;super(void 0,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1),this.isLightProbe=!0,this.sh=t}copy(t){return super.copy(t),this.sh.copy(t.sh),this}fromJSON(t){return this.intensity=t.intensity,this.sh.fromArray(t.sh),this}toJSON(t){const e=super.toJSON(t);return e.object.sh=this.sh.toArray(),e}}class jT extends dT{constructor(t){super(t),this.textures={}}load(t,e,n,r){const i=this,o=new mT(i.manager);o.setPath(i.path),o.setRequestHeader(i.requestHeader),o.setWithCredentials(i.withCredentials),o.load(t,(function(n){try{e(i.parse(JSON.parse(n)))}catch($7){r?r($7):console.error($7),i.manager.itemError(t)}}),n,r)}parse(t){const e=this.textures;function n(t){return void 0===e[t]&&console.warn("THREE.MaterialLoader: Undefined texture",t),e[t]}const r=jT.createMaterialFromType(t.type);if(void 0!==t.uuid&&(r.uuid=t.uuid),void 0!==t.name&&(r.name=t.name),void 0!==t.color&&void 0!==r.color&&r.color.setHex(t.color),void 0!==t.roughness&&(r.roughness=t.roughness),void 0!==t.metalness&&(r.metalness=t.metalness),void 0!==t.sheen&&(r.sheen=t.sheen),void 0!==t.sheenColor&&(r.sheenColor=(new vg).setHex(t.sheenColor)),void 0!==t.sheenRoughness&&(r.sheenRoughness=t.sheenRoughness),void 0!==t.emissive&&void 0!==r.emissive&&r.emissive.setHex(t.emissive),void 0!==t.specular&&void 0!==r.specular&&r.specular.setHex(t.specular),void 0!==t.specularIntensity&&(r.specularIntensity=t.specularIntensity),void 0!==t.specularColor&&void 0!==r.specularColor&&r.specularColor.setHex(t.specularColor),void 0!==t.shininess&&(r.shininess=t.shininess),void 0!==t.clearcoat&&(r.clearcoat=t.clearcoat),void 0!==t.clearcoatRoughness&&(r.clearcoatRoughness=t.clearcoatRoughness),void 0!==t.dispersion&&(r.dispersion=t.dispersion),void 0!==t.iridescence&&(r.iridescence=t.iridescence),void 0!==t.iridescenceIOR&&(r.iridescenceIOR=t.iridescenceIOR),void 0!==t.iridescenceThicknessRange&&(r.iridescenceThicknessRange=t.iridescenceThicknessRange),void 0!==t.transmission&&(r.transmission=t.transmission),void 0!==t.thickness&&(r.thickness=t.thickness),void 0!==t.attenuationDistance&&(r.attenuationDistance=t.attenuationDistance),void 0!==t.attenuationColor&&void 0!==r.attenuationColor&&r.attenuationColor.setHex(t.attenuationColor),void 0!==t.anisotropy&&(r.anisotropy=t.anisotropy),void 0!==t.anisotropyRotation&&(r.anisotropyRotation=t.anisotropyRotation),void 0!==t.fog&&(r.fog=t.fog),void 0!==t.flatShading&&(r.flatShading=t.flatShading),void 0!==t.blending&&(r.blending=t.blending),void 0!==t.combine&&(r.combine=t.combine),void 0!==t.side&&(r.side=t.side),void 0!==t.shadowSide&&(r.shadowSide=t.shadowSide),void 0!==t.opacity&&(r.opacity=t.opacity),void 0!==t.transparent&&(r.transparent=t.transparent),void 0!==t.alphaTest&&(r.alphaTest=t.alphaTest),void 0!==t.alphaHash&&(r.alphaHash=t.alphaHash),void 0!==t.depthFunc&&(r.depthFunc=t.depthFunc),void 0!==t.depthTest&&(r.depthTest=t.depthTest),void 0!==t.depthWrite&&(r.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(r.colorWrite=t.colorWrite),void 0!==t.blendSrc&&(r.blendSrc=t.blendSrc),void 0!==t.blendDst&&(r.blendDst=t.blendDst),void 0!==t.blendEquation&&(r.blendEquation=t.blendEquation),void 0!==t.blendSrcAlpha&&(r.blendSrcAlpha=t.blendSrcAlpha),void 0!==t.blendDstAlpha&&(r.blendDstAlpha=t.blendDstAlpha),void 0!==t.blendEquationAlpha&&(r.blendEquationAlpha=t.blendEquationAlpha),void 0!==t.blendColor&&void 0!==r.blendColor&&r.blendColor.setHex(t.blendColor),void 0!==t.blendAlpha&&(r.blendAlpha=t.blendAlpha),void 0!==t.stencilWriteMask&&(r.stencilWriteMask=t.stencilWriteMask),void 0!==t.stencilFunc&&(r.stencilFunc=t.stencilFunc),void 0!==t.stencilRef&&(r.stencilRef=t.stencilRef),void 0!==t.stencilFuncMask&&(r.stencilFuncMask=t.stencilFuncMask),void 0!==t.stencilFail&&(r.stencilFail=t.stencilFail),void 0!==t.stencilZFail&&(r.stencilZFail=t.stencilZFail),void 0!==t.stencilZPass&&(r.stencilZPass=t.stencilZPass),void 0!==t.stencilWrite&&(r.stencilWrite=t.stencilWrite),void 0!==t.wireframe&&(r.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(r.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(r.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(r.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.rotation&&(r.rotation=t.rotation),void 0!==t.linewidth&&(r.linewidth=t.linewidth),void 0!==t.dashSize&&(r.dashSize=t.dashSize),void 0!==t.gapSize&&(r.gapSize=t.gapSize),void 0!==t.scale&&(r.scale=t.scale),void 0!==t.polygonOffset&&(r.polygonOffset=t.polygonOffset),void 0!==t.polygonOffsetFactor&&(r.polygonOffsetFactor=t.polygonOffsetFactor),void 0!==t.polygonOffsetUnits&&(r.polygonOffsetUnits=t.polygonOffsetUnits),void 0!==t.dithering&&(r.dithering=t.dithering),void 0!==t.alphaToCoverage&&(r.alphaToCoverage=t.alphaToCoverage),void 0!==t.premultipliedAlpha&&(r.premultipliedAlpha=t.premultipliedAlpha),void 0!==t.forceSinglePass&&(r.forceSinglePass=t.forceSinglePass),void 0!==t.visible&&(r.visible=t.visible),void 0!==t.toneMapped&&(r.toneMapped=t.toneMapped),void 0!==t.userData&&(r.userData=t.userData),void 0!==t.vertexColors&&("number"===typeof t.vertexColors?r.vertexColors=t.vertexColors>0:r.vertexColors=t.vertexColors),void 0!==t.uniforms)for(const i in t.uniforms){const e=t.uniforms[i];switch(r.uniforms[i]={},e.type){case"t":r.uniforms[i].value=n(e.value);break;case"c":r.uniforms[i].value=(new vg).setHex(e.value);break;case"v2":r.uniforms[i].value=(new _f).fromArray(e.value);break;case"v3":r.uniforms[i].value=(new $f).fromArray(e.value);break;case"v4":r.uniforms[i].value=(new Hf).fromArray(e.value);break;case"m3":r.uniforms[i].value=(new wf).fromArray(e.value);break;case"m4":r.uniforms[i].value=(new km).fromArray(e.value);break;default:r.uniforms[i].value=e.value}}if(void 0!==t.defines&&(r.defines=t.defines),void 0!==t.vertexShader&&(r.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(r.fragmentShader=t.fragmentShader),void 0!==t.glslVersion&&(r.glslVersion=t.glslVersion),void 0!==t.extensions)for(const i in t.extensions)r.extensions[i]=t.extensions[i];if(void 0!==t.lights&&(r.lights=t.lights),void 0!==t.clipping&&(r.clipping=t.clipping),void 0!==t.size&&(r.size=t.size),void 0!==t.sizeAttenuation&&(r.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(r.map=n(t.map)),void 0!==t.matcap&&(r.matcap=n(t.matcap)),void 0!==t.alphaMap&&(r.alphaMap=n(t.alphaMap)),void 0!==t.bumpMap&&(r.bumpMap=n(t.bumpMap)),void 0!==t.bumpScale&&(r.bumpScale=t.bumpScale),void 0!==t.normalMap&&(r.normalMap=n(t.normalMap)),void 0!==t.normalMapType&&(r.normalMapType=t.normalMapType),void 0!==t.normalScale){let e=t.normalScale;!1===Array.isArray(e)&&(e=[e,e]),r.normalScale=(new _f).fromArray(e)}return void 0!==t.displacementMap&&(r.displacementMap=n(t.displacementMap)),void 0!==t.displacementScale&&(r.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(r.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(r.roughnessMap=n(t.roughnessMap)),void 0!==t.metalnessMap&&(r.metalnessMap=n(t.metalnessMap)),void 0!==t.emissiveMap&&(r.emissiveMap=n(t.emissiveMap)),void 0!==t.emissiveIntensity&&(r.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(r.specularMap=n(t.specularMap)),void 0!==t.specularIntensityMap&&(r.specularIntensityMap=n(t.specularIntensityMap)),void 0!==t.specularColorMap&&(r.specularColorMap=n(t.specularColorMap)),void 0!==t.envMap&&(r.envMap=n(t.envMap)),void 0!==t.envMapRotation&&r.envMapRotation.fromArray(t.envMapRotation),void 0!==t.envMapIntensity&&(r.envMapIntensity=t.envMapIntensity),void 0!==t.reflectivity&&(r.reflectivity=t.reflectivity),void 0!==t.refractionRatio&&(r.refractionRatio=t.refractionRatio),void 0!==t.lightMap&&(r.lightMap=n(t.lightMap)),void 0!==t.lightMapIntensity&&(r.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(r.aoMap=n(t.aoMap)),void 0!==t.aoMapIntensity&&(r.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(r.gradientMap=n(t.gradientMap)),void 0!==t.clearcoatMap&&(r.clearcoatMap=n(t.clearcoatMap)),void 0!==t.clearcoatRoughnessMap&&(r.clearcoatRoughnessMap=n(t.clearcoatRoughnessMap)),void 0!==t.clearcoatNormalMap&&(r.clearcoatNormalMap=n(t.clearcoatNormalMap)),void 0!==t.clearcoatNormalScale&&(r.clearcoatNormalScale=(new _f).fromArray(t.clearcoatNormalScale)),void 0!==t.iridescenceMap&&(r.iridescenceMap=n(t.iridescenceMap)),void 0!==t.iridescenceThicknessMap&&(r.iridescenceThicknessMap=n(t.iridescenceThicknessMap)),void 0!==t.transmissionMap&&(r.transmissionMap=n(t.transmissionMap)),void 0!==t.thicknessMap&&(r.thicknessMap=n(t.thicknessMap)),void 0!==t.anisotropyMap&&(r.anisotropyMap=n(t.anisotropyMap)),void 0!==t.sheenColorMap&&(r.sheenColorMap=n(t.sheenColorMap)),void 0!==t.sheenRoughnessMap&&(r.sheenRoughnessMap=n(t.sheenRoughnessMap)),r}setTextures(t){return this.textures=t,this}static createMaterialFromType(t){return new{ShadowMaterial:NS,SpriteMaterial:Ax,RawShaderMaterial:OS,ShaderMaterial:vy,PointsMaterial:J_,MeshPhysicalMaterial:LS,MeshStandardMaterial:DS,MeshPhongMaterial:FS,MeshToonMaterial:US,MeshNormalMaterial:BS,MeshLambertMaterial:zS,MeshDepthMaterial:ox,MeshDistanceMaterial:ax,MeshBasicMaterial:wg,MeshMatcapMaterial:jS,LineDashedMaterial:VS,LineBasicMaterial:F_,Material:_g}[t]}}class VT{static decodeText(t){if(console.warn("THREE.LoaderUtils: decodeText() has been deprecated with r165 and will be removed with r175. Use TextDecoder instead."),"undefined"!==typeof TextDecoder)return(new TextDecoder).decode(t);let e="";for(let n=0,r=t.length;n<r;n++)e+=String.fromCharCode(t[n]);try{return decodeURIComponent(escape(e))}catch($7){return e}}static extractUrlBase(t){const e=t.lastIndexOf("/");return-1===e?"./":t.slice(0,e+1)}static resolveURL(t,e){return"string"!==typeof t||""===t?"":(/^https?:\/\//i.test(e)&&/^\//.test(t)&&(e=e.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(t)||/^data:.*,.*$/i.test(t)||/^blob:.*$/i.test(t)?t:e+t)}}class WT extends Xg{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(t){return super.copy(t),this.instanceCount=t.instanceCount,this}toJSON(){const t=super.toJSON();return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}}class GT extends dT{constructor(t){super(t)}load(t,e,n,r){const i=this,o=new mT(i.manager);o.setPath(i.path),o.setRequestHeader(i.requestHeader),o.setWithCredentials(i.withCredentials),o.load(t,(function(n){try{e(i.parse(JSON.parse(n)))}catch($7){r?r($7):console.error($7),i.manager.itemError(t)}}),n,r)}parse(t){const e={},n={};function r(t,r){if(void 0!==e[r])return e[r];const i=t.interleavedBuffers[r],o=function(t,e){if(void 0!==n[e])return n[e];const r=t.arrayBuffers,i=r[e],o=new Uint32Array(i).buffer;return n[e]=o,o}(t,i.buffer),a=Mf(i.type,o),s=new Ex(a,i.stride);return s.uuid=i.uuid,e[r]=s,s}const i=t.isInstancedBufferGeometry?new WT:new Xg,o=t.data.index;if(void 0!==o){const t=Mf(o.type,o.array);i.setIndex(new Ig(t,1))}const a=t.data.attributes;for(const u in a){const e=a[u];let n;if(e.isInterleavedBufferAttribute){const i=r(t.data,e.data);n=new Cx(i,e.itemSize,e.offset,e.normalized)}else{const t=Mf(e.type,e.array);n=new(e.isInstancedBufferAttribute?l_:Ig)(t,e.itemSize,e.normalized)}void 0!==e.name&&(n.name=e.name),void 0!==e.usage&&n.setUsage(e.usage),i.setAttribute(u,n)}const s=t.data.morphAttributes;if(s)for(const u in s){const e=s[u],n=[];for(let i=0,o=e.length;i<o;i++){const o=e[i];let a;if(o.isInterleavedBufferAttribute){const e=r(t.data,o.data);a=new Cx(e,o.itemSize,o.offset,o.normalized)}else{const t=Mf(o.type,o.array);a=new Ig(t,o.itemSize,o.normalized)}void 0!==o.name&&(a.name=o.name),n.push(a)}i.morphAttributes[u]=n}t.data.morphTargetsRelative&&(i.morphTargetsRelative=!0);const l=t.data.groups||t.data.drawcalls||t.data.offsets;if(void 0!==l)for(let u=0,h=l.length;u!==h;++u){const t=l[u];i.addGroup(t.start,t.count,t.materialIndex)}const c=t.data.boundingSphere;if(void 0!==c){const t=new $f;void 0!==c.center&&t.fromArray(c.center),i.boundingSphere=new xm(t,c.radius)}return t.name&&(i.name=t.name),t.userData&&(i.userData=t.userData),i}}class HT extends dT{constructor(t){super(t)}load(t,e,n,r){const i=this,o=""===this.path?VT.extractUrlBase(t):this.path;this.resourcePath=this.resourcePath||o;const a=new mT(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(t,(function(n){let o=null;try{o=JSON.parse(n)}catch(oA){return void 0!==r&&r(oA),void console.error("THREE:ObjectLoader: Can't parse "+t+".",oA.message)}const a=o.metadata;if(void 0===a||void 0===a.type||"geometry"===a.type.toLowerCase())return void 0!==r&&r(new Error("THREE.ObjectLoader: Can't load "+t)),void console.error("THREE.ObjectLoader: Can't load "+t);i.parse(o,e)}),n,r)}async loadAsync(t,e){const n=""===this.path?VT.extractUrlBase(t):this.path;this.resourcePath=this.resourcePath||n;const r=new mT(this.manager);r.setPath(this.path),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials);const i=await r.loadAsync(t,e),o=JSON.parse(i),a=o.metadata;if(void 0===a||void 0===a.type||"geometry"===a.type.toLowerCase())throw new Error("THREE.ObjectLoader: Can't load "+t);return await this.parseAsync(o)}parse(t,e){const n=this.parseAnimations(t.animations),r=this.parseShapes(t.shapes),i=this.parseGeometries(t.geometries,r),o=this.parseImages(t.images,(function(){void 0!==e&&e(l)})),a=this.parseTextures(t.textures,o),s=this.parseMaterials(t.materials,a),l=this.parseObject(t.object,i,s,a,n),c=this.parseSkeletons(t.skeletons,l);if(this.bindSkeletons(l,c),void 0!==e){let t=!1;for(const e in o)if(o[e].data instanceof HTMLImageElement){t=!0;break}!1===t&&e(l)}return l}async parseAsync(t){const e=this.parseAnimations(t.animations),n=this.parseShapes(t.shapes),r=this.parseGeometries(t.geometries,n),i=await this.parseImagesAsync(t.images),o=this.parseTextures(t.textures,i),a=this.parseMaterials(t.materials,o),s=this.parseObject(t.object,r,a,o,e),l=this.parseSkeletons(t.skeletons,s);return this.bindSkeletons(s,l),s}parseShapes(t){const e={};if(void 0!==t)for(let n=0,r=t.length;n<r;n++){const r=(new Gw).fromJSON(t[n]);e[r.uuid]=r}return e}parseSkeletons(t,e){const n={},r={};if(e.traverse((function(t){t.isBone&&(r[t.uuid]=t)})),void 0!==t)for(let i=0,o=t.length;i<o;i++){const e=(new s_).fromJSON(t[i],r);n[e.uuid]=e}return n}parseGeometries(t,e){const n={};if(void 0!==t){const r=new GT;for(let i=0,o=t.length;i<o;i++){let o;const a=t[i];switch(a.type){case"BufferGeometry":case"InstancedBufferGeometry":o=r.parse(a);break;default:a.type in PS?o=PS[a.type].fromJSON(a,e):console.warn('THREE.ObjectLoader: Unsupported geometry type "'.concat(a.type,'"'))}o.uuid=a.uuid,void 0!==a.name&&(o.name=a.name),void 0!==a.userData&&(o.userData=a.userData),n[a.uuid]=o}}return n}parseMaterials(t,e){const n={},r={};if(void 0!==t){const i=new jT;i.setTextures(e);for(let e=0,o=t.length;e<o;e++){const o=t[e];void 0===n[o.uuid]&&(n[o.uuid]=i.parse(o)),r[o.uuid]=n[o.uuid]}}return r}parseAnimations(t){const e={};if(void 0!==t)for(let n=0;n<t.length;n++){const r=t[n],i=sT.parse(r);e[i.uuid]=i}return e}parseImages(t,e){const n=this,r={};let i;function o(t){if("string"===typeof t){const e=t;return function(t){return n.manager.itemStart(t),i.load(t,(function(){n.manager.itemEnd(t)}),void 0,(function(){n.manager.itemError(t),n.manager.itemEnd(t)}))}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(e)?e:n.resourcePath+e)}return t.data?{data:Mf(t.type,t.data),width:t.width,height:t.height}:null}if(void 0!==t&&t.length>0){const n=new uT(e);i=new vT(n),i.setCrossOrigin(this.crossOrigin);for(let e=0,i=t.length;e<i;e++){const n=t[e],i=n.url;if(Array.isArray(i)){const t=[];for(let e=0,n=i.length;e<n;e++){const n=o(i[e]);null!==n&&(n instanceof HTMLImageElement?t.push(n):t.push(new i_(n.data,n.width,n.height)))}r[n.uuid]=new jf(t)}else{const t=o(n.url);r[n.uuid]=new jf(t)}}}return r}async parseImagesAsync(t){const e=this,n={};let r;async function i(t){if("string"===typeof t){const n=t,i=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(n)?n:e.resourcePath+n;return await r.loadAsync(i)}return t.data?{data:Mf(t.type,t.data),width:t.width,height:t.height}:null}if(void 0!==t&&t.length>0){r=new vT(this.manager),r.setCrossOrigin(this.crossOrigin);for(let e=0,r=t.length;e<r;e++){const r=t[e],o=r.url;if(Array.isArray(o)){const t=[];for(let e=0,n=o.length;e<n;e++){const n=o[e],r=await i(n);null!==r&&(r instanceof HTMLImageElement?t.push(r):t.push(new i_(r.data,r.width,r.height)))}n[r.uuid]=new jf(t)}else{const t=await i(r.url);n[r.uuid]=new jf(t)}}}return n}parseTextures(t,e){function n(t,e){return"number"===typeof t?t:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",t),e[t])}const r={};if(void 0!==t)for(let i=0,o=t.length;i<o;i++){const o=t[i];void 0===o.image&&console.warn('THREE.ObjectLoader: No "image" specified for',o.uuid),void 0===e[o.image]&&console.warn("THREE.ObjectLoader: Undefined image",o.image);const a=e[o.image],s=a.data;let l;Array.isArray(s)?(l=new My,6===s.length&&(l.needsUpdate=!0)):(l=s&&s.data?new i_:new Gf,s&&(l.needsUpdate=!0)),l.source=a,l.uuid=o.uuid,void 0!==o.name&&(l.name=o.name),void 0!==o.mapping&&(l.mapping=n(o.mapping,qT)),void 0!==o.channel&&(l.channel=o.channel),void 0!==o.offset&&l.offset.fromArray(o.offset),void 0!==o.repeat&&l.repeat.fromArray(o.repeat),void 0!==o.center&&l.center.fromArray(o.center),void 0!==o.rotation&&(l.rotation=o.rotation),void 0!==o.wrap&&(l.wrapS=n(o.wrap[0],XT),l.wrapT=n(o.wrap[1],XT)),void 0!==o.format&&(l.format=o.format),void 0!==o.internalFormat&&(l.internalFormat=o.internalFormat),void 0!==o.type&&(l.type=o.type),void 0!==o.colorSpace&&(l.colorSpace=o.colorSpace),void 0!==o.minFilter&&(l.minFilter=n(o.minFilter,YT)),void 0!==o.magFilter&&(l.magFilter=n(o.magFilter,YT)),void 0!==o.anisotropy&&(l.anisotropy=o.anisotropy),void 0!==o.flipY&&(l.flipY=o.flipY),void 0!==o.generateMipmaps&&(l.generateMipmaps=o.generateMipmaps),void 0!==o.premultiplyAlpha&&(l.premultiplyAlpha=o.premultiplyAlpha),void 0!==o.unpackAlignment&&(l.unpackAlignment=o.unpackAlignment),void 0!==o.compareFunction&&(l.compareFunction=o.compareFunction),void 0!==o.userData&&(l.userData=o.userData),r[o.uuid]=l}return r}parseObject(t,e,n,r,i){let o,a,s;function l(t){return void 0===e[t]&&console.warn("THREE.ObjectLoader: Undefined geometry",t),e[t]}function c(t){if(void 0!==t){if(Array.isArray(t)){const e=[];for(let r=0,i=t.length;r<i;r++){const i=t[r];void 0===n[i]&&console.warn("THREE.ObjectLoader: Undefined material",i),e.push(n[i])}return e}return void 0===n[t]&&console.warn("THREE.ObjectLoader: Undefined material",t),n[t]}}function u(t){return void 0===r[t]&&console.warn("THREE.ObjectLoader: Undefined texture",t),r[t]}switch(t.type){case"Scene":o=new Tx,void 0!==t.background&&(Number.isInteger(t.background)?o.background=new vg(t.background):o.background=u(t.background)),void 0!==t.environment&&(o.environment=u(t.environment)),void 0!==t.fog&&("Fog"===t.fog.type?o.fog=new Sx(t.fog.color,t.fog.near,t.fog.far):"FogExp2"===t.fog.type&&(o.fog=new wx(t.fog.color,t.fog.density)),""!==t.fog.name&&(o.fog.name=t.fog.name)),void 0!==t.backgroundBlurriness&&(o.backgroundBlurriness=t.backgroundBlurriness),void 0!==t.backgroundIntensity&&(o.backgroundIntensity=t.backgroundIntensity),void 0!==t.backgroundRotation&&o.backgroundRotation.fromArray(t.backgroundRotation),void 0!==t.environmentIntensity&&(o.environmentIntensity=t.environmentIntensity),void 0!==t.environmentRotation&&o.environmentRotation.fromArray(t.environmentRotation);break;case"PerspectiveCamera":o=new Sy(t.fov,t.aspect,t.near,t.far),void 0!==t.focus&&(o.focus=t.focus),void 0!==t.zoom&&(o.zoom=t.zoom),void 0!==t.filmGauge&&(o.filmGauge=t.filmGauge),void 0!==t.filmOffset&&(o.filmOffset=t.filmOffset),void 0!==t.view&&(o.view=Object.assign({},t.view));break;case"OrthographicCamera":o=new Zy(t.left,t.right,t.top,t.bottom,t.near,t.far),void 0!==t.zoom&&(o.zoom=t.zoom),void 0!==t.view&&(o.view=Object.assign({},t.view));break;case"AmbientLight":o=new FT(t.color,t.intensity);break;case"DirectionalLight":o=new LT(t.color,t.intensity);break;case"PointLight":o=new OT(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":o=new UT(t.color,t.intensity,t.width,t.height);break;case"SpotLight":o=new kT(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":o=new ST(t.color,t.groundColor,t.intensity);break;case"LightProbe":o=(new zT).fromJSON(t);break;case"SkinnedMesh":a=l(t.geometry),s=c(t.material),o=new n_(a,s),void 0!==t.bindMode&&(o.bindMode=t.bindMode),void 0!==t.bindMatrix&&o.bindMatrix.fromArray(t.bindMatrix),void 0!==t.skeleton&&(o.skeleton=t.skeleton);break;case"Mesh":a=l(t.geometry),s=c(t.material),o=new hy(a,s);break;case"InstancedMesh":a=l(t.geometry),s=c(t.material);const e=t.count,n=t.instanceMatrix,r=t.instanceColor;o=new g_(a,s,e),o.instanceMatrix=new l_(new Float32Array(n.array),16),void 0!==r&&(o.instanceColor=new l_(new Float32Array(r.array),r.itemSize));break;case"BatchedMesh":a=l(t.geometry),s=c(t.material),o=new L_(t.maxGeometryCount,t.maxVertexCount,t.maxIndexCount,s),o.geometry=a,o.perObjectFrustumCulled=t.perObjectFrustumCulled,o.sortObjects=t.sortObjects,o._drawRanges=t.drawRanges,o._reservedRanges=t.reservedRanges,o._visibility=t.visibility,o._active=t.active,o._bounds=t.bounds.map((t=>{const e=new nm;e.min.fromArray(t.boxMin),e.max.fromArray(t.boxMax);const n=new xm;return n.radius=t.sphereRadius,n.center.fromArray(t.sphereCenter),{boxInitialized:t.boxInitialized,box:e,sphereInitialized:t.sphereInitialized,sphere:n}})),o._maxGeometryCount=t.maxGeometryCount,o._maxVertexCount=t.maxVertexCount,o._maxIndexCount=t.maxIndexCount,o._geometryInitialized=t.geometryInitialized,o._geometryCount=t.geometryCount,o._matricesTexture=u(t.matricesTexture.uuid),void 0!==t.colorsTexture&&(o._colorsTexture=u(t.colorsTexture.uuid));break;case"LOD":o=new qx;break;case"Line":o=new H_(l(t.geometry),c(t.material));break;case"LineLoop":o=new Z_(l(t.geometry),c(t.material));break;case"LineSegments":o=new K_(l(t.geometry),c(t.material));break;case"PointCloud":case"Points":o=new nw(l(t.geometry),c(t.material));break;case"Sprite":o=new Vx(c(t.material));break;case"Group":o=new dx;break;case"Bone":o=new r_;break;default:o=new ng}if(o.uuid=t.uuid,void 0!==t.name&&(o.name=t.name),void 0!==t.matrix?(o.matrix.fromArray(t.matrix),void 0!==t.matrixAutoUpdate&&(o.matrixAutoUpdate=t.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(void 0!==t.position&&o.position.fromArray(t.position),void 0!==t.rotation&&o.rotation.fromArray(t.rotation),void 0!==t.quaternion&&o.quaternion.fromArray(t.quaternion),void 0!==t.scale&&o.scale.fromArray(t.scale)),void 0!==t.up&&o.up.fromArray(t.up),void 0!==t.castShadow&&(o.castShadow=t.castShadow),void 0!==t.receiveShadow&&(o.receiveShadow=t.receiveShadow),t.shadow&&(void 0!==t.shadow.bias&&(o.shadow.bias=t.shadow.bias),void 0!==t.shadow.normalBias&&(o.shadow.normalBias=t.shadow.normalBias),void 0!==t.shadow.radius&&(o.shadow.radius=t.shadow.radius),void 0!==t.shadow.mapSize&&o.shadow.mapSize.fromArray(t.shadow.mapSize),void 0!==t.shadow.camera&&(o.shadow.camera=this.parseObject(t.shadow.camera))),void 0!==t.visible&&(o.visible=t.visible),void 0!==t.frustumCulled&&(o.frustumCulled=t.frustumCulled),void 0!==t.renderOrder&&(o.renderOrder=t.renderOrder),void 0!==t.userData&&(o.userData=t.userData),void 0!==t.layers&&(o.layers.mask=t.layers),void 0!==t.children){const a=t.children;for(let t=0;t<a.length;t++)o.add(this.parseObject(a[t],e,n,r,i))}if(void 0!==t.animations){const e=t.animations;for(let t=0;t<e.length;t++){const n=e[t];o.animations.push(i[n])}}if("LOD"===t.type){void 0!==t.autoUpdate&&(o.autoUpdate=t.autoUpdate);const e=t.levels;for(let t=0;t<e.length;t++){const n=e[t],r=o.getObjectByProperty("uuid",n.object);void 0!==r&&o.addLevel(r,n.distance,n.hysteresis)}}return o}bindSkeletons(t,e){0!==Object.keys(e).length&&t.traverse((function(t){if(!0===t.isSkinnedMesh&&void 0!==t.skeleton){const n=e[t.skeleton];void 0===n?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",t.skeleton):t.bind(n,t.bindMatrix)}}))}}const qT={UVMapping:Rh,CubeReflectionMapping:Ph,CubeRefractionMapping:Nh,EquirectangularReflectionMapping:Oh,EquirectangularRefractionMapping:Dh,CubeUVReflectionMapping:Lh},XT={RepeatWrapping:Fh,ClampToEdgeWrapping:Uh,MirroredRepeatWrapping:Bh},YT={NearestFilter:zh,NearestMipmapNearestFilter:jh,NearestMipmapLinearFilter:Wh,LinearFilter:Hh,LinearMipmapNearestFilter:qh,LinearMipmapLinearFilter:Yh};class KT extends dT{constructor(t){super(t),this.isImageBitmapLoader=!0,"undefined"===typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"===typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(t){return this.options=t,this}load(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const i=this,o=cT.get(t);if(void 0!==o)return i.manager.itemStart(t),o.then?void o.then((n=>{e&&e(n),i.manager.itemEnd(t)})).catch((t=>{r&&r(t)})):(setTimeout((function(){e&&e(o),i.manager.itemEnd(t)}),0),o);const a={};a.credentials="anonymous"===this.crossOrigin?"same-origin":"include",a.headers=this.requestHeader;const s=fetch(t,a).then((function(t){return t.blob()})).then((function(t){return createImageBitmap(t,Object.assign(i.options,{colorSpaceConversion:"none"}))})).then((function(n){return cT.add(t,n),e&&e(n),i.manager.itemEnd(t),n})).catch((function(e){r&&r(e),cT.remove(t),i.manager.itemError(t),i.manager.itemEnd(t)}));cT.add(t,s),i.manager.itemStart(t)}}let ZT;class JT{static getContext(){return void 0===ZT&&(ZT=new(window.AudioContext||window.webkitAudioContext)),ZT}static setContext(t){ZT=t}}class QT extends dT{constructor(t){super(t)}load(t,e,n,r){const i=this,o=new mT(this.manager);function a(e){r?r(e):console.error(e),i.manager.itemError(t)}o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(t,(function(t){try{const n=t.slice(0);JT.getContext().decodeAudioData(n,(function(t){e(t)})).catch(a)}catch($7){a($7)}}),n,r)}}const $T=new km,tE=new km,eE=new km;class nE{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Sy,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Sy,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(t){const e=this._cache;if(e.focus!==t.focus||e.fov!==t.fov||e.aspect!==t.aspect*this.aspect||e.near!==t.near||e.far!==t.far||e.zoom!==t.zoom||e.eyeSep!==this.eyeSep){e.focus=t.focus,e.fov=t.fov,e.aspect=t.aspect*this.aspect,e.near=t.near,e.far=t.far,e.zoom=t.zoom,e.eyeSep=this.eyeSep,eE.copy(t.projectionMatrix);const n=e.eyeSep/2,r=n*e.near/e.focus,i=e.near*Math.tan(df*e.fov*.5)/e.zoom;let o,a;tE.elements[12]=-n,$T.elements[12]=n,o=-i*e.aspect+r,a=i*e.aspect+r,eE.elements[0]=2*e.near/(a-o),eE.elements[8]=(a+o)/(a-o),this.cameraL.projectionMatrix.copy(eE),o=-i*e.aspect-r,a=i*e.aspect-r,eE.elements[0]=2*e.near/(a-o),eE.elements[8]=(a+o)/(a-o),this.cameraR.projectionMatrix.copy(eE)}this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(tE),this.cameraR.matrixWorld.copy(t.matrixWorld).multiply($T)}}class rE{constructor(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.autoStart=t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=iE(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const e=iE();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t}}function iE(){return("undefined"===typeof performance?Date:performance).now()}const oE=new $f,aE=new Qf,sE=new $f,lE=new $f;class cE extends ng{constructor(){super(),this.type="AudioListener",this.context=JT.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new rE}getInput(){return this.gain}removeFilter(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(t){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}updateMatrixWorld(t){super.updateMatrixWorld(t);const e=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(oE,aE,sE),lE.set(0,0,-1).applyQuaternion(aE),e.positionX){const t=this.context.currentTime+this.timeDelta;e.positionX.linearRampToValueAtTime(oE.x,t),e.positionY.linearRampToValueAtTime(oE.y,t),e.positionZ.linearRampToValueAtTime(oE.z,t),e.forwardX.linearRampToValueAtTime(lE.x,t),e.forwardY.linearRampToValueAtTime(lE.y,t),e.forwardZ.linearRampToValueAtTime(lE.z,t),e.upX.linearRampToValueAtTime(n.x,t),e.upY.linearRampToValueAtTime(n.y,t),e.upZ.linearRampToValueAtTime(n.z,t)}else e.setPosition(oE.x,oE.y,oE.z),e.setOrientation(lE.x,lE.y,lE.z,n.x,n.y,n.z)}}class uE extends ng{constructor(t){super(),this.type="Audio",this.listener=t,this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this}setMediaElementSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this}setMediaStreamSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(t),this.connect(),this}setBuffer(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this}play(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+t;const e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.onended=this.onEnded.bind(this),e.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,null!==this.source&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(!1!==this._connected){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(t){return t||(t=[]),!0===this._connected?(this.disconnect(),this.filters=t.slice(),this.connect()):this.filters=t.slice(),this}setDetune(t){return this.detune=t,!0===this.isPlaying&&void 0!==this.source.detune&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(t){return this.setFilters(t?[t]:[])}setPlaybackRate(t){if(!1!==this.hasPlaybackControl)return this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(t){if(!1!==this.hasPlaybackControl)return this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(t){return this.loopStart=t,this}setLoopEnd(t){return this.loopEnd=t,this}getVolume(){return this.gain.gain.value}setVolume(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}}const hE=new $f,dE=new Qf,pE=new $f,fE=new $f;class mE extends uE{constructor(t){super(t),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(t){return this.panner.refDistance=t,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(t){return this.panner.rolloffFactor=t,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(t){return this.panner.distanceModel=t,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(t){return this.panner.maxDistance=t,this}setDirectionalCone(t,e,n){return this.panner.coneInnerAngle=t,this.panner.coneOuterAngle=e,this.panner.coneOuterGain=n,this}updateMatrixWorld(t){if(super.updateMatrixWorld(t),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(hE,dE,pE),fE.set(0,0,1).applyQuaternion(dE);const e=this.panner;if(e.positionX){const t=this.context.currentTime+this.listener.timeDelta;e.positionX.linearRampToValueAtTime(hE.x,t),e.positionY.linearRampToValueAtTime(hE.y,t),e.positionZ.linearRampToValueAtTime(hE.z,t),e.orientationX.linearRampToValueAtTime(fE.x,t),e.orientationY.linearRampToValueAtTime(fE.y,t),e.orientationZ.linearRampToValueAtTime(fE.z,t)}else e.setPosition(hE.x,hE.y,hE.z),e.setOrientation(fE.x,fE.y,fE.z)}}class gE{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2048;this.analyser=t.context.createAnalyser(),this.analyser.fftSize=e,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let t=0;const e=this.getFrequencyData();for(let n=0;n<e.length;n++)t+=e[n];return t/e.length}}class yE{constructor(t,e,n){let r,i,o;switch(this.binding=t,this.valueSize=n,e){case"quaternion":r=this._slerp,i=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":r=this._select,i=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:r=this._lerp,i=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=i,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(t,e){const n=this.buffer,r=this.valueSize,i=t*r+r;let o=this.cumulativeWeight;if(0===o){for(let t=0;t!==r;++t)n[i+t]=n[t];o=e}else{o+=e;const t=e/o;this._mixBufferRegion(n,i,0,t,r)}this.cumulativeWeight=o}accumulateAdditive(t){const e=this.buffer,n=this.valueSize,r=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(e,r,0,t,n),this.cumulativeWeightAdditive+=t}apply(t){const e=this.valueSize,n=this.buffer,r=t*e+e,i=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,i<1){const t=e*this._origIndex;this._mixBufferRegion(n,r,t,1-i,e)}o>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*e,1,e);for(let s=e,l=e+e;s!==l;++s)if(n[s]!==n[s+e]){a.setValue(n,r);break}}saveOriginalState(){const t=this.binding,e=this.buffer,n=this.valueSize,r=n*this._origIndex;t.getValue(e,r);for(let i=n,o=r;i!==o;++i)e[i]=e[r+i%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const t=3*this.valueSize;this.binding.setValue(this.buffer,t)}_setAdditiveIdentityNumeric(){const t=this._addIndex*this.valueSize,e=t+this.valueSize;for(let n=t;n<e;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const t=this._origIndex*this.valueSize,e=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[e+n]=this.buffer[t+n]}_select(t,e,n,r,i){if(r>=.5)for(let o=0;o!==i;++o)t[e+o]=t[n+o]}_slerp(t,e,n,r){Qf.slerpFlat(t,e,t,e,t,n,r)}_slerpAdditive(t,e,n,r,i){const o=this._workIndex*i;Qf.multiplyQuaternionsFlat(t,o,t,e,t,n),Qf.slerpFlat(t,e,t,e,t,o,r)}_lerp(t,e,n,r,i){const o=1-r;for(let a=0;a!==i;++a){const i=e+a;t[i]=t[i]*o+t[n+a]*r}}_lerpAdditive(t,e,n,r,i){for(let o=0;o!==i;++o){const i=e+o;t[i]=t[i]+t[n+o]*r}}}const vE="\\[\\]\\.:\\/",bE=new RegExp("["+vE+"]","g"),xE="[^"+vE+"]",_E="[^"+vE.replace("\\.","")+"]",wE=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",xE)+/(WCOD+)?/.source.replace("WCOD",_E)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",xE)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",xE)+"$"),SE=["material","materials","bones","map"];class TE{constructor(t,e,n){this.path=e,this.parsedPath=n||TE.parseTrackName(e),this.node=TE.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,e,n){return t&&t.isAnimationObjectGroup?new TE.Composite(t,e,n):new TE(t,e,n)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(bE,"")}static parseTrackName(t){const e=wE.exec(t);if(null===e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const n={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){const t=n.nodeName.substring(r+1);-1!==SE.indexOf(t)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=t)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return n}static findNode(t,e){if(void 0===e||""===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){const n=t.skeleton.getBoneByName(e);if(void 0!==n)return n}if(t.children){const n=function(t){for(let r=0;r<t.length;r++){const i=t[r];if(i.name===e||i.uuid===e)return i;const o=n(i.children);if(o)return o}return null},r=n(t.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,e){t[e]=this.targetObject[this.propertyName]}_getValue_array(t,e){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)t[e++]=n[r]}_getValue_arrayElement(t,e){t[e]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,e){this.resolvedProperty.toArray(t,e)}_setValue_direct(t,e){this.targetObject[this.propertyName]=t[e]}_setValue_direct_setNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,e){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=t[e++]}_setValue_array_setNeedsUpdate(t,e){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,e){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,e){this.resolvedProperty[this.propertyIndex]=t[e]}_setValue_arrayElement_setNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,e){this.resolvedProperty.fromArray(t,e)}_setValue_fromArray_setNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,e){this.bind(),this.getValue(t,e)}_setValue_unbound(t,e){this.bind(),this.setValue(t,e)}bind(){let t=this.node;const e=this.parsedPath,n=e.objectName,r=e.propertyName;let i=e.propertyIndex;if(t||(t=TE.findNode(this.rootNode,e.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");if(n){let r=e.objectIndex;switch(n){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let e=0;e<t.length;e++)if(t[e].name===r){r=e;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);t=t.material.map;break;default:if(void 0===t[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[n]}if(void 0!==r){if(void 0===t[r])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[r]}}const o=t[r];if(void 0===o){const n=e.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+n+"."+r+" but it wasn't found.",t)}let a=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?a=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(a=this.Versioning.MatrixWorldNeedsUpdate);let s=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===r){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[i]&&(i=t.morphTargetDictionary[i])}s=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=i}else void 0!==o.fromArray&&void 0!==o.toArray?(s=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(s=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=r;this.getValue=this.GetterByBindingType[s],this.setValue=this.SetterByBindingTypeAndVersioning[s][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}TE.Composite=class{constructor(t,e,n){const r=n||TE.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,r)}getValue(t,e){this.bind();const n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(t,e)}setValue(t,e){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(t,e)}bind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()}unbind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}},TE.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},TE.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},TE.prototype.GetterByBindingType=[TE.prototype._getValue_direct,TE.prototype._getValue_array,TE.prototype._getValue_arrayElement,TE.prototype._getValue_toArray],TE.prototype.SetterByBindingTypeAndVersioning=[[TE.prototype._setValue_direct,TE.prototype._setValue_direct_setNeedsUpdate,TE.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[TE.prototype._setValue_array,TE.prototype._setValue_array_setNeedsUpdate,TE.prototype._setValue_array_setMatrixWorldNeedsUpdate],[TE.prototype._setValue_arrayElement,TE.prototype._setValue_arrayElement_setNeedsUpdate,TE.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[TE.prototype._setValue_fromArray,TE.prototype._setValue_fromArray_setNeedsUpdate,TE.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class EE{constructor(){this.isAnimationObjectGroup=!0,this.uuid=ff(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const t={};this._indicesByUUID=t;for(let n=0,r=arguments.length;n!==r;++n)t[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const e=this;this.stats={objects:{get total(){return e._objects.length},get inUse(){return this.total-e.nCachedObjects_}},get bindingsPerObject(){return e._bindings.length}}}add(){const t=this._objects,e=this._indicesByUUID,n=this._paths,r=this._parsedPaths,i=this._bindings,o=i.length;let a,s=t.length,l=this.nCachedObjects_;for(let c=0,u=arguments.length;c!==u;++c){const u=arguments[c],h=u.uuid;let d=e[h];if(void 0===d){d=s++,e[h]=d,t.push(u);for(let t=0,e=o;t!==e;++t)i[t].push(new TE(u,n[t],r[t]))}else if(d<l){a=t[d];const s=--l,c=t[s];e[c.uuid]=d,t[d]=c,e[h]=s,t[s]=u;for(let t=0,e=o;t!==e;++t){const e=i[t],o=e[s];let a=e[d];e[d]=o,void 0===a&&(a=new TE(u,n[t],r[t])),e[s]=a}}else t[d]!==a&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=l}remove(){const t=this._objects,e=this._indicesByUUID,n=this._bindings,r=n.length;let i=this.nCachedObjects_;for(let o=0,a=arguments.length;o!==a;++o){const a=arguments[o],s=a.uuid,l=e[s];if(void 0!==l&&l>=i){const o=i++,c=t[o];e[c.uuid]=l,t[l]=c,e[s]=o,t[o]=a;for(let t=0,e=r;t!==e;++t){const e=n[t],r=e[o],i=e[l];e[l]=r,e[o]=i}}}this.nCachedObjects_=i}uncache(){const t=this._objects,e=this._indicesByUUID,n=this._bindings,r=n.length;let i=this.nCachedObjects_,o=t.length;for(let a=0,s=arguments.length;a!==s;++a){const s=arguments[a].uuid,l=e[s];if(void 0!==l)if(delete e[s],l<i){const a=--i,s=t[a],c=--o,u=t[c];e[s.uuid]=l,t[l]=s,e[u.uuid]=a,t[a]=u,t.pop();for(let t=0,e=r;t!==e;++t){const e=n[t],r=e[a],i=e[c];e[l]=r,e[a]=i,e.pop()}}else{const i=--o,a=t[i];i>0&&(e[a.uuid]=l),t[l]=a,t.pop();for(let t=0,e=r;t!==e;++t){const e=n[t];e[l]=e[i],e.pop()}}}this.nCachedObjects_=i}subscribe_(t,e){const n=this._bindingsIndicesByPath;let r=n[t];const i=this._bindings;if(void 0!==r)return i[r];const o=this._paths,a=this._parsedPaths,s=this._objects,l=s.length,c=this.nCachedObjects_,u=new Array(l);r=i.length,n[t]=r,o.push(t),a.push(e),i.push(u);for(let h=c,d=s.length;h!==d;++h){const n=s[h];u[h]=new TE(n,t,e)}return u}unsubscribe_(t){const e=this._bindingsIndicesByPath,n=e[t];if(void 0!==n){const r=this._paths,i=this._parsedPaths,o=this._bindings,a=o.length-1,s=o[a];e[t[a]]=n,o[n]=s,o.pop(),i[n]=i[a],i.pop(),r[n]=r[a],r.pop()}}}class ME{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.blendMode;this._mixer=t,this._clip=e,this._localRoot=n,this.blendMode=r;const i=e.tracks,o=i.length,a=new Array(o),s={endingStart:ip,endingEnd:ip};for(let l=0;l!==o;++l){const t=i[l].createInterpolant(null);a[l]=t,t.settings=s}this._interpolantSettings=s,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=$d,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(t){return this._startTime=t,this}setLoop(t,e){return this.loop=t,this.repetitions=e,this}setEffectiveWeight(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(t){return this._scheduleFading(t,0,1)}fadeOut(t){return this._scheduleFading(t,1,0)}crossFadeFrom(t,e,n){if(t.fadeOut(e),this.fadeIn(e),n){const n=this._clip.duration,r=t._clip.duration,i=r/n,o=n/r;t.warp(1,i,e),this.warp(o,1,e)}return this}crossFadeTo(t,e,n){return t.crossFadeFrom(this,e,n)}stopFading(){const t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}setEffectiveTimeScale(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(t){return this.timeScale=this._clip.duration/t,this.stopWarping()}syncWith(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()}halt(t){return this.warp(this._effectiveTimeScale,0,t)}warp(t,e,n){const r=this._mixer,i=r.time,o=this.timeScale;let a=this._timeScaleInterpolant;null===a&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);const s=a.parameterPositions,l=a.sampleValues;return s[0]=i,s[1]=i+n,l[0]=t/o,l[1]=e/o,this}stopWarping(){const t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(t,e,n,r){if(!this.enabled)return void this._updateWeight(t);const i=this._startTime;if(null!==i){const r=(t-i)*n;r<0||0===n?e=0:(this._startTime=null,e=n*r)}e*=this._updateTimeScale(t);const o=this._updateTime(e),a=this._updateWeight(t);if(a>0){const t=this._interpolants,e=this._propertyBindings;if(this.blendMode===lp)for(let n=0,r=t.length;n!==r;++n)t[n].evaluate(o),e[n].accumulateAdditive(a);else for(let n=0,i=t.length;n!==i;++n)t[n].evaluate(o),e[n].accumulate(r,a)}}_updateWeight(t){let e=0;if(this.enabled){e=this.weight;const n=this._weightInterpolant;if(null!==n){const r=n.evaluate(t)[0];e*=r,t>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=e,e}_updateTimeScale(t){let e=0;if(!this.paused){e=this.timeScale;const n=this._timeScaleInterpolant;if(null!==n){e*=n.evaluate(t)[0],t>n.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e)}}return this._effectiveTimeScale=e,e}_updateTime(t){const e=this._clip.duration,n=this.loop;let r=this.time+t,i=this._loopCount;const o=n===tp;if(0===t)return-1===i?r:o&&1===(1&i)?e-r:r;if(n===Qd){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(r>=e)r=e;else{if(!(r<0)){this.time=r;break t}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(-1===i&&(t>=0?(i=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),r>=e||r<0){const n=Math.floor(r/e);r-=e*n,i+=Math.abs(n);const a=this.repetitions-i;if(a<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=t>0?e:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(1===a){const e=t<0;this._setEndings(e,!e,o)}else this._setEndings(!1,!1,o);this._loopCount=i,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:n})}}else this.time=r;if(o&&1===(1&i))return e-r}return r}_setEndings(t,e,n){const r=this._interpolantSettings;n?(r.endingStart=op,r.endingEnd=op):(r.endingStart=t?this.zeroSlopeAtStart?op:ip:ap,r.endingEnd=e?this.zeroSlopeAtEnd?op:ip:ap)}_scheduleFading(t,e,n){const r=this._mixer,i=r.time;let o=this._weightInterpolant;null===o&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,s=o.sampleValues;return a[0]=i,s[0]=e,a[1]=i+t,s[1]=n,this}}const CE=new Float32Array(1);class AE extends cf{constructor(t){super(),this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(t,e){const n=t._localRoot||this._root,r=t._clip.tracks,i=r.length,o=t._propertyBindings,a=t._interpolants,s=n.uuid,l=this._bindingsByRootAndName;let c=l[s];void 0===c&&(c={},l[s]=c);for(let u=0;u!==i;++u){const t=r[u],i=t.name;let l=c[i];if(void 0!==l)++l.referenceCount,o[u]=l;else{if(l=o[u],void 0!==l){null===l._cacheIndex&&(++l.referenceCount,this._addInactiveBinding(l,s,i));continue}const r=e&&e._propertyBindings[u].binding.parsedPath;l=new yE(TE.create(n,i,r),t.ValueTypeName,t.getValueSize()),++l.referenceCount,this._addInactiveBinding(l,s,i),o[u]=l}a[u].resultBuffer=l.buffer}}_activateAction(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){const e=(t._localRoot||this._root).uuid,n=t._clip.uuid,r=this._actionsByClip[n];this._bindAction(t,r&&r.knownActions[0]),this._addInactiveAction(t,n,e)}const e=t._propertyBindings;for(let t=0,n=e.length;t!==n;++t){const n=e[t];0===n.useCount++&&(this._lendBinding(n),n.saveOriginalState())}this._lendAction(t)}}_deactivateAction(t){if(this._isActiveAction(t)){const e=t._propertyBindings;for(let t=0,n=e.length;t!==n;++t){const n=e[t];0===--n.useCount&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(t)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}}_isActiveAction(t){const e=t._cacheIndex;return null!==e&&e<this._nActiveActions}_addInactiveAction(t,e,n){const r=this._actions,i=this._actionsByClip;let o=i[e];if(void 0===o)o={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,i[e]=o;else{const e=o.knownActions;t._byClipCacheIndex=e.length,e.push(t)}t._cacheIndex=r.length,r.push(t),o.actionByRoot[n]=t}_removeInactiveAction(t){const e=this._actions,n=e[e.length-1],r=t._cacheIndex;n._cacheIndex=r,e[r]=n,e.pop(),t._cacheIndex=null;const i=t._clip.uuid,o=this._actionsByClip,a=o[i],s=a.knownActions,l=s[s.length-1],c=t._byClipCacheIndex;l._byClipCacheIndex=c,s[c]=l,s.pop(),t._byClipCacheIndex=null;delete a.actionByRoot[(t._localRoot||this._root).uuid],0===s.length&&delete o[i],this._removeInactiveBindingsForAction(t)}_removeInactiveBindingsForAction(t){const e=t._propertyBindings;for(let n=0,r=e.length;n!==r;++n){const t=e[n];0===--t.referenceCount&&this._removeInactiveBinding(t)}}_lendAction(t){const e=this._actions,n=t._cacheIndex,r=this._nActiveActions++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i}_takeBackAction(t){const e=this._actions,n=t._cacheIndex,r=--this._nActiveActions,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i}_addInactiveBinding(t,e,n){const r=this._bindingsByRootAndName,i=this._bindings;let o=r[e];void 0===o&&(o={},r[e]=o),o[n]=t,t._cacheIndex=i.length,i.push(t)}_removeInactiveBinding(t){const e=this._bindings,n=t.binding,r=n.rootNode.uuid,i=n.path,o=this._bindingsByRootAndName,a=o[r],s=e[e.length-1],l=t._cacheIndex;s._cacheIndex=l,e[l]=s,e.pop(),delete a[i],0===Object.keys(a).length&&delete o[r]}_lendBinding(t){const e=this._bindings,n=t._cacheIndex,r=this._nActiveBindings++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i}_takeBackBinding(t){const e=this._bindings,n=t._cacheIndex,r=--this._nActiveBindings,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i}_lendControlInterpolant(){const t=this._controlInterpolants,e=this._nActiveControlInterpolants++;let n=t[e];return void 0===n&&(n=new JS(new Float32Array(2),new Float32Array(2),1,CE),n.__cacheIndex=e,t[e]=n),n}_takeBackControlInterpolant(t){const e=this._controlInterpolants,n=t.__cacheIndex,r=--this._nActiveControlInterpolants,i=e[r];t.__cacheIndex=r,e[r]=t,i.__cacheIndex=n,e[n]=i}clipAction(t,e,n){const r=e||this._root,i=r.uuid;let o="string"===typeof t?sT.findByName(r,t):t;const a=null!==o?o.uuid:t,s=this._actionsByClip[a];let l=null;if(void 0===n&&(n=null!==o?o.blendMode:sp),void 0!==s){const t=s.actionByRoot[i];if(void 0!==t&&t.blendMode===n)return t;l=s.knownActions[0],null===o&&(o=l._clip)}if(null===o)return null;const c=new ME(this,o,e,n);return this._bindAction(c,l),this._addInactiveAction(c,a,i),c}existingAction(t,e){const n=e||this._root,r=n.uuid,i="string"===typeof t?sT.findByName(n,t):t,o=i?i.uuid:t,a=this._actionsByClip[o];return void 0!==a&&a.actionByRoot[r]||null}stopAllAction(){const t=this._actions;for(let e=this._nActiveActions-1;e>=0;--e)t[e].stop();return this}update(t){t*=this.timeScale;const e=this._actions,n=this._nActiveActions,r=this.time+=t,i=Math.sign(t),o=this._accuIndex^=1;for(let l=0;l!==n;++l){e[l]._update(r,t,i,o)}const a=this._bindings,s=this._nActiveBindings;for(let l=0;l!==s;++l)a[l].apply(o);return this}setTime(t){this.time=0;for(let e=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(t)}getRoot(){return this._root}uncacheClip(t){const e=this._actions,n=t.uuid,r=this._actionsByClip,i=r[n];if(void 0!==i){const t=i.knownActions;for(let n=0,r=t.length;n!==r;++n){const r=t[n];this._deactivateAction(r);const i=r._cacheIndex,o=e[e.length-1];r._cacheIndex=null,r._byClipCacheIndex=null,o._cacheIndex=i,e[i]=o,e.pop(),this._removeInactiveBindingsForAction(r)}delete r[n]}}uncacheRoot(t){const e=t.uuid,n=this._actionsByClip;for(const i in n){const t=n[i].actionByRoot[e];void 0!==t&&(this._deactivateAction(t),this._removeInactiveAction(t))}const r=this._bindingsByRootAndName[e];if(void 0!==r)for(const i in r){const t=r[i];t.restoreOriginalState(),this._removeInactiveBinding(t)}}uncacheAction(t,e){const n=this.existingAction(t,e);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}class kE{constructor(t){this.value=t}clone(){return new kE(void 0===this.value.clone?this.value:this.value.clone())}}let IE=0;class RE extends cf{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:IE++}),this.name="",this.usage=Kp,this.uniforms=[]}add(t){return this.uniforms.push(t),this}remove(t){const e=this.uniforms.indexOf(t);return-1!==e&&this.uniforms.splice(e,1),this}setName(t){return this.name=t,this}setUsage(t){return this.usage=t,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(t){this.name=t.name,this.usage=t.usage;const e=t.uniforms;this.uniforms.length=0;for(let n=0,r=e.length;n<r;n++){const t=Array.isArray(e[n])?e[n]:[e[n]];for(let e=0;e<t.length;e++)this.uniforms.push(t[e].clone())}return this}clone(){return(new this.constructor).copy(this)}}class PE extends Ex{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;super(t,e),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}clone(t){const e=super.clone(t);return e.meshPerAttribute=this.meshPerAttribute,e}toJSON(t){const e=super.toJSON(t);return e.isInstancedInterleavedBuffer=!0,e.meshPerAttribute=this.meshPerAttribute,e}}class NE{constructor(t,e,n,r,i){this.isGLBufferAttribute=!0,this.name="",this.buffer=t,this.type=e,this.itemSize=n,this.elementSize=r,this.count=i,this.version=0}set needsUpdate(t){!0===t&&this.version++}setBuffer(t){return this.buffer=t,this}setType(t,e){return this.type=t,this.elementSize=e,this}setItemSize(t){return this.itemSize=t,this}setCount(t){return this.count=t,this}}const OE=new km;class DE{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;this.ray=new Am(t,e),this.near=n,this.far=r,this.camera=null,this.layers=new zm,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(t,e){this.ray.set(t,e)}setFromCamera(t,e){e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e):console.error("THREE.Raycaster: Unsupported camera type: "+e.type)}setFromXRController(t){return OE.identity().extractRotation(t.matrixWorld),this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(OE),this}intersectObject(t){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return FE(t,this,e,!(arguments.length>1&&void 0!==arguments[1])||arguments[1]),e.sort(LE),e}intersectObjects(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];for(let r=0,i=t.length;r<i;r++)FE(t[r],this,n,e);return n.sort(LE),n}}function LE(t,e){return t.distance-e.distance}function FE(t,e,n,r){let i=!0;if(t.layers.test(e.layers)){!1===t.raycast(e,n)&&(i=!1)}if(!0===i&&!0===r){const r=t.children;for(let t=0,i=r.length;t<i;t++)FE(r[t],e,n,!0)}}class UE{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.radius=t,this.phi=e,this.theta=n,this}set(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this}copy(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this}makeSafe(){const t=1e-6;return this.phi=Math.max(t,Math.min(Math.PI-t,this.phi)),this}setFromVector3(t){return this.setFromCartesianCoords(t.x,t.y,t.z)}setFromCartesianCoords(t,e,n){return this.radius=Math.sqrt(t*t+e*e+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,n),this.phi=Math.acos(mf(e/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}class BE{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.radius=t,this.theta=e,this.y=n,this}set(t,e,n){return this.radius=t,this.theta=e,this.y=n,this}copy(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this}setFromVector3(t){return this.setFromCartesianCoords(t.x,t.y,t.z)}setFromCartesianCoords(t,e,n){return this.radius=Math.sqrt(t*t+n*n),this.theta=Math.atan2(t,n),this.y=e,this}clone(){return(new this.constructor).copy(this)}}const zE=new _f;class jE{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new _f(1/0,1/0),e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new _f(-1/0,-1/0);this.isBox2=!0,this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const n=zE.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(t){return this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return this.clampPoint(t,zE).distanceTo(t)}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}const VE=new $f,WE=new $f;class GE{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new $f,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new $f;this.start=t,this.end=e}set(t,e){return this.start.copy(t),this.end.copy(e),this}copy(t){return this.start.copy(t.start),this.end.copy(t.end),this}getCenter(t){return t.addVectors(this.start,this.end).multiplyScalar(.5)}delta(t){return t.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(t,e){return this.delta(e).multiplyScalar(t).add(this.start)}closestPointToPointParameter(t,e){VE.subVectors(t,this.start),WE.subVectors(this.end,this.start);const n=WE.dot(WE);let r=WE.dot(VE)/n;return e&&(r=mf(r,0,1)),r}closestPointToPoint(t,e,n){const r=this.closestPointToPointParameter(t,e);return this.delta(n).multiplyScalar(r).add(this.start)}applyMatrix4(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this}equals(t){return t.start.equals(this.start)&&t.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}}const HE=new $f;class qE extends ng{constructor(t,e){super(),this.light=t,this.matrixAutoUpdate=!1,this.color=e,this.type="SpotLightHelper";const n=new Xg,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,a=1,s=32;o<s;o++,a++){const t=o/s*Math.PI*2,e=a/s*Math.PI*2;r.push(Math.cos(t),Math.sin(t),1,Math.cos(e),Math.sin(e),1)}n.setAttribute("position",new Bg(r,3));const i=new F_({fog:!1,toneMapped:!1});this.cone=new K_(n,i),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const t=this.light.distance?this.light.distance:1e3,e=t*Math.tan(this.light.angle);this.cone.scale.set(e,e,t),HE.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(HE),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const XE=new $f,YE=new km,KE=new km;class ZE extends K_{constructor(t){const e=JE(t),n=new Xg,r=[],i=[],o=new vg(0,0,1),a=new vg(0,1,0);for(let s=0;s<e.length;s++){const t=e[s];t.parent&&t.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),i.push(o.r,o.g,o.b),i.push(a.r,a.g,a.b))}n.setAttribute("position",new Bg(r,3)),n.setAttribute("color",new Bg(i,3));super(n,new F_({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=t,this.bones=e,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(t){const e=this.bones,n=this.geometry,r=n.getAttribute("position");KE.copy(this.root.matrixWorld).invert();for(let i=0,o=0;i<e.length;i++){const t=e[i];t.parent&&t.parent.isBone&&(YE.multiplyMatrices(KE,t.matrixWorld),XE.setFromMatrixPosition(YE),r.setXYZ(o,XE.x,XE.y,XE.z),YE.multiplyMatrices(KE,t.parent.matrixWorld),XE.setFromMatrixPosition(YE),r.setXYZ(o+1,XE.x,XE.y,XE.z),o+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(t)}dispose(){this.geometry.dispose(),this.material.dispose()}}function JE(t){const e=[];!0===t.isBone&&e.push(t);for(let n=0;n<t.children.length;n++)e.push.apply(e,JE(t.children[n]));return e}class QE extends hy{constructor(t,e,n){super(new ES(e,4,2),new wg({wireframe:!0,fog:!1,toneMapped:!1})),this.light=t,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const $E=new $f,tM=new vg,eM=new vg;class nM extends ng{constructor(t,e,n){super(),this.light=t,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";const r=new wS(e);r.rotateY(.5*Math.PI),this.material=new wg({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);const i=r.getAttribute("position"),o=new Float32Array(3*i.count);r.setAttribute("color",new Ig(o,3)),this.add(new hy(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const t=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{const e=t.geometry.getAttribute("color");tM.copy(this.light.color),eM.copy(this.light.groundColor);for(let t=0,n=e.count;t<n;t++){const r=t<n/2?tM:eM;e.setXYZ(t,r.r,r.g,r.b)}e.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),t.lookAt($E.setFromMatrixPosition(this.light.matrixWorld).negate())}}class rM extends K_{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4473924,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8947848;n=new vg(n),r=new vg(r);const i=e/2,o=t/e,a=t/2,s=[],l=[];for(let u=0,h=0,d=-a;u<=e;u++,d+=o){s.push(-a,0,d,a,0,d),s.push(d,0,-a,d,0,a);const t=u===i?n:r;t.toArray(l,h),h+=3,t.toArray(l,h),h+=3,t.toArray(l,h),h+=3,t.toArray(l,h),h+=3}const c=new Xg;c.setAttribute("position",new Bg(s,3)),c.setAttribute("color",new Bg(l,3));super(c,new F_({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class iM extends K_{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:64,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:4473924,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:8947848;i=new vg(i),o=new vg(o);const a=[],s=[];if(e>1)for(let c=0;c<e;c++){const n=c/e*(2*Math.PI),r=Math.sin(n)*t,l=Math.cos(n)*t;a.push(0,0,0),a.push(r,0,l);const u=1&c?i:o;s.push(u.r,u.g,u.b),s.push(u.r,u.g,u.b)}for(let c=0;c<n;c++){const e=1&c?i:o,l=t-t/n*c;for(let t=0;t<r;t++){let n=t/r*(2*Math.PI),i=Math.sin(n)*l,o=Math.cos(n)*l;a.push(i,0,o),s.push(e.r,e.g,e.b),n=(t+1)/r*(2*Math.PI),i=Math.sin(n)*l,o=Math.cos(n)*l,a.push(i,0,o),s.push(e.r,e.g,e.b)}}const l=new Xg;l.setAttribute("position",new Bg(a,3)),l.setAttribute("color",new Bg(s,3));super(l,new F_({vertexColors:!0,toneMapped:!1})),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const oM=new $f,aM=new $f,sM=new $f;class lM extends ng{constructor(t,e,n){super(),this.light=t,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",void 0===e&&(e=1);let r=new Xg;r.setAttribute("position",new Bg([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3));const i=new F_({fog:!1,toneMapped:!1});this.lightPlane=new H_(r,i),this.add(this.lightPlane),r=new Xg,r.setAttribute("position",new Bg([0,0,0,0,0,1],3)),this.targetLine=new H_(r,i),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),oM.setFromMatrixPosition(this.light.matrixWorld),aM.setFromMatrixPosition(this.light.target.matrixWorld),sM.subVectors(aM,oM),this.lightPlane.lookAt(aM),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(aM),this.targetLine.scale.z=sM.length()}}const cM=new $f,uM=new by;class hM extends K_{constructor(t){const e=new Xg,n=new F_({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],i=[],o={};function a(t,e){s(t),s(e)}function s(t){r.push(0,0,0),i.push(0,0,0),void 0===o[t]&&(o[t]=[]),o[t].push(r.length/3-1)}a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4"),e.setAttribute("position",new Bg(r,3)),e.setAttribute("color",new Bg(i,3)),super(e,n),this.type="CameraHelper",this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();const l=new vg(16755200),c=new vg(16711680),u=new vg(43775),h=new vg(16777215),d=new vg(3355443);this.setColors(l,c,u,h,d)}setColors(t,e,n,r,i){const o=this.geometry.getAttribute("color");o.setXYZ(0,t.r,t.g,t.b),o.setXYZ(1,t.r,t.g,t.b),o.setXYZ(2,t.r,t.g,t.b),o.setXYZ(3,t.r,t.g,t.b),o.setXYZ(4,t.r,t.g,t.b),o.setXYZ(5,t.r,t.g,t.b),o.setXYZ(6,t.r,t.g,t.b),o.setXYZ(7,t.r,t.g,t.b),o.setXYZ(8,t.r,t.g,t.b),o.setXYZ(9,t.r,t.g,t.b),o.setXYZ(10,t.r,t.g,t.b),o.setXYZ(11,t.r,t.g,t.b),o.setXYZ(12,t.r,t.g,t.b),o.setXYZ(13,t.r,t.g,t.b),o.setXYZ(14,t.r,t.g,t.b),o.setXYZ(15,t.r,t.g,t.b),o.setXYZ(16,t.r,t.g,t.b),o.setXYZ(17,t.r,t.g,t.b),o.setXYZ(18,t.r,t.g,t.b),o.setXYZ(19,t.r,t.g,t.b),o.setXYZ(20,t.r,t.g,t.b),o.setXYZ(21,t.r,t.g,t.b),o.setXYZ(22,t.r,t.g,t.b),o.setXYZ(23,t.r,t.g,t.b),o.setXYZ(24,e.r,e.g,e.b),o.setXYZ(25,e.r,e.g,e.b),o.setXYZ(26,e.r,e.g,e.b),o.setXYZ(27,e.r,e.g,e.b),o.setXYZ(28,e.r,e.g,e.b),o.setXYZ(29,e.r,e.g,e.b),o.setXYZ(30,e.r,e.g,e.b),o.setXYZ(31,e.r,e.g,e.b),o.setXYZ(32,n.r,n.g,n.b),o.setXYZ(33,n.r,n.g,n.b),o.setXYZ(34,n.r,n.g,n.b),o.setXYZ(35,n.r,n.g,n.b),o.setXYZ(36,n.r,n.g,n.b),o.setXYZ(37,n.r,n.g,n.b),o.setXYZ(38,r.r,r.g,r.b),o.setXYZ(39,r.r,r.g,r.b),o.setXYZ(40,i.r,i.g,i.b),o.setXYZ(41,i.r,i.g,i.b),o.setXYZ(42,i.r,i.g,i.b),o.setXYZ(43,i.r,i.g,i.b),o.setXYZ(44,i.r,i.g,i.b),o.setXYZ(45,i.r,i.g,i.b),o.setXYZ(46,i.r,i.g,i.b),o.setXYZ(47,i.r,i.g,i.b),o.setXYZ(48,i.r,i.g,i.b),o.setXYZ(49,i.r,i.g,i.b),o.needsUpdate=!0}update(){const t=this.geometry,e=this.pointMap;uM.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),dM("c",e,t,uM,0,0,-1),dM("t",e,t,uM,0,0,1),dM("n1",e,t,uM,-1,-1,-1),dM("n2",e,t,uM,1,-1,-1),dM("n3",e,t,uM,-1,1,-1),dM("n4",e,t,uM,1,1,-1),dM("f1",e,t,uM,-1,-1,1),dM("f2",e,t,uM,1,-1,1),dM("f3",e,t,uM,-1,1,1),dM("f4",e,t,uM,1,1,1),dM("u1",e,t,uM,.7,1.1,-1),dM("u2",e,t,uM,-.7,1.1,-1),dM("u3",e,t,uM,0,2,-1),dM("cf1",e,t,uM,-1,0,1),dM("cf2",e,t,uM,1,0,1),dM("cf3",e,t,uM,0,-1,1),dM("cf4",e,t,uM,0,1,1),dM("cn1",e,t,uM,-1,0,-1),dM("cn2",e,t,uM,1,0,-1),dM("cn3",e,t,uM,0,-1,-1),dM("cn4",e,t,uM,0,1,-1),t.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function dM(t,e,n,r,i,o,a){cM.set(i,o,a).unproject(r);const s=e[t];if(void 0!==s){const t=n.getAttribute("position");for(let e=0,n=s.length;e<n;e++)t.setXYZ(s[e],cM.x,cM.y,cM.z)}}const pM=new nm;class fM extends K_{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16776960;const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),i=new Xg;i.setIndex(new Ig(n,1)),i.setAttribute("position",new Ig(r,3)),super(i,new F_({color:e,toneMapped:!1})),this.object=t,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(t){if(void 0!==t&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&pM.setFromObject(this.object),pM.isEmpty())return;const e=pM.min,n=pM.max,r=this.geometry.attributes.position,i=r.array;i[0]=n.x,i[1]=n.y,i[2]=n.z,i[3]=e.x,i[4]=n.y,i[5]=n.z,i[6]=e.x,i[7]=e.y,i[8]=n.z,i[9]=n.x,i[10]=e.y,i[11]=n.z,i[12]=n.x,i[13]=n.y,i[14]=e.z,i[15]=e.x,i[16]=n.y,i[17]=e.z,i[18]=e.x,i[19]=e.y,i[20]=e.z,i[21]=n.x,i[22]=e.y,i[23]=e.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(t){return this.object=t,this.update(),this}copy(t,e){return super.copy(t,e),this.object=t.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class mM extends K_{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16776960;const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Xg;r.setIndex(new Ig(n,1)),r.setAttribute("position",new Bg([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(r,new F_({color:e,toneMapped:!1})),this.box=t,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(t){const e=this.box;e.isEmpty()||(e.getCenter(this.position),e.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(t))}dispose(){this.geometry.dispose(),this.material.dispose()}}class gM extends H_{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16776960,r=new Xg;r.setAttribute("position",new Bg([1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3)),r.computeBoundingSphere(),super(r,new F_({color:n,toneMapped:!1})),this.type="PlaneHelper",this.plane=t,this.size=e;const i=new Xg;i.setAttribute("position",new Bg([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3)),i.computeBoundingSphere(),this.add(new hy(i,new wg({color:n,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(t){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(t)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const yM=new $f;let vM,bM;class xM extends ng{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new $f(0,0,1),e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new $f(0,0,0),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16776960,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.2*n,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.2*i;super(),this.type="ArrowHelper",void 0===vM&&(vM=new Xg,vM.setAttribute("position",new Bg([0,0,0,0,1,0],3)),bM=new Dw(0,.5,1,5,1),bM.translate(0,-.5,0)),this.position.copy(e),this.line=new H_(vM,new F_({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new hy(bM,new wg({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(n,i,o)}setDirection(t){if(t.y>.99999)this.quaternion.set(0,0,0,1);else if(t.y<-.99999)this.quaternion.set(1,0,0,0);else{yM.set(t.z,0,-t.x).normalize();const e=Math.acos(t.y);this.quaternion.setFromAxisAngle(yM,e)}}setLength(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2*t,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.2*e;this.line.scale.set(1,Math.max(1e-4,t-e),1),this.line.updateMatrix(),this.cone.scale.set(n,e,n),this.cone.position.y=t,this.cone.updateMatrix()}setColor(t){this.line.material.color.set(t),this.cone.material.color.set(t)}copy(t){return super.copy(t,!1),this.line.copy(t.line),this.cone.copy(t.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class _M extends K_{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;const e=[0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t],n=new Xg;n.setAttribute("position",new Bg(e,3)),n.setAttribute("color",new Bg([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));super(n,new F_({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(t,e,n){const r=new vg,i=this.geometry.attributes.color.array;return r.set(t),r.toArray(i,0),r.toArray(i,3),r.set(e),r.toArray(i,6),r.toArray(i,9),r.set(n),r.toArray(i,12),r.toArray(i,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class wM{constructor(){this.type="ShapePath",this.color=new vg,this.subPaths=[],this.currentPath=null}moveTo(t,e){return this.currentPath=new Rw,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e),this}lineTo(t,e){return this.currentPath.lineTo(t,e),this}quadraticCurveTo(t,e,n,r){return this.currentPath.quadraticCurveTo(t,e,n,r),this}bezierCurveTo(t,e,n,r,i,o){return this.currentPath.bezierCurveTo(t,e,n,r,i,o),this}splineThru(t){return this.currentPath.splineThru(t),this}toShapes(t){function e(t,e){const n=e.length;let r=!1;for(let i=n-1,o=0;o<n;i=o++){let n=e[i],a=e[o],s=a.x-n.x,l=a.y-n.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(n=e[o],s=-s,a=e[i],l=-l),t.y<n.y||t.y>a.y)continue;if(t.y===n.y){if(t.x===n.x)return!0}else{const e=l*(t.x-n.x)-s*(t.y-n.y);if(0===e)return!0;if(e<0)continue;r=!r}}else{if(t.y!==n.y)continue;if(a.x<=t.x&&t.x<=n.x||n.x<=t.x&&t.x<=a.x)return!0}}return r}const n=gS.isClockWise,r=this.subPaths;if(0===r.length)return[];let i,o,a;const s=[];if(1===r.length)return o=r[0],a=new Gw,a.curves=o.curves,s.push(a),s;let l=!n(r[0].getPoints());l=t?!l:l;const c=[],u=[];let h,d,p=[],f=0;u[f]=void 0,p[f]=[];for(let m=0,g=r.length;m<g;m++)o=r[m],h=o.getPoints(),i=n(h),i=t?!i:i,i?(!l&&u[f]&&f++,u[f]={s:new Gw,p:h},u[f].s.curves=o.curves,l&&f++,p[f]=[]):p[f].push({h:o,p:h[0]});if(!u[0])return function(t){const e=[];for(let n=0,r=t.length;n<r;n++){const r=t[n],i=new Gw;i.curves=r.curves,e.push(i)}return e}(r);if(u.length>1){let t=!1,n=0;for(let e=0,r=u.length;e<r;e++)c[e]=[];for(let r=0,i=u.length;r<i;r++){const i=p[r];for(let o=0;o<i.length;o++){const a=i[o];let s=!0;for(let i=0;i<u.length;i++)e(a.p,u[i].p)&&(r!==i&&n++,s?(s=!1,c[i].push(a)):t=!0);s&&c[r].push(a)}}n>0&&!1===t&&(p=c)}for(let m=0,g=u.length;m<g;m++){a=u[m].s,s.push(a),d=p[m];for(let t=0,e=d.length;t<e;t++)a.holes.push(d[t].h)}return s}}class SM extends Xf{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};console.warn('THREE.WebGLMultipleRenderTargets has been deprecated and will be removed in r172. Use THREE.WebGLRenderTarget and set the "count" parameter to enable MRT.'),super(t,e,{...r,count:n}),this.isWebGLMultipleRenderTargets=!0}get texture(){return this.textures}}"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Tu}})),"undefined"!==typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Tu);var TM=__webpack_require__(205);function EM(t){let e;const n=new Set,r=(t,r)=>{const i="function"===typeof t?t(e):t;if(i!==e){const t=e;e=r?i:Object.assign({},e,i),n.forEach((n=>n(e,t)))}},i=()=>e,o={setState:r,getState:i,subscribe:(t,r,o)=>r||o?function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object.is;console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let a=r(e);function s(){const n=r(e);if(!o(a,n)){const e=a;t(a=n,e)}}return n.add(s),()=>n.delete(s)}(t,r,o):(n.add(t),()=>n.delete(t)),destroy:()=>n.clear()};return e=t(r,i,o),o}const MM="undefined"===typeof window||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent)?k.useEffect:k.useLayoutEffect;function CM(t){const e="function"===typeof t?EM(t):t,n=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.getState,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object.is;const[,r]=(0,k.useReducer)((t=>t+1),0),i=e.getState(),o=(0,k.useRef)(i),a=(0,k.useRef)(t),s=(0,k.useRef)(n),l=(0,k.useRef)(!1),c=(0,k.useRef)();let u;void 0===c.current&&(c.current=t(i));let h=!1;(o.current!==i||a.current!==t||s.current!==n||l.current)&&(u=t(i),h=!n(c.current,u)),MM((()=>{h&&(c.current=u),o.current=i,a.current=t,s.current=n,l.current=!1}));const d=(0,k.useRef)(i);MM((()=>{const t=()=>{try{const t=e.getState(),n=a.current(t);s.current(c.current,n)||(o.current=t,c.current=n,r())}catch(oA){l.current=!0,r()}},n=e.subscribe(t);return e.getState()!==d.current&&t(),n}),[]);const p=h?u:c.current;return(0,k.useDebugValue)(p),p};return Object.assign(n,e),n[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const t=[n,e];return{next(){const e=t.length<=0;return{value:t.shift(),done:e}}}},n}var AM=__webpack_require__(16),kM=__webpack_require__.n(AM),IM=__webpack_require__(853);const RM=[];function PM(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(t,e)=>t===e;if(t===e)return!0;if(!t||!e)return!1;const r=t.length;if(e.length!==r)return!1;for(let i=0;i<r;i++)if(!n(t[i],e[i]))return!1;return!0}function NM(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};null===e&&(e=[t]);for(const a of RM)if(PM(e,a.keys,a.equal)){if(n)return;if(Object.prototype.hasOwnProperty.call(a,"error"))throw a.error;if(Object.prototype.hasOwnProperty.call(a,"response"))return r.lifespan&&r.lifespan>0&&(a.timeout&&clearTimeout(a.timeout),a.timeout=setTimeout(a.remove,r.lifespan)),a.response;if(!n)throw a.promise}const i={keys:e,equal:r.equal,remove:()=>{const t=RM.indexOf(i);-1!==t&&RM.splice(t,1)},promise:(o=t,"object"===typeof o&&"function"===typeof o.then?t:t(...e)).then((t=>{i.response=t,r.lifespan&&r.lifespan>0&&(i.timeout=setTimeout(i.remove,r.lifespan))})).catch((t=>i.error=t))};var o;if(RM.push(i),!n)throw i.promise}const OM=(t,e,n)=>NM(t,e,!1,n);const DM={};var LM,FM;const UM=t=>"colorSpace"in t||"outputColorSpace"in t,BM=()=>{var t;return null!=(t=DM.ColorManagement)?t:null},zM=t=>t&&t.isOrthographicCamera,jM="undefined"!==typeof window&&(null!=(LM=window.document)&&LM.createElement||"ReactNative"===(null==(FM=window.navigator)?void 0:FM.product))?k.useLayoutEffect:k.useEffect;function VM(t){const e=k.useRef(t);return jM((()=>{e.current=t}),[t]),e}function WM(t){let{set:e}=t;return jM((()=>(e(new Promise((()=>null))),()=>e(!1))),[e]),null}class GM extends k.Component{constructor(){super(...arguments),this.state={error:!1}}componentDidCatch(t){this.props.set(t)}render(){return this.state.error?null:this.props.children}}GM.getDerivedStateFromError=()=>({error:!0});const HM="__default",qM=new Map,XM=t=>t&&!!t.memoized&&!!t.changes;function YM(t){var e;const n="undefined"!==typeof window?null!=(e=window.devicePixelRatio)?e:2:1;return Array.isArray(t)?Math.min(Math.max(t[0],n),t[1]):t}const KM=t=>{var e;return null==(e=t.__r3f)?void 0:e.root.getState()};function ZM(t){let e=t.__r3f.root;for(;e.getState().previousRoot;)e=e.getState().previousRoot;return e}const JM={obj:t=>t===Object(t)&&!JM.arr(t)&&"function"!==typeof t,fun:t=>"function"===typeof t,str:t=>"string"===typeof t,num:t=>"number"===typeof t,boo:t=>"boolean"===typeof t,und:t=>void 0===t,arr:t=>Array.isArray(t),equ(t,e){let{arrays:n="shallow",objects:r="reference",strict:i=!0}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(typeof t!==typeof e||!!t!==!!e)return!1;if(JM.str(t)||JM.num(t)||JM.boo(t))return t===e;const o=JM.obj(t);if(o&&"reference"===r)return t===e;const a=JM.arr(t);if(a&&"reference"===n)return t===e;if((a||o)&&t===e)return!0;let s;for(s in t)if(!(s in e))return!1;if(o&&"shallow"===n&&"shallow"===r){for(s in i?e:t)if(!JM.equ(t[s],e[s],{strict:i,objects:"reference"}))return!1}else for(s in i?e:t)if(t[s]!==e[s])return!1;if(JM.und(s)){if(a&&0===t.length&&0===e.length)return!0;if(o&&0===Object.keys(t).length&&0===Object.keys(e).length)return!0;if(t!==e)return!1}return!0}};function QM(t){const e={nodes:{},materials:{}};return t&&t.traverse((t=>{t.name&&(e.nodes[t.name]=t),t.material&&!e.materials[t.material.name]&&(e.materials[t.material.name]=t.material)})),e}function $M(t,e){return t.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...e},t}function tC(t,e){let n=t;if(e.includes("-")){const r=e.split("-"),i=r.pop();return n=r.reduce(((t,e)=>t[e]),t),{target:n,key:i}}return{target:n,key:e}}const eC=/-\d+$/;function nC(t,e,n){if(JM.str(n)){if(eC.test(n)){const e=n.replace(eC,""),{target:r,key:i}=tC(t,e);Array.isArray(r[i])||(r[i]=[])}const{target:r,key:i}=tC(t,n);e.__r3f.previousAttach=r[i],r[i]=e}else e.__r3f.previousAttach=n(t,e)}function rC(t,e,n){var r,i;if(JM.str(n)){const{target:r,key:i}=tC(t,n),o=e.__r3f.previousAttach;void 0===o?delete r[i]:r[i]=o}else null==(r=e.__r3f)||null==r.previousAttach||r.previousAttach(t,e);null==(i=e.__r3f)||delete i.previousAttach}function iC(t,e){let{children:n,key:r,ref:i,...o}=e,{children:a,key:s,ref:l,...c}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const h=t.__r3f,d=Object.entries(o),p=[];if(u){const t=Object.keys(c);for(let e=0;e<t.length;e++)o.hasOwnProperty(t[e])||d.unshift([t[e],HM+"remove"])}d.forEach((e=>{let[n,r]=e;var i;if(null!=(i=t.__r3f)&&i.primitive&&"object"===n)return;if(JM.equ(r,c[n]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(n))return p.push([n,r,!0,[]]);let a=[];n.includes("-")&&(a=n.split("-")),p.push([n,r,!1,a]);for(const t in o){const e=o[t];t.startsWith("".concat(n,"-"))&&p.push([t,e,!1,t.split("-")])}}));const f={...o};return null!=h&&h.memoizedProps&&null!=h&&h.memoizedProps.args&&(f.args=h.memoizedProps.args),null!=h&&h.memoizedProps&&null!=h&&h.memoizedProps.attach&&(f.attach=h.memoizedProps.attach),{memoized:f,changes:p}}const oC="undefined"!==typeof process&&!1;function aC(t,e){var n;const r=t.__r3f,i=null==r?void 0:r.root,o=null==i||null==i.getState?void 0:i.getState(),{memoized:a,changes:s}=XM(e)?e:iC(t,e),l=null==r?void 0:r.eventCount;t.__r3f&&(t.__r3f.memoizedProps=a);for(let c=0;c<s.length;c++){let[e,n,i,a]=s[c];if(UM(t)){const t=3001,r="srgb",i="srgb-linear";"encoding"===e?(e="colorSpace",n=n===t?r:i):"outputEncoding"===e&&(e="outputColorSpace",n=n===t?r:i)}let l=t,u=l[e];if(a.length&&(u=a.reduce(((t,e)=>t[e]),t),!u||!u.set)){const[n,...r]=a.reverse();l=r.reverse().reduce(((t,e)=>t[e]),t),e=n}if(n===HM+"remove")if(l.constructor){let t=qM.get(l.constructor);t||(t=new l.constructor,qM.set(l.constructor,t)),n=t[e]}else n=0;if(i&&r)n?r.handlers[e]=n:delete r.handlers[e],r.eventCount=Object.keys(r.handlers).length;else if(u&&u.set&&(u.copy||u instanceof zm)){if(Array.isArray(n))u.fromArray?u.fromArray(n):u.set(...n);else if(u.copy&&n&&n.constructor&&(oC?u.constructor.name===n.constructor.name:u.constructor===n.constructor))u.copy(n);else if(void 0!==n){const t=u instanceof vg;!t&&u.setScalar?u.setScalar(n):u instanceof zm&&n instanceof zm?u.mask=n.mask:u.set(n),!BM()&&o&&!o.linear&&t&&u.convertSRGBToLinear()}}else if(l[e]=n,l[e]instanceof Gf&&l[e].format===ud&&l[e].type===Zh&&o){const t=l[e];UM(t)&&UM(o.gl)?t.colorSpace=o.gl.outputColorSpace:t.encoding=o.gl.outputEncoding}sC(t)}if(r&&r.parent&&t.raycast&&l!==r.eventCount){const e=ZM(t).getState().internal,n=e.interaction.indexOf(t);n>-1&&e.interaction.splice(n,1),r.eventCount&&e.interaction.push(t)}return!(1===s.length&&"onUpdate"===s[0][0])&&s.length&&null!=(n=t.__r3f)&&n.parent&&lC(t),t}function sC(t){var e,n;const r=null==(e=t.__r3f)||null==(n=e.root)||null==n.getState?void 0:n.getState();r&&0===r.internal.frames&&r.invalidate()}function lC(t){null==t.onUpdate||t.onUpdate(t)}function cC(t,e){t.manual||(zM(t)?(t.left=e.width/-2,t.right=e.width/2,t.top=e.height/2,t.bottom=e.height/-2):t.aspect=e.width/e.height,t.updateProjectionMatrix(),t.updateMatrixWorld())}function uC(t){return(t.eventObject||t.object).uuid+"/"+t.index+t.instanceId}function hC(t,e,n,r){const i=n.get(e);i&&(n.delete(e),0===n.size&&(t.delete(r),i.target.releasePointerCapture(r)))}function dC(t){function e(t){return t.filter((t=>["Move","Over","Enter","Out","Leave"].some((e=>{var n;return null==(n=t.__r3f)?void 0:n.handlers["onPointer"+e]}))))}function n(e){const{internal:n}=t.getState();for(const t of n.hovered.values())if(!e.length||!e.find((e=>e.object===t.object&&e.index===t.index&&e.instanceId===t.instanceId))){const r=t.eventObject.__r3f,i=null==r?void 0:r.handlers;if(n.hovered.delete(uC(t)),null!=r&&r.eventCount){const n={...t,intersections:e};null==i.onPointerOut||i.onPointerOut(n),null==i.onPointerLeave||i.onPointerLeave(n)}}}function r(t,e){for(let n=0;n<e.length;n++){const r=e[n].__r3f;null==r||null==r.handlers.onPointerMissed||r.handlers.onPointerMissed(t)}}return{handlePointer:function(i){switch(i){case"onPointerLeave":case"onPointerCancel":return()=>n([]);case"onLostPointerCapture":return e=>{const{internal:r}=t.getState();"pointerId"in e&&r.capturedMap.has(e.pointerId)&&requestAnimationFrame((()=>{r.capturedMap.has(e.pointerId)&&(r.capturedMap.delete(e.pointerId),n([]))}))}}return function(o){const{onPointerMissed:a,internal:s}=t.getState();s.lastEvent.current=o;const l="onPointerMove"===i,c="onClick"===i||"onContextMenu"===i||"onDoubleClick"===i,u=function(e,n){const r=t.getState(),i=new Set,o=[],a=n?n(r.internal.interaction):r.internal.interaction;for(let t=0;t<a.length;t++){const e=KM(a[t]);e&&(e.raycaster.camera=void 0)}r.previousRoot||null==r.events.compute||r.events.compute(e,r);let s=a.flatMap((function(t){const n=KM(t);return n&&n.events.enabled&&null!==n.raycaster.camera?(void 0===n.raycaster.camera&&(null==n.events.compute||n.events.compute(e,n,null==(r=n.previousRoot)?void 0:r.getState()),void 0===n.raycaster.camera&&(n.raycaster.camera=null)),n.raycaster.camera?n.raycaster.intersectObject(t,!0):[]):[];var r})).sort(((t,e)=>{const n=KM(t.object),r=KM(e.object);return n&&r&&r.events.priority-n.events.priority||t.distance-e.distance})).filter((t=>{const e=uC(t);return!i.has(e)&&(i.add(e),!0)}));r.events.filter&&(s=r.events.filter(s,r));for(const t of s){let e=t.object;for(;e;){var l;null!=(l=e.__r3f)&&l.eventCount&&o.push({...t,eventObject:e}),e=e.parent}}if("pointerId"in e&&r.internal.capturedMap.has(e.pointerId))for(let t of r.internal.capturedMap.get(e.pointerId).values())i.has(uC(t.intersection))||o.push(t.intersection);return o}(o,l?e:void 0),h=c?function(e){const{internal:n}=t.getState(),r=e.offsetX-n.initialClick[0],i=e.offsetY-n.initialClick[1];return Math.round(Math.sqrt(r*r+i*i))}(o):0;"onPointerDown"===i&&(s.initialClick=[o.offsetX,o.offsetY],s.initialHits=u.map((t=>t.eventObject))),c&&!u.length&&h<=2&&(r(o,s.interaction),a&&a(o)),l&&n(u),function(e,r,i,o){const a=t.getState();if(e.length){const t={stopped:!1};for(const s of e){const l=KM(s.object)||a,{raycaster:c,pointer:u,camera:h,internal:d}=l,p=new $f(u.x,u.y,0).unproject(h),f=t=>{var e,n;return null!=(e=null==(n=d.capturedMap.get(t))?void 0:n.has(s.eventObject))&&e},m=t=>{const e={intersection:s,target:r.target};d.capturedMap.has(t)?d.capturedMap.get(t).set(s.eventObject,e):d.capturedMap.set(t,new Map([[s.eventObject,e]])),r.target.setPointerCapture(t)},g=t=>{const e=d.capturedMap.get(t);e&&hC(d.capturedMap,s.eventObject,e,t)};let y={};for(let t in r){let e=r[t];"function"!==typeof e&&(y[t]=e)}let v={...s,...y,pointer:u,intersections:e,stopped:t.stopped,delta:i,unprojectedPoint:p,ray:c.ray,camera:h,stopPropagation(){const i="pointerId"in r&&d.capturedMap.get(r.pointerId);(!i||i.has(s.eventObject))&&(v.stopped=t.stopped=!0,d.hovered.size&&Array.from(d.hovered.values()).find((t=>t.eventObject===s.eventObject)))&&n([...e.slice(0,e.indexOf(s)),s])},target:{hasPointerCapture:f,setPointerCapture:m,releasePointerCapture:g},currentTarget:{hasPointerCapture:f,setPointerCapture:m,releasePointerCapture:g},nativeEvent:r};if(o(v),!0===t.stopped)break}}}(u,o,h,(function(t){const e=t.eventObject,n=e.__r3f,a=null==n?void 0:n.handlers;if(null!=n&&n.eventCount)if(l){if(a.onPointerOver||a.onPointerEnter||a.onPointerOut||a.onPointerLeave){const e=uC(t),n=s.hovered.get(e);n?n.stopped&&t.stopPropagation():(s.hovered.set(e,t),null==a.onPointerOver||a.onPointerOver(t),null==a.onPointerEnter||a.onPointerEnter(t))}null==a.onPointerMove||a.onPointerMove(t)}else{const n=a[i];n?c&&!s.initialHits.includes(e)||(r(o,s.interaction.filter((t=>!s.initialHits.includes(t)))),n(t)):c&&s.initialHits.includes(e)&&r(o,s.interaction.filter((t=>!s.initialHits.includes(t))))}}))}}}}const pC=t=>!(null==t||!t.render),fC=k.createContext(null),mC=(t,e)=>{const n=CM(((n,r)=>{const i=new $f,o=new $f,a=new $f;function s(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r().camera,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r().size;const{width:s,height:l,top:c,left:u}=n,h=s/l;e instanceof $f?a.copy(e):a.set(...e);const d=t.getWorldPosition(i).distanceTo(a);if(zM(t))return{width:s/t.zoom,height:l/t.zoom,top:c,left:u,factor:1,distance:d,aspect:h};{const e=t.fov*Math.PI/180,n=2*Math.tan(e/2)*d,r=n*(s/l);return{width:r,height:n,top:c,left:u,factor:s/r,distance:d,aspect:h}}}let l;const c=t=>n((e=>({performance:{...e.performance,current:t}}))),u=new _f,h={set:n,get:r,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return t(r(),e)},advance:(t,n)=>e(t,n,r()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new rE,pointer:u,mouse:u,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const t=r();l&&clearTimeout(l),t.performance.current!==t.performance.min&&c(t.performance.min),l=setTimeout((()=>c(r().performance.max)),t.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:s},setEvents:t=>n((e=>({...e,events:{...e.events,...t}}))),setSize:(t,e,i,a,l)=>{const c=r().camera,u={width:t,height:e,top:a||0,left:l||0,updateStyle:i};n((t=>({size:u,viewport:{...t.viewport,...s(c,o,u)}})))},setDpr:t=>n((e=>{const n=YM(t);return{viewport:{...e.viewport,dpr:n,initialDpr:e.viewport.initialDpr||n}}})),setFrameloop:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"always";const e=r().clock;e.stop(),e.elapsedTime=0,"never"!==t&&(e.start(),e.elapsedTime=0),n((()=>({frameloop:t})))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:k.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(t,e,n)=>{const i=r().internal;return i.priority=i.priority+(e>0?1:0),i.subscribers.push({ref:t,priority:e,store:n}),i.subscribers=i.subscribers.sort(((t,e)=>t.priority-e.priority)),()=>{const n=r().internal;null!=n&&n.subscribers&&(n.priority=n.priority-(e>0?1:0),n.subscribers=n.subscribers.filter((e=>e.ref!==t)))}}}};return h})),r=n.getState();let i=r.size,o=r.viewport.dpr,a=r.camera;return n.subscribe((()=>{const{camera:t,size:e,viewport:r,gl:s,set:l}=n.getState();if(e.width!==i.width||e.height!==i.height||r.dpr!==o){var c;i=e,o=r.dpr,cC(t,e),s.setPixelRatio(r.dpr);const n=null!=(c=e.updateStyle)?c:"undefined"!==typeof HTMLCanvasElement&&s.domElement instanceof HTMLCanvasElement;s.setSize(e.width,e.height,n)}t!==a&&(a=t,l((e=>({viewport:{...e.viewport,...e.viewport.getCurrentViewport(t)}}))))})),n.subscribe((e=>t(e))),n};let gC,yC=new Set,vC=new Set,bC=new Set;function xC(t,e){if(t.size)for(const{callback:n}of t.values())n(e)}function _C(t,e){switch(t){case"before":return xC(yC,e);case"after":return xC(vC,e);case"tail":return xC(bC,e)}}let wC,SC;function TC(t,e,n){let r=e.clock.getDelta();for("never"===e.frameloop&&"number"===typeof t&&(r=t-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=t),wC=e.internal.subscribers,gC=0;gC<wC.length;gC++)SC=wC[gC],SC.ref.current(SC.store.getState(),r,n);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),"always"===e.frameloop?1:e.internal.frames}function EC(){const t=k.useContext(fC);if(!t)throw new Error("R3F: Hooks can only be used within the Canvas component!");return t}function MC(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t=>t,e=arguments.length>1?arguments[1]:void 0;return EC()(t,e)}function CC(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=EC(),r=n.getState().internal.subscribe,i=VM(t);return jM((()=>r(i,e,n)),[e,r,n]),null}const AC=new WeakMap;function kC(t,e){return function(n){let r=AC.get(n);r||(r=new n,AC.set(n,r)),t&&t(r);for(var i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];return Promise.all(o.map((t=>new Promise(((n,i)=>r.load(t,(t=>{t.scene&&Object.assign(t,QM(t.scene)),n(t)}),e,(e=>i(new Error("Could not load ".concat(t,": ").concat(null==e?void 0:e.message))))))))))}}function IC(t,e,n,r){const i=Array.isArray(e)?e:[e],o=OM(kC(n,r),[t,...i],{equal:JM.equ});return Array.isArray(e)?o:o[0]}IC.preload=function(t,e,n){const r=Array.isArray(e)?e:[e];return((t,e,n)=>{NM(t,e,!0,n)})(kC(n),[t,...r])},IC.clear=function(t,e){return(t=>{if(void 0===t||0===t.length)RM.splice(0,RM.length);else{const e=RM.find((e=>PM(t,e.keys,e.equal)));e&&e.remove()}})([t,...Array.isArray(e)?e:[e]])};const RC=new Map,{invalidate:PC,advance:NC}=function(t){let e,n,r,i=!1,o=!1;function a(s){n=requestAnimationFrame(a),i=!0,e=0,_C("before",s),o=!0;for(const n of t.values()){var l;r=n.store.getState(),!r.internal.active||!("always"===r.frameloop||r.internal.frames>0)||null!=(l=r.gl.xr)&&l.isPresenting||(e+=TC(s,r))}if(o=!1,_C("after",s),0===e)return _C("tail",s),i=!1,cancelAnimationFrame(n)}return{loop:a,invalidate:function e(n){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;var s;if(!n)return t.forEach((t=>e(t.store.getState(),r)));null!=(s=n.gl.xr)&&s.isPresenting||!n.internal.active||"never"===n.frameloop||(n.internal.frames=r>1?Math.min(60,n.internal.frames+r):o?2:1,i||(i=!0,requestAnimationFrame(a)))},advance:function(e){let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;if(n&&_C("before",e),r)TC(e,r,i);else for(const o of t.values())TC(e,o.store.getState());n&&_C("after",e)}}}(RC),{reconciler:OC,applyProps:DC}=function(t,e){function n(t,e,n){let r,{args:i=[],attach:o,...a}=e,s="".concat(t[0].toUpperCase()).concat(t.slice(1));if("primitive"===t){if(void 0===a.object)throw new Error("R3F: Primitives without 'object' are invalid!");r=$M(a.object,{type:t,root:n,attach:o,primitive:!0})}else{const e=DM[s];if(!e)throw new Error("R3F: ".concat(s," is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively"));if(!Array.isArray(i))throw new Error("R3F: The args prop must be an array!");r=$M(new e(...i),{type:t,root:n,attach:o,memoizedProps:{args:i}})}return void 0===r.__r3f.attach&&(r instanceof Xg?r.__r3f.attach="geometry":r instanceof _g&&(r.__r3f.attach="material")),"inject"!==s&&aC(r,a),r}function r(t,e){let n=!1;var r,i;e&&(null!=(r=e.__r3f)&&r.attach?nC(t,e,e.__r3f.attach):e.isObject3D&&t.isObject3D&&(t.add(e),n=!0),n||null==(i=t.__r3f)||i.objects.push(e),e.__r3f||$M(e,{}),e.__r3f.parent=t,lC(e),sC(e))}function i(t,e,n){let r=!1;if(e){var i,o;if(null!=(i=e.__r3f)&&i.attach)nC(t,e,e.__r3f.attach);else if(e.isObject3D&&t.isObject3D){e.parent=t,e.dispatchEvent({type:"added"}),t.dispatchEvent({type:"childadded",child:e});const i=t.children.filter((t=>t!==e)),o=i.indexOf(n);t.children=[...i.slice(0,o),e,...i.slice(o)],r=!0}r||null==(o=t.__r3f)||o.objects.push(e),e.__r3f||$M(e,{}),e.__r3f.parent=t,lC(e),sC(e)}}function o(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t&&[...t].forEach((t=>a(e,t,n)))}function a(t,e,n){if(e){var r,i,a;if(e.__r3f&&(e.__r3f.parent=null),null!=(r=t.__r3f)&&r.objects&&(t.__r3f.objects=t.__r3f.objects.filter((t=>t!==e))),null!=(i=e.__r3f)&&i.attach)rC(t,e,e.__r3f.attach);else if(e.isObject3D&&t.isObject3D){var s;t.remove(e),null!=(s=e.__r3f)&&s.root&&function(t,e){const{internal:n}=t.getState();n.interaction=n.interaction.filter((t=>t!==e)),n.initialHits=n.initialHits.filter((t=>t!==e)),n.hovered.forEach(((t,r)=>{t.eventObject!==e&&t.object!==e||n.hovered.delete(r)})),n.capturedMap.forEach(((t,r)=>{hC(n.capturedMap,e,t,r)}))}(ZM(e),e)}const c=null==(a=e.__r3f)?void 0:a.primitive,u=!c&&(void 0===n?null!==e.dispose:n);var l;if(!c)o(null==(l=e.__r3f)?void 0:l.objects,e,u),o(e.children,e,u);if(delete e.__r3f,u&&e.dispose&&"Scene"!==e.type){const t=()=>{try{e.dispose()}catch($7){}};"undefined"===typeof IS_REACT_ACT_ENVIRONMENT?(0,IM.unstable_scheduleCallback)(IM.unstable_IdlePriority,t):t()}sC(t)}}const s=()=>console.warn("Text is not allowed in the R3F tree! This could be stray whitespace or characters."),l=kM()({createInstance:n,removeChild:a,appendChild:r,appendInitialChild:r,insertBefore:i,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(t,e)=>{if(!e)return;const n=t.getState().scene;n.__r3f&&(n.__r3f.root=t,r(n,e))},removeChildFromContainer:(t,e)=>{e&&a(t.getState().scene,e)},insertInContainerBefore:(t,e,n)=>{if(!e||!n)return;const r=t.getState().scene;r.__r3f&&i(r,e,n)},getRootHostContext:()=>null,getChildHostContext:t=>t,finalizeInitialChildren(t){var e;const n=null!=(e=null==t?void 0:t.__r3f)?e:{};return Boolean(n.handlers)},prepareUpdate(t,e,n,r){var i;if((null!=(i=null==t?void 0:t.__r3f)?i:{}).primitive&&r.object&&r.object!==t)return[!0];{const{args:e=[],children:i,...o}=r,{args:a=[],children:s,...l}=n;if(!Array.isArray(e))throw new Error("R3F: the args prop must be an array!");if(e.some(((t,e)=>t!==a[e])))return[!0];const c=iC(t,o,l,!0);return c.changes.length?[!1,c]:null}},commitUpdate(t,e,i,o,s,l){let[c,u]=e;c?function(t,e,i,o){var s;const l=null==(s=t.__r3f)?void 0:s.parent;if(!l)return;const c=n(e,i,t.__r3f.root);if(t.children){for(const e of t.children)e.__r3f&&r(c,e);t.children=t.children.filter((t=>!t.__r3f))}t.__r3f.objects.forEach((t=>r(c,t))),t.__r3f.objects=[],t.__r3f.autoRemovedBeforeAppend||a(l,t),c.parent&&(c.__r3f.autoRemovedBeforeAppend=!0),r(l,c),c.raycast&&c.__r3f.eventCount&&ZM(c).getState().internal.interaction.push(c);[o,o.alternate].forEach((t=>{null!==t&&(t.stateNode=c,t.ref&&("function"===typeof t.ref?t.ref(c):t.ref.current=c))}))}(t,i,s,l):aC(t,u)},commitMount(t,e,n,r){var i;const o=null!=(i=t.__r3f)?i:{};t.raycast&&o.handlers&&o.eventCount&&ZM(t).getState().internal.interaction.push(t)},getPublicInstance:t=>t,prepareForCommit:()=>null,preparePortalMount:t=>$M(t.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(t){var e;const{attach:n,parent:r}=null!=(e=t.__r3f)?e:{};n&&r&&rC(r,t,n),t.isObject3D&&(t.visible=!1),sC(t)},unhideInstance(t,e){var n;const{attach:r,parent:i}=null!=(n=t.__r3f)?n:{};r&&i&&nC(i,t,r),(t.isObject3D&&null==e.visible||e.visible)&&(t.visible=!0),sC(t)},createTextInstance:s,hideTextInstance:s,unhideTextInstance:s,getCurrentEventPriority:()=>e?e():TM.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:"undefined"!==typeof performance&&JM.fun(performance.now)?performance.now:JM.fun(Date.now)?Date.now:()=>0,scheduleTimeout:JM.fun(setTimeout)?setTimeout:void 0,cancelTimeout:JM.fun(clearTimeout)?clearTimeout:void 0});return{reconciler:l,applyProps:aC}}(0,(function(){var t;const e="undefined"!==typeof self&&self||"undefined"!==typeof window&&window;if(!e)return TM.DefaultEventPriority;switch(null==(t=e.event)?void 0:t.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return TM.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return TM.ContinuousEventPriority;default:return TM.DefaultEventPriority}})),LC={objects:"shallow",strict:!1},FC=(t,e)=>{const n="function"===typeof t?t(e):t;return pC(n)?n:new _x({powerPreference:"high-performance",canvas:e,antialias:!0,alpha:!0,...t})};function UC(t){const e=RC.get(t),n=null==e?void 0:e.fiber,r=null==e?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const i="function"===typeof reportError?reportError:console.error,o=r||mC(PC,NC),a=n||OC.createContainer(o,TM.ConcurrentRoot,null,!1,null,"",i,null);let s;e||RC.set(t,{fiber:a,store:o});let l,c=!1;return{configure(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{gl:n,size:r,scene:i,events:a,onCreated:u,shadows:h=!1,linear:d=!1,flat:p=!1,legacy:f=!1,orthographic:m=!1,frameloop:g="always",dpr:y=[1,2],performance:v,raycaster:b,camera:x,onPointerMissed:_}=e,w=o.getState(),S=w.gl;w.gl||w.set({gl:S=FC(n,t)});let T=w.raycaster;T||w.set({raycaster:T=new DE});const{params:E,...M}=b||{};if(JM.equ(M,T,LC)||DC(T,{...M}),JM.equ(E,T.params,LC)||DC(T,{params:{...T.params,...E}}),!w.camera||w.camera===l&&!JM.equ(l,x,LC)){l=x;const t=x instanceof by,e=t?x:m?new Zy(0,0,0,0,.1,1e3):new Sy(75,0,.1,1e3);t||(e.position.z=5,x&&(DC(e,x),("aspect"in x||"left"in x||"right"in x||"bottom"in x||"top"in x)&&(e.manual=!0,e.updateProjectionMatrix())),w.camera||null!=x&&x.rotation||e.lookAt(0,0,0)),w.set({camera:e}),T.camera=e}if(!w.scene){let t;i instanceof Tx?t=i:(t=new Tx,i&&DC(t,i)),w.set({scene:$M(t)})}if(!w.xr){var C;const t=(t,e)=>{const n=o.getState();"never"!==n.frameloop&&NC(t,!0,n,e)},e=()=>{const e=o.getState();e.gl.xr.enabled=e.gl.xr.isPresenting,e.gl.xr.setAnimationLoop(e.gl.xr.isPresenting?t:null),e.gl.xr.isPresenting||PC(e)},n={connect(){const t=o.getState().gl;t.xr.addEventListener("sessionstart",e),t.xr.addEventListener("sessionend",e)},disconnect(){const t=o.getState().gl;t.xr.removeEventListener("sessionstart",e),t.xr.removeEventListener("sessionend",e)}};"function"===typeof(null==(C=S.xr)?void 0:C.addEventListener)&&n.connect(),w.set({xr:n})}if(S.shadowMap){const t=S.shadowMap.enabled,e=S.shadowMap.type;if(S.shadowMap.enabled=!!h,JM.boo(h))S.shadowMap.type=Nu;else if(JM.str(h)){var A;const t={basic:Ru,percentage:Pu,soft:Nu,variance:Ou};S.shadowMap.type=null!=(A=t[h])?A:Nu}else JM.obj(h)&&Object.assign(S.shadowMap,h);t===S.shadowMap.enabled&&e===S.shadowMap.type||(S.shadowMap.needsUpdate=!0)}const k=BM();if(k&&("enabled"in k?k.enabled=!f:"legacyMode"in k&&(k.legacyMode=f)),!c){DC(S,{outputEncoding:d?3e3:3001,toneMapping:p?_h:Eh})}w.legacy!==f&&w.set((()=>({legacy:f}))),w.linear!==d&&w.set((()=>({linear:d}))),w.flat!==p&&w.set((()=>({flat:p}))),!n||JM.fun(n)||pC(n)||JM.equ(n,S,LC)||DC(S,n),a&&!w.events.handlers&&w.set({events:a(o)});const I=function(t,e){const n="undefined"!==typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement;if(e){const{width:t,height:r,top:i,left:o,updateStyle:a=n}=e;return{width:t,height:r,top:i,left:o,updateStyle:a}}if("undefined"!==typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement&&t.parentElement){const{width:e,height:r,top:i,left:o}=t.parentElement.getBoundingClientRect();return{width:e,height:r,top:i,left:o,updateStyle:n}}return"undefined"!==typeof OffscreenCanvas&&t instanceof OffscreenCanvas?{width:t.width,height:t.height,top:0,left:0,updateStyle:n}:{width:0,height:0,top:0,left:0}}(t,r);return JM.equ(I,w.size,LC)||w.setSize(I.width,I.height,I.updateStyle,I.top,I.left),y&&w.viewport.dpr!==YM(y)&&w.setDpr(y),w.frameloop!==g&&w.setFrameloop(g),w.onPointerMissed||w.set({onPointerMissed:_}),v&&!JM.equ(v,w.performance,LC)&&w.set((t=>({performance:{...t.performance,...v}}))),s=u,c=!0,this},render(e){return c||this.configure(),OC.updateContainer((0,Dn.jsx)(BC,{store:o,children:e,onCreated:s,rootElement:t}),a,null,(()=>{})),o},unmount(){zC(t)}}}function BC(t){let{store:e,children:n,onCreated:r,rootElement:i}=t;return jM((()=>{const t=e.getState();t.set((t=>({internal:{...t.internal,active:!0}}))),r&&r(t),e.getState().events.connected||null==t.events.connect||t.events.connect(i)}),[]),(0,Dn.jsx)(fC.Provider,{value:e,children:n})}function zC(t,e){const n=RC.get(t),r=null==n?void 0:n.fiber;if(r){const i=null==n?void 0:n.store.getState();i&&(i.internal.active=!1),OC.updateContainer(null,r,null,(()=>{i&&setTimeout((()=>{try{var n,r,o,a;null==i.events.disconnect||i.events.disconnect(),null==(n=i.gl)||null==(r=n.renderLists)||null==r.dispose||r.dispose(),null==(o=i.gl)||null==o.forceContextLoss||o.forceContextLoss(),null!=(a=i.gl)&&a.xr&&i.xr.disconnect(),function(t){t.dispose&&"Scene"!==t.type&&t.dispose();for(const e in t)null==e.dispose||e.dispose(),delete t[e]}(i),RC.delete(t),e&&e(t)}catch($7){}}),500)}))}}OC.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:k.version});k.unstable_act;var jC=__webpack_require__(695),VC=__webpack_require__.n(jC);function WC(t){let{debounce:e,scroll:n,polyfill:r,offsetSize:i}=void 0===t?{debounce:0,scroll:!1,offsetSize:!1}:t;const o=r||("undefined"===typeof window?class{}:window.ResizeObserver);if(!o)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[a,s]=(0,k.useState)({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),l=(0,k.useRef)({element:null,scrollContainers:null,resizeObserver:null,lastBounds:a}),c=e?"number"===typeof e?e:e.scroll:null,u=e?"number"===typeof e?e:e.resize:null,h=(0,k.useRef)(!1);(0,k.useEffect)((()=>(h.current=!0,()=>{h.current=!1})));const[d,p,f]=(0,k.useMemo)((()=>{const t=()=>{if(!l.current.element)return;const{left:t,top:e,width:n,height:r,bottom:o,right:a,x:c,y:u}=l.current.element.getBoundingClientRect(),d={left:t,top:e,width:n,height:r,bottom:o,right:a,x:c,y:u};l.current.element instanceof HTMLElement&&i&&(d.height=l.current.element.offsetHeight,d.width=l.current.element.offsetWidth),Object.freeze(d),h.current&&!qC(l.current.lastBounds,d)&&s(l.current.lastBounds=d)};return[t,u?VC()(t,u):t,c?VC()(t,c):t]}),[s,i,c,u]);function m(){l.current.scrollContainers&&(l.current.scrollContainers.forEach((t=>t.removeEventListener("scroll",f,!0))),l.current.scrollContainers=null),l.current.resizeObserver&&(l.current.resizeObserver.disconnect(),l.current.resizeObserver=null)}function g(){l.current.element&&(l.current.resizeObserver=new o(f),l.current.resizeObserver.observe(l.current.element),n&&l.current.scrollContainers&&l.current.scrollContainers.forEach((t=>t.addEventListener("scroll",f,{capture:!0,passive:!0}))))}var y,v,b;return y=f,v=Boolean(n),(0,k.useEffect)((()=>{if(v){const t=y;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>{window.removeEventListener("scroll",t,!0)}}}),[y,v]),b=p,(0,k.useEffect)((()=>{const t=b;return window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t)}}),[b]),(0,k.useEffect)((()=>{m(),g()}),[n,f,p]),(0,k.useEffect)((()=>m),[]),[t=>{t&&t!==l.current.element&&(m(),l.current.element=t,l.current.scrollContainers=GC(t),g())},a,d]}function GC(t){const e=[];if(!t||t===document.body)return e;const{overflow:n,overflowX:r,overflowY:i}=window.getComputedStyle(t);return[n,r,i].some((t=>"auto"===t||"scroll"===t))&&e.push(t),[...e,...GC(t.parentElement)]}const HC=["x","y","top","bottom","left","right","width","height"],qC=(t,e)=>HC.every((n=>t[n]===e[n]));var XC,YC,KC=Object.defineProperty,ZC=Object.defineProperties,JC=Object.getOwnPropertyDescriptors,QC=Object.getOwnPropertySymbols,$C=Object.prototype.hasOwnProperty,tA=Object.prototype.propertyIsEnumerable,eA=(t,e,n)=>e in t?KC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,nA=(t,e)=>{for(var n in e||(e={}))$C.call(e,n)&&eA(t,n,e[n]);if(QC)for(var n of QC(e))tA.call(e,n)&&eA(t,n,e[n]);return t};"undefined"===typeof window||!(null==(XC=window.document)?void 0:XC.createElement)&&"ReactNative"!==(null==(YC=window.navigator)?void 0:YC.product)?k.useEffect:k.useLayoutEffect;function rA(t,e,n){if(!t)return;if(!0===n(t))return t;let r=e?t.return:t.child;for(;r;){const t=rA(r,e,n);if(t)return t;r=e?null:r.sibling}}function iA(t){try{return Object.defineProperties(t,{_currentRenderer:{get:()=>null,set(){}},_currentRenderer2:{get:()=>null,set(){}}})}catch(EZ){return t}}const oA=console.error;console.error=function(){const t=[...arguments].join("");if(!(null==t?void 0:t.startsWith("Warning:"))||!t.includes("useContext"))return oA.apply(this,arguments);console.error=oA};const aA=iA(k.createContext(null));class sA extends k.Component{render(){return k.createElement(aA.Provider,{value:this._reactInternals},this.props.children)}}function lA(){const t=k.useContext(aA);if(null===t)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=k.useId(),n=k.useMemo((()=>{for(const n of[t,null==t?void 0:t.alternate]){if(!n)continue;const t=rA(n,!1,(t=>{let n=t.memoizedState;for(;n;){if(n.memoizedState===e)return!0;n=n.next}}));if(t)return t}}),[t,e]);return n}function cA(){const t=function(){const t=lA(),[e]=k.useState((()=>new Map));e.clear();let n=t;for(;n;){if(n.type&&"object"===typeof n.type){const t=void 0===n.type._context&&n.type.Provider===n.type?n.type:n.type._context;t&&t!==aA&&!e.has(t)&&e.set(t,k.useContext(iA(t)))}n=n.return}return e}();return k.useMemo((()=>Array.from(t.keys()).reduce(((e,n)=>r=>k.createElement(e,null,k.createElement(n.Provider,((t,e)=>ZC(t,JC(e)))(nA({},r),{value:t.get(n)})))),(t=>k.createElement(sA,nA({},t))))),[t])}const uA={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function hA(t){const{handlePointer:e}=dC(t);return{priority:1,enabled:!0,compute(t,e,n){e.pointer.set(t.offsetX/e.size.width*2-1,-t.offsetY/e.size.height*2+1),e.raycaster.setFromCamera(e.pointer,e.camera)},connected:void 0,handlers:Object.keys(uA).reduce(((t,n)=>({...t,[n]:e(n)})),{}),update:()=>{var e;const{events:n,internal:r}=t.getState();null!=(e=r.lastEvent)&&e.current&&n.handlers&&n.handlers.onPointerMove(r.lastEvent.current)},connect:e=>{var n;const{set:r,events:i}=t.getState();null==i.disconnect||i.disconnect(),r((t=>({events:{...t.events,connected:e}}))),Object.entries(null!=(n=i.handlers)?n:[]).forEach((t=>{let[n,r]=t;const[i,o]=uA[n];e.addEventListener(i,r,{passive:o})}))},disconnect:()=>{const{set:e,events:n}=t.getState();var r;n.connected&&(Object.entries(null!=(r=n.handlers)?r:[]).forEach((t=>{let[e,r]=t;if(n&&n.connected instanceof HTMLElement){const[t]=uA[e];n.connected.removeEventListener(t,r)}})),e((t=>({events:{...t.events,connected:void 0}}))))}}}const dA=k.forwardRef((function(e,n){let{children:r,fallback:i,resize:o,style:a,gl:s,events:l=hA,eventSource:c,eventPrefix:u,shadows:h,linear:d,flat:p,legacy:f,orthographic:m,frameloop:g,dpr:y,performance:v,raycaster:b,camera:x,scene:_,onPointerMissed:w,onCreated:S,...T}=e;k.useMemo((()=>{return e=t,void Object.assign(DM,e);var e}),[]);const E=cA(),[M,C]=WC({scroll:!0,debounce:{scroll:50,resize:0},...o}),A=k.useRef(null),I=k.useRef(null);k.useImperativeHandle(n,(()=>A.current));const R=VM(w),[P,N]=k.useState(!1),[O,D]=k.useState(!1);if(P)throw P;if(O)throw O;const L=k.useRef(null);jM((()=>{const t=A.current;C.width>0&&C.height>0&&t&&(L.current||(L.current=UC(t)),L.current.configure({gl:s,events:l,shadows:h,linear:d,flat:p,legacy:f,orthographic:m,frameloop:g,dpr:y,performance:v,raycaster:b,camera:x,scene:_,size:C,onPointerMissed:function(){return null==R.current?void 0:R.current(...arguments)},onCreated:t=>{var e;null==t.events.connect||t.events.connect(c?(e=c)&&e.hasOwnProperty("current")?c.current:c:I.current),u&&t.setEvents({compute:(t,e)=>{const n=t[u+"X"],r=t[u+"Y"];e.pointer.set(n/e.size.width*2-1,-r/e.size.height*2+1),e.raycaster.setFromCamera(e.pointer,e.camera)}}),null==S||S(t)}}),L.current.render((0,Dn.jsx)(E,{children:(0,Dn.jsx)(GM,{set:D,children:(0,Dn.jsx)(k.Suspense,{fallback:(0,Dn.jsx)(WM,{set:N}),children:r})})})))})),k.useEffect((()=>{const t=A.current;if(t)return()=>zC(t)}),[]);const F=c?"none":"auto";return(0,Dn.jsx)("div",{ref:I,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:F,...a},...T,children:(0,Dn.jsx)("div",{ref:M,style:{width:"100%",height:"100%"},children:(0,Dn.jsx)("canvas",{ref:A,style:{display:"block"},children:i})})})})),pA=k.forwardRef((function(t,e){return(0,Dn.jsx)(sA,{children:(0,Dn.jsx)(dA,{...t,ref:e})})})),fA=t=>t===Object(t)&&!Array.isArray(t)&&"function"!==typeof t;function mA(t,e){const n=MC((t=>t.gl)),r=IC(_T,fA(t)?Object.values(t):t);(0,k.useLayoutEffect)((()=>{null==e||e(r)}),[e]),(0,k.useEffect)((()=>{if("initTexture"in n){let t=[];Array.isArray(r)?t=r:r instanceof Gf?t=[r]:fA(r)&&(t=Object.values(r)),t.forEach((t=>{t instanceof Gf&&n.initTexture(t)}))}}),[n,r]);const i=(0,k.useMemo)((()=>{if(fA(t)){const e={};let n=0;for(const i in t)e[i]=r[n++];return e}return r}),[t,r]);return i}mA.preload=t=>IC.preload(_T,t),mA.clear=t=>IC.clear(_T,t);const gA=k.forwardRef(((t,e)=>{let{children:n,enabled:r=!0,speed:i=1,rotationIntensity:o=1,floatIntensity:a=1,floatingRange:s=[-.1,.1],...l}=t;const c=k.useRef(null);k.useImperativeHandle(e,(()=>c.current),[]);const u=k.useRef(1e4*Math.random());return CC((t=>{var e,n;if(!r||0===i)return;const l=u.current+t.clock.getElapsedTime();c.current.rotation.x=Math.cos(l/4*i)/8*o,c.current.rotation.y=Math.sin(l/4*i)/8*o,c.current.rotation.z=Math.sin(l/4*i)/20*o;let h=Math.sin(l/4*i)/10;h=xf.mapLinear(h,-.1,.1,null!==(e=null==s?void 0:s[0])&&void 0!==e?e:-.1,null!==(n=null==s?void 0:s[1])&&void 0!==n?n:.1),c.current.position.y=h*a,c.current.updateMatrix()})),k.createElement("group",l,k.createElement("group",{ref:c,matrixAutoUpdate:!1},n))}));function yA(){return yA=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},yA.apply(null,arguments)}class vA extends Xg{constructor(t,e,n,r){super();const i=[],o=[],a=[],s=new $f,l=new km;l.makeRotationFromEuler(n),l.setPosition(e);const c=new km;function u(e,n,r){n.applyMatrix4(t.matrixWorld),n.applyMatrix4(c),r.transformDirection(t.matrixWorld),e.push(new bA(n.clone(),r.clone()))}function h(t,e){const n=[],i=.5*Math.abs(r.dot(e));for(let r=0;r<t.length;r+=3){let o,a,s,l,c,u,h,p=0;switch(o=t[r+0].position.dot(e)-i>0,a=t[r+1].position.dot(e)-i>0,s=t[r+2].position.dot(e)-i>0,p=(o?1:0)+(a?1:0)+(s?1:0),p){case 0:n.push(t[r]),n.push(t[r+1]),n.push(t[r+2]);break;case 1:if(o&&(l=t[r+1],c=t[r+2],u=d(t[r],l,e,i),h=d(t[r],c,e,i)),a){l=t[r],c=t[r+2],u=d(t[r+1],l,e,i),h=d(t[r+1],c,e,i),n.push(u),n.push(c.clone()),n.push(l.clone()),n.push(c.clone()),n.push(u.clone()),n.push(h);break}s&&(l=t[r],c=t[r+1],u=d(t[r+2],l,e,i),h=d(t[r+2],c,e,i)),n.push(l.clone()),n.push(c.clone()),n.push(u),n.push(h),n.push(u.clone()),n.push(c.clone());break;case 2:o||(l=t[r].clone(),c=d(l,t[r+1],e,i),u=d(l,t[r+2],e,i),n.push(l),n.push(c),n.push(u)),a||(l=t[r+1].clone(),c=d(l,t[r+2],e,i),u=d(l,t[r],e,i),n.push(l),n.push(c),n.push(u)),s||(l=t[r+2].clone(),c=d(l,t[r],e,i),u=d(l,t[r+1],e,i),n.push(l),n.push(c),n.push(u))}}return n}function d(t,e,n,r){const i=t.position.dot(n)-r,o=i/(i-(e.position.dot(n)-r));return new bA(new $f(t.position.x+o*(e.position.x-t.position.x),t.position.y+o*(e.position.y-t.position.y),t.position.z+o*(e.position.z-t.position.z)),new $f(t.normal.x+o*(e.normal.x-t.normal.x),t.normal.y+o*(e.normal.y-t.normal.y),t.normal.z+o*(e.normal.z-t.normal.z)))}c.copy(l).invert(),function(){let e,n=[];const c=new $f,d=new $f;if(!0===t.geometry.isGeometry)return void console.error("THREE.DecalGeometry no longer supports THREE.Geometry. Use BufferGeometry instead.");const p=t.geometry,f=p.attributes.position,m=p.attributes.normal;if(null!==p.index){const t=p.index;for(e=0;e<t.count;e++)c.fromBufferAttribute(f,t.getX(e)),d.fromBufferAttribute(m,t.getX(e)),u(n,c,d)}else for(e=0;e<f.count;e++)c.fromBufferAttribute(f,e),d.fromBufferAttribute(m,e),u(n,c,d);for(n=h(n,s.set(1,0,0)),n=h(n,s.set(-1,0,0)),n=h(n,s.set(0,1,0)),n=h(n,s.set(0,-1,0)),n=h(n,s.set(0,0,1)),n=h(n,s.set(0,0,-1)),e=0;e<n.length;e++){const t=n[e];a.push(.5+t.position.x/r.x,.5+t.position.y/r.y),t.position.applyMatrix4(l),i.push(t.position.x,t.position.y,t.position.z),o.push(t.normal.x,t.normal.y,t.normal.z)}}(),this.setAttribute("position",new Bg(i,3)),this.setAttribute("normal",new Bg(o,3)),this.setAttribute("uv",new Bg(a,2))}}class bA{constructor(t,e){this.position=t,this.normal=e}clone(){return new this.constructor(this.position.clone(),this.normal.clone())}}function xA(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0];return function(t){return Array.isArray(t)}(t)?t:t instanceof $f||t instanceof Bm?[t.x,t.y,t.z]:[t,t,t]}const _A=k.forwardRef((function(t,e){let{debug:n,depthTest:r=!1,polygonOffsetFactor:i=-10,map:o,mesh:a,children:s,position:l,rotation:c,scale:u,...h}=t;const d=k.useRef(null);k.useImperativeHandle(e,(()=>d.current));const p=k.useRef(null);return k.useLayoutEffect((()=>{const t=(null==a?void 0:a.current)||d.current.parent,e=d.current;if(!(t instanceof hy))throw new Error('Decal must have a Mesh as parent or specify its "mesh" prop');const n={position:new $f,rotation:new Bm,scale:new $f(1,1,1)};if(t){DC(n,{position:l,scale:u});const r=t.matrixWorld.clone();if(t.matrixWorld.identity(),c&&"number"!==typeof c)DC(n,{rotation:c});else{const e=new ng;e.position.copy(n.position),e.lookAt(t.position),"number"===typeof c&&e.rotateZ(c),DC(n,{rotation:e.rotation})}return e.geometry=new vA(t,n.position,n.rotation,n.scale),p.current&&(DC(p.current,n),p.current.traverse((t=>t.raycast=()=>null))),t.matrixWorld=r,()=>{e.geometry.dispose()}}}),[a,...xA(l),...xA(u),...xA(c)]),k.createElement("mesh",yA({ref:d,"material-transparent":!0,"material-polygonOffset":!0,"material-polygonOffsetFactor":i,"material-depthTest":r,"material-map":o},h),s,n&&k.createElement("mesh",{ref:p},k.createElement("boxGeometry",null),k.createElement("meshNormalMaterial",{wireframe:!0}),k.createElement("axesHelper",null)))}));var wA=Object.defineProperty,SA=(t,e,n)=>(((t,e,n)=>{e in t?wA(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!==typeof e?e+"":e,n),n);const TA=new Am,EA=new Ry,MA=Math.cos(Math.PI/180*70),CA=(t,e)=>(t%e+e)%e;class AA extends cf{constructor(t,e){super(),SA(this,"object"),SA(this,"domElement"),SA(this,"enabled",!0),SA(this,"target",new $f),SA(this,"minDistance",0),SA(this,"maxDistance",1/0),SA(this,"minZoom",0),SA(this,"maxZoom",1/0),SA(this,"minPolarAngle",0),SA(this,"maxPolarAngle",Math.PI),SA(this,"minAzimuthAngle",-1/0),SA(this,"maxAzimuthAngle",1/0),SA(this,"enableDamping",!1),SA(this,"dampingFactor",.05),SA(this,"enableZoom",!0),SA(this,"zoomSpeed",1),SA(this,"enableRotate",!0),SA(this,"rotateSpeed",1),SA(this,"enablePan",!0),SA(this,"panSpeed",1),SA(this,"screenSpacePanning",!0),SA(this,"keyPanSpeed",7),SA(this,"zoomToCursor",!1),SA(this,"autoRotate",!1),SA(this,"autoRotateSpeed",2),SA(this,"reverseOrbit",!1),SA(this,"reverseHorizontalOrbit",!1),SA(this,"reverseVerticalOrbit",!1),SA(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),SA(this,"mouseButtons",{LEFT:Eu.ROTATE,MIDDLE:Eu.DOLLY,RIGHT:Eu.PAN}),SA(this,"touches",{ONE:Mu.ROTATE,TWO:Mu.DOLLY_PAN}),SA(this,"target0"),SA(this,"position0"),SA(this,"zoom0"),SA(this,"_domElementKeyEvents",null),SA(this,"getPolarAngle"),SA(this,"getAzimuthalAngle"),SA(this,"setPolarAngle"),SA(this,"setAzimuthalAngle"),SA(this,"getDistance"),SA(this,"listenToKeyEvents"),SA(this,"stopListenToKeyEvents"),SA(this,"saveState"),SA(this,"reset"),SA(this,"update"),SA(this,"connect"),SA(this,"dispose"),this.object=t,this.domElement=e,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>c.phi,this.getAzimuthalAngle=()=>c.theta,this.setPolarAngle=t=>{let e=CA(t,2*Math.PI),r=c.phi;r<0&&(r+=2*Math.PI),e<0&&(e+=2*Math.PI);let i=Math.abs(e-r);2*Math.PI-i<i&&(e<r?e+=2*Math.PI:r+=2*Math.PI),u.phi=e-r,n.update()},this.setAzimuthalAngle=t=>{let e=CA(t,2*Math.PI),r=c.theta;r<0&&(r+=2*Math.PI),e<0&&(e+=2*Math.PI);let i=Math.abs(e-r);2*Math.PI-i<i&&(e<r?e+=2*Math.PI:r+=2*Math.PI),u.theta=e-r,n.update()},this.getDistance=()=>n.object.position.distanceTo(n.target),this.listenToKeyEvents=t=>{t.addEventListener("keydown",K),this._domElementKeyEvents=t},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",K),this._domElementKeyEvents=null},this.saveState=()=>{n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=()=>{n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(r),n.update(),s=a.NONE},this.update=(()=>{const e=new $f,i=new $f(0,1,0),o=(new Qf).setFromUnitVectors(t.up,i),p=o.clone().invert(),f=new $f,m=new Qf,g=2*Math.PI;return function(){const y=n.object.position;o.setFromUnitVectors(t.up,i),p.copy(o).invert(),e.copy(y).sub(n.target),e.applyQuaternion(o),c.setFromVector3(e),n.autoRotate&&s===a.NONE&&A(2*Math.PI/60/60*n.autoRotateSpeed),n.enableDamping?(c.theta+=u.theta*n.dampingFactor,c.phi+=u.phi*n.dampingFactor):(c.theta+=u.theta,c.phi+=u.phi);let v=n.minAzimuthAngle,b=n.maxAzimuthAngle;isFinite(v)&&isFinite(b)&&(v<-Math.PI?v+=g:v>Math.PI&&(v-=g),b<-Math.PI?b+=g:b>Math.PI&&(b-=g),c.theta=v<=b?Math.max(v,Math.min(b,c.theta)):c.theta>(v+b)/2?Math.max(v,c.theta):Math.min(b,c.theta)),c.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,c.phi)),c.makeSafe(),!0===n.enableDamping?n.target.addScaledVector(d,n.dampingFactor):n.target.add(d),n.zoomToCursor&&T||n.object.isOrthographicCamera?c.radius=L(c.radius):c.radius=L(c.radius*h),e.setFromSpherical(c),e.applyQuaternion(p),y.copy(n.target).add(e),n.object.matrixAutoUpdate||n.object.updateMatrix(),n.object.lookAt(n.target),!0===n.enableDamping?(u.theta*=1-n.dampingFactor,u.phi*=1-n.dampingFactor,d.multiplyScalar(1-n.dampingFactor)):(u.set(0,0,0),d.set(0,0,0));let x=!1;if(n.zoomToCursor&&T){let r=null;if(n.object instanceof Sy&&n.object.isPerspectiveCamera){const t=e.length();r=L(t*h);const i=t-r;n.object.position.addScaledVector(w,i),n.object.updateMatrixWorld()}else if(n.object.isOrthographicCamera){const t=new $f(S.x,S.y,0);t.unproject(n.object),n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/h)),n.object.updateProjectionMatrix(),x=!0;const i=new $f(S.x,S.y,0);i.unproject(n.object),n.object.position.sub(i).add(t),n.object.updateMatrixWorld(),r=e.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),n.zoomToCursor=!1;null!==r&&(n.screenSpacePanning?n.target.set(0,0,-1).transformDirection(n.object.matrix).multiplyScalar(r).add(n.object.position):(TA.origin.copy(n.object.position),TA.direction.set(0,0,-1).transformDirection(n.object.matrix),Math.abs(n.object.up.dot(TA.direction))<MA?t.lookAt(n.target):(EA.setFromNormalAndCoplanarPoint(n.object.up,n.target),TA.intersectPlane(EA,n.target))))}else n.object instanceof Zy&&n.object.isOrthographicCamera&&(x=1!==h,x&&(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/h)),n.object.updateProjectionMatrix()));return h=1,T=!1,!!(x||f.distanceToSquared(n.object.position)>l||8*(1-m.dot(n.object.quaternion))>l)&&(n.dispatchEvent(r),f.copy(n.object.position),m.copy(n.object.quaternion),x=!1,!0)}})(),this.connect=t=>{t===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),n.domElement=t,n.domElement.style.touchAction="none",n.domElement.addEventListener("contextmenu",Z),n.domElement.addEventListener("pointerdown",H),n.domElement.addEventListener("pointercancel",X),n.domElement.addEventListener("wheel",Y)},this.dispose=()=>{var t,e,r,i,o,a;n.domElement&&(n.domElement.style.touchAction="auto"),null==(t=n.domElement)||t.removeEventListener("contextmenu",Z),null==(e=n.domElement)||e.removeEventListener("pointerdown",H),null==(r=n.domElement)||r.removeEventListener("pointercancel",X),null==(i=n.domElement)||i.removeEventListener("wheel",Y),null==(o=n.domElement)||o.ownerDocument.removeEventListener("pointermove",q),null==(a=n.domElement)||a.ownerDocument.removeEventListener("pointerup",X),null!==n._domElementKeyEvents&&n._domElementKeyEvents.removeEventListener("keydown",K)};const n=this,r={type:"change"},i={type:"start"},o={type:"end"},a={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let s=a.NONE;const l=1e-6,c=new UE,u=new UE;let h=1;const d=new $f,p=new _f,f=new _f,m=new _f,g=new _f,y=new _f,v=new _f,b=new _f,x=new _f,_=new _f,w=new $f,S=new _f;let T=!1;const E=[],M={};function C(){return Math.pow(.95,n.zoomSpeed)}function A(t){n.reverseOrbit||n.reverseHorizontalOrbit?u.theta+=t:u.theta-=t}function k(t){n.reverseOrbit||n.reverseVerticalOrbit?u.phi+=t:u.phi-=t}const I=(()=>{const t=new $f;return function(e,n){t.setFromMatrixColumn(n,0),t.multiplyScalar(-e),d.add(t)}})(),R=(()=>{const t=new $f;return function(e,r){!0===n.screenSpacePanning?t.setFromMatrixColumn(r,1):(t.setFromMatrixColumn(r,0),t.crossVectors(n.object.up,t)),t.multiplyScalar(e),d.add(t)}})(),P=(()=>{const t=new $f;return function(e,r){const i=n.domElement;if(i&&n.object instanceof Sy&&n.object.isPerspectiveCamera){const o=n.object.position;t.copy(o).sub(n.target);let a=t.length();a*=Math.tan(n.object.fov/2*Math.PI/180),I(2*e*a/i.clientHeight,n.object.matrix),R(2*r*a/i.clientHeight,n.object.matrix)}else i&&n.object instanceof Zy&&n.object.isOrthographicCamera?(I(e*(n.object.right-n.object.left)/n.object.zoom/i.clientWidth,n.object.matrix),R(r*(n.object.top-n.object.bottom)/n.object.zoom/i.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}})();function N(t){n.object instanceof Sy&&n.object.isPerspectiveCamera||n.object instanceof Zy&&n.object.isOrthographicCamera?h/=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function O(t){n.object instanceof Sy&&n.object.isPerspectiveCamera||n.object instanceof Zy&&n.object.isOrthographicCamera?h*=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function D(t){if(!n.zoomToCursor||!n.domElement)return;T=!0;const e=n.domElement.getBoundingClientRect(),r=t.clientX-e.left,i=t.clientY-e.top,o=e.width,a=e.height;S.x=r/o*2-1,S.y=-i/a*2+1,w.set(S.x,S.y,1).unproject(n.object).sub(n.object.position).normalize()}function L(t){return Math.max(n.minDistance,Math.min(n.maxDistance,t))}function F(t){p.set(t.clientX,t.clientY)}function U(t){g.set(t.clientX,t.clientY)}function B(){if(1==E.length)p.set(E[0].pageX,E[0].pageY);else{const t=.5*(E[0].pageX+E[1].pageX),e=.5*(E[0].pageY+E[1].pageY);p.set(t,e)}}function z(){if(1==E.length)g.set(E[0].pageX,E[0].pageY);else{const t=.5*(E[0].pageX+E[1].pageX),e=.5*(E[0].pageY+E[1].pageY);g.set(t,e)}}function j(){const t=E[0].pageX-E[1].pageX,e=E[0].pageY-E[1].pageY,n=Math.sqrt(t*t+e*e);b.set(0,n)}function V(t){if(1==E.length)f.set(t.pageX,t.pageY);else{const e=Q(t),n=.5*(t.pageX+e.x),r=.5*(t.pageY+e.y);f.set(n,r)}m.subVectors(f,p).multiplyScalar(n.rotateSpeed);const e=n.domElement;e&&(A(2*Math.PI*m.x/e.clientHeight),k(2*Math.PI*m.y/e.clientHeight)),p.copy(f)}function W(t){if(1==E.length)y.set(t.pageX,t.pageY);else{const e=Q(t),n=.5*(t.pageX+e.x),r=.5*(t.pageY+e.y);y.set(n,r)}v.subVectors(y,g).multiplyScalar(n.panSpeed),P(v.x,v.y),g.copy(y)}function G(t){const e=Q(t),r=t.pageX-e.x,i=t.pageY-e.y,o=Math.sqrt(r*r+i*i);x.set(0,o),_.set(0,Math.pow(x.y/b.y,n.zoomSpeed)),N(_.y),b.copy(x)}function H(t){var e,r;!1!==n.enabled&&(0===E.length&&(null==(e=n.domElement)||e.ownerDocument.addEventListener("pointermove",q),null==(r=n.domElement)||r.ownerDocument.addEventListener("pointerup",X)),function(t){E.push(t)}(t),"touch"===t.pointerType?function(t){switch(J(t),E.length){case 1:switch(n.touches.ONE){case Mu.ROTATE:if(!1===n.enableRotate)return;B(),s=a.TOUCH_ROTATE;break;case Mu.PAN:if(!1===n.enablePan)return;z(),s=a.TOUCH_PAN;break;default:s=a.NONE}break;case 2:switch(n.touches.TWO){case Mu.DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;n.enableZoom&&j(),n.enablePan&&z(),s=a.TOUCH_DOLLY_PAN;break;case Mu.DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;n.enableZoom&&j(),n.enableRotate&&B(),s=a.TOUCH_DOLLY_ROTATE;break;default:s=a.NONE}break;default:s=a.NONE}s!==a.NONE&&n.dispatchEvent(i)}(t):function(t){let e;switch(t.button){case 0:e=n.mouseButtons.LEFT;break;case 1:e=n.mouseButtons.MIDDLE;break;case 2:e=n.mouseButtons.RIGHT;break;default:e=-1}switch(e){case Eu.DOLLY:if(!1===n.enableZoom)return;!function(t){D(t),b.set(t.clientX,t.clientY)}(t),s=a.DOLLY;break;case Eu.ROTATE:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===n.enablePan)return;U(t),s=a.PAN}else{if(!1===n.enableRotate)return;F(t),s=a.ROTATE}break;case Eu.PAN:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===n.enableRotate)return;F(t),s=a.ROTATE}else{if(!1===n.enablePan)return;U(t),s=a.PAN}break;default:s=a.NONE}s!==a.NONE&&n.dispatchEvent(i)}(t))}function q(t){!1!==n.enabled&&("touch"===t.pointerType?function(t){switch(J(t),s){case a.TOUCH_ROTATE:if(!1===n.enableRotate)return;V(t),n.update();break;case a.TOUCH_PAN:if(!1===n.enablePan)return;W(t),n.update();break;case a.TOUCH_DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;!function(t){n.enableZoom&&G(t),n.enablePan&&W(t)}(t),n.update();break;case a.TOUCH_DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;!function(t){n.enableZoom&&G(t),n.enableRotate&&V(t)}(t),n.update();break;default:s=a.NONE}}(t):function(t){if(!1===n.enabled)return;switch(s){case a.ROTATE:if(!1===n.enableRotate)return;!function(t){f.set(t.clientX,t.clientY),m.subVectors(f,p).multiplyScalar(n.rotateSpeed);const e=n.domElement;e&&(A(2*Math.PI*m.x/e.clientHeight),k(2*Math.PI*m.y/e.clientHeight)),p.copy(f),n.update()}(t);break;case a.DOLLY:if(!1===n.enableZoom)return;!function(t){x.set(t.clientX,t.clientY),_.subVectors(x,b),_.y>0?N(C()):_.y<0&&O(C()),b.copy(x),n.update()}(t);break;case a.PAN:if(!1===n.enablePan)return;!function(t){y.set(t.clientX,t.clientY),v.subVectors(y,g).multiplyScalar(n.panSpeed),P(v.x,v.y),g.copy(y),n.update()}(t)}}(t))}function X(t){var e,r,i;!function(t){delete M[t.pointerId];for(let e=0;e<E.length;e++)if(E[e].pointerId==t.pointerId)return void E.splice(e,1)}(t),0===E.length&&(null==(e=n.domElement)||e.releasePointerCapture(t.pointerId),null==(r=n.domElement)||r.ownerDocument.removeEventListener("pointermove",q),null==(i=n.domElement)||i.ownerDocument.removeEventListener("pointerup",X)),n.dispatchEvent(o),s=a.NONE}function Y(t){!1===n.enabled||!1===n.enableZoom||s!==a.NONE&&s!==a.ROTATE||(t.preventDefault(),n.dispatchEvent(i),function(t){D(t),t.deltaY<0?O(C()):t.deltaY>0&&N(C()),n.update()}(t),n.dispatchEvent(o))}function K(t){!1!==n.enabled&&!1!==n.enablePan&&function(t){let e=!1;switch(t.code){case n.keys.UP:P(0,n.keyPanSpeed),e=!0;break;case n.keys.BOTTOM:P(0,-n.keyPanSpeed),e=!0;break;case n.keys.LEFT:P(n.keyPanSpeed,0),e=!0;break;case n.keys.RIGHT:P(-n.keyPanSpeed,0),e=!0}e&&(t.preventDefault(),n.update())}(t)}function Z(t){!1!==n.enabled&&t.preventDefault()}function J(t){let e=M[t.pointerId];void 0===e&&(e=new _f,M[t.pointerId]=e),e.set(t.pageX,t.pageY)}function Q(t){const e=t.pointerId===E[0].pointerId?E[1]:E[0];return M[e.pointerId]}void 0!==e&&this.connect(e),this.update()}}const kA=k.forwardRef(((t,e)=>{let{makeDefault:n,camera:r,regress:i,domElement:o,enableDamping:a=!0,keyEvents:s=!1,onChange:l,onStart:c,onEnd:u,...h}=t;const d=MC((t=>t.invalidate)),p=MC((t=>t.camera)),f=MC((t=>t.gl)),m=MC((t=>t.events)),g=MC((t=>t.setEvents)),y=MC((t=>t.set)),v=MC((t=>t.get)),b=MC((t=>t.performance)),x=r||p,_=o||m.connected||f.domElement,w=k.useMemo((()=>new AA(x)),[x]);return CC((()=>{w.enabled&&w.update()}),-1),k.useEffect((()=>(s&&w.connect(!0===s?_:s),w.connect(_),()=>{w.dispose()})),[s,_,i,w,d]),k.useEffect((()=>{const t=t=>{d(),i&&b.regress(),l&&l(t)},e=t=>{c&&c(t)},n=t=>{u&&u(t)};return w.addEventListener("change",t),w.addEventListener("start",e),w.addEventListener("end",n),()=>{w.removeEventListener("start",e),w.removeEventListener("end",n),w.removeEventListener("change",t)}}),[l,c,u,w,d,g]),k.useEffect((()=>{if(n){const t=v().controls;return y({controls:w}),()=>y({controls:t})}}),[n,w]),k.createElement("primitive",yA({ref:e,object:w,enableDamping:a},h))}));function IA(t){let{all:e,scene:n,camera:r}=t;const i=MC((t=>{let{gl:e}=t;return e})),o=MC((t=>{let{camera:e}=t;return e})),a=MC((t=>{let{scene:e}=t;return e}));return k.useLayoutEffect((()=>{const t=[];e&&(n||a).traverse((e=>{!1===e.visible&&(t.push(e),e.visible=!0)})),i.compile(n||a,r||o);const s=new Cy(128);new Ey(.01,1e5,s).update(i,n||a),s.dispose(),t.forEach((t=>t.visible=!1))}),[]),null}let RA=0;const PA=CM((t=>(hT.onStart=(e,n,r)=>{t({active:!0,item:e,loaded:n,total:r,progress:(n-RA)/(r-RA)*100})},hT.onLoad=()=>{t({active:!1})},hT.onError=e=>t((t=>({errors:[...t.errors,e]}))),hT.onProgress=(e,n,r)=>{n===r&&(RA=r),t({active:!0,item:e,loaded:n,total:r,progress:(n-RA)/(r-RA)*100||100})},{errors:[],active:!1,progress:0,item:"",loaded:0,total:0})));const NA=new $f,OA=new $f,DA=new $f,LA=new _f;function FA(t,e,n){const r=NA.setFromMatrixPosition(t.matrixWorld);r.project(e);const i=n.width/2,o=n.height/2;return[r.x*i+i,-r.y*o+o]}const UA=t=>Math.abs(t)<1e-10?0:t;function BA(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r="matrix3d(";for(let i=0;16!==i;i++)r+=UA(e[i]*t.elements[i])+(15!==i?",":")");return n+r}const zA=(jA=[1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1],t=>BA(t,jA));var jA;const VA=(t,e)=>BA(t,(t=>[1/t,1/t,1/t,1,-1/t,-1/t,-1/t,-1,1/t,1/t,1/t,1,1,1,1,1])(e),"translate(-50%,-50%)");const WA=k.forwardRef(((t,e)=>{let{children:n,eps:r=.001,style:i,className:o,prepend:a,center:s,fullscreen:l,portal:c,distanceFactor:u,sprite:h=!1,transform:d=!1,occlude:p,onOcclude:f,castShadow:m,receiveShadow:g,material:y,geometry:v,zIndexRange:b=[16777271,0],calculatePosition:x=FA,as:_="div",wrapperClass:w,pointerEvents:S="auto",...T}=t;const{gl:E,camera:M,scene:C,size:A,raycaster:I,events:P,viewport:N}=MC(),[O]=k.useState((()=>document.createElement(_))),D=k.useRef(),L=k.useRef(null),F=k.useRef(0),U=k.useRef([0,0]),B=k.useRef(null),z=k.useRef(null),j=(null==c?void 0:c.current)||P.connected||E.domElement.parentNode,V=k.useRef(null),W=k.useRef(!1),G=k.useMemo((()=>p&&"blending"!==p||Array.isArray(p)&&p.length&&function(t){return t&&"object"===typeof t&&"current"in t}(p[0])),[p]);k.useLayoutEffect((()=>{const t=E.domElement;p&&"blending"===p?(t.style.zIndex="".concat(Math.floor(b[0]/2)),t.style.position="absolute",t.style.pointerEvents="none"):(t.style.zIndex=null,t.style.position=null,t.style.pointerEvents=null)}),[p]),k.useLayoutEffect((()=>{if(L.current){const t=D.current=R.createRoot(O);if(C.updateMatrixWorld(),d)O.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const t=x(L.current,M,A);O.style.cssText="position:absolute;top:0;left:0;transform:translate3d(".concat(t[0],"px,").concat(t[1],"px,0);transform-origin:0 0;")}return j&&(a?j.prepend(O):j.appendChild(O)),()=>{j&&j.removeChild(O),t.unmount()}}}),[j,d]),k.useLayoutEffect((()=>{w&&(O.className=w)}),[w]);const H=k.useMemo((()=>d?{position:"absolute",top:0,left:0,width:A.width,height:A.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:s?"translate3d(-50%,-50%,0)":"none",...l&&{top:-A.height/2,left:-A.width/2,width:A.width,height:A.height},...i}),[i,s,l,A,d]),q=k.useMemo((()=>({position:"absolute",pointerEvents:S})),[S]);k.useLayoutEffect((()=>{var t,r;(W.current=!1,d)?null==(t=D.current)||t.render(k.createElement("div",{ref:B,style:H},k.createElement("div",{ref:z,style:q},k.createElement("div",{ref:e,className:o,style:i,children:n})))):null==(r=D.current)||r.render(k.createElement("div",{ref:e,style:H,className:o,children:n}))}));const X=k.useRef(!0);CC((t=>{if(L.current){M.updateMatrixWorld(),L.current.updateWorldMatrix(!0,!1);const t=d?U.current:x(L.current,M,A);if(d||Math.abs(F.current-M.zoom)>r||Math.abs(U.current[0]-t[0])>r||Math.abs(U.current[1]-t[1])>r){const e=function(t,e){const n=NA.setFromMatrixPosition(t.matrixWorld),r=OA.setFromMatrixPosition(e.matrixWorld),i=n.sub(r),o=e.getWorldDirection(DA);return i.angleTo(o)>Math.PI/2}(L.current,M);let n=!1;G&&(Array.isArray(p)?n=p.map((t=>t.current)):"blending"!==p&&(n=[C]));const r=X.current;if(n){const t=function(t,e,n,r){const i=NA.setFromMatrixPosition(t.matrixWorld),o=i.clone();o.project(e),LA.set(o.x,o.y),n.setFromCamera(LA,e);const a=n.intersectObjects(r,!0);if(a.length){const t=a[0].distance;return i.distanceTo(n.ray.origin)<t}return!0}(L.current,M,I,n);X.current=t&&!e}else X.current=!e;r!==X.current&&(f?f(!X.current):O.style.display=X.current?"block":"none");const i=Math.floor(b[0]/2),o=p?G?[b[0],i]:[i-1,0]:b;if(O.style.zIndex="".concat(function(t,e,n){if(e instanceof Sy||e instanceof Zy){const r=NA.setFromMatrixPosition(t.matrixWorld),i=OA.setFromMatrixPosition(e.matrixWorld),o=r.distanceTo(i),a=(n[1]-n[0])/(e.far-e.near),s=n[1]-a*e.far;return Math.round(a*o+s)}}(L.current,M,o)),d){const[t,e]=[A.width/2,A.height/2],n=M.projectionMatrix.elements[5]*e,{isOrthographicCamera:r,top:i,left:o,bottom:a,right:s}=M,l=zA(M.matrixWorldInverse),c=r?"scale(".concat(n,")translate(").concat(UA(-(s+o)/2),"px,").concat(UA((i+a)/2),"px)"):"translateZ(".concat(n,"px)");let d=L.current.matrixWorld;h&&(d=M.matrixWorldInverse.clone().transpose().copyPosition(d).scale(L.current.scale),d.elements[3]=d.elements[7]=d.elements[11]=0,d.elements[15]=1),O.style.width=A.width+"px",O.style.height=A.height+"px",O.style.perspective=r?"":"".concat(n,"px"),B.current&&z.current&&(B.current.style.transform="".concat(c).concat(l,"translate(").concat(t,"px,").concat(e,"px)"),z.current.style.transform=VA(d,1/((u||10)/400)))}else{const e=void 0===u?1:function(t,e){if(e instanceof Zy)return e.zoom;if(e instanceof Sy){const n=NA.setFromMatrixPosition(t.matrixWorld),r=OA.setFromMatrixPosition(e.matrixWorld),i=e.fov*Math.PI/180,o=n.distanceTo(r);return 1/(2*Math.tan(i/2)*o)}return 1}(L.current,M)*u;O.style.transform="translate3d(".concat(t[0],"px,").concat(t[1],"px,0) scale(").concat(e,")")}U.current=t,F.current=M.zoom}}if(!G&&V.current&&!W.current)if(d){if(B.current){const t=B.current.children[0];if(null!=t&&t.clientWidth&&null!=t&&t.clientHeight){const{isOrthographicCamera:e}=M;if(e||v)T.scale&&(Array.isArray(T.scale)?T.scale instanceof $f?V.current.scale.copy(T.scale.clone().divideScalar(1)):V.current.scale.set(1/T.scale[0],1/T.scale[1],1/T.scale[2]):V.current.scale.setScalar(1/T.scale));else{const e=(u||10)/400,n=t.clientWidth*e,r=t.clientHeight*e;V.current.scale.set(n,r,1)}W.current=!0}}}else{const e=O.children[0];if(null!=e&&e.clientWidth&&null!=e&&e.clientHeight){const t=1/N.factor,n=e.clientWidth*t,r=e.clientHeight*t;V.current.scale.set(n,r,1),W.current=!0}V.current.lookAt(t.camera.position)}}));const Y=k.useMemo((()=>({vertexShader:d?void 0:'\n          /*\n            This shader is from the THREE\'s SpriteMaterial.\n            We need to turn the backing plane into a Sprite\n            (make it always face the camera) if "transfrom"\n            is false.\n          */\n          #include <common>\n\n          void main() {\n            vec2 center = vec2(0., 1.);\n            float rotation = 0.0;\n\n            // This is somewhat arbitrary, but it seems to work well\n            // Need to figure out how to derive this dynamically if it even matters\n            float size = 0.03;\n\n            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n            vec2 scale;\n            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\n            bool isPerspective = isPerspectiveMatrix( projectionMatrix );\n            if ( isPerspective ) scale *= - mvPosition.z;\n\n            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;\n            vec2 rotatedPosition;\n            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n            mvPosition.xy += rotatedPosition;\n\n            gl_Position = projectionMatrix * mvPosition;\n          }\n      ',fragmentShader:"\n        void main() {\n          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\n        }\n      "})),[d]);return k.createElement("group",yA({},T,{ref:L}),p&&!G&&k.createElement("mesh",{castShadow:m,receiveShadow:g,ref:V},v||k.createElement("planeGeometry",null),y||k.createElement("shaderMaterial",{side:Fu,vertexShader:Y.vertexShader,fragmentShader:Y.fragmentShader})))})),GA=()=>{const{progress:t}=PA();return(0,Dn.jsxs)(WA,{as:"div",center:!0,style:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},children:[(0,Dn.jsx)("span",{className:"canvas-loader"}),(0,Dn.jsxs)("p",{style:{fontSize:14,color:"#F1F1F1",fontWeight:800,marginTop:40},children:[t.toFixed(2),"%"]})]})},HA=t=>{const[e]=mA([t.imgUrl]);return(0,Dn.jsxs)(gA,{speed:2.5,rotationIntensity:1,floatIntensity:2,children:[(0,Dn.jsx)("ambientLight",{intensity:.25}),(0,Dn.jsx)("directionalLight",{position:[0,0,.05]}),(0,Dn.jsxs)("mesh",{castShadow:!0,receiveShadow:!0,scale:2.75,children:[(0,Dn.jsx)("icosahedronGeometry",{args:[1,2]}),(0,Dn.jsx)("meshStandardMaterial",{color:"#3d3d3d",polygonOffset:!0,polygonOffsetFactor:-5,flatShading:!0}),(0,Dn.jsx)(_A,{position:[0,0,1],rotation:[2*Math.PI,0,6.25],flatShading:!0,map:e})]})]})},qA=t=>{let{icon:e}=t;return(0,Dn.jsxs)(pA,{frameloop:"always",gl:{preserveDrawingBuffer:!0},children:[(0,Dn.jsxs)(k.Suspense,{fallback:(0,Dn.jsx)(GA,{}),children:[(0,Dn.jsx)(kA,{enableZoom:!1,position0:0}),(0,Dn.jsx)(HA,{imgUrl:e})]}),(0,Dn.jsx)(IA,{all:!0})]})},XA=[{name:"python",icon:"/static/images/technos/python.png"},{name:"linux",icon:"/static/images/technos/linux.png"},{name:"git",icon:"/static/images/technos/git.png"},{name:"sql",icon:"/static/images/technos/sql.png"},{name:"aws",icon:"/static/images/technos/aws.png"},{name:"docker",icon:"/static/images/technos/docker.png"},{name:"scikitlearn",icon:"/static/images/technos/scikitlearn.png"},{name:"pytorch",icon:"/static/images/technos/pytorch.png"}],YA=[{name:"cpp",icon:"/static/images/technos/cpp.png"},{name:"rust",icon:"/static/images/technos/rust.png"},{name:"html_css",icon:"/static/images/technos/html_css.png"},{name:"react",icon:"/static/images/technos/react.png"},{name:"reactnative",icon:"/static/images/technos/reactnative.png"},{name:"kotlin",icon:"/static/images/technos/kotlin.png"},{name:"onnx",icon:"/static/images/technos/onnx.png"},{name:"opencv",icon:"/static/images/technos/opencv.png"}],KA={hidden:{y:"100vh",opacity:0}},ZA={hidden:{y:"-100vh",opacity:0}},JA={visible:{y:0,opacity:1,transition:{duration:1.5,ease:"easeInOut"}}},QA=()=>{const[t,e]=(0,k.useState)(!1),[n,r]=(0,k.useState)(!1),[i,o]=(0,k.useState)(!1);return(0,Dn.jsxs)("div",{className:"homepage",children:[(0,Dn.jsx)("div",{style:{backgroundImage:"url(/static/images/alka7.png)",backgroundSize:"cover",backgroundPosition:"center",height:"100%",width:"100%",position:"fixed",top:0,left:0,zIndex:-1,opacity:.25}}),(0,Dn.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",height:"100%"},children:[i&&(0,Dn.jsx)("div",{className:"justify-center w-2/5 mt-48 pl-4",children:(0,Dn.jsxs)(Su.div,{variants:{...KA,...JA},initial:"hidden",animate:"visible",children:[(0,Dn.jsx)("div",{className:"card-title justify-center my-6 text-base text-center",children:"I work with following Technos / Tools :"}),(0,Dn.jsx)("div",{className:"grid grid-cols-4 gap-4 place-items-center",children:XA.map(((t,e)=>(0,Dn.jsx)("div",{className:"w-28 h-28",children:(0,Dn.jsx)(qA,{icon:t.icon})},"".concat(t.name,"-").concat(e))))})]})}),(0,Dn.jsxs)("div",{className:"card w-1/2 h-1/3 bg-base-100 shadow-xl opacity-75 mt-48 mx-20",style:{display:"flex",flexDirection:"column",justifyContent:"space-between"},children:[(0,Dn.jsxs)("div",{className:"card-body",children:[(0,Dn.jsx)("h2",{className:"card-title justify-center text-center",children:(0,Dn.jsx)(Yn,{sequence:["Mahamadou ABOUBACAR",1e3,()=>r(!0)],speed:75,style:{fontSize:"1.10em"},cursor:!1})}),n&&(0,Dn.jsx)("h3",{className:"card-title justify-center text-center",children:(0,Dn.jsx)(Yn,{sequence:["Senior Freelance",1e3,()=>e(!0)],speed:75,style:{fontSize:"1.05em"},cursor:!1})}),t&&(0,Dn.jsx)("h3",{className:"card-title justify-center text-center",children:(0,Dn.jsx)(Yn,{sequence:["Data Engineering | Data Science",1e3,()=>o(!0)],speed:75,style:{fontSize:"1.0em"},cursor:!1})})]}),(0,Dn.jsxs)("div",{className:"flex w-full pb-5 justify-center",id:"links",style:{padding:"1rem"},children:[(0,Dn.jsx)("a",{href:"https://github.com/AlkaSaliss",rel:"noopener noreferrer",target:"_blank",children:(0,Dn.jsx)("div",{className:"grid w-24 h-24  card bg-base-300 rounded-box place-items-center",children:(0,Dn.jsx)(On,{icon:"mdi:github",style:{fontSize:"3.5em"}})})}),(0,Dn.jsx)("div",{className:"divider divider-horizontal mx-10"}),(0,Dn.jsx)("a",{href:"https://www.linkedin.com/in/alkai",rel:"noopener noreferrer",target:"_blank",children:(0,Dn.jsx)("div",{className:"grid w-24 h-24  card bg-base-300 rounded-box place-items-center",children:(0,Dn.jsx)(On,{icon:"mdi:linkedin",style:{fontSize:"3.5em"}})})}),(0,Dn.jsx)("div",{className:"divider divider-horizontal mx-10"}),(0,Dn.jsx)("a",{href:"https://stackoverflow.com/users/7437524/alka",rel:"noopener noreferrer",target:"_blank",children:(0,Dn.jsx)("div",{className:"grid w-24 h-24  card bg-base-300 rounded-box place-items-center",children:(0,Dn.jsx)(On,{icon:"devicon-plain:stackoverflow-wordmark",style:{fontSize:"3.5em"}})})})]})]}),i&&(0,Dn.jsx)("div",{className:"justify-center w-2/5 mt-48 pr-4",children:(0,Dn.jsxs)(Su.div,{variants:{...ZA,...JA},initial:"hidden",animate:"visible",children:[(0,Dn.jsx)("div",{className:"card-title justify-center mt-8 text-base text-center",children:"I'm also interested a lot in on device machine learning, and that's why I've worked on some side projects to familiarize with high performance languages and web/mobile technologies:"}),(0,Dn.jsx)("div",{className:"grid grid-cols-4 gap-4 place-items-center",children:YA.map(((t,e)=>(0,Dn.jsx)("div",{className:"w-28 h-28 place-items-center",children:(0,Dn.jsx)(qA,{icon:t.icon})},"".concat(t.name,"-").concat(e))))})]})})]})]})},$A=t=>(0,Dn.jsxs)("div",{className:"grid grid-cols-12 gap-4",children:[(0,Dn.jsx)("div",{className:"col-span-2 font-bold text-lg",children:t.blockName}),(0,Dn.jsx)("div",{className:"col-span-10",children:t.children})]}),tk=t=>(0,Dn.jsx)("div",{className:"skill mb-4",children:(0,Dn.jsxs)("div",{className:"grid grid-cols-12 gap-4 items-center",children:[(0,Dn.jsx)("div",{className:"col-span-4 text-right",children:(0,Dn.jsx)("span",{children:t.skill})}),(0,Dn.jsx)("div",{className:"col-span-8 flex items-center",children:(0,Dn.jsx)("span",{className:"skill-label",children:(t=>t>=75?"Expert":t>=50?"Advanced":t>=25?"Intermediate":"Beginner")(t.progress)})})]})}),ek=t=>(0,Dn.jsx)("div",{className:"education p-4",children:(0,Dn.jsxs)("div",{className:"grid grid-cols-12 gap-4",children:[(0,Dn.jsx)("div",{className:"col-span-4",children:(0,Dn.jsxs)("p",{className:"text-lg",children:[t.startYear," - ",t.endYear]})}),(0,Dn.jsxs)("div",{className:"col-span-8",children:[(0,Dn.jsx)("h4",{className:"text-xl mt-0 underline italic",children:t.degree}),(0,Dn.jsxs)("p",{children:[(0,Dn.jsx)("strong",{className:"underline",children:"School: "}),t.schoolName]}),(0,Dn.jsxs)("p",{children:[(0,Dn.jsx)("strong",{className:"underline",children:"Major: "}),t.major]})]})]})}),nk=t=>(0,Dn.jsx)("div",{className:"experience mb-8",children:(0,Dn.jsxs)("div",{className:"grid grid-cols-12 gap-4",children:[(0,Dn.jsx)("div",{className:"col-span-4",children:(0,Dn.jsxs)("p",{className:"text-lg",children:[t.startYear," - ",t.endYear]})}),(0,Dn.jsxs)("div",{className:"col-span-8",children:[(0,Dn.jsx)("h4",{className:"text-xl mt-0 underline italic",children:t.jobName}),(0,Dn.jsxs)("p",{children:[(0,Dn.jsx)("strong",{className:"underline",children:"Company: "}),t.company," | ",(0,Dn.jsx)("strong",{className:"underline",children:"Team: "}),t.team]}),(0,Dn.jsxs)("div",{children:[(0,Dn.jsx)("strong",{className:"underline",children:"Subject: "}),t.showSubjectList?(0,Dn.jsx)("ul",{className:"custom-list",children:t.subject.map(((t,e)=>(0,Dn.jsx)("li",{children:t},e)))}):(0,Dn.jsx)("span",{children:t.subject})]}),(0,Dn.jsxs)("p",{children:[(0,Dn.jsx)("strong",{className:"underline",children:"Methods: "}),t.methods]}),(0,Dn.jsxs)("p",{children:[(0,Dn.jsx)("strong",{className:"underline",children:"Tools: "}),t.tools]}),(0,Dn.jsx)("p",{children:t.jobDescription})]})]})}),rk=t=>{let{navBarHeight:e}=t;return(0,Dn.jsxs)("div",{className:"flex h-screen overflow-hidden",style:{paddingTop:e},children:[(0,Dn.jsx)("div",{className:"w-2/5 bg-gray-800  p-4",children:(0,Dn.jsxs)("div",{className:"flex flex-col items-center mt-5",children:[(0,Dn.jsx)("img",{alt:"Profile",src:"/static/images/alka3.jpg",className:"rounded-full w-52 h-52"}),(0,Dn.jsx)("h2",{className:"text-xl mt-2",children:"Mahamadou S. ABOUBACAR A."}),(0,Dn.jsx)("h4",{className:"text-xl",children:"Senior Consultant"}),(0,Dn.jsx)("h5",{className:"text-xl",children:"Data Science | Data Engineering"}),(0,Dn.jsx)("hr",{className:"border-t-2 border-slate-400 w-1/2 my-5"}),(0,Dn.jsx)("p",{className:"text-base mb-4",children:"Currently working as Freelance Data Engineer consultant"}),(0,Dn.jsxs)("p",{className:"text-base text-justify",children:["I've worked for ",(new Date).getFullYear()-2018,"+ years across various data science and data engineering roles. I started my career as a Research Engineer in machine learning for cyber security, then switched to computer vision applied to video surveillance images analysis.",(0,Dn.jsx)("br",{}),"I later joined Quantmetry (a cutting edge AI consulting company, later acquired by Capgemini) as a senior data scientist consultant and worked for various customers ranging from public, defense, transportation, energy sectors on various subjects such as tweets analysis app, web scraping app for supply chain, Reliable AI training content creation, building data processing pipelines for Renewable energy datalake ...",(0,Dn.jsx)("br",{}),"In my free time, I am mostly interested in subjects related to Computer Vision, NLP, on-device machine learning and data visualization. That's why I explore high performant languages (C/C++,  Rust) and web/mobile development (React/react-native, Kotlin) You can find some of my side projects on this website and also",(0,Dn.jsx)("a",{href:"https://github.com/AlkaSaliss?tab=repositories",rel:"noopener noreferrer",target:"_blank",className:"text-blue-500",children:" on github."})]})]})}),(0,Dn.jsxs)("div",{className:"w-3/5 p-4 overflow-y-auto",children:[(0,Dn.jsx)("h2",{className:"text-xl mb-4",children:"Experience"}),(0,Dn.jsx)(nk,{startYear:"July 2024",endYear:"Now",jobName:"Senior Freelance Data Engineer",company:"Customer in Energy Sector",team:"DataLab",showSubjectList:!1,subject:"I work as an admin/tech lead on an Analytics platform, based on AWS services. I create data ingestion pipelines to bring data from multiple sources (api, s3, databases, ...) on this platform for end users to conduct their use cases. I also lead training sessions to onboard new users on the platform. Finally, I serve as intermediary the product company and end users to report bugs, issues and feature requests.",methods:"Data Ingestion, ETL pipelines, Platform Engineering",tools:"Python, AWS S3/Athena/Redshift/Sagemaker/Glue/Quicksight, Pandas/Polars , Jupyter, Terraform/Terragrunt"}),(0,Dn.jsx)(nk,{startYear:"October 2021",endYear:"June 2024",jobName:"Senior Consultant Data Scientist | Data Engineer",company:"Quantmetry (acquired by Capgemini), Paris, France",team:"Computer Vision",showSubjectList:!0,subject:["Worked 2 years at EDF Renouvelables, as tech lead data engineer of a team that builds AWS data pipelines (Lambda/SQS, S3, Athena, Redshift, RDS, EventBridge, Grafana) to ingest and process data coming from solar power sites around the world. The curated data is then used by sites and assets managers to calculate some KPI to assess solar energy production performance","Built a Streamlit web app for a customer in Transport sector, to allow them to analyze multiple data sources and produce a formatted Excel report. The app cut the analysis time from 1-2 weeks to less than 10mins, allow users to focus on analysis interpretation and ","Worked with various customer on different subjects, such as POC on uncertainty estimation for satellite images segmentation, tweets scrapping and analysis (topic modelling, sentiment analysis), web scraping for supply chain, training content creation on reliable AI topics, ..."],methods:"Data ingestion | Data processing | Machine learning | Deep learning | Data analysis/visualization | Software engineering",tools:"Python | AWS | Pytorch | Scikit-learn | Docker | Linux | Spark"}),(0,Dn.jsx)(nk,{startYear:"Nov 2018",endYear:"Oct 2021",jobName:"Research Engineer - Machine Learning",company:"Atos, Paris region, France",team:"Machine Intelligence for Cyber Security",showSubjectList:!0,subject:["Developed computer vision segmentation models for video surveillance analysis","Worked on machine learning based frameworks for anomaly detection in cyber security"],methods:"Machine learning | Deep learning | Data analysis/visualization | Software engineering",tools:"Python | Pytorch | Tensorflow/Keras | Scikit-learn | Docker | Linux | Spark"}),(0,Dn.jsx)(nk,{startYear:"Apr 2018",endYear:"Sep 2018",jobName:"Deep learning intern",company:"Equancy, Paris, France",team:"Data Intelligence",showSubjectList:!1,subject:"Deep learning based approaches for 'translating natural language questions to SQL queries'",methods:"Sequence-to-sequence Deep Learning models",tools:"Python | Tensorflow/Keras | Spacy | Scikit-learn | AWS"}),(0,Dn.jsx)(nk,{startYear:"June 2017",endYear:"Aug 2017",jobName:"Statistician intern",company:"Le Cr\xe9dit Lyonnais (LCL), Paris region, France",team:"Quantitative Models Validation",showSubjectList:!1,subject:"Anomaly analysis on credit risk data",methods:"Regression models | Exploratory data analysis",tools:"SAS"}),(0,Dn.jsx)(nk,{startYear:"Feb 2016",endYear:"June 2016",jobName:"Statistician/Economist intern",company:"Laboratoire de Recherches Economiques et Mon\xe9taires (LAREM), Dakar, S\xe9n\xe9gal",team:"LAREM",showSubjectList:!1,subject:"Determinant of innovation in small & medium enterprises in Ivory-Coast",methods:"Multivariate Probit models | Exploratory data analysis",tools:"R | Stata"}),(0,Dn.jsx)("hr",{className:"border-t-2 border-blue-500 my-4"}),(0,Dn.jsx)("h2",{className:"text-xl mb-4",children:"Education"}),(0,Dn.jsx)(ek,{startYear:2020,endYear:2020,degree:"Data Engineering Nanodegree",schoolName:"UDACITY -Online",major:"ETL pipelines with PostgreSQL | ETL with AWS RedShift/S3 | Big Data with Pyspark and AWS EMR | Data pipelines with Airflow"}),(0,Dn.jsx)(ek,{startYear:2016,endYear:2018,degree:"Engineering degree in Data Science / Statistics / Data Engineering",schoolName:"ENSAI - Rennes, France",major:"Machine Learning Modeling | Statistics/Econometrics | Big Data technologies | Software & Web Development"}),(0,Dn.jsx)(ek,{startYear:2012,endYear:2016,degree:"Engineering degree in Statistics / Economics",schoolName:"ENSAE - Dakar, Senegal",major:"Statistical modelling | Econometrics | Survey Data collection and analysis | Economics"}),(0,Dn.jsx)("hr",{className:"border-t-2 border-blue-500 my-4"}),(0,Dn.jsx)("h2",{className:"text-xl mb-4",children:"Skills"}),(0,Dn.jsxs)($A,{blockName:"Data Engineering",children:[(0,Dn.jsx)(tk,{skill:"Data ingestion pipelines on AWS (Lambda, SQS, SNS, S3, Glue, SageMaker)",progress:74}),(0,Dn.jsx)(tk,{skill:"Data warehouse (Redshift, RDS)",progress:74}),(0,Dn.jsx)(tk,{skill:"Data processing (Pandas, Polars, PySpark)",progress:90}),(0,Dn.jsx)(tk,{skill:"Monitoring/Alerting (CloudWatch metrics, and alarms, SNS, Grafana)",progress:74}),(0,Dn.jsx)(tk,{skill:"CI/CD (Codecommit, Codebuild, CodePipeline, Codeartifact)",progress:74})]}),(0,Dn.jsx)("hr",{className:"border-t border-gray-300 my-4 mx-20"}),(0,Dn.jsxs)($A,{blockName:"Data Science",children:[(0,Dn.jsx)(tk,{skill:"Linear models | Tree-based models | Clustering techniques (Scikit-learn)",progress:90}),(0,Dn.jsx)(tk,{skill:"Deep Learning (Pytorch, Tensorflow/Keras)",progress:90}),(0,Dn.jsx)(tk,{skill:"Data Analysis (Pandas, Numpy, Jupyter)",progress:90}),(0,Dn.jsx)(tk,{skill:"Data Viz (d3.js, Matplotlib, Bokeh, Plotly)",progress:80})]}),(0,Dn.jsx)("hr",{className:"border-t border-gray-300 my-4 mx-20"}),(0,Dn.jsxs)($A,{blockName:"Software | Web | Mobile Dev",children:[(0,Dn.jsx)(tk,{skill:"Python",progress:95}),(0,Dn.jsx)(tk,{skill:"Linux | Bash | Docker",progress:70}),(0,Dn.jsx)(tk,{skill:"Git",progress:80}),(0,Dn.jsx)(tk,{skill:"Javascript | React | React-Native",progress:49}),(0,Dn.jsx)(tk,{skill:"C++ | Rust",progress:49}),(0,Dn.jsx)(tk,{skill:"Kotlin | Android studio",progress:49}),(0,Dn.jsx)(tk,{skill:"HTML | CSS",progress:49})]})]})]})};function ik(t,e){let n,r;if(void 0===e)for(const i of t)null!=i&&(void 0===n?i>=i&&(n=r=i):(n>i&&(n=i),r<i&&(r=i)));else{let i=-1;for(let o of t)null!=(o=e(o,++i,t))&&(void 0===n?o>=o&&(n=r=o):(n>o&&(n=o),r<o&&(r=o)))}return[n,r]}function ok(t,e){let n;if(void 0===e)for(const r of t)null!=r&&(n<r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(n<i||void 0===n&&i>=i)&&(n=i)}return n}function ak(){}function sk(t){return null==t?ak:function(){return this.querySelector(t)}}function lk(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}function ck(){return[]}function uk(t){return null==t?ck:function(){return this.querySelectorAll(t)}}function hk(t){return function(){return this.matches(t)}}function dk(t){return function(e){return e.matches(t)}}var pk=Array.prototype.find;function fk(){return this.firstElementChild}var mk=Array.prototype.filter;function gk(){return Array.from(this.children)}function yk(t){return new Array(t.length)}function vk(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function bk(t,e,n,r,i,o){for(var a,s=0,l=e.length,c=o.length;s<c;++s)(a=e[s])?(a.__data__=o[s],r[s]=a):n[s]=new vk(t,o[s]);for(;s<l;++s)(a=e[s])&&(i[s]=a)}function xk(t,e,n,r,i,o,a){var s,l,c,u=new Map,h=e.length,d=o.length,p=new Array(h);for(s=0;s<h;++s)(l=e[s])&&(p[s]=c=a.call(l,l.__data__,s,e)+"",u.has(c)?i[s]=l:u.set(c,l));for(s=0;s<d;++s)c=a.call(t,o[s],s,o)+"",(l=u.get(c))?(r[s]=l,l.__data__=o[s],u.delete(c)):n[s]=new vk(t,o[s]);for(s=0;s<h;++s)(l=e[s])&&u.get(p[s])===l&&(i[s]=l)}function _k(t){return t.__data__}function wk(t){return"object"===typeof t&&"length"in t?t:Array.from(t)}function Sk(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}vk.prototype={constructor:vk,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var Tk="http://www.w3.org/1999/xhtml";const Ek={svg:"http://www.w3.org/2000/svg",xhtml:Tk,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Mk(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),Ek.hasOwnProperty(e)?{space:Ek[e],local:t}:t}function Ck(t){return function(){this.removeAttribute(t)}}function Ak(t){return function(){this.removeAttributeNS(t.space,t.local)}}function kk(t,e){return function(){this.setAttribute(t,e)}}function Ik(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Rk(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function Pk(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Nk(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Ok(t){return function(){this.style.removeProperty(t)}}function Dk(t,e,n){return function(){this.style.setProperty(t,e,n)}}function Lk(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function Fk(t,e){return t.style.getPropertyValue(e)||Nk(t).getComputedStyle(t,null).getPropertyValue(e)}function Uk(t){return function(){delete this[t]}}function Bk(t,e){return function(){this[t]=e}}function zk(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function jk(t){return t.trim().split(/^|\s+/)}function Vk(t){return t.classList||new Wk(t)}function Wk(t){this._node=t,this._names=jk(t.getAttribute("class")||"")}function Gk(t,e){for(var n=Vk(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function Hk(t,e){for(var n=Vk(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function qk(t){return function(){Gk(this,t)}}function Xk(t){return function(){Hk(this,t)}}function Yk(t,e){return function(){(e.apply(this,arguments)?Gk:Hk)(this,t)}}function Kk(){this.textContent=""}function Zk(t){return function(){this.textContent=t}}function Jk(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function Qk(){this.innerHTML=""}function $k(t){return function(){this.innerHTML=t}}function tI(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function eI(){this.nextSibling&&this.parentNode.appendChild(this)}function nI(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function rI(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Tk&&e.documentElement.namespaceURI===Tk?e.createElement(t):e.createElementNS(n,t)}}function iI(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function oI(t){var e=Mk(t);return(e.local?iI:rI)(e)}function aI(){return null}function sI(){var t=this.parentNode;t&&t.removeChild(this)}function lI(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function cI(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function uI(t){return function(){var e=this.__on;if(e){for(var n,r=0,i=-1,o=e.length;r<o;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++i]=n:this.removeEventListener(n.type,n.listener,n.options);++i?e.length=i:delete this.__on}}}function hI(t,e,n){return function(){var r,i=this.__on,o=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(i)for(var a=0,s=i.length;a<s;++a)if((r=i[a]).type===t.type&&r.name===t.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=o,r.options=n),void(r.value=e);this.addEventListener(t.type,o,n),r={type:t.type,name:t.name,value:e,listener:o,options:n},i?i.push(r):this.__on=[r]}}function dI(t,e,n){var r=Nk(t),i=r.CustomEvent;"function"===typeof i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function pI(t,e){return function(){return dI(this,t,e)}}function fI(t,e){return function(){return dI(this,t,e.apply(this,arguments))}}Wk.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var mI=[null];function gI(t,e){this._groups=t,this._parents=e}function yI(){return new gI([[document.documentElement]],mI)}gI.prototype=yI.prototype={constructor:gI,select:function(t){"function"!==typeof t&&(t=sk(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,a,s=e[i],l=s.length,c=r[i]=new Array(l),u=0;u<l;++u)(o=s[u])&&(a=t.call(o,o.__data__,u,s))&&("__data__"in o&&(a.__data__=o.__data__),c[u]=a);return new gI(r,this._parents)},selectAll:function(t){t="function"===typeof t?function(t){return function(){return lk(t.apply(this,arguments))}}(t):uk(t);for(var e=this._groups,n=e.length,r=[],i=[],o=0;o<n;++o)for(var a,s=e[o],l=s.length,c=0;c<l;++c)(a=s[c])&&(r.push(t.call(a,a.__data__,c,s)),i.push(a));return new gI(r,i)},selectChild:function(t){return this.select(null==t?fk:function(t){return function(){return pk.call(this.children,t)}}("function"===typeof t?t:dk(t)))},selectChildren:function(t){return this.selectAll(null==t?gk:function(t){return function(){return mk.call(this.children,t)}}("function"===typeof t?t:dk(t)))},filter:function(t){"function"!==typeof t&&(t=hk(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,a=e[i],s=a.length,l=r[i]=[],c=0;c<s;++c)(o=a[c])&&t.call(o,o.__data__,c,a)&&l.push(o);return new gI(r,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,_k);var n,r=e?xk:bk,i=this._parents,o=this._groups;"function"!==typeof t&&(n=t,t=function(){return n});for(var a=o.length,s=new Array(a),l=new Array(a),c=new Array(a),u=0;u<a;++u){var h=i[u],d=o[u],p=d.length,f=wk(t.call(h,h&&h.__data__,u,i)),m=f.length,g=l[u]=new Array(m),y=s[u]=new Array(m);r(h,d,g,y,c[u]=new Array(p),f,e);for(var v,b,x=0,_=0;x<m;++x)if(v=g[x]){for(x>=_&&(_=x+1);!(b=y[_])&&++_<m;);v._next=b||null}}return(s=new gI(s,i))._enter=l,s._exit=c,s},enter:function(){return new gI(this._enter||this._groups.map(yk),this._parents)},exit:function(){return new gI(this._exit||this._groups.map(yk),this._parents)},join:function(t,e,n){var r=this.enter(),i=this,o=this.exit();return"function"===typeof t?(r=t(r))&&(r=r.selection()):r=r.append(t+""),null!=e&&(i=e(i))&&(i=i.selection()),null==n?o.remove():n(o),r&&i?r.merge(i).order():i},merge:function(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,o=r.length,a=Math.min(i,o),s=new Array(i),l=0;l<a;++l)for(var c,u=n[l],h=r[l],d=u.length,p=s[l]=new Array(d),f=0;f<d;++f)(c=u[f]||h[f])&&(p[f]=c);for(;l<i;++l)s[l]=n[l];return new gI(s,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],o=i.length-1,a=i[o];--o>=0;)(r=i[o])&&(a&&4^r.compareDocumentPosition(a)&&a.parentNode.insertBefore(r,a),a=r);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=Sk);for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var a,s=n[o],l=s.length,c=i[o]=new Array(l),u=0;u<l;++u)(a=s[u])&&(c[u]=a);c.sort(e)}return new gI(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,o=e[n],a=0,s=o.length;a<s;++a)(i=o[a])&&t.call(i,i.__data__,a,o);return this},attr:function(t,e){var n=Mk(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?Ak:Ck:"function"===typeof e?n.local?Pk:Rk:n.local?Ik:kk)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?Ok:"function"===typeof e?Lk:Dk)(t,e,null==n?"":n)):Fk(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?Uk:"function"===typeof e?zk:Bk)(t,e)):this.node()[t]},classed:function(t,e){var n=jk(t+"");if(arguments.length<2){for(var r=Vk(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"===typeof e?Yk:e?qk:Xk)(n,e))},text:function(t){return arguments.length?this.each(null==t?Kk:("function"===typeof t?Jk:Zk)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?Qk:("function"===typeof t?tI:$k)(t)):this.node().innerHTML},raise:function(){return this.each(eI)},lower:function(){return this.each(nI)},append:function(t){var e="function"===typeof t?t:oI(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"===typeof t?t:oI(t),r=null==e?aI:"function"===typeof e?e:sk(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(sI)},clone:function(t){return this.select(t?cI:lI)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,i,o=function(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}(t+""),a=o.length;if(!(arguments.length<2)){for(s=e?hI:uI,r=0;r<a;++r)this.each(s(o[r],e,n));return this}var s=this.node().__on;if(s)for(var l,c=0,u=s.length;c<u;++c)for(r=0,l=s[c];r<a;++r)if((i=o[r]).type===l.type&&i.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"===typeof e?fI:pI)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r,i=t[e],o=0,a=i.length;o<a;++o)(r=i[o])&&(yield r)}};const vI=yI;var bI={value:()=>{}};function xI(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new _I(r)}function _I(t){this._=t}function wI(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function SI(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=bI,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}_I.prototype=xI.prototype={constructor:_I,on:function(t,e){var n,r,i=this._,o=(r=i,(t+"").trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");if(n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),t&&!r.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}}))),a=-1,s=o.length;if(!(arguments.length<2)){if(null!=e&&"function"!==typeof e)throw new Error("invalid callback: "+e);for(;++a<s;)if(n=(t=o[a]).type)i[n]=SI(i[n],t.name,e);else if(null==e)for(n in i)i[n]=SI(i[n],t.name,null);return this}for(;++a<s;)if((n=(t=o[a]).type)&&(n=wI(i[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new _I(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,n=(r=this._[t]).length;o<n;++o)r[o].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};const TI=xI;var EI,MI,CI=0,AI=0,kI=0,II=1e3,RI=0,PI=0,NI=0,OI="object"===typeof performance&&performance.now?performance:Date,DI="object"===typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function LI(){return PI||(DI(FI),PI=OI.now()+NI)}function FI(){PI=0}function UI(){this._call=this._time=this._next=null}function BI(t,e,n){var r=new UI;return r.restart(t,e,n),r}function zI(){PI=(RI=OI.now())+NI,CI=AI=0;try{!function(){LI(),++CI;for(var t,e=EI;e;)(t=PI-e._time)>=0&&e._call.call(void 0,t),e=e._next;--CI}()}finally{CI=0,function(){var t,e,n=EI,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:EI=e);MI=t,VI(r)}(),PI=0}}function jI(){var t=OI.now(),e=t-RI;e>II&&(NI-=e,RI=t)}function VI(t){CI||(AI&&(AI=clearTimeout(AI)),t-PI>24?(t<1/0&&(AI=setTimeout(zI,t-OI.now()-NI)),kI&&(kI=clearInterval(kI))):(kI||(RI=OI.now(),kI=setInterval(jI,II)),CI=1,DI(zI)))}function WI(t,e,n){var r=new UI;return e=null==e?0:+e,r.restart((n=>{r.stop(),t(n+e)}),e,n),r}UI.prototype=BI.prototype={constructor:UI,restart:function(t,e,n){if("function"!==typeof t)throw new TypeError("callback is not a function");n=(null==n?LI():+n)+(null==e?0:+e),this._next||MI===this||(MI?MI._next=this:EI=this,MI=this),this._call=t,this._time=n,VI()},stop:function(){this._call&&(this._call=null,this._time=1/0,VI())}};var GI=TI("start","end","cancel","interrupt"),HI=[],qI=0,XI=1,YI=2,KI=3,ZI=4,JI=5,QI=6;function $I(t,e,n,r,i,o){var a=t.__transition;if(a){if(n in a)return}else t.__transition={};!function(t,e,n){var r,i=t.__transition;function o(t){n.state=XI,n.timer.restart(a,n.delay,n.time),n.delay<=t&&a(t-n.delay)}function a(o){var c,u,h,d;if(n.state!==XI)return l();for(c in i)if((d=i[c]).name===n.name){if(d.state===KI)return WI(a);d.state===ZI?(d.state=QI,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete i[c]):+c<e&&(d.state=QI,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete i[c])}if(WI((function(){n.state===KI&&(n.state=ZI,n.timer.restart(s,n.delay,n.time),s(o))})),n.state=YI,n.on.call("start",t,t.__data__,n.index,n.group),n.state===YI){for(n.state=KI,r=new Array(h=n.tween.length),c=0,u=-1;c<h;++c)(d=n.tween[c].value.call(t,t.__data__,n.index,n.group))&&(r[++u]=d);r.length=u+1}}function s(e){for(var i=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(l),n.state=JI,1),o=-1,a=r.length;++o<a;)r[o].call(t,i);n.state===JI&&(n.on.call("end",t,t.__data__,n.index,n.group),l())}function l(){for(var r in n.state=QI,n.timer.stop(),delete i[e],i)return;delete t.__transition}i[e]=n,n.timer=BI(o,0,n.time)}(t,n,{name:e,index:r,group:i,on:GI,tween:HI,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:qI})}function tR(t,e){var n=nR(t,e);if(n.state>qI)throw new Error("too late; already scheduled");return n}function eR(t,e){var n=nR(t,e);if(n.state>KI)throw new Error("too late; already running");return n}function nR(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function rR(t,e){var n,r,i,o=t.__transition,a=!0;if(o){for(i in e=null==e?null:e+"",o)(n=o[i]).name===e?(r=n.state>YI&&n.state<JI,n.state=QI,n.timer.stop(),n.on.call(r?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete o[i]):a=!1;a&&delete t.__transition}}function iR(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var oR,aR=180/Math.PI,sR={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function lR(t,e,n,r,i,o){var a,s,l;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(l=t*n+e*r)&&(n-=t*l,r-=e*l),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,l/=s),t*r<e*n&&(t=-t,e=-e,l=-l,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*aR,skewX:Math.atan(l)*aR,scaleX:a,scaleY:s}}function cR(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(o,a){var s=[],l=[];return o=t(o),a=t(a),function(t,r,i,o,a,s){if(t!==i||r!==o){var l=a.push("translate(",null,e,null,n);s.push({i:l-4,x:iR(t,i)},{i:l-2,x:iR(r,o)})}else(i||o)&&a.push("translate("+i+e+o+n)}(o.translateX,o.translateY,a.translateX,a.translateY,s,l),function(t,e,n,o){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),o.push({i:n.push(i(n)+"rotate(",null,r)-2,x:iR(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(o.rotate,a.rotate,s,l),function(t,e,n,o){t!==e?o.push({i:n.push(i(n)+"skewX(",null,r)-2,x:iR(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(o.skewX,a.skewX,s,l),function(t,e,n,r,o,a){if(t!==n||e!==r){var s=o.push(i(o)+"scale(",null,",",null,")");a.push({i:s-4,x:iR(t,n)},{i:s-2,x:iR(e,r)})}else 1===n&&1===r||o.push(i(o)+"scale("+n+","+r+")")}(o.scaleX,o.scaleY,a.scaleX,a.scaleY,s,l),o=a=null,function(t){for(var e,n=-1,r=l.length;++n<r;)s[(e=l[n]).i]=e.x(t);return s.join("")}}}var uR=cR((function(t){const e=new("function"===typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?sR:lR(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),hR=cR((function(t){return null==t?sR:(oR||(oR=document.createElementNS("http://www.w3.org/2000/svg","g")),oR.setAttribute("transform",t),(t=oR.transform.baseVal.consolidate())?lR((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):sR)}),", ",")",")");function dR(t,e){var n,r;return function(){var i=eR(this,t),o=i.tween;if(o!==n)for(var a=0,s=(r=n=o).length;a<s;++a)if(r[a].name===e){(r=r.slice()).splice(a,1);break}i.tween=r}}function pR(t,e,n){var r,i;if("function"!==typeof n)throw new Error;return function(){var o=eR(this,t),a=o.tween;if(a!==r){i=(r=a).slice();for(var s={name:e,value:n},l=0,c=i.length;l<c;++l)if(i[l].name===e){i[l]=s;break}l===c&&i.push(s)}o.tween=i}}function fR(t,e,n){var r=t._id;return t.each((function(){var t=eR(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return nR(t,r).value[e]}}function mR(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function gR(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function yR(){}var vR=.7,bR=1/vR,xR="\\s*([+-]?\\d+)\\s*",_R="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",wR="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",SR=/^#([0-9a-f]{3,8})$/,TR=new RegExp("^rgb\\(".concat(xR,",").concat(xR,",").concat(xR,"\\)$")),ER=new RegExp("^rgb\\(".concat(wR,",").concat(wR,",").concat(wR,"\\)$")),MR=new RegExp("^rgba\\(".concat(xR,",").concat(xR,",").concat(xR,",").concat(_R,"\\)$")),CR=new RegExp("^rgba\\(".concat(wR,",").concat(wR,",").concat(wR,",").concat(_R,"\\)$")),AR=new RegExp("^hsl\\(".concat(_R,",").concat(wR,",").concat(wR,"\\)$")),kR=new RegExp("^hsla\\(".concat(_R,",").concat(wR,",").concat(wR,",").concat(_R,"\\)$")),IR={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function RR(){return this.rgb().formatHex()}function PR(){return this.rgb().formatRgb()}function NR(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=SR.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?OR(e):3===n?new FR(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?DR(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?DR(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=TR.exec(t))?new FR(e[1],e[2],e[3],1):(e=ER.exec(t))?new FR(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=MR.exec(t))?DR(e[1],e[2],e[3],e[4]):(e=CR.exec(t))?DR(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=AR.exec(t))?WR(e[1],e[2]/100,e[3]/100,1):(e=kR.exec(t))?WR(e[1],e[2]/100,e[3]/100,e[4]):IR.hasOwnProperty(t)?OR(IR[t]):"transparent"===t?new FR(NaN,NaN,NaN,0):null}function OR(t){return new FR(t>>16&255,t>>8&255,255&t,1)}function DR(t,e,n,r){return r<=0&&(t=e=n=NaN),new FR(t,e,n,r)}function LR(t,e,n,r){return 1===arguments.length?((i=t)instanceof yR||(i=NR(i)),i?new FR((i=i.rgb()).r,i.g,i.b,i.opacity):new FR):new FR(t,e,n,null==r?1:r);var i}function FR(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function UR(){return"#".concat(VR(this.r)).concat(VR(this.g)).concat(VR(this.b))}function BR(){const t=zR(this.opacity);return"".concat(1===t?"rgb(":"rgba(").concat(jR(this.r),", ").concat(jR(this.g),", ").concat(jR(this.b)).concat(1===t?")":", ".concat(t,")"))}function zR(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function jR(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function VR(t){return((t=jR(t))<16?"0":"")+t.toString(16)}function WR(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new HR(t,e,n,r)}function GR(t){if(t instanceof HR)return new HR(t.h,t.s,t.l,t.opacity);if(t instanceof yR||(t=NR(t)),!t)return new HR;if(t instanceof HR)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),a=NaN,s=o-i,l=(o+i)/2;return s?(a=e===o?(n-r)/s+6*(n<r):n===o?(r-e)/s+2:(e-n)/s+4,s/=l<.5?o+i:2-o-i,a*=60):s=l>0&&l<1?0:a,new HR(a,s,l,t.opacity)}function HR(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function qR(t){return(t=(t||0)%360)<0?t+360:t}function XR(t){return Math.max(0,Math.min(1,t||0))}function YR(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function KR(t,e,n,r,i){var o=t*t,a=o*t;return((1-3*t+3*o-a)*e+(4-6*o+3*a)*n+(1+3*t+3*o-3*a)*r+a*i)/6}mR(yR,NR,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:RR,formatHex:RR,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return GR(this).formatHsl()},formatRgb:PR,toString:PR}),mR(FR,LR,gR(yR,{brighter(t){return t=null==t?bR:Math.pow(bR,t),new FR(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?vR:Math.pow(vR,t),new FR(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new FR(jR(this.r),jR(this.g),jR(this.b),zR(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:UR,formatHex:UR,formatHex8:function(){return"#".concat(VR(this.r)).concat(VR(this.g)).concat(VR(this.b)).concat(VR(255*(isNaN(this.opacity)?1:this.opacity)))},formatRgb:BR,toString:BR})),mR(HR,(function(t,e,n,r){return 1===arguments.length?GR(t):new HR(t,e,n,null==r?1:r)}),gR(yR,{brighter(t){return t=null==t?bR:Math.pow(bR,t),new HR(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?vR:Math.pow(vR,t),new HR(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new FR(YR(t>=240?t-240:t+120,i,r),YR(t,i,r),YR(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new HR(qR(this.h),XR(this.s),XR(this.l),zR(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=zR(this.opacity);return"".concat(1===t?"hsl(":"hsla(").concat(qR(this.h),", ").concat(100*XR(this.s),"%, ").concat(100*XR(this.l),"%").concat(1===t?")":", ".concat(t,")"))}}));const ZR=t=>()=>t;function JR(t,e){return function(n){return t+n*e}}function QR(t){return 1===(t=+t)?$R:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):ZR(isNaN(e)?n:e)}}function $R(t,e){var n=e-t;return n?JR(t,n):ZR(isNaN(t)?e:t)}const tP=function t(e){var n=QR(e);function r(t,e){var r=n((t=LR(t)).r,(e=LR(e)).r),i=n(t.g,e.g),o=n(t.b,e.b),a=$R(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=o(e),t.opacity=a(e),t+""}}return r.gamma=t,r}(1);function eP(t){return function(e){var n,r,i=e.length,o=new Array(i),a=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=LR(e[n]),o[n]=r.r||0,a[n]=r.g||0,s[n]=r.b||0;return o=t(o),a=t(a),s=t(s),r.opacity=1,function(t){return r.r=o(t),r.g=a(t),r.b=s(t),r+""}}}eP((function(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],o=t[r+1],a=r>0?t[r-1]:2*i-o,s=r<e-1?t[r+2]:2*o-i;return KR((n-r/e)*e,a,i,o,s)}})),eP((function(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),i=t[(r+e-1)%e],o=t[r%e],a=t[(r+1)%e],s=t[(r+2)%e];return KR((n-r/e)*e,i,o,a,s)}}));var nP=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,rP=new RegExp(nP.source,"g");function iP(t,e){var n,r,i,o=nP.lastIndex=rP.lastIndex=0,a=-1,s=[],l=[];for(t+="",e+="";(n=nP.exec(t))&&(r=rP.exec(e));)(i=r.index)>o&&(i=e.slice(o,i),s[a]?s[a]+=i:s[++a]=i),(n=n[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,l.push({i:a,x:iR(n,r)})),o=rP.lastIndex;return o<e.length&&(i=e.slice(o),s[a]?s[a]+=i:s[++a]=i),s.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var n,r=0;r<e;++r)s[(n=l[r]).i]=n.x(t);return s.join("")})}function oP(t,e){var n;return("number"===typeof e?iR:e instanceof NR?tP:(n=NR(e))?(e=n,tP):iP)(t,e)}function aP(t){return function(){this.removeAttribute(t)}}function sP(t){return function(){this.removeAttributeNS(t.space,t.local)}}function lP(t,e,n){var r,i,o=n+"";return function(){var a=this.getAttribute(t);return a===o?null:a===r?i:i=e(r=a,n)}}function cP(t,e,n){var r,i,o=n+"";return function(){var a=this.getAttributeNS(t.space,t.local);return a===o?null:a===r?i:i=e(r=a,n)}}function uP(t,e,n){var r,i,o;return function(){var a,s,l=n(this);if(null!=l)return(a=this.getAttribute(t))===(s=l+"")?null:a===r&&s===i?o:(i=s,o=e(r=a,l));this.removeAttribute(t)}}function hP(t,e,n){var r,i,o;return function(){var a,s,l=n(this);if(null!=l)return(a=this.getAttributeNS(t.space,t.local))===(s=l+"")?null:a===r&&s===i?o:(i=s,o=e(r=a,l));this.removeAttributeNS(t.space,t.local)}}function dP(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&function(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}(t,i)),n}return i._value=e,i}function pP(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&function(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}(t,i)),n}return i._value=e,i}function fP(t,e){return function(){tR(this,t).delay=+e.apply(this,arguments)}}function mP(t,e){return e=+e,function(){tR(this,t).delay=e}}function gP(t,e){return function(){eR(this,t).duration=+e.apply(this,arguments)}}function yP(t,e){return e=+e,function(){eR(this,t).duration=e}}var vP=vI.prototype.constructor;function bP(t){return function(){this.style.removeProperty(t)}}var xP=0;function _P(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function wP(){return++xP}var SP=vI.prototype;_P.prototype=function(t){return vI().transition(t)}.prototype={constructor:_P,select:function(t){var e=this._name,n=this._id;"function"!==typeof t&&(t=sk(t));for(var r=this._groups,i=r.length,o=new Array(i),a=0;a<i;++a)for(var s,l,c=r[a],u=c.length,h=o[a]=new Array(u),d=0;d<u;++d)(s=c[d])&&(l=t.call(s,s.__data__,d,c))&&("__data__"in s&&(l.__data__=s.__data__),h[d]=l,$I(h[d],e,n,d,h,nR(s,n)));return new _P(o,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!==typeof t&&(t=uk(t));for(var r=this._groups,i=r.length,o=[],a=[],s=0;s<i;++s)for(var l,c=r[s],u=c.length,h=0;h<u;++h)if(l=c[h]){for(var d,p=t.call(l,l.__data__,h,c),f=nR(l,n),m=0,g=p.length;m<g;++m)(d=p[m])&&$I(d,e,n,m,p,f);o.push(p),a.push(l)}return new _P(o,a,e,n)},selectChild:SP.selectChild,selectChildren:SP.selectChildren,filter:function(t){"function"!==typeof t&&(t=hk(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,a=e[i],s=a.length,l=r[i]=[],c=0;c<s;++c)(o=a[c])&&t.call(o,o.__data__,c,a)&&l.push(o);return new _P(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),a=new Array(r),s=0;s<o;++s)for(var l,c=e[s],u=n[s],h=c.length,d=a[s]=new Array(h),p=0;p<h;++p)(l=c[p]||u[p])&&(d[p]=l);for(;s<r;++s)a[s]=e[s];return new _P(a,this._parents,this._name,this._id)},selection:function(){return new vP(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=wP(),r=this._groups,i=r.length,o=0;o<i;++o)for(var a,s=r[o],l=s.length,c=0;c<l;++c)if(a=s[c]){var u=nR(a,e);$I(a,t,n,c,s,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new _P(r,this._parents,t,n)},call:SP.call,nodes:SP.nodes,node:SP.node,size:SP.size,empty:SP.empty,each:SP.each,on:function(t,e){var n=this._id;return arguments.length<2?nR(this.node(),n).on.on(t):this.each(function(t,e,n){var r,i,o=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?tR:eR;return function(){var a=o(this,t),s=a.on;s!==r&&(i=(r=s).copy()).on(e,n),a.on=i}}(n,t,e))},attr:function(t,e){var n=Mk(t),r="transform"===n?hR:oP;return this.attrTween(t,"function"===typeof e?(n.local?hP:uP)(n,r,fR(this,"attr."+t,e)):null==e?(n.local?sP:aP)(n):(n.local?cP:lP)(n,r,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!==typeof e)throw new Error;var r=Mk(t);return this.tween(n,(r.local?dP:pP)(r,e))},style:function(t,e,n){var r="transform"===(t+="")?uR:oP;return null==e?this.styleTween(t,function(t,e){var n,r,i;return function(){var o=Fk(this,t),a=(this.style.removeProperty(t),Fk(this,t));return o===a?null:o===n&&a===r?i:i=e(n=o,r=a)}}(t,r)).on("end.style."+t,bP(t)):"function"===typeof e?this.styleTween(t,function(t,e,n){var r,i,o;return function(){var a=Fk(this,t),s=n(this),l=s+"";return null==s&&(this.style.removeProperty(t),l=s=Fk(this,t)),a===l?null:a===r&&l===i?o:(i=l,o=e(r=a,s))}}(t,r,fR(this,"style."+t,e))).each(function(t,e){var n,r,i,o,a="style."+e,s="end."+a;return function(){var l=eR(this,t),c=l.on,u=null==l.value[a]?o||(o=bP(e)):void 0;c===n&&i===u||(r=(n=c).copy()).on(s,i=u),l.on=r}}(this._id,t)):this.styleTween(t,function(t,e,n){var r,i,o=n+"";return function(){var a=Fk(this,t);return a===o?null:a===r?i:i=e(r=a,n)}}(t,r,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!==typeof e)throw new Error;return this.tween(r,function(t,e,n){var r,i;function o(){var o=e.apply(this,arguments);return o!==i&&(r=(i=o)&&function(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}(t,o,n)),r}return o._value=e,o}(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"===typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(fR(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!==typeof t)throw new Error;return this.tween(e,function(t){var e,n;function r(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&function(t){return function(e){this.textContent=t.call(this,e)}}(r)),e}return r._value=t,r}(t))},remove:function(){return this.on("end.remove",function(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,i=nR(this.node(),n).tween,o=0,a=i.length;o<a;++o)if((r=i[o]).name===t)return r.value;return null}return this.each((null==e?dR:pR)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"===typeof t?fP:mP)(e,t)):nR(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"===typeof t?gP:yP)(e,t)):nR(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(function(t,e){if("function"!==typeof e)throw new Error;return function(){eR(this,t).ease=e}}(e,t)):nR(this.node(),e).ease},easeVarying:function(t){if("function"!==typeof t)throw new Error;return this.each(function(t,e){return function(){var n=e.apply(this,arguments);if("function"!==typeof n)throw new Error;eR(this,t).ease=n}}(this._id,t))},end:function(){var t,e,n=this,r=n._id,i=n.size();return new Promise((function(o,a){var s={value:a},l={value:function(){0===--i&&o()}};n.each((function(){var n=eR(this,r),i=n.on;i!==t&&((e=(t=i).copy())._.cancel.push(s),e._.interrupt.push(s),e._.end.push(l)),n.on=e})),0===i&&o()}))},[Symbol.iterator]:SP[Symbol.iterator]};var TP={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function EP(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error("transition ".concat(e," not found"));return n}vI.prototype.interrupt=function(t){return this.each((function(){rR(this,t)}))},vI.prototype.transition=function(t){var e,n;t instanceof _P?(e=t._id,t=t._name):(e=wP(),(n=TP).time=LI(),t=null==t?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var a,s=r[o],l=s.length,c=0;c<l;++c)(a=s[c])&&$I(a,t,e,c,s,n||EP(a,e));return new _P(r,this._parents,t,e)};const{abs:MP,max:CP,min:AP}=Math;function kP(t){return[+t[0],+t[1]]}function IP(t){return[kP(t[0]),kP(t[1])]}["w","e"].map(RP),["n","s"].map(RP),["n","w","e","s","nw","ne","sw","se"].map(RP);function RP(t){return{type:t}}var PP={},NP={};function OP(t){return new Function("d","return {"+t.map((function(t,e){return JSON.stringify(t)+": d["+e+'] || ""'})).join(",")+"}")}function DP(t){var e=Object.create(null),n=[];return t.forEach((function(t){for(var r in t)r in e||n.push(e[r]=r)})),n}function LP(t,e){var n=t+"",r=n.length;return r<e?new Array(e-r+1).join(0)+n:n}function FP(t){var e,n=t.getUTCHours(),r=t.getUTCMinutes(),i=t.getUTCSeconds(),o=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":((e=t.getUTCFullYear())<0?"-"+LP(-e,6):e>9999?"+"+LP(e,6):LP(e,4))+"-"+LP(t.getUTCMonth()+1,2)+"-"+LP(t.getUTCDate(),2)+(o?"T"+LP(n,2)+":"+LP(r,2)+":"+LP(i,2)+"."+LP(o,3)+"Z":i?"T"+LP(n,2)+":"+LP(r,2)+":"+LP(i,2)+"Z":r||n?"T"+LP(n,2)+":"+LP(r,2)+"Z":"")}function UP(t){var e=new RegExp('["'+t+"\n\r]"),n=t.charCodeAt(0);function r(t,e){var r,i=[],o=t.length,a=0,s=0,l=o<=0,c=!1;function u(){if(l)return NP;if(c)return c=!1,PP;var e,r,i=a;if(34===t.charCodeAt(i)){for(;a++<o&&34!==t.charCodeAt(a)||34===t.charCodeAt(++a););return(e=a)>=o?l=!0:10===(r=t.charCodeAt(a++))?c=!0:13===r&&(c=!0,10===t.charCodeAt(a)&&++a),t.slice(i+1,e-1).replace(/""/g,'"')}for(;a<o;){if(10===(r=t.charCodeAt(e=a++)))c=!0;else if(13===r)c=!0,10===t.charCodeAt(a)&&++a;else if(r!==n)continue;return t.slice(i,e)}return l=!0,t.slice(i,o)}for(10===t.charCodeAt(o-1)&&--o,13===t.charCodeAt(o-1)&&--o;(r=u())!==NP;){for(var h=[];r!==PP&&r!==NP;)h.push(r),r=u();e&&null==(h=e(h,s++))||i.push(h)}return i}function i(e,n){return e.map((function(e){return n.map((function(t){return a(e[t])})).join(t)}))}function o(e){return e.map(a).join(t)}function a(t){return null==t?"":t instanceof Date?FP(t):e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,e){var n,i,o=r(t,(function(t,r){if(n)return n(t,r-1);i=t,n=e?function(t,e){var n=OP(t);return function(r,i){return e(n(r),i,t)}}(t,e):OP(t)}));return o.columns=i||[],o},parseRows:r,format:function(e,n){return null==n&&(n=DP(e)),[n.map(a).join(t)].concat(i(e,n)).join("\n")},formatBody:function(t,e){return null==e&&(e=DP(t)),i(t,e).join("\n")},formatRows:function(t){return t.map(o).join("\n")},formatRow:o,formatValue:a}}var BP=UP(","),zP=BP.parse,jP=(BP.parseRows,BP.format,BP.formatBody,BP.formatRows,BP.formatRow,BP.formatValue,UP("\t")),VP=jP.parse;jP.parseRows,jP.format,jP.formatBody,jP.formatRows,jP.formatRow,jP.formatValue;function WP(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.text()}function GP(t){return function(e,n,r){return 2===arguments.length&&"function"===typeof n&&(r=n,n=void 0),function(t,e){return fetch(t,e).then(WP)}(e,n).then((function(e){return t(e,r)}))}}var HP=GP(zP);GP(VP);function qP(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}class XP extends Map{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:JP;if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),null!=t)for(const[n,r]of t)this.set(n,r)}get(t){return super.get(YP(this,t))}has(t){return super.has(YP(this,t))}set(t,e){return super.set(KP(this,t),e)}delete(t){return super.delete(ZP(this,t))}}Set;function YP(t,e){let{_intern:n,_key:r}=t;const i=r(e);return n.has(i)?n.get(i):e}function KP(t,e){let{_intern:n,_key:r}=t;const i=r(e);return n.has(i)?n.get(i):(n.set(i,e),e)}function ZP(t,e){let{_intern:n,_key:r}=t;const i=r(e);return n.has(i)&&(e=n.get(i),n.delete(i)),e}function JP(t){return null!==t&&"object"===typeof t?t.valueOf():t}const QP=Symbol("implicit");function $P(){var t=new XP,e=[],n=[],r=QP;function i(i){let o=t.get(i);if(void 0===o){if(r!==QP)return r;t.set(i,o=e.push(i)-1)}return n[o%n.length]}return i.domain=function(n){if(!arguments.length)return e.slice();e=[],t=new XP;for(const r of n)t.has(r)||t.set(r,e.push(r)-1);return i},i.range=function(t){return arguments.length?(n=Array.from(t),i):n.slice()},i.unknown=function(t){return arguments.length?(r=t,i):r},i.copy=function(){return $P(e,n).unknown(r)},qP.apply(i,arguments),i}function tN(){var t,e,n=$P().unknown(void 0),r=n.domain,i=n.range,o=0,a=1,s=!1,l=0,c=0,u=.5;function h(){var n=r().length,h=a<o,d=h?a:o,p=h?o:a;t=(p-d)/Math.max(1,n-l+2*c),s&&(t=Math.floor(t)),d+=(p-d-t*(n-l))*u,e=t*(1-l),s&&(d=Math.round(d),e=Math.round(e));var f=function(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),o=new Array(i);++r<i;)o[r]=t+r*n;return o}(n).map((function(e){return d+t*e}));return i(h?f.reverse():f)}return delete n.unknown,n.domain=function(t){return arguments.length?(r(t),h()):r()},n.range=function(t){return arguments.length?([o,a]=t,o=+o,a=+a,h()):[o,a]},n.rangeRound=function(t){return[o,a]=t,o=+o,a=+a,s=!0,h()},n.bandwidth=function(){return e},n.step=function(){return t},n.round=function(t){return arguments.length?(s=!!t,h()):s},n.padding=function(t){return arguments.length?(l=Math.min(1,c=+t),h()):l},n.paddingInner=function(t){return arguments.length?(l=Math.min(1,t),h()):l},n.paddingOuter=function(t){return arguments.length?(c=+t,h()):c},n.align=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),h()):u},n.copy=function(){return tN(r(),[o,a]).round(s).paddingInner(l).paddingOuter(c).align(u)},qP.apply(h(),arguments)}const eN=Math.sqrt(50),nN=Math.sqrt(10),rN=Math.sqrt(2);function iN(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),o=r/Math.pow(10,i),a=o>=eN?10:o>=nN?5:o>=rN?2:1;let s,l,c;return i<0?(c=Math.pow(10,-i)/a,s=Math.round(t*c),l=Math.round(e*c),s/c<t&&++s,l/c>e&&--l,c=-c):(c=Math.pow(10,i)*a,s=Math.round(t/c),l=Math.round(e/c),s*c<t&&++s,l*c>e&&--l),l<s&&.5<=n&&n<2?iN(t,e,2*n):[s,l,c]}function oN(t,e,n){return iN(t=+t,e=+e,n=+n)[2]}function aN(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function sN(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function lN(t){let e,n,r;function i(t,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(i<o){if(0!==e(r,r))return o;do{const e=i+o>>>1;n(t[e],r)<0?i=e+1:o=e}while(i<o)}return i}return 2!==t.length?(e=aN,n=(e,n)=>aN(t(e),n),r=(e,n)=>t(e)-n):(e=t===aN||t===sN?t:cN,n=t,r=t),{left:i,center:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const o=i(t,e,n,(arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length)-1);return o>n&&r(t[o-1],e)>-r(t[o],e)?o-1:o},right:function(t,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(i<o){if(0!==e(r,r))return o;do{const e=i+o>>>1;n(t[e],r)<=0?i=e+1:o=e}while(i<o)}return i}}}function cN(){return 0}const uN=lN(aN),hN=uN.right,dN=(uN.left,lN((function(t){return null===t?NaN:+t})).center,hN);function pN(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,o=new Array(i),a=new Array(r);for(n=0;n<i;++n)o[n]=yN(t[n],e[n]);for(;n<r;++n)a[n]=e[n];return function(t){for(n=0;n<i;++n)a[n]=o[n](t);return a}}function fN(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function mN(t,e){var n,r={},i={};for(n in null!==t&&"object"===typeof t||(t={}),null!==e&&"object"===typeof e||(e={}),e)n in t?r[n]=yN(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}}function gN(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,i=e.slice();return function(o){for(n=0;n<r;++n)i[n]=t[n]*(1-o)+e[n]*o;return i}}function yN(t,e){var n,r,i=typeof e;return null==e||"boolean"===i?ZR(e):("number"===i?iR:"string"===i?(n=NR(e))?(e=n,tP):iP:e instanceof NR?tP:e instanceof Date?fN:(r=e,!ArrayBuffer.isView(r)||r instanceof DataView?Array.isArray(e)?pN:"function"!==typeof e.valueOf&&"function"!==typeof e.toString||isNaN(e)?mN:iR:gN))(t,e)}function vN(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function bN(t){return+t}var xN=[0,1];function _N(t){return t}function wN(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:(n=isNaN(e)?NaN:.5,function(){return n});var n}function SN(t,e,n){var r=t[0],i=t[1],o=e[0],a=e[1];return i<r?(r=wN(i,r),o=n(a,o)):(r=wN(r,i),o=n(o,a)),function(t){return o(r(t))}}function TN(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),o=new Array(r),a=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<r;)i[a]=wN(t[a],t[a+1]),o[a]=n(e[a],e[a+1]);return function(e){var n=dN(t,e,1,r)-1;return o[n](i[n](e))}}function EN(){var t,e,n,r,i,o,a=xN,s=xN,l=yN,c=_N;function u(){var t=Math.min(a.length,s.length);return c!==_N&&(c=function(t,e){var n;return t>e&&(n=t,t=e,e=n),function(n){return Math.max(t,Math.min(e,n))}}(a[0],a[t-1])),r=t>2?TN:SN,i=o=null,h}function h(e){return null==e||isNaN(e=+e)?n:(i||(i=r(a.map(t),s,l)))(t(c(e)))}return h.invert=function(n){return c(e((o||(o=r(s,a.map(t),iR)))(n)))},h.domain=function(t){return arguments.length?(a=Array.from(t,bN),u()):a.slice()},h.range=function(t){return arguments.length?(s=Array.from(t),u()):s.slice()},h.rangeRound=function(t){return s=Array.from(t),l=vN,u()},h.clamp=function(t){return arguments.length?(c=!!t||_N,u()):c!==_N},h.interpolate=function(t){return arguments.length?(l=t,u()):l},h.unknown=function(t){return arguments.length?(n=t,h):n},function(n,r){return t=n,e=r,u()}}var MN,CN=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function AN(t){if(!(e=CN.exec(t)))throw new Error("invalid format: "+t);var e;return new kN({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function kN(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function IN(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function RN(t){return(t=IN(Math.abs(t)))?t[1]:NaN}function PN(t,e){var n=IN(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}AN.prototype=kN.prototype,kN.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const NN={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>PN(100*t,e),r:PN,s:function(t,e){var n=IN(t,e);if(!n)return t+"";var r=n[0],i=n[1],o=i-(MN=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+IN(t,Math.max(0,e+o-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function ON(t){return t}var DN,LN,FN,UN=Array.prototype.map,BN=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function zN(t){var e,n,r=void 0===t.grouping||void 0===t.thousands?ON:(e=UN.call(t.grouping,Number),n=t.thousands+"",function(t,r){for(var i=t.length,o=[],a=0,s=e[0],l=0;i>0&&s>0&&(l+s+1>r&&(s=Math.max(1,r-l)),o.push(t.substring(i-=s,i+s)),!((l+=s+1)>r));)s=e[a=(a+1)%e.length];return o.reverse().join(n)}),i=void 0===t.currency?"":t.currency[0]+"",o=void 0===t.currency?"":t.currency[1]+"",a=void 0===t.decimal?".":t.decimal+"",s=void 0===t.numerals?ON:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(UN.call(t.numerals,String)),l=void 0===t.percent?"%":t.percent+"",c=void 0===t.minus?"\u2212":t.minus+"",u=void 0===t.nan?"NaN":t.nan+"";function h(t){var e=(t=AN(t)).fill,n=t.align,h=t.sign,d=t.symbol,p=t.zero,f=t.width,m=t.comma,g=t.precision,y=t.trim,v=t.type;"n"===v?(m=!0,v="g"):NN[v]||(void 0===g&&(g=12),y=!0,v="g"),(p||"0"===e&&"="===n)&&(p=!0,e="0",n="=");var b="$"===d?i:"#"===d&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",x="$"===d?o:/[%p]/.test(v)?l:"",_=NN[v],w=/[defgprs%]/.test(v);function S(t){var i,o,l,d=b,S=x;if("c"===v)S=_(t)+S,t="";else{var T=(t=+t)<0||1/t<0;if(t=isNaN(t)?u:_(Math.abs(t),g),y&&(t=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(!+t[r])break t;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),T&&0===+t&&"+"!==h&&(T=!1),d=(T?"("===h?h:c:"-"===h||"("===h?"":h)+d,S=("s"===v?BN[8+MN/3]:"")+S+(T&&"("===h?")":""),w)for(i=-1,o=t.length;++i<o;)if(48>(l=t.charCodeAt(i))||l>57){S=(46===l?a+t.slice(i+1):t.slice(i))+S,t=t.slice(0,i);break}}m&&!p&&(t=r(t,1/0));var E=d.length+t.length+S.length,M=E<f?new Array(f-E+1).join(e):"";switch(m&&p&&(t=r(M+t,M.length?f-S.length:1/0),M=""),n){case"<":t=d+t+S+M;break;case"=":t=d+M+t+S;break;case"^":t=M.slice(0,E=M.length>>1)+d+t+S+M.slice(E);break;default:t=M+d+t+S}return s(t)}return g=void 0===g?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),S.toString=function(){return t+""},S}return{format:h,formatPrefix:function(t,e){var n=h(((t=AN(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(RN(e)/3))),i=Math.pow(10,-r),o=BN[8+r/3];return function(t){return n(i*t)+o}}}}function jN(t,e,n,r){var i,o=function(t,e,n){n=+n;const r=(e=+e)<(t=+t),i=r?oN(e,t,n):oN(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}(t,e,n);switch((r=AN(null==r?",f":r)).type){case"s":var a=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(i=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(RN(e)/3)))-RN(Math.abs(t)))}(o,a))||(r.precision=i),FN(r,a);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,RN(e)-RN(t))+1}(o,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=function(t){return Math.max(0,-RN(Math.abs(t)))}(o))||(r.precision=i-2*("%"===r.type))}return LN(r)}function VN(t){var e=t.domain;return t.ticks=function(t){var n=e();return function(t,e,n){if(!((n=+n)>0))return[];if((t=+t)===(e=+e))return[t];const r=e<t,[i,o,a]=r?iN(e,t,n):iN(t,e,n);if(!(o>=i))return[];const s=o-i+1,l=new Array(s);if(r)if(a<0)for(let c=0;c<s;++c)l[c]=(o-c)/-a;else for(let c=0;c<s;++c)l[c]=(o-c)*a;else if(a<0)for(let c=0;c<s;++c)l[c]=(i+c)/-a;else for(let c=0;c<s;++c)l[c]=(i+c)*a;return l}(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var r=e();return jN(r[0],r[r.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var r,i,o=e(),a=0,s=o.length-1,l=o[a],c=o[s],u=10;for(c<l&&(i=l,l=c,c=i,i=a,a=s,s=i);u-- >0;){if((i=oN(l,c,n))===r)return o[a]=l,o[s]=c,e(o);if(i>0)l=Math.floor(l/i)*i,c=Math.ceil(c/i)*i;else{if(!(i<0))break;l=Math.ceil(l*i)/i,c=Math.floor(c*i)/i}r=i}return t},t}function WN(){var t=EN()(_N,_N);return t.copy=function(){return e=t,WN().domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown());var e},qP.apply(t,arguments),VN(t)}function GN(t){return"string"===typeof t?new gI([[document.querySelector(t)]],[document.documentElement]):new gI([[t]],mI)}function HN(t){return"string"===typeof t?new gI([document.querySelectorAll(t)],[document.documentElement]):new gI([lk(t)],mI)}DN=zN({thousands:",",grouping:[3],currency:["$",""]}),LN=DN.format,FN=DN.formatPrefix;const qN={capture:!0,passive:!1};function XN(t){t.preventDefault(),t.stopImmediatePropagation()}function YN(t){return((t=Math.exp(t))+1/t)/2}const KN=function t(e,n,r){function i(t,i){var o,a,s=t[0],l=t[1],c=t[2],u=i[0],h=i[1],d=i[2],p=u-s,f=h-l,m=p*p+f*f;if(m<1e-12)a=Math.log(d/c)/e,o=function(t){return[s+t*p,l+t*f,c*Math.exp(e*t*a)]};else{var g=Math.sqrt(m),y=(d*d-c*c+r*m)/(2*c*n*g),v=(d*d-c*c-r*m)/(2*d*n*g),b=Math.log(Math.sqrt(y*y+1)-y),x=Math.log(Math.sqrt(v*v+1)-v);a=(x-b)/e,o=function(t){var r,i=t*a,o=YN(b),u=c/(n*g)*(o*(r=e*i+b,((r=Math.exp(2*r))-1)/(r+1))-function(t){return((t=Math.exp(t))-1/t)/2}(b));return[s+u*p,l+u*f,c*o/YN(e*i+b)]}}return o.duration=1e3*a*e/Math.SQRT2,o}return i.rho=function(e){var n=Math.max(.001,+e),r=n*n;return t(n,r,r*r)},i}(Math.SQRT2,2,4);function ZN(t,e){if(t=function(t){let e;for(;e=t.sourceEvent;)t=e;return t}(t),void 0===e&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,[(r=r.matrixTransform(e.getScreenCTM().inverse())).x,r.y]}if(e.getBoundingClientRect){var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}}return[t.pageX,t.pageY]}const JN=t=>()=>t;function QN(t,e){let{sourceEvent:n,target:r,transform:i,dispatch:o}=e;Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:o}})}function $N(t,e,n){this.k=t,this.x=e,this.y=n}$N.prototype={constructor:$N,scale:function(t){return 1===t?this:new $N(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new $N(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var tO=new $N(1,0,0);function eO(t){t.stopImmediatePropagation()}function nO(t){t.preventDefault(),t.stopImmediatePropagation()}function rO(t){return(!t.ctrlKey||"wheel"===t.type)&&!t.button}function iO(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t).hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]:[[0,0],[t.clientWidth,t.clientHeight]]}function oO(){return this.__zoom||tO}function aO(t){return-t.deltaY*(1===t.deltaMode?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function sO(){return navigator.maxTouchPoints||"ontouchstart"in this}function lO(t,e,n){var r=t.invertX(e[0][0])-n[0][0],i=t.invertX(e[1][0])-n[1][0],o=t.invertY(e[0][1])-n[0][1],a=t.invertY(e[1][1])-n[1][1];return t.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),a>o?(o+a)/2:Math.min(0,o)||Math.max(0,a))}function cO(){var t,e,n,r=rO,i=iO,o=lO,a=aO,s=sO,l=[0,1/0],c=[[-1/0,-1/0],[1/0,1/0]],u=250,h=KN,d=TI("start","zoom","end"),p=500,f=150,m=0,g=10;function y(t){t.property("__zoom",oO).on("wheel.zoom",T,{passive:!1}).on("mousedown.zoom",E).on("dblclick.zoom",M).filter(s).on("touchstart.zoom",C).on("touchmove.zoom",A).on("touchend.zoom touchcancel.zoom",k).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function v(t,e){return(e=Math.max(l[0],Math.min(l[1],e)))===t.k?t:new $N(e,t.x,t.y)}function b(t,e,n){var r=e[0]-n[0]*t.k,i=e[1]-n[1]*t.k;return r===t.x&&i===t.y?t:new $N(t.k,r,i)}function x(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function _(t,e,n,r){t.on("start.zoom",(function(){w(this,arguments).event(r).start()})).on("interrupt.zoom end.zoom",(function(){w(this,arguments).event(r).end()})).tween("zoom",(function(){var t=this,o=arguments,a=w(t,o).event(r),s=i.apply(t,o),l=null==n?x(s):"function"===typeof n?n.apply(t,o):n,c=Math.max(s[1][0]-s[0][0],s[1][1]-s[0][1]),u=t.__zoom,d="function"===typeof e?e.apply(t,o):e,p=h(u.invert(l).concat(c/u.k),d.invert(l).concat(c/d.k));return function(t){if(1===t)t=d;else{var e=p(t),n=c/e[2];t=new $N(n,l[0]-e[0]*n,l[1]-e[1]*n)}a.zoom(null,t)}}))}function w(t,e,n){return!n&&t.__zooming||new S(t,e)}function S(t,e){this.that=t,this.args=e,this.active=0,this.sourceEvent=null,this.extent=i.apply(t,e),this.taps=0}function T(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];if(r.apply(this,arguments)){var s=w(this,n).event(t),u=this.__zoom,h=Math.max(l[0],Math.min(l[1],u.k*Math.pow(2,a.apply(this,arguments)))),d=ZN(t);if(s.wheel)s.mouse[0][0]===d[0]&&s.mouse[0][1]===d[1]||(s.mouse[1]=u.invert(s.mouse[0]=d)),clearTimeout(s.wheel);else{if(u.k===h)return;s.mouse=[d,u.invert(d)],rR(this),s.start()}nO(t),s.wheel=setTimeout((function(){s.wheel=null,s.end()}),f),s.zoom("mouse",o(b(v(u,h),s.mouse[0],s.mouse[1]),s.extent,c))}}function E(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),a=1;a<e;a++)i[a-1]=arguments[a];if(!n&&r.apply(this,arguments)){var s=t.currentTarget,l=w(this,i,!0).event(t),u=GN(t.view).on("mousemove.zoom",(function(t){if(nO(t),!l.moved){var e=t.clientX-d,n=t.clientY-p;l.moved=e*e+n*n>m}l.event(t).zoom("mouse",o(b(l.that.__zoom,l.mouse[0]=ZN(t,s),l.mouse[1]),l.extent,c))}),!0).on("mouseup.zoom",(function(t){u.on("mousemove.zoom mouseup.zoom",null),function(t,e){var n=t.document.documentElement,r=GN(t).on("dragstart.drag",null);e&&(r.on("click.drag",XN,qN),setTimeout((function(){r.on("click.drag",null)}),0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}(t.view,l.moved),nO(t),l.event(t).end()}),!0),h=ZN(t,s),d=t.clientX,p=t.clientY;!function(t){var e=t.document.documentElement,n=GN(t).on("dragstart.drag",XN,qN);"onselectstart"in e?n.on("selectstart.drag",XN,qN):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}(t.view),eO(t),l.mouse=[h,this.__zoom.invert(h)],rR(this),l.start()}}function M(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),a=1;a<e;a++)n[a-1]=arguments[a];if(r.apply(this,arguments)){var s=this.__zoom,l=ZN(t.changedTouches?t.changedTouches[0]:t,this),h=s.invert(l),d=s.k*(t.shiftKey?.5:2),p=o(b(v(s,d),l,h),i.apply(this,n),c);nO(t),u>0?GN(this).transition().duration(u).call(_,p,l,t):GN(this).call(y.transform,p,l,t)}}function C(n){for(var i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];if(r.apply(this,arguments)){var s,l,c,u,h=n.touches,d=h.length,f=w(this,o,n.changedTouches.length===d).event(n);for(eO(n),l=0;l<d;++l)u=[u=ZN(c=h[l],this),this.__zoom.invert(u),c.identifier],f.touch0?f.touch1||f.touch0[2]===u[2]||(f.touch1=u,f.taps=0):(f.touch0=u,s=!0,f.taps=1+!!t);t&&(t=clearTimeout(t)),s&&(f.taps<2&&(e=u[0],t=setTimeout((function(){t=null}),p)),rR(this),f.start())}}function A(t){if(this.__zooming){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var i,a,s,l,u=w(this,n).event(t),h=t.changedTouches,d=h.length;for(nO(t),i=0;i<d;++i)s=ZN(a=h[i],this),u.touch0&&u.touch0[2]===a.identifier?u.touch0[0]=s:u.touch1&&u.touch1[2]===a.identifier&&(u.touch1[0]=s);if(a=u.that.__zoom,u.touch1){var p=u.touch0[0],f=u.touch0[1],m=u.touch1[0],g=u.touch1[1],y=(y=m[0]-p[0])*y+(y=m[1]-p[1])*y,x=(x=g[0]-f[0])*x+(x=g[1]-f[1])*x;a=v(a,Math.sqrt(y/x)),s=[(p[0]+m[0])/2,(p[1]+m[1])/2],l=[(f[0]+g[0])/2,(f[1]+g[1])/2]}else{if(!u.touch0)return;s=u.touch0[0],l=u.touch0[1]}u.zoom("touch",o(b(a,s,l),u.extent,c))}}function k(t){for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];if(this.__zooming){var a,s,l=w(this,i).event(t),c=t.changedTouches,u=c.length;for(eO(t),n&&clearTimeout(n),n=setTimeout((function(){n=null}),p),a=0;a<u;++a)s=c[a],l.touch0&&l.touch0[2]===s.identifier?delete l.touch0:l.touch1&&l.touch1[2]===s.identifier&&delete l.touch1;if(l.touch1&&!l.touch0&&(l.touch0=l.touch1,delete l.touch1),l.touch0)l.touch0[1]=this.__zoom.invert(l.touch0[0]);else if(l.end(),2===l.taps&&(s=ZN(s,this),Math.hypot(e[0]-s[0],e[1]-s[1])<g)){var h=GN(this).on("dblclick.zoom");h&&h.apply(this,arguments)}}}return y.transform=function(t,e,n,r){var i=t.selection?t.selection():t;i.property("__zoom",oO),t!==i?_(t,e,n,r):i.interrupt().each((function(){w(this,arguments).event(r).start().zoom(null,"function"===typeof e?e.apply(this,arguments):e).end()}))},y.scaleBy=function(t,e,n,r){y.scaleTo(t,(function(){return this.__zoom.k*("function"===typeof e?e.apply(this,arguments):e)}),n,r)},y.scaleTo=function(t,e,n,r){y.transform(t,(function(){var t=i.apply(this,arguments),r=this.__zoom,a=null==n?x(t):"function"===typeof n?n.apply(this,arguments):n,s=r.invert(a),l="function"===typeof e?e.apply(this,arguments):e;return o(b(v(r,l),a,s),t,c)}),n,r)},y.translateBy=function(t,e,n,r){y.transform(t,(function(){return o(this.__zoom.translate("function"===typeof e?e.apply(this,arguments):e,"function"===typeof n?n.apply(this,arguments):n),i.apply(this,arguments),c)}),null,r)},y.translateTo=function(t,e,n,r,a){y.transform(t,(function(){var t=i.apply(this,arguments),a=this.__zoom,s=null==r?x(t):"function"===typeof r?r.apply(this,arguments):r;return o(tO.translate(s[0],s[1]).scale(a.k).translate("function"===typeof e?-e.apply(this,arguments):-e,"function"===typeof n?-n.apply(this,arguments):-n),t,c)}),r,a)},S.prototype={event:function(t){return t&&(this.sourceEvent=t),this},start:function(){return 1===++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(t,e){return this.mouse&&"mouse"!==t&&(this.mouse[1]=e.invert(this.mouse[0])),this.touch0&&"touch"!==t&&(this.touch0[1]=e.invert(this.touch0[0])),this.touch1&&"touch"!==t&&(this.touch1[1]=e.invert(this.touch1[0])),this.that.__zoom=e,this.emit("zoom"),this},end:function(){return 0===--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(t){var e=GN(this.that).datum();d.call(t,this.that,new QN(t,{sourceEvent:this.sourceEvent,target:y,type:t,transform:this.that.__zoom,dispatch:d}),e)}},y.wheelDelta=function(t){return arguments.length?(a="function"===typeof t?t:JN(+t),y):a},y.filter=function(t){return arguments.length?(r="function"===typeof t?t:JN(!!t),y):r},y.touchable=function(t){return arguments.length?(s="function"===typeof t?t:JN(!!t),y):s},y.extent=function(t){return arguments.length?(i="function"===typeof t?t:JN([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),y):i},y.scaleExtent=function(t){return arguments.length?(l[0]=+t[0],l[1]=+t[1],y):[l[0],l[1]]},y.translateExtent=function(t){return arguments.length?(c[0][0]=+t[0][0],c[1][0]=+t[1][0],c[0][1]=+t[0][1],c[1][1]=+t[1][1],y):[[c[0][0],c[0][1]],[c[1][0],c[1][1]]]},y.constrain=function(t){return arguments.length?(o=t,y):o},y.duration=function(t){return arguments.length?(u=+t,y):u},y.interpolate=function(t){return arguments.length?(h=t,y):h},y.on=function(){var t=d.on.apply(d,arguments);return t===d?y:t},y.clickDistance=function(t){return arguments.length?(m=(t=+t)*t,y):Math.sqrt(m)},y.tapDistance=function(t){return arguments.length?(g=+t,y):g},y}function uO(t){return t}$N.prototype;var hO=1,dO=2,pO=3,fO=4,mO=1e-6;function gO(t){return"translate("+t+",0)"}function yO(t){return"translate(0,"+t+")"}function vO(t){return e=>+t(e)}function bO(t,e){return e=Math.max(0,t.bandwidth()-2*e)/2,t.round()&&(e=Math.round(e)),n=>+t(n)+e}function xO(){return!this.__axis}function _O(t,e){var n=[],r=null,i=null,o=6,a=6,s=3,l="undefined"!==typeof window&&window.devicePixelRatio>1?0:.5,c=t===hO||t===fO?-1:1,u=t===fO||t===dO?"x":"y",h=t===hO||t===pO?gO:yO;function d(d){var p=null==r?e.ticks?e.ticks.apply(e,n):e.domain():r,f=null==i?e.tickFormat?e.tickFormat.apply(e,n):uO:i,m=Math.max(o,0)+s,g=e.range(),y=+g[0]+l,v=+g[g.length-1]+l,b=(e.bandwidth?bO:vO)(e.copy(),l),x=d.selection?d.selection():d,_=x.selectAll(".domain").data([null]),w=x.selectAll(".tick").data(p,e).order(),S=w.exit(),T=w.enter().append("g").attr("class","tick"),E=w.select("line"),M=w.select("text");_=_.merge(_.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),w=w.merge(T),E=E.merge(T.append("line").attr("stroke","currentColor").attr(u+"2",c*o)),M=M.merge(T.append("text").attr("fill","currentColor").attr(u,c*m).attr("dy",t===hO?"0em":t===pO?"0.71em":"0.32em")),d!==x&&(_=_.transition(d),w=w.transition(d),E=E.transition(d),M=M.transition(d),S=S.transition(d).attr("opacity",mO).attr("transform",(function(t){return isFinite(t=b(t))?h(t+l):this.getAttribute("transform")})),T.attr("opacity",mO).attr("transform",(function(t){var e=this.parentNode.__axis;return h((e&&isFinite(e=e(t))?e:b(t))+l)}))),S.remove(),_.attr("d",t===fO||t===dO?a?"M"+c*a+","+y+"H"+l+"V"+v+"H"+c*a:"M"+l+","+y+"V"+v:a?"M"+y+","+c*a+"V"+l+"H"+v+"V"+c*a:"M"+y+","+l+"H"+v),w.attr("opacity",1).attr("transform",(function(t){return h(b(t)+l)})),E.attr(u+"2",c*o),M.attr(u,c*m).text(f),x.filter(xO).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===dO?"start":t===fO?"end":"middle"),x.each((function(){this.__axis=b}))}return d.scale=function(t){return arguments.length?(e=t,d):e},d.ticks=function(){return n=Array.from(arguments),d},d.tickArguments=function(t){return arguments.length?(n=null==t?[]:Array.from(t),d):n.slice()},d.tickValues=function(t){return arguments.length?(r=null==t?null:Array.from(t),d):r&&r.slice()},d.tickFormat=function(t){return arguments.length?(i=t,d):i},d.tickSize=function(t){return arguments.length?(o=a=+t,d):o},d.tickSizeInner=function(t){return arguments.length?(o=+t,d):o},d.tickSizeOuter=function(t){return arguments.length?(a=+t,d):a},d.tickPadding=function(t){return arguments.length?(s=+t,d):s},d.offset=function(t){return arguments.length?(l=+t,d):l},d}function wO(t){return _O(hO,t)}function SO(t){return _O(dO,t)}function TO(t){return _O(pO,t)}function EO(t){return _O(fO,t)}const MO=t=>{const n=(0,k.useRef)(null);return(0,k.useEffect)((()=>((r=>{const{orient:i,scale:o,axisLabel:a,axisLabelText:s}=t,l="Left"===i?"y":"x";if(r&&r.axisLabel&&HN("text.".concat(l,"axis-label-").concat(r.axisLabel)).remove(),!["Left","Bottom"].includes(i))throw new Error("axisType must be 'Left' or 'Bottom'");const c="axis".concat(i),u=e[c]().scale(o).tickPadding([5]),h=GN(n.current).call(u);if(a){let{axisLabelPositionX:e,axisLabelPositionY:n}=t.axisLabelPositions;e="Left"===i?-e:e,n="Left"===i?-n:n,h.append("text").attr("class","".concat(l,"axis-label-").concat(a," text-lg"));let r=HN("text.".concat(l,"axis-label-").concat(a)).data([null]);const o="Left"===i?"rotate(-90)":"rotate(0)";if(r.enter().merge(r).attr("y",n).attr("x",e).attr("fill","black").text(s).attr("font-family","sans-serif").attr("fill","currentColor").attr("transform",o).exit().remove(),"Bottom"===i){const{innerHeight:e}=t;h.selectAll("g.tick line").attr("y2",-e).attr("opacity",.2)}else{const{innerWidth:e}=t;h.selectAll("g.tick line").attr("x2",e).attr("opacity",.2)}}const{removeTickLine:d}=t;d&&h.selectAll(d).remove()})(),()=>{})),[t]),(0,Dn.jsx)("g",{transform:t.translate,ref:n})},CO=t=>{let{axisProps:e}=t;const{xProps:n,yProps:r}=e;return(0,Dn.jsxs)("g",{children:[(0,Dn.jsx)(MO,{...n}),(0,Dn.jsx)(MO,{...r})]})},AO=t=>{let{data:e,columns:n,id:r,scales:i,innerWidth:o,innerHeight:a,clickedCategory:s,setClickedCategory:l}=t;const c=(0,k.useRef)(null),{xColumn:u,yColumn:h,catColumn:d}=n,{xScale:p,yScale:f,colorScale:m}=i;return(0,k.useEffect)((()=>{if(c.current){let t=GN(c.current).selectAll(".unique-group").data(e,(t=>t[r]));t.exit().remove();let n=t.enter().append("g").attr("class","unique-group");t=t.merge(n),n.append("circle").attr("class","circle-class hover:cursor-pointer").attr("cx",o/2).attr("cy",a/2).attr("r",0).on("click",((t,e)=>l(e[d]))).on("mouseover",(function(t){GN(this).transition().duration(250).attr("r","0.75em")})).on("mouseout",(function(t){GN(this).transition().duration(250).attr("r","0.5em")})),n.append("title").attr("class","title-class").text((t=>"(".concat(t[u],", ").concat(t[h],")"))),t.select(".circle-class").transition().duration(750).delay(((t,e)=>10*e)).attr("cx",(t=>p(t[u]))).attr("cy",(t=>f(t[h]))).attr("r","0.5em").attr("fill",(t=>m(t[d]))).attr("fill-opacity",(t=>s?t[d]===s?.7:.05:.7)),t.select(".title-class").text((t=>"(".concat(t[u],", ").concat(t[h],")")));const i=33,g=30,y=m.domain().length,v=GN(c.current).selectAll("rect").data([null]);v.enter().append("rect").merge(v).attr("x",2*-i).attr("y",2*-i).attr("rx",10).attr("width",.15*o).attr("height",g*y+1.25*i).attr("fill","black").attr("opacity",.1).attr("transform","translate(".concat(1.06*o,", ").concat(.11*a,")"));let b=GN(c.current).selectAll(".circle-tick").data(m.domain());b.exit().remove();let x=b.enter().append("g").attr("class","circle-tick").attr("transform",((t,e)=>"translate(".concat(1.02*o,", ").concat(e*g+.06*a,")")));b=b.merge(x),b.select(".circle-tick").merge(b).transition().attr("transform",((t,e)=>"translate(".concat(1.02*o,", ").concat(e*g+.06*a,")"))),x.append("circle").attr("class","circle-legend hover:cursor-pointer").attr("r",10).attr("fill",m).attr("opacity",.8).on("click",((t,e)=>l(e))),b.select(".circle-legend").transition().duration(750).attr("opacity",(t=>s?s===t?.8:.05:.8)),x.append("text").attr("class","text-legend text-sm hover:cursor-pointer").attr("fill","currentColor").text((t=>t)).attr("dy","0.32em").attr("x",20).on("click",((t,e)=>l(e))),b.select(".text-legend").transition().duration(750).attr("opacity",(t=>s?s===t?1:.2:1))}}),[c,d,e,o,a,r,p,u,f,h,m,l,s]),(0,Dn.jsx)("g",{ref:c})},kO=(t,e,n)=>(t.PetalLengthCm=+t.PetalLengthCm,t.PetalWidthCm=+t.PetalWidthCm,t.SepalLengthCm=+t.SepalLengthCm,t.SepalWidthCm=+t.SepalWidthCm,t),IO=()=>{const t=.9*window.innerWidth,e=.55*window.innerHeight,n={left:.07*t,right:.12*t,top:.084*e,bottom:.084*e};return{width:t,height:e,margins:n,innerWidth:t-n.left-n.right,innerHeight:e-n.top-n.bottom}};class RO extends k.Component{constructor(t){super(t),this.handleResize=()=>{this.setState({dimensions:IO()})},this.handleXColumnChange=t=>{this.setState({xColumn:t.target.value})},this.handleYColumnChange=t=>{this.setState({yColumn:t.target.value})},this.setClickedCategory=t=>{this.setState((e=>({clickedCategory:e.clickedCategory===t?null:t})))},this.state={data:null,xColumn:"PetalLengthCm",yColumn:"PetalWidthCm",clickedCategory:null,dimensions:IO()}}componentDidMount(){window.addEventListener("resize",this.handleResize),HP("/static/data/Iris.csv",kO).then((t=>{this.setState({data:t})}))}componentWillUnmount(){window.removeEventListener("resize",this.handleResize)}render(){const t=["PetalLengthCm","PetalWidthCm","SepalLengthCm","SepalWidthCm"],{data:e,dimensions:n,xColumn:r,yColumn:i,clickedCategory:o}=this.state;if(e){const a=ik(e.map((t=>t[r]))),s=ik(e.map((t=>t[i]))),l=[...new Set(e.map((t=>t.Species)))],c=WN().domain(a).range([0,n.innerWidth]).nice(),u=WN().domain(s).range([n.innerHeight,0]).nice(),h=$P().domain(l).range(["red","steelblue","green"]),d={orient:"Bottom",scale:c,axisLabel:r,axisLabelText:r,axisLabelPositions:{axisLabelPositionX:n.innerWidth/2,axisLabelPositionY:n.innerHeight/11},innerHeight:n.innerHeight,removeTickLine:".domain",translate:"translate(0, ".concat(n.innerHeight,")")},p={orient:"Left",scale:u,axisLabel:i,axisLabelText:i,axisLabelPositions:{axisLabelPositionX:n.innerWidth/6,axisLabelPositionY:n.innerHeight/11},innerWidth:n.innerWidth,removeTickLine:".domain",translate:"translate(0, 0)"};return(0,Dn.jsxs)("div",{className:"flex flex-col items-center",children:[(0,Dn.jsx)("div",{className:"text-center mb-2",children:(0,Dn.jsx)("p",{className:"text-base",children:"Change interactively X or Y axis using dropdown Menus. Hover on a given point to display (x, y) values. Click on any point from plot or legend to highlight all points from the same color. Click again to unselect."})}),(0,Dn.jsxs)("div",{className:"flex justify-center mb-4",children:[(0,Dn.jsxs)("div",{className:"form-control w-full max-w-xs mx-4",children:[(0,Dn.jsx)("label",{className:"label",htmlFor:"x-axis-select",children:"X"}),(0,Dn.jsx)("select",{className:"select select-bordered",id:"x-axis-select",value:r,onChange:this.handleXColumnChange,children:t.map((t=>(0,Dn.jsx)("option",{value:t,children:t},t)))})]}),(0,Dn.jsxs)("div",{className:"form-control w-full max-w-xs mx-4",children:[(0,Dn.jsx)("label",{className:"label",htmlFor:"y-axis-select",children:"Y"}),(0,Dn.jsx)("select",{className:"select select-bordered",id:"y-axis-select",value:i,onChange:this.handleYColumnChange,children:t.map((t=>(0,Dn.jsx)("option",{value:t,children:t},t)))})]})]}),(0,Dn.jsx)("div",{className:"w-full",children:e&&(0,Dn.jsx)("svg",{width:n.width,height:n.height,children:(0,Dn.jsxs)("g",{transform:"translate(".concat(n.margins.left,", ").concat(n.margins.top,")"),children:[(0,Dn.jsx)(CO,{axisProps:{xProps:d,yProps:p}}),(0,Dn.jsx)("text",{x:.25*n.width,y:-n.height/27,className:"text-2xl",fill:"currentColor",children:"Iris Flower Data Visualizer"}),(0,Dn.jsx)(AO,{data:e,columns:{xColumn:r,yColumn:i,catColumn:"Species"},scales:{xScale:c,yScale:u,colorScale:h},id:"Id",innerWidth:n.innerWidth,innerHeight:n.innerHeight,setClickedCategory:this.setClickedCategory,clickedCategory:o})]})})})]})}return(0,Dn.jsxs)("div",{className:"flex items-center justify-center min-h-screen",children:[(0,Dn.jsx)("div",{className:"loader ease-linear rounded-full border-4 border-t-4 border-gray-200 h-12 w-12"}),(0,Dn.jsx)("p",{className:"text-lg",children:"Loading..."})]})}}const PO=t=>{let{data:e,xScale:n,yScale:r,zScale:i,colorScale:o,xColumn:a,yColumn:s,zColumn:l}=t;const c=(0,k.useRef)(null);return(0,k.useEffect)((()=>{if(c.current){(t=>{for(var e=t.lastElementChild;e;)t.removeChild(e),e=t.lastElementChild})(document.getElementById("iris-3d-div"));const t=.75*window.innerWidth,u=.6*window.innerHeight,h=.1,d=.9,p=.7,f=2.5,m=.009,g=-.2,y=t=>{const e=document.createElement("canvas");e.width=64,e.height=64;const n=e.getContext("2d");return n.beginPath(),n.arc(32,32,28,0,2*Math.PI,!1),n.globalAlpha=d,n.fillStyle=t,n.fill(),n.lineWidth=p,n.strokeStyle="black",n.stroke(),e},v={},b=t=>(v[t]||(v[t]=new Ax({map:new cw(y(t))})),v[t]),x=new Tx,_=new Sy(75,t/u,.1,1e3),w=new _x({alpha:!0});w.setSize(t,u),c.current.appendChild(w.domElement);const S=new ng;x.add(S),_.position.z=f;const T=cO();T.scaleExtent([1,1]),T.translateExtent([[-1/0,-Math.PI/2/m],[1/0,u+Math.PI/2/m]]),T.on("zoom",(t=>{S.rotation.y=t.transform.x*m,S.rotation.x=t.transform.y*m}));const E=GN(w.domElement).call(T);T.translateBy(E,0,0);const M=()=>{requestAnimationFrame(M),T.translateBy(E,g,0),w.render(x,_)};M();const C=t=>{let{x:e,y:n,z:r,color:i}=t;const o=new Vx(b(i));o.position.x=e,o.position.y=n,o.position.z=r,o.scale.set(h,h,1),S.add(o)};e.map((t=>({x:n(t[a]),y:r(t[s]),z:i(t[l]),color:o(t.Species)}))).forEach(C)}}),[e,n,r,i,o,a,s,l]),(0,Dn.jsx)("div",{ref:c,id:"iris-3d-div",className:"iris-3d-div"})},NO=()=>{const[t,e]=(0,k.useState)(null),[n,r]=(0,k.useState)("PetalLengthCm"),[i,o]=(0,k.useState)("PetalWidthCm"),[a,s]=(0,k.useState)("SepalLengthCm"),[l,c]=(0,k.useState)(null),[u,h]=(0,k.useState)(null),[d,p]=(0,k.useState)(null),[f,m]=(0,k.useState)(null);(0,k.useEffect)((()=>{HP("/static/data/Iris.csv",kO).then((t=>{const r=ik(t.map((t=>t[n]))),o=ik(t.map((t=>t[i]))),s=ik(t.map((t=>t[a]))),l=[...new Set(t.map((t=>t.Species)))],u=WN().domain(r).range([-1,1]),d=WN().domain(o).range([-1,1]),f=WN().domain(s).range([-1,1]),g=$P().domain(l).range(["red","steelblue","green"]);e((e=>t)),c((t=>u)),h((t=>d)),p((t=>f)),m((t=>g))}))}),[n,i,a]),(0,k.useEffect)((()=>{f&&g(f)}),[f]);const g=t=>{if(!t)return;const e=t.domain().length,n=GN(".legend-group-3d").selectAll("rect").data([null]);n.enter().append("rect").merge(n).attr("x",-60).attr("y",-60).attr("rx",10).attr("width",135).attr("height",30*e+21).attr("fill","black").attr("opacity",.1).attr("transform","translate(60, ".concat(70,")"));let r=GN(".legend-group-3d").selectAll(".circle-tick-3d").data(t.domain());r.exit().remove();let i=r.enter().append("g").attr("class","circle-tick-3d").attr("transform",((t,e)=>"translate(12, ".concat(30*e+50-17,")")));r=r.merge(i),i.append("circle").attr("r",10).attr("fill",t).attr("opacity",.8),i.append("text").attr("class","text-legend text-sm").attr("fill","currentColor").text((t=>t)).attr("dy","0.32em").attr("x",20)},y=(0,k.useCallback)((t=>{r(t.target.value)}),[]),v=(0,k.useCallback)((t=>{o(t.target.value)}),[]),b=(0,k.useCallback)((t=>{s(t.target.value)}),[]),x=["PetalLengthCm","PetalWidthCm","SepalLengthCm","SepalWidthCm"];return(0,Dn.jsxs)("div",{className:"container mx-auto p-4",children:[(0,Dn.jsxs)("div",{className:"flex flex-wrap justify-around mb-4",children:[(0,Dn.jsxs)("div",{className:"form-control w-56",children:[(0,Dn.jsx)("label",{className:"label",children:(0,Dn.jsx)("span",{className:"label-text",children:"X"})}),(0,Dn.jsx)("select",{className:"select select-bordered",value:n,onChange:y,children:x.map((t=>(0,Dn.jsx)("option",{value:t,children:t},t)))})]}),(0,Dn.jsxs)("div",{className:"form-control w-56",children:[(0,Dn.jsx)("label",{className:"label",children:(0,Dn.jsx)("span",{className:"label-text",children:"Y"})}),(0,Dn.jsx)("select",{className:"select select-bordered",value:i,onChange:v,children:x.map((t=>(0,Dn.jsx)("option",{value:t,children:t},t)))})]}),(0,Dn.jsxs)("div",{className:"form-control w-56",children:[(0,Dn.jsx)("label",{className:"label",children:(0,Dn.jsx)("span",{className:"label-text",children:"Z"})}),(0,Dn.jsx)("select",{className:"select select-bordered",value:a,onChange:b,children:x.map((t=>(0,Dn.jsx)("option",{value:t,children:t},t)))})]})]}),(0,Dn.jsxs)("div",{className:"flex",children:[(0,Dn.jsx)("div",{className:"w-3/4",children:t&&(0,Dn.jsx)(PO,{data:t,xScale:l,yScale:u,zScale:d,colorScale:f,xColumn:n,yColumn:i,zColumn:a})}),(0,Dn.jsx)("div",{className:"w-1/4",children:(0,Dn.jsx)("svg",{height:150,width:300,children:(0,Dn.jsx)("g",{className:"legend-group-3d"})})})]})]})},OO=__webpack_require__(388);function DO(t){return new Promise((e=>setTimeout(e,t)))}function LO(){const[t,e]=(0,k.useState)(null),[n,r]=(0,k.useState)(null),[i,o]=(0,k.useState)(!1),[a,s]=(0,k.useState)(null),[l,c]=(0,k.useState)(null),[u,h]=(0,k.useState)(10),[d,p]=(0,k.useState)(10),f={epsilon:p,perplexity:h},m=(0,k.useRef)(null),g=(0,k.useRef)(i);(0,k.useEffect)((()=>{g.current=i}),[i]);const y=()=>{const t=.65*window.innerWidth,e=.6*window.innerHeight,n={left:70,right:150,top:50,bottom:50};return{width:t,height:e,margins:n,innerWidth:t-n.left-n.right,innerHeight:e-n.top-n.bottom}},v=(t,e)=>{const n=a;n[t]=e,o(!1),s(n),f[t](e)},b=t=>{const e=y(),n=ik(t.map((t=>t[0]))),r=ik(t.map((t=>t[1])));return{xScale:WN().domain(n).range([5,e.innerWidth-5]),yScale:WN().domain(r).range([e.innerHeight-5,5])}};(0,k.useEffect)((()=>{const t=y();HP("/static/data/Iris.csv",kO).then((n=>{const i=n.map((t=>({id:t.Id,x:Math.random(),y:Math.random(),Species:t.Species}))),o=[...new Set(i.map((t=>t.Species)))],a=$P().domain(o).range(["red","steelblue","green"]),l=new OO.tSNE({epsilon:10,perplexity:10,dim:2});l.initDataRaw(n.map((t=>[t.PetalLengthCm,t.PetalWidthCm,t.SepalLengthCm,t.SepalWidthCm])));var u=GN(m.current).select(".iris-tsne-plot-container").selectAll(".circle-tsne-group").data(i,(t=>t.id));u.exit().remove();var h=u.enter().append("g").attr("class","circle-tsne-group");u=u.merge(h),h.append("circle").attr("class","circle-tsne-point").attr("cx",t.innerWidth/2).attr("cy",t.innerHeight/2).attr("r",0);const d=l.getSolution(),{xScale:p,yScale:f}=b(d);u.select(".circle-tsne-point").transition().duration(1e3).delay(((t,e)=>10*e)).attr("cx",((t,e)=>p(d[e][0]))).attr("cy",((t,e)=>f(d[e][1]))).attr("r",10).attr("fill",(t=>a(t.Species))).attr("fill-opacity",.8),e(n),r((()=>a)),s(l),c(u)}))}),[]),(0,k.useEffect)((()=>{x()}),[i,a,l,n]);const x=async()=>{for(;g.current;){a.step();const t=a.getSolution(),{xScale:e,yScale:r}=b(t);l.select(".circle-tsne-point").transition().duration(1e3).delay(((t,e)=>10*e)).attr("cx",((n,r)=>e(t[r][0]))).attr("cy",((e,n)=>r(t[n][1]))).attr("r",10).attr("fill",(t=>n(t.Species))).attr("fill-opacity",.8),await DO(1020)}},_=y();return(0,Dn.jsxs)("div",{className:"container mx-auto p-4",children:[(0,Dn.jsxs)("div",{className:"text-center mb-8",children:[(0,Dn.jsx)("h2",{className:"text-2xl font-bold mb-2",children:"Interactive t-SNE Visualization"}),(0,Dn.jsx)("p",{className:"text-lg",children:"This program runs interactively t-SNE to reduce iris 4-dimensional data to 2 dimensions."})]}),(0,Dn.jsxs)("div",{className:"flex flex-col md:flex-row",children:[(0,Dn.jsxs)("div",{className:"w-full md:w-1/3 mb-8 md:mb-0",children:[(0,Dn.jsxs)("div",{className:"flex justify-center space-x-4 mb-8",children:[(0,Dn.jsx)("button",{className:"btn mr-20 w-20 ".concat(i?"":"btn-success"),onClick:()=>{o((t=>!t))},children:i?"Pause":"Play"}),(0,Dn.jsx)("button",{className:"btn w-20 btn-secondary",onClick:()=>{const e=new OO.tSNE({epsilon:10,perplexity:10,dim:2});e.initDataRaw(t.map((t=>[t.PetalLengthCm,t.PetalWidthCm,t.SepalLengthCm,t.SepalWidthCm])));const r=e.getSolution(),{xScale:i,yScale:a}=b(r);l.select(".circle-tsne-point").transition().duration(1e3).delay(((t,e)=>10*e)).attr("cx",((t,e)=>i(r[e][0]))).attr("cy",((t,e)=>a(r[e][1]))).attr("r",10).attr("fill",(t=>n(t.Species))).attr("fill-opacity",.8),o(!1),h(10),p(10),s(e)},children:"Reset"})]}),(0,Dn.jsxs)("div",{className:"mb-8",children:[(0,Dn.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Learning Rate"}),(0,Dn.jsx)("input",{type:"range",min:"1",max:"20",value:d,className:"range h-3",step:"1",onChange:t=>v("epsilon",parseInt(t.target.value))})]}),(0,Dn.jsxs)("div",{children:[(0,Dn.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Perplexity"}),(0,Dn.jsx)("input",{type:"range",min:"5",max:"100",value:u,className:"range h-3",step:"5",onChange:t=>v("perplexity",parseInt(t.target.value))})]})]}),(0,Dn.jsx)("div",{className:"w-full md:w-2/3",children:(0,Dn.jsx)("svg",{ref:m,width:_.width,height:_.height,children:(0,Dn.jsx)("g",{className:"iris-tsne-plot-container"})})})]})]})}const FO=t=>{let{children:e,value:n,index:r}=t;return(0,Dn.jsx)("div",{role:"tabpanel",hidden:n!==r,id:"scrollable-auto-tabpanel-".concat(r),"aria-labelledby":"scrollable-auto-tab-".concat(r),children:n===r&&(0,Dn.jsx)("div",{className:"p-3",children:e})})},UO=t=>{let{navBarHeight:e}=t;const[n,r]=(0,k.useState)(0),i=t=>{r(t)};return(0,Dn.jsxs)("div",{className:"w-full h-full bg-gray-800",style:{paddingTop:e},children:[(0,Dn.jsx)("div",{className:"w-full",children:(0,Dn.jsxs)("nav",{className:"flex justify-center",children:[(0,Dn.jsx)("button",{className:"px-4 py-2 focus:outline-none ".concat(0===n?"border-b":"border-b border-slate-500"),onClick:()=>i(0),children:"Iris 2D Interactive"}),(0,Dn.jsx)("button",{className:"px-4 py-2 focus:outline-none ".concat(1===n?"border-b":"border-b border-slate-500"),onClick:()=>i(1),children:"Iris 3D plot"}),(0,Dn.jsx)("button",{className:"px-4 py-2 focus:outline-none ".concat(2===n?"border-b":"border-b border-slate-500"),onClick:()=>i(2),children:"IRIS t-SNE visualization"})]})}),(0,Dn.jsxs)("div",{className:"p-4",children:[(0,Dn.jsx)(FO,{value:n,index:0,children:(0,Dn.jsx)(RO,{})}),(0,Dn.jsx)(FO,{value:n,index:1,children:(0,Dn.jsx)(NO,{})}),(0,Dn.jsx)(FO,{value:n,index:2,children:(0,Dn.jsx)(LO,{})})]})]})};var BO=__webpack_require__(20),zO=__webpack_require__(516),jO=__webpack_require__.n(zO),VO=__webpack_require__(676),WO=__webpack_require__.n(VO);const GO=t=>{const n=(0,k.useRef)(null);(0,k.useEffect)((()=>{r()}));const r=()=>{const r=t.orient,i=t.scale,o=t.axisLabel,a=t.axisLabelText;if(!["Left","Bottom"].includes(r))throw new Error("axisType must be 'Left' or 'Bottom'");const s="axis".concat(r),l=e[s]().scale(i).tickPadding([12]).ticks([5]);"Bottom"===r&&HN(".tick text").each((function(t,e){GN(this).style("font-size","2em")}));const c=GN(n.current).call(l);if(o){let{axisLabelPositionX:e,axisLabelPositionY:n}=t.axisLabelPositions;e="Left"===r?-e:e,n="Left"===r?-n:n,c.append("text").attr("class","yaxis-label-".concat(o));let i=HN("text.yaxis-label-".concat(o)).data([null]);const s="Left"===r?"rotate(-90)":"rotate(0)";if(i.enter().merge(i).attr("y",n).attr("x",e).attr("fill","black").text(a).attr("transform",s),"Bottom"===r){const e=t.innerHeight;c.selectAll("g.tick line").attr("y2",-e)}else{const e=t.innerWidth;c.selectAll("g.tick line").attr("x2",e)}}"Bottom"===r&&c.selectAll(".tick line").remove()},i=t.translate;return(0,Dn.jsx)("g",{transform:i,ref:n})},HO=t=>{let{axisProps:e}=t;const{xProps:n,yProps:r}=e;return(0,Dn.jsxs)("g",{children:[(0,Dn.jsx)(GO,{...n}),(0,Dn.jsx)(GO,{...r})]})},qO=t=>{let{data:e,columns:n,scales:r,id:i}=t;const o=(0,k.useRef)(null),{xColumn:a,yColumn:s}=n,{xScale:l,yScale:c}=r;return(0,k.useEffect)((()=>{const t=GN(o.current).selectAll("rect").data(e);t.enter().append("rect").attr("class","rect-prob-class color-").attr("y",(t=>c(t[s]))).attr("height",c.bandwidth()).attr("width",0).attr("key",(t=>t[i])).style("fill","currentColor").merge(t).transition().duration(1e3).delay(((t,e)=>10*e)).attr("y",(t=>c(t[s]))).attr("height",c.bandwidth()).attr("width",(t=>l(t[a]))).attr("key",(t=>t[i])).style("fill","currentColor")})),(0,Dn.jsx)("g",{ref:o})},XO=t=>{const e=t.data,{xColumn:n,yColumn:r}=t.columns,{width:i,height:o}=t.dimensions,a=t.title,s={width:i-t.dimensions.marginLeft-t.dimensions.marginRight,height:o-t.dimensions.marginTop-t.dimensions.marginBottom},l=WN().domain([0,ok(e,(t=>t[n]))]).range([0,s.width]),c=tN().domain(e.map((t=>t[r]))).range([0,s.height]).padding(.1),u={orient:"Bottom",scale:l,axisLabel:n,axisLabelPositions:{axisLabelPositionX:i/2,axisLabelPositionY:60},innerHeight:s.height,axisLabelText:"Number of ".concat(n),translate:"translate(".concat(0,",",o,")")},h={orient:"Left",scale:c,translate:"translate(".concat(0,",",0,")")};return(0,Dn.jsx)("svg",{width:i,height:o,children:(0,Dn.jsxs)("g",{transform:"translate(".concat(30,", ",50,")"),children:[(0,Dn.jsx)(HO,{axisProps:{xProps:u,yProps:h}}),(0,Dn.jsx)("text",{x:s.width/2-70,y:-20,className:"text-xl",fill:"currentColor",children:a}),(0,Dn.jsx)(qO,{data:e,columns:t.columns,scales:{xScale:l,yScale:c},id:t.id})]})})};var YO=new BO.InferenceSession({backendHint:"webgl"});const KO=t=>{const e=t.map((t=>Math.exp(t))).reduce(((t,e)=>t+e));return t.map((t=>Math.exp(t)/e))},ZO=()=>{const t=(0,k.useRef)(null),e=(0,k.useRef)(null),n=(0,k.useRef)(null),[r,i]=(0,k.useState)(!1),o=Array.from({length:10},((t,e)=>({pred:.1,category:e.toString(),key:e}))),[a,s]=(0,k.useState)(o);(0,k.useEffect)((()=>{const e=340-20-20,r=340-20-20,i=t.current;i.width=3*e,i.height=3*r,i.style.width="".concat(e,"px"),i.style.height="".concat(r,"px");const o=i.getContext("2d");return o.scale(3,3),o.lineCap="round",o.strokeStyle="black",o.lineWidth=20,n.current=o,(async()=>{await YO.loadModel("/static/models/mnist.onnx")})(),()=>{YO=new BO.InferenceSession({backendHint:"webgl"})}}),[]);return(0,Dn.jsxs)("div",{className:"flex flex-col items-center p-4 space-y-8",children:[(0,Dn.jsx)("div",{className:"text-center mb-4",children:(0,Dn.jsx)("h2",{className:"text-lg font-semibold",children:"Digit Recognition: Draw a digit (from 0 to 9) and an embedded AI model will predict the drawn digit"})}),(0,Dn.jsxs)("div",{className:"flex justify-center space-x-8",children:[(0,Dn.jsxs)("div",{className:"flex flex-col items-center  mx-36 mt-10",children:[(0,Dn.jsx)("canvas",{id:"input-img-canvas",className:"border border-gray-300 rounded-lg",onMouseDown:t=>{let{nativeEvent:e}=t;const{offsetX:r,offsetY:o}=e;n.current.beginPath(),n.current.moveTo(r,o),i(!0)},onMouseUp:()=>{n.current.closePath(),i(!1),(async()=>{const t=e.current.getContext("2d");t.clearRect(0,0,n.current.canvas.width,n.current.canvas.height),t.drawImage(document.getElementById("input-img-canvas"),0,0,n.current.canvas.width,n.current.canvas.height,0,0,28,28);const r=t.getImageData(0,0,t.canvas.width,t.canvas.height),{data:i,width:o,height:a}=r,l=jO()(new Float32Array(i),[o,a,4]),c=jO()(new Float32Array(o*a*1),[1,1,o,a]);WO().assign(c.pick(0,0,null,null),l.pick(null,null,3)),WO().divseq(c,255),WO().subseq(c,.1307),WO().divseq(c,.3081);const u=[new BO.Tensor(c.data,"float32",[1,1,o,a])],h=(await YO.run(u)).values().next().value,d=[...KO(h.data)].map(((t,e)=>({pred:t,category:e.toString(),key:e})));s(d)})()},onMouseMove:t=>{let{nativeEvent:e}=t;if(!r)return;const{offsetX:i,offsetY:o}=e;n.current.lineTo(i,o),n.current.stroke()},ref:t}),(0,Dn.jsx)("canvas",{height:"28",width:"28",style:{display:"none"},ref:e}),(0,Dn.jsx)("div",{className:"flex justify-center mt-6",children:(0,Dn.jsx)("button",{className:"btn",onClick:()=>{n.current&&n.current.clearRect(0,0,n.current.canvas.width,n.current.canvas.height),s(o)},children:"Clear Drawing"})})]}),(0,Dn.jsx)("div",{className:"flex flex-col items-center",children:(0,Dn.jsx)(XO,{data:a,columns:{xColumn:"pred",yColumn:"category"},dimensions:{width:500,height:400,marginBottom:20,marginTop:20,marginRight:20,marginLeft:20},title:"Predicted Digit",id:"key"})})]})]})};var JO=__webpack_require__(29),QO=__webpack_require__.n(JO),$O=__webpack_require__(87);class tD{constructor(t,e){this.backend=t,this.dataMover=e,this.data=new WeakMap,this.dataIdsCount=0}get(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)}set(t,e){this.dataIdsCount++,this.data.set(t,e)}has(t){return this.data.has(t)}delete(t){return this.dataIdsCount--,this.data.delete(t)}numDataIds(){return this.dataIdsCount}}class eD{refCount(t){return nD("refCount")}incRef(t){return nD("incRef")}timerAvailable(){return!0}time(t){return nD("time")}read(t){return nD("read")}readSync(t){return nD("readSync")}readToGPU(t,e){return nD("readToGPU")}numDataIds(){return nD("numDataIds")}disposeData(t,e){return nD("disposeData")}write(t,e,n){return nD("write")}move(t,e,n,r,i){return nD("move")}createTensorFromGPUData(t,e,n){return nD("createTensorFromGPUData")}memory(){return nD("memory")}floatPrecision(){return nD("floatPrecision")}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}dispose(){return nD("dispose")}}function nD(t){throw new Error("'".concat(t,"' not yet implemented or not found in the registry. ")+"This kernel may not be supported by the tfjs backend you have chosen")}function rD(t,e,n){return Math.max(t,Math.min(e,n))}function iD(t){return t%2===0?t:t+1}function oD(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function aD(t,e){if(!t)throw new Error("string"===typeof e?e:e())}function sD(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";aD(uD(t,e),(()=>n+" Shapes ".concat(t," and ").concat(e," must match")))}function lD(t){aD(null!=t,(()=>"The input to the tensor constructor must be a non-null value."))}function cD(t){if(0===t.length)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function uD(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function hD(t){return t%1===0}function dD(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function pD(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function fD(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t=>0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return new Promise(((i,o)=>{let a=0;const s=()=>{if(t())return void i();a++;const l=e(a);null!=n&&a>=n?o():null!=r?r(s,l):setTimeout(s,l)};s()}))}function mD(t,e){const n=e.length;return t=null==t?e.map(((t,e)=>e)):[].concat(t),aD(t.every((t=>t>=-n&&t<n)),(()=>"All values in axis param must be in range [-".concat(n,", ").concat(n,") but ")+"got axis ".concat(t))),aD(t.every((t=>hD(t))),(()=>"All values in axis param must be integers but "+"got axis ".concat(t))),t.map((t=>t<0?n+t:t))}function gD(t,e){const n=[],r=[],i=null!=e&&Array.isArray(e)&&0===e.length,o=null==e||i?null:mD(e,t).sort();let a=0;for(let s=0;s<t.length;++s){if(null!=o){if(o[a]===s&&1!==t[s])throw new Error("Can't squeeze axis ".concat(s," since its dim '").concat(t[s],"' is not 1"));(null==o[a]||o[a]>s)&&1===t[s]&&(n.push(t[s]),r.push(s)),o[a]<=s&&a++}1!==t[s]&&(n.push(t[s]),r.push(s))}return{newShape:n,keptDims:r}}function yD(t,e){return vD(t,e)}function vD(t,e){let n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else if("bool"===t)n=new Uint8Array(e);else{if("string"!==t)throw new Error("Unknown data type ".concat(t));n=new Array(e)}return n}function bD(t,e){return"complex64"!==e&&(("float32"!==e||"complex64"===t)&&(("int32"!==e||"float32"===t||"complex64"===t)&&("bool"!==e||"bool"!==t)))}function xD(t){if("float32"===t||"int32"===t)return 4;if("complex64"===t)return 8;if("bool"===t)return 1;throw new Error("Unknown dtype ".concat(t))}function _D(t){return"string"===typeof t||t instanceof String}function wD(t){return Array.isArray(t)?wD(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":function(t){return"number"===typeof t}(t)?"float32":_D(t)?"string":function(t){return"boolean"===typeof t}(t)?"bool":"float32"}function SD(t){return!!(t&&t.constructor&&t.call&&t.apply)}function TD(t,e){for(let n=e;n<t;++n)if(t%n===0)return n;return t}function ED(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function MD(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=new Array;if(1===e.length){const o=e[0]*(r?2:1);for(let e=0;e<o;e++)i[e]=n[t+e]}else{const o=e[0],a=e.slice(1),s=a.reduce(((t,e)=>t*e))*(r?2:1);for(let e=0;e<o;e++)i[e]=MD(t+e*s,a,n,r)}return i}function CD(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0===t.length)return e[0];const r=t.reduce(((t,e)=>t*e))*(n?2:1);if(0===r)return[];if(r!==e.length)throw new Error("[".concat(t,"] does not match the input size ").concat(e.length).concat(n?" for a complex tensor":"","."));return MD(0,t,e,n)}function AD(t,e){const n=kD(t,e);for(let r=0;r<n.length;r++)n[r]=1;return n}function kD(t,e){if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e)return new Uint8Array(t);throw new Error("Unknown data type ".concat(e))}function ID(t){t.forEach((e=>{aD(Number.isInteger(e)&&e>=0,(()=>"Tensor must have a shape comprised of positive integers but got "+"shape [".concat(t,"].")))}))}function RD(t,e,n){if(0===e)return 0;if(1===e)return t[0];let r=t[t.length-1];for(let i=0;i<t.length-1;++i)r+=n[i]*t[i];return r}function PD(t,e,n){if(0===e)return[];if(1===e)return[t];const r=new Array(e);for(let i=0;i<r.length-1;++i)r[i]=Math.floor(t/n[i]),t-=r[i]*n[i];return r[r.length-1]=t,r}function ND(t){return t&&t.then&&"function"===typeof t.then}const OD="tfjsflags";class DD{constructor(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=LD,this.populateURLFlags()}setPlatform(t,e){null!=this.platform&&(FD().getBool("IS_TEST")||FD().getBool("PROD")||console.warn("Platform ".concat(this.platformName," has already been set. ")+"Overwriting the platform with ".concat(t,"."))),this.platformName=t,this.platform=e}registerFlag(t,e,n){if(this.flagRegistry[t]={evaluationFn:e,setHook:n},null!=this.urlFlags[t]){const e=this.urlFlags[t];FD().getBool("IS_TEST")||FD().getBool("PROD")||console.warn("Setting feature override from URL ".concat(t,": ").concat(e,".")),this.set(t,e)}}async getAsync(t){return t in this.flags||(this.flags[t]=await this.evaluateFlag(t)),this.flags[t]}get(t){if(t in this.flags)return this.flags[t];const e=this.evaluateFlag(t);if(ND(e))throw new Error("Flag ".concat(t," cannot be synchronously evaluated. ")+"Please use getAsync() instead.");return this.flags[t]=e,this.flags[t]}getNumber(t){return this.get(t)}getBool(t){return this.get(t)}getString(t){return this.get(t)}getFlags(){return this.flags}get features(){return this.flags}set(t,e){if(null==this.flagRegistry[t])throw new Error("Cannot set flag ".concat(t," as it has not been registered."));this.flags[t]=e,null!=this.flagRegistry[t].setHook&&this.flagRegistry[t].setHook(e)}evaluateFlag(t){if(null==this.flagRegistry[t])throw new Error("Cannot evaluate flag '".concat(t,"': no evaluation function found."));return this.flagRegistry[t].evaluationFn()}setFlags(t){this.flags=Object.assign({},t)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if("undefined"===typeof this.global||"undefined"===typeof this.global.location||"undefined"===typeof this.global.location.search)return;const t=this.getQueryParams(this.global.location.search);if(OD in t){t[OD].split(",").forEach((t=>{const[e,n]=t.split(":");this.urlFlags[e]=function(t,e){const n=e.toLowerCase();return"true"===n||"false"===n?"true"===n:"".concat(+n)===n?+n:e}(0,n)}))}}}function LD(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return function(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}(e,r[0],r[1]),r.join("=")})),e}function FD(){return BD}let UD,BD=null;function zD(){if(null==UD){let t;if("undefined"!==typeof window)t=window;else if("undefined"!==typeof __webpack_require__.g)t=__webpack_require__.g;else if("undefined"!==typeof process)t=process;else{if("undefined"===typeof self)throw new Error("Could not find a global object");t=self}UD=t}return UD}function jD(t,e){const n=function(){const t=zD();return null==t._tfGlobals&&(t._tfGlobals=new Map),t._tfGlobals}();if(n.has(t))return n.get(t);{const r=e();return n.set(t,r),n.get(t)}}const VD="Abs",WD="Acos",GD="Acosh",HD="Add",qD="AddN",XD="ArgMax",YD="ArgMin",KD="Asin",ZD="Asinh",JD="Atan",QD="Atanh",$D="Atan2",tL="AvgPool",eL="AvgPool3D",nL="BatchMatMul",rL="BatchToSpaceND",iL="Bincount",oL="BitwiseAnd",aL="BroadcastArgs",sL="Cast",lL="Ceil",cL="ClipByValue",uL="Complex",hL="ComplexAbs",dL="Concat",pL="Conv2D",fL="Conv2DBackpropFilter",mL="Conv2DBackpropInput",gL="Conv3D",yL="Conv3DBackpropInputV2",vL="Cosh",bL="Cumprod",xL="Cumsum",_L="CropAndResize",wL="DenseBincount",SL="DepthToSpace",TL="DepthwiseConv2dNative",EL="DepthwiseConv2dNativeBackpropFilter",ML="DepthwiseConv2dNativeBackpropInput",CL="Diag",AL="Dilation2D",kL="Draw",IL="RealDiv",RL="Einsum",PL="Equal",NL="Exp",OL="ExpandDims",DL="Expm1",LL="Fill",FL="FlipLeftRight",UL="Floor",BL="FloorDiv",zL="FusedBatchNorm",jL="GatherV2",VL="GatherNd",WL="Greater",GL="GreaterEqual",HL="Identity",qL="IFFT",XL="Imag",YL="IsFinite",KL="IsInf",ZL="IsNan",JL="LeakyRelu",QL="Less",$L="LessEqual",tF="LinSpace",eF="Log",nF="Log1p",rF="LogicalAnd",iF="LogicalNot",oF="LogicalOr",aF="Maximum",sF="MaxPool",lF="MaxPool3D",cF="MaxPoolWithArgmax",uF="Mean",hF="Minimum",dF="MirrorPad",pF="Multinomial",fF="Multiply",mF="Neg",gF="NotEqual",yF="NonMaxSuppressionV3",vF="NonMaxSuppressionV4",bF="NonMaxSuppressionV5",xF="OnesLike",_F="OneHot",wF="Pack",SF="PadV2",TF="Prelu",EF="Prod",MF="RaggedGather",CF="RaggedRange",AF="RaggedTensorToTensor",kF="Range",IF="Real",RF="Reciprocal",PF="Relu",NF="Reshape",OF="ResizeNearestNeighbor",DF="ResizeBilinear",LF="Relu6",FF="Reverse",UF="Round",BF="Rsqrt",zF="ScatterNd",jF="TensorScatterUpdate",VF="SearchSorted",WF="Select",GF="Selu",HF="Slice",qF="Sinh",XF="Sign",YF="Sigmoid",KF="Softplus",ZF="Sqrt",JF="SpaceToBatchND",QF="SplitV",$F="Softmax",tU="SparseFillEmptyRows",eU="SparseReshape",nU="SparseSegmentMean",rU="SparseSegmentSum",iU="SparseToDense",oU="SquaredDifference",aU="StaticRegexReplace",sU="StridedSlice",lU="StringNGrams",cU="StringSplit",uU="StringToHashBucketFast",hU="Sub",dU="Tanh",pU="Tile",fU="TopK",mU="Transform",gU="Transpose",yU="Unique",vU="Unpack",bU="UnsortedSegmentSum",xU="ZerosLike",_U="Step",wU="FromPixels",SU="RotateWithOffset",TU="_FusedMatMul",EU="FusedConv2D",MU="FusedDepthwiseConv2D";function CU(){FD().getBool("IS_TEST")||FD().getBool("PROD")||console.warn(...arguments)}function AU(){FD().getBool("IS_TEST")||FD().getBool("PROD")||console.log(...arguments)}const kU=jD("kernelRegistry",(()=>new Map)),IU=jD("gradRegistry",(()=>new Map));function RU(t,e){const n=DU(t,e);return kU.get(n)}function PU(t){return IU.get(t)}function NU(t){const e=kU.entries(),n=[];for(;;){const{done:r,value:i}=e.next();if(r)break;const[o,a]=i,[s]=o.split("_");s===t&&n.push(a)}return n}function OU(t){const{kernelName:e,backendName:n}=t,r=DU(e,n);kU.has(r)&&CU("The kernel '".concat(e,"' for backend ")+"'".concat(n,"' is already registered")),kU.set(r,t)}function DU(t,e){return"".concat(e,"_").concat(t)}function LU(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}var FU=__webpack_require__(353);const UU=__webpack_require__.n(FU)()||FU;function BU(t){return UU.fromString(t,!0,16)}const zU=BU("c3a5c85c97cb3127"),jU=BU("b492b66fbe98f273"),VU=BU("9ae16a3b2f90404f");function WU(t){return t.xor(t.shru(47))}function GU(t,e,n){const r=t.slice(e,e+n);return UU.fromBytes(Array.from(r),!0,!0)}function HU(t,e){return GU(t,e,8)}function qU(t,e){return GU(t,e,4)}function XU(t,e){return 0===e?t:t.shru(e).or(t.shl(64-e))}function YU(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:BU("9ddfea08eb382d69"),r=t.xor(e).mul(n);r=r.xor(r.shru(47));let i=e.xor(r).mul(n);return i=i.xor(i.shru(47)),i=i.mul(n),i}function KU(t,e,n,r){return function(t,e,n,r,i,o){i=i.add(t),o=XU(o.add(i).add(r),21);const a=i;return i=(i=i.add(e)).add(n),o=o.add(XU(i,44)),[i.add(r),o.add(a)]}(HU(t,e),HU(t,e+8),HU(t,e+16),HU(t,e+24),n,r)}function ZU(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.length;const n=UU.fromNumber(81,!0);if(e<=32)return e<=16?function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.length;if(e>=8){const n=VU.add(2*e),r=HU(t,0).add(VU),i=HU(t,e-8);return YU(XU(i,37).mul(n).add(r),XU(r,25).add(i).mul(n),n)}if(e>=4){const n=VU.add(2*e);return YU(qU(t,0).shl(3).add(e),qU(t,e-4),n)}if(e>0){const n=t[0]+(t[e>>1]<<8),r=e+(t[e-1]<<2);return WU(VU.mul(n).xor(zU.mul(r))).mul(VU)}return VU}(t,e):function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.length;const n=VU.add(2*e),r=HU(t,0).mul(jU),i=HU(t,8),o=HU(t,e-8).mul(n),a=HU(t,e-16).mul(VU);return YU(XU(r.add(i),43).add(XU(o,30)).add(a),r.add(XU(i.add(VU),18)).add(o),n)}(t,e);if(e<=64)return function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.length;const n=VU.add(2*e),r=HU(t,0).mul(VU),i=HU(t,8),o=HU(t,e-8).mul(n),a=HU(t,e-16).mul(VU),s=XU(r.add(i),43).add(XU(o,30)).add(a),l=YU(s,r.add(XU(i.add(VU),18)).add(o),n),c=HU(t,16).mul(n),u=HU(t,24),h=s.add(HU(t,e-32)).mul(n),d=l.add(HU(t,e-24)).mul(n);return YU(XU(c.add(u),43).add(XU(h,30)).add(d),c.add(XU(u.add(r),18)).add(h),n)}(t,e);let r=n,i=n.mul(jU).add(113),o=WU(i.mul(VU).add(113)).mul(VU),a=[UU.UZERO,UU.UZERO],s=[UU.UZERO,UU.UZERO];r=r.mul(VU).add(HU(t,0));let l=0;const c=64*(e-1>>6),u=c+(e-1&63)-63;do{r=XU(r.add(i).add(a[0]).add(HU(t,l+8)),37).mul(jU),i=XU(i.add(a[1]).add(HU(t,l+48)),42).mul(jU),r=r.xor(s[1]),i=i.add(a[0]).add(HU(t,l+40)),o=XU(o.add(s[0]),33).mul(jU),a=KU(t,l,a[1].mul(jU),r.add(s[0])),s=KU(t,l+32,o.add(s[1]),i.add(HU(t,l+16))),[o,r]=[r,o],l+=64}while(l!==c);const h=jU.add(o.and(255).shl(1));return l=u,s[0]=s[0].add(e-1&63),a[0]=a[0].add(s[0]),s[0]=s[0].add(a[0]),r=XU(r.add(i).add(a[0]).add(HU(t,l+8)),37).mul(h),i=XU(i.add(a[1]).add(HU(t,l+48)),42).mul(h),r=r.xor(s[1].mul(9)),i=i.add(a[0].mul(9).add(HU(t,l+40))),o=XU(o.add(s[0]),33).mul(h),a=KU(t,l,a[1].mul(h),r.add(s[0])),s=KU(t,l+32,o.add(s[1]),i.add(HU(t,l+16))),[o,r]=[r,o],YU(YU(a[0],s[0],h).add(WU(i).mul(zU)).add(o),YU(a[1],s[1],h).add(r),h)}function JU(t,e){return"string"===e?tB(t):QU([t],e)}function QU(t,e){if("string"===e)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=rB(t)),FD().getBool("DEBUG")&&function(t,e){for(let n=0;n<t.length;n++){const r=t[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type ".concat(e," being uploaded contains ").concat(r,"."))}}(t,e),function(t,e){return t instanceof Float32Array&&"float32"===e||t instanceof Int32Array&&"int32"===e||t instanceof Uint8Array&&"bool"===e}(t,e))return t;if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e){const e=new Uint8Array(t.length);for(let n=0;n<e.length;++n)0!==Math.round(t[n])&&(e[n]=1);return e}throw new Error("Unknown data type ".concat(e))}function $U(){return FD().platform.now()}function tB(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return e=e||"utf-8",FD().platform.encode(t,e)}function eB(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return e=e||"utf-8",FD().platform.decode(t,e)}function nB(t){return null!=FD().platform.isTypedArray?FD().platform.isTypedArray(t):LU(t)}function rB(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==e&&(e=[]),"boolean"===typeof t||"number"===typeof t||"string"===typeof t||ND(t)||null==t||nB(t)&&n)e.push(t);else if(Array.isArray(t)||nB(t))for(let r=0;r<t.length;++r)rB(t[r],e,n);else{let r=-1;for(const e of Object.keys(t))/^([1-9]+[0-9]*|0)$/.test(e)&&(r=Math.max(r,Number(e)));for(let i=0;i<=r;i++)rB(t[i],e,n)}return e}class iB{constructor(t,e){this.backendTimer=t,this.logger=e,null==e&&(this.logger=new aB)}profileKernel(t,e,n){let r;const i=()=>{r=n()};let o;const a=$U();if(this.backendTimer.timerAvailable())o=this.backendTimer.time(i);else{i();for(const t of r)t.dataSync();o=Promise.resolve({kernelMs:$U()-a})}if(FD().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let s=0;s<r.length;s++){const e=r[s];e.data().then((n=>{oB(n,e.dtype,t)}))}return{kernelName:t,outputs:r,inputs:e,timeMs:o.then((t=>t.kernelMs)),extraInfo:o.then((t=>null!=t.getExtraProfileInfo?t.getExtraProfileInfo():""))}}logKernelProfile(t){const{kernelName:e,outputs:n,timeMs:r,inputs:i,extraInfo:o}=t;n.forEach((t=>{Promise.all([t.data(),r,o]).then((n=>{this.logger.logKernelProfile(e,t,n[0],n[1],i,n[2])}))}))}}function oB(t,e,n){if("float32"!==e)return!1;for(let r=0;r<t.length;r++){const e=t[r];if(isNaN(e)||!isFinite(e))return console.warn("Found ".concat(e," in the result of '").concat(n,"'")),!0}return!1}class aB{logKernelProfile(t,e,n,r,i,o){const a="number"===typeof r?pD("".concat(r,"ms"),9):r.error,s=pD(t,25),l=e.rank,c=e.size,u=pD(e.shape.toString(),14);let h="";for(const d in i){const t=i[d];if(null!=t){const n=t.shape||e.shape,r=n.length;h+="".concat(d,": ").concat(r,"D ").concat(r>0?n:""," ")}}console.log("%c".concat(s,"\t%c").concat(a,"\t%c").concat(l,"D ").concat(u,"\t%c").concat(c,"\t%c").concat(h,"\t%c").concat(o),"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}const sB=20,lB=3,cB=7;function uB(t,e,n,r){const i=ED(e),o=function(t,e,n,r){const i=cD(e),o=r[r.length-1],a=new Array(o).fill(0),s=e.length,l="complex64"===n?fB(t):t;if(s>1)for(let c=0;c<i/o;c++){const t=c*o;for(let e=0;e<o;e++)a[e]=Math.max(a[e],hB(l[t+e],0,n).length)}return a}(t,e,n,i),a=e.length,s=pB(t,e,n,i,o),l=["Tensor"];return r&&(l.push("  dtype: ".concat(n)),l.push("  rank: ".concat(a)),l.push("  shape: [".concat(e,"]")),l.push("  values:")),l.push(s.map((t=>"    "+t)).join("\n")),l.join("\n")}function hB(t,e,n){let r;return r=Array.isArray(t)?"".concat(parseFloat(t[0].toFixed(cB))," + ")+"".concat(parseFloat(t[1].toFixed(cB)),"j"):_D(t)?"'".concat(t,"'"):"bool"===n?dB(t):parseFloat(t.toFixed(cB)).toString(),pD(r,e)}function dB(t){return 0===t?"false":"true"}function pB(t,e,n,r,i){let o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];const a="complex64"===n?2:1,s=e[0],l=e.length;if(0===l){if("complex64"===n){return[hB(fB(t)[0],0,n)]}return"bool"===n?[dB(t[0])]:[t[0].toString()]}if(1===l){if(s>sB){const e=lB*a;let r=Array.from(t.slice(0,e)),o=Array.from(t.slice((s-lB)*a,s*a));return"complex64"===n&&(r=fB(r),o=fB(o)),["["+r.map(((t,e)=>hB(t,i[e],n))).join(", ")+", ..., "+o.map(((t,e)=>hB(t,i[s-lB+e],n))).join(", ")+"]"]}return["["+("complex64"===n?fB(t):Array.from(t)).map(((t,e)=>hB(t,i[e],n))).join(", ")+"]"]}const c=e.slice(1),u=r.slice(1),h=r[0]*a,d=[];if(s>sB){for(let e=0;e<lB;e++){const r=e*h,o=r+h;d.push(...pB(t.slice(r,o),c,n,u,i,!1))}d.push("...");for(let e=s-lB;e<s;e++){const r=e*h,o=r+h;d.push(...pB(t.slice(r,o),c,n,u,i,e===s-1))}}else for(let m=0;m<s;m++){const e=m*h,r=e+h;d.push(...pB(t.slice(e,r),c,n,u,i,m===s-1))}const p=2===l?",":"";d[0]="["+(s>0?d[0]+p:"");for(let m=1;m<d.length-1;m++)d[m]=" "+d[m]+p;let f=",\n";for(let m=2;m<l;m++)f+="\n";return d[d.length-1]=" "+d[d.length-1]+"]"+(o?"":f),d}function fB(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}class mB{constructor(t,e,n){if(this.dtype=e,this.shape=t.slice(),this.size=cD(t),null!=n){const t=n.length;aD(t===this.size,(()=>"Length of values '".concat(t,"' does not match the size ")+"inferred by the shape '".concat(this.size,"'.")))}if("complex64"===e)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||vD(e,this.size),this.strides=ED(t)}set(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];0===n.length&&(n=[0]),aD(n.length===this.rank,(()=>"The number of provided coordinates (".concat(n.length,") must ")+"match the rank (".concat(this.rank,")")));const i=this.locToIndex(n);this.values[i]=t}get(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];0===e.length&&(e=[0]);let r=0;for(const o of e){if(o<0||o>=this.shape[r]){const t="Requested out of range element at ".concat(e,". ")+"  Buffer shape=".concat(this.shape);throw new Error(t)}r++}let i=e[e.length-1];for(let o=0;o<e.length-1;++o)i+=this.strides[o]*e[o];return this.values[i]}locToIndex(t){if(0===this.rank)return 0;if(1===this.rank)return t[0];let e=t[t.length-1];for(let n=0;n<t.length-1;++n)e+=this.strides[n]*t[n];return e}indexToLoc(t){if(0===this.rank)return[];if(1===this.rank)return[t];const e=new Array(this.shape.length);for(let n=0;n<e.length-1;++n)e[n]=Math.floor(t/this.strides[n]),t-=e[n]*this.strides[n];return e[e.length-1]=t,e}get rank(){return this.shape.length}toTensor(){return gB().makeTensor(this.values,this.shape,this.dtype)}}let gB=null,yB=null,vB=null;class bB{constructor(t,e,n,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=e||"float32",this.size=cD(t),this.strides=ED(t),this.dataId=n,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const t=await this.data();return yB.buffer(this.shape,this.dtype,t)}bufferSync(){return yB.buffer(this.shape,this.dtype,this.dataSync())}async array(){const t=await this.data();return CD(this.shape,t,"complex64"===this.dtype)}arraySync(){return CD(this.shape,this.dataSync(),"complex64"===this.dtype)}async data(){this.throwIfDisposed();const t=gB().read(this.dataId);if("string"===this.dtype){const e=await t;try{return e.map((t=>eB(t)))}catch(XC){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return t}dataToGPU(t){return this.throwIfDisposed(),gB().readToGPU(this.dataId,t)}dataSync(){this.throwIfDisposed();const t=gB().readSync(this.dataId);if("string"===this.dtype)try{return t.map((t=>eB(t)))}catch(XC){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t}async bytes(){this.throwIfDisposed();const t=await gB().read(this.dataId);return"string"===this.dtype?t:new Uint8Array(t.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),gB().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return yB.print(this,t)}clone(){return this.throwIfDisposed(),yB.clone(this)}toString(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return uB(this.dataSync(),this.shape,this.dtype,t)}cast(t){return this.throwIfDisposed(),yB.cast(this,t)}variable(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return this.throwIfDisposed(),gB().makeVariable(this,t,e,n)}}function xB(){return jD("Tensor",(()=>bB))}Object.defineProperty(bB,Symbol.hasInstance,{value:t=>!!t&&null!=t.data&&null!=t.dataSync&&null!=t.throwIfDisposed}),xB();class _B extends bB{constructor(t,e,n,r){super(t.shape,t.dtype,t.dataId,r),this.trainable=e,this.name=n}assign(t){if(t.dtype!==this.dtype)throw new Error("dtype of the new value (".concat(t.dtype,") and ")+"previous value (".concat(this.dtype,") must match"));if(!uD(t.shape,this.shape))throw new Error("shape of the new value (".concat(t.shape,") and ")+"previous value (".concat(this.shape,") must match"));gB().disposeTensor(this),this.dataId=t.dataId,gB().incRef(this,null)}dispose(){gB().disposeVariable(this),this.isDisposedInternal=!0}}var wB,SB,TB,EB,MB;Object.defineProperty(_B,Symbol.hasInstance,{value:t=>t instanceof bB&&null!=t.assign&&t.assign instanceof Function}),function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"}(wB||(wB={})),function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"}(SB||(SB={})),function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"}(TB||(TB={})),function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"}(EB||(EB={})),function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"}(MB||(MB={}));const CB={float32:EB,int32:SB,bool:TB,complex64:MB};function AB(t,e){if("string"===t||"string"===e){if("string"===t&&"string"===e)return"string";throw new Error("Can not upcast ".concat(t," with ").concat(e))}return CB[t][e]}function kB(t){return AB(t,"int32")}function IB(t){return null!=t&&"object"===typeof t&&"texture"in t&&t.texture instanceof WebGLTexture}function RB(t){return"undefined"!==typeof GPUBuffer&&null!=t&&"object"===typeof t&&"buffer"in t&&t.buffer instanceof GPUBuffer}function PB(t,e){if(t.dtype===e.dtype)return[t,e];const n=AB(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function NB(t){const e=[];return OB(t,e,new Set),e}function OB(t,e,n){if(null==t)return;if(t instanceof bB)return void e.push(t);if(r=t,!Array.isArray(r)&&"object"!==typeof r)return;var r;const i=t;for(const o in i){const t=i[o];n.has(t)||(n.add(t),OB(t,e,n))}}function DB(t){return null!=t.kernelName}class LB{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map((t=>t.name))))}}}dispose(){for(const t in this.registeredVariables)this.registeredVariables[t].dispose()}}class FB{constructor(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new LB}async ready(){if(null!=this.pendingBackendInit)return this.pendingBackendInit.then((()=>{}));if(null!=this.backendInstance)return;const t=this.getSortedBackends();for(let e=0;e<t.length;e++){const n=t[e];if(await this.initializeBackend(n).success)return void await this.setBackend(n)}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(null!=this.pendingBackendInit)throw new Error("Backend '".concat(this.backendName,"' has not yet been initialized. Make ")+"sure to await tf.ready() or await tf.setBackend() before calling other methods");if(null==this.backendInstance){const{name:t,asyncInit:e}=this.initializeBackendsAndReturnBest();if(e)throw new Error("The highest priority backend '".concat(t,"' has not yet been ")+"initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(t)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(t){if(!(t in this.registry)){if(!(t in this.registryFactory))return null;{const{asyncInit:e}=this.initializeBackend(t);if(e)return null}}return this.registry[t]}findBackendFactory(t){return t in this.registryFactory?this.registryFactory[t].factory:null}registerBackend(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return t in this.registryFactory?(CU("".concat(t," backend was already registered. ")+"Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:e,priority:n},!0)}async setBackend(t){if(null==this.registryFactory[t])throw new Error("Backend name '".concat(t,"' not found in registry"));if(this.backendName=t,null==this.registry[t]){this.backendInstance=null;const{success:e,asyncInit:n}=this.initializeBackend(t);if(!(n?await e:e))return!1}return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new iB(this.backendInstance),!0}setupRegisteredKernels(){NU(this.backendName).forEach((t=>{null!=t.setupFunc&&t.setupFunc(this.backendInstance)}))}disposeRegisteredKernels(t){NU(t).forEach((e=>{null!=e.disposeFunc&&e.disposeFunc(this.registry[t])}))}initializeBackend(t){const e=this.registryFactory[t];if(null==e)throw new Error("Cannot initialize backend ".concat(t,", no registration found."));try{const n=e.factory();if(!n||n instanceof eD||"function"!==typeof n.then)return this.registry[t]=n,{success:!0,asyncInit:!1};{const e=++this.pendingBackendInitId,r=n.then((n=>!(e<this.pendingBackendInitId)&&(this.registry[t]=n,this.pendingBackendInit=null,!0))).catch((n=>(e<this.pendingBackendInitId||(this.pendingBackendInit=null,CU("Initialization of backend ".concat(t," failed")),CU(n.stack||n.message)),!1)));return this.pendingBackendInit=r,{success:r,asyncInit:!0}}}catch(n){return CU("Initialization of backend ".concat(t," failed")),CU(n.stack||n.message),{success:!1,asyncInit:!1}}}removeBackend(t){if(!(t in this.registryFactory))throw new Error("".concat(t," backend not found in registry"));this.backendName===t&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(((t,e)=>this.registryFactory[e].priority-this.registryFactory[t].priority))}initializeBackendsAndReturnBest(){const t=this.getSortedBackends();for(let e=0;e<t.length;e++){const n=t[e],{success:r,asyncInit:i}=this.initializeBackend(n);if(i||r)return{name:n,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(t,e){const n=this.state.tensorInfo.get(e),r=n.backend,i=this.readSync(e),o=r.refCount(e);r.disposeData(e,!0),n.backend=t,t.move(e,i,n.shape,n.dtype,o),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(t,e){let n,r=null;if(null==e){if("function"!==typeof t)throw new Error("Please provide a function to tidy()");e=t}else{if("string"!==typeof t&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!==typeof e)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=t}return this.scopedRun((()=>this.startScope(r)),(()=>this.endScope(n)),(()=>(n=e(),n instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n)))}scopedRun(t,e,n){t();try{const t=n();return e(),t}catch(r){throw e(),r}}nextTensorId(){return FB.nextTensorId++}nextVariableId(){return FB.nextVariableId++}clone(t){const e=BB.runKernel(HL,{x:t}),n={x:t};return this.addTapeNode(this.state.activeScope.name,n,[e],(t=>({x:()=>{const e={x:t},n={dtype:"float32"};return BB.runKernel(sL,e,n)}})),[],{}),e}runKernel(t,e,n){null==this.backendName&&this.backend;if(!(null!=RU(t,this.backendName)))throw new Error("Kernel '".concat(t,"' not registered for backend '").concat(this.backendName,"'"));return this.runKernelFunc({kernelName:t,inputs:e,attrs:n})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(t,e,n){const r=this.backend.numDataIds();let i=0;n.forEach((t=>{i+="complex64"===t.dtype?3:1}));const o=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=r-e-i-o;if(a>0)throw new Error("Backend '".concat(this.backendName,"' has an internal memory leak ")+"(".concat(a," data ids) after running '").concat(t,"'"))}runKernelFunc(t){let e,n=[];const r=this.isTapeOn(),i=this.state.numBytes,o=this.state.numTensors;let a,s;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0),null==this.backendName&&this.backend;const l=DB(t)?t.kernelName:null!=this.state.activeScope?this.state.activeScope.name:"";if(DB(t)){const{kernelName:e,inputs:i,attrs:o}=t;null==this.backendName&&this.backend;const l=RU(e,this.backendName);aD(null!=l,(()=>"Cannot find registered kernel '".concat(e,"' for backend '").concat(this.backendName,"'"))),a=()=>{const t=this.backend.numDataIds();s=l.kernelFunc({inputs:i,attrs:o,backend:this.backend});const a=Array.isArray(s)?s:[s];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(e,t,a);const c=a.map((t=>null!=t.rank?t:this.makeTensorFromTensorInfo(t)));if(r){const t=this.getTensorsForGradient(e,i,c);n=this.saveTensorsForBackwardMode(t)}return c}}else{const{forwardFunc:e}=t,i=t=>{r&&(n=t.map((t=>this.keep(this.clone(t)))))};a=()=>{const t=this.backend.numDataIds();s=this.tidy((()=>e(this.backend,i)));const n=Array.isArray(s)?s:[s];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(l,t,n),n}}const{inputs:c,attrs:u}=t,h=DB(t)?null:t.backwardsFunc;let d;return this.scopedRun((()=>this.state.kernelDepth++),(()=>this.state.kernelDepth--),(()=>{this.ENV.getBool("DEBUG")||this.state.profiling?(d=this.profiler.profileKernel(l,c,(()=>a())),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(d),e=d.outputs):e=a()})),r&&this.addTapeNode(l,c,e,h,n,u),this.state.profiling&&this.state.activeProfile.kernels.push({name:l,bytesAdded:this.state.numBytes-i,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-o,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(c).map((t=>null!=c[t]?c[t].shape:null)),outputShapes:e.map((t=>t.shape)),kernelTimeMs:d.timeMs,extraInfo:d.extraInfo}),Array.isArray(s)?e:e[0]}saveTensorsForBackwardMode(t){const e=t.map((t=>this.keep(this.clone(t))));return e}getTensorsForGradient(t,e,n){const r=PU(t);if(null!=r){const t=r.inputsToSave||[],i=r.outputsToSave||[];let o;r.saveAllInputs?(aD(Array.isArray(e),(()=>"saveAllInputs is true, expected inputs to be an array.")),o=Object.keys(e).map((t=>e[t]))):o=t.map((t=>e[t]));const a=n.filter(((t,e)=>i[e]));return o.concat(a)}return[]}makeTensor(t,e,n,r){if(null==t)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;let i=t;"string"===n&&_D(t[0])&&(i=t.map((t=>tB(t))));const o=r.write(i,e,n),a=new bB(e,n,o,this.nextTensorId());if(this.trackTensor(a,r),"string"===n){const t=this.state.tensorInfo.get(o),e=function(t){if(null==t)return 0;let e=0;return t.forEach((t=>e+=t.length)),e}(i);this.state.numBytes+=e-t.bytes,t.bytes=e}return a}makeTensorFromDataId(t,e,n,r){const i={dataId:t,shape:e,dtype:n=n||"float32"};return this.makeTensorFromTensorInfo(i,r)}makeTensorFromTensorInfo(t,e){const{dataId:n,shape:r,dtype:i}=t,o=new bB(r,i,n,this.nextTensorId());return this.trackTensor(o,e),o}makeVariable(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;n=n||this.nextVariableId().toString(),null!=r&&r!==t.dtype&&(t=t.cast(r));const i=new _B(t,e,n,this.nextTensorId());if(null!=this.state.registeredVariables[i.name])throw new Error("Variable with name ".concat(i.name," was already registered"));return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i}trackTensor(t,e){this.state.numTensors++,"string"===t.dtype&&this.state.numStringTensors++;let n=0;"complex64"!==t.dtype&&"string"!==t.dtype&&(n=t.size*xD(t.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(t.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(t.dataId,{backend:e||this.backend,dtype:t.dtype,shape:t.shape,bytes:n})),t instanceof _B||this.track(t)}incRef(t,e){this.trackTensor(t,e),this.backend.incRef(t.dataId)}removeDataId(t,e){this.state.tensorInfo.has(t)&&this.state.tensorInfo.get(t).backend===e&&(this.state.tensorInfo.delete(t),this.state.numDataBuffers--)}disposeTensor(t){if(!this.state.tensorInfo.has(t.dataId))return;const e=this.state.tensorInfo.get(t.dataId);if(this.state.numTensors--,"string"===t.dtype&&(this.state.numStringTensors--,this.state.numBytes-=e.bytes),"complex64"!==t.dtype&&"string"!==t.dtype){const e=t.size*xD(t.dtype);this.state.numBytes-=e}e.backend.disposeData(t.dataId)&&this.removeDataId(t.dataId,e.backend)}disposeVariables(){for(const t in this.state.registeredVariables){const e=this.state.registeredVariables[t];this.disposeVariable(e)}}disposeVariable(t){this.disposeTensor(t),null!=this.state.registeredVariables[t.name]&&delete this.state.registeredVariables[t.name]}memory(){const t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,null==t.reasons&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t}async profile(t){this.state.profiling=!0;const e=this.state.numBytes,n=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map((t=>t.totalBytesSnapshot))),this.state.activeProfile.newBytes=this.state.numBytes-e,this.state.activeProfile.newTensors=this.state.numTensors-n;for(const r of this.state.activeProfile.kernels)r.kernelTimeMs=await r.kernelTimeMs,r.extraInfo=await r.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}addTapeNode(t,e,n,r,i,o){const a={id:this.state.nextTapeNodeId++,kernelName:t,inputs:e,outputs:n,saved:i},s=PU(t);null!=s&&(r=s.gradFunc),null!=r&&(a.gradient=t=>(t=t.map(((t,e)=>{if(null==t){const t=n[e],r=kD(t.size,t.dtype);return this.makeTensor(r,t.shape,t.dtype)}return t})),r(t.length>1?t:t[0],i,o))),this.state.activeTape.push(a)}keep(t){return t.kept=!0,t}startTape(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(t){const e={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(e.name=t),this.state.scopeStack.push(e),this.state.activeScope=e}endScope(t){const e=NB(t),n=new Set(e.map((t=>t.id)));for(let i=0;i<this.state.activeScope.track.length;i++){const t=this.state.activeScope.track[i];t.kept||n.has(t.id)||t.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],e.forEach((t=>{t.kept||t.scopeId!==r.id||this.track(t)}))}gradients(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(aD(e.length>0,(()=>"gradients() received an empty list of xs.")),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '".concat(n.dtype,"'"));const i=this.scopedRun((()=>this.startTape()),(()=>this.endTape()),(()=>this.tidy("forward",t)));aD(i instanceof bB,(()=>"The result y returned by f() must be a tensor."));const o=function(t,e,n){const r={},i={};for(let l=0;l<e.length;l++)r[e[l].id]=!0;for(let l=0;l<t.length;l++){const n=t[l],o=n.inputs;for(const t in o){const a=o[t];let s=!1;for(let t=0;t<e.length;t++)if(r[a.id]){n.outputs.forEach((t=>r[t.id]=!0)),s=!0,i[n.id]=!0;break}if(s)break}}const o={};o[n.id]=!0;const a={};for(let l=t.length-1;l>=0;l--){const e=t[l],n=e.inputs;for(let t=0;t<e.outputs.length;t++)if(o[e.outputs[t].id]){for(const t in n)o[n[t].id]=!0,a[e.id]=!0;break}}const s=[];for(let l=0;l<t.length;l++){const e=t[l];if(i[e.id]&&a[e.id]){const t={};for(const i in e.inputs){const n=e.inputs[i];r[n.id]&&(t[i]=n)}const n=Object.assign({},e);n.inputs=t,n.outputs=e.outputs,s.push(n)}}return s}(this.state.activeTape,e,i);if(!r&&0===o.length&&e.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(()=>{const t={};t[i.id]=null==n?function(t){const e=AD(cD(t),"float32");return BB.makeTensor(e,t,"float32")}(i.shape):n,function(t,e,n,r){for(let i=e.length-1;i>=0;i--){const o=e[i],a=[];if(o.outputs.forEach((e=>{const n=t[e.id];null!=n?a.push(n):a.push(null)})),null==o.gradient)throw new Error("Cannot compute gradient: gradient function not found "+"for ".concat(o.kernelName,"."));const s=o.gradient(a);for(const e in o.inputs){if(!(e in s))throw new Error("Cannot backprop through input ".concat(e,". ")+"Available gradients found: ".concat(Object.keys(s),"."));const i=n((()=>s[e]()));if("float32"!==i.dtype)throw new Error("Error in gradient for op ".concat(o.kernelName,". The gradient of input ")+"".concat(e," must have 'float32' dtype, but has '").concat(i.dtype,"'"));const a=o.inputs[e];if(!uD(i.shape,a.shape))throw new Error("Error in gradient for op ".concat(o.kernelName,". The gradient of input ")+"'".concat(e,"' has shape '").concat(i.shape,"', which does not match ")+"the shape of the input '".concat(a.shape,"'"));if(null==t[a.id])t[a.id]=i;else{const e=t[a.id];t[a.id]=r(e,i),e.dispose()}}}}(t,o,(t=>this.tidy(t)),zB);const r=e.map((e=>t[e.id]));return 0===this.state.gradientDepth&&(this.state.activeTape.forEach((t=>{for(const e of t.saved)e.dispose()})),this.state.activeTape=null),{value:i,grads:r}}))}customGrad(t){var e=this;return aD(SD(t),(()=>"The f passed in customGrad(f) must be a function.")),function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];let o;aD(r.every((t=>t instanceof bB)),(()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors"));const a={};r.forEach(((t,e)=>{a[e]=t}));return e.runKernelFunc({forwardFunc:(e,n)=>(o=t(...r,n),aD(o.value instanceof bB,(()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor")),aD(SD(o.gradFunc),(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function.")),o.value),backwardsFunc:(t,e)=>{const n=o.gradFunc(t,e),i=Array.isArray(n)?n:[n];aD(i.length===r.length,(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...).")),aD(i.every((t=>t instanceof bB)),(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."));const a={};return i.forEach(((t,e)=>{a[e]=()=>t})),a},inputs:a})}}readSync(t){return this.state.tensorInfo.get(t).backend.readSync(t)}read(t){return this.state.tensorInfo.get(t).backend.read(t)}readToGPU(t,e){return this.state.tensorInfo.get(t).backend.readToGPU(t,e)}async time(t){const e=$U(),n=await this.backend.time(t);return n.wallMs=$U()-e,n}track(t){return null!=this.state.activeScope&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new LB;for(const t in this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}function UB(){const t=zD();if(null==t._tfengine){const e=new DD(t);t._tfengine=new FB(e)}var e;return e=t._tfengine.ENV,BD=e,gB=()=>t._tfengine,t._tfengine}FB.nextTensorId=0,FB.nextVariableId=0;const BB=UB();function zB(t,e){const n={a:t,b:e};return BB.runKernel(HD,n)}let jB;function VB(t){if(void 0!==jB)return jB;if(t||"undefined"!==typeof navigator&&null!=navigator){if(t||(t=navigator),"ReactNative"===t.product)return!0;const e=t.userAgent||t.vendor||("undefined"!==typeof window?window.opera:"");if(!e){const e=t;return e.userAgentData&&e.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function WB(){return"undefined"!==typeof window&&null!=window.document||"undefined"!==typeof WorkerGlobalScope}const GB=FD();function HB(t,e){let n=t;if(nB(t))return"string"===e?[]:[t.length];if(IB(t)){const e=t.channels||"RGBA";return[t.height,t.width*e.length]}if(RB(t))return[t.buffer.size/(null==e?4:xD(e))];if(!Array.isArray(t))return[];const r=[];for(;Array.isArray(n)||nB(n)&&"string"!==e;)r.push(n.length),n=n[0];return Array.isArray(t)&&FD().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&qB(t,r,[]),r}function qB(t,e,n){if(n=n||[],!Array.isArray(t)&&!nB(t))return void aD(0===e.length,(()=>"Element arr[".concat(n.join("]["),"] is a primitive, ")+"but should be an array/TypedArray of ".concat(e[0]," elements")));aD(e.length>0,(()=>"Element arr[".concat(n.join("]["),"] should be a primitive, ")+"but is an array of ".concat(t.length," elements"))),aD(t.length===e[0],(()=>"Element arr[".concat(n.join("]["),"] should have ").concat(e[0]," ")+"elements, but has ".concat(t.length," elements")));const r=e.slice(1);for(let i=0;i<t.length;++i)qB(t[i],r,n.concat(i))}function XB(t,e,n,r){if("string_or_numeric"!==t){if(null==t)throw new Error("Expected dtype cannot be null.");if("numeric"!==t&&t!==e||"numeric"===t&&"string"===e)throw new Error("Argument '".concat(n,"' passed to '").concat(r,"' must ")+"be ".concat(t," tensor, but got ").concat(e," tensor"))}}function YB(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(t instanceof xB())return XB(r,t.dtype,e,n),t;let i=wD(t);if("string"!==i&&["bool","int32","float32"].indexOf(r)>=0&&(i=r),XB(r,i,e,n),null==t||!nB(t)&&!Array.isArray(t)&&"number"!==typeof t&&"boolean"!==typeof t&&"string"!==typeof t){const r=null==t?"null":t.constructor.name;throw new Error("Argument '".concat(e,"' passed to '").concat(n,"' must be a ")+"Tensor or TensorLike, but got '".concat(r,"'"))}const o=HB(t,i);nB(t)||Array.isArray(t)||(t=[t]);const a="string"!==i?QU(t,i):rB(t,[],!0);return BB.makeTensor(a,o,i)}function KB(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(!Array.isArray(t))throw new Error("Argument ".concat(e," passed to ").concat(n," must be a ")+"`Tensor[]` or `TensorLike[]`");return t.map(((t,i)=>YB(t,"".concat(e,"[").concat(i,"]"),n,r)))}GB.registerFlag("DEBUG",(()=>!1),(t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),GB.registerFlag("IS_BROWSER",(()=>WB())),GB.registerFlag("IS_NODE",(()=>"undefined"!==typeof process&&"undefined"!==typeof process.versions&&"undefined"!==typeof process.versions.node)),GB.registerFlag("IS_CHROME",(()=>"undefined"!==typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor))),GB.registerFlag("IS_SAFARI",(()=>"undefined"!==typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor))),GB.registerFlag("PROD",(()=>!1)),GB.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(()=>GB.getBool("DEBUG"))),GB.registerFlag("DEPRECATION_WARNINGS_ENABLED",(()=>!0)),GB.registerFlag("IS_TEST",(()=>!1)),GB.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",(()=>GB.getBool("DEBUG"))),GB.registerFlag("WRAP_TO_IMAGEBITMAP",(()=>!1)),GB.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",(()=>!1)),GB.registerFlag("USE_SETTIMEOUTCUSTOM",(()=>!1));const ZB="__op";function JB(t){const e=Object.keys(t);if(1!==e.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+"".concat(e.length," keys."));let n=e[0];const r=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n+=ZB;const i=function(){BB.startScope(n);try{const t=r(...arguments);return ND(t)&&console.error("Cannot return a Promise inside of tidy."),BB.endScope(t),t}catch(t){throw BB.endScope(null),t}};return Object.defineProperty(i,"name",{value:n,configurable:!0}),i}const QB=JB({complex_:function(t,e){const n=YB(t,"real","complex"),r=YB(e,"imag","complex");sD(n.shape,r.shape,"real and imag shapes, ".concat(n.shape," and ").concat(r.shape,", ")+"must match in call to tf.complex().");const i={real:n,imag:r};return BB.runKernel(uL,i)}});function $B(t,e,n,r){if(null==r)r=wD(t);else if("complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(RB(t)||IB(t)){if("float32"!==r&&"int32"!==r)throw new Error("Creating tensor from GPU data only supports "+"'float32'|'int32' dtype, while the dtype is ".concat(r,"."));return BB.backend.createTensorFromGPUData(t,e||n,r)}if(!nB(t)&&!Array.isArray(t)&&"number"!==typeof t&&"boolean"!==typeof t&&"string"!==typeof t)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=e){ID(e);const t=cD(e),r=cD(n);aD(t===r,(()=>"Based on the provided shape, [".concat(e,"], the tensor should have ")+"".concat(t," values but has ").concat(r)));for(let i=0;i<n.length;++i){const t=n[i],r=i!==n.length-1||t!==cD(e.slice(i));aD(n[i]===e[i]||!r,(()=>"Error creating a new Tensor. Inferred shape "+"(".concat(n,") does not match the provided ")+"shape (".concat(e,"). ")))}}return nB(t)||Array.isArray(t)||(t=[t]),e=e||n,t="string"!==r?QU(t,r):rB(t,[],!0),BB.makeTensor(t,e,r)}function tz(t,e,n){return $B(t,e,HB(t,n),n)}const ez={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class nz{static join(t){return new nz(t).slice()}constructor(t){if(this.shards=[],this.previousShardIndex=0,null==t)return;if(t instanceof Array||(t=[t]),0===(t=t.map((t=>nB(t)?t.buffer:t))).length)return;this.bufferUniformSize=t[0].byteLength;let e=0;for(let n=0;n<t.length;n++){const r=t[n];n!==t.length-1&&r.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const i=e+r.byteLength;this.shards.push({buffer:r,start:e,end:i}),e=i}0===this.shards.length&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.byteLength;if(0===this.shards.length)return new ArrayBuffer(0);if(t=isNaN(Number(t))?0:t,e=isNaN(Number(e))?0:e,t=Math.max(0,t),e=Math.min(this.byteLength,e),e<=t)return new ArrayBuffer(0);const n=this.findShardForByte(t);if(-1===n)throw new Error("Could not find start shard for byte ".concat(t));const r=new ArrayBuffer(e-t),i=new Uint8Array(r);let o=0;for(let a=n;a<this.shards.length;a++){const n=this.shards[a],r=t+o-n.start,s=o,l=Math.min(e,n.end)-n.start,c=new Uint8Array(n.buffer,r,l-r);if(i.set(c,s),o+=c.length,e<n.end)break}return r}findShardForByte(t){if(0===this.shards.length||t<0||t>=this.byteLength)return-1;if(null!=this.bufferUniformSize)return this.previousShardIndex=Math.floor(t/this.bufferUniformSize),this.previousShardIndex;function e(e){return t<e.start?-1:t>=e.end?1:0}if(0===e(this.shards[this.previousShardIndex]))return this.previousShardIndex;const n=function(t,e){let n=0,r=t.length;for(;n<=r;){const i=Math.floor((r-n)/2)+n,o=e(t[i]);if(0===o)return i;o<0?r=i:n=i+1}return-1}(this.shards,e);return-1===n?-1:(this.previousShardIndex=n,this.previousShardIndex)}}function rz(){return BB}function iz(t,e){return BB.tidy(t,e)}function oz(t){NB(t).forEach((t=>t.dispose()))}function az(t){return BB.keep(t)}vB=function(t){FD().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")};const sz=4;async function lz(t,e){const n=[],r=[],i=Array.isArray(t)?t.map((t=>t.name)):Object.keys(t);for(let o=0;o<i.length;++o){const a=i[o],s=Array.isArray(t)?t[o].tensor:t[a];if("float32"!==s.dtype&&"int32"!==s.dtype&&"bool"!==s.dtype&&"string"!==s.dtype&&"complex64"!==s.dtype)throw new Error("Unsupported dtype in weight '".concat(a,"': ").concat(s.dtype));const l={name:a,shape:s.shape,dtype:s.dtype};if("string"===s.dtype){const t=new Promise((async t=>{const e=await s.bytes(),n=e.reduce(((t,e)=>t+e.length),0)+sz*e.length,r=new Uint8Array(n);let i=0;for(let o=0;o<e.length;o++){const t=e[o],n=new Uint8Array(new Uint32Array([t.length]).buffer);r.set(n,i),i+=sz,r.set(t,i),i+=t.length}t(r)}));r.push(t)}else r.push(s.data());null!=e&&(l.group=e),n.push(l)}return{data:mz(await Promise.all(r)),specs:n}}function cz(t,e){const n=new nz(t),r={};let i=0;for(const o of e){const t=uz(o,((t,e)=>n.slice(i+t,i+e)));r[o.name]=dz(o,n.slice(i,i+t)),i+=t}return r}function uz(t,e){const n=cD(t.shape);let r;if("quantization"in t){const e=t.quantization;r=ez[e.dtype]}else{if("string"===t.dtype){let t=0;for(let r=0;r<n;r++)t+=sz+new Uint32Array(e(t,t+sz))[0];return t}r=ez[t.dtype]}return n*r}async function hz(t,e){const n=cD(t.shape);let r;if("quantization"in t){const e=t.quantization;r=ez[e.dtype]}else{if("string"===t.dtype){let t=0;for(let r=0;r<n;r++)t+=sz+new Uint32Array(await e(t,t+sz))[0];return t}r=ez[t.dtype]}return n*r}function dz(t,e){const n=t.name,r=t.dtype,i=t.shape,o=cD(i);let a,s=0;if("quantization"in t){const i=t.quantization;if("uint8"===i.dtype||"uint16"===i.dtype){if(!("min"in i)||!("scale"in i))throw new Error("Weight ".concat(t.name," with quantization ").concat(i.dtype," ")+"doesn't have corresponding metadata min and scale.")}else{if("float16"!==i.dtype)throw new Error("Weight ".concat(t.name," has unknown ")+"quantization dtype ".concat(i.dtype,". ")+"Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.");if("float32"!==r)throw new Error("Weight ".concat(t.name," is quantized with ").concat(i.dtype," ")+"which only supports weights of type float32 not ".concat(r,"."))}const l=ez[i.dtype],c="uint8"===i.dtype?new Uint8Array(e):new Uint16Array(e);if("float32"===r)if("uint8"===i.dtype||"uint16"===i.dtype){a=new Float32Array(c.length);for(let t=0;t<c.length;t++){const e=c[t];a[t]=e*i.scale+i.min}}else{if("float16"!==i.dtype)throw new Error("Unsupported quantization type ".concat(i.dtype," ")+"for weight type float32.");{const t=function(){const t=function(){const t=t=>{let e=t<<13,n=0;for(;0===(8388608&e);)n-=8388608,e<<=1;return e&=-8388609,n+=947912704,e|n},e=new Uint32Array(2048);e[0]=0;for(let n=1;n<1024;n++)e[n]=t(n);for(let n=1024;n<2048;n++)e[n]=939524096+(n-1024<<13);return e}(),e=function(){const t=new Uint32Array(64);t[0]=0,t[31]=1199570944,t[32]=2147483648,t[63]=3347054592;for(let e=1;e<31;e++)t[e]=e<<23;for(let e=33;e<63;e++)t[e]=2147483648+(e-32<<23);return t}(),n=function(){const t=new Uint32Array(64);for(let e=0;e<64;e++)t[e]=1024;return t[0]=t[32]=0,t}();return r=>{const i=new ArrayBuffer(4*r.length),o=new Uint32Array(i);for(let a=0;a<r.length;a++){const i=r[a],s=t[n[i>>10]+(1023&i)]+e[i>>10];o[a]=s}return new Float32Array(i)}}();a=t(c)}}else{if("int32"!==r)throw new Error("Unsupported dtype in weight '".concat(n,"': ").concat(r));if("uint8"!==i.dtype&&"uint16"!==i.dtype)throw new Error("Unsupported quantization type ".concat(i.dtype," ")+"for weight type int32.");a=new Int32Array(c.length);for(let t=0;t<c.length;t++){const e=c[t];a[t]=Math.round(e*i.scale+i.min)}}s+=o*l}else if("string"===r){const n=cD(t.shape);a=[];for(let t=0;t<n;t++){const t=new Uint32Array(e.slice(s,s+sz))[0];s+=sz;const n=new Uint8Array(e.slice(s,s+t));a.push(n),s+=t}}else{const t=ez[r];if("float32"===r)a=new Float32Array(e);else if("int32"===r)a=new Int32Array(e);else{if("bool"!==r){if("complex64"===r){a=new Float32Array(e);const t=new Float32Array(a.length/2),n=new Float32Array(a.length/2);for(let e=0;e<t.length;e++)t[e]=a[2*e],n[e]=a[2*e+1];const r=tz(t,i,"float32"),o=tz(n,i,"float32"),s=QB(r,o);return r.dispose(),o.dispose(),s}throw new Error("Unsupported dtype in weight '".concat(n,"': ").concat(r))}a=new Uint8Array(e)}s+=o*t}return tz(a,i,r)}async function pz(t,e,n){let r=new Uint8Array(e);for(;r.byteLength<n;){const{done:e,value:i}=await t.read();if(e&&null==i){const t=n-r.byteLength;throw new Error("Reader is done but ".concat(t," bytes are still expected"))}const o=new Uint8Array(r.length+i.byteLength);o.set(r,0),o.set(new Uint8Array(i),r.length),r=o}return r.buffer}async function fz(t,e){const n={},r=t.getReader();let i=new ArrayBuffer(0);for(const o of e){const t=await hz(o,(async(t,e)=>(i=await pz(r,i,e),i.slice(t,e))));i=await pz(r,i,t);const e=i.slice(0,t);i=i.slice(t);const a=dz(o,e);if(n[o.name]=a,"webgpu"===BB.backendName){const t=BB.backend;"uploadToGPU"in t&&cD(a.shape)>=FD().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&t.uploadToGPU(a.dataId)}}return n}function mz(t){if(null===t)throw new Error("Invalid input value: ".concat(JSON.stringify(t)));let e=0;const n=[];t.forEach((t=>{if(e+=t.byteLength,n.push(t.byteLength===t.buffer.byteLength?t:new t.constructor(t)),!(t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: ".concat(t.constructor.name))}));const r=new Uint8Array(e);let i=0;return n.forEach((t=>{r.set(new Uint8Array(t.buffer),i),i+=t.byteLength})),r.buffer}const gz="undefined"!==typeof Buffer&&("undefined"===typeof Blob||"undefined"===typeof atob||"undefined"===typeof btoa);function yz(t){return gz?Buffer.byteLength(t,"utf8"):new Blob([t]).size}function vz(t){return nz.join(t)}function bz(t){for(t=t.trim();t.endsWith("/");)t=t.slice(0,t.length-1);const e=t.split("/");return e[e.length-1]}function xz(t,e){const n={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:e};return null!=t.signature&&(n.signature=t.signature),null!=t.userDefinedMetadata&&(n.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(n.modelInitializer=t.modelInitializer),null!=t.initializerSignature&&(n.initializerSignature=t.initializerSignature),null!=t.trainingConfig&&(n.trainingConfig=t.trainingConfig),n}function _z(t,e,n){const r={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy};if(null!=t.trainingConfig&&(r.trainingConfig=t.trainingConfig),null!=t.weightsManifest){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=e,r.weightData=n}return null!=t.signature&&(r.signature=t.signature),null!=t.userDefinedMetadata&&(r.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(r.modelInitializer=t.modelInitializer),null!=t.initializerSignature&&(r.initializerSignature=t.initializerSignature),r}async function wz(t,e){let n,r;return null!=t.weightsManifest&&([n,r]=await e(t.weightsManifest)),_z(t,n,r)}function Sz(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==t.modelTopology?0:yz(JSON.stringify(t.modelTopology)),weightSpecsBytes:null==t.weightSpecs?0:yz(JSON.stringify(t.weightSpecs)),weightDataBytes:null==t.weightData?0:new nz(t.weightData).byteLength}}function Tz(t){const e=[];for(const n of t)e.push(...n.weights);return e}class Ez{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return null==Ez.instance&&(Ez.instance=new Ez),Ez.instance}static registerSaveRouter(t){Ez.getInstance().saveRouters.push(t)}static registerLoadRouter(t){Ez.getInstance().loadRouters.push(t)}static getSaveHandlers(t){return Ez.getHandlers(t,"save")}static getLoadHandlers(t,e){return Ez.getHandlers(t,"load",e)}static getHandlers(t,e,n){const r=[];return("load"===e?Ez.getInstance().loadRouters:Ez.getInstance().saveRouters).forEach((e=>{const i=e(t,n);null!==i&&r.push(i)})),r}}const Mz=t=>Ez.registerSaveRouter(t),Cz=t=>Ez.registerLoadRouter(t),Az=t=>Ez.getSaveHandlers(t),kz=(t,e)=>Ez.getLoadHandlers(t,e),Iz="tensorflowjs",Rz="models_store",Pz="model_info_store";function Nz(){if(!FD().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t="undefined"===typeof window?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(null==e)throw new Error("The current browser does not appear to support IndexedDB.");return e}function Oz(t){const e=t.result;e.createObjectStore(Rz,{keyPath:"modelPath"}),e.createObjectStore(Pz,{keyPath:"modelPath"})}class Dz{constructor(t){if(this.indexedDB=Nz(),null==t||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,t)}async load(){return this.databaseAction(this.modelPath)}databaseAction(t,e){return new Promise(((t,n)=>{const r=this.indexedDB.open(Iz,1);r.onupgradeneeded=()=>Oz(r),r.onsuccess=()=>{const i=r.result;if(null==e){const e=i.transaction(Rz,"readonly"),r=e.objectStore(Rz).get(this.modelPath);r.onsuccess=()=>{if(null==r.result)return i.close(),n(new Error("Cannot find model with path '".concat(this.modelPath,"' ")+"in IndexedDB."));t(r.result.modelArtifacts)},r.onerror=t=>(i.close(),n(r.error)),e.oncomplete=()=>i.close()}else{e.weightData=nz.join(e.weightData);const r=Sz(e),o=i.transaction(Pz,"readwrite");let a,s,l=o.objectStore(Pz);try{a=l.put({modelPath:this.modelPath,modelArtifactsInfo:r})}catch(oA){return n(oA)}a.onsuccess=()=>{s=i.transaction(Rz,"readwrite");const a=s.objectStore(Rz);let c;try{c=a.put({modelPath:this.modelPath,modelArtifacts:e,modelArtifactsInfo:r})}catch(oA){return n(oA)}c.onsuccess=()=>t({modelArtifactsInfo:r}),c.onerror=t=>{l=o.objectStore(Pz);const e=l.delete(this.modelPath);e.onsuccess=()=>(i.close(),n(c.error)),e.onerror=t=>(i.close(),n(c.error))}},a.onerror=t=>(i.close(),n(a.error)),o.oncomplete=()=>{null==s?i.close():s.oncomplete=()=>i.close()}}},r.onerror=t=>n(r.error)}))}}Dz.URL_SCHEME="indexeddb://";const Lz=t=>{return FD().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Dz.URL_SCHEME)?(e=t.slice(Dz.URL_SCHEME.length),new Dz(e)):null;var e};Ez.registerSaveRouter(Lz),Ez.registerLoadRouter(Lz);class Fz{constructor(){this.indexedDB=Nz()}async listModels(){return new Promise(((t,e)=>{const n=this.indexedDB.open(Iz,1);n.onupgradeneeded=()=>Oz(n),n.onsuccess=()=>{const r=n.result,i=r.transaction(Pz,"readonly"),o=i.objectStore(Pz).getAll();o.onsuccess=()=>{const e={};for(const t of o.result)e[t.modelPath]=t.modelArtifactsInfo;t(e)},o.onerror=t=>(r.close(),e(o.error)),i.oncomplete=()=>r.close()},n.onerror=t=>e(n.error)}))}async removeModel(t){var e;return t=(e=t).startsWith(Dz.URL_SCHEME)?e.slice(Dz.URL_SCHEME.length):e,new Promise(((e,n)=>{const r=this.indexedDB.open(Iz,1);r.onupgradeneeded=()=>Oz(r),r.onsuccess=()=>{const i=r.result,o=i.transaction(Pz,"readwrite"),a=o.objectStore(Pz),s=a.get(t);let l;s.onsuccess=()=>{if(null==s.result)return i.close(),n(new Error("Cannot find model with path '".concat(t,"' ")+"in IndexedDB."));{const r=a.delete(t),o=()=>{l=i.transaction(Rz,"readwrite");const r=l.objectStore(Rz).delete(t);r.onsuccess=()=>e(s.result.modelArtifactsInfo),r.onerror=t=>n(s.error)};r.onsuccess=o,r.onerror=t=>(o(),i.close(),n(s.error))}},s.onerror=t=>(i.close(),n(s.error)),o.oncomplete=()=>{null==l?i.close():l.oncomplete=()=>i.close()}},r.onerror=t=>n(r.error)}))}}const Uz="/",Bz="tensorflowjs_models",zz="info",jz="model_topology",Vz="weight_specs",Wz="weight_data",Gz="model_metadata";function Hz(t){return{info:[Bz,t,zz].join(Uz),topology:[Bz,t,jz].join(Uz),weightSpecs:[Bz,t,Vz].join(Uz),weightData:[Bz,t,Wz].join(Uz),modelMetadata:[Bz,t,Gz].join(Uz)}}function qz(t){for(const e of Object.values(t))window.localStorage.removeItem(e)}function Xz(t){const e=t.split(Uz);if(e.length<3)throw new Error("Invalid key format: ".concat(t));return e.slice(1,e.length-1).join(Uz)}class Yz{constructor(t){if(!FD().getBool("IS_BROWSER")||"undefined"===typeof window||"undefined"===typeof window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==t||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=Hz(this.modelPath)}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(t.modelTopology),r=JSON.stringify(t.weightSpecs),i=Sz(t),o=nz.join(t.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(i)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,function(t){if(gz)return Buffer.from(t).toString("base64");const e=new Uint8Array(t);let n="";for(let r=0,i=e.length;r<i;r++)n+=String.fromCharCode(e[r]);return btoa(n)}(o));const e={format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,signature:null!=t.signature?t.signature:void 0,userDefinedMetadata:null!=t.userDefinedMetadata?t.userDefinedMetadata:void 0,modelInitializer:null!=t.modelInitializer?t.modelInitializer:void 0,initializerSignature:null!=t.initializerSignature?t.initializerSignature:void 0,trainingConfig:null!=t.trainingConfig?t.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(e)),{modelArtifactsInfo:i}}catch(e){throw qz(this.keys),new Error("Failed to save model '".concat(this.modelPath,"' to local storage: ")+"size quota being exceeded is a possible cause of this failure: "+"modelTopologyBytes=".concat(i.modelTopologyBytes,", ")+"weightSpecsBytes=".concat(i.weightSpecsBytes,", ")+"weightDataBytes=".concat(i.weightDataBytes,"."))}}}async load(){const t=JSON.parse(this.LS.getItem(this.keys.info));if(null==t)throw new Error("In local storage, there is no model with name '".concat(this.modelPath,"'"));if("JSON"!==t.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const e={},n=JSON.parse(this.LS.getItem(this.keys.topology));if(null==n)throw new Error("In local storage, the topology of model '".concat(this.modelPath,"' ")+"is missing.");e.modelTopology=n;const r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(null==r)throw new Error("In local storage, the weight specs of model '".concat(this.modelPath,"' ")+"are missing.");e.weightSpecs=r;const i=this.LS.getItem(this.keys.modelMetadata);if(null!=i){const t=JSON.parse(i);e.format=t.format,e.generatedBy=t.generatedBy,e.convertedBy=t.convertedBy,null!=t.signature&&(e.signature=t.signature),null!=t.userDefinedMetadata&&(e.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(e.modelInitializer=t.modelInitializer),null!=t.initializerSignature&&(e.initializerSignature=t.initializerSignature),null!=t.trainingConfig&&(e.trainingConfig=t.trainingConfig)}const o=this.LS.getItem(this.keys.weightData);if(null==o)throw new Error("In local storage, the binary weight values of model "+"'".concat(this.modelPath,"' are missing."));return e.weightData=function(t){if(gz){const e=Buffer.from(t,"base64");return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}const e=atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;++r)n.set([e.charCodeAt(r)],r);return n.buffer}(o),e}}Yz.URL_SCHEME="localstorage://";const Kz=t=>{return FD().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Yz.URL_SCHEME)?(e=t.slice(Yz.URL_SCHEME.length),new Yz(e)):null;var e};Ez.registerSaveRouter(Kz),Ez.registerLoadRouter(Kz);class Zz{constructor(){aD(FD().getBool("IS_BROWSER"),(()=>"Current environment is not a web browser")),aD("undefined"===typeof window||"undefined"!==typeof window.localStorage,(()=>"Current browser does not appear to support localStorage")),this.LS=window.localStorage}async listModels(){const t={},e=Bz+Uz,n=Uz+zz;for(let r=0;r<this.LS.length;++r){const i=this.LS.key(r);if(i.startsWith(e)&&i.endsWith(n)){t[Xz(i)]=JSON.parse(this.LS.getItem(i))}}return t}async removeModel(t){var e;const n=Hz(t=(e=t).startsWith(Yz.URL_SCHEME)?e.slice(Yz.URL_SCHEME.length):e);if(null==this.LS.getItem(n.info))throw new Error("Cannot find model at path '".concat(t,"'"));const r=JSON.parse(this.LS.getItem(n.info));return qz(n),r}}const Jz="://";class Qz{constructor(){this.managers={}}static getInstance(){return null==Qz.instance&&(Qz.instance=new Qz),Qz.instance}static registerManager(t,e){aD(null!=t,(()=>"scheme must not be undefined or null.")),t.endsWith(Jz)&&(t=t.slice(0,t.indexOf(Jz))),aD(t.length>0,(()=>"scheme must not be an empty string."));const n=Qz.getInstance();aD(null==n.managers[t],(()=>"A model store manager is already registered for scheme '".concat(t,"'."))),n.managers[t]=e}static getManager(t){const e=Qz.getInstance().managers[t];if(null==e)throw new Error("Cannot find model manager for scheme '".concat(t,"'"));return e}static getSchemes(){return Object.keys(Qz.getInstance().managers)}}function $z(t){if(-1===t.indexOf(Jz))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+"".concat(Qz.getSchemes().join(",")));return{scheme:t.split(Jz)[0],path:t.split(Jz)[1]}}async function tj(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];aD(t!==e,(()=>"Old path and new path are the same: '".concat(t,"'")));const r=Ez.getLoadHandlers(t);aD(r.length>0,(()=>"Copying failed because no load handler is found for source URL ".concat(t,"."))),aD(r.length<2,(()=>"Copying failed because more than one (".concat(r.length,") ")+"load handlers for source URL ".concat(t,".")));const i=r[0],o=Ez.getSaveHandlers(e);aD(o.length>0,(()=>"Copying failed because no save handler is found for destination "+"URL ".concat(e,"."))),aD(o.length<2,(()=>"Copying failed because more than one (".concat(r.length,") ")+"save handlers for destination URL ".concat(e,".")));const a=o[0],s=$z(t).scheme,l=$z(t).path,c=s===$z(t).scheme,u=await i.load();n&&c&&await Qz.getManager(s).removeModel(l);const h=await a.save(u);return n&&!c&&await Qz.getManager(s).removeModel(l),h.modelArtifactsInfo}async function ej(){const t=Qz.getSchemes(),e={};for(const n of t){const t=await Qz.getManager(n).listModels();for(const r in t){e[n+Jz+r]=t[r]}}return e}async function nj(t){const e=$z(t);return Qz.getManager(e.scheme).removeModel(e.path)}async function rj(t,e){return tj(t,e,!1)}async function ij(t,e){return tj(t,e,!0)}class oj{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(t,e){return fetch(t,e)}now(){return performance.now()}encode(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error("Browser's encoder only supports utf-8, but got ".concat(e));return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)}decode(t,e){return new TextDecoder(e).decode(t)}setTimeoutCustom(t,e){"undefined"!==typeof window&&FD().getBool("USE_SETTIMEOUTCUSTOM")?(this.functionRefs.push(t),setTimeout((()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")}),e),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",(t=>{if(t.source===window&&t.data.name===this.messageName){t.stopPropagation();(0,this.functionRefs[t.data.index])(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}}),!0))):setTimeout(t,e)}isTypedArray(t){return LU(t)}}if(FD().get("IS_BROWSER")){FD().setPlatform("browser",new oj);try{Qz.registerManager(Yz.URL_SCHEME,new Zz)}catch(t9){}try{Qz.registerManager(Dz.URL_SCHEME,new Fz)}catch(t9){}}const aj=()=>__webpack_require__(817);let sj;class lj{constructor(){this.util=__webpack_require__(590),this.textEncoder=new this.util.TextEncoder}fetch(t,e){return null!=FD().global.fetch?FD().global.fetch(t,e):(null==sj&&(sj=aj()),sj(t,e))}now(){const t=process.hrtime();return 1e3*t[0]+t[1]/1e6}encode(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error("Node built-in encoder only supports utf-8, but got ".concat(e));return this.textEncoder.encode(t)}decode(t,e){return 0===t.length?"":new this.util.TextDecoder(e).decode(t)}isTypedArray(t){return this.util.types.isFloat32Array(t)||this.util.types.isInt32Array(t)||this.util.types.isUint8Array(t)||this.util.types.isUint8ClampedArray(t)}}function cj(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",n=arguments.length>2?arguments[2]:void 0;return e=e||"float32",ID(t),new mB(t,e,n)}FD().get("IS_NODE")&&!FD().get("IS_BROWSER")&&FD().setPlatform("node",new lj);const uj=JB({cast_:function(t,e){const n=YB(t,"x","cast");if(!function(t){return"bool"===t||"complex64"===t||"float32"===t||"int32"===t||"string"===t}(e))throw new Error("Failed to cast to unknown dtype ".concat(e));if("string"===e&&"string"!==n.dtype||"string"!==e&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");const r={x:n},i={dtype:e};return BB.runKernel(sL,r,i)}});const hj=JB({clone_:function(t){const e={x:YB(t,"x","clone","string_or_numeric")};return BB.runKernel(HL,e)}});function dj(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log(t.toString(e))}UB();yB={buffer:cj,cast:uj,clone:hj,print:dj};const pj=JB({add_:function(t,e){let n=YB(t,"a","add"),r=YB(e,"b","add");[n,r]=PB(n,r);const i={a:n,b:r};return BB.runKernel(HD,i)}});const fj=JB({floorDiv_:function(t,e){let n=YB(t,"a","floorDiv"),r=YB(e,"b","floorDiv");[n,r]=PB(n,r);const i={a:n,b:r};return BB.runKernel(BL,i)}});const mj=JB({div_:function(t,e){let n=YB(t,"a","div"),r=YB(e,"b","div");if([n,r]=PB(n,r),"int32"===n.dtype&&"int32"===r.dtype)return fj(n,r);const i={a:n,b:r};return BB.runKernel(IL,i,{})}});const gj=JB({mul_:function(t,e){let n=YB(t,"a","mul"),r=YB(e,"b","mul");[n,r]=PB(n,r);const i={a:n,b:r};return BB.runKernel(fF,i)}});const yj=JB({sqrt_:function(t){const e={x:YB(t,"x","sqrt","float32")};return BB.runKernel(ZF,e)}});const vj=JB({square_:function(t){const e=YB(t,"x","square");return BB.runKernel("Square",{x:e},{})}});const bj=JB({zerosLike_:function(t){const e={x:YB(t,"x","zerosLike")};return BB.runKernel(xU,e)}});function xj(t){return BB.customGrad(t)}function _j(t,e){if((nB(t)&&"string"!==e||Array.isArray(t))&&"complex64"!==e)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===e&&nB(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return $B(t,[],[],e)}const wj=new Map,Sj=new Map;class Tj{getClassName(){return this.constructor.className}static fromConfig(t,e){return new t(e)}}class Ej{constructor(){this.classNameMap={}}static getMap(){return null==Ej.instance&&(Ej.instance=new Ej),Ej.instance}static register(t){Ej.getMap().classNameMap[t.className]=[t,t.fromConfig]}}function Mj(t,e,n){aD(null!=t.className,(()=>"Class being registered does not have the static className property defined.")),aD("string"===typeof t.className,(()=>"className is required to be a string, but got type "+typeof t.className)),aD(t.className.length>0,(()=>"Class being registered has an empty-string as its className, which is disallowed.")),"undefined"===typeof e&&(e="Custom"),"undefined"===typeof n&&(n=t.className);const r=e+">"+n;return Ej.register(t),wj.set(r,t),Sj.set(t,r),t}class Cj extends Tj{minimize(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;const{value:r,grads:i}=this.computeGradients(t,n);if(null!=n){const t=n.map((t=>({name:t.name,tensor:i[t.name]})));this.applyGradients(t)}else this.applyGradients(i);return oz(i),e?r:(r.dispose(),null)}get iterations(){return null==this.iterations_&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(t,e){return function(t,e){aD(SD(t),(()=>"The f passed in variableGrads(f) must be a function")),aD(null==e||Array.isArray(e)&&e.every((t=>t instanceof _B)),(()=>"The varList passed in variableGrads(f, varList) must be an array of variables"));const n=null!=e;if(!n){e=[];for(const t in BB.registeredVariables)e.push(BB.registeredVariables[t])}const r=n?e.filter((t=>!t.trainable)):null,i=e.length;e=e.filter((t=>t.trainable)),aD(e.length>0,(()=>"variableGrads() expects at least one of the input variables to "+"be trainable, but none of the ".concat(i," variables is ")+"trainable."));const{value:o,grads:a}=BB.gradients(t,e,null,!0);aD(a.some((t=>null!=t)),(()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize().")),aD(0===o.rank,(()=>"The f passed in variableGrads(f) must return a scalar, but it "+"returned a rank-".concat(o.rank," tensor")));const s={};return e.forEach(((t,e)=>{null!=a[e]&&(s[t.name]=a[e])})),null!=r&&r.forEach((t=>s[t.name]=null)),{value:o,grads:s}}(t,e)}dispose(){null!=this.iterations_&&oz(this.iterations_)}async saveIterations(){return null==this.iterations_&&(this.iterations_=0),{name:"iter",tensor:_j(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(t){throw new Error("setWeights() is not implemented for this optimizer class "+"".concat(this.getClassName()))}async extractIterations(t){return this.iterations_=(await t[0].tensor.data())[0],t.slice(1)}}Object.defineProperty(Cj,Symbol.hasInstance,{value:t=>null!=t.minimize&&null!=t.computeGradients&&null!=t.applyGradients});function Aj(t,e,n){ID(t);const r={shape:t,value:e,dtype:n=n||wD(e)};return BB.runKernel(LL,{},r)}const kj=JB({pow_:function(t,e){let n=YB(t,"base","pow"),r=YB(e,"exp","pow");[n,r]=PB(n,r);const i={a:n,b:r};return BB.runKernel("Pow",i)}});const Ij=JB({sub_:function(t,e){let n=YB(t,"a","sub"),r=YB(e,"b","sub");[n,r]=PB(n,r);const i={a:n,b:r};return BB.runKernel(hU,i)}});const Rj=JB({abs_:function(t){const e=YB(t,"x","abs");if("complex64"===e.dtype){const t={x:e};return BB.runKernel(hL,t)}{const t={x:e};return BB.runKernel(VD,t)}}});function Pj(t,e){const n=t.length,r=[];for(let i=0;i<n;i++){const o=n-1-i,a=t[o]||1;(e[e.length-1-i]||1)>1&&1===a&&r.unshift(o)}return r}function Nj(t,e){const n=[];for(let r=0;r<e.length;r++){const i=t[t.length-r-1],o=e.length-r-1,a=e[o];(null==i||1===i&&a>1)&&n.unshift(o)}return n}function Oj(t,e){const n=Math.max(t.length,e.length),r=new Array(n);for(let i=0;i<n;i++){let o=t[t.length-i-1];null==o&&(o=1);let a=e[e.length-i-1];if(null==a&&(a=1),1===o)r[n-i-1]=a;else if(1===a)r[n-i-1]=o;else{if(o!==a){const n="Operands could not be broadcast together with shapes "+"".concat(t," and ").concat(e,".");throw Error(n)}r[n-i-1]=o}}return r}const Dj=JB({maximum_:function(t,e){let n=YB(t,"a","maximum"),r=YB(e,"b","maximum");[n,r]=PB(n,r),"bool"===n.dtype&&(n=uj(n,"int32"),r=uj(r,"int32")),Oj(n.shape,r.shape);const i={a:n,b:r};return BB.runKernel(aF,i)}});class Lj extends Cj{static get className(){return"SGD"}constructor(t){super(),this.learningRate=t,this.setLearningRate(t)}applyGradients(t){const e=Array.isArray(t)?t.map((t=>t.name)):Object.keys(t);e.forEach(((e,n)=>{const r=Array.isArray(t)?t[n].tensor:t[e];if(null==r)return;const i=BB.registeredVariables[e];iz((()=>{const t=pj(gj(this.c,r),i);i.assign(t)}))})),this.incrementIterations()}setLearningRate(t){this.learningRate=t,null!=this.c&&this.c.dispose(),this.c=az(_j(-t))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(t){if(0!==(t=await this.extractIterations(t)).length)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(t,e){return new t(e.learningRate)}}const Fj=[class extends Cj{static get className(){return"Adadelta"}constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super(),this.learningRate=t,this.rho=e,this.epsilon=n,this.accumulatedGrads=[],this.accumulatedUpdates=[],null==n&&(this.epsilon=BB.backend.epsilon())}applyGradients(t){(Array.isArray(t)?t.map((t=>t.name)):Object.keys(t)).forEach(((e,n)=>{const r=BB.registeredVariables[e],i=!1;null==this.accumulatedGrads[n]&&(this.accumulatedGrads[n]={originalName:"".concat(e,"/accum_grad"),variable:iz((()=>bj(r).variable(i)))}),null==this.accumulatedUpdates[n]&&(this.accumulatedUpdates[n]={originalName:"".concat(e,"/accum_var"),variable:iz((()=>bj(r).variable(i)))});const o=Array.isArray(t)?t[n].tensor:t[e];if(null==o)return;const a=this.accumulatedGrads[n].variable,s=this.accumulatedUpdates[n].variable;iz((()=>{const t=pj(gj(a,this.rho),gj(vj(o),1-this.rho)),e=gj(mj(yj(pj(s,this.epsilon)),yj(pj(a,this.epsilon))),o),n=pj(gj(s,this.rho),gj(vj(e),1-this.rho));a.assign(t),s.assign(n);const i=pj(gj(e,-this.learningRate),r);r.assign(i)}))})),this.incrementIterations()}dispose(){null!=this.accumulatedUpdates&&(oz(this.accumulatedGrads.map((t=>t.variable))),oz(this.accumulatedUpdates.map((t=>t.variable))))}async getWeights(){const t=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(t.map((t=>({name:t.originalName,tensor:t.variable}))))}async setWeights(t){const e=(t=await this.extractIterations(t)).length/2,n=!1;this.accumulatedGrads=t.slice(0,e).map((t=>({originalName:t.name,variable:t.tensor.variable(n)}))),this.accumulatedUpdates=t.slice(e,2*e).map((t=>({originalName:t.name,variable:t.tensor.variable(n)})))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(t,e){return new t(e.learningRate,e.rho,e.epsilon)}},class extends Cj{static get className(){return"Adagrad"}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;super(),this.learningRate=t,this.initialAccumulatorValue=e,this.accumulatedGrads=[]}applyGradients(t){(Array.isArray(t)?t.map((t=>t.name)):Object.keys(t)).forEach(((e,n)=>{const r=BB.registeredVariables[e];if(null==this.accumulatedGrads[n]){const t=!1;this.accumulatedGrads[n]={originalName:"".concat(e,"/accumulator"),variable:iz((()=>Aj(r.shape,this.initialAccumulatorValue).variable(t)))}}const i=Array.isArray(t)?t[n].tensor:t[e];if(null==i)return;const o=this.accumulatedGrads[n].variable;iz((()=>{const t=pj(o,vj(i));o.assign(t);const e=pj(gj(mj(i,yj(pj(t,BB.backend.epsilon()))),-this.learningRate),r);r.assign(e)}))})),this.incrementIterations()}dispose(){null!=this.accumulatedGrads&&oz(this.accumulatedGrads.map((t=>t.variable)))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map((t=>({name:t.originalName,tensor:t.variable}))))}async setWeights(t){t=await this.extractIterations(t);this.accumulatedGrads=t.map((t=>({originalName:t.name,variable:t.tensor.variable(false)})))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(t,e){return new t(e.learningRate,e.initialAccumulatorValue)}},class extends Cj{static get className(){return"Adam"}constructor(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super(),this.learningRate=t,this.beta1=e,this.beta2=n,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],iz((()=>{this.accBeta1=_j(e).variable(),this.accBeta2=_j(n).variable()})),null==r&&(this.epsilon=BB.backend.epsilon())}applyGradients(t){const e=Array.isArray(t)?t.map((t=>t.name)):Object.keys(t);iz((()=>{const n=Ij(1,this.accBeta1),r=Ij(1,this.accBeta2);e.forEach(((e,i)=>{const o=BB.registeredVariables[e],a=!1;null==this.accumulatedFirstMoment[i]&&(this.accumulatedFirstMoment[i]={originalName:"".concat(e,"/m"),variable:iz((()=>bj(o).variable(a)))}),null==this.accumulatedSecondMoment[i]&&(this.accumulatedSecondMoment[i]={originalName:"".concat(e,"/v"),variable:iz((()=>bj(o).variable(a)))});const s=Array.isArray(t)?t[i].tensor:t[e];if(null==s)return;const l=this.accumulatedFirstMoment[i].variable,c=this.accumulatedSecondMoment[i].variable,u=pj(gj(l,this.beta1),gj(s,1-this.beta1)),h=pj(gj(c,this.beta2),gj(vj(s),1-this.beta2)),d=mj(u,n),p=mj(h,r);l.assign(u),c.assign(h);const f=pj(gj(mj(d,pj(yj(p),this.epsilon)),-this.learningRate),o);o.assign(f)})),this.accBeta1.assign(gj(this.accBeta1,this.beta1)),this.accBeta2.assign(gj(this.accBeta2,this.beta2))})),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&oz(this.accumulatedFirstMoment.map((t=>t.variable))),null!=this.accumulatedSecondMoment&&oz(this.accumulatedSecondMoment.map((t=>t.variable)))}async getWeights(){const t=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(t.map((t=>({name:t.originalName,tensor:t.variable}))))}async setWeights(t){t=await this.extractIterations(t),iz((()=>{this.accBeta1.assign(kj(this.beta1,this.iterations_+1)),this.accBeta2.assign(kj(this.beta2,this.iterations_+1))}));const e=t.length/2,n=!1;this.accumulatedFirstMoment=t.slice(0,e).map((t=>({originalName:t.name,variable:t.tensor.variable(n)}))),this.accumulatedSecondMoment=t.slice(e,2*e).map((t=>({originalName:t.name,variable:t.tensor.variable(n)})))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon)}},class extends Cj{static get className(){return"Adamax"}constructor(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;super(),this.learningRate=t,this.beta1=e,this.beta2=n,this.epsilon=r,this.decay=i,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],iz((()=>{this.iteration=_j(0).variable(),this.accBeta1=_j(e).variable()})),null==r&&(this.epsilon=BB.backend.epsilon())}applyGradients(t){const e=Array.isArray(t)?t.map((t=>t.name)):Object.keys(t);iz((()=>{const n=Ij(1,this.accBeta1),r=mj(-this.learningRate,pj(gj(this.iteration,this.decay),1));e.forEach(((e,i)=>{const o=BB.registeredVariables[e],a=!1;null==this.accumulatedFirstMoment[i]&&(this.accumulatedFirstMoment[i]={originalName:"".concat(e,"/m"),variable:bj(o).variable(a)}),null==this.accumulatedWeightedInfNorm[i]&&(this.accumulatedWeightedInfNorm[i]={originalName:"".concat(e,"/v"),variable:bj(o).variable(a)});const s=Array.isArray(t)?t[i].tensor:t[e];if(null==s)return;const l=this.accumulatedFirstMoment[i].variable,c=this.accumulatedWeightedInfNorm[i].variable,u=pj(gj(l,this.beta1),gj(s,1-this.beta1)),h=gj(c,this.beta2),d=Rj(s),p=Dj(h,d);l.assign(u),c.assign(p);const f=pj(gj(mj(r,n),mj(u,pj(p,this.epsilon))),o);o.assign(f)})),this.iteration.assign(pj(this.iteration,1)),this.accBeta1.assign(gj(this.accBeta1,this.beta1))})),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&oz(this.accumulatedFirstMoment.map((t=>t.variable))),null!=this.accumulatedWeightedInfNorm&&oz(this.accumulatedWeightedInfNorm.map((t=>t.variable)))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(t){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon,e.decay)}},class extends Lj{static get className(){return"Momentum"}constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super(t),this.learningRate=t,this.momentum=e,this.useNesterov=n,this.accumulations=[],this.m=_j(this.momentum)}applyGradients(t){(Array.isArray(t)?t.map((t=>t.name)):Object.keys(t)).forEach(((e,n)=>{const r=BB.registeredVariables[e];if(null==this.accumulations[n]){const t=!1;this.accumulations[n]={originalName:"".concat(e,"/momentum"),variable:iz((()=>bj(r).variable(t)))}}const i=this.accumulations[n].variable,o=Array.isArray(t)?t[n].tensor:t[e];null!=o&&iz((()=>{let t;const e=pj(gj(this.m,i),o);t=this.useNesterov?pj(gj(this.c,pj(o,gj(e,this.m))),r):pj(gj(this.c,e),r),i.assign(e),r.assign(t)}))})),this.incrementIterations()}dispose(){this.m.dispose(),null!=this.accumulations&&oz(this.accumulations.map((t=>t.variable)))}setMomentum(t){this.momentum=t}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map((t=>({name:t.originalName,tensor:t.variable}))))}async setWeights(t){t=await this.extractIterations(t);this.accumulations=t.map((t=>({originalName:t.name,variable:t.tensor.variable(false)})))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(t,e){return new t(e.learningRate,e.momentum,e.useNesterov)}},class extends Cj{static get className(){return"RMSProp"}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(super(),this.learningRate=t,this.decay=e,this.momentum=n,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=i,null==r&&(this.epsilon=BB.backend.epsilon()),null==t)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(t){(Array.isArray(t)?t.map((t=>t.name)):Object.keys(t)).forEach(((e,n)=>{const r=BB.registeredVariables[e],i=!1;null==this.accumulatedMeanSquares[n]&&(this.accumulatedMeanSquares[n]={originalName:"".concat(e,"/rms"),variable:iz((()=>bj(r).variable(i)))}),null==this.accumulatedMoments[n]&&(this.accumulatedMoments[n]={originalName:"".concat(e,"/momentum"),variable:iz((()=>bj(r).variable(i)))}),null==this.accumulatedMeanGrads[n]&&this.centered&&(this.accumulatedMeanGrads[n]={originalName:"".concat(e,"/mg"),variable:iz((()=>bj(r).variable(i)))});const o=Array.isArray(t)?t[n].tensor:t[e];if(null==o)return;const a=this.accumulatedMeanSquares[n].variable,s=this.accumulatedMoments[n].variable;iz((()=>{const t=pj(gj(a,this.decay),gj(vj(o),1-this.decay));if(this.centered){const e=this.accumulatedMeanGrads[n].variable,i=pj(gj(e,this.decay),gj(o,1-this.decay)),l=mj(gj(o,this.learningRate),yj(Ij(t,pj(vj(i),this.epsilon)))),c=pj(gj(s,this.momentum),l);a.assign(t),e.assign(i),s.assign(c);const u=Ij(r,c);r.assign(u)}else{const t=pj(gj(a,this.decay),gj(vj(o),1-this.decay)),e=pj(gj(s,this.momentum),mj(gj(o,this.learningRate),yj(pj(t,this.epsilon))));a.assign(t),s.assign(e);const n=Ij(r,e);r.assign(n)}}))})),this.incrementIterations()}dispose(){null!=this.accumulatedMeanSquares&&oz(this.accumulatedMeanSquares.map((t=>t.variable))),null!=this.accumulatedMeanGrads&&this.centered&&oz(this.accumulatedMeanGrads.map((t=>t.variable))),null!=this.accumulatedMoments&&oz(this.accumulatedMoments.map((t=>t.variable)))}async getWeights(){const t=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&t.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(t.map((t=>({name:t.originalName,tensor:t.variable}))))}async setWeights(t){t=await this.extractIterations(t);const e=this.centered?t.length/3:t.length/2,n=!1;this.accumulatedMeanSquares=t.slice(0,e).map((t=>({originalName:t.name,variable:t.tensor.variable(n)}))),this.accumulatedMoments=t.slice(e,2*e).map((t=>({originalName:t.name,variable:t.tensor.variable(n)}))),this.centered&&(this.accumulatedMeanGrads=t.slice(2*e,3*e).map((t=>({originalName:t.name,variable:t.tensor.variable(n)}))))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(t,e){return new t(e.learningRate,e.decay,e.momentum,e.epsilon,e.centered)}},Lj];function Uj(t){return new Promise((t=>setTimeout(t))).then(t)}class Bj{constructor(t){if(!FD().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(Bj.URL_SCHEME)&&(t=t.slice(Bj.URL_SCHEME.length)),null!=t&&0!==t.length||(t="model"),this.modelJsonFileName=t+".json",this.weightDataFileName=t+".weights.bin"}async save(t){if("undefined"===typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");const e=nz.join(t.weightData),n=window.URL.createObjectURL(new Blob([e],{type:"application/octet-stream"}));if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const e=xz(t,[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}]),r=window.URL.createObjectURL(new Blob([JSON.stringify(e)],{type:"application/json"})),i=null==this.modelJsonAnchor?document.createElement("a"):this.modelJsonAnchor;if(i.download=this.modelJsonFileName,i.href=r,await Uj((()=>i.dispatchEvent(new MouseEvent("click")))),null!=t.weightData){const t=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor;t.download=this.weightDataFileName,t.href=n,await Uj((()=>t.dispatchEvent(new MouseEvent("click"))))}return{modelArtifactsInfo:Sz(t)}}}}Bj.URL_SCHEME="downloads://";class zj{constructor(t){if(null==t||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, "+"but received ".concat(t));this.jsonFile=t[0],this.weightsFiles=t.slice(1)}async load(){return new Promise(((t,e)=>{const n=new FileReader;n.onload=n=>{const r=JSON.parse(n.target.result),i=r.modelTopology;if(null==i)return void e(new Error("modelTopology field is missing from file ".concat(this.jsonFile.name)));if(null==r.weightsManifest)return void e(new Error("weightManifest field is missing from file ".concat(this.jsonFile.name)));if(0===this.weightsFiles.length)return void t({modelTopology:i});const o=wz(r,(t=>this.loadWeights(t)));t(o)},n.onerror=t=>e("Failed to read model topology and weights manifest JSON "+"from file '".concat(this.jsonFile.name,"'. BrowserFiles supports loading ")+"Keras-style tf.Model artifacts only."),n.readAsText(this.jsonFile)}))}loadWeights(t){const e=[],n=[];for(const o of t)e.push(...o.weights),n.push(...o.paths);const r=this.checkManifestAndWeightFiles(t),i=n.map((t=>this.loadWeightsFile(t,r[t])));return Promise.all(i).then((t=>[e,t]))}loadWeightsFile(t,e){return new Promise(((n,r)=>{const i=new FileReader;i.onload=t=>{const e=t.target.result;n(e)},i.onerror=e=>r("Failed to weights data from file of path '".concat(t,"'.")),i.readAsArrayBuffer(e)}))}checkManifestAndWeightFiles(t){const e=[],n=this.weightsFiles.map((t=>bz(t.name))),r={};for(const i of t)i.paths.forEach((t=>{const i=bz(t);if(-1!==e.indexOf(i))throw new Error("Duplicate file basename found in weights manifest: "+"'".concat(i,"'"));if(e.push(i),-1===n.indexOf(i))throw new Error("Weight file with basename '".concat(i,"' is not provided."));r[t]=this.weightsFiles[n.indexOf(i)]}));if(e.length!==this.weightsFiles.length)throw new Error("Mismatch in the number of files in weights manifest "+"(".concat(e.length,") and the number of weight files provided ")+"(".concat(this.weightsFiles.length,")."));return r}}function jj(t){return new zj(t)}function Vj(t,e,n,r){!function(t){aD(null!=t&&Array.isArray(t)&&t.length>0,(()=>"promises must be a none empty array"))}(t),function(t,e){aD(t>=0&&t<=1,(()=>"Progress fraction must be in range [0, 1], but "+"got startFraction ".concat(t))),aD(e>=0&&e<=1,(()=>"Progress fraction must be in range [0, 1], but "+"got endFraction ".concat(e))),aD(e>=t,(()=>"startFraction must be no more than endFraction, but "+"got startFraction ".concat(t," and endFraction ")+"".concat(e)))}(n=null==n?0:n,r=null==r?1:r);let i=0;return Promise.all(t.map((o=>(o.then((o=>{const a=n+ ++i/t.length*(r-n);return e(a),o})),o))))}async function Wj(t,e){null==e&&(e={});const n=null==e.fetchFunc?FD().platform.fetch:e.fetchFunc,r=t.map((t=>n(t,e.requestInit,{isBinary:!0}))),i=(null==e.onProgress?await Promise.all(r):await Vj(r,e.onProgress,0,.5)).map((t=>t.arrayBuffer()));return null==e.onProgress?await Promise.all(i):await Vj(i,e.onProgress,.5,1)}async function Gj(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return Hj((t=>Wj(t,{requestInit:r})))(t,e,n)}function Hj(t){return async function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2?arguments[2]:void 0;const i=e.map((()=>!1)),o={},a=null!=r?r.map((()=>!1)):[],s=[];if(e.forEach(((t,e)=>{let n=0;t.weights.forEach((t=>{const l="quantization"in t?t.quantization.dtype:t.dtype,c=ez[l]*cD(t.shape),u=()=>{i[e]=!0,null==o[e]&&(o[e]=[]),o[e].push({manifestEntry:t,groupOffset:n,sizeBytes:c})};null!=r?r.forEach(((e,n)=>{e===t.name&&(u(),a[n]=!0)})):u(),s.push(t.name),n+=c}))})),!a.every((t=>t))){const t=r.filter(((t,e)=>!a[e]));throw new Error("Could not find weights in manifest with names: "+"".concat(t.join(", "),". \n")+"Manifest JSON has weights with names: "+"".concat(s.join(", "),"."))}const l=i.reduce(((t,e,n)=>(e&&t.push(n),t)),[]),c=[];l.forEach((t=>{e[t].paths.forEach((t=>{const e=n+(n.endsWith("/")?"":"/")+t;c.push(e)}))}));const u=await t(c),h={};let d=0;return l.forEach((t=>{const n=e[t].paths.length,r=new nz(u.slice(d,d+n));o[t].forEach((t=>{const e=cz(r.slice(t.groupOffset,t.groupOffset+t.sizeBytes),[t.manifestEntry]);for(const n in e)h[n]=e[n]})),d+=n})),h}}Ez.registerSaveRouter((t=>FD().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Bj.URL_SCHEME)?function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"model";return new Bj(t)}(t.slice(Bj.URL_SCHEME.length)):null));class qj{constructor(t,e){if(this.DEFAULT_METHOD="POST",null==e&&(e={}),this.weightPathPrefix=e.weightPathPrefix,this.weightUrlConverter=e.weightUrlConverter,null!=e.fetchFunc?(aD("function"===typeof e.fetchFunc,(()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)")),this.fetch=e.fetchFunc):this.fetch=FD().platform.fetch,aD(null!=t&&t.length>0,(()=>"URL path for http must not be null, undefined or empty.")),Array.isArray(t)&&aD(2===t.length,(()=>"URL paths for http must have a length of 2, "+"(actual length is ".concat(t.length,")."))),this.path=t,null!=e.requestInit&&null!=e.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=e.requestInit||{},this.loadOptions=e}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const e=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);e.body=new FormData;const n=xz(t,[{paths:["./model.weights.bin"],weights:t.weightSpecs}]);if(e.body.append("model.json",new Blob([JSON.stringify(n)],{type:"application/json"}),"model.json"),null!=t.weightData){const n=nz.join(t.weightData);e.body.append("model.weights.bin",new Blob([n],{type:"application/octet-stream"}),"model.weights.bin")}const r=await this.fetch(this.path,e);if(r.ok)return{modelArtifactsInfo:Sz(t),responses:[r]};throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+"".concat(r.status,"."))}async loadModelJSON(){const t=await this.fetch(this.path,this.requestInit);if(!t.ok)throw new Error("Request to ".concat(this.path," failed with status code ")+"".concat(t.status,". Please verify this URL points to ")+"the model JSON of the model to load.");let e;try{e=await t.json()}catch($7){let e="Failed to parse model JSON of response from ".concat(this.path,".");throw this.path.endsWith(".pb")?e+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":e+=" Please make sure the server is serving valid JSON for this request.",new Error(e)}const n=e.modelTopology,r=e.weightsManifest;if(null==n&&null==r)throw new Error("The JSON from HTTP path ".concat(this.path," contains neither model ")+"topology or manifest for weights.");return e}async load(){if(this.loadOptions.streamWeights)return this.loadStream();return wz(await this.loadModelJSON(),(t=>this.loadWeights(t)))}async loadStream(){const t=await this.loadModelJSON(),e=await this.getWeightUrls(t.weightsManifest),n=Tz(t.weightsManifest);return Object.assign(Object.assign({},t),{weightSpecs:n,getWeightStream:()=>function(t,e){var n;const r=null==e.fetchFunc?FD().platform.fetch:e.fetchFunc;let i,o=0;return null===(n=e.onProgress)||void 0===n||n.call(e,0),new ReadableStream({pull:async n=>{for(var a;o<t.length;){if(!i){const n=(await r(t[o],e.requestInit,{isBinary:!0})).body;i=n.getReader()}const{done:s,value:l}=await i.read();if(!s)return void n.enqueue(l);o++,i=void 0,null===(a=e.onProgress)||void 0===a||a.call(e,o/t.length)}n.close()}})}(e,this.loadOptions)})}async getWeightUrls(t){const e=Array.isArray(this.path)?this.path[1]:this.path,[n,r]=function(t){const e=t.lastIndexOf("/"),n=t.lastIndexOf("?"),r=t.substring(0,e),i=n>e?t.substring(n):"";return[r+"/",i]}(e),i=this.weightPathPrefix||n,o=[],a=[];for(const s of t)for(const t of s.paths)null!=this.weightUrlConverter?a.push(this.weightUrlConverter(t)):o.push(i+t+r);return this.weightUrlConverter&&o.push(...await Promise.all(a)),o}async loadWeights(t){const e=await this.getWeightUrls(t);return[Tz(t),await Wj(e,this.loadOptions)]}}function Xj(t){return null!=t.match(qj.URL_SCHEME_REGEX)}qj.URL_SCHEME_REGEX=/^https?:\/\//;const Yj=(t,e)=>{if("undefined"===typeof fetch&&(null==e||null==e.fetchFunc))return null;{let n=!0;if(n=Array.isArray(t)?t.every((t=>Xj(t))):Xj(t),n)return Kj(t,e)}return null};function Kj(t,e){return new qj(t,e)}function Zj(t,e){return Kj(t,e)}Ez.registerSaveRouter(Yj),Ez.registerLoadRouter(Yj);class Jj{constructor(t){this.modelArtifacts=t}load(){return this.modelArtifacts}}class Qj{constructor(t){this.saveHandler=t}save(t){return this.saveHandler(t)}}class $j{constructor(t){t.load&&(this.load=()=>Promise.resolve(t.load())),t.save&&(this.save=e=>Promise.resolve(t.save(e)))}}function tV(t,e,n,r){return new $j(eV(...arguments))}function eV(t,e,n,r){if(1===arguments.length){return null!=t.modelTopology||null!=t.weightSpecs?new Jj(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Jj({modelTopology:t}))}return console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Jj({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:r})}function nV(t){return new Qj(t)}function rV(t){return new Qj(t)}function iV(t,e,n){if(lD(t),null!=e&&3!==e.length)throw new Error("tensor3d() requires shape to have three numbers");const r=HB(t,n);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return $B(t,e,r,n)}let oV,aV=!1;function sV(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==t)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,r=!1,i=!1,o=!1,a=!1,s=!1;if(t.data instanceof Uint8Array)n=!0;else if("undefined"!==typeof ImageData&&t instanceof ImageData)r=!0;else if("undefined"!==typeof HTMLVideoElement&&t instanceof HTMLVideoElement)i=!0;else if("undefined"!==typeof HTMLImageElement&&t instanceof HTMLImageElement)o=!0;else if(null!=t.getContext)a=!0;else{if(!("undefined"!==typeof ImageBitmap&&t instanceof ImageBitmap))throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, "+"but was ".concat(t.constructor.name));s=!0}if(null!=RU(wU,BB.backendName)){const n={pixels:t},r={numChannels:e};return BB.runKernel(wU,n,r)}const[l,c]=i?[t.videoWidth,t.videoHeight]:[t.width,t.height];let u,h;if(a)u=t.getContext("2d").getImageData(0,0,l,c).data;else if(r||n)u=t.data;else if(o||i||s){if(null==oV)if("undefined"===typeof document){if("undefined"===typeof OffscreenCanvas||"undefined"===typeof OffscreenCanvasRenderingContext2D)throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");oV=new OffscreenCanvas(1,1).getContext("2d")}else oV=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});oV.canvas.width=l,oV.canvas.height=c,oV.drawImage(t,0,0,l,c),u=oV.getImageData(0,0,l,c).data}if(4===e)h=new Int32Array(u);else{const t=l*c;h=new Int32Array(t*e);for(let n=0;n<t;n++)for(let t=0;t<e;++t)h[n*e+t]=u[4*n+t]}return iV(h,[c,l,e],"int32")}function lV(t){if(2!==t.rank&&3!==t.rank)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank ".concat(t.rank,"."));const e=2===t.rank?1:t.shape[2];if(e>4||2===e)throw new Error("toPixels only supports depth of size "+"1, 3 or 4 but got ".concat(e));if("float32"!==t.dtype&&"int32"!==t.dtype)throw new Error("Unsupported type for toPixels: ".concat(t.dtype,".")+" Please use float32 or int32 tensors.")}async function cV(t,e){let n=YB(t,"img","toPixels");if(!(t instanceof bB)){const t=n;n=uj(t,"int32"),t.dispose()}lV(n);const[r,i]=n.shape.slice(0,2),o=2===n.rank?1:n.shape[2],a=await n.data(),s="float32"===n.dtype?255:1,l=new Uint8ClampedArray(i*r*4);for(let c=0;c<r*i;++c){const t=[0,0,0,255];for(let r=0;r<o;r++){const e=a[c*o+r];if("float32"===n.dtype){if(e<0||e>1)throw new Error("Tensor values for a float32 Tensor must be in the "+"range [0 - 1] but encountered ".concat(e,"."))}else if("int32"===n.dtype&&(e<0||e>255))throw new Error("Tensor values for a int32 Tensor must be in the "+"range [0 - 255] but encountered ".concat(e,"."));1===o?(t[0]=e*s,t[1]=e*s,t[2]=e*s):t[r]=e*s}const e=4*c;l[e+0]=Math.round(t[0]),l[e+1]=Math.round(t[1]),l[e+2]=Math.round(t[2]),l[e+3]=Math.round(t[3])}if(null!=e){if(!aV){null!=RU(kL,BB.backendName)&&(console.warn("tf.browser.toPixels is not efficient to draw tensor on canvas. Please try tf.browser.draw instead."),aV=!0)}e.width=i,e.height=r;const t=e.getContext("2d"),n=new ImageData(l,i,r);t.putImageData(n,0,0)}return n!==t&&n.dispose(),l}const uV=JB({fromPixels_:sV}),hV=-2,dV=-1;function pV(t,e,n){const r=t.shape.length;aD(r===e.length,(()=>"Error in slice".concat(r,"D: Length of begin ").concat(e," must ")+"match the rank of the array (".concat(r,")."))),aD(r===n.length,(()=>"Error in slice".concat(r,"D: Length of size ").concat(n," must ")+"match the rank of the array (".concat(r,").")));for(let i=0;i<r;++i)aD(e[i]+n[i]<=t.shape[i],(()=>"Error in slice".concat(r,"D: begin[").concat(i,"] + size[").concat(i,"] ")+"(".concat(e[i]+n[i],") would overflow input.shape[").concat(i,"] (").concat(t.shape[i],")")))}function fV(t){const e=[];let n=0;for(;t>0;)1&t&&e.push(n),t/=2,n++;return e}function mV(t,e,n){const r=[];for(let i=0;i<t.length;i++)r[i]=Math.ceil((e[i]-t[i])/n[i]);return r}function gV(t,e,n,r){const i=[...t];for(let o=i.length;o<r.length;o++)i.push(1);for(let o=0;o<n;o++)0===o?i[e]=1:(i.splice(e,0,1),i.pop());return i}function yV(t,e,n){return n<=t?n:n-(e-1)}function vV(t,e){const n=[];for(let r=0;r<t;r++)n.push(e+r);return n}function bV(t,e,n,r,i,o,a,s,l){const c=t.length;let u=new Array(c),h=new Array(c),d=new Array(c);if(e.length&&n>0){const l=e[0],c=n+1;u=xV(a,l,c,r,t),h=_V(s,l,c,i,t),d=gV(o,l,c,t)}else for(let p=0;p<c;p++)u[p]=SV(a,r,o,t,p,l),h[p]=TV(s,i,o,t,p,l),d[p]=wV(o,p,l);return{begin:u,end:h,strides:d}}function xV(t,e,n,r,i){const o=[...i],a=vV(n,e);for(let s=0;s<o.length;s++)if(a.indexOf(s)>-1)o[s]=0;else{const i=yV(e,n,s);let a=r[i];t&1<<i&&(a=0),o[s]=a}return o}function _V(t,e,n,r,i){const o=[...i],a=vV(n,e);for(let s=0;s<o.length;s++)if(a.indexOf(s)>-1)o[s]=Number.MAX_SAFE_INTEGER;else{const i=yV(e,n,s);let a=r[i];t&1<<i&&(a=Number.MAX_SAFE_INTEGER),o[s]=a}for(let s=0;s<o.length;s++){const t=i[s];o[s]<0&&(o[s]+=t),o[s]=rD(0,o[s],i[s])}return o}function wV(t,e,n){let r=t[e];return(n&1<<e||null==r)&&(r=1),r}function SV(t,e,n,r,i,o){let a=e[i];const s=n[i]||1;(t&1<<i||o&1<<i||null==a)&&(a=s>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);const l=r[i];return a<0&&(a+=l),a=rD(0,a,l-1),a}function TV(t,e,n,r,i,o){let a=e[i];const s=n[i]||1;(t&1<<i||o&1<<i||null==a)&&(a=s>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);const l=r[i];return a<0&&(a+=l),a=s>0?rD(0,a,l):rD(-1,a,l-1),a}function EV(t,e,n){let r=n.length;for(let i=0;i<n.length;i++)if(n[i]>1){r=i;break}for(let i=r+1;i<n.length;i++)if(e[i]>0||n[i]!==t[i])return!1;return!0}function MV(t,e){let n=t.length>0?t[t.length-1]:1;for(let r=0;r<t.length-1;r++)n+=t[r]*e[r];return n}function CV(t,e,n){let r;const i=t.shape.length;let o;return r="number"===typeof e?[e,...new Array(i-1).fill(0)]:e.length<i?e.concat(new Array(i-e.length).fill(0)):e.slice(),r.forEach((t=>{aD(-1!==t,(()=>"slice() does not support negative begin indexing."))})),o=null==n?new Array(i).fill(-1):"number"===typeof n?[n,...new Array(i-1).fill(-1)]:n.length<i?n.concat(new Array(i-n.length).fill(-1)):n,o=o.map(((e,n)=>e>=0?e:(aD(-1===e,(()=>"Negative size values should be exactly -1 but got "+"".concat(e," for the slice() size at index ").concat(n,"."))),t.shape[n]-r[n]))),[r,o]}function AV(t,e,n,r,i,o,a,s,l){let c;if(null==r?(c=new Array(e.length),c.fill(1)):c=r,null!=a&&0!==(a&a-1))throw new Error("Multiple ellipses in slice is not allowed.");let u=!1;const h={dims:c.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:n.slice(),strides:c.slice(),beginMask:i,endMask:o,ellipsisMask:a,newAxisMask:s,shrinkAxisMask:l};for(let b=0;b<h.dims;b++)u&&0!==(1<<b&s)&&h.numAddAxisAfterEllipsis++,1<<b&a&&(u=!0);u||(h.ellipsisMask|=1<<h.dims,h.dims++);const d={dims:t.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};!function(t,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let n=0;e.beginValid=null!=t.begin,e.endValid=null!=t.end,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let r=0;r<t.dims;r++)if(1<<r&t.ellipsisMask){const i=Math.min(e.dims-(t.dims-r)+1+t.numAddAxisAfterEllipsis,e.dims);for(;n<i;n++)e.begin[n]=0,e.end[n]=0,e.strides[n]=1,e.beginMask|=1<<n,e.endMask|=1<<n,e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[n]=r}else if(1<<r&t.newAxisMask)e.finalShapeGatherIndices.push(hV),e.finalShapeGatherIndicesSparse.push(-1);else{if(n===e.begin.length)throw Error("Index out of range using input dim ".concat(n,"; input ")+"has only ".concat(e.dims," dims, ").concat(e.begin.length,"."));null!=t.begin&&(e.begin[n]=t.begin[r]),null!=t.end&&(e.end[n]=t.end[r]),e.strides[n]=t.strides[r],t.beginMask&1<<r&&(e.beginMask|=1<<n),t.endMask&1<<r&&(e.endMask|=1<<n),t.shrinkAxisMask&1<<r?(e.finalShapeGatherIndices.push(dV),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<n):(e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(r)),e.inputShapeGatherIndicesSparse[n]=r,n++}}(h,d);let p=!0,f=!0,m=!0;const g=[],y=[];for(let b=0;b<t.length;++b){if(0===d.strides[b])throw Error("strides[".concat(b,"] must be non-zero"));const e=!!(d.shrinkAxisMask&1<<b),n=t[b];if(-1===n){g.push(e?1:-1);continue}const r=[d.beginMask&1<<b,d.endMask&1<<b],i=[d.strides[b]>0?0:-1,d.strides[b]>0?n:n-1];if(e&&d.strides[b]<=0)throw Error("only stride 1 allowed on non-range indexing.");m=m&&1===d.strides[b];const o=!!(d.beginMask&1<<b&&d.endMask&1<<b);if(d.beginValid&&d.endValid){if(e){const t=d.begin[b]<0?n+d.begin[b]:d.begin[b];if(d.begin[b]=t,d.end[b]=d.begin[b]+1,t<0||t>=n)throw Error("slice index ".concat(d.begin[b]," of dimension ").concat(b," out of bounds."))}else d.begin[b]=kV(d.begin[b],0,d.strides[b],n,r,i),d.end[b]=kV(d.end[b],1,d.strides[b],n,r,i);const t=1===d.strides[b]&&0===d.begin[b]&&d.end[b]===n;p=p&&t,f=f&&(0===b&&1===d.strides[b]||t)}else p=p&&1===d.strides[b]&&o,f=f&&(0===b&&1===d.strides[b]||o);let a,s=!1;if(d.beginValid&&d.endValid?(a=d.end[b]-d.begin[b],s=!0):e?(a=1,s=!0):o&&n>=0&&(a=d.strides[b]<0?-n:n,s=!0),s){let t;t=0===a||a<0!==d.strides[b]<0?0:Math.trunc(a/d.strides[b])+(a%d.strides[b]!==0?1:0),g.push(t)}else g.push(-1)}for(let b=0;b<d.finalShapeGatherIndices.length;++b){const t=d.finalShapeGatherIndices[b];t>=0?y.push(g[t]):t===hV&&y.push(1)}const v=y.filter(((t,e)=>d.finalShapeGatherIndices[e]!==hV));return{finalShapeSparse:v,finalShape:y,isIdentity:p,sliceDim0:f,isSimpleSlice:m,begin:d.begin,end:d.end,strides:d.strides}}function kV(t,e,n,r,i,o){if(i[e])return n>0?o[e]:o[e+1&1];{const e=t<0?r+t:t;return e<o[0]?o[0]:e>o[1]?o[1]:e}}const IV=JB({acos_:function(t){const e={x:YB(t,"x","acos")};return BB.runKernel(WD,e)}});const RV=JB({acosh_:function(t){const e={x:YB(t,"x","acosh")};return BB.runKernel(GD,e)}});const PV=JB({addN_:function(t){aD(Array.isArray(t),(()=>"The argument passed to tf.addN() must be a list of tensors")),aD(t.length>=1,(()=>"Must pass at least one tensor to tf.addN(), but got "+"".concat(t.length)));const e=t.map(((t,e)=>YB(t,"tensors".concat(e),"addN"))),n=e[0];e.forEach((t=>{if(t.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),e.forEach((t=>{if(!uD(t.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}));const r=e;return BB.runKernel(qD,r)}});const NV=JB({all_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r={x:YB(t,"x","all","bool")},i={axis:e,keepDims:n};return BB.runKernel("All",r,i)}});const OV=JB({any_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r={x:YB(t,"x","any","bool")},i={axis:e,keepDims:n};return BB.runKernel("Any",r,i)}});const DV=JB({argMax_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n={x:YB(t,"x","argMax")},r={axis:e};return BB.runKernel(XD,n,r)}});const LV=JB({argMin_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n={x:YB(t,"x","argMin")},r={axis:e};return BB.runKernel(YD,n,r)}});const FV=JB({asin_:function(t){const e={x:YB(t,"x","asin")};return BB.runKernel(KD,e)}});const UV=JB({asinh_:function(t){const e={x:YB(t,"x","asinh")};return BB.runKernel(ZD,e)}});const BV=JB({atan_:function(t){const e={x:YB(t,"x","atan")};return BB.runKernel(JD,e)}});const zV=JB({atan2_:function(t,e){let n=YB(t,"a","atan2"),r=YB(e,"b","atan2");[n,r]=PB(n,r);const i={a:n,b:r};return BB.runKernel($D,i)}});const jV=JB({atanh_:function(t){const e={x:YB(t,"x","atanh")};return BB.runKernel(QD,e)}});function VV(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",o=arguments.length>5?arguments[5]:void 0;return HV(t,[...e,t[3]],n,o,r,null,null,eW(i))}function WV(t,e,n,r,i,o){let a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast";const[s,l]=YV(e);let c;if("channelsLast"===a)c=[s,l,t[3],t[3]];else{if("channelsFirst"!==a)throw new Error("Unknown dataFormat ".concat(a));c=[s,l,t[1],t[1]]}return HV(t,c,n,r,i,o,!1,a)}function GV(t,e,n,r,i,o){let a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NDHWC";const[s,l,c]=KV(e);let u,h;if("NDHWC"===a)h="channelsLast",u=[s,l,c,t[4],t[4]];else{if("NCDHW"!==a)throw new Error("Unknown dataFormat ".concat(a));h="channelsFirst",u=[s,l,c,t[1],t[1]]}return qV(t,u,n,r,i,!1,h,o)}function HV(t,e,n,r,i,o){let a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"channelsLast",[l,c,u,h]=[-1,-1,-1,-1];if("channelsLast"===s)[l,c,u,h]=t;else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat ".concat(s));[l,h,c,u]=t}const[d,p,,f]=e,[m,g]=YV(n),[y,v]=YV(r),b=ZV(d,y),x=ZV(p,v),{padInfo:_,outHeight:w,outWidth:S}=function(t,e,n,r,i,o,a,s,l){let c,u,h;if("number"===typeof t){c={top:t,bottom:t,left:t,right:t,type:0===t?"VALID":"NUMBER"};const i=function(t,e,n,r,i){null==r&&(r=XV(t,e,n));const o=t[0],a=t[1],s=JV((o-e+2*r)/n+1,i),l=JV((a-e+2*r)/n+1,i);return[s,l]}([e,n],o,r,t,s);u=i[0],h=i[1]}else if("same"===t){u=Math.ceil(e/r),h=Math.ceil(n/i);const t=Math.max(0,(u-1)*r+o-e),s=Math.max(0,(h-1)*i+a-n),l=Math.floor(t/2),d=t-l,p=Math.floor(s/2);c={top:l,bottom:d,left:p,right:s-p,type:"SAME"}}else if("valid"===t)c={top:0,bottom:0,left:0,right:0,type:"VALID"},u=Math.ceil((e-o+1)/r),h=Math.ceil((n-a+1)/i);else{if("object"!==typeof t)throw Error("Unknown padding parameter: ".concat(t));{const d="channelsLast"===l?t[1][0]:t[2][0],p="channelsLast"===l?t[1][1]:t[2][1],f="channelsLast"===l?t[2][0]:t[3][0],m="channelsLast"===l?t[2][1]:t[3][1];c={top:d,bottom:p,left:f,right:m,type:0===d&&0===p&&0===f&&0===m?"VALID":"EXPLICIT"},u=JV((e-o+d+p)/r+1,s),h=JV((n-a+f+m)/i+1,s)}}return{padInfo:c,outHeight:u,outWidth:h}}(i,c,u,m,g,b,x,o,s),T=a?f*h:f;let E;return"channelsFirst"===s?E=[l,T,w,S]:"channelsLast"===s&&(E=[l,w,S,T]),{batchSize:l,dataFormat:s,inHeight:c,inWidth:u,inChannels:h,outHeight:w,outWidth:S,outChannels:T,padInfo:_,strideHeight:m,strideWidth:g,filterHeight:d,filterWidth:p,effectiveFilterHeight:b,effectiveFilterWidth:x,dilationHeight:y,dilationWidth:v,inShape:t,outShape:E,filterShape:e}}function qV(t,e,n,r,i){let o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",s=arguments.length>7?arguments[7]:void 0,[l,c,u,h,d]=[-1,-1,-1,-1,-1];if("channelsLast"===a)[l,c,u,h,d]=t;else{if("channelsFirst"!==a)throw new Error("Unknown dataFormat ".concat(a));[l,d,c,u,h]=t}const[p,f,m,,g]=e,[y,v,b]=KV(n),[x,_,w]=KV(r),S=ZV(p,x),T=ZV(f,_),E=ZV(m,w),{padInfo:M,outDepth:C,outHeight:A,outWidth:k}=function(t,e,n,r,i,o,a,s,l,c,u){let h,d,p,f;"valid"===t&&(t=0);if("number"===typeof t){h={top:t,bottom:t,left:t,right:t,front:t,back:t,type:0===t?"VALID":"NUMBER"};const m=function(t,e,n,r,i,o){null==i&&(i=XV(t,e[0],r[0]));const a=[0,0,0,n];for(let s=0;s<3;s++)t[s]+2*i>=e[s]&&(a[s]=JV((t[s]-e[s]+2*i)/r[s]+1,o));return a}([e,n,r,1],[s,l,c],1,[i,o,a],t,u);d=m[0],p=m[1],f=m[2]}else{if("same"!==t)throw Error("Unknown padding parameter: ".concat(t));{d=Math.ceil(e/i),p=Math.ceil(n/o),f=Math.ceil(r/a);const t=(d-1)*i+s-e,u=(p-1)*o+l-n,m=(f-1)*a+c-r,g=Math.floor(t/2),y=t-g,v=Math.floor(u/2),b=u-v,x=Math.floor(m/2);h={top:v,bottom:b,left:x,right:m-x,front:g,back:y,type:"SAME"}}}return{padInfo:h,outDepth:d,outHeight:p,outWidth:f}}(i,c,u,h,y,v,b,S,T,E,s),I=o?g*d:g;let R;return"channelsFirst"===a?R=[l,I,C,A,k]:"channelsLast"===a&&(R=[l,C,A,k,I]),{batchSize:l,dataFormat:a,inDepth:c,inHeight:u,inWidth:h,inChannels:d,outDepth:C,outHeight:A,outWidth:k,outChannels:I,padInfo:M,strideDepth:y,strideHeight:v,strideWidth:b,filterDepth:p,filterHeight:f,filterWidth:m,effectiveFilterDepth:S,effectiveFilterHeight:T,effectiveFilterWidth:E,dilationDepth:x,dilationHeight:_,dilationWidth:w,inShape:t,outShape:R,filterShape:e}}function XV(t,e,n){const r=ZV(e,arguments.length>3&&void 0!==arguments[3]?arguments[3]:1);return Math.floor((t[0]*(n-1)-n+r)/2)}function YV(t){return"number"===typeof t?[t,t,t]:2===t.length?[t[0],t[1],1]:t}function KV(t){return"number"===typeof t?[t,t,t]:t}function ZV(t,e){return e<=1?t:t+(t-1)*(e-1)}function JV(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error("Unknown roundingMode ".concat(e))}}function QV(t){const[e,n,r]=YV(t);return 1===e&&1===n&&1===r}function $V(t,e){return QV(t)||QV(e)}function tW(t){return YV(t).every((t=>t>0))}function eW(t){if("NHWC"===t)return"channelsLast";if("NCHW"===t)return"channelsFirst";throw new Error("Unknown dataFormat ".concat(t))}function nW(t,e,n){if(null!=n){if("string"===typeof e)throw Error("Error in ".concat(t,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(e,"."));if("number"===typeof e)aD(hD(e),(()=>"Error in ".concat(t,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(e,".")));else{if("object"!==typeof e)throw Error("Error in ".concat(t,": Unknown padding parameter: ").concat(e));e.forEach((e=>{e.forEach((e=>{aD(hD(e),(()=>"Error in ".concat(t,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(e,".")))}))}))}}}const rW=JB({reshape_:function(t,e){const n={x:YB(t,"x","reshape","string_or_numeric")},r={shape:e};return BB.runKernel(NF,n,r)}});const iW=JB({avgPool_:function(t,e,n,r,i){const o=YB(t,"x","avgPool","float32");aD($V(n,1),(()=>"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'")));let a=o,s=!1;3===o.rank&&(s=!0,a=rW(o,[1,o.shape[0],o.shape[1],o.shape[2]])),aD(4===a.rank,(()=>"Error in avgPool: x must be rank 4 but got rank ".concat(a.rank,"."))),nW("avgPool",r,i);const l={x:a},c={filterSize:e,strides:n,pad:r,dimRoundingMode:i};let u=BB.runKernel(tL,l,c);return u=uj(u,o.dtype),s?rW(u,[u.shape[1],u.shape[2],u.shape[3]]):u}});const oW=JB({avgPool3d_:function(t,e,n,r,i){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC";const a=YB(t,"x","avgPool3d","float32");let s=a,l=!1;4===a.rank&&(l=!0,s=rW(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),aD(5===s.rank,(()=>"Error in avgPool3d: x must be rank 5 but got rank ".concat(s.rank,"."))),aD("NDHWC"===o,(()=>"Error in avgPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(o))),aD("number"===typeof n&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,(()=>"Error in avgPool3d: Stride must be > 0, but got '".concat(n,"'"))),nW("avgPool3d",r,i);const c={x:s},u={filterSize:e,strides:n,pad:r,dimRoundingMode:i,dataFormat:o};let h=BB.runKernel(eL,c,u);return h=uj(h,s.dtype),l?rW(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}});const aW=JB({concat_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;aD(t.length>=1,(()=>"Pass at least one tensor to concat"));const n=KB(t,"tensors","concat","string_or_numeric");if("complex64"===n[0].dtype&&n.forEach((t=>{if("complex64"!==t.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype ".concat(t.dtype,". "))})),1===n.length)return hj(n[0]);const r=n,i={axis:e};return BB.runKernel(dL,r,i)}});const sW=JB({matMul_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=YB(t,"a","matMul"),o=YB(e,"b","matMul");[i,o]=PB(i,o);const a={a:i,b:o},s={transposeA:n,transposeB:r};return BB.runKernel(nL,a,s)}});const lW=JB({sigmoid_:function(t){const e={x:YB(t,"x","sigmoid","float32")};return BB.runKernel(YF,e)}});const cW=JB({slice_:function(t,e,n){const r=YB(t,"x","slice","string_or_numeric");if(0===r.rank)throw new Error("Slicing scalar is not possible");const i={x:r},o={begin:e,size:n};return BB.runKernel(HF,i,o)}});const uW=JB({tanh_:function(t){const e={x:YB(t,"x","tanh","float32")};return BB.runKernel(dU,e)}});const hW=JB({basicLSTMCell_:function(t,e,n,r,i,o){const a=YB(t,"forgetBias","basicLSTMCell"),s=YB(e,"lstmKernel","basicLSTMCell"),l=YB(n,"lstmBias","basicLSTMCell"),c=YB(r,"data","basicLSTMCell"),u=YB(i,"c","basicLSTMCell"),h=YB(o,"h","basicLSTMCell"),d=aW([c,h],1),p=sW(d,s),f=pj(p,l),m=f.shape[0],g=f.shape[1]/4,y=[m,g],v=cW(f,[0,0],y),b=cW(f,[0,g],y),x=cW(f,[0,2*g],y),_=cW(f,[0,3*g],y),w=pj(gj(lW(v),uW(b)),gj(u,lW(pj(a,x))));return[w,gj(uW(w),lW(_))]}});const dW=JB({batchToSpaceND_:function(t,e,n){const r=YB(t,"x","batchToSpaceND"),i=e.reduce(((t,e)=>t*e));aD(r.rank>=1+e.length,(()=>"input rank is ".concat(r.rank," but should be > than blockShape.length ").concat(e.length))),aD(n.length===e.length,(()=>"crops.length is ".concat(n.length," but should be equal to blockShape.length  ").concat(e.length))),aD(r.shape[0]%i===0,(()=>"input tensor batch is ".concat(r.shape[0]," but is not divisible by the product of ")+"the elements of blockShape ".concat(e.join(" * ")," === ").concat(i)));const o={x:r},a={blockShape:e,crops:n};return BB.runKernel(rL,o,a)}});const pW=JB({batchNorm_:function(t,e,n,r,i,o){null==o&&(o=.001);const a=YB(t,"x","batchNorm"),s=YB(e,"mean","batchNorm"),l=YB(n,"variance","batchNorm");let c,u;null!=i&&(c=YB(i,"scale","batchNorm")),null!=r&&(u=YB(r,"offset","batchNorm")),aD(s.rank===l.rank,(()=>"Batch normalization gradient requires mean and variance to have equal ranks.")),aD(null==u||s.rank===u.rank,(()=>"Batch normalization gradient requires mean and offset to have equal ranks.")),aD(null==c||s.rank===c.rank,(()=>"Batch normalization gradient requires mean and scale to have equal ranks."));const h={x:function(t){let e;return e=0===t.rank||1===t.rank?rW(t,[1,1,1,t.size]):2===t.rank?rW(t,[1,1,t.shape[0],t.shape[1]]):3===t.rank?rW(t,[1,t.shape[0],t.shape[1],t.shape[2]]):t,e}(a),scale:c,offset:u,mean:s,variance:l},d={varianceEpsilon:o},p=BB.runKernel(zL,h,d);return rW(p,a.shape)}});const fW=JB({batchNorm2d_:function(t,e,n,r,i,o){const a=YB(t,"x","batchNorm"),s=YB(e,"mean","batchNorm"),l=YB(n,"variance","batchNorm");let c,u;return null!=i&&(c=YB(i,"scale","batchNorm")),null!=r&&(u=YB(r,"offset","batchNorm")),aD(2===a.rank,(()=>"Error in batchNorm2D: x must be rank 2 but got rank "+"".concat(a.rank,"."))),aD(2===s.rank||1===s.rank,(()=>"Error in batchNorm2D: mean must be rank 2 or rank 1 but "+"got rank ".concat(s.rank,"."))),aD(2===l.rank||1===l.rank,(()=>"Error in batchNorm2D: variance must be rank 2 or rank 1 "+"but got rank ".concat(l.rank,"."))),null!=c&&aD(2===c.rank||1===c.rank,(()=>"Error in batchNorm2D: scale must be rank 2 or rank 1 "+"but got rank ".concat(c.rank,"."))),null!=u&&aD(2===u.rank||1===u.rank,(()=>"Error in batchNorm2D: offset must be rank 2 or rank 1 "+"but got rank ".concat(u.rank,"."))),pW(a,s,l,u,c,o)}});const mW=JB({batchNorm3d_:function(t,e,n,r,i,o){const a=YB(t,"x","batchNorm"),s=YB(e,"mean","batchNorm"),l=YB(n,"variance","batchNorm");let c,u;return null!=i&&(c=YB(i,"scale","batchNorm")),null!=r&&(u=YB(r,"offset","batchNorm")),aD(3===a.rank,(()=>"Error in batchNorm3D: x must be rank 3 but got rank "+"".concat(a.rank,"."))),aD(3===s.rank||1===s.rank,(()=>"Error in batchNorm3D: mean must be rank 3 or rank 1 but "+"got rank ".concat(s.rank,"."))),aD(3===l.rank||1===l.rank,(()=>"Error in batchNorm3D: variance must be rank 3 or rank 1 "+"but got rank ".concat(l.rank,"."))),null!=c&&aD(3===c.rank||1===c.rank,(()=>"Error in batchNorm3D: scale must be rank 3 or rank 1 "+"but got rank ".concat(c.rank,"."))),null!=u&&aD(3===u.rank||1===u.rank,(()=>"Error in batchNorm3D: offset must be rank 3 or rank 1 "+"but got rank ".concat(u.rank,"."))),pW(a,s,l,u,c,o)}});const gW=JB({batchNorm4d_:function(t,e,n,r,i,o){const a=YB(t,"x","batchNorm"),s=YB(e,"mean","batchNorm"),l=YB(n,"variance","batchNorm");let c,u;return null!=i&&(c=YB(i,"scale","batchNorm")),null!=r&&(u=YB(r,"offset","batchNorm")),aD(4===a.rank,(()=>"Error in batchNorm4D: x must be rank 4 but got rank "+"".concat(a.rank,"."))),aD(4===s.rank||1===s.rank,(()=>"Error in batchNorm4D: mean must be rank 4 or rank 1 but "+"got rank ".concat(s.rank,"."))),aD(4===l.rank||1===l.rank,(()=>"Error in batchNorm4D: variance must be rank 4 or rank 1 "+"but got rank ".concat(l.rank,"."))),null!=c&&aD(4===c.rank||1===c.rank,(()=>"Error in batchNorm4D: scale must be rank 4 or rank 1 "+"but got rank ".concat(c.rank,"."))),null!=u&&aD(4===u.rank||1===u.rank,(()=>"Error in batchNorm4D: offset must be rank 4 or rank 1 "+"but got rank ".concat(u.rank,"."))),pW(a,s,l,u,c,o)}});const yW=JB({bincount_:function(t,e,n){const r=YB(t,"x","bincount"),i=YB(e,"weights","bincount");aD("int32"===r.dtype,(()=>"Error in bincount: input "+"dtype must be int32, but got ".concat(r.dtype))),aD(n>=0,(()=>"size must be non-negative, but got ".concat(n,"."))),aD(i.size===r.size||0===i.size,(()=>"Error in bincount: weights must have the same size as input or"+"0-length, but got input shape: ".concat(r.shape,", weights shape: ")+"".concat(i.shape,".")));const o={x:r,weights:i},a={size:n};return BB.runKernel(iL,o,a)}});const vW=JB({bitwiseAnd_:function(t,e){const n=YB(t,"x","bitwiseAnd"),r=YB(e,"y","bitwiseAnd");if(!uD(n.shape,r.shape))throw new Error("BitwiseAnd: Tensors must have the same shape. x: ".concat(n.shape,", y: ").concat(r.shape));if("int32"!==n.dtype||"int32"!==r.dtype)throw new Error("BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ".concat(n.dtype," and type of y: ").concat(r.dtype));const i={a:n,b:r};return BB.runKernel(oL,i)}});const bW=JB({broadcastArgs_:function(t,e){const n=YB(t,"s0","broadcastArgs","int32"),r=YB(e,"s1","broadcastArgs","int32");if(1!==n.rank)throw new Error("broadcastArgs(): first input must be a vector (rank=1). "+"Has rank ".concat(n.rank));if(1!==r.rank)throw new Error("broadcastArgs(): second input must be a vector (rank=1). "+"Has rank ".concat(r.rank));const i={s0:n,s1:r};return BB.runKernel(aL,i)}});const xW=JB({broadcastTo_:function(t,e){let n=YB(t,"broadcastTo","x");const r=n.shape;if(ID(e),e.length<n.rank)throw new Error("broadcastTo(): shape.length=".concat(e.length," < input.rank=").concat(n.rank,"."));if(e.length>n.rank){const t=n.shape.slice();for(;t.length<e.length;)t.unshift(1);n=rW(n,t)}const i=n.shape,o=Array.from(e);for(let c=e.length-1;c>=0;c--)if(i[c]===e[c])o[c]=1;else if(1!==n.shape[c])throw new Error("broadcastTo(): [".concat(r,"] cannot be broadcast to [").concat(e,"]."));const a=o.map(((t,e)=>t>1?e:-1)).filter((t=>t>=0));if(0===a.length)return hj(n);const s={x:n},l={reps:o};return BB.runKernel(pU,s,l)}});const _W=JB({ceil_:function(t){const e={x:YB(t,"x","ceil","float32")};return BB.runKernel(lL,e)}});const wW=JB({clipByValue_:function(t,e,n){const r=YB(t,"x","clipByValue");if(aD(e<=n,(()=>"Error in clip: min (".concat(e,") must be ")+"less than or equal to max (".concat(n,")."))),e===n)return Aj(r.shape,e,r.dtype);const i={x:r},o={clipValueMin:e,clipValueMax:n};return BB.runKernel(cL,i,o)}});const SW=JB({concat1d_:function(t){return aW(t,0)}});const TW=JB({concat2d_:function(t,e){return aW(t,e)}});const EW=JB({concat3d_:function(t,e){return aW(t,e)}});const MW=JB({concat4d_:function(t,e){return aW(t,e)}});const CW=JB({conv2d_:function(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],a=arguments.length>6?arguments[6]:void 0;const s=YB(t,"x","conv2d","float32"),l=YB(e,"filter","conv2d","float32");let c=s,u=!1;3===s.rank&&(u=!0,c=rW(s,[1,s.shape[0],s.shape[1],s.shape[2]])),aD(4===c.rank,(()=>"Error in conv2d: input must be rank 4, but got rank ".concat(c.rank,"."))),aD(4===l.rank,(()=>"Error in conv2d: filter must be rank 4, but got rank "+"".concat(l.rank,"."))),nW("conv2d",r,a);const h="NHWC"===i?c.shape[3]:c.shape[1];aD(h===l.shape[2],(()=>"Error in conv2d: depth of input (".concat(h,") must match ")+"input depth for filter ".concat(l.shape[2],"."))),aD($V(n,o),(()=>"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(o,"'"))),aD(tW(o),(()=>"Error in conv2D: Dilated rates should be larger than 0.")),aD(tW(n),(()=>"Error in conv2D: Strides should be larger than 0."));const d={x:c,filter:l},p={strides:n,pad:r,dataFormat:i,dilations:o,dimRoundingMode:a},f=BB.runKernel(pL,d,p);return u?rW(f,[f.shape[1],f.shape[2],f.shape[3]]):f}});const AW=JB({conv1d_:function(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NWC",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,a=arguments.length>6?arguments[6]:void 0;const s=YB(t,"x","conv1d"),l=YB(e,"filter","conv1d");let c=s,u=!1;2===s.rank&&(u=!0,c=rW(s,[1,s.shape[0],s.shape[1]])),aD(3===c.rank,(()=>"Error in conv1d: input must be rank 3, but got rank ".concat(c.rank,"."))),aD(3===l.rank,(()=>"Error in conv1d: filter must be rank 3, but got rank "+"".concat(l.rank,"."))),nW("conv1d",r,a),aD(c.shape[2]===l.shape[1],(()=>"Error in conv1d: depth of input (".concat(c.shape[2],") must match ")+"input depth for filter ".concat(l.shape[1],"."))),aD($V(n,o),(()=>"Error in conv1D: Either stride or dilation must be 1. "+"Got stride ".concat(n," and dilation '").concat(o,"'"))),aD(tW(o),(()=>"Error in conv1D: Dilated rates should be larger than 0.")),aD(tW(n),(()=>"Error in conv1D: Stride should be larger than 0.")),aD("NWC"===i,(()=>"Error in conv1d: got dataFormat of ".concat(i," but only NWC is currently supported.")));const h=rW(l,[1,l.shape[0],l.shape[1],l.shape[2]]),d=rW(c,[c.shape[0],1,c.shape[1],c.shape[2]]),p=CW(d,h,[1,n],r,"NHWC",[1,o],a);return rW(p,u?[p.shape[2],p.shape[3]]:[p.shape[0],p.shape[2],p.shape[3]])}});const kW=JB({conv2DBackpropInput_:function(t,e,n,r,i){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",a=arguments.length>6?arguments[6]:void 0;aD(t.length===e.rank,(()=>"Length of inShape "+"(".concat(t.length,") and rank of dy (").concat(e.rank,") must match")));let s=t,l=e,c=!1;3===e.rank&&(c=!0,l=rW(e,[1,e.shape[0],e.shape[1],e.shape[2]]),s=[1,t[0],t[1],t[2]]),aD(4===s.length,(()=>"Error in conv2dDerInput: inShape must be length 4, but got length "+"".concat(s.length,"."))),aD(4===l.rank,(()=>"Error in conv2dDerInput: dy must be rank 4, but got "+"rank ".concat(l.rank))),aD(4===n.rank,(()=>"Error in conv2dDerInput: filter must be rank 4, but got "+"rank ".concat(n.rank)));const u="NHWC"===o?s[3]:s[1],h="NHWC"===o?l.shape[3]:l.shape[1];aD(u===n.shape[2],(()=>"Error in conv2dDerInput: depth of input (".concat(u,") must ")+"match input depth for filter ".concat(n.shape[2],"."))),aD(h===n.shape[3],(()=>"Error in conv2dDerInput: depth of output (".concat(h,") must ")+"match output depth for filter ".concat(n.shape[3],"."))),nW("conv2dDerInput",i,a);const d={dy:l,filter:n},p={strides:r,pad:i,dataFormat:o,dimRoundingMode:a,inputShape:s},f=BB.runKernel(mL,d,p);return c?rW(f,[f.shape[1],f.shape[2],f.shape[3]]):f}});const IW=JB({conv2dTranspose_:function(t,e,n,r,i,o){const a=YB(t,"x","conv2dTranspose"),s=YB(e,"filter","conv2dTranspose");return kW(n,a,s,r,i,"NHWC",o)}});const RW=JB({conv3d_:function(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NDHWC",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1,1];const a=YB(t,"x","conv3d"),s=YB(e,"filter","conv3d");let l=a,c=!1;4===a.rank&&(c=!0,l=rW(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),aD(5===l.rank,(()=>"Error in conv3d: input must be rank 5, but got rank ".concat(l.rank,"."))),aD(5===s.rank,(()=>"Error in conv3d: filter must be rank 5, but got rank "+"".concat(s.rank,"."))),aD(l.shape[4]===s.shape[3],(()=>"Error in conv3d: depth of input (".concat(l.shape[4],") must match ")+"input depth for filter ".concat(s.shape[3],"."))),aD($V(n,o),(()=>"Error in conv3D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(o,"'"))),aD("NDHWC"===i,(()=>"Error in conv3d: got dataFormat of ".concat(i," but only NDHWC is currently supported."))),aD(tW(o),(()=>"Error in conv3D: Dilated rates should be larger than 0.")),aD(tW(n),(()=>"Error in conv3D: Strides should be larger than 0."));const u={x:l,filter:s},h={strides:n,pad:r,dataFormat:i,dilations:o},d=BB.runKernel(gL,u,h);return c?rW(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}});const PW=JB({conv3DBackpropInput_:function(t,e,n,r,i){aD(t.length===e.rank,(()=>"Length of inShape "+"(".concat(t.length,") and rank of dy (").concat(e.rank,") must match")));let o=t,a=e,s=!1;4===e.rank&&(s=!0,a=rW(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),o=[1,t[0],t[1],t[2],t[3]]);const l=o[4],c=a.shape[4];aD(5===o.length,(()=>"Error in conv3dDerInput: inShape must be length 5, but got length "+"".concat(o.length,"."))),aD(5===a.rank,(()=>"Error in conv3dDerInput: dy must be rank 5, but got "+"rank ".concat(a.rank))),aD(5===n.rank,(()=>"Error in conv3dDerInput: filter must be rank 5, but got "+"rank ".concat(n.rank))),aD(l===n.shape[3],(()=>"Error in conv3dDerInput: depth of input (".concat(l,") must ")+"match input depth for filter ".concat(n.shape[3],"."))),aD(c===n.shape[4],(()=>"Error in conv3dDerInput: depth of output (".concat(c,") must ")+"match output depth for filter ".concat(n.shape[4],".")));const u={dy:a,filter:n},h={pad:i,strides:r,inputShape:o},d=BB.runKernel(yL,u,h);return s?rW(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}});const NW=JB({conv3dTranspose_:function(t,e,n,r,i){const o=YB(t,"x","conv3dTranspose"),a=YB(e,"filter","conv3dTranspose");return PW(n,o,a,r,i)}});const OW=JB({cos_:function(t){const e={x:YB(t,"x","cos","float32")};return BB.runKernel("Cos",e)}});const DW=JB({cosh_:function(t){const e={x:YB(t,"x","cosh","float32")};return BB.runKernel(vL,e)}});const LW=JB({cumprod_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i={x:YB(t,"x","cumprod")},o={axis:e,exclusive:n,reverse:r};return BB.runKernel(bL,i,o)}});const FW=JB({cumsum_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i={x:YB(t,"x","cumsum")},o={axis:e,exclusive:n,reverse:r};return BB.runKernel(xL,i,o)}});const UW=JB({denseBincount_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=YB(t,"x","denseBincount"),o=YB(e,"weights","denseBincount");aD("int32"===i.dtype,(()=>"Error in denseBincount: input "+"dtype must be int32, but got ".concat(i.dtype))),aD(i.rank<=2,(()=>"Error in denseBincount: input must be at most rank 2, but got "+"rank ".concat(i.rank,"."))),aD(n>=0,(()=>"size must be non-negative, but got ".concat(n,"."))),aD(o.size===i.size||0===o.size,(()=>"Error in denseBincount: weights must have the same shape as x or "+"0-length, but got x shape: ".concat(i.shape,", weights shape: ")+"".concat(o.shape,".")));const a={x:i,weights:o},s={size:n,binaryOutput:r};return BB.runKernel(wL,a,s)}});const BW=JB({depthToSpace_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"NHWC";const r=YB(t,"x","depthToSpace","float32"),i="NHWC"===n?r.shape[1]:r.shape[2],o="NHWC"===n?r.shape[2]:r.shape[3],a="NHWC"===n?r.shape[3]:r.shape[1];aD(e>1,(()=>"blockSize should be > 1 for depthToSpace, but was: ".concat(e))),aD(i*e>=0,(()=>"Negative dimension size caused by overflow when multiplying\n    ".concat(i," and ").concat(e,"  for depthToSpace with input shape\n    ").concat(r.shape))),aD(o*e>=0,(()=>"Negative dimension size caused by overflow when multiplying\n    ".concat(o," and ").concat(e," for depthToSpace with input shape\n        ").concat(r.shape))),aD(a%(e*e)===0,(()=>"Dimension size must be evenly divisible by ".concat(e*e," but is ").concat(a," for depthToSpace with input shape ").concat(r.shape)));const s={x:r},l={blockSize:e,dataFormat:n};return BB.runKernel(SL,s,l)}});const zW=JB({depthwiseConv2d_:function(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],a=arguments.length>6?arguments[6]:void 0;const s=YB(t,"x","depthwiseConv2d","float32"),l=YB(e,"filter","depthwiseConv2d","float32");let c=s,u=!1;3===s.rank&&(u=!0,c=rW(s,[1,s.shape[0],s.shape[1],s.shape[2]])),aD(4===c.rank,(()=>"Error in depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(c.rank,"."))),aD(4===l.rank,(()=>"Error in depthwiseConv2d: filter must be rank 4, but got rank "+"".concat(l.rank,".")));const h="NHWC"===i?c.shape[3]:c.shape[1];aD(h===l.shape[2],(()=>"Error in depthwiseConv2d: number of input channels "+"(".concat(h,") must match the inChannels dimension in ")+"filter ".concat(l.shape[2],"."))),nW("depthwiseConv2d",r,a);const d={x:c,filter:l},p={strides:n,pad:r,dataFormat:i,dilations:o,dimRoundingMode:a},f=BB.runKernel(TL,d,p);return u?rW(f,[f.shape[1],f.shape[2],f.shape[3]]):f}});const jW=JB({diag_:function(t){const e={x:YB(t,"x","diag")};return BB.runKernel(CL,e)}});const VW=JB({dilation2d_:function(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[1,1],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC";const a=YB(t,"x","dilation2d"),s=YB(e,"filter","dilation2d");aD(3===a.rank||4===a.rank,(()=>"Error in dilation2d: input must be rank 3 or 4, but got rank "+"".concat(a.rank,"."))),aD(3===s.rank,(()=>"Error in dilation2d: filter must be rank 3, but got rank "+"".concat(s.rank,"."))),aD("NHWC"===o,(()=>"Error in dilation2d: Only NHWC is currently supported, "+"but got dataFormat of ".concat(o)));let l=a,c=!1;3===a.rank&&(l=rW(a,[1,a.shape[0],a.shape[1],a.shape[2]]),c=!0),aD(l.shape[3]===s.shape[2],(()=>"Error in dilation2d:  input and filter must have the same depth: ".concat(l.shape[3]," vs ").concat(s.shape[2])));const u={x:l,filter:s},h={strides:n,pad:r,dilations:i},d=BB.runKernel(AL,u,h);return c?rW(d,[d.shape[1],d.shape[2],d.shape[3]]):d}});const WW=JB({equal_:function(t,e){let n=YB(t,"a","equal","string_or_numeric"),r=YB(e,"b","equal","string_or_numeric");[n,r]=PB(n,r),Oj(n.shape,r.shape);const i={a:n,b:r};return BB.runKernel(PL,i)}});const GW=JB({where_:function(t,e,n){const r=YB(e,"a","where"),i=YB(n,"b","where"),o=YB(t,"condition","where","bool"),a=Oj(Oj(o.shape,r.shape),i.shape),s={condition:xW(o,a),t:xW(r,a),e:xW(i,a)};return BB.runKernel(WF,s)}});const HW=JB({divNoNan_:function(t,e){let n=YB(t,"a","div"),r=YB(e,"b","div");[n,r]=PB(n,r);const i=mj(n,r),o=bj(i),a=WW(r,o);return GW(a,o,i)}});const qW=JB({dot_:function(t,e){const n=YB(t,"t1","dot"),r=YB(e,"t2","dot");aD((1===n.rank||2===n.rank)&&(1===r.rank||2===r.rank),(()=>"Error in dot: inputs must all be rank 1 or 2, but got ranks "+"".concat(n.rank," and ").concat(r.rank,".")));const i=1===n.rank?n.size:n.shape[1],o=1===r.rank?r.size:r.shape[0];if(aD(i===o,(()=>"Error in dot: inner dimensions of inputs must match, but got "+"".concat(i," and ").concat(o,"."))),1===n.rank&&1===r.rank){const t=rW(n,[1,-1]),e=rW(r,[-1,1]),i=sW(t,e);return rW(i,[])}if(1===n.rank&&2===r.rank){const t=rW(n,[1,-1]),e=rW(r,[r.shape[0],r.shape[1]]),i=sW(t,e);return rW(i,[i.size])}if(2===n.rank&&1===r.rank){const t=rW(r,[-1,1]),e=sW(n,t);return rW(e,[e.size])}{const t=rW(r,[r.shape[0],r.shape[1]]);return sW(n,t)}}});const XW=JB({einsum_:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];const i=n.map(((t,e)=>YB(t,"tensors".concat(e),"einsum"))),o={equation:t};return BB.runKernel(RL,i,o)}});const YW=JB({elu_:function(t){const e={x:YB(t,"x","elu","float32")};return BB.runKernel("Elu",e)}});const KW=JB({ensureShape_:function(t,e){const n=YB(t,"x","ensureShape","string_or_numeric");if(!function(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(null!==t[n]&&null!==e[n]&&t[n]!==e[n])return!1;return!0}(n.shape,e))throw new Error("EnsureShape: Shape of tensor ".concat(n.shape," is not compatible with expected shape ").concat(e));return t}});const ZW=JB({erf_:function(t){let e=YB(t,"x","erf");aD("int32"===e.dtype||"float32"===e.dtype,(()=>"Input dtype must be `int32` or `float32`.")),"int32"===e.dtype&&(e=uj(e,"float32"));const n={x:e};return BB.runKernel("Erf",n)}});function JW(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function QW(t,e,n){const r=t.length+e.length,i=[];let o=0,a=0;for(let s=0;s<r;s++)-1===n.indexOf(s)?i.push(t[o++]):i.push(e[a++]);return i}function $W(t,e){const n=[],r=t.length;for(let i=0;i<r;i++)-1===e.indexOf(i)&&n.push(t[i]);return[n,e.map((e=>t[e]))]}function tG(t,e){return QW(t,e.map((t=>1)),e)}function eG(t,e,n){aD(JW(e,n),(()=>"".concat(t," supports only inner-most axes for now. ")+"Got axes ".concat(e," and rank-").concat(n," input.")))}function nG(t,e){if(JW(t,e))return null;const n=[];for(let r=0;r<e;++r)-1===t.indexOf(r)&&n.push(r);return t.forEach((t=>n.push(t))),n}function rG(t){return t.map(((t,e)=>[e,t])).sort(((t,e)=>t[1]-e[1])).map((t=>t[0]))}function iG(t,e){const n=[];for(let r=e-t;r<e;++r)n.push(r);return n}const oG=JB({max_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r={x:YB(t,"x","max")},i={reductionIndices:e,keepDims:n};return BB.runKernel("Max",r,i)}});const aG=JB({min_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r={x:YB(t,"x","min")},i={axis:e,keepDims:n};return BB.runKernel("Min",r,i)}});const sG=JB({sum_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=YB(t,"x","sum");"bool"===r.dtype&&(r=uj(r,"int32"));const i={x:r},o={axis:e,keepDims:n};return BB.runKernel("Sum",i,o)}});function lG(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(0===t.rank)return Rj(t);if(1!==t.rank&&null===n)return lG(rW(t,[-1]),e,n);if(1===t.rank||"number"===typeof n||Array.isArray(n)&&1===n.length){if(1===e)return sG(Rj(t),n);if(e===1/0)return oG(Rj(t),n);if(e===-1/0)return aG(Rj(t),n);if("euclidean"===e||2===e)return yj(sG(kj(Rj(t),_j(2,"int32")),n));throw new Error("Error in norm: invalid ord value: ".concat(e))}if(Array.isArray(n)&&2===n.length){if(1===e)return oG(sG(Rj(t),n[0]),n[1]-1);if(e===1/0)return oG(sG(Rj(t),n[1]),n[0]);if(e===-1/0)return aG(sG(Rj(t),n[1]),n[0]);if("fro"===e||"euclidean"===e)return yj(sG(vj(t),n));throw new Error("Error in norm: invalid ord value: ".concat(e))}throw new Error("Error in norm: invalid axis: ".concat(n))}const cG=JB({norm_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"euclidean",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=lG(t=YB(t,"x","norm"),e,n);let o=i.shape;if(r){const e=mD(n,t.shape);o=tG(i.shape,e)}return rW(i,o)}});const uG=JB({euclideanNorm_:function(t){return cG(t,"euclidean",arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]&&arguments[2])}});const hG=JB({exp_:function(t){const e={x:YB(t,"x","exp")};return BB.runKernel(NL,e)}});const dG=JB({expandDims_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=YB(t,"x","expandDims","string_or_numeric");aD(e<=n.rank,(()=>"Axis must be <= rank of the tensor"));const r={input:n},i={dim:e};return BB.runKernel(OL,r,i)}});const pG=JB({expm1_:function(t){const e={x:YB(t,"x","expm1")};return BB.runKernel(DL,e)}});const fG=JB({tile_:function(t,e){const n=YB(t,"x","tile","string_or_numeric");aD(n.rank===e.length,(()=>"Error in transpose: rank of input ".concat(n.rank," ")+"must match length of reps ".concat(e,".")));const r={x:n},i={reps:e};return BB.runKernel(pU,r,i)}});const mG=JB({eye_:function(t,e,n){null==e&&(e=t);const r=cj([t,e],arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32"),i=t<=e?t:e;for(let a=0;a<i;++a)r.set(1,a,a);const o=rW(r.toTensor(),[t,e]);if(null==n)return o;if(1===n.length)return fG(dG(o,0),[n[0],1,1]);if(2===n.length)return fG(dG(dG(o,0),0),[n[0],n[1],1,1]);if(3===n.length)return fG(dG(dG(dG(o,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D "+"batchShapes, but received ".concat(n.length,"D."))}});const gG=JB({floor_:function(t){const e={x:YB(t,"x","floor","float32")};return BB.runKernel(UL,e)}});const yG=JB({gather_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const i={x:YB(t,"x","gather"),indices:YB(e,"indices","gather","int32")},o={axis:n,batchDims:r};return BB.runKernel(jL,i,o)}});const vG=JB({greater_:function(t,e){let n=YB(t,"a","greater","string_or_numeric"),r=YB(e,"b","greater","string_or_numeric");[n,r]=PB(n,r),Oj(n.shape,r.shape);const i={a:n,b:r};return BB.runKernel(WL,i)}});const bG=JB({greaterEqual_:function(t,e){let n=YB(t,"a","greaterEqual","string_or_numeric"),r=YB(e,"b","greaterEqual","string_or_numeric");[n,r]=PB(n,r),Oj(n.shape,r.shape);const i={a:n,b:r};return BB.runKernel(GL,i)}});const xG=JB({imag_:function(t){const e={input:YB(t,"input","imag")};return BB.runKernel(XL,e)}});const _G=JB({isFinite_:function(t){const e={x:YB(t,"x","isFinite")};return BB.runKernel(YL,e)}});const wG=JB({isInf_:function(t){const e={x:YB(t,"x","isInf")};return BB.runKernel(KL,e)}});const SG=JB({isNaN_:function(t){const e={x:YB(t,"x","isNaN")};return BB.runKernel(ZL,e)}});const TG=JB({leakyRelu_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2;const n={x:YB(t,"x","leakyRelu")},r={alpha:e};return BB.runKernel(JL,n,r)}});const EG=JB({less_:function(t,e){let n=YB(t,"a","less","string_or_numeric"),r=YB(e,"b","less","string_or_numeric");[n,r]=PB(n,r),Oj(n.shape,r.shape);const i={a:n,b:r};return BB.runKernel(QL,i)}});const MG=JB({lessEqual_:function(t,e){let n=YB(t,"a","lessEqual","string_or_numeric"),r=YB(e,"b","lessEqual","string_or_numeric");[n,r]=PB(n,r),Oj(n.shape,r.shape);const i={a:n,b:r};return BB.runKernel($L,i)}});function CG(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");const r={start:t,stop:e,num:n};return BB.runKernel(tF,{},r)}const AG=JB({localResponseNormalization_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5;const o=YB(t,"x","localResponseNormalization");aD(4===o.rank||3===o.rank,(()=>"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ".concat(o.rank,"."))),aD(hD(e),(()=>"Error in localResponseNormalization: depthRadius must be an "+"integer but got depthRadius ".concat(e,".")));let a=o,s=!1;3===o.rank&&(s=!0,a=rW(o,[1,o.shape[0],o.shape[1],o.shape[2]]));const l={x:a},c={depthRadius:e,bias:n,alpha:r,beta:i},u=BB.runKernel("LRN",l,c);return s?rW(u,[u.shape[1],u.shape[2],u.shape[3]]):u}});const kG=JB({log_:function(t){const e={x:YB(t,"x","log","float32")};return BB.runKernel(eF,e)}});const IG=JB({log1p_:function(t){const e={x:YB(t,"x","log1p")};return BB.runKernel(nF,e)}});const RG=JB({neg_:function(t){const e={x:YB(t,"x","neg")};return BB.runKernel(mF,e)}});const PG=JB({softplus_:function(t){const e={x:YB(t,"x","softplus")};return BB.runKernel(KF,e)}});const NG=JB({logSigmoid_:function(t){const e=YB(t,"x","logSigmoid");return xj((t=>({value:RG(PG(RG(t))),gradFunc:e=>gj(e,lW(RG(t)))})))(e)}});const OG=JB({logSoftmax_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const n=YB(t,"logits","logSoftmax");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and axis was ").concat(e));const r=xj(((t,n)=>{const r=oG(t,e,!0),i=Ij(t,r),o=Ij(uj(i,"float32"),kG(sG(hG(i),e,!0)));n([o]);return{value:o,gradFunc:(t,n)=>{const[r]=n,i=hG(r);return Ij(t,gj(sG(t,e,!0),i))}}}));return r(n)}});const DG=JB({logSumExp_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=YB(t,"x","logSumExp"),i=mD(e,r.shape),o=oG(r,i,!0),a=Ij(r,o),s=hG(a),l=sG(s,i),c=kG(l),u=pj(rW(o,c.shape),c);if(n){const t=tG(u.shape,i);return rW(u,t)}return u}});const LG=JB({logicalAnd_:function(t,e){const n=YB(t,"a","logicalAnd","bool"),r=YB(e,"b","logicalAnd","bool");Oj(n.shape,r.shape);const i={a:n,b:r};return BB.runKernel(rF,i)}});const FG=JB({logicalNot_:function(t){const e={x:YB(t,"x","logicalNot","bool")};return BB.runKernel(iF,e)}});const UG=JB({logicalOr_:function(t,e){const n=YB(t,"a","logicalOr","bool"),r=YB(e,"b","logicalOr","bool");Oj(n.shape,r.shape);const i={a:n,b:r};return BB.runKernel(oF,i)}});const BG=JB({logicalXor_:function(t,e){const n=YB(t,"a","logicalXor","bool"),r=YB(e,"b","logicalXor","bool");return Oj(n.shape,r.shape),LG(UG(t,e),FG(LG(t,e)))}}),zG=2147483648;const jG=JB({searchSorted_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"left";const r=YB(t,"sortedSequence","searchSorted"),i=YB(e,"values","searchSorted"),o=r.shape[r.shape.length-1],a=i.shape[i.shape.length-1],s=rW(r,[-1,o]),l=rW(i,[-1,a]);if(s.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(s.shape[0]!==l.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(cD(l.shape)>=zG)throw new Error("values tensor size must less than ".concat(zG));if(s.shape[1]>=zG)throw new Error("trailing dim_size must less than ".concat(zG," for int32 output type, was ").concat(s.shape[1]));const c={sortedSequence:s,values:l},u={side:n};return BB.runKernel(VF,c,u)}});function VG(t,e){return jG(t,e,"left")}const WG=JB({maxPool_:function(t,e,n,r,i){const o=YB(t,"x","maxPool");let a=o,s=!1;3===o.rank&&(s=!0,a=rW(o,[1,o.shape[0],o.shape[1],o.shape[2]])),aD(4===a.rank,(()=>"Error in maxPool: input must be rank 4 but got rank ".concat(a.rank,"."))),aD($V(n,1),(()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'"))),nW("maxPool",r,i);const l={x:a},c={filterSize:e,strides:n,pad:r,dimRoundingMode:i},u=BB.runKernel(sF,l,c);return s?rW(u,[u.shape[1],u.shape[2],u.shape[3]]):u}});const GG=JB({maxPool3d_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1,1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC";const a=YB(t,"x","maxPool3d");let s=a,l=!1;4===a.rank&&(l=!0,s=rW(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),aD(5===s.rank,(()=>"Error in maxPool3d: x must be rank 5 but got rank ".concat(s.rank,"."))),aD("NDHWC"===o,(()=>"Error in maxPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(o))),nW("maxPool3d",r,i);const c={x:s},u={filterSize:e,strides:n,pad:r,dimRoundingMode:i,dataFormat:o},h=BB.runKernel(lF,c,u);return l?rW(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}});const HG=JB({maxPoolWithArgmax_:function(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const o={x:YB(t,"x","maxPoolWithArgmax")},a={filterSize:e,strides:n,pad:r,includeBatchInIndex:i},s=BB.runKernel(cF,o,a);return{result:s[0],indexes:s[1]}}});const qG=JB({mean_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r={x:YB(t,"x","mean")},i={axis:e,keepDims:n};return BB.runKernel(uF,r,i)}});function XG(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if(ID(t),"complex64"===e){const e=XG(t,"float32"),n=XG(t,"float32");return QB(e,n)}const n=kD(cD(t),e);return BB.makeTensor(n,t,e)}function YG(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if(ID(t),"complex64"===e){const e=YG(t,"float32"),n=XG(t,"float32");return QB(e,n)}const n=AD(cD(t),e);return BB.makeTensor(n,t,e)}function KG(t,e){let{indexing:n="xy"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("xy"!==n&&"ij"!==n)throw new TypeError("".concat(n," is not a valid third argument to meshgrid"));if(void 0===t)return[];let r=YB(t,"x","meshgrid",t instanceof bB?t.dtype:"float32");if(void 0===e)return[r];let i=YB(e,"y","meshgrid",e instanceof bB?e.dtype:"float32");const o=cD(r.shape),a=cD(i.shape);return"xy"===n?(r=rW(r,[1,-1]),i=rW(i,[-1,1]),[sW(YG([a,1],r.dtype),r),sW(i,YG([1,o],i.dtype))]):(r=rW(r,[-1,1]),i=rW(i,[1,-1]),[sW(r,YG([1,a],r.dtype)),sW(YG([o,1],i.dtype),i)])}const ZG=JB({minimum_:function(t,e){let n=YB(t,"a","minimum"),r=YB(e,"b","minimum");[n,r]=PB(n,r),"bool"===n.dtype&&(n=uj(n,"int32"),r=uj(r,"int32")),Oj(n.shape,r.shape);const i={a:n,b:r};return BB.runKernel(hF,i)}});const JG=JB({mirrorPad_:function(t,e,n){aD("reflect"===n||"symmetric"===n,(()=>"Invalid mode. Mode must be either reflect or symmetric. "+"Got ".concat(n,".")));const r=YB(t,"x","mirrorPad");if(0===r.rank)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");aD(e.length===r.rank,(()=>"Padding doesn't match input. Must be ".concat(r.rank,". ")+"Got ".concat(e.length,".")));const i="reflect"===n?1:0;for(let s=0;s<r.rank;s++)aD(2===e[s].length,(()=>"Invalid number of paddings. Must be length of 2 each.")),aD(e[s][0]>=0&&e[s][0]<=r.shape[s]-i&&e[s][1]>=0&&e[s][1]<=r.shape[s]-i,(()=>"Padding in dimension ".concat(s," cannot be greater than or equal ")+"to ".concat(r.shape[s]-i," or less than 0 for input of ")+"shape ".concat(r.shape)));const o={paddings:e,mode:n},a={x:r};return BB.runKernel(dF,a,o)}});const QG=JB({mod_:function(t,e){let n=YB(t,"a","mod"),r=YB(e,"b","mod");[n,r]=PB(n,r);const i={a:n,b:r};return BB.runKernel("Mod",i)}});const $G=JB({moments_:function(t){let e=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=mD(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,(t=YB(t,"x","moments")).shape),r=qG(t,n,e);let i=r.shape;e||(i=tG(r.shape,n));const o=vj(Ij(uj(t,"float32"),rW(r,i)));return{mean:r,variance:qG(o,n,e)}}});const tH=JB({multiRNNCell_:function(t,e,n,r){const i=YB(e,"data","multiRNNCell"),o=KB(n,"c","multiRNNCell"),a=KB(r,"h","multiRNNCell");let s=i;const l=[];for(let h=0;h<t.length;h++){const e=t[h](s,o[h],a[h]);l.push(e[0]),l.push(e[1]),s=e[1]}const c=[],u=[];for(let h=0;h<l.length;h+=2)c.push(l[h]),u.push(l[h+1]);return[c,u]}});const eH=JB({multinomial_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=YB(t,"logits","multinomial"),o=i.size,a=i.rank;if(o<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+"".concat(o,"."));if(a>2)throw new Error("Rank of probabilities must be 1 or 2, but is ".concat(a));n=n||Math.random();const s={logits:1===a?rW(i,[1,-1]):i},l={numSamples:e,seed:n,normalized:r},c=BB.runKernel(pF,s,l);return 1===a?rW(c,[c.size]):c}});const nH=JB({notEqual_:function(t,e){let n=YB(t,"a","notEqual","string_or_numeric"),r=YB(e,"b","notEqual","string_or_numeric");[n,r]=PB(n,r),Oj(n.shape,r.shape);const i={a:n,b:r};return BB.runKernel(gF,i)}});const rH=JB({oneHot_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"int32";if(e<2)throw new Error("Error in oneHot: depth must be >=2, but it is ".concat(e));const o={indices:YB(t,"indices","oneHot","int32")},a={dtype:i,depth:e,onValue:n,offValue:r};return BB.runKernel(_F,o,a)}});const iH=JB({onesLike_:function(t){const e={x:YB(t,"x","onesLike")};return BB.runKernel(xF,e)}});const oH=JB({outerProduct_:function(t,e){const n=YB(t,"v1","outerProduct"),r=YB(e,"v2","outerProduct");aD(1===n.rank&&1===r.rank,(()=>"Error in outerProduct: inputs must be rank 1, but got ranks "+"".concat(n.rank," and ").concat(r.rank,".")));const i=rW(n,[-1,1]),o=rW(r,[1,-1]);return sW(i,o)}});const aH=JB({pad_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=YB(t,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const i={paddings:e,constantValue:n},o={x:r};return BB.runKernel(SF,o,i)}});const sH=JB({pad1d_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return aD(2===e.length,(()=>"Invalid number of paddings. Must be length of 2.")),aH(t,[e],n)}});const lH=JB({pad2d_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return aD(2===e.length&&2===e[0].length&&2===e[1].length,(()=>"Invalid number of paddings. Must be length of 2 each.")),aH(t,e,n)}});const cH=JB({pad3d_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return aD(3===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length,(()=>"Invalid number of paddings. Must be length of 2 each.")),aH(t,e,n)}});const uH=JB({pad4d_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return aD(4===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length&&2===e[3].length,(()=>"Invalid number of paddings. Must be length of 2 each.")),aH(t,e,n)}});const hH=JB({spaceToBatchND_:function(t,e,n){const r=YB(t,"x","spaceToBatchND");aD(r.rank>=1+e.length,(()=>"input rank ".concat(r.rank," should be > than [blockShape] ").concat(e.length))),aD(n.length===e.length,(()=>"paddings.shape[0] ".concat(n.length," must be equal to [blockShape] ").concat(e.length))),aD(r.shape.reduce(((t,r,i)=>i>0&&i<=e.length?t&&(r+n[i-1][0]+n[i-1][1])%e[i-1]===0:t),!0),(()=>"input spatial dimensions ".concat(r.shape.slice(1)," with paddings ").concat(n.toString()," must be divisible by blockShapes ").concat(e.toString())));const i={x:r},o={blockShape:e,paddings:n};return BB.runKernel(JF,i,o)}});const dH=JB({pool_:function(t,e,n,r,i,o,a){null==i&&(i=[1,1]),null==o&&(o=1),0===r&&(r="valid");const s=YB(t,"x","maxPool");let l=s,c=!1;3===s.rank&&(c=!0,l=rW(s,[1,s.shape[0],s.shape[1],s.shape[2]])),aD($V(o,i),(()=>"Error in pool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(i,"'")));const u=WV(l.shape,e,o,i,r),h=[u.dilationHeight,u.dilationWidth];let d;d="same"===r?function(t,e){const n=t.map(((t,n)=>t+(t-1)*(e[n]-1))),r=n.map((t=>t-1)),i=r.map((t=>Math.floor(t/2))),o=r.map(((t,e)=>t-i[e]));return r.map(((t,e)=>[i[e],o[e]]))}([u.filterHeight,u.filterWidth],h):[[0,0],[0,0]];const p=1===h[0]&&1===h[1],[f,m]=function(t,e,n){const r=n.map((t=>t[0])),i=n.map((t=>t[1])),o=t.concat(r,i),a=e.map(((t,e)=>(t-o[e]%t)%t)),s=i.map(((t,e)=>t+a[e])),l=e.map(((t,e)=>[r[e],s[e]])),c=e.map(((t,e)=>[0,a[e]]));return[l,c]}([u.inHeight,u.inWidth],h,d),g=p?r:"valid",y=p?l:hH(l,h,f),v=("avg"===n?()=>iW(y,e,o,g,a):()=>WG(y,e,o,g,a))(),b=p?v:dW(v,h,m);return c?rW(b,[b.shape[1],b.shape[2],b.shape[3]]):b}});const pH=JB({prelu_:function(t,e){const n={x:YB(t,"x","prelu"),alpha:YB(e,"alpha","prelu")};return BB.runKernel(TF,n)}});const fH=JB({prod_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=YB(t,"x","prod");"bool"===r.dtype&&(r=uj(r,"int32"));const i={x:r},o={axis:e,keepDims:n};return BB.runKernel(EF,i,o)}});const mH=JB({raggedGather_:function(t,e,n,r){const i=t.map(((t,e)=>YB(t,"tensors".concat(e),"raggedGather","int32"))),o={paramsNestedSplits:i,paramsDenseValues:YB(e,"paramsDenseValues","raggedGather"),indices:YB(n,"indices","raggedGather","int32")},a={outputRaggedRank:r},s=BB.runKernel(MF,o,a);return{outputNestedSplits:s.slice(0,s.length-1),outputDenseValues:s[s.length-1]}}});const gH=JB({raggedRange_:function(t,e,n){const r=YB(t,"starts","raggedRange"),i={starts:r,limits:YB(e,"limits","raggedRange",r.dtype),deltas:YB(n,"deltas","raggedRange",r.dtype)},o=BB.runKernel(CF,i);return{rtNestedSplits:o[0],rtDenseValues:o[1]}}});const yH=JB({raggedTensorToTensor_:function(t,e,n,r,i){const o=YB(t,"shape","raggedTensorToTensor","int32"),a=YB(e,"values","raggedTensorToTensor"),s=YB(n,"defaultValue","raggedTensorToTensor",a.dtype),l=r.map(((t,e)=>YB(t,"tensors".concat(e),"raggedTensorToTensor","int32"))),c={shape:o,values:a,defaultValue:s,rowPartitionTensors:l},u={rowPartitionTypes:i};return BB.runKernel(AF,c,u)}});const vH=JB({rand_:function(t,e,n){ID(t);const r=cD(t);let i=null;if(null==n||"float32"===n)i=new Float32Array(r);else if("int32"===n)i=new Int32Array(r);else{if("bool"!==n)throw new Error("Unknown data type ".concat(n));i=new Uint8Array(r)}for(let o=0;o<r;o++)i[o]=e();return BB.makeTensor(i,t,n)}});var bH=__webpack_require__(334);class xH{constructor(t,e,n,r,i){this.mean=t,this.stdDev=e,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);const o=i||Math.random();this.random=bH.alea(o.toString())}nextValue(){if(!isNaN(this.nextVal)){const t=this.nextVal;return this.nextVal=NaN,t}let t,e,n=!1;for(;!n;){let r,i,o;do{r=2*this.random()-1,i=2*this.random()-1,o=r*r+i*i}while(o>=1||0===o);const a=Math.sqrt(-2*Math.log(o)/o);t=this.mean+this.stdDev*r*a,e=this.mean+this.stdDev*i*a,this.truncated&&!this.isValidTruncated(t)||(n=!0)}return this.truncated&&!this.isValidTruncated(e)||(this.nextVal=this.convertValue(e)),this.convertValue(t)}convertValue(t){return null==this.dtype||"float32"===this.dtype?t:Math.round(t)}isValidTruncated(t){return t<=this.upper&&t>=this.lower}}class _H{constructor(t,e,n,r){this.alpha=t,this.beta=1/e,this.dtype=n;const i=r||Math.random();this.randu=bH.alea(i.toString()),this.randn=new xH(0,1,n,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let t,e,n,r,i,o;for(;;){do{r=this.randn.nextValue(),o=1+this.c*r}while(o<=0);if(o*=o*o,t=r*r,e=1-.331*t*t,n=.5*t+this.d*(1-o+Math.log(o)),i=this.randu(),i<e||Math.log(i)<n)break}return o=1/this.beta*this.d*o,this.alpha<1&&(o*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(o)}convertValue(t){return"float32"===this.dtype?t:Math.round(t)}}class wH{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(this.canReturnFloat=()=>null==this.dtype||"float32"===this.dtype,this.min=t,this.range=e-t,this.dtype=n,null==r&&(r=Math.random()),"number"===typeof r&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between ".concat(t," - ").concat(e," <= 1 and dtype is not float"));this.random=bH.alea(r)}convertValue(t){return this.canReturnFloat()?t:Math.round(t)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}const SH=JB({randomGamma_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",i=arguments.length>4?arguments[4]:void 0;if(ID(t),null==n&&(n=1),null==r&&(r="float32"),"float32"!==r&&"int32"!==r)throw new Error("Unsupported data type ".concat(r));const o=new _H(e,n,r,i),a=cj(t,r);for(let s=0;s<a.values.length;s++)a.values[s]=o.nextValue();return a.toTensor()}});const TH=JB({randomNormal_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;if(ID(t),null!=r&&"bool"===r)throw new Error("Unsupported data type ".concat(r));const o=new xH(e,n,r,!1,i),a=cj(t,r);for(let s=0;s<a.values.length;s++)a.values[s]=o.nextValue();return a.toTensor()}});const EH=JB({randomStandardNormal_:function(t,e,n){if(null!=e&&"bool"===e)throw new Error("Unsupported data type ".concat(e));return TH(t,0,1,e,n)}});const MH=JB({randomUniform_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",i=arguments.length>4?arguments[4]:void 0;ID(t);const o=cj(t,r),a=new wH(e,n,null,i);for(let s=0;s<o.values.length;s++)o.values[s]=a.nextValue();return o.toTensor()}});const CH=JB({randomUniformInt_:function(t,e,n,r){return MH(t,e,n,"int32",r)}});function AH(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";if(0===n)throw new Error("Cannot have a step of zero");const i={start:t,stop:e,step:n,dtype:r};return BB.runKernel(kF,{},i)}const kH=JB({real_:function(t){const e={input:YB(t,"input","real")};return BB.runKernel(IF,e)}});const IH=JB({reciprocal_:function(t){const e={x:YB(t,"x","reciprocal")};return BB.runKernel(RF,e)}});const RH=JB({relu_:function(t){const e={x:YB(t,"x","relu")};return BB.runKernel(PF,e)}});const PH=JB({relu6_:function(t){const e={x:YB(t,"x","relu6")};return BB.runKernel(LF,e)}});const NH=JB({reverse_:function(t,e){const n={x:YB(t,"x","reverse")},r={dims:e};return BB.runKernel(FF,n,r)}});const OH=JB({reverse1d_:function(t){const e=YB(t,"x","reverse");return aD(1===e.rank,(()=>"Error in reverse1D: x must be rank 1 but got rank ".concat(e.rank,"."))),NH(e,0)}});const DH=JB({reverse2d_:function(t,e){const n=YB(t,"x","reverse");return aD(2===n.rank,(()=>"Error in reverse2D: x must be rank 2 but got rank ".concat(n.rank,"."))),NH(n,e)}});const LH=JB({reverse3d_:function(t,e){const n=YB(t,"x","reverse");return aD(3===n.rank,(()=>"Error in reverse3D: x must be rank 3 but got rank ".concat(n.rank,"."))),NH(n,e)}});const FH=JB({reverse4d_:function(t,e){const n=YB(t,"x","reverse");return aD(4===n.rank,(()=>"Error in reverse4D: x must be rank 4 but got rank ".concat(n.rank,"."))),NH(n,e)}});const UH=JB({round_:function(t){const e={x:YB(t,"x","round")};return BB.runKernel(UF,e)}});const BH=JB({rsqrt_:function(t){const e={x:YB(t,"x","rsqrt","float32")};return BB.runKernel(BF,e)}});const zH=JB({selu_:function(t){const e={x:YB(t,"x","selu")};return BB.runKernel(GF,e)}});const jH=JB({separableConv2d_:function(t,e,n,r,i){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NHWC";const s=YB(t,"x","separableConv2d"),l=YB(e,"depthwiseFilter","separableConv2d"),c=YB(n,"pointwiseFilter","separableConv2d");let u=s,h=!1;if(3===s.rank&&(h=!0,u=rW(s,[1,s.shape[0],s.shape[1],s.shape[2]])),"NCHW"===a)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");aD(4===u.rank,(()=>"Error in separableConv2d: input must be rank 4, but got "+"rank ".concat(u.rank,"."))),aD(4===l.rank,(()=>"Error in separableConv2d: depthwise filter must be rank 4, but "+"got rank ".concat(l.rank,"."))),aD(4===c.rank,(()=>"Error in separableConv2d: pointwise filter must be rank 4, but "+"got rank ".concat(l.rank,"."))),aD(1===c.shape[0],(()=>"Error in separableConv2d: the first dimension of pointwise filter "+" must be 1, but got ".concat(c.shape[0],"."))),aD(1===c.shape[1],(()=>"Error in separableConv2d: the second dimension of pointwise "+"filter must be 1, but got ".concat(c.shape[1],".")));const d=l.shape[2],p=l.shape[3];aD(c.shape[2]===d*p,(()=>"Error in separableConv2d: the third dimension of pointwise filter "+"must be ".concat(d*p,", ")+"but got ".concat(c.shape[2],".")));const f=zW(u,l,r,i,a,o),m=CW(f,c,1,"valid",a);return h?rW(m,[m.shape[1],m.shape[2],m.shape[3]]):m}});const VH=async function(t,e){const n=YB(t,"x","setdiff1d"),r=YB(e,"y","setdiff1d");aD(n.dtype===r.dtype,(()=>"x and y should have the same dtype, but got x (".concat(n.dtype,") and y (").concat(r.dtype,")."))),aD(1===n.rank,(()=>"x should be 1D tensor, but got x (".concat(n.shape,")."))),aD(1===r.rank,(()=>"y should be 1D tensor, but got y (".concat(r.shape,").")));const i=await n.data(),o=await r.data(),a=new Set(o);let s=0;for(let u=0;u<i.length;u++)a.has(i[u])||s++;const l=new mB([s],n.dtype),c=new mB([s],"int32");for(let u=0,h=0;u<i.length;u++)a.has(i[u])||(l.values[h]=i[u],c.values[h]=u,h++);return[l.toTensor(),c.toTensor()]};const WH=JB({sign_:function(t){const e={x:YB(t,"x","sign")};return BB.runKernel(XF,e)}});const GH=JB({sin_:function(t){const e={x:YB(t,"x","sin","float32")};return BB.runKernel("Sin",e)}});const HH=JB({sinh_:function(t){const e={x:YB(t,"x","sinh")};return BB.runKernel(qF,e)}});const qH=JB({slice1d_:function(t,e,n){const r=YB(t,"x","slice1d");return aD(1===r.rank,(()=>"slice1d expects a rank-1 tensor, but got a rank-".concat(r.rank," tensor"))),cW(r,[e],[n])}});const XH=JB({slice2d_:function(t,e,n){const r=YB(t,"x","slice2d");return aD(2===r.rank,(()=>"slice2d expects a rank-2 tensor, but got a rank-".concat(r.rank," tensor"))),cW(r,e,n)}});const YH=JB({slice3d_:function(t,e,n){const r=YB(t,"x","slice3d");return aD(3===r.rank,(()=>"slice3d expects a rank-3 tensor, but got a rank-".concat(r.rank," tensor"))),cW(r,e,n)}});const KH=JB({slice4d_:function(t,e,n){const r=YB(t,"x","slice4d");return aD(4===r.rank,(()=>"slice4d expects a rank-4 tensor, but got a rank-".concat(r.rank," tensor"))),cW(r,e,n)}});const ZH=JB({softmax_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const n=YB(t,"logits","softmax","float32");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and dim was ").concat(e));const r={logits:n},i={dim:e};return BB.runKernel($F,r,i)}});const JH=JB({fft_:function(t){aD("complex64"===t.dtype,(()=>"The dtype for tf.spectral.fft() must be complex64 "+"but got ".concat(t.dtype,".")));const e={input:t};return BB.runKernel("FFT",e)}});const QH=JB({ifft_:function(t){aD("complex64"===t.dtype,(()=>"The dtype for tf.spectral.ifft() must be complex64 "+"but got ".concat(t.dtype,".")));const e={input:t};return BB.runKernel(qL,e)}});const $H=JB({irfft_:function(t){const e=t.shape[t.shape.length-1],n=t.size/e;let r;if(e<=2){const i=rW(t,[n,e]);r=QH(i)}else{const i=[n,2*(e-1)],o=rW(kH(t),[n,e]),a=rW(xG(t),[n,e]),s=NH(cW(o,[0,1],[n,e-2]),1),l=gj(NH(cW(a,[0,1],[n,e-2]),1),_j(-1)),c=aW([o,s],1),u=aW([a,l],1),h=rW(QB(c,u),[i[0],i[1]]);r=QH(h)}if(r=kH(r),3===t.rank&&0!==t.shape[0]){const e=r,n=t.shape[0];r=rW(r,[n,r.shape[0]/n,r.shape[1]]),e.dispose()}return r}});const tq=JB({split_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r={x:YB(t,"x","split")},i={numOrSizeSplits:e,axis:n};return BB.runKernel(QF,r,i)}});const eq=JB({rfft_:function(t,e){aD("float32"===t.dtype,(()=>"The dtype for rfft() must be real value but got ".concat(t.dtype)));let n=t.shape[t.shape.length-1];const r=t.size/n;let i;if(null!=e&&e<n){const r=t.shape.map((t=>0)),o=t.shape.map((t=>t));o[t.shape.length-1]=e,i=cW(t,r,o),n=e}else if(null!=e&&e>n){const r=t.shape.map((t=>t));r[t.shape.length-1]=e-n,i=aW([t,XG(r)],t.shape.length-1),n=e}else i=t;const o=bj(i),a=rW(QB(i,o),[r,n]),s=JH(a),l=Math.floor(n/2)+1,c=kH(s),u=xG(s),h=tq(c,[l,n-l],c.shape.length-1),d=tq(u,[l,n-l],u.shape.length-1),p=i.shape.slice();return p[i.shape.length-1]=l,rW(QB(h[0],d[0]),p)}});const nq=JB({squaredDifference_:function(t,e){let n=YB(t,"a","squaredDifference"),r=YB(e,"b","squaredDifference");[n,r]=PB(n,r),Oj(n.shape,r.shape);const i={a:n,b:r};return BB.runKernel(oU,i,{})}});const rq=JB({squeeze_:function(t,e){const n=YB(t,"x","squeeze","string_or_numeric");return rW(n,gD(n.shape,e).newShape)}});const iq=JB({stack_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=KB(t,"tensors","stack","string_or_numeric");aD(n.length>=1,(()=>"Pass at least one tensor to tf.stack")),n.length>0&&aD(e<=n[0].rank,(()=>"Axis must be <= rank of the tensor"));const r=n,i={axis:e};return BB.runKernel(wF,r,i)}});const oq=JB({step_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n={x:YB(t,"x","step")},r={alpha:e};return BB.runKernel(_U,n,r)}});const aq=JB({stridedSlice_:function(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0;const c={x:YB(t,"x","stridedSlice","string_or_numeric")},u={begin:e,end:n,strides:r,beginMask:i,endMask:o,ellipsisMask:a,newAxisMask:s,shrinkAxisMask:l};return BB.runKernel(sU,c,u)}});const sq=JB({tan_:function(t){const e={x:YB(t,"x","tan","float32")};return BB.runKernel("Tan",e)}});function lq(t,e){lD(t);const n=HB(t,e);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return $B(t,null,n,e)}function cq(t,e,n){if(lD(t),null!=e&&2!==e.length)throw new Error("tensor2d() requires shape to have two numbers");const r=HB(t,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return $B(t,e,r,n)}function uq(t,e,n){if(lD(t),null!=e&&4!==e.length)throw new Error("tensor4d() requires shape to have four numbers");const r=HB(t,n);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return $B(t,e,r,n)}function hq(t,e,n){if(lD(t),null!=e&&5!==e.length)throw new Error("tensor5d() requires shape to have five numbers");const r=HB(t,n);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return $B(t,e,r,n)}function dq(t,e,n){if(lD(t),null!=e&&6!==e.length)throw new Error("tensor6d() requires shape to have six numbers");const r=HB(t,n);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return $B(t,e=e||r,r,n)}function pq(t,e,n){const r=e.rank>1?e.shape[e.rank-1]:1,i=e.rank>1?e.rank-1:1,o="Must have updates.shape = indices.shape[:batchDim] + "+"shape[sliceDim:], got updates.shape: ".concat(n.shape)+", indices.shape: ".concat(e.shape,", shape: ").concat(t)+", sliceDim: ".concat(r,", and batchDim: ").concat(i,".");if(n.rank<i)throw new Error(o+" update.rank < ".concat(i,". "));if(t.length<r+(n.rank-i))throw new Error(o+" Output shape length < ".concat(r+(n.rank-i)));if(n.rank!==i+t.length-r)throw new Error(o+" update.rank != ".concat(i+t.length-r));for(let a=0;a<i;++a)if(n.shape[a]!==e.shape[a])throw new Error(o+" updates.shape[".concat(a,"] (").concat(n.shape[a],") != indices.shape[").concat(a,"] (").concat(e.shape[a],")."));for(let a=0;a<n.rank-i;++a)if(n.shape[a+i]!==t[a+r])throw new Error(o+" updates.shape[".concat(a+i,"] (").concat(n.shape[a+i],") != shape[").concat(a+i,"] (").concat(t[a+i],")"))}function fq(t,e,n){if(e.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(e.rank,"."));if(t.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher,"+" but the rank was ".concat(t.rank,"."));if("int32"!==e.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: ".concat(e.dtype));if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: ".concat(n));if(0===n.length){if(0===e.size)throw new Error("Indices specified for empty output. indices shape: ".concat(e.shape));if(0===t.size)throw new Error("Updates specified for empty output. updates shape: ".concat(t.shape))}pq(n,e,t)}function mq(t,e,n){const r=e.shape.length,i=r>1?e.shape[r-1]:1,o=n.length;let a=1;for(let l=i;l<o;++l)a*=n[l];const s=i<1?1:i;return{sliceRank:i,numUpdates:cD(e.shape)/s,sliceSize:a,strides:[...ED(n.slice(0,i)),1],outputSize:cD(n)}}const gq=JB({tensorScatterUpdate_:function(t,e,n){const r=YB(t,"tensor","tensorScatterupdate"),i=YB(e,"indices","tensorScatterupdate","int32"),o=YB(n,"updates","tensorScatterupdate");if(fq(o,i,r.shape),r.dtype!==o.dtype)throw new Error("tensor and updates must have the same dtype, instead they are ".concat(r.dtype," and ").concat(o.dtype,"."));const a={tensor:r,indices:i,updates:o};return BB.runKernel(jF,a,{})}});const yq=JB({topk_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=YB(t,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");const i=r.shape[r.shape.length-1];if(e<0)throw new Error("'k' passed to topk() must be >= 0 but got ".concat(e));if(e>i)throw new Error("'k' passed to topk() must be <= the last dimension (".concat(i,") ")+"but got ".concat(e));const o={x:r},a={k:e,sorted:n},[s,l]=BB.runKernel(fU,o,a);return{values:s,indices:l}}});const vq=JB({truncatedNormal_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;if(ID(t),null!=r&&"bool"===r)throw new Error("Unsupported data type $ { dtype }");const o=new xH(e,n,r,!0,i),a=cj(t,r);for(let s=0;s<a.values.length;s++)a.values[s]=o.nextValue();return a.toTensor()}});const bq=JB({unique_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=YB(t,"x","unique","string_or_numeric");aD(n.rank>0,(()=>"The input tensor must be at least 1D"));const r={x:n},i={axis:e},[o,a]=BB.runKernel(yU,r,i);return{values:o,indices:a}}});const xq=JB({unsortedSegmentSum_:function(t,e,n){const r=YB(t,"x","unsortedSegmentSum"),i=YB(e,"segmentIds","unsortedSegmentSum","int32");aD(hD(n),(()=>"numSegments must be of dtype int"));const o={x:r,segmentIds:i},a={numSegments:n};return BB.runKernel(bU,o,a)}});const _q=JB({unstack_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=YB(t,"x","unstack","string_or_numeric");aD(e>=-n.shape.length&&e<n.shape.length,(()=>"Axis = ".concat(e," is not in [-").concat(n.shape.length,", ").concat(n.shape.length,")")));const r={value:n},i={axis:e};return BB.runKernel(vU,r,i)}});function wq(t,e){return jG(t,e,"right")}function Sq(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return BB.makeVariable(t,e,n,r)}function Tq(t,e){const n=[];for(let o=0;o<e.length;o++)e[o]&&n.push(o);const r=cj(t,"int32"),i=cj([n.length,t.length],"int32");for(let o=0;o<n.length;o++){const e=r.indexToLoc(n[o]),a=o*t.length;i.values.set(e,a)}return i.toTensor()}const Eq=async function(t){const e=YB(t,"condition","whereAsync","bool"),n=await e.data(),r=Tq(e.shape,n);return t!==e&&e.dispose(),r};const Mq=async function(t,e,n){const r=YB(t,"tensor","boolMask"),i=YB(e,"mask","boolMask","bool"),o=null==n?0:n,a=i.rank,s=r.shape;aD(a>0,(()=>"mask cannot be scalar")),sD(s.slice(o,o+a),i.shape,"mask's shape must match the first K dimensions of tensor's shape,");let l=1;for(let m=o;m<o+a;m++)l*=s[m];const c=s.slice(0,o).concat([l],s.slice(o+a)),u=rW(r,c),h=rW(i,[-1]),d=await Eq(h),p=rq(d,[1]),f=yG(u,p,o);return t!==r&&r.dispose(),e!==i&&i.dispose(),p.dispose(),u.dispose(),h.dispose(),d.dispose(),f};const Cq=JB({transpose_:function(t,e,n){const r=YB(t,"x","transpose");if(null==e&&(e=r.shape.map(((t,e)=>e)).reverse()),aD(r.rank===e.length,(()=>"Error in transpose: rank of input ".concat(r.rank," ")+"must match length of perm ".concat(e,"."))),e.forEach((t=>{aD(t>=0&&t<r.rank,(()=>"All entries in 'perm' must be between 0 and ".concat(r.rank-1)+" but got ".concat(e)))})),r.rank<=1)return r.clone();const i={x:r},o={perm:e};return"complex64"===r.dtype?iz((()=>{let t=kH(r),e=xG(r);return t=BB.runKernel(gU,{x:t},o),e=BB.runKernel(gU,{x:e},o),n&&(e=RG(e)),QB(t,e)})):BB.runKernel(gU,i,o)}});const Aq=JB({movingAverage_:function(t,e,n,r){let i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];const o=YB(t,"v","movingAverage"),a=YB(e,"x","movingAverage"),s=YB(n,"decay","movingAverage");!function(t,e){aD(t.dtype===e.dtype,(()=>"The dtypes of the first(".concat(t.dtype,") and")+" second(".concat(e.dtype,") input must match")))}(o,a),aD(uD(o.shape,a.shape),(()=>"Shape mismatch in v and x"));const l=_j(1),c=Ij(l,s);let u=gj(Ij(a,o),c);if(i){aD(null!=r,(()=>"When using zeroDebias: true, step is required."));const t=YB(r,"step","movingAverage");u=mj(u,Ij(l,kj(s,t)))}return pj(o,u)}});const kq=JB({scatterND_:function(t,e,n){ID(n);const r=YB(t,"indices","scatterND","int32"),i=YB(e,"updates","scatterND");fq(i,r,n);const o={indices:r,updates:i},a={shape:n};return BB.runKernel(zF,o,a)}});const Iq=JB({sparseToDense_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;ID(n);const i=YB(t,"sparseIndices","sparseToDense","int32"),o=YB(e,"sparseValues","sparseToDense","string_or_numeric"),a=YB(r,"defaultValue","sparseToDense",o.dtype);!function(t,e,n,r){if("int32"!==t.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type,"+" but the dtype was ".concat(t.dtype,"."));if(t.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix,"+" but got shape ".concat(t.shape,"."));const i=t.rank>0?t.shape[0]:1,o=t.rank>1?t.shape[1]:1;if(n.length!==o)throw new Error("outputShape has incorrect number of elements:,"+" ".concat(n.length,", should be: ").concat(o,"."));const a=e.size;if(0!==e.rank&&(1!==e.rank||a!==i))throw new Error("sparseValues has incorrect shape "+"".concat(e.shape,", should be [] or [").concat(i,"]"));if(e.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(i,o,n,a);const s={sparseIndices:i,sparseValues:o,defaultValue:a},l={outputShape:n};return BB.runKernel(iU,s,l)}});const Rq=JB({gatherND_:function(t,e){const n=YB(e,"indices","gatherND","int32"),r={params:YB(t,"x","gatherND","string_or_numeric"),indices:n};return BB.runKernel(VL,r)}});const Pq=JB({dropout_:function(t,e,n,r){const i=YB(t,"x","dropout");if(aD("float32"===i.dtype,(()=>"x has to be a floating point tensor since it's going to be "+"scaled, but got a ".concat(i.dtype," tensor instead."))),aD(e>=0&&e<1,(()=>"rate must be a float in the range [0, 1), but got ".concat(e,"."))),0===e)return t instanceof bB?i.clone():i;const o=function(t,e){if(null==e)return t.shape.slice();if(uD(t.shape,e))return e;if(t.shape.length===e.length){const n=[];for(let r=0;r<t.shape.length;r++)null==e[r]&&null!=t.shape[r]?n.push(t.shape[r]):n.push(e[r]);return n}return e}(i,n),a=1-e,s=mj(gG(pj(MH(o,0,1,"float32",r),a)),a);return gj(i,s)}});function Nq(t){return Math.floor(Math.pow(2,Math.ceil(Math.log(t)/Math.log(2))))}function Oq(t,e,n){const r=1-t%2,i=new Float32Array(t);for(let o=0;o<t;++o){const a=2*Math.PI*o/(t+r-1);i[o]=e-n*Math.cos(a)}return lq(i,"float32")}const Dq=async function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const r=YB(t,"predictions","inTopK"),i=YB(e,"targets","inTopK");aD(r.rank>1,(()=>"inTopK() expects the predictions to be of rank 2 or higher, "+"but got ".concat(r.rank))),aD(r.rank-1===i.rank,(()=>"predictions rank should be 1 larger than targets rank, but got predictions rank "+"".concat(r.rank," and targets rank ").concat(i.rank))),sD(r.shape.slice(0,r.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const o=r.shape[r.shape.length-1];aD(n>0&&n<=o,(()=>"'k' passed to inTopK() must be > 0 && <= the predictions last "+"dimension (".concat(o,"), but got ").concat(n)));const a=await r.data(),s=await i.data(),[l,c]=[a.length/o,o],u=yD("bool",l);for(let h=0;h<l;h++){const t=h*c,e=a.subarray(t,t+c),r=[];for(let n=0;n<e.length;n++)r.push({value:e[n],index:n});r.sort(((t,e)=>e.value-t.value)),u[h]=0;for(let i=0;i<n;i++)if(r[i].index===s[h]){u[h]=1;break}}return t!==r&&r.dispose(),e!==i&&i.dispose(),tz(u,i.shape,"bool")};const Lq=JB({conv2DBackpropFilter_:function(t,e,n,r,i){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",a=arguments.length>6?arguments[6]:void 0,s=t;3===t.rank&&(s=rW(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;3===l.rank&&(l=rW(e,[1,e.shape[0],e.shape[1],e.shape[2]])),aD(4===s.rank,(()=>"Error in conv2dDerFilter: input must be rank 4, but got shape "+"".concat(s.shape,"."))),aD(4===l.rank,(()=>"Error in conv2dDerFilter: dy must be rank 4, but got shape "+"".concat(l.shape,"."))),aD(4===n.length,(()=>"Error in conv2dDerFilter: filterShape must be length 4, but got "+"".concat(n,".")));const c="NHWC"===o?s.shape[3]:s.shape[1],u="NHWC"===o?l.shape[3]:l.shape[1];aD(c===n[2],(()=>"Error in conv2dDerFilter: depth of input ".concat(c,") must ")+"match input depth in filter (".concat(n[2],"."))),aD(u===n[3],(()=>"Error in conv2dDerFilter: depth of dy (".concat(u,") must ")+"match output depth for filter (".concat(n[3],")."))),nW("conv2dDerFilter",i,a);const h={x:s,dy:l},d={strides:r,pad:i,dataFormat:o,dimRoundingMode:a,filterShape:n};return BB.runKernel(fL,h,d)}});function Fq(t,e,n){if(null==n||"linear"===n)return t;if("relu"===n)return gj(t,oq(e));throw new Error("Cannot compute gradient for fused activation ".concat(n,"."))}function Uq(t,e){let n=e;const r=Nj(t.shape,e.shape);return r.length>0&&(n=sG(n,r)),rW(n,t.shape)}function Bq(t,e,n,r){if("linear"===e)return t;if("relu"===e)return RH(t);if("elu"===e)return YW(t);if("relu6"===e)return PH(t);if("prelu"===e)return pH(t,n);if("leakyrelu"===e)return TG(t,r);if("sigmoid"===e)return lW(t);throw new Error("Unknown fused activation ".concat(e,"."))}const zq=(t,e)=>!(t>0)||"linear"===e;const jq=JB({fusedConv2d_:function(t){let{x:e,filter:n,strides:r,pad:i,dataFormat:o="NHWC",dilations:a=[1,1],dimRoundingMode:s,bias:l,activation:c="linear",preluActivationWeights:u,leakyreluAlpha:h}=t;if(c=c||"linear",!1===zq(BB.state.gradientDepth,c)){aD("NHWC"===o,(()=>"Error in fused conv2d: got dataFormat of ".concat(o," but ")+"only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear."));let t=CW(e,n,r,i,o,a,s);return null!=l&&(t=pj(t,l)),Bq(t,c,u,h)}const d=YB(e,"x","conv2d","float32"),p=YB(n,"filter","conv2d","float32");let f=d,m=!1;3===d.rank&&(m=!0,f=rW(d,[1,d.shape[0],d.shape[1],d.shape[2]])),aD(4===f.rank,(()=>"Error in fused conv2d: input must be rank 4, but got rank "+"".concat(f.rank,"."))),aD(4===p.rank,(()=>"Error in fused conv2d: filter must be rank 4, but got rank "+"".concat(p.rank,"."))),nW("fused conv2d",i,s);const g="NHWC"===o?f.shape[3]:f.shape[1];aD(p.shape[2]===g,(()=>"Error in conv2d: depth of input (".concat(g,") must match ")+"input depth for filter ".concat(p.shape[2],"."))),aD($V(r,a),(()=>"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(r," and dilations '").concat(a,"'")));const y=HV(f.shape,p.shape,r,a,i,s);let v,b;if(null!=l&&(v=YB(l,"bias","fused conv2d"),[v]=PB(v,d),"NHWC"===o?Oj(y.outShape,v.shape):(aD(v.shape.length<=1,(()=>"Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of "+"rank-".concat(v.shape.length,"."))),aD(0===v.shape.length||v.shape[0]===y.outChannels||1===v.shape[0],(()=>"Error in fused conv2d: bias shape (".concat(v.shape,") is not ")+"compatible with the number of output channels "+"(".concat(y.outChannels,")"))))),null!=u){const t=u.shape;if(aD(t.length<=1||3===t.length,(()=>"Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of "+"rank-".concat(t.length,"."))),1===t.length)aD(1===t[0]||t[0]===y.outChannels,(()=>"Error in fused conv2d: PReLU activation weights "+"(".concat(t,") is not compatible with the number of output ")+"channels (".concat(y.outChannels,").")));else if(3===t.length)try{Oj(t,y.outShape)}catch($7){const n="Error in fused conv2d: PReLU activation weights (".concat(t,") ")+"is not compatible with the output shape of the conv2d "+"(".concat(y.outShape,").");throw Error(n)}b=YB(u,"prelu weights","fused conv2d")}const x=(t,e)=>{aD("NHWC"===o,(()=>"Error in gradient of fused conv2D: got dataFormat of ".concat(o," but only NHWC is currently supported.")));const[n,s,l,u]=e,h=Fq(t,l,c);aD(QV(a),(()=>"Error in gradient of fused conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(a,"'")));const d=[kW(s.shape,h,n,r,i),Lq(s,h,n.shape,r,i)];if(null!=u){const t=Uq(u,h);d.push(t)}return d},_={x:f,filter:p,bias:v,preluActivationWeights:b},w={strides:r,pad:i,dataFormat:o,dilations:a,dimRoundingMode:s,activation:c,leakyreluAlpha:h};if(null==l){const t=xj(((t,e,n)=>{let r=BB.runKernel(EU,_,w);return n([e,t,r]),m&&(r=rW(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:x}}));return t(f,p)}{const t=xj(((t,e,n,r)=>{let i=BB.runKernel(EU,_,w);return r([e,t,i,n]),m&&(i=rW(i,[i.shape[1],i.shape[2],i.shape[3]])),{value:i,gradFunc:x}}));return t(f,p,v)}}});const Vq=JB({depthwiseConv2dNativeBackpropFilter_:function(t,e,n,r,i){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],a=arguments.length>6?arguments[6]:void 0,s=t;3===t.rank&&(s=rW(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;3===l.rank&&(l=rW(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={x:s,dy:l},u={strides:r,pad:i,dimRoundingMode:a,dilations:o,filterShape:n};return BB.runKernel(EL,c,u)}});const Wq=JB({depthwiseConv2dNativeBackpropInput_:function(t,e,n,r,i){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],a=arguments.length>6?arguments[6]:void 0,s=e,l=!1;3===e.rank&&(l=!0,s=rW(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={dy:s,filter:n},u={strides:r,pad:i,dimRoundingMode:a,dilations:o,inputShape:t},h=BB.runKernel(ML,c,u);return l?rW(h,[h.shape[1],h.shape[2],h.shape[3]]):h}});const Gq=JB({fusedDepthwiseConv2d_:function(t){let{x:e,filter:n,strides:r,pad:i,dataFormat:o="NHWC",dilations:a=[1,1],dimRoundingMode:s,bias:l,activation:c="linear",preluActivationWeights:u,leakyreluAlpha:h}=t;if(!1===zq(BB.state.gradientDepth,c)){let t=zW(e,n,r,i,o,a,s);return null!=l&&(t=pj(t,l)),Bq(t,c,u,h)}const d=YB(e,"x","depthwiseConv2d","float32"),p=YB(n,"filter","depthwiseConv2d","float32");let f=d,m=!1;3===d.rank&&(m=!0,f=rW(d,[1,d.shape[0],d.shape[1],d.shape[2]])),aD(4===f.rank,(()=>"Error in fused depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(f.rank,"."))),aD(4===p.rank,(()=>"Error in fused depthwiseConv2d: filter must be rank 4, "+"but got rank ".concat(p.rank,"."))),aD(f.shape[3]===p.shape[2],(()=>"Error in fused depthwiseConv2d: number of input channels "+"(".concat(f.shape[3],") must match the inChannels dimension in ")+"filter ".concat(p.shape[2],"."))),null==a&&(a=[1,1]),aD($V(r,a),(()=>"Error in fused depthwiseConv2d: Either strides or dilations must "+"be 1. Got strides ".concat(r," and dilations '").concat(a,"'"))),nW("fused depthwiseConv2d",i,s);const g=HV(f.shape,p.shape,r,a,i,s,!0);let y,v;null!=l&&(y=YB(l,"bias","fused conv2d"),[y]=PB(y,d),Oj(g.outShape,y.shape)),null!=u&&(v=YB(u,"prelu weights","fused depthwiseConv2d"));const b=(t,e)=>{aD(QV(a),(()=>"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(a,"'")));const[n,o,l,u]=e,h=Fq(t,l,c),d=Wq(o.shape,h,n,r,i,a,s),p=Vq(o,h,n.shape,r,i,a,s);if(null!=u){return[d,p,Uq(y,h)]}return[d,p]},x={x:f,filter:p,bias:y,preluActivationWeights:v},_={strides:r,pad:i,dataFormat:o,dilations:a,dimRoundingMode:s,activation:c,leakyreluAlpha:h};if(null==l){const t=xj(((t,e,n)=>{let r=BB.runKernel(MU,x,_);return n([e,t,r]),m&&(r=rW(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:b}}));return t(f,p)}{const t=xj(((t,e,n,r)=>{let i=BB.runKernel(MU,x,_);return r([e,t,i,n]),m&&(i=rW(i,[i.shape[1],i.shape[2],i.shape[3]])),{value:i,gradFunc:b}}));return t(f,p,y)}}});const Hq=JB({fusedMatMul_:function(t){let{a:e,b:n,transposeA:r=!1,transposeB:i=!1,bias:o,activation:a="linear",preluActivationWeights:s,leakyreluAlpha:l=.2}=t;if(!1===zq(BB.state.gradientDepth,a)){let t=sW(e,n,r,i);return null!=o&&(t=pj(t,o)),Bq(t,a,s,l)}let c=YB(e,"a","fused matMul"),u=YB(n,"b","fused matMul");[c,u]=PB(c,u);const h=r?c.shape[c.rank-2]:c.shape[c.rank-1],d=i?u.shape[u.rank-1]:u.shape[u.rank-2],p=r?c.shape[c.rank-1]:c.shape[c.rank-2],f=i?u.shape[u.rank-2]:u.shape[u.rank-1],m=c.shape.slice(0,-2),g=u.shape.slice(0,-2),y=cD(m),v=cD(g);aD(h===d,(()=>"Error in fused matMul: inner shapes (".concat(h,") and (")+"".concat(d,") of Tensors with shapes ").concat(c.shape," and ")+"".concat(u.shape," and transposeA=").concat(r)+" and transposeB=".concat(i," must match.")));const b=Oj(c.shape.slice(0,-2),u.shape.slice(0,-2)).concat([p,f]),x=rW(c,r?[y,h,p]:[y,p,h]),_=rW(u,i?[v,f,d]:[v,d,f]);let w,S;null!=o&&(w=YB(o,"bias","fused matMul"),[w]=PB(w,c),Oj(b,w.shape)),null!=s&&(S=YB(s,"prelu weights","fused matMul"));const T=(t,e)=>{const[n,s,l,c]=e,u=Fq(rW(t,l.shape),l,a);let h,d;if(r||i?!r&&i?(h=sW(u,s,!1,!1),d=sW(u,n,!0,!1)):r&&!i?(h=sW(s,u,!1,!0),d=sW(n,u,!1,!1)):(h=sW(s,u,!0,!0),d=sW(u,n,!0,!0)):(h=sW(u,s,!1,!0),d=sW(n,u,!0,!1)),null!=o){return[h,d,Uq(c,u)]}return[h,d]},E={a:x,b:_,bias:w,preluActivationWeights:S},M={transposeA:r,transposeB:i,activation:a,leakyreluAlpha:l};if(null==o){const t=xj(((t,e,n)=>{const r=BB.runKernel(TU,E,M);return n([t,e,r]),{value:rW(r,b),gradFunc:T}}));return t(x,_)}{const t=xj(((t,e,n,r)=>{const i=BB.runKernel(TU,E,M);return r([t,e,i,n]),{value:rW(i,b),gradFunc:T}}));return t(x,_,w)}}});const qq=JB({hammingWindow_:function(t){return Oq(t,.54,.46)}});const Xq=JB({hannWindow_:function(t){return Oq(t,.5,.5)}});const Yq=JB({frame_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=0;const a=[];for(;o+e<=t.size;)a.push(cW(t,o,e)),o+=n;if(r)for(;o<t.size;){const r=o+e-t.size,s=aW([cW(t,o,e-r),Aj([r],i)]);a.push(s),o+=n}return 0===a.length?cq([],[0,e]):rW(aW(a),[a.length,e])}});const Kq=JB({stft_:function(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Xq;null==r&&(r=Nq(e));const o=Yq(t,e,n),a=gj(o,i(e));return eq(a,r)}});const Zq=JB({cropAndResize_:function(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"bilinear",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;const a=YB(t,"image","cropAndResize"),s=YB(e,"boxes","cropAndResize","float32"),l=YB(n,"boxInd","cropAndResize","int32"),c=s.shape[0];aD(4===a.rank,(()=>"Error in cropAndResize: image must be rank 4,"+"but got rank ".concat(a.rank,"."))),aD(2===s.rank&&4===s.shape[1],(()=>"Error in cropAndResize: boxes must be have size [".concat(c,",4] ")+"but had shape ".concat(s.shape,"."))),aD(1===l.rank&&l.shape[0]===c,(()=>"Error in cropAndResize: boxInd must be have size [".concat(c,"] ")+"but had shape ".concat(s.shape,"."))),aD(2===r.length,(()=>"Error in cropAndResize: cropSize must be of length 2, but got "+"length ".concat(r.length,"."))),aD(r[0]>=1&&r[1]>=1,(()=>"cropSize must be atleast [1,1], but was ".concat(r))),aD("bilinear"===i||"nearest"===i,(()=>"method must be bilinear or nearest, but was ".concat(i)));const u={image:a,boxes:s,boxInd:l},h={method:i,extrapolationValue:o,cropSize:r};return BB.runKernel(_L,u,h)}});const Jq=JB({flipLeftRight_:function(t){const e=YB(t,"image","flipLeftRight","float32");aD(4===e.rank,(()=>"Error in flipLeftRight: image must be rank 4,"+"but got rank ".concat(e.rank,".")));const n={image:e};return BB.runKernel(FL,n,{})}});const Qq=JB({grayscaleToRGB_:function(t){const e=YB(t,"image","grayscaleToRGB"),n=e.rank-1,r=e.shape[n];aD(e.rank>=2,(()=>"Error in grayscaleToRGB: images must be at least rank 2, "+"but got rank ".concat(e.rank,"."))),aD(1===r,(()=>"Error in grayscaleToRGB: last dimension of a grayscale image "+"should be size 1, but got size ".concat(r,".")));const i=new Array(e.rank);return i.fill(1,0,n),i[n]=3,fG(e,i)}});const $q=JB({rgbToGrayscale_:function(t){const e=YB(t,"image","RGBToGrayscale"),n=e.rank-1,r=e.shape[n];aD(e.rank>=2,(()=>"Error in RGBToGrayscale: images must be at least rank 2, "+"but got rank ".concat(e.rank,"."))),aD(3===r,(()=>"Error in RGBToGrayscale: last dimension of an RGB image "+"should be size 3, but got size ".concat(r,".")));const i=e.dtype,o=uj(e,"float32"),a=lq([.2989,.587,.114]);let s;switch(e.rank){case 2:s=XW("ij,j->i",o,a);break;case 3:s=XW("ijk,k->ij",o,a);break;case 4:s=XW("ijkl,l->ijk",o,a);break;case 5:s=XW("ijklm,m->ijkl",o,a);break;case 6:s=XW("ijklmn,n->ijklm",o,a);break;default:throw new Error("Not a valid tensor rank.")}return s=dG(s,-1),uj(s,i)}});const tX=JB({rotateWithOffset_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;const i=YB(t,"image","rotateWithOffset","float32");aD(4===i.rank,(()=>"Error in rotateWithOffset: image must be rank 4,"+"but got rank ".concat(i.rank,".")));const o={image:i},a={radians:e,fillValue:n,center:r};return BB.runKernel(SU,o,a)}});function eX(t,e,n,r,i,o){null==r&&(r=.5),null==i&&(i=Number.NEGATIVE_INFINITY),null==o&&(o=0);const a=t.shape[0];return n=Math.min(n,a),aD(0<=r&&r<=1,(()=>"iouThreshold must be in [0, 1], but was '".concat(r,"'"))),aD(2===t.rank,(()=>"boxes must be a 2D tensor, but was of rank '".concat(t.rank,"'"))),aD(4===t.shape[1],(()=>"boxes must have 4 columns, but 2nd dimension was ".concat(t.shape[1]))),aD(1===e.rank,(()=>"scores must be a 1D tensor")),aD(e.shape[0]===a,(()=>"scores has incompatible shape with boxes. Expected ".concat(a,", ")+"but was ".concat(e.shape[0]))),aD(0<=o&&o<=1,(()=>"softNmsSigma must be in [0, 1], but was '".concat(o,"'"))),{maxOutputSize:n,iouThreshold:r,scoreThreshold:i,softNmsSigma:o}}const nX=JB({nonMaxSuppression_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY;const o=YB(t,"boxes","nonMaxSuppression","float32"),a=YB(e,"scores","nonMaxSuppression","float32"),s=eX(o,a,n,r,i);n=s.maxOutputSize,r=s.iouThreshold,i=s.scoreThreshold;const l={maxOutputSize:n,iouThreshold:r,scoreThreshold:i};return BB.runKernel(yF,{boxes:o,scores:a},l)}});function rX(t,e,n){const r=function(t,e,n){return function(t,e,n){let r=0,i=t.length,o=0,a=!1;for(;r<i;){o=r+(i-r>>>1);const s=n(e,t[o]);s>0?r=o+1:(i=o,a=!s)}return a?r:-r-1}(t,e,n||iX)}(t,e,n),i=r<0?-(r+1):r;t.splice(i,0,e)}function iX(t,e){return t>e?1:t<e?-1:0}function oX(t,e,n,r,i){return lX(t,e,n,r,i,0)}function aX(t,e,n,r,i,o){return lX(t,e,n,r,i,0,!1,o,!0)}function sX(t,e,n,r,i,o){return lX(t,e,n,r,i,o,!0)}function lX(t,e,n,r,i,o){let a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]&&arguments[7],l=arguments.length>8&&void 0!==arguments[8]&&arguments[8];const c=[];for(let g=0;g<e.length;g++)e[g]>i&&c.push({score:e[g],boxIndex:g,suppressBeginIndex:0});c.sort(hX);const u=o>0?-.5/o:0,h=[],d=[];for(;h.length<n&&c.length>0;){const e=c.pop(),{score:n,boxIndex:o,suppressBeginIndex:a}=e;if(n<i)break;let s=!1;for(let l=h.length-1;l>=a;--l){const n=cX(t,o,h[l]);if(n>=r){s=!0;break}if(e.score=e.score*uX(r,u,n),e.score<=i)break}e.suppressBeginIndex=h.length,s||(e.score===n?(h.push(o),d.push(e.score)):e.score>i&&rX(c,e,hX))}const p=h.length,f=n-p;s&&f>0&&(h.push(...new Array(f).fill(0)),d.push(...new Array(f).fill(0)));const m={selectedIndices:h};return a&&(m.selectedScores=d),l&&(m.validOutputs=p),m}function cX(t,e,n){const r=t.subarray(4*e,4*e+4),i=t.subarray(4*n,4*n+4),o=Math.min(r[0],r[2]),a=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]),c=Math.min(i[0],i[2]),u=Math.min(i[1],i[3]),h=Math.max(i[0],i[2]),d=Math.max(i[1],i[3]),p=(s-o)*(l-a),f=(h-c)*(d-u);if(p<=0||f<=0)return 0;const m=Math.max(o,c),g=Math.max(a,u),y=Math.min(s,h),v=Math.min(l,d),b=Math.max(y-m,0)*Math.max(v-g,0);return b/(p+f-b)}function uX(t,e,n){const r=Math.exp(e*n*n);return n<=t?r:0}function hX(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}const dX=async function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY;const o=YB(t,"boxes","nonMaxSuppressionAsync"),a=YB(e,"scores","nonMaxSuppressionAsync"),s=eX(o,a,n,r,i);n=s.maxOutputSize,r=s.iouThreshold,i=s.scoreThreshold;const l=await Promise.all([o.data(),a.data()]),c=l[0],u=l[1],{selectedIndices:h}=oX(c,u,n,r,i);return o!==t&&o.dispose(),a!==e&&a.dispose(),lq(h,"int32")};const pX=JB({nonMaxSuppressionWithScore_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;const a=YB(t,"boxes","nonMaxSuppression"),s=YB(e,"scores","nonMaxSuppression"),l=eX(a,s,n,r,i,o);n=l.maxOutputSize,r=l.iouThreshold,i=l.scoreThreshold,o=l.softNmsSigma;const c={boxes:a,scores:s},u={maxOutputSize:n,iouThreshold:r,scoreThreshold:i,softNmsSigma:o},h=BB.runKernel(bF,c,u);return{selectedIndices:h[0],selectedScores:h[1]}}});const fX=async function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;const a=YB(t,"boxes","nonMaxSuppressionAsync"),s=YB(e,"scores","nonMaxSuppressionAsync"),l=eX(a,s,n,r,i,o);n=l.maxOutputSize,r=l.iouThreshold,i=l.scoreThreshold,o=l.softNmsSigma;const c=await Promise.all([a.data(),s.data()]),u=c[0],h=c[1],{selectedIndices:d,selectedScores:p}=sX(u,h,n,r,i,o);return a!==t&&a.dispose(),s!==e&&s.dispose(),{selectedIndices:lq(d,"int32"),selectedScores:lq(p)}};const mX=JB({nonMaxSuppressionPadded_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const a=YB(t,"boxes","nonMaxSuppression"),s=YB(e,"scores","nonMaxSuppression"),l=eX(a,s,n,r,i,null),c={boxes:a,scores:s},u={maxOutputSize:l.maxOutputSize,iouThreshold:l.iouThreshold,scoreThreshold:l.scoreThreshold,padToMaxOutputSize:o},h=BB.runKernel(vF,c,u);return{selectedIndices:h[0],validOutputs:h[1]}}});const gX=async function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const a=YB(t,"boxes","nonMaxSuppressionAsync"),s=YB(e,"scores","nonMaxSuppressionAsync"),l=eX(a,s,n,r,i,null),c=l.maxOutputSize,u=l.iouThreshold,h=l.scoreThreshold,[d,p]=await Promise.all([a.data(),s.data()]),{selectedIndices:f,validOutputs:m}=aX(d,p,c,u,h,o);return a!==t&&a.dispose(),s!==e&&s.dispose(),{selectedIndices:lq(f,"int32"),validOutputs:_j(m,"int32")}};const yX=JB({resizeBilinear_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=YB(t,"images","resizeBilinear");aD(3===i.rank||4===i.rank,(()=>"Error in resizeBilinear: x must be rank 3 or 4, but got "+"rank ".concat(i.rank,"."))),aD(2===e.length,(()=>"Error in resizeBilinear: new shape must 2D, but got shape "+"".concat(e,"."))),aD(!1===r||!1===n,(()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false."));let o=i,a=!1;3===i.rank&&(a=!0,o=rW(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const[]=e,s={images:o},l={alignCorners:n,halfPixelCenters:r,size:e},c=BB.runKernel(DF,s,l);return a?rW(c,[c.shape[1],c.shape[2],c.shape[3]]):c}});const vX=JB({resizeNearestNeighbor_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=YB(t,"images","resizeNearestNeighbor");aD(3===i.rank||4===i.rank,(()=>"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got "+"rank ".concat(i.rank,"."))),aD(2===e.length,(()=>"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+"".concat(e,"."))),aD("float32"===i.dtype||"int32"===i.dtype,(()=>"`images` must have `int32` or `float32` as dtype")),aD(!1===r||!1===n,(()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false."));let o=i,a=!1;3===i.rank&&(a=!0,o=rW(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const[]=e,s={images:o},l={alignCorners:n,halfPixelCenters:r,size:e},c=BB.runKernel(OF,s,l);return a?rW(c,[c.shape[1],c.shape[2],c.shape[3]]):c}});const bX=JB({threshold_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"binary",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;const i=YB(t,"image","threshold"),o=i.shape[0]*i.shape[1];let a,s,l,c,u=gj(lq([r]),255);if(aD(3===i.rank,(()=>"Error in threshold: image must be rank 3,"+"but got rank ".concat(i.rank,"."))),aD(3===i.shape[2]||1===i.shape[2],(()=>"Error in threshold: image color channel must be equal to 3 or 1"+"but got ".concat(i.shape[2],"."))),aD("int32"===i.dtype||"float32"===i.dtype,(()=>"Error in dtype: image dtype must be int32 or float32,"+"but got dtype ".concat(i.dtype,"."))),aD("otsu"===e||"binary"===e,(()=>"Method must be binary or otsu, but was ".concat(e))),3===i.shape[2]){[a,s,l]=tq(i,[1,1,1],-1);const t=gj(a,.2989),e=gj(s,.587),n=gj(l,.114);c=pj(pj(t,e),n)}else c=t;if("otsu"===e){u=function(t,e){let n,r,i,o,a,s,l=lq([-1]),c=lq([0]),u=lq([0]);for(let h=0;h<t.size-1;h++){n=cW(t,0,h+1),r=cW(t,h+1),a=mj(sG(n),e),s=mj(sG(r),e);const d=sG(gj(n,AH(0,n.size)));i=mj(d,sG(n));const p=Aj(r.shape,n.size),f=pj(AH(0,r.size),p),m=gj(r,f);o=mj(sG(m),sG(r));const g=Ij(i,o),y=Ij(i,o),v=gj(a,s);u=gj(gj(v,g),y);const b=vG(u,c);c=GW(b,u,c),l=GW(b,lq([h]),l)}return l}(yW(uj(UH(c),"int32"),tz([]),256),o)}const h=n?MG(c,u):vG(c,u);return uj(gj(h,255),"int32")}});const xX=JB({transform_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"nearest",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"constant",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5?arguments[5]:void 0;const a=YB(t,"image","transform","float32"),s=YB(e,"transforms","transform","float32");aD(4===a.rank,(()=>"Error in transform: image must be rank 4,"+"but got rank ".concat(a.rank,"."))),aD(2===s.rank&&(s.shape[0]===a.shape[0]||1===s.shape[0])&&8===s.shape[1],(()=>"Error in transform: Input transform should be batch x 8 or 1 x 8")),aD(null==o||2===o.length,(()=>"Error in transform: outputShape must be [height, width] or null, "+"but got ".concat(o,".")));const l={image:a,transforms:s},c={interpolation:n,fillMode:r,fillValue:i,outputShape:o};return BB.runKernel(mU,l,c)}});const _X=JB({bandPart_:function(t,e,n){const r=YB(t,"a","bandPart");aD(r.rank>=2,(()=>"bandPart(): Rank must be at least 2, got ".concat(r.rank,".")));const i=r.shape,[o,a]=r.shape.slice(-2);let s,l;"number"===typeof e?(aD(e%1===0,(()=>"bandPart(): numLower must be an integer, got ".concat(e,"."))),aD(e<=o,(()=>"bandPart(): numLower (".concat(e,")")+" must not be greater than the number of rows (".concat(o,")."))),s=YB(e<0?o:e,"numLower","bandPart")):(aD("int32"===e.dtype,(()=>"bandPart(): numLower's dtype must be an int32.")),s=GW(EG(e,0),o,ZG(e,o))),"number"===typeof n?(aD(n%1===0,(()=>"bandPart(): numUpper must be an integer, got ".concat(n,"."))),aD(n<=a,(()=>"bandPart(): numUpper (".concat(n,")")+" must not be greater than the number of columns (".concat(a,")."))),l=YB(n<0?a:n,"numUpper","bandPart")):(aD("int32"===n.dtype,(()=>"bandPart(): numUpper's dtype must be an int32.")),l=GW(EG(n,0),a,ZG(n,a)));const c=rW(AH(0,o,1,"int32"),[-1,1]),u=AH(0,a,1,"int32"),h=Ij(c,u),d=LG(MG(h,s),bG(h,RG(l))),p=XG([o,a],r.dtype);return rW(iq(_q(rW(r,[-1,o,a])).map((t=>GW(d,t,p)))),i)}});const wX=JB({gramSchmidt_:function(t){let e;if(Array.isArray(t)){e=!1,aD(null!=t&&t.length>0,(()=>"Gram-Schmidt process: input must not be null, undefined, or empty"));const n=t[0].shape[0];for(let e=1;e<t.length;++e)aD(t[e].shape[0]===n,(()=>"Gram-Schmidt: Non-unique lengths found in the input vectors: "+"(".concat(t[e].shape[0]," vs. ").concat(n,")")))}else e=!0,t=tq(t,t.shape[0],0).map((t=>rq(t,[0])));aD(t.length<=t[0].shape[0],(()=>"Gram-Schmidt: Number of vectors (".concat(t.length,") exceeds ")+"number of dimensions (".concat(t[0].shape[0],").")));const n=[],r=t;for(let i=0;i<t.length;++i)n.push(BB.tidy((()=>{let t=r[i];if(i>0)for(let e=0;e<i;++e){const r=gj(sG(gj(n[e],t)),n[e]);t=Ij(t,r)}return mj(t,cG(t,"euclidean"))})));return e?iq(n,0):n}});function SX(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return BB.tidy((()=>{aD(2===t.shape.length,(()=>"qr2d() requires a 2D Tensor, but got a ".concat(t.shape.length,"D Tensor.")));const n=t.shape[0],r=t.shape[1];let i=mG(n),o=hj(t);const a=cq([[1]],[1,1]);let s=hj(a);const l=n>=r?r:n;for(let t=0;t<l;++t){const e=o,l=s,c=i;[s,o,i]=BB.tidy((()=>{const e=cW(o,[t,t],[n-t,1]),l=cG(e),c=cW(o,[t,t],[1,1]),u=GW(vG(c,0),cq([[-1]]),cq([[1]])),h=Ij(c,gj(u,l)),d=mj(e,h);s=1===d.shape[0]?hj(a):aW([a,cW(d,[1,0],[d.shape[0]-1,d.shape[1]])],0);const p=RG(mj(sW(u,h),l)),f=cW(o,[t,0],[n-t,r]),m=gj(p,s),g=Cq(s);if(0===t)o=Ij(f,sW(m,sW(g,f)));else{const e=Ij(f,sW(m,sW(g,f)));o=aW([cW(o,[0,0],[t,r]),e],0)}const y=Cq(m),v=cW(i,[0,t],[n,i.shape[1]-t]);if(0===t)i=Ij(v,sW(sW(v,s),y));else{const e=Ij(v,sW(sW(v,s),y));i=aW([cW(i,[0,0],[n,t]),e],1)}return[s,o,i]})),oz([e,l,c])}return!e&&n>r&&(i=cW(i,[0,0],[n,r]),o=cW(o,[0,0],[r,r])),[i,o]}))}const TX=JB({qr_:function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(aD(t.rank>=2,(()=>"qr() requires input tensor to have a rank >= 2, but got rank ".concat(t.rank))),2===t.rank)return SX(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce(((t,e)=>t*e)),r=_q(rW(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),i=[],o=[];r.forEach((t=>{const[n,r]=SX(t,e);i.push(n),o.push(r)}));return[rW(iq(i,0),t.shape),rW(iq(o,0),t.shape)]}}});var EX;!function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(EX||(EX={}));const MX=JB({computeWeightedLoss_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:EX.SUM_BY_NONZERO_WEIGHTS;const r=YB(t,"losses","computeWeightedLoss");let i=null;null!=e&&(i=YB(e,"weights","computeWeightedLoss"));const o=null==i?r:gj(r,i);if(n===EX.NONE)return o;if(n===EX.SUM)return sG(o);if(n===EX.MEAN){if(null==i)return qG(o);{const t=r.size/i.size,e=mj(sG(o),sG(i));return t>1?mj(e,_j(t)):e}}if(n===EX.SUM_BY_NONZERO_WEIGHTS){if(null==i)return mj(sG(o),_j(r.size));{const t=gj(i,YG(r.shape)),e=uj(sG(nH(t,_j(0))),"float32");return mj(sG(o),e)}}throw Error("Unknown reduction: ".concat(n))}});const CX=JB({absoluteDifference_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:EX.SUM_BY_NONZERO_WEIGHTS;const i=YB(t,"labels","absoluteDifference"),o=YB(e,"predictions","absoluteDifference");let a=null;null!=n&&(a=YB(n,"weights","absoluteDifference")),sD(i.shape,o.shape,"Error in absoluteDifference: ");const s=Rj(Ij(i,o));return MX(s,a,r)}});const AX=JB({cosineDistance_:function(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:EX.SUM_BY_NONZERO_WEIGHTS;const o=YB(t,"labels","cosineDistance"),a=YB(e,"predictions","cosineDistance");let s=null;null!=r&&(s=YB(r,"weights","cosineDistance")),sD(o.shape,a.shape,"Error in cosineDistance: ");const l=_j(1),c=Ij(l,sG(gj(o,a),n,!0));return MX(c,s,i)}});const kX=JB({hingeLoss_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:EX.SUM_BY_NONZERO_WEIGHTS,i=YB(t,"labels","hingeLoss");const o=YB(e,"predictions","hingeLoss");let a=null;null!=n&&(a=YB(n,"weights","hingeLoss")),sD(i.shape,o.shape,"Error in hingeLoss: ");const s=_j(1);i=Ij(gj(_j(2),i),s);const l=RH(Ij(s,gj(i,o)));return MX(l,a,r)}});const IX=JB({huberLoss_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:EX.SUM_BY_NONZERO_WEIGHTS;const o=YB(t,"labels","huberLoss"),a=YB(e,"predictions","huberLoss");let s=null;null!=n&&(s=YB(n,"weights","huberLoss")),sD(o.shape,a.shape,"Error in huberLoss: ");const l=_j(r),c=Rj(Ij(a,o)),u=ZG(c,l),h=Ij(c,u),d=pj(gj(_j(.5),vj(u)),gj(l,h));return MX(d,s,i)}});const RX=JB({logLoss_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-7,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:EX.SUM_BY_NONZERO_WEIGHTS;const o=YB(t,"labels","logLoss"),a=YB(e,"predictions","logLoss");let s=null;null!=n&&(s=YB(n,"weights","logLoss")),sD(o.shape,a.shape,"Error in logLoss: ");const l=_j(1),c=_j(r),u=RG(gj(o,kG(pj(a,c)))),h=gj(Ij(l,o),kG(pj(Ij(l,a),c))),d=Ij(u,h);return MX(d,s,i)}});const PX=JB({meanSquaredError_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:EX.SUM_BY_NONZERO_WEIGHTS;const i=YB(t,"labels","meanSquaredError"),o=YB(e,"predictions","meanSquaredError");let a=null;null!=n&&(a=YB(n,"weights","meanSquaredError")),sD(i.shape,o.shape,"Error in meanSquaredError: ");const s=nq(i,o);return MX(s,a,r)}});const NX=JB({sigmoidCrossEntropy_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:EX.SUM_BY_NONZERO_WEIGHTS,o=YB(t,"multiClassLabels","sigmoidCrossEntropy");const a=YB(e,"logits","sigmoidCrossEntropy");let s=null;if(null!=n&&(s=YB(n,"weights","sigmoidCrossEntropy")),sD(o.shape,a.shape,"Error in sigmoidCrossEntropy: "),r>0){const t=_j(r),e=_j(1),n=_j(.5);o=pj(gj(o,Ij(e,t)),gj(n,t))}const l=function(t,e){const n=YB(t,"labels","sigmoidCrossEntropyWithLogits"),r=YB(e,"logits","sigmoidCrossEntropyWithLogits");sD(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");const i=RH(r),o=gj(r,n),a=IG(hG(RG(Rj(r))));return pj(Ij(i,o),a)}(o,a);return MX(l,s,i)}});const OX=JB({softmaxCrossEntropy_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:EX.SUM_BY_NONZERO_WEIGHTS,o=YB(t,"onehotLabels","softmaxCrossEntropy");const a=YB(e,"logits","softmaxCrossEntropy");let s=null;if(null!=n&&(s=YB(n,"weights","softmaxCrossEntropy")),sD(o.shape,a.shape,"Error in softmaxCrossEntropy: "),r>0){const t=_j(r),e=_j(1),n=_j(o.shape[1]);o=pj(gj(o,Ij(e,t)),mj(t,n))}const l=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(-1===n&&(n=e.rank-1),n!==e.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet "+"supported. Labels / logits was rank ".concat(e.rank," ")+"and dim was ".concat(n));const r=xj(((t,e,r)=>{const i=DG(e,[n],!0),o=Ij(uj(e,"float32"),i);r([t,o]);const a=RG(gj(o,t));return{value:sG(a,[n]),gradFunc:(t,e)=>{const[r,i]=e,o=tG(t.shape,[n]);return[gj(rW(t,o),Ij(uj(r,"float32"),hG(i))),gj(rW(t,o),Ij(hG(i),uj(r,"float32")))]}}}));return r(t,e)}(o,a);return MX(l,s,i)}});const DX=JB({sparseFillEmptyRows_:function(t,e,n,r){const i=YB(t,"indices","sparseFillEmptyRows","int32"),o=YB(e,"values","sparseFillEmptyRows"),a=YB(n,"denseShape","sparseFillEmptyRows","int32"),s=YB(r,"defaultValue","sparseFillEmptyRows",o.dtype);if(2!==i.rank)throw new Error("Indices should be Tensor2D but received shape\n        ".concat(i.shape));if(1!==o.rank)throw new Error("Values should be Tensor1D but received shape ".concat(o.shape));if(1!==a.rank)throw new Error("Dense shape should be Tensor1D but received shape ".concat(a.shape));if(0!==s.rank)throw new Error("Default value should be a scalar but received shape ".concat(s.shape));const l={indices:i,values:o,denseShape:a,defaultValue:s},c=BB.runKernel(tU,l);return{outputIndices:c[0],outputValues:c[1],emptyRowIndicator:c[2],reverseIndexMap:c[3]}}});const LX=JB({sparseReshape_:function(t,e,n){const r=YB(t,"inputIndices","sparseReshape","int32"),i=YB(e,"inputShape","sparseReshape","int32"),o=YB(n,"newShape","sparseReshape","int32");if(2!==r.rank)throw new Error("Input indices should be Tensor2D but received shape\n        ".concat(r.shape));if(1!==i.rank)throw new Error("Input shape should be Tensor1D but received shape ".concat(i.shape));if(1!==o.rank)throw new Error("New shape should be Tensor1D but received shape ".concat(o.shape));const a={inputIndices:r,inputShape:i,newShape:o},s=BB.runKernel(eU,a);return{outputIndices:s[0],outputShape:s[1]}}});const FX=JB({sparseSegmentMean_:function(t,e,n){const r=YB(t,"data","sparseSegmentMean"),i=YB(e,"indices","sparseSegmentMean","int32"),o=YB(n,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.rank)throw new Error("Indices should be Tensor1D but received shape\n          ".concat(i.shape));if(1!==o.rank)throw new Error("Segment ids should be Tensor1D but received shape\n          ".concat(o.shape));const a={data:r,indices:i,segmentIds:o};return BB.runKernel(nU,a)}});const UX=JB({sparseSegmentSum_:function(t,e,n){const r=YB(t,"data","sparseSegmentSum"),i=YB(e,"indices","sparseSegmentSum","int32"),o=YB(n,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.rank)throw new Error("Indices should be Tensor1D but received shape\n         ".concat(i.shape));if(1!==o.rank)throw new Error("Segment ids should be Tensor1D but received shape\n         ".concat(o.shape));const a={data:r,indices:i,segmentIds:o};return BB.runKernel(rU,a)}});const BX=JB({stringNGrams_:function(t,e,n,r,i,o,a,s){const l=YB(t,"data","stringNGrams","string");if("string"!==l.dtype)throw new Error("Data must be of datatype string");if(1!==l.shape.length)throw new Error("Data must be a vector, saw: ".concat(l.shape));const c=YB(e,"dataSplits","stringNGrams");if("int32"!==c.dtype)throw new Error("Data splits must be of datatype int32");const u={separator:n,nGramWidths:r,leftPad:i,rightPad:o,padWidth:a,preserveShortSequences:s},h={data:l,dataSplits:c},d=BB.runKernel(lU,h,u);return{nGrams:d[0],nGramsSplits:d[1]}}});const zX={fft:JH,ifft:QH,rfft:eq,irfft:$H},jX={hammingWindow:qq,hannWindow:Xq,frame:Yq,stft:Kq},VX={flipLeftRight:Jq,grayscaleToRGB:Qq,resizeNearestNeighbor:vX,resizeBilinear:yX,rgbToGrayscale:$q,rotateWithOffset:tX,cropAndResize:Zq,nonMaxSuppression:nX,nonMaxSuppressionAsync:dX,nonMaxSuppressionWithScore:pX,nonMaxSuppressionWithScoreAsync:fX,nonMaxSuppressionPadded:mX,nonMaxSuppressionPaddedAsync:gX,threshold:bX,transform:xX},WX={bandPart:_X,gramSchmidt:wX,qr:TX},GX={absoluteDifference:CX,computeWeightedLoss:MX,cosineDistance:AX,hingeLoss:kX,huberLoss:IX,logLoss:RX,meanSquaredError:PX,sigmoidCrossEntropy:NX,softmaxCrossEntropy:OX},HX={sparseFillEmptyRows:DX,sparseReshape:LX,sparseSegmentMean:FX,sparseSegmentSum:UX},qX={stringNGrams:BX,stringSplit:JB({stringSplit_:function(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=YB(t,"input","stringSplit","string"),i=YB(e,"delimiter","stringSplit","string");if(1!==r.rank)throw new Error("Input should be Tensor1D but received shape ".concat(r.shape));if(0!==i.rank)throw new Error("Delimiter should be a scalar but received shape ".concat(i.shape));const o={skipEmpty:n},a={input:r,delimiter:i},s=BB.runKernel(cU,a,o);return{indices:s[0],values:s[1],shape:s[2]}}}),stringToHashBucketFast:JB({stringToHashBucketFast_:function(t,e){const n=YB(t,"input","stringToHashBucketFast","string"),r={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");const i={input:n};return BB.runKernel(uU,i,r)}}),staticRegexReplace:JB({staticRegexReplace_:function(t,e,n){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const i=YB(t,"input","staticRegexReplace","string"),o={pattern:e,rewrite:n,replaceGlobal:r};return BB.runKernel(aU,{x:i},o)}})},XX="undefined"!==typeof requestAnimationFrame?requestAnimationFrame:"undefined"!==typeof setImmediate?setImmediate:t=>t();function YX(t,e){const n=t[0].length;t.forEach(((t,e)=>{aD(t.length===n,(()=>"Error in concat".concat(n,"D: rank of tensors[").concat(e,"] must be the same ")+"as the rank of the rest (".concat(n,")")))})),aD(e>=0&&e<n,(()=>"Error in concat".concat(n,"D: axis must be between 0 and ").concat(n-1,".")));const r=t[0];t.forEach(((t,i)=>{for(let o=0;o<n;o++)aD(o===e||t[o]===r[o],(()=>"Error in concat".concat(n,"D: Shape of tensors[").concat(i,"] (").concat(t,") ")+"does not match the shape of the rest (".concat(r,") ")+"along the non-concatenated axis ".concat(i,".")))}))}function KX(t,e){const n=t[0].slice();for(let r=1;r<t.length;r++)n[e]+=t[r][e];return n}var ZX;function JX(t,e,n){let r=new Array;if(null==n&&null==e)return r;if(null==e)for(;r.length<t+n.length;)r.push(-1);else r=e.slice();if(null==n)return r;if(t+n.length!==r.length)throw new Error("rt input.shape and shape=".concat(e," are incompatible: rt input.rank = ").concat(t+n.length,", but shape.rank = ").concat(r.length));for(let i=1;i<n.length;++i){const o=n[i],a=r[r.length-n.length+i],s=r[a];if(o>=0)if(s>=0){if(s!==o)throw new Error("rt input.shape and shape=".concat(e," are incompatible: rt input.shape[").concat(i+t,"] = ").concat(o," but shape[").concat(i+t,"] = ").concat(s))}else r[a]=o}return r}function QX(t){const e={FIRST_DIM_SIZE:ZX.FIRST_DIM_SIZE,VALUE_ROWIDS:ZX.VALUE_ROWIDS,ROW_LENGTHS:ZX.ROW_LENGTHS,ROW_SPLITS:ZX.ROW_SPLITS,ROW_LIMITS:ZX.ROW_LIMITS,ROW_STARTS:ZX.ROW_STARTS},n=[];for(const r of t){if(!(r in e))break;n.push(e[r])}return n}function $X(t){return 0===t.length?0:t[0]===ZX.FIRST_DIM_SIZE?t.length-1:t.length}function tY(t,e){if(null==t||null==e)return;const n=t.length,r=e.length;if(n>=r)throw new Error("defaultValue.shape=".concat(t," and ragged tensor flatValues.shape=").concat(e,", are incompatible: defaultValue.rank = ").concat(n," must be less than ragged tensor input flatValues.rank = ").concat(r,")"));for(let i=0;i<Math.min(n,r-1);++i){const n=t[i],r=e[i+1];if(n>=0&&r>=0&&1!==n&&n!==r)throw new Error("defaultValue.shape=".concat(t,", and ragged tensor input flatValues.shape=").concat(e," are incompatible: defaultValue.shape[").concat(i-t.length,"] = ").concat(n," but ragged tensor input.flatValues.shape[").concat(i-t.length,"] = ").concat(r))}}!function(t){t[t.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",t[t.VALUE_ROWIDS=1]="VALUE_ROWIDS",t[t.ROW_LENGTHS=2]="ROW_LENGTHS",t[t.ROW_SPLITS=3]="ROW_SPLITS",t[t.ROW_LIMITS=4]="ROW_LIMITS",t[t.ROW_STARTS=5]="ROW_STARTS"}(ZX||(ZX={}));const eY=30;function nY(t){return t<=eY?t:TD(t,Math.floor(Math.sqrt(t)))}function rY(t,e,n){return[n*("number"===typeof t?t:t[0]),e*("number"===typeof t?t:t[1])]}function iY(t,e,n){let r=[];if(!(arguments.length>3&&void 0!==arguments[3])||arguments[3])r=r.concat(e.slice(0)),r.push(t[0]/n),r=r.concat(t.slice(1));else{r=r.concat(t[0]);const n=e.length;for(let i=0;i<n;++i)r=r.concat([t[i+1]/e[i],e[i]]);r=r.concat(t.slice(n+1))}return r}function oY(t,e){const n=[];if(!(arguments.length>2&&void 0!==arguments[2])||arguments[2]){n.push(e);for(let r=e+1;r<t;++r)r<=2*e?(n.push(r),n.push(r-(e+1))):n.push(r)}else{const r=[],i=[];for(let n=1;n<t;++n)n>=2*e+1||n%2===1?i.push(n):r.push(n);n.push(...r),n.push(0),n.push(...i)}return n}function aY(t,e,n){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const i=[];r?i.push(t[0]/n):i.push(t[0]*n);for(let o=1;o<t.length;++o)o<=e.length?r?i.push(e[o-1]*t[o]):i.push(t[o]/e[o-1]):i.push(t[o]);return i}function sY(t,e){const n=[0];for(let r=0;r<e;++r)n.push(t[r][0]);return n}function lY(t,e,n){const r=t.slice(0,1);for(let i=0;i<n;++i)r.push(t[i+1]-e[i][0]-e[i][1]);return r}function cY(t,e){const n=t.shape.length,r=e.shape.length;if(n<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher,"+" but the rank was ".concat(n,"."));if(r<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(r,"."));if("int32"!==e.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type,"+" but the dtype was ".concat(e.dtype,"."));if(e.shape[r-1]>n)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+"".concat(e.shape[r-1]," vs. ").concat(n));if(0===cD(t.shape))throw new Error("Requested more than 0 entries, but input is empty."+" Input shape: ".concat(t.shape,"."));const i=e.shape,o=i[i.length-1];let a=1;for(let h=0;h<i.length-1;++h)a*=i[h];const s=t.shape,l=i.slice();l.pop();let c=1;for(let h=o;h<n;++h)c*=s[h],l.push(s[h]);const u=[...ED(t.shape).map((t=>t/c)),1].slice(0,o);return[l,a,c,u]}const uY=1.7580993408473768,hY=1.0507009873554805,dY=.3275911,pY=.254829592,fY=-.284496736,mY=1.421413741,gY=-1.453152027,yY=1.061405429;function vY(t,e){if(t.length!==e.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+"".concat(t.length,", imag: ").concat(e.length,"."));const n=new Float32Array(2*t.length);for(let r=0;r<n.length;r+=2)n[r]=t[r/2],n[r+1]=e[r/2];return n}function bY(t){const e=new Float32Array(t.length/2),n=new Float32Array(t.length/2);for(let r=0;r<t.length;r+=2)e[r/2]=t[r],n[r/2]=t[r+1];return{real:e,imag:n}}function xY(t){const e=Math.ceil(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let i=0;i<t.length;i+=4)n[Math.floor(i/4)]=t[i],r[Math.floor(i/4)]=t[i+1];return{real:n,imag:r}}function _Y(t){const e=Math.floor(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let i=2;i<t.length;i+=4)n[Math.floor(i/4)]=t[i],r[Math.floor(i/4)]=t[i+1];return{real:n,imag:r}}function wY(t,e){return{real:t[2*e],imag:t[2*e+1]}}function SY(t,e,n,r){t[2*r]=e,t[2*r+1]=n}function TY(t,e){const n=new Float32Array(t/2),r=new Float32Array(t/2);for(let i=0;i<Math.ceil(t/2);i++){const o=(e?2:-2)*Math.PI*(i/t);n[i]=Math.cos(o),r[i]=Math.sin(o)}return{real:n,imag:r}}function EY(t,e,n){const r=(n?2:-2)*Math.PI*(t/e);return{real:Math.cos(r),imag:Math.sin(r)}}const MY="->",CY=/->/g,AY=",",kY="...";function IY(t,e){const n=((t=t.replace(/\s/g,"")).length-t.replace(CY,"").length)/MY.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error('Equation must contain exactly one arrow ("'.concat(MY,'").'));const[r,i]=t.split(MY);aD(-1===r.indexOf(kY),(()=>'The ellipsis notation ("'.concat(kY,'") is not supported yet.')));const o=r.split(AY),a=o.length;if(e!==a)throw new Error("Expected ".concat(a," input tensors, received ").concat(e));if(a>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const s=[];for(let h=0;h<i.length;++h){const t=i[h];if(!o.some((e=>-1!==e.indexOf(t))))throw new Error("Output subscripts contain the label ".concat(t," ")+"not present in the input subscripts.");-1===s.indexOf(t)&&s.push(t)}for(let h=0;h<r.length;++h){const t=r[h];-1===s.indexOf(t)&&t!==AY&&s.push(t)}const l=new Array(o.length);for(let h=0;h<a;++h){if(new Set(o[h].split("")).size!==o[h].length)throw new Error("Found duplicate axes in input component ".concat(o[h],". ")+"Support for duplicate axes in input is not implemented yet.");l[h]=[];for(let t=0;t<o[h].length;++t)l[h].push(s.indexOf(o[h][t]))}const c=s.length,u=[];for(let h=i.length;h<c;++h)u.push(h);return{allDims:s,summedDims:u,idDims:l}}function RY(t,e){let n=new Array(t);n.fill(-1);for(let i=0;i<e.length;++i)n[e[i]]=i;const r=[];for(let i=0;i<t;++i)-1===n[i]&&r.push(i);return n=n.filter((t=>-1!==t)),{permutationIndices:n,expandDims:r}}function PY(t,e,n){const r=new Array(t);for(let i=0;i<n.length;++i){const t=n[i].shape;for(let n=0;n<e[i].length;++n)void 0===r[e[i][n]]?r[e[i][n]]=t[n]:aD(r[e[i][n]]===t[n],(()=>"Expected dimension ".concat(r[e[i][n]]," at axis ").concat(n," ")+"of input shaped ".concat(JSON.stringify(t),", ")+"but got dimension ".concat(t[n])))}}function NY(t,e){const n=t,r=[];let i=0;0===t.length&&n.push(-1),i=t.length+1;for(let a=0;a<i;++a)r.push([]);const o=[];for(let a=0;a<n.length;++a){const t=DY(e,n[a]);for(const e of t)-1===o.indexOf(e)&&(r[a].push(e),o.push(e))}return{path:n,steps:r}}function OY(t){return t.every(((t,e)=>t===e))}function DY(t,e){const n=[];for(let r=0;r<t.length;++r)0!==t[r].length&&-1===t[r].indexOf(e)&&-1!==e||n.push(r);return n}function LY(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=[];if("number"===typeof e)aD(t.shape[n]%e===0,(()=>"Number of splits must evenly divide the axis.")),r=new Array(e).fill(t.shape[n]/e);else{const i=e.reduce(((t,e)=>(-1===e&&(t+=1),t)),0);aD(i<=1,(()=>"There should be only one negative value in split array."));const o=e.indexOf(-1);if(-1!==o){const r=e.reduce(((t,e)=>e>0?t+e:t));e[o]=t.shape[n]-r}aD(t.shape[n]===e.reduce(((t,e)=>t+e)),(()=>"The sum of sizes must match the size of the axis dimension.")),r=e}return r}function FY(t){return"Received SparseTensor with denseShape[0] = 0 but\n  indices.shape[0] = ".concat(t)}function UY(t,e){return"indices(".concat(t,", 0) is invalid: ").concat(e," < 0")}function BY(t,e,n){return"indices(".concat(t,", 0) is invalid: ").concat(e," >= ").concat(n)}function zY(t,e){return"only one output dimension may be -1, not both ".concat(t," and ").concat(e)}function jY(t,e){return"size ".concat(t," must be non-negative, not ").concat(e)}function VY(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function WY(t,e){const n=cD(t),r=cD(e);return"Input to reshape is a SparseTensor with ".concat(n,"\n  dense values, but the requested shape requires a multiple of ").concat(r,". inputShape=").concat(t," outputShape= ").concat(e)}function GY(t,e){const n=cD(t),r=cD(e);return"Input to reshape is a tensor with ".concat(n," dense values, but the requested shape has ").concat(r,". inputShape=").concat(t," outputShape=").concat(e)}function HY(){return"segment ids must be >= 0"}function qY(){return"segment ids are not increasing"}function XY(t,e){return"Segment id ".concat(t," out of range [0, ").concat(e,"), possibly because segmentIds input is not sorted.")}function YY(t,e,n){return"Bad: indices[".concat(t,"] == ").concat(e," out of range [0, ").concat(n,")")}function KY(t,e){let n,r=!1;for(t<=eY?(n=t,r=!0):n=TD(t,Math.floor(Math.sqrt(t)));!r;)n>e||n===t?r=!0:n=TD(t,n+1);return n}function ZY(t,e,n){const r=[],i=t.length;for(let o=0;o<i;o++)o!==e?r.push(t[o]):r.push(n);return r}function JY(t,e,n,r){const i=e.shape.length,o=t.shape.length;if(0!==r&&(r<-i||r>i))throw new Error("Expect batchDims in the range of [-".concat(i,", ").concat(i,"], but got ").concat(r));if(r<0&&(r+=i),r>o)throw new Error("batchDims (".concat(r,") must be less than rank(x) (\n    ").concat(o,")."));if(n<r)throw new Error("batchDims (".concat(r,") must be less than or equal to axis (").concat(n,")."));for(let h=0;h<r;++h)if(t.shape[h]!==e.shape[h])throw new Error("x.shape[".concat(h,"]: ").concat(t.shape[h]," should be equal to indices.shape[").concat(h,"]: ").concat(e.shape[h],"."));const a=t.shape[n],s=[];let l=1,c=1,u=1;for(let h=0;h<r;++h)s.push(t.shape[h]),l*=t.shape[h];for(let h=r;h<n;h++)s.push(t.shape[h]),c*=t.shape[h];for(let h=r;h<i;h++)s.push(e.shape[h]);for(let h=n+1;h<o;h++)s.push(t.shape[h]),u*=t.shape[h];return{batchSize:l,sliceSize:u,outerSize:c,dimSize:a,outputShape:s}}function QY(t){try{return t.map((t=>eB(t)))}catch(t9){throw new Error("Failed to decode encoded string bytes into utf-8, error: ".concat(t9))}}function $Y(t){return t.map((t=>tB(t)))}!function(){for(const t of Fj)Mj(t)}();var tK,eK;FD().registerFlag("KEEP_INTERMEDIATE_TENSORS",(()=>!1),(t=>{t&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")})),function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_QINT16=15]="DT_QINT16",t[t.DT_QUINT16=16]="DT_QUINT16",t[t.DT_UINT16=17]="DT_UINT16",t[t.DT_COMPLEX128=18]="DT_COMPLEX128",t[t.DT_HALF=19]="DT_HALF",t[t.DT_RESOURCE=20]="DT_RESOURCE",t[t.DT_VARIANT=21]="DT_VARIANT",t[t.DT_UINT32=22]="DT_UINT32",t[t.DT_UINT64=23]="DT_UINT64",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",t[t.DT_QINT16_REF=115]="DT_QINT16_REF",t[t.DT_QUINT16_REF=116]="DT_QUINT16_REF",t[t.DT_UINT16_REF=117]="DT_UINT16_REF",t[t.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",t[t.DT_HALF_REF=119]="DT_HALF_REF",t[t.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",t[t.DT_VARIANT_REF=121]="DT_VARIANT_REF",t[t.DT_UINT32_REF=122]="DT_UINT32_REF",t[t.DT_UINT64_REF=123]="DT_UINT64_REF"}(tK||(tK={})),function(t){let e;!function(t){t[t.LEGACY=0]="LEGACY",t[t.V1=1]="V1",t[t.V2=2]="V2"}(e=t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))}(eK||(eK={}));const nK={};function rK(t){return nK[t]}function iK(t,e,n,r,i){const o=e.inputParams[t];if(o&&void 0!==o.inputIndexStart){const t=o.inputIndexStart,a=0===o.inputIndexEnd?void 0:void 0===o.inputIndexEnd?t+1:o.inputIndexEnd,s=t<0?e.inputNames.length+t:t;if("tensor"===o.type)return oK(e.inputNames[s],n,r,i);if("tensors"===o.type){const o=e.inputs.slice(t,a),s=e.inputNames.slice(t,a).filter(((t,e)=>{var n;return"NoOp"!==(null===(n=o[e])||void 0===n?void 0:n.op)}));return s.map((t=>oK(t,n,r,i)))}const l=oK(e.inputNames[s],n,r,i),c=l.dataSync();return"number"===o.type?c[0]:CD(l.shape,c)}const a=e.attrParams[t];return a&&a.value}function oK(t,e,n,r){const[i,o]=cK(t,n);if(null!=r){const t=r.getHashTableHandleByName(i);if(null!=t)return t}const a=n.currentContextIds.find((t=>!!e[lK(i,t)]));return void 0!==a?e[lK(i,a)][o]:void 0}function aK(t,e,n){return e[lK(t,n.currentContextId)]}function sK(t,e){const[n,r,i]=cK(t,e);return[lK(n,e&&e.currentContextId),r,i]}function lK(t,e){return e?"".concat(t,"-").concat(e):t}function cK(t,e){if(""===t)return["",0,void 0];const n=null!=e&&null!=e.parseNodeNameCache;if(n){const n=e.parseNodeNameCache.get(t);if(null!=n)return n}const r=t.split(":");let i;if(1===r.length)i=[t,0,void 0];else{const t=r[0],e=3===r.length?r[1]:void 0;i=[t,Number(r[r.length-1]),e]}return n&&e.parseNodeNameCache.set(t,i),i}function uK(t,e,n){let r=iK("pad",t,e,n);if("explicit"===r){r=iK("explicitPaddings",t,e,n);const i=[[0,0],[0,0],[0,0],[0,0]];for(let t=0;t<4;t++)i[t][0]=r[2*t],i[t][1]=r[2*t+1];return i}return r}function hK(t){return t.kept?t:hj(t)}const dK=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],pK=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],fK=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],mK=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],gK=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],yK=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],vK=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],bK=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],xK=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],_K=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],wK=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}],SK=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}],TK=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}],EK=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],MK=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],CK=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],AK=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],kK=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],IK=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}];class RK{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const t=[].concat(...[s,l,c,u,h,d,p,f,m,g,y,v,b,x,_,w,S,T,E].map((t=>t.json)));this.opMappers=t.reduce(((t,e)=>(t[e.tfOpName]=e,t)),{})}transformGraph(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=t.node,r=[],i=[],o=[],a=n.reduce(((t,e)=>(t[e.name]=this.mapNode(e),e.op.startsWith("Placeholder")?r.push(t[e.name]):"Const"===e.op?i.push(t[e.name]):null!=e.input&&0!==e.input.length||o.push(t[e.name]),t)),{});let s=[];const l=[];let c={},u={};null!=e&&(c=this.mapSignatureEntries(e.inputs),u=this.mapSignatureEntries(e.outputs));const h=Object.keys(a);h.forEach((t=>{const e=a[t];e.inputNames.forEach(((t,n)=>{const[r,,i]=sK(t),o=a[r];if(null!=o.outputs){const t=o.outputs.indexOf(i);if(-1!==t){const i="".concat(r,":").concat(t);e.inputNames[n]=i}}e.inputs.push(o),o.children.push(e)}))})),0===Object.keys(u).length?h.forEach((t=>{const e=a[t];0===e.children.length&&l.push(e)})):Object.keys(u).forEach((t=>{const[e]=sK(t),n=a[e];null!=n&&(n.signatureKey=u[t],l.push(n))})),Object.keys(c).length>0?Object.keys(c).forEach((t=>{const[e]=sK(t),n=a[e];n&&(n.signatureKey=c[t],s.push(n))})):s=r;let d={};null!=t.library&&null!=t.library.function&&(d=t.library.function.reduce(((t,e)=>(t[e.signature.name]=this.mapFunction(e),t)),{}));const p={nodes:a,inputs:s,outputs:l,weights:i,placeholders:r,signature:e,functions:d};return o.length>0&&(p.initNodes=o),p}mapSignatureEntries(t){return Object.keys(t||{}).reduce(((e,n)=>(e[t[n].name]=n,e)),{})}mapNode(t){const e=rK(t.op)||this.opMappers[t.op]||{};null==t.attr&&(t.attr={});const n={name:t.name,op:t.op,category:e.category,inputNames:(t.input||[]).map((t=>t.startsWith("^")?t.slice(1):t)),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:t.attr,outputs:e.outputs};return null!=e.inputs&&(n.inputParams=e.inputs.reduce(((t,e)=>(t[e.name]={type:e.type,inputIndexStart:e.start,inputIndexEnd:e.end},t)),{})),null!=e.attrs&&(n.attrParams=e.attrs.reduce(((e,n)=>{const r=n.type;let i;switch(n.type){case"string":i=NK(t.attr,n.tfName,n.defaultValue),void 0===i&&n.tfDeprecatedName&&(i=NK(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"string[]":i=WK(t.attr,n.tfName,n.defaultValue),void 0===i&&n.tfDeprecatedName&&(i=WK(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"number":i=DK(t.attr,n.tfName,n.defaultValue||0),void 0===i&&n.tfDeprecatedName&&(i=DK(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"number[]":i=VK(t.attr,n.tfName,n.defaultValue),void 0===i&&n.tfDeprecatedName&&(i=VK(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool":i=OK(t.attr,n.tfName,n.defaultValue),void 0===i&&n.tfDeprecatedName&&(i=OK(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool[]":i=HK(t.attr,n.tfName,n.defaultValue),void 0===i&&n.tfDeprecatedName&&(i=HK(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape":i=jK(t.attr,n.tfName,n.defaultValue),void 0===i&&n.tfDeprecatedName&&(i=jK(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape[]":i=GK(t.attr,n.tfName,n.defaultValue),void 0===i&&n.tfDeprecatedName&&(i=GK(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype":i=UK(t.attr,n.tfName,n.defaultValue),void 0===i&&n.tfDeprecatedName&&(i=UK(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype[]":i=BK(t.attr,n.tfName,n.defaultValue),void 0===i&&n.tfDeprecatedName&&(i=BK(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"func":i=FK(t.attr,n.tfName,n.defaultValue),void 0===i&&n.tfDeprecatedName&&(i=FK(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error("Unsupported param type: ".concat(n.type," for op: ").concat(t.op))}return e[n.name]={value:i,type:r},e}),{})),n}mapFunction(t){const e=t.nodeDef,n=[];let r={};null!=e&&(r=e.reduce(((t,e)=>(t[e.name]=this.mapNode(e),"Const"===e.op&&n.push(t[e.name]),t)),{}));const i=[],o=[];t.signature.inputArg.forEach((t=>{const[e]=sK(t.name),n={name:e,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:LK(t.type),type:"dtype"}},children:[]};n.signatureKey=t.name,i.push(n),r[e]=n}));Object.keys(r).forEach((t=>{const e=r[t];e.inputNames.forEach(((t,n)=>{const[i,,o]=sK(t),a=r[i];if(null!=a.outputs){const t=a.outputs.indexOf(o);if(-1!==t){const r="".concat(i,":").concat(t);e.inputNames[n]=r}}e.inputs.push(a),a.children.push(e)}))}));const a=t.ret;t.signature.outputArg.forEach((t=>{const[e,n]=sK(a[t.name]),i=r[e];null!=i&&(i.defaultOutput=n,o.push(i))}));const s=this.mapArgsToSignature(t);return{nodes:r,inputs:i,outputs:o,weights:n,placeholders:[],signature:s}}mapArgsToSignature(t){return{methodName:t.signature.name,inputs:t.signature.inputArg.reduce(((t,e)=>(t[e.name]=this.mapArgToTensorInfo(e),t)),{}),outputs:t.signature.outputArg.reduce(((e,n)=>(e[n.name]=this.mapArgToTensorInfo(n,t.ret),e)),{})}}mapArgToTensorInfo(t,e){let n=t.name;return null!=e&&(n=e[n]),{name:n,dtype:t.type}}}function PK(t,e){const n=Array.isArray(t)?String.fromCharCode.apply(null,t):function(t){const e=FD().global;if("undefined"!==typeof e.atob)return e.atob(t);if("undefined"!==typeof Buffer)return new Buffer(t,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}(t);return e?n:n.toLowerCase()}function NK(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=t[e];return null!=i?PK(i.s,r):n}function OK(t,e,n){const r=t[e];return r?r.b:n}function DK(t,e,n){const r=t[e]||{},i=null!=r.i?r.i:null!=r.f?r.f:n;return"number"===typeof i?i:parseInt(i,10)}function LK(t){switch("string"===typeof t&&(t=tK[t]),t){case tK.DT_FLOAT:case tK.DT_HALF:return"float32";case tK.DT_INT32:case tK.DT_INT64:case tK.DT_INT8:case tK.DT_UINT8:return"int32";case tK.DT_BOOL:return"bool";case tK.DT_DOUBLE:return"float32";case tK.DT_STRING:return"string";case tK.DT_COMPLEX64:case tK.DT_COMPLEX128:return"complex64";default:return null}}function FK(t,e,n){const r=t[e];return r&&r.func?r.func.name:n}function UK(t,e,n){const r=t[e];return r&&r.type?LK(r.type):n}function BK(t,e,n){const r=t[e];return r&&r.list&&r.list.type?r.list.type.map((t=>LK(t))):n}function zK(t){if(!t.unknownRank)return null!=t.dim?t.dim.map((t=>"number"===typeof t.size?t.size:parseInt(t.size,10))):[]}function jK(t,e,n){const r=t[e];return r&&r.shape?zK(r.shape):n}function VK(t,e,n){const r=t[e];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map((t=>"number"===typeof t?t:parseInt(t,10))):n}function WK(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=t[e];return i&&i.list&&i.list.s?i.list.s.map((t=>PK(t,r))):n}function GK(t,e,n){const r=t[e];return r&&r.list&&r.list.shape?r.list.shape.map((t=>zK(t))):n}function HK(t,e,n){const r=t[e];return r&&r.list&&r.list.b?r.list.b:n}class qK{constructor(t,e,n){this.node=t,this.tensorMap=e,this.context=n,this.inputs=[],this.attrs={},this.inputs=t.inputNames.map((t=>this.getInput(t))),null!=t.rawAttrs&&(this.attrs=Object.keys(t.rawAttrs).reduce(((t,e)=>(t[e]=this.getAttr(e),t)),{}))}getInput(t){return oK(t,this.tensorMap,this.context)}getAttr(t,e){const n=this.node.rawAttrs[t];if(null!=n.tensor)return oK(t,this.tensorMap,this.context);if(null!=n.i||null!=n.f)return DK(this.node.rawAttrs,t,e);if(null!=n.s)return NK(this.node.rawAttrs,t,e);if(null!=n.b)return OK(this.node.rawAttrs,t,e);if(null!=n.shape)return jK(this.node.rawAttrs,t,e);if(null!=n.type)return UK(this.node.rawAttrs,t,e);if(null!=n.list){if(null!=n.list.i||null!=n.list.f)return VK(this.node.rawAttrs,t,e);if(null!=n.list.s)return WK(this.node.rawAttrs,t,e);if(null!=n.list.shape)return GK(this.node.rawAttrs,t,e);if(null!=n.list.b)return HK(this.node.rawAttrs,t,e);if(null!=n.list.type)return BK(this.node.rawAttrs,t,e)}return e}}function XK(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if("number"!==typeof t&&"number"!==typeof e){aD(t.length===e.length,(()=>n+" Shapes ".concat(t," and ").concat(e," must match")));for(let r=0;r<t.length;r++){const i=t[r],o=e[r];aD(i<0||o<0||i===o,(()=>n+" Shapes ".concat(t," and ").concat(e," must match")))}}}function YK(t){return"number"!==typeof t&&!t.some((t=>t<0))}function KK(t,e,n){let r=ZK(t,n);const i=!YK(r);if(i&&0===e.length)throw new Error("Tried to calculate elements of an empty list"+" with non-fully-defined elementShape: ".concat(r));if(i&&e.forEach((t=>{r=ZK(t.shape,r)})),!YK(r))throw new Error("Non-fully-defined elementShape: ".concat(r));return r}function ZK(t,e){if("number"===typeof t)return e;if("number"===typeof e)return t;if(t.length!==e.length)throw new Error("Incompatible ranks during merge: ".concat(t," vs. ").concat(e));const n=[];for(let r=0;r<t.length;++r){const i=t[r],o=e[r];if(i>=0&&o>=0&&i!==o)throw new Error("Incompatible shape during merge: ".concat(t," vs. ").concat(e));n[r]=i>=0?i:o}return n}class JK{constructor(t,e,n,r,i,o,a){this.name=t,this.dtype=e,this.maxSize=n,this.elementShape=r,this.identicalElementShapes=i,this.dynamicSize=o,this.clearAfterRead=a,this.tensors=[],this.closed_=!1,this.idTensor=_j(0),az(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(t){this.tensors.forEach((e=>{null!=t&&t.has(e.tensor.id)||e.tensor.dispose()})),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(t){if(this.closed_)throw new Error("TensorArray ".concat(this.name," has already been closed."));if(t<0||t>=this.size())throw new Error("Tried to read from index ".concat(t,", but array size is: ").concat(this.size()));const e=this.tensors[t];if(e.cleared)throw new Error("TensorArray ".concat(this.name,": Could not read index ").concat(t," twice because it was cleared after a previous read ")+"(perhaps try setting clear_after_read = false?).");return this.clearAfterRead&&(e.cleared=!0),e.read=!0,e.tensor}readMany(t){return t.map((t=>this.read(t)))}write(t,e){if(this.closed_)throw new Error("TensorArray ".concat(this.name," has already been closed."));if(t<0||!this.dynamicSize&&t>=this.maxSize)throw new Error("Tried to write to index ".concat(t,", but array is not resizeable and size is: ").concat(this.maxSize));const n=this.tensors[t]||{};if(e.dtype!==this.dtype)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(t,",\n          because the value dtype is ").concat(e.dtype,", but TensorArray dtype is ").concat(this.dtype,"."));if(0!==this.size()||null!=this.elementShape&&0!==this.elementShape.length||(this.elementShape=e.shape),XK(this.elementShape,e.shape,"TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(t,".")),n.read)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(t,", because it has already been read."));if(n.written)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(t,", because it has already been written."));n.tensor=e,az(e),n.written=!0,this.tensors[t]=n}writeMany(t,e){if(t.length!==e.length)throw new Error("TensorArray ".concat(this.name,": could not write multiple tensors,")+"because the index size: ".concat(t.length," is not the same as tensors size: ").concat(e.length,"."));t.forEach(((t,n)=>this.write(t,e[n])))}gather(t,e){if(e&&e!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but gather requested dtype ").concat(e));if(t)t=t.slice(0,this.size());else{t=[];for(let e=0;e<this.size();e++)t.push(e)}if(0===t.length)return tz([],[0].concat(this.elementShape));const n=this.readMany(t);return XK(this.elementShape,n[0].shape,"TensorArray shape mismatch: "),iq(n,0)}concat(t){if(t&&t!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but concat requested dtype ").concat(t));if(0===this.size())return tz([],[0].concat(this.elementShape));const e=[];for(let r=0;r<this.size();r++)e.push(r);const n=this.readMany(e);return XK(this.elementShape,n[0].shape,"TensorArray shape mismatch: tensor array shape (".concat(this.elementShape,") vs first tensor shape (").concat(n[0].shape,")")),aW(n,0)}scatter(t,e){if(e.dtype!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but tensor has dtype ").concat(e.dtype));if(t.length!==e.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: ".concat(t.length," vs. ").concat(e.shape[0]));const n=Math.max(...t);if(!this.dynamicSize&&n>=this.maxSize)throw new Error("Max index must be < array size (".concat(n,"  vs. ").concat(this.maxSize,")"));this.writeMany(t,_q(e,0))}split(t,e){if(e.dtype!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but tensor has dtype ").concat(e.dtype));let n=0;const r=t.map((t=>(n+=t,n)));if(n!==e.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ".concat(n,", and tensor's shape is: ").concat(e.shape));if(!this.dynamicSize&&t.length!==this.maxSize)throw new Error("TensorArray's size is not equal to the size of lengths (".concat(this.maxSize," vs. ").concat(t.length,"), ")+"and the TensorArray is not marked as dynamically resizeable");const i=0===n?0:e.size/n,o=[];iz((()=>{e=rW(e,[1,n,i]);for(let n=0;n<t.length;++n){const a=[0,0===n?0:r[n-1],0],s=[1,t[n],i];o[n]=rW(cW(e,a,s),this.elementShape)}return o}));const a=[];for(let s=0;s<t.length;s++)a[s]=s;this.writeMany(a,o)}}class QK{get id(){return this.idTensor.id}constructor(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;this.tensors=t,this.elementShape=e,this.elementDtype=n,null!=t&&t.forEach((t=>{if(n!==t.dtype)throw new Error("Invalid data types; op elements ".concat(n,", but list elements ").concat(t.dtype));XK(e,t.shape,"TensorList shape mismatch: "),az(t)})),this.idTensor=_j(0),this.maxNumElements=r,az(this.idTensor)}copy(){return new QK([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(t){this.tensors.forEach((e=>{null!=t&&t.has(e.id)||e.dispose()})),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(e!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(e,", but list elements ").concat(this.elementDtype));if(-1!==n&&this.tensors.length!==n)throw new Error("Operation expected a list with ".concat(n," elements but got a list with ").concat(this.tensors.length," elements."));XK(t,this.elementShape,"TensorList shape mismatch: ");const r=KK(this.elementShape,this.tensors,t);return iz((()=>{const t=this.tensors.map((t=>rW(t,r)));return iq(t,0)}))}popBack(t,e){if(e!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(e,", but list elements ").concat(this.elementDtype));if(0===this.size())throw new Error("Trying to pop from an empty list.");const n=KK(this.elementShape,this.tensors,t),r=this.tensors.pop();return r.kept=!1,XK(r.shape,t,"TensorList shape mismatch: "),rW(r,n)}pushBack(t){if(t.dtype!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t.dtype,", but list elements ").concat(this.elementDtype));if(XK(t.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");az(t),this.tensors.push(t)}resize(t){if(t<0)throw new Error("TensorListResize expects size to be non-negative. Got: ".concat(t));if(-1!==this.maxNumElements&&t>this.maxNumElements)throw new Error("TensorListResize input size ".concat(t," is greater maxNumElement ").concat(this.maxNumElements,"."));const e=new QK([],this.elementShape,this.elementDtype,this.maxNumElements);e.tensors.length=t;for(let n=0;n<Math.min(this.tensors.length,t);++n)e.tensors[n]=this.tensors[n];return e}getItem(t,e,n){if(n!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(n,", but list elements ").concat(this.elementDtype));if(t<0||t>this.tensors.length)throw new Error("Trying to access element ".concat(t," in a list with ").concat(this.tensors.length," elements."));if(null==this.tensors[t])throw new Error("element at index ".concat(t," is null."));XK(this.tensors[t].shape,e,"TensorList shape mismatch: ");const r=KK(this.elementShape,this.tensors,e);return rW(this.tensors[t],r)}setItem(t,e){if(e.dtype!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(e.dtype,", but list elements ").concat(this.elementDtype));if(t<0||-1!==this.maxNumElements&&t>=this.maxNumElements)throw new Error("Trying to set element ".concat(t," in a list with max ").concat(this.maxNumElements," elements."));XK(this.elementShape,e.shape,"TensorList shape mismatch: "),az(e),null!=this.tensors[t]&&(this.tensors[t].kept=!1),this.tensors[t]=e}gather(t,e,n){if(e!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(e,", but list elements ").concat(this.elementDtype));XK(this.elementShape,n,"TensorList shape mismatch: "),t=t.slice(0,this.size());const r=KK(this.elementShape,this.tensors,n);return 0===t.length?tz([],[0].concat(r)):iz((()=>{const e=t.map((t=>rW(this.tensors[t],r)));return iq(e,0)}))}concat(t,e){if(t&&t!==this.elementDtype)throw new Error("TensorList dtype is ".concat(this.elementDtype," but concat requested dtype ").concat(t));XK(this.elementShape,e,"TensorList shape mismatch: ");const n=KK(this.elementShape,this.tensors,e);return 0===this.size()?tz([],[0].concat(n)):iz((()=>{const t=this.tensors.map((t=>rW(t,n)));return aW(t,0)}))}}const $K=async(t,e,n)=>{switch(t.op){case"If":case"StatelessIf":{const r=iK("thenBranch",t,e,n),i=iK("elseBranch",t,e,n),o=iK("cond",t,e,n),a=iK("args",t,e,n);return(await o.data())[0]?n.functionMap[r].executeFunctionAsync(a,n.tensorArrayMap,n.tensorListMap):n.functionMap[i].executeFunctionAsync(a,n.tensorArrayMap,n.tensorListMap)}case"While":case"StatelessWhile":{const r=iK("body",t,e,n),i=iK("cond",t,e,n),o=iK("args",t,e,n),a=await n.functionMap[i].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap),s=o.map((t=>t.id));let l=await a[0].data();a.forEach((t=>{t.kept||-1!==s.indexOf(t.id)||t.dispose()}));let c=o;for(;l[0];){const t=c;c=await n.functionMap[r].executeFunctionAsync(c,n.tensorArrayMap,n.tensorListMap);const e=c.map((t=>t.id));t.forEach((t=>{t.kept||-1!==s.indexOf(t.id)||-1!==e.indexOf(t.id)||t.dispose()}));const o=await n.functionMap[i].executeFunctionAsync(c,n.tensorArrayMap,n.tensorListMap);l=await o[0].data(),o.forEach((t=>{t.kept||-1!==s.indexOf(t.id)||-1!==e.indexOf(t.id)||t.dispose()}))}return c}case"LoopCond":return[hK(iK("pred",t,e,n))];case"Switch":{const r=iK("pred",t,e,n);let i=iK("data",t,e,n);return i.kept||(i=hK(i)),(await r.data())[0]?[void 0,i]:[i,void 0]}case"Merge":{const r=t.inputNames.find((t=>void 0!==oK(t,e,n)));if(r){return[hK(oK(r,e,n))]}return}case"Enter":{const r=iK("frameName",t,e,n),i=iK("tensor",t,e,n);return n.enterFrame(r),[hK(i)]}case"Exit":{const r=iK("tensor",t,e,n);return n.exitFrame(),[hK(r)]}case"NextIteration":{const r=iK("tensor",t,e,n);return n.nextIteration(),[hK(r)]}case"TensorArrayV3":{const r=iK("size",t,e,n),i=iK("dtype",t,e,n),o=iK("elementShape",t,e,n),a=iK("dynamicSize",t,e,n),s=iK("clearAfterRead",t,e,n),l=iK("identicalElementShapes",t,e,n),c=iK("name",t,e,n),u=new JK(c,i,r,o,l,a,s);return n.addTensorArray(u),[u.idTensor,_j(1)]}case"TensorArrayWriteV3":{const r=iK("tensorArrayId",t,e,n),i=iK("index",t,e,n),o=iK("tensor",t,e,n),a=n.getTensorArray(r.id);return a.write(i,o),[a.idTensor]}case"TensorArrayReadV3":{const r=iK("tensorArrayId",t,e,n),i=iK("index",t,e,n);return[n.getTensorArray(r.id).read(i)]}case"TensorArrayGatherV3":{const r=iK("tensorArrayId",t,e,n),i=iK("indices",t,e,n),o=iK("dtype",t,e,n);return[n.getTensorArray(r.id).gather(i,o)]}case"TensorArrayScatterV3":{const r=iK("tensorArrayId",t,e,n),i=iK("indices",t,e,n),o=iK("tensor",t,e,n),a=n.getTensorArray(r.id);return a.scatter(i,o),[a.idTensor]}case"TensorArrayConcatV3":{const r=iK("tensorArrayId",t,e,n),i=n.getTensorArray(r.id),o=iK("dtype",t,e,n);return[i.concat(o)]}case"TensorArraySplitV3":{const r=iK("tensorArrayId",t,e,n),i=iK("tensor",t,e,n),o=iK("lengths",t,e,n),a=n.getTensorArray(r.id);return a.split(o,i),[a.idTensor]}case"TensorArraySizeV3":{const r=iK("tensorArrayId",t,e,n);return[_j(n.getTensorArray(r.id).size(),"int32")]}case"TensorArrayCloseV3":{const r=iK("tensorArrayId",t,e,n),i=n.getTensorArray(r.id);return i.clearAndClose(),[i.idTensor]}case"TensorListSetItem":{const r=iK("tensorListId",t,e,n),i=iK("index",t,e,n),o=iK("tensor",t,e,n),a=n.getTensorList(r.id);return a.setItem(i,o),[a.idTensor]}case"TensorListGetItem":{const r=iK("tensorListId",t,e,n),i=iK("index",t,e,n),o=iK("elementShape",t,e,n),a=iK("elementDType",t,e,n);return[n.getTensorList(r.id).getItem(i,o,a)]}case"TensorListScatterV2":case"TensorListScatter":{const r=iK("indices",t,e,n),i=function(t,e,n,r){if(e.length!==t.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: ".concat(e.length," vs. ").concat(t.shape[0]));const i=Math.max(...e);if(null!=r&&-1!==r&&i>=r)throw new Error("Max index must be < array size (".concat(i,"  vs. ").concat(r,")"));const o=new QK([],n,t.dtype,r),a=_q(t,0);return e.forEach(((t,e)=>{o.setItem(t,a[e])})),o}(iK("tensor",t,e,n),r,iK("elementShape",t,e,n),iK("numElements",t,e,n));return n.addTensorList(i),[i.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const r=iK("elementShape",t,e,n),i=iK("elementDType",t,e,n);let o;o="TensorListReserve"===t.op?"numElements":"maxNumElements";const a=iK(o,t,e,n),s=function(t,e,n,r){return new QK([],t,e,r)}(r,i,0,"TensorListReserve"===t.op?-1:a);return n.addTensorList(s),[s.idTensor]}case"TensorListGather":{const r=iK("tensorListId",t,e,n),i=iK("indices",t,e,n),o=iK("elementShape",t,e,n),a=iK("elementDType",t,e,n);return[n.getTensorList(r.id).gather(i,a,o)]}case"TensorListStack":{const r=iK("tensorListId",t,e,n),i=iK("elementShape",t,e,n),o=iK("elementDType",t,e,n),a=iK("numElements",t,e,n);return[n.getTensorList(r.id).stack(i,o,a)]}case"TensorListFromTensor":{const r=function(t,e,n){const r=t.dtype;if(t.shape.length<1)throw new Error("Tensor must be at least a vector, but saw shape: ".concat(t.shape));if(t.dtype!==n)throw new Error("Invalid data types; op elements ".concat(t.dtype,", but list elements ").concat(n));XK(t.shape.slice(1),e,"TensorList shape mismatch: ");const i=_q(t);return new QK(i,e,r)}(iK("tensor",t,e,n),iK("elementShape",t,e,n),iK("elementDType",t,e,n));return n.addTensorList(r),[r.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const r=iK("tensorListId",t,e,n),i=n.getTensorList(r.id),o=iK("dtype",t,e,n),a=iK("elementShape",t,e,n);return[i.concat(o,a)]}case"TensorListPushBack":{const r=iK("tensorListId",t,e,n),i=iK("tensor",t,e,n),o=n.getTensorList(r.id);return o.pushBack(i),[o.idTensor]}case"TensorListPopBack":{const r=iK("tensorListId",t,e,n),i=iK("elementShape",t,e,n),o=iK("elementDType",t,e,n);return[n.getTensorList(r.id).popBack(i,o)]}case"TensorListSplit":{const r=iK("tensor",t,e,n),i=iK("elementShape",t,e,n),o=function(t,e,n){let r=0;const i=e.map((t=>(r+=t,r)));if(r!==t.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ".concat(r,", and tensor's shape is: ").concat(t.shape));const o=ZK(t.shape.slice(1),n),a=0===r?0:t.size/r,s=iz((()=>{const n=[];t=rW(t,[1,r,a]);for(let r=0;r<e.length;++r){const s=[0,0===r?0:i[r-1],0],l=[1,e[r],a];n[r]=rW(cW(t,s,l),o)}return t.dispose(),n})),l=new QK([],n,t.dtype,e.length);for(let c=0;c<s.length;c++)l.setItem(c,s[c]);return l}(r,iK("lengths",t,e,n),i);return n.addTensorList(o),[o.idTensor]}case"TensorListLength":{const r=iK("tensorListId",t,e,n);return[_j(n.getTensorList(r.id).size(),"int32")]}case"TensorListResize":{const r=iK("tensorListId",t,e,n),i=iK("size",t,e,n),o=n.getTensorList(r.id).resize(i);return n.addTensorList(o),[o.idTensor]}default:throw TypeError("Node type ".concat(t.op," is not implemented"))}};function tZ(t,e,n){const[r,i]=iK("fusedOps",t,e,n),o="biasadd"===r,a=!o,s="prelu"===i,l="fusedbatchnorm"===r,c=iK("numArgs",t,e,n);if(o){if(s&&2!==c)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!s&&o&&1!==c)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(l)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const u=iK("strides",t,e,n),h=uK(t,e,n),d=iK("dataFormat",t,e,n).toUpperCase(),p=iK("dilations",t,e,n);let[f,m]=iK("args",t,e,n);a&&(m=f,f=void 0);return{stride:u,pad:h,dataFormat:d,dilations:p,biasArg:f,preluArg:m,activationFunc:i,leakyreluAlpha:iK("leakyreluAlpha",t,e,n)}}function eZ(t,e,n){return{boxes:iK("boxes",t,e,n),scores:iK("scores",t,e,n),maxOutputSize:iK("maxOutputSize",t,e,n),iouThreshold:iK("iouThreshold",t,e,n),scoreThreshold:iK("scoreThreshold",t,e,n),softNmsSigma:iK("softNmsSigma",t,e,n)}}class nZ{get id(){return this.handle.id}constructor(t,e){this.keyDType=t,this.valueDType=e,this.handle=_j(0),this.tensorMap=new Map,az(this.handle)}clearAndClose(){this.tensorMap.forEach((t=>t.dispose())),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return _j(this.size(),"int32")}async import(t,e){this.checkKeyAndValueTensor(t,e);const n=await t.data();return this.tensorMap.forEach((t=>t.dispose())),this.tensorMap.clear(),iz((()=>{const t=_q(e),r=n.length,i=t.length;aD(r===i,(()=>"The number of elements doesn't match, keys has "+"".concat(r," elements, the values has ").concat(i," ")+"elements."));for(let e=0;e<r;e++){const r=n[e],i=t[e];az(i),this.tensorMap.set(r,i)}return this.handle}))}async find(t,e){this.checkKeyAndValueTensor(t,e);const n=await t.data();return iz((()=>{const t=[];for(let r=0;r<n.length;r++){const i=n[r],o=this.findWithDefault(i,e);t.push(o)}return iq(t)}))}findWithDefault(t,e){const n=this.tensorMap.get(t);return null!=n?n:e}checkKeyAndValueTensor(t,e){if(t.dtype!==this.keyDType)throw new Error("Expect key dtype ".concat(this.keyDType,", but got ")+"".concat(t.dtype));if(e.dtype!==this.valueDType)throw new Error("Expect value dtype ".concat(this.valueDType,", but got ")+"".concat(e.dtype))}}function rZ(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:iz;const o=((t,e,n)=>{switch(t.category){case"arithmetic":return i((()=>function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;switch(t.op){case"BiasAdd":case"AddV2":case"Add":return[r.add(iK("a",t,e,n),iK("b",t,e,n))];case"AddN":return[r.addN(iK("tensors",t,e,n))];case"FloorMod":case"Mod":return[r.mod(iK("a",t,e,n),iK("b",t,e,n))];case"Mul":return[r.mul(iK("a",t,e,n),iK("b",t,e,n))];case"RealDiv":case"Div":return[r.div(iK("a",t,e,n),iK("b",t,e,n))];case"DivNoNan":return[r.divNoNan(iK("a",t,e,n),iK("b",t,e,n))];case"FloorDiv":return[r.floorDiv(iK("a",t,e,n),iK("b",t,e,n))];case"Sub":return[r.sub(iK("a",t,e,n),iK("b",t,e,n))];case"Minimum":return[r.minimum(iK("a",t,e,n),iK("b",t,e,n))];case"Maximum":return[r.maximum(iK("a",t,e,n),iK("b",t,e,n))];case"Pow":return[r.pow(iK("a",t,e,n),iK("b",t,e,n))];case"SquaredDifference":return[r.squaredDifference(iK("a",t,e,n),iK("b",t,e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n)));case"basic_math":return i((()=>function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;switch(t.op){case"Abs":case"ComplexAbs":return[r.abs(iK("x",t,e,n))];case"Acos":return[r.acos(iK("x",t,e,n))];case"Acosh":return[r.acosh(iK("x",t,e,n))];case"Asin":return[r.asin(iK("x",t,e,n))];case"Asinh":return[r.asinh(iK("x",t,e,n))];case"Atan":return[r.atan(iK("x",t,e,n))];case"Atan2":return[r.atan2(iK("x",t,e,n),iK("y",t,e,n))];case"Atanh":return[r.atanh(iK("x",t,e,n))];case"Ceil":return[r.ceil(iK("x",t,e,n))];case"Complex":return[r.complex(iK("real",t,e,n),iK("imag",t,e,n))];case"Cos":return[r.cos(iK("x",t,e,n))];case"Cosh":return[r.cosh(iK("x",t,e,n))];case"Elu":return[r.elu(iK("x",t,e,n))];case"Erf":return[r.erf(iK("x",t,e,n))];case"Exp":return[r.exp(iK("x",t,e,n))];case"Expm1":return[r.expm1(iK("x",t,e,n))];case"Floor":return[r.floor(iK("x",t,e,n))];case"Log":return[r.log(iK("x",t,e,n))];case"Log1p":return[r.log1p(iK("x",t,e,n))];case"Imag":return[r.imag(iK("x",t,e,n))];case"Neg":return[r.neg(iK("x",t,e,n))];case"Reciprocal":return[r.reciprocal(iK("x",t,e,n))];case"Real":return[r.real(iK("x",t,e,n))];case"Relu":return[r.relu(iK("x",t,e,n))];case"Round":return[r.round(iK("x",t,e,n))];case"Selu":return[r.selu(iK("x",t,e,n))];case"Sigmoid":return[r.sigmoid(iK("x",t,e,n))];case"Sin":return[r.sin(iK("x",t,e,n))];case"Sign":return[r.sign(iK("x",t,e,n))];case"Sinh":return[r.sinh(iK("x",t,e,n))];case"Softplus":return[r.softplus(iK("x",t,e,n))];case"Sqrt":return[r.sqrt(iK("x",t,e,n))];case"Square":return[r.square(iK("x",t,e,n))];case"Tanh":return[r.tanh(iK("x",t,e,n))];case"Tan":return[r.tan(iK("x",t,e,n))];case"ClipByValue":return[r.clipByValue(iK("x",t,e,n),iK("clipValueMin",t,e,n),iK("clipValueMax",t,e,n))];case"Relu6":return[r.relu6(iK("x",t,e,n))];case"Rsqrt":return[r.rsqrt(oK(t.inputNames[0],e,n))];case"LeakyRelu":return[r.leakyRelu(iK("x",t,e,n),iK("alpha",t,e,n))];case"Prelu":return[r.prelu(iK("x",t,e,n),iK("alpha",t,e,n))];case"IsNan":return[r.isNaN(oK(t.inputNames[0],e,n))];case"IsInf":return[r.isInf(oK(t.inputNames[0],e,n))];case"IsFinite":return[r.isFinite(oK(t.inputNames[0],e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n)));case"control":return $K(t,e,n);case"convolution":return i((()=>function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;switch(t.op){case"Conv1D":{const i=iK("stride",t,e,n),o=iK("pad",t,e,n),a=iK("dataFormat",t,e,n).toUpperCase(),s=iK("dilation",t,e,n);return[r.conv1d(iK("x",t,e,n),iK("filter",t,e,n),i,o,a,s)]}case"Conv2D":{const i=iK("strides",t,e,n),o=uK(t,e,n),a=iK("dataFormat",t,e,n).toUpperCase(),s=iK("dilations",t,e,n);return[r.conv2d(iK("x",t,e,n),iK("filter",t,e,n),[i[1],i[2]],o,a,[s[1],s[2]])]}case"_FusedConv2D":{const{stride:i,pad:o,dataFormat:a,dilations:s,biasArg:l,preluArg:c,activationFunc:u,leakyreluAlpha:h}=tZ(t,e,n);return[r.fused.conv2d({x:iK("x",t,e,n),filter:iK("filter",t,e,n),strides:[i[1],i[2]],pad:o,dataFormat:a,dilations:[s[1],s[2]],bias:l,activation:u,preluActivationWeights:c,leakyreluAlpha:h})]}case"FusedDepthwiseConv2dNative":{const{stride:i,pad:o,dataFormat:a,dilations:s,biasArg:l,preluArg:c,activationFunc:u,leakyreluAlpha:h}=tZ(t,e,n);return[r.fused.depthwiseConv2d({x:iK("x",t,e,n),filter:iK("filter",t,e,n),strides:[i[1],i[2]],pad:o,dataFormat:a,dilations:[s[1],s[2]],bias:l,activation:u,preluActivationWeights:c,leakyreluAlpha:h})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const i=iK("outputShape",t,e,n),o=iK("strides",t,e,n),a=uK(t,e,n);return[r.conv2dTranspose(iK("x",t,e,n),iK("filter",t,e,n),i,[o[1],o[2]],a)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const i=iK("strides",t,e,n),o=uK(t,e,n),a=iK("dilations",t,e,n),s=iK("dataFormat",t,e,n).toUpperCase();return[r.depthwiseConv2d(iK("input",t,e,n),iK("filter",t,e,n),[i[1],i[2]],o,s,[a[1],a[2]])]}case"Conv3D":{const i=iK("strides",t,e,n),o=iK("pad",t,e,n),a=iK("dataFormat",t,e,n).toUpperCase(),s=iK("dilations",t,e,n);return[r.conv3d(iK("x",t,e,n),iK("filter",t,e,n),[i[1],i[2],i[3]],o,a,[s[1],s[2],s[3]])]}case"AvgPool":{const i=iK("strides",t,e,n),o=iK("pad",t,e,n),a=iK("kernelSize",t,e,n);return[r.avgPool(iK("x",t,e,n),[a[1],a[2]],[i[1],i[2]],o)]}case"MaxPool":{const i=iK("strides",t,e,n),o=iK("pad",t,e,n),a=iK("kernelSize",t,e,n);return[r.maxPool(iK("x",t,e,n),[a[1],a[2]],[i[1],i[2]],o)]}case"MaxPoolWithArgmax":{const i=iK("strides",t,e,n),o=iK("pad",t,e,n),a=iK("kernelSize",t,e,n),s=iK("includeBatchInIndex",t,e,n),{result:l,indexes:c}=r.maxPoolWithArgmax(iK("x",t,e,n),[a[1],a[2]],[i[1],i[2]],o,s);return[l,c]}case"AvgPool3D":{const i=iK("strides",t,e,n),o=iK("pad",t,e,n),a=iK("kernelSize",t,e,n);return[r.avgPool3d(iK("x",t,e,n),[a[1],a[2],a[3]],[i[1],i[2],i[3]],o)]}case"MaxPool3D":{const i=iK("strides",t,e,n),o=iK("pad",t,e,n),a=iK("kernelSize",t,e,n);return[r.maxPool3d(iK("x",t,e,n),[a[1],a[2],a[3]],[i[1],i[2],i[3]],o)]}case"Dilation2D":{const i=iK("strides",t,e,n),o=iK("pad",t,e,n),a=iK("dilations",t,e,n),s=i[1],l=i[2],c=a[1],u=a[2];return[r.dilation2d(iK("x",t,e,n),iK("filter",t,e,n),[s,l],o,[c,u],"NHWC")]}default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n)));case"creation":return i((()=>function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;switch(t.op){case"Fill":{const i=iK("shape",t,e,n),o=iK("dtype",t,e,n),a=iK("value",t,e,n);return[r.fill(i,a,o)]}case"LinSpace":{const i=iK("start",t,e,n),o=iK("stop",t,e,n),a=iK("num",t,e,n);return[r.linspace(i,o,a)]}case"Multinomial":{const i=iK("logits",t,e,n),o=iK("numSamples",t,e,n),a=iK("seed",t,e,n);return[r.multinomial(i,o,a)]}case"OneHot":{const i=iK("indices",t,e,n),o=iK("depth",t,e,n),a=iK("onValue",t,e,n),s=iK("offValue",t,e,n),l=iK("dtype",t,e,n);return[r.oneHot(i,o,a,s,l)]}case"Ones":return[r.ones(iK("shape",t,e,n),iK("dtype",t,e,n))];case"OnesLike":return[r.onesLike(iK("x",t,e,n))];case"RandomStandardNormal":return[r.randomStandardNormal(iK("shape",t,e,n),iK("dtype",t,e,n),iK("seed",t,e,n))];case"RandomUniform":return[r.randomUniform(iK("shape",t,e,n),iK("minval",t,e,n),iK("maxval",t,e,n),iK("dtype",t,e,n))];case"RandomUniformInt":return[r.randomUniformInt(iK("shape",t,e,n),iK("minval",t,e,n),iK("maxval",t,e,n),iK("seed",t,e,n))];case"Range":{const i=iK("start",t,e,n),o=iK("stop",t,e,n),a=iK("step",t,e,n);return[r.range(i,o,a,iK("dtype",t,e,n))]}case"TruncatedNormal":{const i=iK("shape",t,e,n),o=iK("mean",t,e,n),a=iK("stdDev",t,e,n),s=iK("seed",t,e,n);return[r.truncatedNormal(i,o,a,iK("dtype",t,e,n),s)]}case"Zeros":return[r.zeros(iK("shape",t,e,n),iK("dtype",t,e,n))];case"ZerosLike":return[r.zerosLike(iK("x",t,e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n)));case"dynamic":return async function(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;switch(t.op){case"NonMaxSuppressionV5":{const{boxes:r,scores:o,maxOutputSize:a,iouThreshold:s,scoreThreshold:l,softNmsSigma:c}=eZ(t,e,n),u=await i.image.nonMaxSuppressionWithScoreAsync(r,o,a,s,l,c);return[u.selectedIndices,u.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:r,scores:o,maxOutputSize:a,iouThreshold:s,scoreThreshold:l}=eZ(t,e,n),c=iK("padToMaxOutputSize",t,e,n),u=await i.image.nonMaxSuppressionPaddedAsync(r,o,a,s,l,c);return[u.selectedIndices,u.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:r,scores:o,maxOutputSize:a,iouThreshold:s,scoreThreshold:l}=eZ(t,e,n);return[await i.image.nonMaxSuppressionAsync(r,o,a,s,l)]}case"Where":{const r=i.cast(iK("condition",t,e,n),"bool"),o=[await i.whereAsync(r)];return r.dispose(),o}case"ListDiff":return i.setdiff1dAsync(iK("x",t,e,n),iK("y",t,e,n));default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n);case"evaluation":return i((()=>function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;switch(t.op){case"LowerBound":{const i=iK("sortedSequence",t,e,n),o=iK("values",t,e,n);return[r.lowerBound(i,o)]}case"TopKV2":{const i=iK("x",t,e,n),o=iK("k",t,e,n),a=iK("sorted",t,e,n),s=r.topk(i,o,a);return[s.values,s.indices]}case"UpperBound":{const i=iK("sortedSequence",t,e,n),o=iK("values",t,e,n);return[r.upperBound(i,o)]}case"Unique":{const i=iK("x",t,e,n),o=r.unique(i);return[o.values,o.indices]}case"UniqueV2":{const i=iK("x",t,e,n),o=iK("axis",t,e,n),a=r.unique(i,o);return[a.values,a.indices]}default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n)));case"image":return i((()=>function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;switch(t.op){case"ResizeBilinear":{const i=iK("images",t,e,n),o=iK("size",t,e,n),a=iK("alignCorners",t,e,n),s=iK("halfPixelCenters",t,e,n);return[r.image.resizeBilinear(i,[o[0],o[1]],a,s)]}case"ResizeNearestNeighbor":{const i=iK("images",t,e,n),o=iK("size",t,e,n),a=iK("alignCorners",t,e,n),s=iK("halfPixelCenters",t,e,n);return[r.image.resizeNearestNeighbor(i,[o[0],o[1]],a,s)]}case"CropAndResize":{const i=iK("image",t,e,n),o=iK("boxes",t,e,n),a=iK("boxInd",t,e,n),s=iK("cropSize",t,e,n),l=iK("method",t,e,n),c=iK("extrapolationValue",t,e,n);return[r.image.cropAndResize(i,o,a,s,l,c)]}case"ImageProjectiveTransformV3":{const i=iK("images",t,e,n),o=iK("transforms",t,e,n),a=iK("outputShape",t,e,n),s=iK("fillValue",t,e,n),l=iK("interpolation",t,e,n),c=iK("fillMode",t,e,n);return[r.image.transform(i,o,l.toLowerCase(),c.toLowerCase(),s,a)]}default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n)));case"graph":return i((()=>function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;switch(t.op){case"Const":return e[t.name];case"PlaceholderWithDefault":const i=iK("default",t,e,n);return[oK(t.name,e,n)||i];case"Placeholder":return[oK(t.name,e,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":case"Snapshot":return[hK(iK("x",t,e,n))];case"IdentityN":return iK("x",t,e,n).map((t=>hK(t)));case"Shape":return[r.tensor1d(iK("x",t,e,n).shape,"int32")];case"ShapeN":return iK("x",t,e,n).map((t=>r.tensor1d(t.shape)));case"Size":return[r.scalar(iK("x",t,e,n).size,"int32")];case"Rank":return[r.scalar(iK("x",t,e,n).rank,"int32")];case"NoOp":return[r.scalar(1)];case"Print":const o=iK("x",t,e,n),a=iK("data",t,e,n),s=iK("message",t,e,n),l=iK("summarize",t,e,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(s);for(let t=0;t<a.length;t++)console.log(Array.prototype.slice.call(a[t].dataSync()).slice(0,l));return[o];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n)));case"logical":return i((()=>function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;switch(t.op){case"Equal":return[r.equal(iK("a",t,e,n),iK("b",t,e,n))];case"NotEqual":return[r.notEqual(iK("a",t,e,n),iK("b",t,e,n))];case"Greater":return[r.greater(iK("a",t,e,n),iK("b",t,e,n))];case"GreaterEqual":return[r.greaterEqual(iK("a",t,e,n),iK("b",t,e,n))];case"Less":return[r.less(iK("a",t,e,n),iK("b",t,e,n))];case"LessEqual":return[r.lessEqual(iK("a",t,e,n),iK("b",t,e,n))];case"LogicalAnd":return[r.logicalAnd(iK("a",t,e,n),iK("b",t,e,n))];case"LogicalNot":return[r.logicalNot(iK("a",t,e,n))];case"LogicalOr":return[r.logicalOr(iK("a",t,e,n),iK("b",t,e,n))];case"Select":case"SelectV2":return[r.where(iK("condition",t,e,n),iK("a",t,e,n),iK("b",t,e,n))];case"BitwiseAnd":return[r.bitwiseAnd(iK("a",t,e,n),iK("b",t,e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n)));case"matrices":return i((()=>function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;switch(t.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[r.matMul(iK("a",t,e,n),iK("b",t,e,n),iK("transposeA",t,e,n),iK("transposeB",t,e,n))];case"Einsum":return[r.einsum(iK("equation",t,e,n),...iK("tensors",t,e,n))];case"Transpose":return[r.transpose(iK("x",t,e,n),iK("perm",t,e,n))];case"_FusedMatMul":const[i,o]=iK("fusedOps",t,e,n),a="biasadd"===i,s="prelu"===o,l=iK("numArgs",t,e,n),c=iK("leakyreluAlpha",t,e,n);if(a){if(s&&2!==l)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!s&&1!==l)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[u,h]=iK("args",t,e,n);return[r.fused.matMul({a:iK("a",t,e,n),b:iK("b",t,e,n),transposeA:iK("transposeA",t,e,n),transposeB:iK("transposeB",t,e,n),bias:u,activation:o,preluActivationWeights:h,leakyreluAlpha:c})];case"MatrixBandPart":return[r.linalg.bandPart(iK("a",t,e,n),iK("numLower",t,e,n),iK("numUpper",t,e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n)));case"normalization":return i((()=>function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;switch(t.op){case"EuclideanNorm":return[r.euclideanNorm(iK("x",t,e,n),iK("axis",t,e,n),iK("keepDims",t,e,n))];case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[r.batchNorm(iK("x",t,e,n),iK("mean",t,e,n),iK("variance",t,e,n),iK("offset",t,e,n),iK("scale",t,e,n),iK("epsilon",t,e,n))];case"LRN":return[r.localResponseNormalization(iK("x",t,e,n),iK("radius",t,e,n),iK("bias",t,e,n),iK("alpha",t,e,n),iK("beta",t,e,n))];case"Softmax":return[r.softmax(iK("x",t,e,n))];case"LogSoftmax":return[r.logSoftmax(iK("x",t,e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n)));case"ragged":return i((()=>function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;switch(t.op){case"RaggedGather":{const{outputNestedSplits:i,outputDenseValues:o}=r.raggedGather(iK("paramsNestedSplits",t,e,n),iK("paramsDenseValues",t,e,n),iK("indices",t,e,n),iK("outputRaggedRank",t,e,n));return i.concat(o)}case"RaggedRange":{const{rtNestedSplits:i,rtDenseValues:o}=r.raggedRange(iK("starts",t,e,n),iK("limits",t,e,n),iK("splits",t,e,n));return[i,o]}case"RaggedTensorToTensor":return[r.raggedTensorToTensor(iK("shape",t,e,n),iK("values",t,e,n),iK("defaultValue",t,e,n),iK("rowPartitionTensors",t,e,n),iK("rowPartitionTypes",t,e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n)));case"reduction":return i((()=>function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;switch(t.op){case"Max":{const i=iK("axis",t,e,n),o=iK("keepDims",t,e,n);return[r.max(iK("x",t,e,n),i,o)]}case"Mean":{const i=iK("axis",t,e,n),o=iK("keepDims",t,e,n);return[r.mean(iK("x",t,e,n),i,o)]}case"Min":{const i=iK("axis",t,e,n),o=iK("keepDims",t,e,n);return[r.min(iK("x",t,e,n),i,o)]}case"Sum":{const i=iK("axis",t,e,n),o=iK("keepDims",t,e,n);return[r.sum(iK("x",t,e,n),i,o)]}case"All":{const i=iK("axis",t,e,n),o=iK("keepDims",t,e,n);return[r.all(iK("x",t,e,n),i,o)]}case"Any":{const i=iK("axis",t,e,n),o=iK("keepDims",t,e,n);return[r.any(iK("x",t,e,n),i,o)]}case"ArgMax":{const i=iK("axis",t,e,n);return[r.argMax(iK("x",t,e,n),i)]}case"ArgMin":{const i=iK("axis",t,e,n);return[r.argMin(iK("x",t,e,n),i)]}case"Prod":{const i=iK("axis",t,e,n),o=iK("keepDims",t,e,n);return[r.prod(iK("x",t,e,n),i,o)]}case"Cumprod":{const i=iK("axis",t,e,n),o=iK("exclusive",t,e,n),a=iK("reverse",t,e,n);return[r.cumprod(iK("x",t,e,n),i,o,a)]}case"Cumsum":{const i=iK("axis",t,e,n),o=iK("exclusive",t,e,n),a=iK("reverse",t,e,n);return[r.cumsum(iK("x",t,e,n),i,o,a)]}case"Bincount":const i=iK("x",t,e,n),o=iK("weights",t,e,n),a=iK("size",t,e,n);return[r.bincount(i,o,a)];case"DenseBincount":{const i=iK("x",t,e,n),o=iK("weights",t,e,n),a=iK("size",t,e,n),s=iK("binaryOutput",t,e,n);return[r.denseBincount(i,o,a,s)]}default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n)));case"slice_join":return i((()=>function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;switch(t.op){case"ConcatV2":case"Concat":{const i=iK("n",t,e,n),o=iK("axis",t,e,n);let a=iK("tensors",t,e,n);return a=a.slice(0,i),[r.concat(a,o)]}case"Gather":{const i=iK("x",t,e,n),o=iK("indices",t,e,n);return[r.gather(i,r.cast(o,"int32"),0)]}case"GatherV2":{const i=iK("axis",t,e,n),o=iK("batchDims",t,e,n),a=iK("x",t,e,n),s=iK("indices",t,e,n);return[r.gather(a,r.cast(s,"int32"),i,o)]}case"Reverse":{const i=iK("dims",t,e,n),o=[];for(let t=0;t<i.length;t++)i[t]&&o.push(t);const a=iK("x",t,e,n);return[r.reverse(a,o)]}case"ReverseV2":{const i=iK("axis",t,e,n),o=iK("x",t,e,n);return[r.reverse(o,i)]}case"Slice":{const i=iK("begin",t,e,n),o=iK("size",t,e,n);return[r.slice(iK("x",t,e,n),i,o)]}case"StridedSlice":{const i=iK("begin",t,e,n),o=iK("end",t,e,n),a=iK("strides",t,e,n),s=iK("beginMask",t,e,n),l=iK("endMask",t,e,n),c=iK("ellipsisMask",t,e,n),u=iK("newAxisMask",t,e,n),h=iK("shrinkAxisMask",t,e,n),d=iK("x",t,e,n);return[r.stridedSlice(d,i,o,a,s,l,c,u,h)]}case"Pack":return iz((()=>{const i=iK("axis",t,e,n),o=iK("tensors",t,e,n),a=o[0].shape,s=r.squeeze(o[0]).shape,l=o.map((t=>{const e=uD(t.shape,a);if(!e&&!uD(r.squeeze(t).shape,s))throw new Error("the input tensors shape does not match");return e?t:r.reshape(t,a)}));return[r.stack(l,i)]}));case"Unpack":{const i=iK("axis",t,e,n),o=iK("tensor",t,e,n);return r.unstack(o,i)}case"Tile":{const i=iK("reps",t,e,n);return[r.tile(iK("x",t,e,n),i)]}case"Split":case"SplitV":{const i=iK("axis",t,e,n),o=iK("numOrSizeSplits",t,e,n),a=iK("x",t,e,n);return r.split(a,o,i)}case"ScatterNd":{const i=iK("indices",t,e,n),o=iK("values",t,e,n),a=iK("shape",t,e,n);return[r.scatterND(i,o,a)]}case"GatherNd":{const i=iK("x",t,e,n),o=iK("indices",t,e,n);return[r.gatherND(i,o)]}case"SparseToDense":{const i=iK("sparseIndices",t,e,n),o=iK("outputShape",t,e,n),a=iK("sparseValues",t,e,n),s=iK("defaultValue",t,e,n);return[r.sparseToDense(i,a,o,a.dtype===s.dtype?s:r.cast(s,a.dtype))]}case"TensorScatterUpdate":{const i=iK("indices",t,e,n),o=iK("values",t,e,n),a=iK("tensor",t,e,n);return[r.tensorScatterUpdate(a,i,o)]}default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n)));case"sparse":return i((()=>function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;switch(t.op){case"SparseFillEmptyRows":{const{outputIndices:i,outputValues:o,emptyRowIndicator:a,reverseIndexMap:s}=r.sparse.sparseFillEmptyRows(iK("indices",t,e,n),iK("values",t,e,n),iK("denseShape",t,e,n),iK("defaultValue",t,e,n));return[i,o,a,s]}case"SparseReshape":{const{outputIndices:i,outputShape:o}=r.sparse.sparseReshape(iK("inputIndices",t,e,n),iK("inputShape",t,e,n),iK("newShape",t,e,n));return[i,o]}case"SparseSegmentMean":return[r.sparse.sparseSegmentMean(iK("data",t,e,n),iK("indices",t,e,n),iK("segmentIds",t,e,n))];case"SparseSegmentSum":return[r.sparse.sparseSegmentSum(iK("data",t,e,n),iK("indices",t,e,n),iK("segmentIds",t,e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n)));case"spectral":return i((()=>function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;switch(t.op){case"FFT":return[r.fft(iK("x",t,e,n))];case"IFFT":return[r.ifft(iK("x",t,e,n))];case"RFFT":return[r.rfft(iK("x",t,e,n))];case"IRFFT":return[r.irfft(iK("x",t,e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n)));case"string":return i((()=>function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;switch(t.op){case"StaticRegexReplace":return[r.string.staticRegexReplace(iK("input",t,e,n),iK("pattern",t,e,n),iK("rewrite",t,e,n),iK("replaceGlobal",t,e,n))];case"StringNGrams":{const{nGrams:i,nGramsSplits:o}=r.string.stringNGrams(iK("data",t,e,n),iK("dataSplits",t,e,n),iK("separator",t,e,n),iK("nGramWidths",t,e,n),iK("leftPad",t,e,n),iK("rightPad",t,e,n),iK("padWidth",t,e,n),iK("preserveShortSequences",t,e,n));return[i,o]}case"StringSplit":{const{indices:i,values:o,shape:a}=r.string.stringSplit(iK("input",t,e,n),iK("delimiter",t,e,n),iK("skipEmpty",t,e,n));return[i,o,a]}case"StringToHashBucketFast":return[r.string.stringToHashBucketFast(iK("input",t,e,n),iK("numBuckets",t,e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n)));case"transformation":return i((()=>function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;switch(t.op){case"Cast":return[r.cast(iK("x",t,e,n),iK("dtype",t,e,n))];case"ExpandDims":{const i=iK("axis",t,e,n);return[r.expandDims(iK("x",t,e,n),i)]}case"Squeeze":{const i=iK("axis",t,e,n);return[r.squeeze(iK("x",t,e,n),i)]}case"Reshape":return[r.reshape(iK("x",t,e,n),iK("shape",t,e,n))];case"EnsureShape":return[r.ensureShape(iK("x",t,e,n),iK("shape",t,e,n))];case"MirrorPad":return[r.mirrorPad(iK("x",t,e,n),iK("padding",t,e,n),iK("mode",t,e,n))];case"PadV2":case"Pad":return[r.pad(iK("x",t,e,n),iK("padding",t,e,n),iK("constantValue",t,e,n))];case"SpaceToBatchND":{const i=iK("blockShape",t,e,n),o=iK("paddings",t,e,n);return[r.spaceToBatchND(iK("x",t,e,n),i,o)]}case"BatchToSpaceND":{const i=iK("blockShape",t,e,n),o=iK("crops",t,e,n);return[r.batchToSpaceND(iK("x",t,e,n),i,o)]}case"DepthToSpace":{const i=iK("blockSize",t,e,n),o=iK("dataFormat",t,e,n).toUpperCase();return[r.depthToSpace(iK("x",t,e,n),i,o)]}case"BroadcastTo":return[r.broadcastTo(iK("x",t,e,n),iK("shape",t,e,n))];case"BroadcastArgs":return[r.broadcastArgs(iK("s0",t,e,n),iK("s1",t,e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n)));case"hash_table":return(async(t,e,n,r)=>{switch(t.op){case"HashTable":case"HashTableV2":{const i=r.getHashTableHandleByName(t.name);if(null!=i)return[i];{const i=iK("keyDType",t,e,n),o=iK("valueDType",t,e,n),a=new nZ(i,o);return r.addHashTable(t.name,a),[a.handle]}}case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":{const i=iK("tableHandle",t,e,n,r),o=iK("keys",t,e,n),a=iK("values",t,e,n),s=r.getHashTableById(i.id);return[await s.import(o,a)]}case"LookupTableFind":case"LookupTableFindV2":{const i=iK("tableHandle",t,e,n,r),o=iK("keys",t,e,n),a=iK("defaultValue",t,e,n),s=r.getHashTableById(i.id);return[await s.find(o,a)]}case"LookupTableSize":case"LookupTableSizeV2":{const i=iK("tableHandle",t,e,n,r);return[r.getHashTableById(i.id).tensorSize()]}default:throw TypeError("Node type ".concat(t.op," is not implemented"))}})(t,e,n,r);case"custom":const o=rK(t.op);if(o&&o.customExecutor)return o.customExecutor(new qK(t,e,n));throw TypeError("Custom op ".concat(t.op," is not registered."));default:throw TypeError("Unknown op '".concat(t.op,"'. File an issue at ")+"https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()")}})(t,e,n);return ND(o)?o.then((t=>[].concat(t))):[].concat(o)}class iZ{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4?arguments[4]:void 0;this.weightMap=t,this.tensorArrayMap=e,this.tensorListMap=n,this.functionMap=r,this.parseNodeNameCache=i,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(t,e){return{id:t,frameName:e,iterationId:0}}set currentContext(t){this.contexts!==t&&(this.contexts=t,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const t=[];for(let e=0;e<this.contexts.length-1;e++){const n=this.contexts.slice(0,this.contexts.length-e);t.push(this.contextIdforContexts(n))}t.push(""),this._currentContextIds=t}contextIdforContexts(t){return t?t.map((t=>0===t.id&&0===t.iterationId?"":"".concat(t.frameName,"-").concat(t.iterationId))).join("/"):""}enterFrame(t){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,t)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()}nextIteration(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");{this.contexts=this.contexts.slice(),this.lastId++;const t=Object.assign({},this.contexts[this.contexts.length-1]);t.iterationId+=1,t.id=this.lastId,this.contexts.splice(-1,1,t),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}}getWeight(t){return this.weightMap[t]}addTensorArray(t){this.tensorArrayMap[t.id]=t}getTensorArray(t){return this.tensorArrayMap[t]}addTensorList(t){this.tensorListMap[t.id]=t}getTensorList(t){return this.tensorListMap[t]}dispose(t){for(const e in this.tensorArrayMap)this.tensorArrayMap[e].clearAndClose(t);for(const e in this.tensorListMap)this.tensorListMap[e].clearAndClose(t)}}function oZ(t,e,n,r){const i=new Set,o=[];let a=null,s=null;const l=new Set,c=new Set(Object.keys(t).map((t=>cK(t)[0])));r=r||[];const u=new Set(r.map((t=>cK(t.name)[0]))),h=[...e];for(;h.length>0;){const t=h.pop();(hZ(t)||dZ(t)||pZ(t))&&null==a&&(a=t,s=a.children.map((t=>t.name)).filter((t=>i.has(t)))),i.add(t.name),null==n[t.name]&&(c.has(t.name)||u.has(t.name)||(0!==t.inputs.length?t.inputs.forEach((t=>{l.has(t.name)||(l.add(t.name),h.push(t))})):o.push(t.name)))}return{inputs:t,outputs:e,usedNodes:i,missingInputs:o,dynamicNode:a,syncInputs:s}}function aZ(t,e){const{usedNodes:n,inputs:r}=e,i=Object.keys(r).map((t=>cK(t)[0])).map((e=>t.nodes[e])),o=t.initNodes||[],a=t=>n.has("string"===typeof t?t:t.name);function s(t){return[...new Map(t.map((t=>[t.name,t]))).values()]}const l=s([...i,...t.weights,...o]).filter(a),c=s([...l,...Object.values(t.nodes)]).filter(a),u=new Map(c.map((t=>[t.name,t]))),h={};for(const m of c){h[m.name]=h[m.name]||0;for(const t of m.children)a(t)||(h[t.name]=Number.POSITIVE_INFINITY),h[t.name]=(h[t.name]||0)+1}const d=Object.entries(h).filter((t=>{let[,e]=t;return 0===e})).map((t=>{let[e]=t;return e})),p=[...d];for(;d.length>0;){const t=d.pop(),e=u.get(t);for(const n of e.children.filter(a))0===--h[n.name]&&(p.push(n.name),d.push(n.name))}const f=function(t,e){const n=new Map(t.map((t=>[t.name,t]))),r=e.map((t=>t.name)),i=new Set(r);for(;r.length>0;){const t=r.pop(),e=n.get(t);for(const o of e.children)n.has(o.name)&&!i.has(o.name)&&(i.add(o.name),r.push(o.name))}const o=t.filter((t=>i.has(t.name)));return o}(p.map((t=>u.get(t))),l);return function(t,e){const n=new Map(t.map(((t,e)=>[t.name,e]))),r=new Set(e.map((t=>t.name))),i=t=>r.has("string"===typeof t?t:t.name),o=new Set(t.map((t=>t.name))),a=t=>o.has("string"===typeof t?t:t.name);for(const s of t){for(const t of s.children.filter(a)){if(!n.has(t.name))throw new sZ("Child ".concat(t.name," of node ").concat(s.name," is unreachable."));if(n.get(s.name)>n.get(t.name))throw new sZ("Node ".concat(s.name," is scheduled to run after its child ").concat(t.name,"."))}if(!i(s))for(const t of s.inputs){if(!n.has(t.name))throw new sZ("Input ".concat(t.name," of node ").concat(s.name," is unreachable."));if(n.get(t.name)>n.get(s.name))throw new sZ("Node ".concat(s.name," is scheduled to run before its input ").concat(t.name,"."))}}}(f,l),f}class sZ extends Error{constructor(t){super("NodesExecutionOrderError: ".concat(t))}}const lZ=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),cZ=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),uZ=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function hZ(t){return lZ.has(t.op)}function dZ(t){return cZ.has(t.op)}function pZ(t){return uZ.has(t.op)}class fZ{get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(t){const e=Object.keys(t).map((e=>t[e].map((t=>t.id))));this._weightIds=[].concat(...e),this._weightMap=t}set resourceManager(t){this._resourceManager=t}get inputs(){return this._inputs.map((t=>({name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0})))}get outputs(){return this._outputs.map((t=>({name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0})))}get inputNodes(){return this._inputs.map((t=>t.signatureKey||t.name))}get outputNodes(){return this._outputs.map((t=>{const e=t.signatureKey||t.name;return t.defaultOutput?"".concat(e,":").concat(t.defaultOutput):e}))}get functions(){return Object.keys(this._functions).reduce(((t,e)=>(t[e]=this._functions[e].signature,t)),{})}constructor(t,e){this.graph=t,this.parent=e,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=t.outputs,this._inputs=t.inputs,this._initNodes=t.initNodes,this._signature=t.signature,this._functions=t.functions,null!=t.functions&&Object.keys(t.functions).forEach((e=>{this._functionExecutorMap[e]=new fZ(t.functions[e],this)}))}getCompilationKey(t,e){const n=t.map((t=>t.name)).sort(),r=e.map((t=>t.name)).sort();return n.join(this.SEPARATOR)+"--"+r.join(this.SEPARATOR)}compile(t,e){const n=oZ(t,e,this.weightMap,this._initNodes),{missingInputs:r,dynamicNode:i,syncInputs:o}=n;if(null!=i)throw new Error("This execution contains the node '".concat(i.name,"', which has ")+"the dynamic op '".concat(i.op,"'. Please use ")+"model.executeAsync() instead. Alternatively, to avoid the "+"dynamic ops, specify the inputs [".concat(o,"]"));if(r.length>0){const n=e.map((t=>t.name)),i=Object.keys(t);throw new Error("Cannot compute the outputs [".concat(n,"] from the provided inputs ")+"[".concat(i,"]. Missing the following inputs: [").concat(r,"]"))}const a=aZ(this.graph,n),s=function(t){const e=new Map(t.map(((t,e)=>[t.name,e]))),n=Number.MAX_SAFE_INTEGER,r=t.map(((t,e)=>hZ(t)?n:e)),i=t=>{const n=r[e.get(t.name)];return null==n?-1:n},o=t.map(((t,e)=>t.children.map(i).reduce(((t,e)=>Math.max(t,e)),r[e]))),a=new Map;for(let s=0;s<t.length;++s){const e=o[s];if(e===n)continue;const r=t[s],i=t[e];a.has(i.name)||a.set(i.name,[]),a.get(i.name).push(r)}return a}(a);return{orderedNodes:a,nodeLiveUntilMap:s}}cloneAndKeepTensor(t){if(null==t)return null;const e=t.clone();return az(e),e}cloneTensorList(t){if(!t)return null;const e=t.map((t=>this.cloneAndKeepTensor(t)));return e}cloneTensorMap(t){return Object.fromEntries(Object.entries(t).map((t=>{let[e,n]=t;return[e,this.cloneTensorList(n)]})))}execute(t,e){this.disposeIntermediateTensors(),t=this.mapInputs(t);const n=Object.keys(t).sort();this.checkInputs(t),this.checkInputShapeAndType(t),e=this.mapOutputs(e),this.checkOutputs(e);const r=n.map((t=>this.graph.nodes[cK(t)[0]])),i=e.map((t=>cK(t)[0])),o=new Set(i);let a=i.map((t=>this.graph.nodes[t]));0===a.length&&(a=this._outputs);const s=this.getCompilationKey(r,a);let l=this.compiledMap.get(s);null==l&&(l=this.compile(t,a),this.compiledMap.set(s,l));try{this.keepIntermediateTensors=FD().getBool("KEEP_INTERMEDIATE_TENSORS")}catch($7){this.keepIntermediateTensors=!1,console.warn($7.message)}const c={},u={};return iz((()=>{const n=new iZ(this.weightMap,c,u,this.functionExecutorMap,this.parseNodeNameCache),r=Object.assign({},this.weightMap);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),Object.keys(t).forEach((e=>{const[i,o]=cK(e,n),a=[];a[o]=t[e],r[i]=a,this.keepIntermediateTensors&&(this.clonedTensorsMap[i]=this.cloneTensorList(a))}));const i=this.getFrozenTensorIds(r),{orderedNodes:a,nodeLiveUntilMap:s}=l;for(const t of a){if(r[t.name])continue;const e=rZ(t,r,n,this._resourceManager);if(ND(e))throw new Error("The execution of the op '".concat(t.op,"' returned a promise. ")+"Please use model.executeAsync() instead.");r[t.name]=e,this.keepIntermediateTensors&&(this.clonedTensorsMap[t.name]=this.cloneTensorList(e)),this.checkTensorForDisposalWithNodeLiveUntilInfo(t,r,n,i,o,s.get(t.name))}return null==this.parent&&n.dispose(i),e.map((t=>oK(t,r,n)))}))}getFrozenTensorIds(t){const e=[].concat.apply([],Object.keys(t).map((e=>t[e])).map((t=>t.map((t=>t.id)))));return new Set(e)}checkTensorForDisposal(t,e,n,r,i,o,a){if(!hZ(e)&&!o.has(t)){for(const r of n[t])null!=r&&(a[r.id]=(a[r.id]||0)+e.children.length);for(const t of e.inputs){if(hZ(t))continue;const e=aK(t.name,n,r);if(null!=e)for(const t of e){if(!t||t.kept||i.has(t.id))continue;const e=a[t.id];1===e?(t.dispose(),delete a[t.id]):null!=e&&a[t.id]--}}}}checkTensorForDisposalWithNodeLiveUntilInfo(t,e,n,r,i,o){function a(t){return hZ(t)||i.has(t.name)}if(!hZ(t)&&null!=o)for(const s of o){if(a(s))continue;const t=aK(s.name,e,n);for(const e of t)!e||e.kept||r.has(e.id)||e.dispose()}}async executeAsync(t,e){return this._executeAsync(t,e)}disposeIntermediateTensors(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach((t=>{for(const e of t)e&&!e.isDisposed&&e.dispose()})),this.clonedTensorsMap=null)}getIntermediateTensors(){return this.clonedTensorsMap}async _executeAsync(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};this.disposeIntermediateTensors(),n||(t=this.mapInputs(t),this.checkInputs(t),this.checkInputShapeAndType(t),e=this.mapOutputs(e),this.checkOutputs(e));try{this.keepIntermediateTensors=FD().getBool("KEEP_INTERMEDIATE_TENSORS")}catch($7){this.keepIntermediateTensors=!1,console.warn($7.message)}const o=new iZ(this.weightMap,r,i,this.functionExecutorMap,this.parseNodeNameCache);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap));const a=await this.executeWithControlFlow(t,o,e,n),s=e.map((t=>oK(t,a,o))),l=s.map((t=>t.id)),c=Object.keys(t).map((e=>t[e].id)),u=new Set([...l,...c,...this.weightIds]);return Object.values(a).forEach((t=>{t.forEach((t=>{!t||t.isDisposed||u.has(t.id)||t.dispose()}))})),null==this.parent&&o.dispose(u),s}async executeFunctionAsync(t,e,n){const r=t.reduce(((t,e,n)=>(t[this.inputs[n].name]=e,t)),{});return this._executeAsync(r,this.outputNodes,!0,e,n)}async executeWithControlFlow(t,e,n,r){const i=Object.keys(t),o=i.map((t=>this.graph.nodes[cK(t)[0]])),a=n.map((t=>cK(t)[0])),s=new Set(a);let l=a.map((t=>this.graph.nodes[t]));0===l.length&&(l=this._outputs);const{usedNodes:c,missingInputs:u,dynamicNode:h,syncInputs:d}=oZ(t,l,this.weightMap,this._initNodes),p=[...o,...this.graph.weights,...this._initNodes||[]].map((t=>({node:t,contexts:e.currentContext}))),f=Object.assign({},this.weightMap);Object.keys(t).forEach((e=>{const[n,r]=cK(e),i=[];i[r]=t[e],f[n]=i}));const m={},g=this.getFrozenTensorIds(f),y={};for(;p.length>0;){const t=this.processStack(o,p,e,f,y,g,s,m,c);await Promise.all(t)}null!=h||r||console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const v=l.filter((t=>!hZ(t)&&!oK(t.name,f,e))).map((t=>t.name));if(v.length>0){let t="";throw null!=h&&(t="Alternatively, to avoid the dynamic ops, use model.execute() "+"and specify the inputs [".concat(d,"]")),new Error("Cannot compute the outputs [".concat(v,"] from the provided ")+"inputs [".concat(i,"]. Consider providing the following inputs: ")+"[".concat(u,"]. ").concat(t))}return f}processStack(t,e,n,r,i,o,a,s,l){const c=[];for(;e.length>0;){const t=e.pop();n.currentContext=t.contexts;let u="";if("Enter"===t.node.op&&iK("isConstant",t.node,r,n)&&([u]=sK(t.node.name,n)),null==r[t.node.name]){const h=rZ(t.node,r,n,this._resourceManager);u||([u]=sK(t.node.name,n));const d=n.currentContext;ND(h)?c.push(h.then((c=>(r[u]=c,this.keepIntermediateTensors&&(this.clonedTensorsMap[u]=this.cloneTensorList(c)),n.currentContext=d,this.checkTensorForDisposal(u,t.node,r,n,o,a,s),this.processChildNodes(t.node,e,n,r,i,l),c)))):(r[u]=h,this.keepIntermediateTensors&&(this.clonedTensorsMap[u]=this.cloneTensorList(h)),this.checkTensorForDisposal(u,t.node,r,n,o,a,s),this.processChildNodes(t.node,e,n,r,i,l))}else this.processChildNodes(t.node,e,n,r,i,l)}return c}processChildNodes(t,e,n,r,i,o){t.children.forEach((t=>{const[a]=sK(t.name,n);!i[a]&&o.has(t.name)&&("Merge"===t.op?t.inputNames.some((t=>!!oK(t,r,n)))&&(i[a]=!0,e.push({contexts:n.currentContext,node:t})):t.inputNames.every((t=>!!oK(t,r,n)))&&(i[a]=!0,e.push({contexts:n.currentContext,node:t})))}))}dispose(){Object.keys(this.weightMap).forEach((t=>this.weightMap[t].forEach((t=>t.dispose()))))}checkInputShapeAndType(t){Object.keys(t).forEach((e=>{const n=t[e],[r]=cK(e),i=this.graph.nodes[r];if(i.attrParams.shape&&i.attrParams.shape.value){const t=i.attrParams.shape.value;aD(t.length===n.shape.length&&n.shape.every(((e,n)=>-1===t[n]||t[n]===e)),(()=>"The shape of dict['".concat(i.name,"'] provided in ")+"model.execute(dict) must be [".concat(t,"], but was ")+"[".concat(n.shape,"]")))}i.attrParams.dtype&&i.attrParams.dtype.value&&aD(n.dtype===i.attrParams.dtype.value,(()=>"The dtype of dict['".concat(i.name,"'] provided in ")+"model.execute(dict) must be "+"".concat(i.attrParams.dtype.value,", but was ").concat(n.dtype)))}))}mapInputs(t){var e,n;const r={};for(const i in t){const o=null===(n=null===(e=this._signature)||void 0===e?void 0:e.inputs)||void 0===n?void 0:n[i];null!=o?r[o.name]=t[i]:r[i]=t[i]}return r}checkInputs(t){const e=Object.keys(t).filter((t=>{const[e]=cK(t);return null==this.graph.nodes[e]}));if(e.length>0)throw new Error("The dict provided in model.execute(dict) has "+"keys: [".concat(e,"] that are not part of graph"))}mapOutputs(t){return t.map((t=>{var e,n;const r=null===(n=null===(e=this._signature)||void 0===e?void 0:e.outputs)||void 0===n?void 0:n[t];return null!=r?r.name:t}),{})}checkOutputs(t){t.forEach((t=>{const[e]=cK(t);if(!this.graph.nodes[e])throw new Error("The output '".concat(t,"' is not found in the graph"))}))}}class mZ{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.hashTableNameToHandle=t,this.hashTableMap=e}addHashTable(t,e){this.hashTableNameToHandle[t]=e.handle,this.hashTableMap[e.id]=e}getHashTableHandleByName(t){return this.hashTableNameToHandle[t]}getHashTableById(t){return this.hashTableMap[t]}dispose(){for(const t in this.hashTableMap)this.hashTableMap[t].clearAndClose(),delete this.hashTableMap[t];for(const t in this.hashTableNameToHandle)this.hashTableNameToHandle[t].dispose(),delete this.hashTableNameToHandle[t]}}const gZ="?tfjs-format=file",yZ="model.json";class vZ{get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n;this.modelUrl=t,this.loadOptions=e,this.version="n/a",this.io=r,null==e&&(this.loadOptions={}),this.resourceManager=new mZ}findIOHandler(){const t=this.modelUrl;if(null!=t.load)this.handler=t;else if(null!=this.loadOptions.requestInit)this.handler=this.io.browserHTTPRequest(t,this.loadOptions);else{const e=this.io.getLoadHandlers(t,this.loadOptions);if(0===e.length)e.push(this.io.browserHTTPRequest(t,this.loadOptions));else if(e.length>1)throw new Error("Found more than one (".concat(e.length,") load handlers for ")+"URL '".concat([t],"'"));this.handler=e[0]}}load(){if(this.findIOHandler(),null==this.handler.load)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const t=this.handler.load();return ND(t)?t.then((t=>null==t.getWeightStream?this.loadSync(t):this.loadStreaming(t))):this.loadSync(t)}loadSync(t){const e=this.io.decodeWeights(t.weightData,t.weightSpecs);return this.loadWithWeightMap(t,e)}async loadStreaming(t){if(null==t.getWeightStream)throw new Error("Model artifacts missing streamWeights function");const e=await fz(t.getWeightStream(),t.weightSpecs);return this.loadWithWeightMap(t,e)}loadWithWeightMap(t,e){this.artifacts=t;const n=this.artifacts.modelTopology;let r=this.artifacts.signature;if(null!=this.artifacts.userDefinedMetadata){const t=this.artifacts.userDefinedMetadata;null!=t.signature&&(r=t.signature),null!=t.structuredOutputKeys&&(this.structuredOutputKeys=t.structuredOutputKeys)}if(this.signature=r,this.version="".concat(n.versions.producer,".").concat(n.versions.minConsumer),this.executor=new fZ(RK.Instance.transformGraph(n,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(e),this.executor.resourceManager=this.resourceManager,null!=t.modelInitializer&&null!=t.modelInitializer.node){const e=RK.Instance.transformGraph(t.modelInitializer);this.initializer=new fZ(e),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=t.initializerSignature}return!0}async save(t,e){if("string"===typeof t){const e=this.io.getSaveHandlers(t);if(0===e.length)throw new Error("Cannot find any save handlers for URL '".concat(t,"'"));if(e.length>1)throw new Error("Found more than one (".concat(e.length,") save handlers for ")+"URL '".concat(t,"'"));t=e[0]}if(null==t.save)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return t.save(this.artifacts)}addStructuredOutputNames(t){if(this.structuredOutputKeys){const e={};return(t instanceof bB?[t]:t).forEach(((t,n)=>e[this.structuredOutputKeys[n]]=t)),e}return t}predict(t,e){const n=this.execute(t,this.outputNodes);return this.addStructuredOutputNames(n)}async predictAsync(t,e){const n=await this.executeAsync(t,this.outputNodes);return this.addStructuredOutputNames(n)}normalizeInputs(t){var e;if(!(t instanceof bB)&&!Array.isArray(t)){const n=null===(e=this.signature)||void 0===e?void 0:e.inputs;if(null!=n)for(const e in n){const r=n[e];null!=r.resourceId&&(t[e]=this.resourceIdToCapturedInput[r.resourceId])}return t}t=Array.isArray(t)?t:[t];const n=Object.keys(this.resourceIdToCapturedInput).length;if(t.length+n!==this.inputNodes.length)throw new Error("Input tensor count mismatch, the graph model has ".concat(this.inputNodes.length-n," non-resource placeholders, while there are ").concat(t.length," input tensors provided."));let r=0;return this.inputNodes.reduce(((e,n)=>{var i,o,a;const s=null===(a=null===(o=null===(i=this.signature)||void 0===i?void 0:i.inputs)||void 0===o?void 0:o[n])||void 0===a?void 0:a.resourceId;return e[n]=null!=s?this.resourceIdToCapturedInput[s]:t[r++],e}),{})}normalizeOutputs(t){return t=t||this.outputNodes,Array.isArray(t)?t:[t]}executeInitializerGraph(){return null==this.initializer?[]:null==this.initializerSignature?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}async executeInitializerGraphAsync(){return null==this.initializer?[]:null==this.initializerSignature?this.initializer.executeAsync({},[]):this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs))}setResourceIdToCapturedInput(t){if(this.resourceIdToCapturedInput={},this.initializerSignature){const e=this.initializerSignature.outputs,n=Object.keys(e);for(let r=0;r<n.length;r++){const i=e[n[r]];this.resourceIdToCapturedInput[i.resourceId]=t[r]}}}execute(t,e){null==this.resourceIdToCapturedInput&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),t=this.normalizeInputs(t),e=this.normalizeOutputs(e);const n=this.executor.execute(t,e);return n.length>1?n:n[0]}async executeAsync(t,e){null==this.resourceIdToCapturedInput&&this.setResourceIdToCapturedInput(await this.executeInitializerGraphAsync()),t=this.normalizeInputs(t),e=this.normalizeOutputs(e);const n=await this.executor.executeAsync(t,e);return n.length>1?n:n[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(t){return Object.keys(t).reduce(((e,n)=>(e[n]=[t[n]],e)),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&oz(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}}async function bZ(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n;if(null==t)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");null==e&&(e={}),e.fromTFHub&&"string"===typeof t&&(t=function(t){t.endsWith("/")||(t+="/");return"".concat(t).concat(yZ).concat(gZ)}(t));const i=new vZ(t,e,r);return await i.load(),i}var xZ=function(){return xZ=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},xZ.apply(this,arguments)};function _Z(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{l(r.next(t))}catch(t){o(t)}}function s(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((r=r.apply(t,e||[])).next())}))}function wZ(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function SZ(t){var e=t.map((function(t){return t[0]}));return e.push(t[t.length-1][1]),e}var TZ={lips:SZ([[61,146],[146,91],[91,181],[181,84],[84,17],[17,314],[314,405],[405,321],[321,375],[375,291],[61,185],[185,40],[40,39],[39,37],[37,0],[0,267],[267,269],[269,270],[270,409],[409,291],[78,95],[95,88],[88,178],[178,87],[87,14],[14,317],[317,402],[402,318],[318,324],[324,308],[78,191],[191,80],[80,81],[81,82],[82,13],[13,312],[312,311],[311,310],[310,415],[415,308]]),leftEye:SZ([[263,249],[249,390],[390,373],[373,374],[374,380],[380,381],[381,382],[382,362],[263,466],[466,388],[388,387],[387,386],[386,385],[385,384],[384,398],[398,362]]),leftEyebrow:SZ([[276,283],[283,282],[282,295],[295,285],[300,293],[293,334],[334,296],[296,336]]),leftIris:SZ([[474,475],[475,476],[476,477],[477,474]]),rightEye:SZ([[33,7],[7,163],[163,144],[144,145],[145,153],[153,154],[154,155],[155,133],[33,246],[246,161],[161,160],[160,159],[159,158],[158,157],[157,173],[173,133]]),rightEyebrow:SZ([[46,53],[53,52],[52,65],[65,55],[70,63],[63,105],[105,66],[66,107]]),rightIris:SZ([[469,470],[470,471],[471,472],[472,469]]),faceOval:SZ([[10,338],[338,297],[297,332],[332,284],[284,251],[251,389],[389,356],[356,454],[454,323],[323,361],[361,288],[288,397],[397,365],[365,379],[379,378],[378,400],[400,377],[377,152],[152,148],[148,176],[176,149],[149,150],[150,136],[136,172],[172,58],[58,132],[132,93],[93,234],[234,127],[127,162],[162,21],[21,54],[54,103],[103,67],[67,109],[109,10]])},EZ=[[127,34],[34,139],[139,127],[11,0],[0,37],[37,11],[232,231],[231,120],[120,232],[72,37],[37,39],[39,72],[128,121],[121,47],[47,128],[232,121],[121,128],[128,232],[104,69],[69,67],[67,104],[175,171],[171,148],[148,175],[118,50],[50,101],[101,118],[73,39],[39,40],[40,73],[9,151],[151,108],[108,9],[48,115],[115,131],[131,48],[194,204],[204,211],[211,194],[74,40],[40,185],[185,74],[80,42],[42,183],[183,80],[40,92],[92,186],[186,40],[230,229],[229,118],[118,230],[202,212],[212,214],[214,202],[83,18],[18,17],[17,83],[76,61],[61,146],[146,76],[160,29],[29,30],[30,160],[56,157],[157,173],[173,56],[106,204],[204,194],[194,106],[135,214],[214,192],[192,135],[203,165],[165,98],[98,203],[21,71],[71,68],[68,21],[51,45],[45,4],[4,51],[144,24],[24,23],[23,144],[77,146],[146,91],[91,77],[205,50],[50,187],[187,205],[201,200],[200,18],[18,201],[91,106],[106,182],[182,91],[90,91],[91,181],[181,90],[85,84],[84,17],[17,85],[206,203],[203,36],[36,206],[148,171],[171,140],[140,148],[92,40],[40,39],[39,92],[193,189],[189,244],[244,193],[159,158],[158,28],[28,159],[247,246],[246,161],[161,247],[236,3],[3,196],[196,236],[54,68],[68,104],[104,54],[193,168],[168,8],[8,193],[117,228],[228,31],[31,117],[189,193],[193,55],[55,189],[98,97],[97,99],[99,98],[126,47],[47,100],[100,126],[166,79],[79,218],[218,166],[155,154],[154,26],[26,155],[209,49],[49,131],[131,209],[135,136],[136,150],[150,135],[47,126],[126,217],[217,47],[223,52],[52,53],[53,223],[45,51],[51,134],[134,45],[211,170],[170,140],[140,211],[67,69],[69,108],[108,67],[43,106],[106,91],[91,43],[230,119],[119,120],[120,230],[226,130],[130,247],[247,226],[63,53],[53,52],[52,63],[238,20],[20,242],[242,238],[46,70],[70,156],[156,46],[78,62],[62,96],[96,78],[46,53],[53,63],[63,46],[143,34],[34,227],[227,143],[123,117],[117,111],[111,123],[44,125],[125,19],[19,44],[236,134],[134,51],[51,236],[216,206],[206,205],[205,216],[154,153],[153,22],[22,154],[39,37],[37,167],[167,39],[200,201],[201,208],[208,200],[36,142],[142,100],[100,36],[57,212],[212,202],[202,57],[20,60],[60,99],[99,20],[28,158],[158,157],[157,28],[35,226],[226,113],[113,35],[160,159],[159,27],[27,160],[204,202],[202,210],[210,204],[113,225],[225,46],[46,113],[43,202],[202,204],[204,43],[62,76],[76,77],[77,62],[137,123],[123,116],[116,137],[41,38],[38,72],[72,41],[203,129],[129,142],[142,203],[64,98],[98,240],[240,64],[49,102],[102,64],[64,49],[41,73],[73,74],[74,41],[212,216],[216,207],[207,212],[42,74],[74,184],[184,42],[169,170],[170,211],[211,169],[170,149],[149,176],[176,170],[105,66],[66,69],[69,105],[122,6],[6,168],[168,122],[123,147],[147,187],[187,123],[96,77],[77,90],[90,96],[65,55],[55,107],[107,65],[89,90],[90,180],[180,89],[101,100],[100,120],[120,101],[63,105],[105,104],[104,63],[93,137],[137,227],[227,93],[15,86],[86,85],[85,15],[129,102],[102,49],[49,129],[14,87],[87,86],[86,14],[55,8],[8,9],[9,55],[100,47],[47,121],[121,100],[145,23],[23,22],[22,145],[88,89],[89,179],[179,88],[6,122],[122,196],[196,6],[88,95],[95,96],[96,88],[138,172],[172,136],[136,138],[215,58],[58,172],[172,215],[115,48],[48,219],[219,115],[42,80],[80,81],[81,42],[195,3],[3,51],[51,195],[43,146],[146,61],[61,43],[171,175],[175,199],[199,171],[81,82],[82,38],[38,81],[53,46],[46,225],[225,53],[144,163],[163,110],[110,144],[52,65],[65,66],[66,52],[229,228],[228,117],[117,229],[34,127],[127,234],[234,34],[107,108],[108,69],[69,107],[109,108],[108,151],[151,109],[48,64],[64,235],[235,48],[62,78],[78,191],[191,62],[129,209],[209,126],[126,129],[111,35],[35,143],[143,111],[117,123],[123,50],[50,117],[222,65],[65,52],[52,222],[19,125],[125,141],[141,19],[221,55],[55,65],[65,221],[3,195],[195,197],[197,3],[25,7],[7,33],[33,25],[220,237],[237,44],[44,220],[70,71],[71,139],[139,70],[122,193],[193,245],[245,122],[247,130],[130,33],[33,247],[71,21],[21,162],[162,71],[170,169],[169,150],[150,170],[188,174],[174,196],[196,188],[216,186],[186,92],[92,216],[2,97],[97,167],[167,2],[141,125],[125,241],[241,141],[164,167],[167,37],[37,164],[72,38],[38,12],[12,72],[38,82],[82,13],[13,38],[63,68],[68,71],[71,63],[226,35],[35,111],[111,226],[101,50],[50,205],[205,101],[206,92],[92,165],[165,206],[209,198],[198,217],[217,209],[165,167],[167,97],[97,165],[220,115],[115,218],[218,220],[133,112],[112,243],[243,133],[239,238],[238,241],[241,239],[214,135],[135,169],[169,214],[190,173],[173,133],[133,190],[171,208],[208,32],[32,171],[125,44],[44,237],[237,125],[86,87],[87,178],[178,86],[85,86],[86,179],[179,85],[84,85],[85,180],[180,84],[83,84],[84,181],[181,83],[201,83],[83,182],[182,201],[137,93],[93,132],[132,137],[76,62],[62,183],[183,76],[61,76],[76,184],[184,61],[57,61],[61,185],[185,57],[212,57],[57,186],[186,212],[214,207],[207,187],[187,214],[34,143],[143,156],[156,34],[79,239],[239,237],[237,79],[123,137],[137,177],[177,123],[44,1],[1,4],[4,44],[201,194],[194,32],[32,201],[64,102],[102,129],[129,64],[213,215],[215,138],[138,213],[59,166],[166,219],[219,59],[242,99],[99,97],[97,242],[2,94],[94,141],[141,2],[75,59],[59,235],[235,75],[24,110],[110,228],[228,24],[25,130],[130,226],[226,25],[23,24],[24,229],[229,23],[22,23],[23,230],[230,22],[26,22],[22,231],[231,26],[112,26],[26,232],[232,112],[189,190],[190,243],[243,189],[221,56],[56,190],[190,221],[28,56],[56,221],[221,28],[27,28],[28,222],[222,27],[29,27],[27,223],[223,29],[30,29],[29,224],[224,30],[247,30],[30,225],[225,247],[238,79],[79,20],[20,238],[166,59],[59,75],[75,166],[60,75],[75,240],[240,60],[147,177],[177,215],[215,147],[20,79],[79,166],[166,20],[187,147],[147,213],[213,187],[112,233],[233,244],[244,112],[233,128],[128,245],[245,233],[128,114],[114,188],[188,128],[114,217],[217,174],[174,114],[131,115],[115,220],[220,131],[217,198],[198,236],[236,217],[198,131],[131,134],[134,198],[177,132],[132,58],[58,177],[143,35],[35,124],[124,143],[110,163],[163,7],[7,110],[228,110],[110,25],[25,228],[356,389],[389,368],[368,356],[11,302],[302,267],[267,11],[452,350],[350,349],[349,452],[302,303],[303,269],[269,302],[357,343],[343,277],[277,357],[452,453],[453,357],[357,452],[333,332],[332,297],[297,333],[175,152],[152,377],[377,175],[347,348],[348,330],[330,347],[303,304],[304,270],[270,303],[9,336],[336,337],[337,9],[278,279],[279,360],[360,278],[418,262],[262,431],[431,418],[304,408],[408,409],[409,304],[310,415],[415,407],[407,310],[270,409],[409,410],[410,270],[450,348],[348,347],[347,450],[422,430],[430,434],[434,422],[313,314],[314,17],[17,313],[306,307],[307,375],[375,306],[387,388],[388,260],[260,387],[286,414],[414,398],[398,286],[335,406],[406,418],[418,335],[364,367],[367,416],[416,364],[423,358],[358,327],[327,423],[251,284],[284,298],[298,251],[281,5],[5,4],[4,281],[373,374],[374,253],[253,373],[307,320],[320,321],[321,307],[425,427],[427,411],[411,425],[421,313],[313,18],[18,421],[321,405],[405,406],[406,321],[320,404],[404,405],[405,320],[315,16],[16,17],[17,315],[426,425],[425,266],[266,426],[377,400],[400,369],[369,377],[322,391],[391,269],[269,322],[417,465],[465,464],[464,417],[386,257],[257,258],[258,386],[466,260],[260,388],[388,466],[456,399],[399,419],[419,456],[284,332],[332,333],[333,284],[417,285],[285,8],[8,417],[346,340],[340,261],[261,346],[413,441],[441,285],[285,413],[327,460],[460,328],[328,327],[355,371],[371,329],[329,355],[392,439],[439,438],[438,392],[382,341],[341,256],[256,382],[429,420],[420,360],[360,429],[364,394],[394,379],[379,364],[277,343],[343,437],[437,277],[443,444],[444,283],[283,443],[275,440],[440,363],[363,275],[431,262],[262,369],[369,431],[297,338],[338,337],[337,297],[273,375],[375,321],[321,273],[450,451],[451,349],[349,450],[446,342],[342,467],[467,446],[293,334],[334,282],[282,293],[458,461],[461,462],[462,458],[276,353],[353,383],[383,276],[308,324],[324,325],[325,308],[276,300],[300,293],[293,276],[372,345],[345,447],[447,372],[352,345],[345,340],[340,352],[274,1],[1,19],[19,274],[456,248],[248,281],[281,456],[436,427],[427,425],[425,436],[381,256],[256,252],[252,381],[269,391],[391,393],[393,269],[200,199],[199,428],[428,200],[266,330],[330,329],[329,266],[287,273],[273,422],[422,287],[250,462],[462,328],[328,250],[258,286],[286,384],[384,258],[265,353],[353,342],[342,265],[387,259],[259,257],[257,387],[424,431],[431,430],[430,424],[342,353],[353,276],[276,342],[273,335],[335,424],[424,273],[292,325],[325,307],[307,292],[366,447],[447,345],[345,366],[271,303],[303,302],[302,271],[423,266],[266,371],[371,423],[294,455],[455,460],[460,294],[279,278],[278,294],[294,279],[271,272],[272,304],[304,271],[432,434],[434,427],[427,432],[272,407],[407,408],[408,272],[394,430],[430,431],[431,394],[395,369],[369,400],[400,395],[334,333],[333,299],[299,334],[351,417],[417,168],[168,351],[352,280],[280,411],[411,352],[325,319],[319,320],[320,325],[295,296],[296,336],[336,295],[319,403],[403,404],[404,319],[330,348],[348,349],[349,330],[293,298],[298,333],[333,293],[323,454],[454,447],[447,323],[15,16],[16,315],[315,15],[358,429],[429,279],[279,358],[14,15],[15,316],[316,14],[285,336],[336,9],[9,285],[329,349],[349,350],[350,329],[374,380],[380,252],[252,374],[318,402],[402,403],[403,318],[6,197],[197,419],[419,6],[318,319],[319,325],[325,318],[367,364],[364,365],[365,367],[435,367],[367,397],[397,435],[344,438],[438,439],[439,344],[272,271],[271,311],[311,272],[195,5],[5,281],[281,195],[273,287],[287,291],[291,273],[396,428],[428,199],[199,396],[311,271],[271,268],[268,311],[283,444],[444,445],[445,283],[373,254],[254,339],[339,373],[282,334],[334,296],[296,282],[449,347],[347,346],[346,449],[264,447],[447,454],[454,264],[336,296],[296,299],[299,336],[338,10],[10,151],[151,338],[278,439],[439,455],[455,278],[292,407],[407,415],[415,292],[358,371],[371,355],[355,358],[340,345],[345,372],[372,340],[346,347],[347,280],[280,346],[442,443],[443,282],[282,442],[19,94],[94,370],[370,19],[441,442],[442,295],[295,441],[248,419],[419,197],[197,248],[263,255],[255,359],[359,263],[440,275],[275,274],[274,440],[300,383],[383,368],[368,300],[351,412],[412,465],[465,351],[263,467],[467,466],[466,263],[301,368],[368,389],[389,301],[395,378],[378,379],[379,395],[412,351],[351,419],[419,412],[436,426],[426,322],[322,436],[2,164],[164,393],[393,2],[370,462],[462,461],[461,370],[164,0],[0,267],[267,164],[302,11],[11,12],[12,302],[268,12],[12,13],[13,268],[293,300],[300,301],[301,293],[446,261],[261,340],[340,446],[330,266],[266,425],[425,330],[426,423],[423,391],[391,426],[429,355],[355,437],[437,429],[391,327],[327,326],[326,391],[440,457],[457,438],[438,440],[341,382],[382,362],[362,341],[459,457],[457,461],[461,459],[434,430],[430,394],[394,434],[414,463],[463,362],[362,414],[396,369],[369,262],[262,396],[354,461],[461,457],[457,354],[316,403],[403,402],[402,316],[315,404],[404,403],[403,315],[314,405],[405,404],[404,314],[313,406],[406,405],[405,313],[421,418],[418,406],[406,421],[366,401],[401,361],[361,366],[306,408],[408,407],[407,306],[291,409],[409,408],[408,291],[287,410],[410,409],[409,287],[432,436],[436,410],[410,432],[434,416],[416,411],[411,434],[264,368],[368,383],[383,264],[309,438],[438,457],[457,309],[352,376],[376,401],[401,352],[274,275],[275,4],[4,274],[421,428],[428,262],[262,421],[294,327],[327,358],[358,294],[433,416],[416,367],[367,433],[289,455],[455,439],[439,289],[462,370],[370,326],[326,462],[2,326],[326,370],[370,2],[305,460],[460,455],[455,305],[254,449],[449,448],[448,254],[255,261],[261,446],[446,255],[253,450],[450,449],[449,253],[252,451],[451,450],[450,252],[256,452],[452,451],[451,256],[341,453],[453,452],[452,341],[413,464],[464,463],[463,413],[441,413],[413,414],[414,441],[258,442],[442,441],[441,258],[257,443],[443,442],[442,257],[259,444],[444,443],[443,259],[260,445],[445,444],[444,260],[467,342],[342,445],[445,467],[459,458],[458,250],[250,459],[289,392],[392,290],[290,289],[290,328],[328,460],[460,290],[376,433],[433,435],[435,376],[250,290],[290,392],[392,250],[411,416],[416,433],[433,411],[341,463],[463,464],[464,341],[453,464],[464,465],[465,453],[357,465],[465,412],[412,357],[343,412],[412,399],[399,343],[360,363],[363,440],[440,360],[437,399],[399,456],[456,437],[420,456],[456,363],[363,420],[401,435],[435,288],[288,401],[372,383],[383,353],[353,372],[339,255],[255,249],[249,339],[448,261],[261,255],[255,448],[133,243],[243,190],[190,133],[133,155],[155,112],[112,133],[33,246],[246,247],[247,33],[33,130],[130,25],[25,33],[398,384],[384,286],[286,398],[362,398],[398,414],[414,362],[362,463],[463,341],[341,362],[263,359],[359,467],[467,263],[263,249],[249,255],[255,263],[466,467],[467,260],[260,466],[75,60],[60,166],[166,75],[238,239],[239,79],[79,238],[162,127],[127,139],[139,162],[72,11],[11,37],[37,72],[121,232],[232,120],[120,121],[73,72],[72,39],[39,73],[114,128],[128,47],[47,114],[233,232],[232,128],[128,233],[103,104],[104,67],[67,103],[152,175],[175,148],[148,152],[119,118],[118,101],[101,119],[74,73],[73,40],[40,74],[107,9],[9,108],[108,107],[49,48],[48,131],[131,49],[32,194],[194,211],[211,32],[184,74],[74,185],[185,184],[191,80],[80,183],[183,191],[185,40],[40,186],[186,185],[119,230],[230,118],[118,119],[210,202],[202,214],[214,210],[84,83],[83,17],[17,84],[77,76],[76,146],[146,77],[161,160],[160,30],[30,161],[190,56],[56,173],[173,190],[182,106],[106,194],[194,182],[138,135],[135,192],[192,138],[129,203],[203,98],[98,129],[54,21],[21,68],[68,54],[5,51],[51,4],[4,5],[145,144],[144,23],[23,145],[90,77],[77,91],[91,90],[207,205],[205,187],[187,207],[83,201],[201,18],[18,83],[181,91],[91,182],[182,181],[180,90],[90,181],[181,180],[16,85],[85,17],[17,16],[205,206],[206,36],[36,205],[176,148],[148,140],[140,176],[165,92],[92,39],[39,165],[245,193],[193,244],[244,245],[27,159],[159,28],[28,27],[30,247],[247,161],[161,30],[174,236],[236,196],[196,174],[103,54],[54,104],[104,103],[55,193],[193,8],[8,55],[111,117],[117,31],[31,111],[221,189],[189,55],[55,221],[240,98],[98,99],[99,240],[142,126],[126,100],[100,142],[219,166],[166,218],[218,219],[112,155],[155,26],[26,112],[198,209],[209,131],[131,198],[169,135],[135,150],[150,169],[114,47],[47,217],[217,114],[224,223],[223,53],[53,224],[220,45],[45,134],[134,220],[32,211],[211,140],[140,32],[109,67],[67,108],[108,109],[146,43],[43,91],[91,146],[231,230],[230,120],[120,231],[113,226],[226,247],[247,113],[105,63],[63,52],[52,105],[241,238],[238,242],[242,241],[124,46],[46,156],[156,124],[95,78],[78,96],[96,95],[70,46],[46,63],[63,70],[116,143],[143,227],[227,116],[116,123],[123,111],[111,116],[1,44],[44,19],[19,1],[3,236],[236,51],[51,3],[207,216],[216,205],[205,207],[26,154],[154,22],[22,26],[165,39],[39,167],[167,165],[199,200],[200,208],[208,199],[101,36],[36,100],[100,101],[43,57],[57,202],[202,43],[242,20],[20,99],[99,242],[56,28],[28,157],[157,56],[124,35],[35,113],[113,124],[29,160],[160,27],[27,29],[211,204],[204,210],[210,211],[124,113],[113,46],[46,124],[106,43],[43,204],[204,106],[96,62],[62,77],[77,96],[227,137],[137,116],[116,227],[73,41],[41,72],[72,73],[36,203],[203,142],[142,36],[235,64],[64,240],[240,235],[48,49],[49,64],[64,48],[42,41],[41,74],[74,42],[214,212],[212,207],[207,214],[183,42],[42,184],[184,183],[210,169],[169,211],[211,210],[140,170],[170,176],[176,140],[104,105],[105,69],[69,104],[193,122],[122,168],[168,193],[50,123],[123,187],[187,50],[89,96],[96,90],[90,89],[66,65],[65,107],[107,66],[179,89],[89,180],[180,179],[119,101],[101,120],[120,119],[68,63],[63,104],[104,68],[234,93],[93,227],[227,234],[16,15],[15,85],[85,16],[209,129],[129,49],[49,209],[15,14],[14,86],[86,15],[107,55],[55,9],[9,107],[120,100],[100,121],[121,120],[153,145],[145,22],[22,153],[178,88],[88,179],[179,178],[197,6],[6,196],[196,197],[89,88],[88,96],[96,89],[135,138],[138,136],[136,135],[138,215],[215,172],[172,138],[218,115],[115,219],[219,218],[41,42],[42,81],[81,41],[5,195],[195,51],[51,5],[57,43],[43,61],[61,57],[208,171],[171,199],[199,208],[41,81],[81,38],[38,41],[224,53],[53,225],[225,224],[24,144],[144,110],[110,24],[105,52],[52,66],[66,105],[118,229],[229,117],[117,118],[227,34],[34,234],[234,227],[66,107],[107,69],[69,66],[10,109],[109,151],[151,10],[219,48],[48,235],[235,219],[183,62],[62,191],[191,183],[142,129],[129,126],[126,142],[116,111],[111,143],[143,116],[118,117],[117,50],[50,118],[223,222],[222,52],[52,223],[94,19],[19,141],[141,94],[222,221],[221,65],[65,222],[196,3],[3,197],[197,196],[45,220],[220,44],[44,45],[156,70],[70,139],[139,156],[188,122],[122,245],[245,188],[139,71],[71,162],[162,139],[149,170],[170,150],[150,149],[122,188],[188,196],[196,122],[206,216],[216,92],[92,206],[164,2],[2,167],[167,164],[242,141],[141,241],[241,242],[0,164],[164,37],[37,0],[11,72],[72,12],[12,11],[12,38],[38,13],[13,12],[70,63],[63,71],[71,70],[31,226],[226,111],[111,31],[36,101],[101,205],[205,36],[203,206],[206,165],[165,203],[126,209],[209,217],[217,126],[98,165],[165,97],[97,98],[237,220],[220,218],[218,237],[237,239],[239,241],[241,237],[210,214],[214,169],[169,210],[140,171],[171,32],[32,140],[241,125],[125,237],[237,241],[179,86],[86,178],[178,179],[180,85],[85,179],[179,180],[181,84],[84,180],[180,181],[182,83],[83,181],[181,182],[194,201],[201,182],[182,194],[177,137],[137,132],[132,177],[184,76],[76,183],[183,184],[185,61],[61,184],[184,185],[186,57],[57,185],[185,186],[216,212],[212,186],[186,216],[192,214],[214,187],[187,192],[139,34],[34,156],[156,139],[218,79],[79,237],[237,218],[147,123],[123,177],[177,147],[45,44],[44,4],[4,45],[208,201],[201,32],[32,208],[98,64],[64,129],[129,98],[192,213],[213,138],[138,192],[235,59],[59,219],[219,235],[141,242],[242,97],[97,141],[97,2],[2,141],[141,97],[240,75],[75,235],[235,240],[229,24],[24,228],[228,229],[31,25],[25,226],[226,31],[230,23],[23,229],[229,230],[231,22],[22,230],[230,231],[232,26],[26,231],[231,232],[233,112],[112,232],[232,233],[244,189],[189,243],[243,244],[189,221],[221,190],[190,189],[222,28],[28,221],[221,222],[223,27],[27,222],[222,223],[224,29],[29,223],[223,224],[225,30],[30,224],[224,225],[113,247],[247,225],[225,113],[99,60],[60,240],[240,99],[213,147],[147,215],[215,213],[60,20],[20,166],[166,60],[192,187],[187,213],[213,192],[243,112],[112,244],[244,243],[244,233],[233,245],[245,244],[245,128],[128,188],[188,245],[188,114],[114,174],[174,188],[134,131],[131,220],[220,134],[174,217],[217,236],[236,174],[236,198],[198,134],[134,236],[215,177],[177,58],[58,215],[156,143],[143,124],[124,156],[25,110],[110,7],[7,25],[31,228],[228,25],[25,31],[264,356],[356,368],[368,264],[0,11],[11,267],[267,0],[451,452],[452,349],[349,451],[267,302],[302,269],[269,267],[350,357],[357,277],[277,350],[350,452],[452,357],[357,350],[299,333],[333,297],[297,299],[396,175],[175,377],[377,396],[280,347],[347,330],[330,280],[269,303],[303,270],[270,269],[151,9],[9,337],[337,151],[344,278],[278,360],[360,344],[424,418],[418,431],[431,424],[270,304],[304,409],[409,270],[272,310],[310,407],[407,272],[322,270],[270,410],[410,322],[449,450],[450,347],[347,449],[432,422],[422,434],[434,432],[18,313],[313,17],[17,18],[291,306],[306,375],[375,291],[259,387],[387,260],[260,259],[424,335],[335,418],[418,424],[434,364],[364,416],[416,434],[391,423],[423,327],[327,391],[301,251],[251,298],[298,301],[275,281],[281,4],[4,275],[254,373],[373,253],[253,254],[375,307],[307,321],[321,375],[280,425],[425,411],[411,280],[200,421],[421,18],[18,200],[335,321],[321,406],[406,335],[321,320],[320,405],[405,321],[314,315],[315,17],[17,314],[423,426],[426,266],[266,423],[396,377],[377,369],[369,396],[270,322],[322,269],[269,270],[413,417],[417,464],[464,413],[385,386],[386,258],[258,385],[248,456],[456,419],[419,248],[298,284],[284,333],[333,298],[168,417],[417,8],[8,168],[448,346],[346,261],[261,448],[417,413],[413,285],[285,417],[326,327],[327,328],[328,326],[277,355],[355,329],[329,277],[309,392],[392,438],[438,309],[381,382],[382,256],[256,381],[279,429],[429,360],[360,279],[365,364],[364,379],[379,365],[355,277],[277,437],[437,355],[282,443],[443,283],[283,282],[281,275],[275,363],[363,281],[395,431],[431,369],[369,395],[299,297],[297,337],[337,299],[335,273],[273,321],[321,335],[348,450],[450,349],[349,348],[359,446],[446,467],[467,359],[283,293],[293,282],[282,283],[250,458],[458,462],[462,250],[300,276],[276,383],[383,300],[292,308],[308,325],[325,292],[283,276],[276,293],[293,283],[264,372],[372,447],[447,264],[346,352],[352,340],[340,346],[354,274],[274,19],[19,354],[363,456],[456,281],[281,363],[426,436],[436,425],[425,426],[380,381],[381,252],[252,380],[267,269],[269,393],[393,267],[421,200],[200,428],[428,421],[371,266],[266,329],[329,371],[432,287],[287,422],[422,432],[290,250],[250,328],[328,290],[385,258],[258,384],[384,385],[446,265],[265,342],[342,446],[386,387],[387,257],[257,386],[422,424],[424,430],[430,422],[445,342],[342,276],[276,445],[422,273],[273,424],[424,422],[306,292],[292,307],[307,306],[352,366],[366,345],[345,352],[268,271],[271,302],[302,268],[358,423],[423,371],[371,358],[327,294],[294,460],[460,327],[331,279],[279,294],[294,331],[303,271],[271,304],[304,303],[436,432],[432,427],[427,436],[304,272],[272,408],[408,304],[395,394],[394,431],[431,395],[378,395],[395,400],[400,378],[296,334],[334,299],[299,296],[6,351],[351,168],[168,6],[376,352],[352,411],[411,376],[307,325],[325,320],[320,307],[285,295],[295,336],[336,285],[320,319],[319,404],[404,320],[329,330],[330,349],[349,329],[334,293],[293,333],[333,334],[366,323],[323,447],[447,366],[316,15],[15,315],[315,316],[331,358],[358,279],[279,331],[317,14],[14,316],[316,317],[8,285],[285,9],[9,8],[277,329],[329,350],[350,277],[253,374],[374,252],[252,253],[319,318],[318,403],[403,319],[351,6],[6,419],[419,351],[324,318],[318,325],[325,324],[397,367],[367,365],[365,397],[288,435],[435,397],[397,288],[278,344],[344,439],[439,278],[310,272],[272,311],[311,310],[248,195],[195,281],[281,248],[375,273],[273,291],[291,375],[175,396],[396,199],[199,175],[312,311],[311,268],[268,312],[276,283],[283,445],[445,276],[390,373],[373,339],[339,390],[295,282],[282,296],[296,295],[448,449],[449,346],[346,448],[356,264],[264,454],[454,356],[337,336],[336,299],[299,337],[337,338],[338,151],[151,337],[294,278],[278,455],[455,294],[308,292],[292,415],[415,308],[429,358],[358,355],[355,429],[265,340],[340,372],[372,265],[352,346],[346,280],[280,352],[295,442],[442,282],[282,295],[354,19],[19,370],[370,354],[285,441],[441,295],[295,285],[195,248],[248,197],[197,195],[457,440],[440,274],[274,457],[301,300],[300,368],[368,301],[417,351],[351,465],[465,417],[251,301],[301,389],[389,251],[394,395],[395,379],[379,394],[399,412],[412,419],[419,399],[410,436],[436,322],[322,410],[326,2],[2,393],[393,326],[354,370],[370,461],[461,354],[393,164],[164,267],[267,393],[268,302],[302,12],[12,268],[312,268],[268,13],[13,312],[298,293],[293,301],[301,298],[265,446],[446,340],[340,265],[280,330],[330,425],[425,280],[322,426],[426,391],[391,322],[420,429],[429,437],[437,420],[393,391],[391,326],[326,393],[344,440],[440,438],[438,344],[458,459],[459,461],[461,458],[364,434],[434,394],[394,364],[428,396],[396,262],[262,428],[274,354],[354,457],[457,274],[317,316],[316,402],[402,317],[316,315],[315,403],[403,316],[315,314],[314,404],[404,315],[314,313],[313,405],[405,314],[313,421],[421,406],[406,313],[323,366],[366,361],[361,323],[292,306],[306,407],[407,292],[306,291],[291,408],[408,306],[291,287],[287,409],[409,291],[287,432],[432,410],[410,287],[427,434],[434,411],[411,427],[372,264],[264,383],[383,372],[459,309],[309,457],[457,459],[366,352],[352,401],[401,366],[1,274],[274,4],[4,1],[418,421],[421,262],[262,418],[331,294],[294,358],[358,331],[435,433],[433,367],[367,435],[392,289],[289,439],[439,392],[328,462],[462,326],[326,328],[94,2],[2,370],[370,94],[289,305],[305,455],[455,289],[339,254],[254,448],[448,339],[359,255],[255,446],[446,359],[254,253],[253,449],[449,254],[253,252],[252,450],[450,253],[252,256],[256,451],[451,252],[256,341],[341,452],[452,256],[414,413],[413,463],[463,414],[286,441],[441,414],[414,286],[286,258],[258,441],[441,286],[258,257],[257,442],[442,258],[257,259],[259,443],[443,257],[259,260],[260,444],[444,259],[260,467],[467,445],[445,260],[309,459],[459,250],[250,309],[305,289],[289,290],[290,305],[305,290],[290,460],[460,305],[401,376],[376,435],[435,401],[309,250],[250,392],[392,309],[376,411],[411,433],[433,376],[453,341],[341,464],[464,453],[357,453],[453,465],[465,357],[343,357],[357,412],[412,343],[437,343],[343,399],[399,437],[344,360],[360,440],[440,344],[420,437],[437,456],[456,420],[360,420],[420,363],[363,360],[361,401],[401,288],[288,361],[265,372],[372,353],[353,265],[390,339],[339,249],[249,390],[339,448],[448,255],[255,339]],MZ=Object.entries(TZ).map((function(t){var e=t[0];return t[1].map((function(t){return[t,e]}))})).flat(),CZ=new Map(MZ);function AZ(t){for(var e={locationData:{relativeKeypoints:[]}},n=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,o=Number.MIN_SAFE_INTEGER,a=0;a<t.length;++a){var s=t[a];n=Math.min(n,s.x),r=Math.max(r,s.x),i=Math.min(i,s.y),o=Math.max(o,s.y),e.locationData.relativeKeypoints.push({x:s.x,y:s.y})}return e.locationData.relativeBoundingBox={xMin:n,yMin:i,xMax:r,yMax:o,width:r-n,height:o-i},e}var kZ={runtime:"mediapipe",maxFaces:1,refineLandmarks:!1},IZ=function(){function t(t){var e=this;this.width=0,this.height=0,this.selfieMode=!1,this.faceMeshSolution=new $O.FaceMesh({locateFile:function(e,n){return t.solutionPath?t.solutionPath.replace(/\/+$/,"")+"/"+e:n+"/"+e}}),this.faceMeshSolution.setOptions({refineLandmarks:t.refineLandmarks,selfieMode:this.selfieMode,maxNumFaces:t.maxFaces}),this.faceMeshSolution.onResults((function(t){if(e.height=t.image.height,e.width=t.image.width,e.faces=[],null!==t.multiFaceLandmarks)for(var n=t.multiFaceLandmarks,r=0;r<n.length;r++){var i=e.translateOutput(n[r]);e.faces.push({keypoints:i,box:AZ(i).locationData.relativeBoundingBox})}}))}return t.prototype.translateOutput=function(t){var e=this;return t.map((function(t,n){var r={x:t.x*e.width,y:t.y*e.height,z:t.z*e.width},i=CZ.get(n);return null!=i&&(r.name=i),r}))},t.prototype.estimateFaces=function(t,e){return _Z(this,void 0,void 0,(function(){var n,r;return wZ(this,(function(i){switch(i.label){case 0:return e&&e.flipHorizontal&&e.flipHorizontal!==this.selfieMode&&(this.selfieMode=e.flipHorizontal,this.faceMeshSolution.setOptions({selfieMode:this.selfieMode})),t instanceof bB?(r=ImageData.bind,[4,cV(t)]):[3,2];case 1:return n=new(r.apply(ImageData,[void 0,i.sent(),t.shape[1],t.shape[0]])),[3,3];case 2:n=t,i.label=3;case 3:return t=n,[4,this.faceMeshSolution.send({image:t})];case 4:return i.sent(),[2,this.faces]}}))}))},t.prototype.dispose=function(){this.faceMeshSolution.close()},t.prototype.reset=function(){this.faceMeshSolution.reset(),this.width=0,this.height=0,this.faces=null,this.selfieMode=!1},t.prototype.initialize=function(){return this.faceMeshSolution.initialize()},t}();function RZ(t){return _Z(this,void 0,void 0,(function(){var e,n;return wZ(this,(function(r){switch(r.label){case 0:return e=function(t){if(null==t)return xZ({},kZ);var e=xZ({},t);return e.runtime="mediapipe",null==e.maxFaces&&(e.maxFaces=kZ.maxFaces),null==e.refineLandmarks&&(e.refineLandmarks=kZ.refineLandmarks),e}(t),[4,(n=new IZ(e)).initialize()];case 1:return r.sent(),[2,n]}}))}))}var PZ="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof __webpack_require__.g?__webpack_require__.g:"undefined"!=typeof self?self:{},NZ={};(function(){var t;function e(t){var e=0;return function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}}var n="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){return t==Array.prototype||t==Object.prototype||(t[e]=n.value),t},r=function(t){t=["object"==typeof globalThis&&globalThis,t,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof PZ&&PZ];for(var e=0;e<t.length;++e){var n=t[e];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);function i(t,e){if(e)t:{var i=r;t=t.split(".");for(var o=0;o<t.length-1;o++){var a=t[o];if(!(a in i))break t;i=i[a]}(e=e(o=i[t=t[t.length-1]]))!=o&&null!=e&&n(i,t,{configurable:!0,writable:!0,value:e})}}function o(t){return(t={next:t})[Symbol.iterator]=function(){return this},t}function a(t){var n="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];return n?n.call(t):{next:e(t)}}function s(t){if(!(t instanceof Array)){t=a(t);for(var e,n=[];!(e=t.next()).done;)n.push(e.value);t=n}return t}i("Symbol",(function(t){function e(t,e){this.g=t,n(this,"description",{configurable:!0,writable:!0,value:e})}if(t)return t;e.prototype.toString=function(){return this.g};var r="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",i=0;return function t(n){if(this instanceof t)throw new TypeError("Symbol is not a constructor");return new e(r+(n||"")+"_"+i++,n)}})),i("Symbol.iterator",(function(t){if(t)return t;t=Symbol("Symbol.iterator");for(var i="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),a=0;a<i.length;a++){var s=r[i[a]];"function"==typeof s&&"function"!=typeof s.prototype[t]&&n(s.prototype,t,{configurable:!0,writable:!0,value:function(){return o(e(this))}})}return t}));var l,c="function"==typeof Object.create?Object.create:function(t){function e(){}return e.prototype=t,new e};if("function"==typeof Object.setPrototypeOf)l=Object.setPrototypeOf;else{var u;t:{var h={};try{h.__proto__={a:!0},u=h.a;break t}catch(t){}u=!1}l=u?function(t,e){if(t.__proto__=e,t.__proto__!==e)throw new TypeError(t+" is not extensible");return t}:null}var d=l;function p(t,e){if(t.prototype=c(e.prototype),t.prototype.constructor=t,d)d(t,e);else for(var n in e)if("prototype"!=n)if(Object.defineProperties){var r=Object.getOwnPropertyDescriptor(e,n);r&&Object.defineProperty(t,n,r)}else t[n]=e[n];t.na=e.prototype}function f(){this.l=!1,this.i=null,this.h=void 0,this.g=1,this.u=this.o=0,this.j=null}function m(t){if(t.l)throw new TypeError("Generator is already running");t.l=!0}function g(t,e){t.j={da:e,ea:!0},t.g=t.o||t.u}function y(t,e,n){return t.g=n,{value:e}}function v(t){this.g=new f,this.h=t}function b(t,e,n,r){try{var i=e.call(t.g.i,n);if(!(i instanceof Object))throw new TypeError("Iterator result "+i+" is not an object");if(!i.done)return t.g.l=!1,i;var o=i.value}catch(e){return t.g.i=null,g(t.g,e),x(t)}return t.g.i=null,r.call(t.g,o),x(t)}function x(t){for(;t.g.g;)try{var e=t.h(t.g);if(e)return t.g.l=!1,{value:e.value,done:!1}}catch(e){t.g.h=void 0,g(t.g,e)}if(t.g.l=!1,t.g.j){if(e=t.g.j,t.g.j=null,e.ea)throw e.da;return{value:e.return,done:!0}}return{value:void 0,done:!0}}function _(t){this.next=function(e){return m(t.g),t.g.i?e=b(t,t.g.i.next,e,t.g.s):(t.g.s(e),e=x(t)),e},this.throw=function(e){return m(t.g),t.g.i?e=b(t,t.g.i.throw,e,t.g.s):(g(t.g,e),e=x(t)),e},this.return=function(e){return function(t,e){m(t.g);var n=t.g.i;return n?b(t,"return"in n?n.return:function(t){return{value:t,done:!0}},e,t.g.return):(t.g.return(e),x(t))}(t,e)},this[Symbol.iterator]=function(){return this}}function w(t){return function(t){function e(e){return t.next(e)}function n(e){return t.throw(e)}return new Promise((function(r,i){!function t(o){o.done?r(o.value):Promise.resolve(o.value).then(e,n).then(t,i)}(t.next())}))}(new _(new v(t)))}f.prototype.s=function(t){this.h=t},f.prototype.return=function(t){this.j={return:t},this.g=this.u},i("Promise",(function(t){function e(t){this.h=0,this.i=void 0,this.g=[],this.s=!1;var e=this.j();try{t(e.resolve,e.reject)}catch(t){e.reject(t)}}function n(){this.g=null}function i(t){return t instanceof e?t:new e((function(e){e(t)}))}if(t)return t;n.prototype.h=function(t){if(null==this.g){this.g=[];var e=this;this.i((function(){e.l()}))}this.g.push(t)};var o=r.setTimeout;n.prototype.i=function(t){o(t,0)},n.prototype.l=function(){for(;this.g&&this.g.length;){var t=this.g;this.g=[];for(var e=0;e<t.length;++e){var n=t[e];t[e]=null;try{n()}catch(t){this.j(t)}}}this.g=null},n.prototype.j=function(t){this.i((function(){throw t}))},e.prototype.j=function(){function t(t){return function(r){n||(n=!0,t.call(e,r))}}var e=this,n=!1;return{resolve:t(this.D),reject:t(this.l)}},e.prototype.D=function(t){if(t===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(t instanceof e)this.H(t);else{t:switch(typeof t){case"object":var n=null!=t;break t;case"function":n=!0;break t;default:n=!1}n?this.A(t):this.o(t)}},e.prototype.A=function(t){var e=void 0;try{e=t.then}catch(t){return void this.l(t)}"function"==typeof e?this.I(e,t):this.o(t)},e.prototype.l=function(t){this.u(2,t)},e.prototype.o=function(t){this.u(1,t)},e.prototype.u=function(t,e){if(0!=this.h)throw Error("Cannot settle("+t+", "+e+"): Promise already settled in state"+this.h);this.h=t,this.i=e,2===this.h&&this.G(),this.B()},e.prototype.G=function(){var t=this;o((function(){if(t.C()){var e=r.console;void 0!==e&&e.error(t.i)}}),1)},e.prototype.C=function(){if(this.s)return!1;var t=r.CustomEvent,e=r.Event,n=r.dispatchEvent;return void 0===n||("function"==typeof t?t=new t("unhandledrejection",{cancelable:!0}):"function"==typeof e?t=new e("unhandledrejection",{cancelable:!0}):(t=r.document.createEvent("CustomEvent")).initCustomEvent("unhandledrejection",!1,!0,t),t.promise=this,t.reason=this.i,n(t))},e.prototype.B=function(){if(null!=this.g){for(var t=0;t<this.g.length;++t)s.h(this.g[t]);this.g=null}};var s=new n;return e.prototype.H=function(t){var e=this.j();t.M(e.resolve,e.reject)},e.prototype.I=function(t,e){var n=this.j();try{t.call(e,n.resolve,n.reject)}catch(t){n.reject(t)}},e.prototype.then=function(t,n){function r(t,e){return"function"==typeof t?function(e){try{i(t(e))}catch(t){o(t)}}:e}var i,o,a=new e((function(t,e){i=t,o=e}));return this.M(r(t,i),r(n,o)),a},e.prototype.catch=function(t){return this.then(void 0,t)},e.prototype.M=function(t,e){function n(){switch(r.h){case 1:t(r.i);break;case 2:e(r.i);break;default:throw Error("Unexpected state: "+r.h)}}var r=this;null==this.g?s.h(n):this.g.push(n),this.s=!0},e.resolve=i,e.reject=function(t){return new e((function(e,n){n(t)}))},e.race=function(t){return new e((function(e,n){for(var r=a(t),o=r.next();!o.done;o=r.next())i(o.value).M(e,n)}))},e.all=function(t){var n=a(t),r=n.next();return r.done?i([]):new e((function(t,e){function o(e){return function(n){a[e]=n,0==--s&&t(a)}}var a=[],s=0;do{a.push(void 0),s++,i(r.value).M(o(a.length-1),e),r=n.next()}while(!r.done)}))},e}));var S="function"==typeof Object.assign?Object.assign:function(t,e){for(var n=1;n<arguments.length;n++){var r=arguments[n];if(r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t};i("Object.assign",(function(t){return t||S})),i("Object.is",(function(t){return t||function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}})),i("Array.prototype.includes",(function(t){return t||function(t,e){var n=this;n instanceof String&&(n=String(n));var r=n.length;for(0>(e=e||0)&&(e=Math.max(e+r,0));e<r;e++){var i=n[e];if(i===t||Object.is(i,t))return!0}return!1}})),i("String.prototype.includes",(function(t){return t||function(t,e){if(null==this)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(t instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return-1!==this.indexOf(t,e||0)}})),i("Array.prototype.keys",(function(t){return t||function(){return function(t,e){t instanceof String&&(t+="");var n=0,r=!1,i={next:function(){if(!r&&n<t.length){var i=n++;return{value:e(i,t[i]),done:!1}}return r=!0,{done:!0,value:void 0}}};return i[Symbol.iterator]=function(){return i},i}(this,(function(t){return t}))}}));var T=this||self;function E(t,e){t=t.split(".");var n,r=T;t[0]in r||void 0===r.execScript||r.execScript("var "+t[0]);for(;t.length&&(n=t.shift());)t.length||void 0===e?r=r[n]&&r[n]!==Object.prototype[n]?r[n]:r[n]={}:r[n]=e}function M(){throw Error("Invalid UTF8")}function C(t,e){return e=String.fromCharCode.apply(null,e),null==t?e:t+e}var A,k,I="undefined"!=typeof TextDecoder,R="undefined"!=typeof TextEncoder,P={},N=null;function O(t){var e;void 0===e&&(e=0),L(),e=P[e];for(var n=Array(Math.floor(t.length/3)),r=e[64]||"",i=0,o=0;i<t.length-2;i+=3){var a=t[i],s=t[i+1],l=t[i+2],c=e[a>>2];a=e[(3&a)<<4|s>>4],s=e[(15&s)<<2|l>>6],l=e[63&l],n[o++]=c+a+s+l}switch(c=0,l=r,t.length-i){case 2:l=e[(15&(c=t[i+1]))<<2]||r;case 1:t=t[i],n[o]=e[t>>2]+e[(3&t)<<4|c>>4]+l+r}return n.join("")}function D(t){var e=t.length,n=3*e/4;n%3?n=Math.floor(n):-1!="=.".indexOf(t[e-1])&&(n=-1!="=.".indexOf(t[e-2])?n-2:n-1);var r=new Uint8Array(n),i=0;return function(t,e){function n(e){for(;r<t.length;){var n=t.charAt(r++),i=N[n];if(null!=i)return i;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return e}L();for(var r=0;;){var i=n(-1),o=n(0),a=n(64),s=n(64);if(64===s&&-1===i)break;e(i<<2|o>>4),64!=a&&(e(o<<4&240|a>>2),64!=s&&e(a<<6&192|s))}}(t,(function(t){r[i++]=t})),i!==n?r.subarray(0,i):r}function L(){if(!N){N={};for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),e=["+/=","+/","-_=","-_.","-_"],n=0;5>n;n++){var r=t.concat(e[n].split(""));P[n]=r;for(var i=0;i<r.length;i++){var o=r[i];void 0===N[o]&&(N[o]=i)}}}}var F,U="function"==typeof Uint8Array;function B(t){return U&&null!=t&&t instanceof Uint8Array}function z(t){if(this.L=t,null!==t&&0===t.length)throw Error("ByteString should be constructed with non-empty values")}var j="function"==typeof Uint8Array.prototype.slice,V=0;function W(t,e){return Error("Invalid wire type: "+t+" (at position "+e+")")}function G(){return Error("Failed to read varint, encoding is invalid.")}function H(t,e){e=void 0!==(e=void 0===e?{}:e).v&&e.v,this.h=null,this.g=this.i=this.j=0,this.v=e,t&&q(this,t)}function q(t,e){t.h=function(t,e){if(t.constructor===Uint8Array)return t;if(t.constructor===ArrayBuffer)return new Uint8Array(t);if(t.constructor===Array)return new Uint8Array(t);if(t.constructor===String)return D(t);if(t.constructor===z)return!e&&(e=t.L)&&e.constructor===Uint8Array?e:(e=null==(e=t.L)||B(e)?e:"string"==typeof e?D(e):null,(t=t.L=e)?new Uint8Array(t):F||(F=new Uint8Array(0)));if(t instanceof Uint8Array)return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, or Array of numbers")}(e,t.v),t.j=0,t.i=t.h.length,t.g=t.j}function X(t){if(t.g>t.i)throw Error("Tried to read past the end of the data "+t.g+" > "+t.i)}function Y(t){var e=t.h,n=e[t.g],r=127&n;if(128>n)return t.g+=1,X(t),r;if(r|=(127&(n=e[t.g+1]))<<7,128>n)return t.g+=2,X(t),r;if(r|=(127&(n=e[t.g+2]))<<14,128>n)return t.g+=3,X(t),r;if(r|=(127&(n=e[t.g+3]))<<21,128>n)return t.g+=4,X(t),r;if(n=e[t.g+4],t.g+=5,r|=(15&n)<<28,128>n)return X(t),r;if(128<=e[t.g++]&&128<=e[t.g++]&&128<=e[t.g++]&&128<=e[t.g++]&&128<=e[t.g++])throw G();return X(t),r}H.prototype.reset=function(){this.g=this.j};var K=[];function Z(){this.g=[]}function J(t,e){for(;127<e;)t.g.push(127&e|128),e>>>=7;t.g.push(e)}function Q(t){var e={},n=void 0!==e.W&&e.W;this.l={v:void 0!==e.v&&e.v},this.W=n,e=this.l,K.length?(n=K.pop(),e&&(n.v=e.v),t&&q(n,t),t=n):t=new H(t,e),this.g=t,this.j=this.g.g,this.h=this.i=-1}function $(t){var e=t.g;if(e.g==e.i)return!1;t.j=t.g.g;var n=Y(t.g)>>>0;if(e=n>>>3,!(0<=(n&=7)&&5>=n))throw W(n,t.j);if(1>e)throw Error("Invalid field number: "+e+" (at position "+t.j+")");return t.i=e,t.h=n,!0}function tt(t){switch(t.h){case 0:if(0!=t.h)tt(t);else t:{for(var e=(t=t.g).g,n=e+10;e<n;)if(0==(128&t.h[e++])){t.g=e,X(t);break t}throw G()}break;case 1:(t=t.g).g+=8,X(t);break;case 2:2!=t.h?tt(t):(e=Y(t.g)>>>0,(t=t.g).g+=e,X(t));break;case 5:(t=t.g).g+=4,X(t);break;case 3:for(e=t.i;;){if(!$(t))throw Error("Unmatched start-group tag: stream EOF");if(4==t.h){if(t.i!=e)throw Error("Unmatched end-group tag");break}tt(t)}break;default:throw W(t.h,t.j)}}Z.prototype.length=function(){return this.g.length},Z.prototype.end=function(){var t=this.g;return this.g=[],t},Q.prototype.reset=function(){this.g.reset(),this.j=this.g.g,this.h=this.i=-1};var et=[];function nt(){this.i=[],this.h=0,this.g=new Z}function rt(t,e){0!==e.length&&(t.i.push(e),t.h+=e.length)}var it="function"==typeof Symbol&&"symbol"==typeof Symbol()?Symbol(void 0):void 0;function ot(t,e){Object.isFrozen(t)||(it?t[it]|=e:void 0!==t.N?t.N|=e:Object.defineProperties(t,{N:{value:e,configurable:!0,writable:!0,enumerable:!1}}))}function at(t){var e;return null==(e=it?t[it]:t.N)?0:e}function st(t){return ot(t,1),t}function lt(t){return!!Array.isArray(t)&&!!(2&at(t))}function ct(t){if(!Array.isArray(t))throw Error("cannot mark non-array as immutable");ot(t,2)}function ut(t){return null!==t&&"object"==typeof t&&!Array.isArray(t)&&t.constructor===Object}var ht=Object.freeze(st([]));function dt(t){if(lt(t.m))throw Error("Cannot mutate an immutable Message")}var pt,ft="undefined"!=typeof Symbol&&void 0!==Symbol.hasInstance;function mt(t){return{value:t,configurable:!1,writable:!1,enumerable:!1}}function gt(t,e,n){return-1===e?null:e>=t.i?t.g?t.g[e]:void 0:void 0!==n&&n&&t.g&&null!=(n=t.g[e])?n:t.m[e+t.h]}function yt(t,e,n,r){r=void 0!==r&&r,dt(t),e<t.i&&!r?t.m[e+t.h]=n:(t.g||(t.g=t.m[t.i+t.h]={}))[e]=n}function vt(t,e,n,r){n=void 0===n||n;var i=gt(t,e,r=void 0!==r&&r);return null==i&&(i=ht),lt(t.m)?n&&(ct(i),Object.freeze(i)):(i===ht||lt(i))&&yt(t,e,i=st(i.slice()),r),i}function bt(t,e,n){return null==(t=null==(t=gt(t,e))?t:+t)?void 0===n?0:n:t}function xt(t,e,n,r){t.j||(t.j={});var i=lt(t.m),o=t.j[n];if(!o){r=vt(t,n,!0,void 0!==r&&r),o=[],i=i||lt(r);for(var a=0;a<r.length;a++)o[a]=new e(r[a]),i&&ct(o[a].m);i&&(ct(o),Object.freeze(o)),t.j[n]=o}return o}function _t(t,e,n,r,i){var o=void 0!==o&&o;return dt(t),o=xt(t,n,e,o),n=r||new n,t=vt(t,e),null!=i?(o.splice(i,0,n),t.splice(i,0,n.m)):(o.push(n),t.push(n.m)),n}function wt(t,e){return null==(t=gt(t,e))?0:t}function St(t,e){return null==(t=gt(t,e))?"":t}function Tt(t){return Mt(t,void 0===Ct?At:Ct)}function Et(t,e){if(null!=t){if(Array.isArray(t))t=Mt(t,e);else if(ut(t)){var n,r={};for(n in t)r[n]=Et(t[n],e);t=r}else t=e(t);return t}}function Mt(t,e){for(var n=t.slice(),r=0;r<n.length;r++)n[r]=Et(n[r],e);return Array.isArray(t)&&1&at(t)&&st(n),n}function Ct(t){return t&&"object"==typeof t&&t.toJSON?t.toJSON():(t=function(t){switch(typeof t){case"number":return isFinite(t)?t:String(t);case"object":if(t&&!Array.isArray(t)){if(B(t))return O(t);if(t instanceof z){var e=t.L;return e=null==e||"string"==typeof e?e:U&&e instanceof Uint8Array?O(e):null,(t.L=e)||""}}}return t}(t),Array.isArray(t)?Tt(t):t)}function At(t){return B(t)?new Uint8Array(t):t}function kt(t,e,n){t||(t=pt),pt=null;var r=this.constructor.h;if(t||(t=r?[r]:[]),this.h=(r?0:-1)-(this.constructor.g||0),this.j=void 0,this.m=t,t=(r=this.m.length)-1,r&&ut(r=this.m[t])?(this.i=t-this.h,this.g=r):void 0!==e&&-1<e?(this.i=Math.max(e,t+1-this.h),this.g=void 0):this.i=Number.MAX_VALUE,n)for(e=0;e<n.length;e++)if((t=n[e])<this.i)t+=this.h,(r=this.m[t])?Array.isArray(r)&&st(r):this.m[t]=ht;else{var i=(r=this.g||(this.g=this.m[this.i+this.h]={}))[t];i?Array.isArray(i)&&st(i):r[t]=ht}}function It(){kt.apply(this,arguments)}if(kt.prototype.toJSON=function(){return Tt(this.m)},kt.prototype.toString=function(){return this.m.toString()},p(It,kt),ft){var Rt={};Object.defineProperties(It,(Rt[Symbol.hasInstance]=mt((function(){throw Error("Cannot perform instanceof checks for MutableMessage")})),Rt))}function Pt(t,e,n){if(n){var r,i={};for(r in n){var o=n[r],a=o.ha;a||(i.F=o.la||o.fa.P,o.aa?(i.U=Bt(o.aa),a=function(t){return function(e,n,r){return t.F(e,n,r,t.U)}}(i)):o.ca?(i.T=zt(o.X.g,o.ca),a=function(t){return function(e,n,r){return t.F(e,n,r,t.T)}}(i)):a=i.F,o.ha=a),a(e,t,o.X),i={F:i.F,U:i.U,T:i.T}}}!function(t,e){if(e=e.ba){rt(t,t.g.end());for(var n=0;n<e.length;n++)rt(t,e[n])}}(e,t)}var Nt=Symbol();function Ot(t,e,n){return t[Nt]||(t[Nt]=function(t,r){return e(t,r,n)})}function Dt(t){var e=t[Nt];if(!e){var n=Qt(t);e=function(t,e){return $t(t,e,n)},t[Nt]=e}return e}function Lt(t){var e=function(t){var e=t.aa;return e?Dt(e):(e=t.ka)?Ot(t.X.g,e,t.ca):void 0}(t),n=t.X,r=t.fa.O;return e?function(t,i){return r(t,i,n,e)}:function(t,e){return r(t,e,n)}}function Ft(t,e,n,r,i,o){var a=0;for((t=t()).length&&"number"!=typeof t[0]&&(n(e,t[0]),a++);a<t.length;){n=t[a++];for(var s=a+1;s<t.length&&"number"!=typeof t[s];)s++;var l=t[a++];switch(s-=a){case 0:r(e,n,l);break;case 1:r(e,n,l,t[a++]);break;case 2:i(e,n,l,t[a++],t[a++]);break;case 3:s=t[a++];var c=t[a++],u=t[a++];Array.isArray(u)?i(e,n,l,s,c,u):o(e,n,l,s,c,u);break;case 4:o(e,n,l,t[a++],t[a++],t[a++],t[a++]);break;default:throw Error("unexpected number of binary field arguments: "+s)}}return e}var Ut=Symbol();function Bt(t){var e=t[Ut];if(!e){var n=qt(t);e=function(t,e){return ee(t,e,n)},t[Ut]=e}return e}function zt(t,e){var n=t[Ut];return n||(n=function(t,n){return Pt(t,n,e)},t[Ut]=n),n}var jt=Symbol();function Vt(t,e){t.push(e)}function Wt(t,e,n){t.push(e,n.P)}function Gt(t,e,n,r,i){var o=Bt(i),a=n.P;t.push(e,(function(t,e,n){return a(t,e,n,r,o)}))}function Ht(t,e,n,r,i,o){var a=zt(r,o),s=n.P;t.push(e,(function(t,e,n){return s(t,e,n,r,a)}))}function qt(t){return t[jt]||Ft(t,t[jt]=[],Vt,Wt,Gt,Ht)}var Xt=Symbol();function Yt(t,e){t[0]=e}function Kt(t,e,n,r){var i=n.O;t[e]=r?function(t,e,n){return i(t,e,n,r)}:i}function Zt(t,e,n,r,i,o){var a=n.O,s=Dt(i);t[e]=function(t,e,n){return a(t,e,n,r,s,o)}}function Jt(t,e,n,r,i,o,a){var s=n.O,l=Ot(r,i,o);t[e]=function(t,e,n){return s(t,e,n,r,l,a)}}function Qt(t){return t[Xt]||Ft(t,t[Xt]={},Yt,Kt,Zt,Jt)}function $t(t,e,n){for(;$(e)&&4!=e.h;){var r=e.i,i=n[r];if(!i){var o=n[0];o&&(o=o[r])&&(i=n[r]=Lt(o))}if(!(i&&i(e,t,r)||(i=e,r=t,o=i.j,tt(i),i.W))){var a=i.g.h;i=o===(i=i.g.g)?F||(F=new Uint8Array(0)):j?a.slice(o,i):new Uint8Array(a.subarray(o,i)),(o=r.ba)?o.push(i):r.ba=[i]}}return t}function te(t,e,n){if(et.length){var r=et.pop();t&&(q(r.g,t),r.i=-1,r.h=-1),t=r}else t=new Q(t);try{return $t(new e,t,Qt(n))}finally{(e=t.g).h=null,e.j=0,e.i=0,e.g=0,e.v=!1,t.i=-1,t.h=-1,100>et.length&&et.push(t)}}function ee(t,e,n){for(var r=n.length,i=1==r%2,o=i?1:0;o<r;o+=2)(0,n[o+1])(e,t,n[o]);Pt(t,e,i?n[0]:void 0)}function ne(t,e){var n=new nt;ee(t,n,qt(e)),rt(n,n.g.end()),t=new Uint8Array(n.h);for(var r=(e=n.i).length,i=0,o=0;o<r;o++){var a=e[o];t.set(a,i),i+=a.length}return n.i=[t],t}function re(t,e){return{O:t,P:e}}var ie=re((function(t,e,n){if(5!==t.h)return!1;var r=(t=t.g).h[t.g],i=t.h[t.g+1],o=t.h[t.g+2],a=t.h[t.g+3];return t.g+=4,X(t),t=2*((i=(r|i<<8|o<<16|a<<24)>>>0)>>31)+1,r=i>>>23&255,i&=8388607,yt(e,n,255==r?i?NaN:1/0*t:0==r?t*Math.pow(2,-149)*i:t*Math.pow(2,r-150)*(i+Math.pow(2,23))),!0}),(function(t,e,n){if(null!=(e=gt(e,n))){J(t.g,8*n+5),t=t.g;var r=e;0===(r=(n=0>r?1:0)?-r:r)?V=0<1/r?0:2147483648:isNaN(r)?V=2147483647:34028234663852886e22<r?V=(n<<31|2139095040)>>>0:11754943508222875e-54>r?(r=Math.round(r/Math.pow(2,-149)),V=(n<<31|r)>>>0):(e=Math.floor(Math.log(r)/Math.LN2),r*=Math.pow(2,-e),16777216<=(r=Math.round(8388608*r))&&++e,V=(n<<31|e+127<<23|8388607&r)>>>0),n=V,t.g.push(n>>>0&255),t.g.push(n>>>8&255),t.g.push(n>>>16&255),t.g.push(n>>>24&255)}})),oe=re((function(t,e,n){if(0!==t.h)return!1;for(var r=t.g,i=128,o=0,a=t=0;4>a&&128<=i;a++)i=r.h[r.g++],X(r),o|=(127&i)<<7*a;if(128<=i&&(i=r.h[r.g++],X(r),o|=(127&i)<<28,t|=(127&i)>>4),128<=i)for(a=0;5>a&&128<=i;a++)i=r.h[r.g++],X(r),t|=(127&i)<<7*a+3;if(!(128>i))throw G();return r=o>>>0,(t=2147483648&(i=t>>>0))&&(i=~i>>>0,0==(r=1+~r>>>0)&&(i=i+1>>>0)),r=4294967296*i+(r>>>0),yt(e,n,t?-r:r),!0}),(function(t,e,n){if(null!=(e=gt(e,n))&&null!=e){J(t.g,8*n),t=t.g;var r=e;for(n=0>r,e=(r=Math.abs(r))>>>0,r=Math.floor((r-e)/4294967296),r>>>=0,n&&(r=~r>>>0,4294967295<(e=1+(~e>>>0))&&(e=0,4294967295<++r&&(r=0))),n=V=e,e=r;0<e||127<n;)t.g.push(127&n|128),n=(n>>>7|e<<25)>>>0,e>>>=7;t.g.push(n)}})),ae=re((function(t,e,n){return 0===t.h&&(yt(e,n,Y(t.g)),!0)}),(function(t,e,n){if(null!=(e=gt(e,n))&&null!=e)if(J(t.g,8*n),t=t.g,0<=(n=e))J(t,n);else{for(e=0;9>e;e++)t.g.push(127&n|128),n>>=7;t.g.push(1)}})),se=re((function(t,e,n){if(2!==t.h)return!1;var r,i=Y(t.g)>>>0,o=(t=t.g).g;if(t.g+=i,X(t),t=t.h,I)(r=A)||(r=A=new TextDecoder("utf-8",{fatal:!0})),r=r.decode(t.subarray(o,o+i));else{i=o+i;for(var a,s,l,c=[],u=null;o<i;)128>(a=t[o++])?c.push(a):224>a?o>=i?M():(s=t[o++],194>a||128!=(192&s)?(o--,M()):c.push((31&a)<<6|63&s)):240>a?o>=i-1?M():128!=(192&(s=t[o++]))||224===a&&160>s||237===a&&160<=s||128!=(192&(r=t[o++]))?(o--,M()):c.push((15&a)<<12|(63&s)<<6|63&r):244>=a?o>=i-2?M():128!=(192&(s=t[o++]))||0!=s-144+(a<<28)>>30||128!=(192&(r=t[o++]))||128!=(192&(l=t[o++]))?(o--,M()):(a=(7&a)<<18|(63&s)<<12|(63&r)<<6|63&l,a-=65536,c.push(55296+(a>>10&1023),56320+(1023&a))):M(),8192<=c.length&&(u=C(u,c),c.length=0);r=C(u,c)}return yt(e,n,r),!0}),(function(t,e,n){if(null!=(e=gt(e,n))){var r=!1;if(r=void 0!==r&&r,R){if(r&&/(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])/.test(e))throw Error("Found an unpaired surrogate");e=(k||(k=new TextEncoder)).encode(e)}else{for(var i=0,o=new Uint8Array(3*e.length),a=0;a<e.length;a++){var s=e.charCodeAt(a);if(128>s)o[i++]=s;else{if(2048>s)o[i++]=s>>6|192;else{if(55296<=s&&57343>=s){if(56319>=s&&a<e.length){var l=e.charCodeAt(++a);if(56320<=l&&57343>=l){s=1024*(s-55296)+l-56320+65536,o[i++]=s>>18|240,o[i++]=s>>12&63|128,o[i++]=s>>6&63|128,o[i++]=63&s|128;continue}a--}if(r)throw Error("Found an unpaired surrogate");s=65533}o[i++]=s>>12|224,o[i++]=s>>6&63|128}o[i++]=63&s|128}}e=o.subarray(0,i)}J(t.g,8*n+2),J(t.g,e.length),rt(t,t.g.end()),rt(t,e)}})),le=re((function(t,e,n,r,i){if(2!==t.h)return!1;e=_t(e,n,r),n=t.g.i,r=Y(t.g)>>>0;var o=t.g.g+r,a=o-n;if(0>=a&&(t.g.i=o,i(e,t),a=o-t.g.g),a)throw Error("Message parsing ended unexpectedly. Expected to read "+r+" bytes, instead read "+(r-a)+" bytes, either the data ended unexpectedly or the message misreported its own length");return t.g.g=o,t.g.i=n,!0}),(function(t,e,n,r,i){if(null!=(e=xt(e,r,n)))for(r=0;r<e.length;r++){var o=t;J(o.g,8*n+2);var a=o.g.end();rt(o,a),a.push(o.h),o=a,i(e[r],t),a=t;var s=o.pop();for(s=a.h+a.g.length()-s;127<s;)o.push(127&s|128),s>>>=7,a.h++;o.push(s),a.h++}}));function ce(){It.apply(this,arguments)}if(p(ce,It),ft){var ue={};Object.defineProperties(ce,(ue[Symbol.hasInstance]=mt(Object[Symbol.hasInstance]),ue))}function he(t){ce.call(this,t)}function de(){return[1,ae,2,ie,3,se,4,se]}function pe(t){ce.call(this,t,-1,me)}function fe(){return[1,le,he,de]}p(he,ce),p(pe,ce),pe.prototype.addClassification=function(t,e){return _t(this,1,he,t,e),this};var me=[1];function ge(t){ce.call(this,t)}function ye(){return[1,ie,2,ie,3,ie,4,ie,5,ie]}function ve(t){ce.call(this,t,-1,xe)}function be(){return[1,le,ge,ye]}p(ge,ce),p(ve,ce);var xe=[1];function _e(t){ce.call(this,t)}function we(){return[1,ie,2,ie,3,ie,4,ie,5,ie,6,oe]}p(_e,ce);var Se=[[61,146],[146,91],[91,181],[181,84],[84,17],[17,314],[314,405],[405,321],[321,375],[375,291],[61,185],[185,40],[40,39],[39,37],[37,0],[0,267],[267,269],[269,270],[270,409],[409,291],[78,95],[95,88],[88,178],[178,87],[87,14],[14,317],[317,402],[402,318],[318,324],[324,308],[78,191],[191,80],[80,81],[81,82],[82,13],[13,312],[312,311],[311,310],[310,415],[415,308]],Te=[[263,249],[249,390],[390,373],[373,374],[374,380],[380,381],[381,382],[382,362],[263,466],[466,388],[388,387],[387,386],[386,385],[385,384],[384,398],[398,362]],Ee=[[276,283],[283,282],[282,295],[295,285],[300,293],[293,334],[334,296],[296,336]],Me=[[33,7],[7,163],[163,144],[144,145],[145,153],[153,154],[154,155],[155,133],[33,246],[246,161],[161,160],[160,159],[159,158],[158,157],[157,173],[173,133]],Ce=[[46,53],[53,52],[52,65],[65,55],[70,63],[63,105],[105,66],[66,107]],Ae=[[10,338],[338,297],[297,332],[332,284],[284,251],[251,389],[389,356],[356,454],[454,323],[323,361],[361,288],[288,397],[397,365],[365,379],[379,378],[378,400],[400,377],[377,152],[152,148],[148,176],[176,149],[149,150],[150,136],[136,172],[172,58],[58,132],[132,93],[93,234],[234,127],[127,162],[162,21],[21,54],[54,103],[103,67],[67,109],[109,10]],ke=[].concat(s(Se),s(Te),s(Ee),s(Me),s(Ce),s(Ae));function Ie(t,e,n){if(n=t.createShader(0===n?t.VERTEX_SHADER:t.FRAGMENT_SHADER),t.shaderSource(n,e),t.compileShader(n),!t.getShaderParameter(n,t.COMPILE_STATUS))throw Error("Could not compile WebGL shader.\n\n"+t.getShaderInfoLog(n));return n}function Re(t){return xt(t,he,1).map((function(t){return{index:wt(t,1),ga:bt(t,2),label:null!=gt(t,3)?St(t,3):void 0,displayName:null!=gt(t,4)?St(t,4):void 0}}))}function Pe(t){return{x:bt(t,1),y:bt(t,2),z:bt(t,3),visibility:null!=gt(t,4)?bt(t,4):void 0}}function Ne(t,e){this.h=t,this.g=e,this.l=0}function Oe(t,e,n){return function(t,e){var n=t.g;if(void 0===t.o){var r=Ie(n,"\n  attribute vec2 aVertex;\n  attribute vec2 aTex;\n  varying vec2 vTex;\n  void main(void) {\n    gl_Position = vec4(aVertex, 0.0, 1.0);\n    vTex = aTex;\n  }",0),i=Ie(n,"\n  precision mediump float;\n  varying vec2 vTex;\n  uniform sampler2D sampler0;\n  void main(){\n    gl_FragColor = texture2D(sampler0, vTex);\n  }",1),o=n.createProgram();if(n.attachShader(o,r),n.attachShader(o,i),n.linkProgram(o),!n.getProgramParameter(o,n.LINK_STATUS))throw Error("Could not compile WebGL program.\n\n"+n.getProgramInfoLog(o));r=t.o=o,n.useProgram(r),i=n.getUniformLocation(r,"sampler0"),t.j={K:n.getAttribLocation(r,"aVertex"),J:n.getAttribLocation(r,"aTex"),ma:i},t.u=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,t.u),n.enableVertexAttribArray(t.j.K),n.vertexAttribPointer(t.j.K,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),t.s=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,t.s),n.enableVertexAttribArray(t.j.J),n.vertexAttribPointer(t.j.J,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),n.uniform1i(i,0)}r=t.j,n.useProgram(t.o),n.canvas.width=e.width,n.canvas.height=e.height,n.viewport(0,0,e.width,e.height),n.activeTexture(n.TEXTURE0),t.h.bindTexture2d(e.glName),n.enableVertexAttribArray(r.K),n.bindBuffer(n.ARRAY_BUFFER,t.u),n.vertexAttribPointer(r.K,2,n.FLOAT,!1,0,0),n.enableVertexAttribArray(r.J),n.bindBuffer(n.ARRAY_BUFFER,t.s),n.vertexAttribPointer(r.J,2,n.FLOAT,!1,0,0),n.bindFramebuffer(n.DRAW_FRAMEBUFFER?n.DRAW_FRAMEBUFFER:n.FRAMEBUFFER,null),n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT),n.colorMask(!0,!0,!0,!0),n.drawArrays(n.TRIANGLE_FAN,0,4),n.disableVertexAttribArray(r.K),n.disableVertexAttribArray(r.J),n.bindBuffer(n.ARRAY_BUFFER,null),t.h.bindTexture2d(0)}(t,e),"function"==typeof t.g.canvas.transferToImageBitmap?Promise.resolve(t.g.canvas.transferToImageBitmap()):n?Promise.resolve(t.g.canvas):"function"==typeof createImageBitmap?createImageBitmap(t.g.canvas):(void 0===t.i&&(t.i=document.createElement("canvas")),new Promise((function(e){t.i.height=t.g.canvas.height,t.i.width=t.g.canvas.width,t.i.getContext("2d",{}).drawImage(t.g.canvas,0,0,t.g.canvas.width,t.g.canvas.height),e(t.i)})))}function De(t){this.g=t}var Le=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function Fe(t,e){return e+t}function Ue(t,e){window[t]=e}function Be(t){if(this.g=t,this.listeners={},this.j={},this.H={},this.o={},this.u={},this.I=this.s=this.Z=!0,this.D=Promise.resolve(),this.Y="",this.C={},this.locateFile=t&&t.locateFile||Fe,"object"==typeof window)var e=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else{if("undefined"==typeof location)throw Error("solutions can only be loaded on a web page or in a web worker");e=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/"}if(this.$=e,t.options)for(var n=(e=a(Object.keys(t.options))).next();!n.done;n=e.next()){n=n.value;var r=t.options[n].default;void 0!==r&&(this.j[n]="function"==typeof r?r():r)}}function ze(t,e){var n,r;return w((function(i){return e in t.H?i.return(t.H[e]):(n=t.locateFile(e,""),r=fetch(n).then((function(t){return t.arrayBuffer()})),t.H[e]=r,i.return(r))}))}function je(t,e,n){var r,i,o,s,l,c,u,h,d,p,f,m,g,v;return w((function(b){switch(b.g){case 1:if(!n)return b.return(e);for(r={},i=0,o=a(Object.keys(n)),s=o.next();!s.done;s=o.next())l=s.value,"string"!=typeof(c=n[l])&&"texture"===c.type&&void 0!==e[c.stream]&&++i;1<i&&(t.I=!1),u=a(Object.keys(n)),s=u.next();case 2:if(s.done){b.g=4;break}if(h=s.value,"string"==typeof(d=n[h]))return g=r,v=h,y(b,function(t,e,n){var r;return w((function(i){return"number"==typeof n||n instanceof Uint8Array||n instanceof t.h.Uint8BlobList?i.return(n):n instanceof t.h.Texture2dDataOut?((r=t.u[e])||(r=new Ne(t.h,t.G),t.u[e]=r),i.return(Oe(r,n,t.I))):i.return(void 0)}))}(t,h,e[d]),14);if(p=e[d.stream],"detection_list"===d.type){if(p){for(var x=p.getRectList(),_=p.getLandmarksList(),S=p.getClassificationsList(),T=[],E=0;E<x.size();++E){var M=te(x.get(E),_e,we);M={boundingBox:{xCenter:bt(M,1),yCenter:bt(M,2),height:bt(M,3),width:bt(M,4),rotation:bt(M,5,0),rectId:wt(M,6)},landmarks:xt(te(_.get(E),ve,be),ge,1).map(Pe),V:Re(te(S.get(E),pe,fe))},T.push(M)}x=T}else x=[];r[h]=x,b.g=7;break}if("proto_list"===d.type){if(p){for(x=Array(p.size()),_=0;_<p.size();_++)x[_]=p.get(_);p.delete()}else x=[];r[h]=x,b.g=7;break}if(void 0===p){b.g=3;break}if("float_list"===d.type){r[h]=p,b.g=7;break}if("proto"===d.type){r[h]=p,b.g=7;break}if("texture"!==d.type)throw Error("Unknown output config type: '"+d.type+"'");return(f=t.u[h])||(f=new Ne(t.h,t.G),t.u[h]=f),y(b,Oe(f,p,t.I),13);case 13:m=b.h,r[h]=m;case 7:d.transform&&r[h]&&(r[h]=d.transform(r[h])),b.g=3;break;case 14:g[v]=b.h;case 3:s=u.next(),b.g=2;break;case 4:return b.return(r)}}))}function Ve(t,e){for(var n=e.name||"$",r=[].concat(s(e.wants)),i=new t.h.StringList,o=a(e.wants),l=o.next();!l.done;l=o.next())i.push_back(l.value);o=t.h.PacketListener.implement({onResults:function(i){for(var o={},a=0;a<e.wants.length;++a)o[r[a]]=i.get(a);var s=t.listeners[n];s&&(t.D=je(t,o,e.outs).then((function(n){n=s(n);for(var i=0;i<e.wants.length;++i){var a=o[r[i]];"object"==typeof a&&a.hasOwnProperty&&a.hasOwnProperty("delete")&&a.delete()}n&&(t.D=n)})))}}),t.i.attachMultiListener(i,o),i.delete()}function We(t){var e=this;t=t||{};var n={url:"face_detection_short.binarypb"},r={type:1,graphOptionXref:{calculatorType:"TensorsToDetectionsCalculator",calculatorName:"facedetectionshortrangegpu__facedetectionshortrangecommon__TensorsToDetectionsCalculator",fieldName:"min_score_thresh"}};this.g=new Be({locateFile:t.locateFile,files:[{data:!0,url:"face_detection_short.binarypb"},{data:!0,url:"face_detection_short_range.tflite"},{simd:!0,url:"face_detection_solution_simd_wasm_bin.js"},{simd:!1,url:"face_detection_solution_wasm_bin.js"}],graph:n,listeners:[{wants:["detections","image_transformed"],outs:{image:"image_transformed",detections:{type:"detection_list",stream:"detections"}}}],inputs:{image:{type:"video",stream:"input_frames_gpu"}},options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:"object"==typeof window&&void 0!==window.navigator&&("iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document)},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},model:{type:0,onChange:function(t){var i,o,s,l,c;return w((function(u){switch(u.g){case 1:i=a("short"===t?["face_detection_short_range.tflite"]:["face_detection_full_range_sparse.tflite"]),o=i.next();case 2:if(o.done){u.g=4;break}return s=o.value,l="third_party/mediapipe/modules/face_detection/"+s,y(u,ze(e.g,s),5);case 5:c=u.h,e.g.overrideFile(l,c),o=i.next(),u.g=2;break;case 4:return n.url="short"===t?"face_detection_short.binarypb":"face_detection_full.binarypb",r.graphOptionXref.calculatorName="short"===t?"facedetectionshortrangegpu__facedetectionshortrangecommon__TensorsToDetectionsCalculator":"facedetectionfullrangegpu__facedetectionfullrangecommon__TensorsToDetectionsCalculator",u.return(!0)}}))}},minDetectionConfidence:r}})}(t=Be.prototype).close=function(){return this.i&&this.i.delete(),Promise.resolve()},t.reset=function(){var t=this;return w((function(e){t.i&&(t.i.reset(),t.o={},t.u={}),e.g=0}))},t.setOptions=function(t,e){var n=this;if(e=e||this.g.options){for(var r=[],i=[],o={},s=a(Object.keys(t)),l=s.next();!l.done;o={R:o.R,S:o.S},l=s.next()){var c=l.value;c in this.j&&this.j[c]===t[c]||(this.j[c]=t[c],void 0!==(l=e[c])&&(l.onChange&&(o.R=l.onChange,o.S=t[c],r.push(function(t){return function(){return w((function(e){if(1==e.g)return y(e,t.R(t.S),2);!0===e.h&&(n.s=!0),e.g=0}))}}(o))),l.graphOptionXref&&(c={valueNumber:1===l.type?t[c]:0,valueBoolean:0===l.type&&t[c],valueString:2===l.type?t[c]:""},l=Object.assign(Object.assign(Object.assign({},{calculatorName:"",calculatorIndex:0}),l.graphOptionXref),c),i.push(l))))}0===r.length&&0===i.length||(this.s=!0,this.B=(void 0===this.B?[]:this.B).concat(i),this.A=(void 0===this.A?[]:this.A).concat(r))}},t.initialize=function(){var t=this;return w((function(e){return 1==e.g?y(e,function(t){var e,n,r,i,o,a,l,c,u,h,d;return w((function(p){switch(p.g){case 1:return t.Z?(e=void 0===t.g.files?[]:"function"==typeof t.g.files?t.g.files(t.j):t.g.files,y(p,w((function(t){switch(t.g){case 1:return t.o=2,y(t,WebAssembly.instantiate(Le),4);case 4:t.g=3,t.o=0;break;case 2:return t.o=0,t.j=null,t.return(!1);case 3:return t.return(!0)}})),2)):p.return();case 2:if(n=p.h,"object"==typeof window)return Ue("createMediapipeSolutionsWasm",{locateFile:t.locateFile}),Ue("createMediapipeSolutionsPackedAssets",{locateFile:t.locateFile}),a=e.filter((function(t){return void 0!==t.data})),l=e.filter((function(t){return void 0===t.data})),c=Promise.all(a.map((function(e){var n=ze(t,e.url);if(void 0!==e.path){var r=e.path;n=n.then((function(e){return t.overrideFile(r,e),Promise.resolve(e)}))}return n}))),u=Promise.all(l.map((function(e){return void 0===e.simd||e.simd&&n||!e.simd&&!n?function(t){var e=document.createElement("script");return e.setAttribute("src",t),e.setAttribute("crossorigin","anonymous"),new Promise((function(t){e.addEventListener("load",(function(){t()}),!1),e.addEventListener("error",(function(){t()}),!1),document.body.appendChild(e)}))}(t.locateFile(e.url,t.$)):Promise.resolve()}))).then((function(){var e,n,r;return w((function(i){if(1==i.g)return e=window.createMediapipeSolutionsWasm,n=window.createMediapipeSolutionsPackedAssets,r=t,y(i,e(n),2);r.h=i.h,i.g=0}))})),h=w((function(e){return t.g.graph&&t.g.graph.url?e=y(e,ze(t,t.g.graph.url),0):(e.g=0,e=void 0),e})),y(p,Promise.all([u,c,h]),7);if("function"!=typeof importScripts)throw Error("solutions can only be loaded on a web page or in a web worker");return r=e.filter((function(t){return void 0===t.simd||t.simd&&n||!t.simd&&!n})).map((function(e){return t.locateFile(e.url,t.$)})),importScripts.apply(null,s(r)),i=t,y(p,createMediapipeSolutionsWasm(Module),6);case 6:i.h=p.h,t.l=new OffscreenCanvas(1,1),t.h.canvas=t.l,o=t.h.GL.createContext(t.l,{antialias:!1,alpha:!1,ja:"undefined"!=typeof WebGL2RenderingContext?2:1}),t.h.GL.makeContextCurrent(o),p.g=4;break;case 7:if(t.l=document.createElement("canvas"),!(d=t.l.getContext("webgl2",{}))&&!(d=t.l.getContext("webgl",{})))return alert("Failed to create WebGL canvas context when passing video frame."),p.return();t.G=d,t.h.canvas=t.l,t.h.createContext(t.l,!0,!0,{});case 4:t.i=new t.h.SolutionWasm,t.Z=!1,p.g=0}}))}(t),2):3!=e.g?y(e,function(t){var e,n,r,i,o,s,l,c;return w((function(u){if(1==u.g)return t.g.graph&&t.g.graph.url&&t.Y===t.g.graph.url?u.return():(t.s=!0,t.g.graph&&t.g.graph.url?(t.Y=t.g.graph.url,y(u,ze(t,t.g.graph.url),3)):void(u.g=2));for(2!=u.g&&(e=u.h,t.i.loadGraph(e)),n=a(Object.keys(t.C)),r=n.next();!r.done;r=n.next())i=r.value,t.i.overrideFile(i,t.C[i]);if(t.C={},t.g.listeners)for(o=a(t.g.listeners),s=o.next();!s.done;s=o.next())l=s.value,Ve(t,l);c=t.j,t.j={},t.setOptions(c),u.g=0}))}(t),3):y(e,function(t){var e,n,r,i,o,s;return w((function(l){switch(l.g){case 1:if(!t.s)return l.return();if(!t.A){l.g=2;break}e=a(t.A),n=e.next();case 3:if(n.done){l.g=5;break}return y(l,(0,n.value)(),4);case 4:n=e.next(),l.g=3;break;case 5:t.A=void 0;case 2:if(t.B){for(r=new t.h.GraphOptionChangeRequestList,i=a(t.B),o=i.next();!o.done;o=i.next())s=o.value,r.push_back(s);t.i.changeOptions(r),r.delete(),t.B=void 0}t.s=!1,l.g=0}}))}(t),0)}))},t.overrideFile=function(t,e){this.i?this.i.overrideFile(t,e):this.C[t]=e},t.clearOverriddenFiles=function(){this.C={},this.i&&this.i.clearOverriddenFiles()},t.send=function(t,e){var n,r,i,o,s,l,c,u,h,d=this;return w((function(p){switch(p.g){case 1:return d.g.inputs?(n=1e3*(null==e?performance.now():e),y(p,d.D,2)):p.return();case 2:return y(p,d.initialize(),3);case 3:for(r=new d.h.PacketDataList,i=a(Object.keys(t)),o=i.next();!o.done;o=i.next())if(s=o.value,l=d.g.inputs[s]){t:{var f=t[s];switch(l.type){case"video":var m=d.o[l.stream];if(m||(m=new Ne(d.h,d.G),d.o[l.stream]=m),0===m.l&&(m.l=m.h.createTexture()),"undefined"!=typeof HTMLVideoElement&&f instanceof HTMLVideoElement)var g=f.videoWidth,v=f.videoHeight;else"undefined"!=typeof HTMLImageElement&&f instanceof HTMLImageElement?(g=f.naturalWidth,v=f.naturalHeight):(g=f.width,v=f.height);v={glName:m.l,width:g,height:v},(g=m.g).canvas.width=v.width,g.canvas.height=v.height,g.activeTexture(g.TEXTURE0),m.h.bindTexture2d(m.l),g.texImage2D(g.TEXTURE_2D,0,g.RGBA,g.RGBA,g.UNSIGNED_BYTE,f),m.h.bindTexture2d(0),m=v;break t;case"detections":for((m=d.o[l.stream])||(m=new De(d.h),d.o[l.stream]=m),m.data||(m.data=new m.g.DetectionListData),m.data.reset(f.length),v=0;v<f.length;++v){g=f[v];var b=m.data,x=b.setBoundingBox,_=v,w=g.boundingBox,S=new _e;if(yt(S,1,w.xCenter),yt(S,2,w.yCenter),yt(S,3,w.height),yt(S,4,w.width),yt(S,5,w.rotation),yt(S,6,w.rectId),w=ne(S,we),x.call(b,_,w),g.landmarks)for(b=0;b<g.landmarks.length;++b){var T=!!(S=g.landmarks[b]).visibility;_=(x=m.data).addNormalizedLandmark,w=v,S=Object.assign(Object.assign({},S),{visibility:T?S.visibility:0}),yt(T=new ge,1,S.x),yt(T,2,S.y),yt(T,3,S.z),S.visibility&&yt(T,4,S.visibility),S=ne(T,ye),_.call(x,w,S)}if(g.V)for(b=0;b<g.V.length;++b)_=(x=m.data).addClassification,w=v,S=g.V[b],yt(T=new he,2,S.ga),S.index&&yt(T,1,S.index),S.label&&yt(T,3,S.label),S.displayName&&yt(T,4,S.displayName),S=ne(T,de),_.call(x,w,S)}m=m.data;break t;default:m={}}}switch(c=m,u=l.stream,l.type){case"video":r.pushTexture2d(Object.assign(Object.assign({},c),{stream:u,timestamp:n}));break;case"detections":(h=c).stream=u,h.timestamp=n,r.pushDetectionList(h);break;default:throw Error("Unknown input config type: '"+l.type+"'")}}return d.i.send(r),y(p,d.D,4);case 4:r.delete(),p.g=0}}))},t.onResults=function(t,e){this.listeners[e||"$"]=t},E("Solution",Be),E("OptionType",{BOOL:0,NUMBER:1,ia:2,0:"BOOL",1:"NUMBER",2:"STRING"}),(t=We.prototype).close=function(){return this.g.close(),Promise.resolve()},t.onResults=function(t){this.g.onResults(t)},t.initialize=function(){var t=this;return w((function(e){return y(e,t.g.initialize(),0)}))},t.reset=function(){this.g.reset()},t.send=function(t){var e=this;return w((function(n){return y(n,e.g.send(t),0)}))},t.setOptions=function(t){this.g.setOptions(t)},E("FaceDetection",We),E("FACEDETECTION_LIPS",Se),E("FACEDETECTION_LEFT_EYE",Te),E("FACEDETECTION_LEFT_EYEBROW",Ee),E("FACEDETECTION_RIGHT_EYE",Me),E("FACEDETECTION_RIGHT_EYEBROW",Ce),E("FACEDETECTION_FACE_OVAL",Ae),E("FACEDETECTION_CONTOURS",ke),E("FACEDETECTION_TESSELATION",[[127,34],[34,139],[139,127],[11,0],[0,37],[37,11],[232,231],[231,120],[120,232],[72,37],[37,39],[39,72],[128,121],[121,47],[47,128],[232,121],[121,128],[128,232],[104,69],[69,67],[67,104],[175,171],[171,148],[148,175],[118,50],[50,101],[101,118],[73,39],[39,40],[40,73],[9,151],[151,108],[108,9],[48,115],[115,131],[131,48],[194,204],[204,211],[211,194],[74,40],[40,185],[185,74],[80,42],[42,183],[183,80],[40,92],[92,186],[186,40],[230,229],[229,118],[118,230],[202,212],[212,214],[214,202],[83,18],[18,17],[17,83],[76,61],[61,146],[146,76],[160,29],[29,30],[30,160],[56,157],[157,173],[173,56],[106,204],[204,194],[194,106],[135,214],[214,192],[192,135],[203,165],[165,98],[98,203],[21,71],[71,68],[68,21],[51,45],[45,4],[4,51],[144,24],[24,23],[23,144],[77,146],[146,91],[91,77],[205,50],[50,187],[187,205],[201,200],[200,18],[18,201],[91,106],[106,182],[182,91],[90,91],[91,181],[181,90],[85,84],[84,17],[17,85],[206,203],[203,36],[36,206],[148,171],[171,140],[140,148],[92,40],[40,39],[39,92],[193,189],[189,244],[244,193],[159,158],[158,28],[28,159],[247,246],[246,161],[161,247],[236,3],[3,196],[196,236],[54,68],[68,104],[104,54],[193,168],[168,8],[8,193],[117,228],[228,31],[31,117],[189,193],[193,55],[55,189],[98,97],[97,99],[99,98],[126,47],[47,100],[100,126],[166,79],[79,218],[218,166],[155,154],[154,26],[26,155],[209,49],[49,131],[131,209],[135,136],[136,150],[150,135],[47,126],[126,217],[217,47],[223,52],[52,53],[53,223],[45,51],[51,134],[134,45],[211,170],[170,140],[140,211],[67,69],[69,108],[108,67],[43,106],[106,91],[91,43],[230,119],[119,120],[120,230],[226,130],[130,247],[247,226],[63,53],[53,52],[52,63],[238,20],[20,242],[242,238],[46,70],[70,156],[156,46],[78,62],[62,96],[96,78],[46,53],[53,63],[63,46],[143,34],[34,227],[227,143],[123,117],[117,111],[111,123],[44,125],[125,19],[19,44],[236,134],[134,51],[51,236],[216,206],[206,205],[205,216],[154,153],[153,22],[22,154],[39,37],[37,167],[167,39],[200,201],[201,208],[208,200],[36,142],[142,100],[100,36],[57,212],[212,202],[202,57],[20,60],[60,99],[99,20],[28,158],[158,157],[157,28],[35,226],[226,113],[113,35],[160,159],[159,27],[27,160],[204,202],[202,210],[210,204],[113,225],[225,46],[46,113],[43,202],[202,204],[204,43],[62,76],[76,77],[77,62],[137,123],[123,116],[116,137],[41,38],[38,72],[72,41],[203,129],[129,142],[142,203],[64,98],[98,240],[240,64],[49,102],[102,64],[64,49],[41,73],[73,74],[74,41],[212,216],[216,207],[207,212],[42,74],[74,184],[184,42],[169,170],[170,211],[211,169],[170,149],[149,176],[176,170],[105,66],[66,69],[69,105],[122,6],[6,168],[168,122],[123,147],[147,187],[187,123],[96,77],[77,90],[90,96],[65,55],[55,107],[107,65],[89,90],[90,180],[180,89],[101,100],[100,120],[120,101],[63,105],[105,104],[104,63],[93,137],[137,227],[227,93],[15,86],[86,85],[85,15],[129,102],[102,49],[49,129],[14,87],[87,86],[86,14],[55,8],[8,9],[9,55],[100,47],[47,121],[121,100],[145,23],[23,22],[22,145],[88,89],[89,179],[179,88],[6,122],[122,196],[196,6],[88,95],[95,96],[96,88],[138,172],[172,136],[136,138],[215,58],[58,172],[172,215],[115,48],[48,219],[219,115],[42,80],[80,81],[81,42],[195,3],[3,51],[51,195],[43,146],[146,61],[61,43],[171,175],[175,199],[199,171],[81,82],[82,38],[38,81],[53,46],[46,225],[225,53],[144,163],[163,110],[110,144],[52,65],[65,66],[66,52],[229,228],[228,117],[117,229],[34,127],[127,234],[234,34],[107,108],[108,69],[69,107],[109,108],[108,151],[151,109],[48,64],[64,235],[235,48],[62,78],[78,191],[191,62],[129,209],[209,126],[126,129],[111,35],[35,143],[143,111],[117,123],[123,50],[50,117],[222,65],[65,52],[52,222],[19,125],[125,141],[141,19],[221,55],[55,65],[65,221],[3,195],[195,197],[197,3],[25,7],[7,33],[33,25],[220,237],[237,44],[44,220],[70,71],[71,139],[139,70],[122,193],[193,245],[245,122],[247,130],[130,33],[33,247],[71,21],[21,162],[162,71],[170,169],[169,150],[150,170],[188,174],[174,196],[196,188],[216,186],[186,92],[92,216],[2,97],[97,167],[167,2],[141,125],[125,241],[241,141],[164,167],[167,37],[37,164],[72,38],[38,12],[12,72],[38,82],[82,13],[13,38],[63,68],[68,71],[71,63],[226,35],[35,111],[111,226],[101,50],[50,205],[205,101],[206,92],[92,165],[165,206],[209,198],[198,217],[217,209],[165,167],[167,97],[97,165],[220,115],[115,218],[218,220],[133,112],[112,243],[243,133],[239,238],[238,241],[241,239],[214,135],[135,169],[169,214],[190,173],[173,133],[133,190],[171,208],[208,32],[32,171],[125,44],[44,237],[237,125],[86,87],[87,178],[178,86],[85,86],[86,179],[179,85],[84,85],[85,180],[180,84],[83,84],[84,181],[181,83],[201,83],[83,182],[182,201],[137,93],[93,132],[132,137],[76,62],[62,183],[183,76],[61,76],[76,184],[184,61],[57,61],[61,185],[185,57],[212,57],[57,186],[186,212],[214,207],[207,187],[187,214],[34,143],[143,156],[156,34],[79,239],[239,237],[237,79],[123,137],[137,177],[177,123],[44,1],[1,4],[4,44],[201,194],[194,32],[32,201],[64,102],[102,129],[129,64],[213,215],[215,138],[138,213],[59,166],[166,219],[219,59],[242,99],[99,97],[97,242],[2,94],[94,141],[141,2],[75,59],[59,235],[235,75],[24,110],[110,228],[228,24],[25,130],[130,226],[226,25],[23,24],[24,229],[229,23],[22,23],[23,230],[230,22],[26,22],[22,231],[231,26],[112,26],[26,232],[232,112],[189,190],[190,243],[243,189],[221,56],[56,190],[190,221],[28,56],[56,221],[221,28],[27,28],[28,222],[222,27],[29,27],[27,223],[223,29],[30,29],[29,224],[224,30],[247,30],[30,225],[225,247],[238,79],[79,20],[20,238],[166,59],[59,75],[75,166],[60,75],[75,240],[240,60],[147,177],[177,215],[215,147],[20,79],[79,166],[166,20],[187,147],[147,213],[213,187],[112,233],[233,244],[244,112],[233,128],[128,245],[245,233],[128,114],[114,188],[188,128],[114,217],[217,174],[174,114],[131,115],[115,220],[220,131],[217,198],[198,236],[236,217],[198,131],[131,134],[134,198],[177,132],[132,58],[58,177],[143,35],[35,124],[124,143],[110,163],[163,7],[7,110],[228,110],[110,25],[25,228],[356,389],[389,368],[368,356],[11,302],[302,267],[267,11],[452,350],[350,349],[349,452],[302,303],[303,269],[269,302],[357,343],[343,277],[277,357],[452,453],[453,357],[357,452],[333,332],[332,297],[297,333],[175,152],[152,377],[377,175],[347,348],[348,330],[330,347],[303,304],[304,270],[270,303],[9,336],[336,337],[337,9],[278,279],[279,360],[360,278],[418,262],[262,431],[431,418],[304,408],[408,409],[409,304],[310,415],[415,407],[407,310],[270,409],[409,410],[410,270],[450,348],[348,347],[347,450],[422,430],[430,434],[434,422],[313,314],[314,17],[17,313],[306,307],[307,375],[375,306],[387,388],[388,260],[260,387],[286,414],[414,398],[398,286],[335,406],[406,418],[418,335],[364,367],[367,416],[416,364],[423,358],[358,327],[327,423],[251,284],[284,298],[298,251],[281,5],[5,4],[4,281],[373,374],[374,253],[253,373],[307,320],[320,321],[321,307],[425,427],[427,411],[411,425],[421,313],[313,18],[18,421],[321,405],[405,406],[406,321],[320,404],[404,405],[405,320],[315,16],[16,17],[17,315],[426,425],[425,266],[266,426],[377,400],[400,369],[369,377],[322,391],[391,269],[269,322],[417,465],[465,464],[464,417],[386,257],[257,258],[258,386],[466,260],[260,388],[388,466],[456,399],[399,419],[419,456],[284,332],[332,333],[333,284],[417,285],[285,8],[8,417],[346,340],[340,261],[261,346],[413,441],[441,285],[285,413],[327,460],[460,328],[328,327],[355,371],[371,329],[329,355],[392,439],[439,438],[438,392],[382,341],[341,256],[256,382],[429,420],[420,360],[360,429],[364,394],[394,379],[379,364],[277,343],[343,437],[437,277],[443,444],[444,283],[283,443],[275,440],[440,363],[363,275],[431,262],[262,369],[369,431],[297,338],[338,337],[337,297],[273,375],[375,321],[321,273],[450,451],[451,349],[349,450],[446,342],[342,467],[467,446],[293,334],[334,282],[282,293],[458,461],[461,462],[462,458],[276,353],[353,383],[383,276],[308,324],[324,325],[325,308],[276,300],[300,293],[293,276],[372,345],[345,447],[447,372],[352,345],[345,340],[340,352],[274,1],[1,19],[19,274],[456,248],[248,281],[281,456],[436,427],[427,425],[425,436],[381,256],[256,252],[252,381],[269,391],[391,393],[393,269],[200,199],[199,428],[428,200],[266,330],[330,329],[329,266],[287,273],[273,422],[422,287],[250,462],[462,328],[328,250],[258,286],[286,384],[384,258],[265,353],[353,342],[342,265],[387,259],[259,257],[257,387],[424,431],[431,430],[430,424],[342,353],[353,276],[276,342],[273,335],[335,424],[424,273],[292,325],[325,307],[307,292],[366,447],[447,345],[345,366],[271,303],[303,302],[302,271],[423,266],[266,371],[371,423],[294,455],[455,460],[460,294],[279,278],[278,294],[294,279],[271,272],[272,304],[304,271],[432,434],[434,427],[427,432],[272,407],[407,408],[408,272],[394,430],[430,431],[431,394],[395,369],[369,400],[400,395],[334,333],[333,299],[299,334],[351,417],[417,168],[168,351],[352,280],[280,411],[411,352],[325,319],[319,320],[320,325],[295,296],[296,336],[336,295],[319,403],[403,404],[404,319],[330,348],[348,349],[349,330],[293,298],[298,333],[333,293],[323,454],[454,447],[447,323],[15,16],[16,315],[315,15],[358,429],[429,279],[279,358],[14,15],[15,316],[316,14],[285,336],[336,9],[9,285],[329,349],[349,350],[350,329],[374,380],[380,252],[252,374],[318,402],[402,403],[403,318],[6,197],[197,419],[419,6],[318,319],[319,325],[325,318],[367,364],[364,365],[365,367],[435,367],[367,397],[397,435],[344,438],[438,439],[439,344],[272,271],[271,311],[311,272],[195,5],[5,281],[281,195],[273,287],[287,291],[291,273],[396,428],[428,199],[199,396],[311,271],[271,268],[268,311],[283,444],[444,445],[445,283],[373,254],[254,339],[339,373],[282,334],[334,296],[296,282],[449,347],[347,346],[346,449],[264,447],[447,454],[454,264],[336,296],[296,299],[299,336],[338,10],[10,151],[151,338],[278,439],[439,455],[455,278],[292,407],[407,415],[415,292],[358,371],[371,355],[355,358],[340,345],[345,372],[372,340],[346,347],[347,280],[280,346],[442,443],[443,282],[282,442],[19,94],[94,370],[370,19],[441,442],[442,295],[295,441],[248,419],[419,197],[197,248],[263,255],[255,359],[359,263],[440,275],[275,274],[274,440],[300,383],[383,368],[368,300],[351,412],[412,465],[465,351],[263,467],[467,466],[466,263],[301,368],[368,389],[389,301],[395,378],[378,379],[379,395],[412,351],[351,419],[419,412],[436,426],[426,322],[322,436],[2,164],[164,393],[393,2],[370,462],[462,461],[461,370],[164,0],[0,267],[267,164],[302,11],[11,12],[12,302],[268,12],[12,13],[13,268],[293,300],[300,301],[301,293],[446,261],[261,340],[340,446],[330,266],[266,425],[425,330],[426,423],[423,391],[391,426],[429,355],[355,437],[437,429],[391,327],[327,326],[326,391],[440,457],[457,438],[438,440],[341,382],[382,362],[362,341],[459,457],[457,461],[461,459],[434,430],[430,394],[394,434],[414,463],[463,362],[362,414],[396,369],[369,262],[262,396],[354,461],[461,457],[457,354],[316,403],[403,402],[402,316],[315,404],[404,403],[403,315],[314,405],[405,404],[404,314],[313,406],[406,405],[405,313],[421,418],[418,406],[406,421],[366,401],[401,361],[361,366],[306,408],[408,407],[407,306],[291,409],[409,408],[408,291],[287,410],[410,409],[409,287],[432,436],[436,410],[410,432],[434,416],[416,411],[411,434],[264,368],[368,383],[383,264],[309,438],[438,457],[457,309],[352,376],[376,401],[401,352],[274,275],[275,4],[4,274],[421,428],[428,262],[262,421],[294,327],[327,358],[358,294],[433,416],[416,367],[367,433],[289,455],[455,439],[439,289],[462,370],[370,326],[326,462],[2,326],[326,370],[370,2],[305,460],[460,455],[455,305],[254,449],[449,448],[448,254],[255,261],[261,446],[446,255],[253,450],[450,449],[449,253],[252,451],[451,450],[450,252],[256,452],[452,451],[451,256],[341,453],[453,452],[452,341],[413,464],[464,463],[463,413],[441,413],[413,414],[414,441],[258,442],[442,441],[441,258],[257,443],[443,442],[442,257],[259,444],[444,443],[443,259],[260,445],[445,444],[444,260],[467,342],[342,445],[445,467],[459,458],[458,250],[250,459],[289,392],[392,290],[290,289],[290,328],[328,460],[460,290],[376,433],[433,435],[435,376],[250,290],[290,392],[392,250],[411,416],[416,433],[433,411],[341,463],[463,464],[464,341],[453,464],[464,465],[465,453],[357,465],[465,412],[412,357],[343,412],[412,399],[399,343],[360,363],[363,440],[440,360],[437,399],[399,456],[456,437],[420,456],[456,363],[363,420],[401,435],[435,288],[288,401],[372,383],[383,353],[353,372],[339,255],[255,249],[249,339],[448,261],[261,255],[255,448],[133,243],[243,190],[190,133],[133,155],[155,112],[112,133],[33,246],[246,247],[247,33],[33,130],[130,25],[25,33],[398,384],[384,286],[286,398],[362,398],[398,414],[414,362],[362,463],[463,341],[341,362],[263,359],[359,467],[467,263],[263,249],[249,255],[255,263],[466,467],[467,260],[260,466],[75,60],[60,166],[166,75],[238,239],[239,79],[79,238],[162,127],[127,139],[139,162],[72,11],[11,37],[37,72],[121,232],[232,120],[120,121],[73,72],[72,39],[39,73],[114,128],[128,47],[47,114],[233,232],[232,128],[128,233],[103,104],[104,67],[67,103],[152,175],[175,148],[148,152],[119,118],[118,101],[101,119],[74,73],[73,40],[40,74],[107,9],[9,108],[108,107],[49,48],[48,131],[131,49],[32,194],[194,211],[211,32],[184,74],[74,185],[185,184],[191,80],[80,183],[183,191],[185,40],[40,186],[186,185],[119,230],[230,118],[118,119],[210,202],[202,214],[214,210],[84,83],[83,17],[17,84],[77,76],[76,146],[146,77],[161,160],[160,30],[30,161],[190,56],[56,173],[173,190],[182,106],[106,194],[194,182],[138,135],[135,192],[192,138],[129,203],[203,98],[98,129],[54,21],[21,68],[68,54],[5,51],[51,4],[4,5],[145,144],[144,23],[23,145],[90,77],[77,91],[91,90],[207,205],[205,187],[187,207],[83,201],[201,18],[18,83],[181,91],[91,182],[182,181],[180,90],[90,181],[181,180],[16,85],[85,17],[17,16],[205,206],[206,36],[36,205],[176,148],[148,140],[140,176],[165,92],[92,39],[39,165],[245,193],[193,244],[244,245],[27,159],[159,28],[28,27],[30,247],[247,161],[161,30],[174,236],[236,196],[196,174],[103,54],[54,104],[104,103],[55,193],[193,8],[8,55],[111,117],[117,31],[31,111],[221,189],[189,55],[55,221],[240,98],[98,99],[99,240],[142,126],[126,100],[100,142],[219,166],[166,218],[218,219],[112,155],[155,26],[26,112],[198,209],[209,131],[131,198],[169,135],[135,150],[150,169],[114,47],[47,217],[217,114],[224,223],[223,53],[53,224],[220,45],[45,134],[134,220],[32,211],[211,140],[140,32],[109,67],[67,108],[108,109],[146,43],[43,91],[91,146],[231,230],[230,120],[120,231],[113,226],[226,247],[247,113],[105,63],[63,52],[52,105],[241,238],[238,242],[242,241],[124,46],[46,156],[156,124],[95,78],[78,96],[96,95],[70,46],[46,63],[63,70],[116,143],[143,227],[227,116],[116,123],[123,111],[111,116],[1,44],[44,19],[19,1],[3,236],[236,51],[51,3],[207,216],[216,205],[205,207],[26,154],[154,22],[22,26],[165,39],[39,167],[167,165],[199,200],[200,208],[208,199],[101,36],[36,100],[100,101],[43,57],[57,202],[202,43],[242,20],[20,99],[99,242],[56,28],[28,157],[157,56],[124,35],[35,113],[113,124],[29,160],[160,27],[27,29],[211,204],[204,210],[210,211],[124,113],[113,46],[46,124],[106,43],[43,204],[204,106],[96,62],[62,77],[77,96],[227,137],[137,116],[116,227],[73,41],[41,72],[72,73],[36,203],[203,142],[142,36],[235,64],[64,240],[240,235],[48,49],[49,64],[64,48],[42,41],[41,74],[74,42],[214,212],[212,207],[207,214],[183,42],[42,184],[184,183],[210,169],[169,211],[211,210],[140,170],[170,176],[176,140],[104,105],[105,69],[69,104],[193,122],[122,168],[168,193],[50,123],[123,187],[187,50],[89,96],[96,90],[90,89],[66,65],[65,107],[107,66],[179,89],[89,180],[180,179],[119,101],[101,120],[120,119],[68,63],[63,104],[104,68],[234,93],[93,227],[227,234],[16,15],[15,85],[85,16],[209,129],[129,49],[49,209],[15,14],[14,86],[86,15],[107,55],[55,9],[9,107],[120,100],[100,121],[121,120],[153,145],[145,22],[22,153],[178,88],[88,179],[179,178],[197,6],[6,196],[196,197],[89,88],[88,96],[96,89],[135,138],[138,136],[136,135],[138,215],[215,172],[172,138],[218,115],[115,219],[219,218],[41,42],[42,81],[81,41],[5,195],[195,51],[51,5],[57,43],[43,61],[61,57],[208,171],[171,199],[199,208],[41,81],[81,38],[38,41],[224,53],[53,225],[225,224],[24,144],[144,110],[110,24],[105,52],[52,66],[66,105],[118,229],[229,117],[117,118],[227,34],[34,234],[234,227],[66,107],[107,69],[69,66],[10,109],[109,151],[151,10],[219,48],[48,235],[235,219],[183,62],[62,191],[191,183],[142,129],[129,126],[126,142],[116,111],[111,143],[143,116],[118,117],[117,50],[50,118],[223,222],[222,52],[52,223],[94,19],[19,141],[141,94],[222,221],[221,65],[65,222],[196,3],[3,197],[197,196],[45,220],[220,44],[44,45],[156,70],[70,139],[139,156],[188,122],[122,245],[245,188],[139,71],[71,162],[162,139],[149,170],[170,150],[150,149],[122,188],[188,196],[196,122],[206,216],[216,92],[92,206],[164,2],[2,167],[167,164],[242,141],[141,241],[241,242],[0,164],[164,37],[37,0],[11,72],[72,12],[12,11],[12,38],[38,13],[13,12],[70,63],[63,71],[71,70],[31,226],[226,111],[111,31],[36,101],[101,205],[205,36],[203,206],[206,165],[165,203],[126,209],[209,217],[217,126],[98,165],[165,97],[97,98],[237,220],[220,218],[218,237],[237,239],[239,241],[241,237],[210,214],[214,169],[169,210],[140,171],[171,32],[32,140],[241,125],[125,237],[237,241],[179,86],[86,178],[178,179],[180,85],[85,179],[179,180],[181,84],[84,180],[180,181],[182,83],[83,181],[181,182],[194,201],[201,182],[182,194],[177,137],[137,132],[132,177],[184,76],[76,183],[183,184],[185,61],[61,184],[184,185],[186,57],[57,185],[185,186],[216,212],[212,186],[186,216],[192,214],[214,187],[187,192],[139,34],[34,156],[156,139],[218,79],[79,237],[237,218],[147,123],[123,177],[177,147],[45,44],[44,4],[4,45],[208,201],[201,32],[32,208],[98,64],[64,129],[129,98],[192,213],[213,138],[138,192],[235,59],[59,219],[219,235],[141,242],[242,97],[97,141],[97,2],[2,141],[141,97],[240,75],[75,235],[235,240],[229,24],[24,228],[228,229],[31,25],[25,226],[226,31],[230,23],[23,229],[229,230],[231,22],[22,230],[230,231],[232,26],[26,231],[231,232],[233,112],[112,232],[232,233],[244,189],[189,243],[243,244],[189,221],[221,190],[190,189],[222,28],[28,221],[221,222],[223,27],[27,222],[222,223],[224,29],[29,223],[223,224],[225,30],[30,224],[224,225],[113,247],[247,225],[225,113],[99,60],[60,240],[240,99],[213,147],[147,215],[215,213],[60,20],[20,166],[166,60],[192,187],[187,213],[213,192],[243,112],[112,244],[244,243],[244,233],[233,245],[245,244],[245,128],[128,188],[188,245],[188,114],[114,174],[174,188],[134,131],[131,220],[220,134],[174,217],[217,236],[236,174],[236,198],[198,134],[134,236],[215,177],[177,58],[58,215],[156,143],[143,124],[124,156],[25,110],[110,7],[7,25],[31,228],[228,25],[25,31],[264,356],[356,368],[368,264],[0,11],[11,267],[267,0],[451,452],[452,349],[349,451],[267,302],[302,269],[269,267],[350,357],[357,277],[277,350],[350,452],[452,357],[357,350],[299,333],[333,297],[297,299],[396,175],[175,377],[377,396],[280,347],[347,330],[330,280],[269,303],[303,270],[270,269],[151,9],[9,337],[337,151],[344,278],[278,360],[360,344],[424,418],[418,431],[431,424],[270,304],[304,409],[409,270],[272,310],[310,407],[407,272],[322,270],[270,410],[410,322],[449,450],[450,347],[347,449],[432,422],[422,434],[434,432],[18,313],[313,17],[17,18],[291,306],[306,375],[375,291],[259,387],[387,260],[260,259],[424,335],[335,418],[418,424],[434,364],[364,416],[416,434],[391,423],[423,327],[327,391],[301,251],[251,298],[298,301],[275,281],[281,4],[4,275],[254,373],[373,253],[253,254],[375,307],[307,321],[321,375],[280,425],[425,411],[411,280],[200,421],[421,18],[18,200],[335,321],[321,406],[406,335],[321,320],[320,405],[405,321],[314,315],[315,17],[17,314],[423,426],[426,266],[266,423],[396,377],[377,369],[369,396],[270,322],[322,269],[269,270],[413,417],[417,464],[464,413],[385,386],[386,258],[258,385],[248,456],[456,419],[419,248],[298,284],[284,333],[333,298],[168,417],[417,8],[8,168],[448,346],[346,261],[261,448],[417,413],[413,285],[285,417],[326,327],[327,328],[328,326],[277,355],[355,329],[329,277],[309,392],[392,438],[438,309],[381,382],[382,256],[256,381],[279,429],[429,360],[360,279],[365,364],[364,379],[379,365],[355,277],[277,437],[437,355],[282,443],[443,283],[283,282],[281,275],[275,363],[363,281],[395,431],[431,369],[369,395],[299,297],[297,337],[337,299],[335,273],[273,321],[321,335],[348,450],[450,349],[349,348],[359,446],[446,467],[467,359],[283,293],[293,282],[282,283],[250,458],[458,462],[462,250],[300,276],[276,383],[383,300],[292,308],[308,325],[325,292],[283,276],[276,293],[293,283],[264,372],[372,447],[447,264],[346,352],[352,340],[340,346],[354,274],[274,19],[19,354],[363,456],[456,281],[281,363],[426,436],[436,425],[425,426],[380,381],[381,252],[252,380],[267,269],[269,393],[393,267],[421,200],[200,428],[428,421],[371,266],[266,329],[329,371],[432,287],[287,422],[422,432],[290,250],[250,328],[328,290],[385,258],[258,384],[384,385],[446,265],[265,342],[342,446],[386,387],[387,257],[257,386],[422,424],[424,430],[430,422],[445,342],[342,276],[276,445],[422,273],[273,424],[424,422],[306,292],[292,307],[307,306],[352,366],[366,345],[345,352],[268,271],[271,302],[302,268],[358,423],[423,371],[371,358],[327,294],[294,460],[460,327],[331,279],[279,294],[294,331],[303,271],[271,304],[304,303],[436,432],[432,427],[427,436],[304,272],[272,408],[408,304],[395,394],[394,431],[431,395],[378,395],[395,400],[400,378],[296,334],[334,299],[299,296],[6,351],[351,168],[168,6],[376,352],[352,411],[411,376],[307,325],[325,320],[320,307],[285,295],[295,336],[336,285],[320,319],[319,404],[404,320],[329,330],[330,349],[349,329],[334,293],[293,333],[333,334],[366,323],[323,447],[447,366],[316,15],[15,315],[315,316],[331,358],[358,279],[279,331],[317,14],[14,316],[316,317],[8,285],[285,9],[9,8],[277,329],[329,350],[350,277],[253,374],[374,252],[252,253],[319,318],[318,403],[403,319],[351,6],[6,419],[419,351],[324,318],[318,325],[325,324],[397,367],[367,365],[365,397],[288,435],[435,397],[397,288],[278,344],[344,439],[439,278],[310,272],[272,311],[311,310],[248,195],[195,281],[281,248],[375,273],[273,291],[291,375],[175,396],[396,199],[199,175],[312,311],[311,268],[268,312],[276,283],[283,445],[445,276],[390,373],[373,339],[339,390],[295,282],[282,296],[296,295],[448,449],[449,346],[346,448],[356,264],[264,454],[454,356],[337,336],[336,299],[299,337],[337,338],[338,151],[151,337],[294,278],[278,455],[455,294],[308,292],[292,415],[415,308],[429,358],[358,355],[355,429],[265,340],[340,372],[372,265],[352,346],[346,280],[280,352],[295,442],[442,282],[282,295],[354,19],[19,370],[370,354],[285,441],[441,295],[295,285],[195,248],[248,197],[197,195],[457,440],[440,274],[274,457],[301,300],[300,368],[368,301],[417,351],[351,465],[465,417],[251,301],[301,389],[389,251],[394,395],[395,379],[379,394],[399,412],[412,419],[419,399],[410,436],[436,322],[322,410],[326,2],[2,393],[393,326],[354,370],[370,461],[461,354],[393,164],[164,267],[267,393],[268,302],[302,12],[12,268],[312,268],[268,13],[13,312],[298,293],[293,301],[301,298],[265,446],[446,340],[340,265],[280,330],[330,425],[425,280],[322,426],[426,391],[391,322],[420,429],[429,437],[437,420],[393,391],[391,326],[326,393],[344,440],[440,438],[438,344],[458,459],[459,461],[461,458],[364,434],[434,394],[394,364],[428,396],[396,262],[262,428],[274,354],[354,457],[457,274],[317,316],[316,402],[402,317],[316,315],[315,403],[403,316],[315,314],[314,404],[404,315],[314,313],[313,405],[405,314],[313,421],[421,406],[406,313],[323,366],[366,361],[361,323],[292,306],[306,407],[407,292],[306,291],[291,408],[408,306],[291,287],[287,409],[409,291],[287,432],[432,410],[410,287],[427,434],[434,411],[411,427],[372,264],[264,383],[383,372],[459,309],[309,457],[457,459],[366,352],[352,401],[401,366],[1,274],[274,4],[4,1],[418,421],[421,262],[262,418],[331,294],[294,358],[358,331],[435,433],[433,367],[367,435],[392,289],[289,439],[439,392],[328,462],[462,326],[326,328],[94,2],[2,370],[370,94],[289,305],[305,455],[455,289],[339,254],[254,448],[448,339],[359,255],[255,446],[446,359],[254,253],[253,449],[449,254],[253,252],[252,450],[450,253],[252,256],[256,451],[451,252],[256,341],[341,452],[452,256],[414,413],[413,463],[463,414],[286,441],[441,414],[414,286],[286,258],[258,441],[441,286],[258,257],[257,442],[442,258],[257,259],[259,443],[443,257],[259,260],[260,444],[444,259],[260,467],[467,445],[445,260],[309,459],[459,250],[250,309],[305,289],[289,290],[290,305],[305,290],[290,460],[460,305],[401,376],[376,435],[435,401],[309,250],[250,392],[392,309],[376,411],[411,433],[433,376],[453,341],[341,464],[464,453],[357,453],[453,465],[465,357],[343,357],[357,412],[412,343],[437,343],[343,399],[399,437],[344,360],[360,440],[440,344],[420,437],[437,456],[456,420],[360,420],[420,363],[363,360],[361,401],[401,288],[288,361],[265,372],[372,353],[353,265],[390,339],[339,249],[249,390],[339,448],[448,255],[255,339]]),E("VERSION","0.4.1646425229")}).call(PZ);var OZ=function(){return OZ=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},OZ.apply(this,arguments)};function DZ(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{l(r.next(t))}catch(t){o(t)}}function s(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((r=r.apply(t,e||[])).next())}))}function LZ(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var FZ=["rightEye","leftEye","noseTip","mouthCenter","rightEarTragion","leftEarTragion"],UZ={modelType:"short",runtime:"mediapipe",maxFaces:1},BZ=function(){function t(t){var e=this;this.width=0,this.height=0,this.selfieMode=!1,this.faceDetectorSolution=new NZ.FaceDetection({locateFile:function(e,n){return t.solutionPath?t.solutionPath.replace(/\/+$/,"")+"/"+e:n+"/"+e}}),this.faceDetectorSolution.setOptions({selfieMode:this.selfieMode,model:t.modelType}),this.faceDetectorSolution.onResults((function(t){if(e.height=t.image.height,e.width=t.image.width,e.faces=[],null!==t.detections)for(var n=0,r=t.detections;n<r.length;n++){var i=r[n];e.faces.push(e.normalizedToAbsolute(i.landmarks,{xMin:a=(o=i.boundingBox).xCenter-o.width/2,xMax:a+o.width,yMin:s=o.yCenter-o.height/2,yMax:s+o.height,width:o.width,height:o.height}))}var o,a,s}))}return t.prototype.normalizedToAbsolute=function(t,e){var n=this;return{keypoints:t.map((function(t,e){return{x:t.x*n.width,y:t.y*n.height,name:FZ[e]}})),box:{xMin:e.xMin*this.width,yMin:e.yMin*this.height,xMax:e.xMax*this.width,yMax:e.yMax*this.height,width:e.width*this.width,height:e.height*this.height}}},t.prototype.estimateFaces=function(t,e){return DZ(this,void 0,void 0,(function(){var n,r;return LZ(this,(function(i){switch(i.label){case 0:return e&&e.flipHorizontal&&e.flipHorizontal!==this.selfieMode&&(this.selfieMode=e.flipHorizontal,this.faceDetectorSolution.setOptions({selfieMode:this.selfieMode})),t instanceof bB?(r=ImageData.bind,[4,cV(t)]):[3,2];case 1:return n=new(r.apply(ImageData,[void 0,i.sent(),t.shape[1],t.shape[0]])),[3,3];case 2:n=t,i.label=3;case 3:return t=n,[4,this.faceDetectorSolution.send({image:t})];case 4:return i.sent(),[2,this.faces]}}))}))},t.prototype.dispose=function(){this.faceDetectorSolution.close()},t.prototype.reset=function(){this.faceDetectorSolution.reset(),this.width=0,this.height=0,this.faces=null,this.selfieMode=!1},t.prototype.initialize=function(){return this.faceDetectorSolution.initialize()},t}();function zZ(t){return DZ(this,void 0,void 0,(function(){var e,n;return LZ(this,(function(r){switch(r.label){case 0:return e=function(t){if(null==t)return OZ({},UZ);var e=OZ({},t);return e.runtime="mediapipe",null==e.modelType&&(e.modelType=UZ.modelType),null==e.maxFaces&&(e.maxFaces=UZ.maxFaces),e}(t),[4,(n=new BZ(e)).initialize()];case 1:return r.sent(),[2,n]}}))}))}function jZ(t){return t instanceof bB?{height:t.shape[0],width:t.shape[1]}:{height:t.height,width:t.width}}function VZ(t){return t instanceof bB?t:uV(t)}function WZ(t,e){aD(0!==t.width,(function(){return e+" width cannot be 0."})),aD(0!==t.height,(function(){return e+" height cannot be 0."}))}function GZ(t){null==t.reduceBoxesInLowestLayer&&(t.reduceBoxesInLowestLayer=!1),null==t.interpolatedScaleAspectRatio&&(t.interpolatedScaleAspectRatio=1),null==t.fixedAnchorSize&&(t.fixedAnchorSize=!1);for(var e=[],n=0;n<t.numLayers;){for(var r=[],i=[],o=[],a=[],s=n;s<t.strides.length&&t.strides[s]===t.strides[n];){var l=HZ(t.minScale,t.maxScale,s,t.strides.length);if(0===s&&t.reduceBoxesInLowestLayer)o.push(1),o.push(2),o.push(.5),a.push(.1),a.push(l),a.push(l);else{for(var c=0;c<t.aspectRatios.length;++c)o.push(t.aspectRatios[c]),a.push(l);if(t.interpolatedScaleAspectRatio>0){var u=s===t.strides.length-1?1:HZ(t.minScale,t.maxScale,s+1,t.strides.length);a.push(Math.sqrt(l*u)),o.push(t.interpolatedScaleAspectRatio)}}s++}for(var h=0;h<o.length;++h){var d=Math.sqrt(o[h]);r.push(a[h]/d),i.push(a[h]*d)}var p=0,f=0;if(t.featureMapHeight.length>0)p=t.featureMapHeight[n],f=t.featureMapWidth[n];else{var m=t.strides[n];p=Math.ceil(t.inputSizeHeight/m),f=Math.ceil(t.inputSizeWidth/m)}for(var g=0;g<p;++g)for(var y=0;y<f;++y)for(var v=0;v<r.length;++v){var b={xCenter:(y+t.anchorOffsetX)/f,yCenter:(g+t.anchorOffsetY)/p,width:0,height:0};t.fixedAnchorSize?(b.width=1,b.height=1):(b.width=i[v],b.height=r[v]),e.push(b)}n=s}return e}function HZ(t,e,n,r){return 1===r?.5*(t+e):t+(e-t)*n/(r-1)}function qZ(t,e){var n=e[0],r=e[1];return[n*t[0]+r*t[1]+t[3],n*t[4]+r*t[5]+t[7]]}function XZ(t,e,n,r){return DZ(this,void 0,void 0,(function(){var r,i,o,a,s;return LZ(this,(function(l){switch(l.label){case 0:return t.sort((function(t,e){return Math.max.apply(Math,e.score)-Math.max.apply(Math,t.score)})),r=cq(t.map((function(t){return[t.locationData.relativeBoundingBox.yMin,t.locationData.relativeBoundingBox.xMin,t.locationData.relativeBoundingBox.yMax,t.locationData.relativeBoundingBox.xMax]}))),i=lq(t.map((function(t){return t.score[0]}))),[4,VX.nonMaxSuppressionAsync(r,i,e,n)];case 1:return[4,(o=l.sent()).array()];case 2:return a=l.sent(),s=t.filter((function(t,e){return a.indexOf(e)>-1})),oz([r,i,o]),[2,s]}}))}))}function YZ(t,e,n){return DZ(this,void 0,void 0,(function(){var r,i,o,a,s;return LZ(this,(function(l){switch(l.label){case 0:return r=t[0],i=t[1],o=function(t,e,n){return iz((function(){var r,i,o,a;n.reverseOutputOrder?(i=rq(cW(t,[0,n.boxCoordOffset+0],[-1,1])),r=rq(cW(t,[0,n.boxCoordOffset+1],[-1,1])),a=rq(cW(t,[0,n.boxCoordOffset+2],[-1,1])),o=rq(cW(t,[0,n.boxCoordOffset+3],[-1,1]))):(r=rq(cW(t,[0,n.boxCoordOffset+0],[-1,1])),i=rq(cW(t,[0,n.boxCoordOffset+1],[-1,1])),o=rq(cW(t,[0,n.boxCoordOffset+2],[-1,1])),a=rq(cW(t,[0,n.boxCoordOffset+3],[-1,1]))),i=pj(gj(mj(i,n.xScale),e.w),e.x),r=pj(gj(mj(r,n.yScale),e.h),e.y),n.applyExponentialOnBoxSize?(o=gj(hG(mj(o,n.hScale)),e.h),a=gj(hG(mj(a,n.wScale)),e.w)):(o=gj(mj(o,n.hScale),e.h),a=gj(mj(a,n.wScale),e.h));var s=Ij(r,mj(o,2)),l=Ij(i,mj(a,2)),c=pj(r,mj(o,2)),u=pj(i,mj(a,2)),h=aW([rW(s,[n.numBoxes,1]),rW(l,[n.numBoxes,1]),rW(c,[n.numBoxes,1]),rW(u,[n.numBoxes,1])],1);if(n.numKeypoints)for(var d=0;d<n.numKeypoints;++d){var p=n.keypointCoordOffset+d*n.numValuesPerKeypoint,f=void 0,m=void 0;n.reverseOutputOrder?(f=rq(cW(t,[0,p],[-1,1])),m=rq(cW(t,[0,p+1],[-1,1]))):(m=rq(cW(t,[0,p],[-1,1])),f=rq(cW(t,[0,p+1],[-1,1])));var g=pj(gj(mj(f,n.xScale),e.w),e.x),y=pj(gj(mj(m,n.yScale),e.h),e.y);h=aW([h,rW(g,[n.numBoxes,1]),rW(y,[n.numBoxes,1])],1)}return h}))}(i,e,n),a=iz((function(){var t=r;return n.sigmoidScore?(null!=n.scoreClippingThresh&&(t=wW(r,-n.scoreClippingThresh,n.scoreClippingThresh)),t=lW(t)):t})),[4,KZ(o,a,n)];case 1:return s=l.sent(),oz([o,a]),[2,s]}}))}))}function KZ(t,e,n){return DZ(this,void 0,void 0,(function(){var r,i,o,a,s,l,c,u,h,d,p,f;return LZ(this,(function(m){switch(m.label){case 0:return r=[],[4,t.data()];case 1:return i=m.sent(),[4,e.data()];case 2:for(o=m.sent(),a=0;a<n.numBoxes;++a)if(!(null!=n.minScoreThresh&&o[a]<n.minScoreThresh||(s=a*n.numCoords,l=ZZ(i[s+0],i[s+1],i[s+2],i[s+3],o[a],n.flipVertically,a),(c=l.locationData.relativeBoundingBox).width<0||c.height<0))){if(n.numKeypoints>0)for((u=l.locationData).relativeKeypoints=[],h=n.numKeypoints*n.numValuesPerKeypoint,d=0;d<h;d+=n.numValuesPerKeypoint)p=s+n.keypointCoordOffset+d,f={x:i[p+0],y:n.flipVertically?1-i[p+1]:i[p+1]},u.relativeKeypoints.push(f);r.push(l)}return[2,r]}}))}))}function ZZ(t,e,n,r,i,o,a){return{score:[i],ind:a,locationData:{relativeBoundingBox:{xMin:e,yMin:o?1-n:t,xMax:r,yMax:o?1-t:n,width:r-e,height:n-t}}}}var JZ,QZ={reduceBoxesInLowestLayer:!1,interpolatedScaleAspectRatio:1,featureMapHeight:[],featureMapWidth:[],numLayers:4,minScale:.1484375,maxScale:.75,inputSizeHeight:128,inputSizeWidth:128,anchorOffsetX:.5,anchorOffsetY:.5,strides:[8,16,16,16],aspectRatios:[1],fixedAnchorSize:!0},$Z={reduceBoxesInLowestLayer:!1,interpolatedScaleAspectRatio:0,featureMapHeight:[],featureMapWidth:[],numLayers:1,minScale:.1484375,maxScale:.75,inputSizeHeight:192,inputSizeWidth:192,anchorOffsetX:.5,anchorOffsetY:.5,strides:[4],aspectRatios:[1],fixedAnchorSize:!0},tJ={runtime:"tfjs",modelType:"short",maxFaces:1,detectorModelUrl:"https://tfhub.dev/mediapipe/tfjs-model/face_detection/short/1"},eJ={applyExponentialOnBoxSize:!1,flipVertically:!1,ignoreClasses:[],numClasses:1,numBoxes:896,numCoords:16,boxCoordOffset:0,keypointCoordOffset:4,numKeypoints:6,numValuesPerKeypoint:2,sigmoidScore:!0,scoreClippingThresh:100,reverseOutputOrder:!0,xScale:128,yScale:128,hScale:128,wScale:128,minScoreThresh:.5},nJ={applyExponentialOnBoxSize:!1,flipVertically:!1,ignoreClasses:[],numClasses:1,numBoxes:2304,numCoords:16,boxCoordOffset:0,keypointCoordOffset:4,numKeypoints:6,numValuesPerKeypoint:2,sigmoidScore:!0,scoreClippingThresh:100,reverseOutputOrder:!0,xScale:192,yScale:192,hScale:192,wScale:192,minScoreThresh:.6},rJ={outputTensorSize:{width:128,height:128},keepAspectRatio:!0,outputTensorFloatRange:[-1,1],borderMode:"zero"},iJ={outputTensorSize:{width:192,height:192},keepAspectRatio:!0,outputTensorFloatRange:[-1,1],borderMode:"zero"},oJ=function(){function t(t,e,n){this.detectorModel=e,this.maxFaces=n,"full"===t?(this.imageToTensorConfig=iJ,this.tensorsToDetectionConfig=nJ,this.anchors=GZ($Z)):(this.imageToTensorConfig=rJ,this.tensorsToDetectionConfig=eJ,this.anchors=GZ(QZ));var r=lq(this.anchors.map((function(t){return t.width}))),i=lq(this.anchors.map((function(t){return t.height}))),o=lq(this.anchors.map((function(t){return t.xCenter}))),a=lq(this.anchors.map((function(t){return t.yCenter})));this.anchorTensor={x:o,y:a,w:r,h:i}}return t.prototype.dispose=function(){this.detectorModel.dispose(),oz([this.anchorTensor.x,this.anchorTensor.y,this.anchorTensor.w,this.anchorTensor.h])},t.prototype.reset=function(){},t.prototype.detectFaces=function(t,e){return void 0===e&&(e=!1),DZ(this,void 0,void 0,(function(){var n,r,i,o,a,s,l,c,u,h,d;return LZ(this,(function(p){switch(p.label){case 0:return null==t?(this.reset(),[2,[]]):(n=iz((function(){var n=uj(VZ(t),"float32");return e&&(n=rq(VX.flipLeftRight(dG(n,0)),[0])),n})),r=function(t,e,n){var r=e.outputTensorSize,i=e.keepAspectRatio,o=e.borderMode,a=e.outputTensorFloatRange,s=jZ(t),l=function(t,e){return e?{xCenter:e.xCenter*t.width,yCenter:e.yCenter*t.height,width:e.width*t.width,height:e.height*t.height,rotation:e.rotation}:{xCenter:.5*t.width,yCenter:.5*t.height,width:t.width,height:t.height,rotation:0}}(s,n),c=function(t,e,n){if(void 0===n&&(n=!1),!n)return{top:0,left:0,right:0,bottom:0};var r=e.height,i=e.width;WZ(e,"targetSize"),WZ(t,"roi");var o,a,s=r/i,l=t.height/t.width,c=0,u=0;return s>l?(o=t.width,a=t.width*s,u=(1-l/s)/2):(o=t.height/s,a=t.height,c=(1-s/l)/2),t.width=o,t.height=a,{top:u,left:c,right:c,bottom:u}}(l,r,i),u=function(t,e,n,r){var i=t.width,o=t.height,a=Math.cos(t.rotation),s=Math.sin(t.rotation),l=t.xCenter,c=t.yCenter,u=1/e,h=1/n,d=new Array(16);return d[0]=i*a*1*u,d[1]=-o*s*u,d[2]=0,d[3]=(-.5*i*a*1+.5*o*s+l)*u,d[4]=i*s*1*h,d[5]=o*a*h,d[6]=0,d[7]=(-.5*o*a-.5*i*s*1+c)*h,d[8]=0,d[9]=0,d[10]=i*u,d[11]=0,d[12]=0,d[13]=0,d[14]=0,d[15]=1,function(t){if(16!==t.length)throw new Error("Array length must be 16 but got "+t.length);return[[t[0],t[1],t[2],t[3]],[t[4],t[5],t[6],t[7]],[t[8],t[9],t[10],t[11]],[t[12],t[13],t[14],t[15]]]}(d)}(l,s.width,s.height),h=iz((function(){var e=VZ(t),n=cq(function(t,e,n){return WZ(n,"inputResolution"),[1/n.width*t[0][0]*e.width,1/n.height*t[0][1]*e.width,t[0][3]*e.width,1/n.width*t[1][0]*e.height,1/n.height*t[1][1]*e.height,t[1][3]*e.height,0,0]}(u,s,r),[1,8]),i="zero"===o?"constant":"nearest",l=VX.transform(dG(uj(e,"float32")),n,"bilinear",i,0,[r.height,r.width]);return null!=a?function(t,e){var n=function(t,e,n,r){var i=(r-n)/255;return{scale:i,offset:n-0*i}}(0,0,e[0],e[1]);return iz((function(){return pj(gj(t,n.scale),n.offset)}))}(l,a):l}));return{imageTensor:h,padding:c,transformationMatrix:u}}(n,this.imageToTensorConfig),i=r.imageTensor,o=r.transformationMatrix,a=this.detectorModel.execute(i,"Identity:0"),s=function(t){return iz((function(){var e=function(t){return iz((function(){return[cW(t,[0,0,0],[1,-1,1]),cW(t,[0,0,1],[1,-1,-1])]}))}(t),n=e[0],r=e[1];return{boxes:rq(r),logits:rq(n)}}))}(a),l=s.boxes,[4,YZ([c=s.logits,l],this.anchorTensor,this.tensorsToDetectionConfig)]);case 1:return 0===(u=p.sent()).length?(oz([n,i,a,c,l]),[2,u]):[4,XZ(u,this.maxFaces,.3)];case 2:return h=p.sent(),d=function(t,e){void 0===t&&(t=[]);var n,r=(n=e,[].concat.apply([],n));return t.forEach((function(t){var e=t.locationData;e.relativeKeypoints.forEach((function(t){var e=qZ(r,[t.x,t.y]),n=e[0],i=e[1];t.x=n,t.y=i}));var n=e.relativeBoundingBox,i=Number.MAX_VALUE,o=Number.MAX_VALUE,a=Number.MIN_VALUE,s=Number.MIN_VALUE;[[n.xMin,n.yMin],[n.xMin+n.width,n.yMin],[n.xMin+n.width,n.yMin+n.height],[n.xMin,n.yMin+n.height]].forEach((function(t){var e=qZ(r,t),n=e[0],l=e[1];i=Math.min(i,n),a=Math.max(a,n),o=Math.min(o,l),s=Math.max(s,l)})),e.relativeBoundingBox={xMin:i,xMax:a,yMin:o,yMax:s,width:a-i,height:s-o}})),t}(h,o),oz([n,i,a,c,l]),[2,d]}}))}))},t.prototype.estimateFaces=function(t,e){return DZ(this,void 0,void 0,(function(){var n,r;return LZ(this,(function(i){return n=jZ(t),r=!!e&&e.flipHorizontal,[2,this.detectFaces(t,r).then((function(t){return t.map((function(t){for(var e=t.locationData.relativeKeypoints.map((function(t,e){return OZ(OZ({},t),{x:t.x*n.width,y:t.y*n.height,name:FZ[e]})})),r=t.locationData.relativeBoundingBox,i=0,o=["width","xMax","xMin"];i<o.length;i++)r[o[i]]*=n.width;for(var a=0,s=["height","yMax","yMin"];a<s.length;a++)r[s[a]]*=n.height;return{keypoints:e,box:r}}))}))]}))}))},t}();function aJ(t){return DZ(this,void 0,void 0,(function(){var e,n,r;return LZ(this,(function(i){switch(i.label){case 0:return e=function(t){if(null==t)return OZ({},tJ);var e=OZ({},t);return null==e.modelType&&(e.modelType=tJ.modelType),null==e.maxFaces&&(e.maxFaces=tJ.maxFaces),null==e.detectorModelUrl&&("full"===e.modelType?e.detectorModelUrl="https://tfhub.dev/mediapipe/tfjs-model/face_detection/full/1":e.detectorModelUrl="https://tfhub.dev/mediapipe/tfjs-model/face_detection/short/1"),e}(t),n="string"==typeof e.detectorModelUrl&&e.detectorModelUrl.indexOf("https://tfhub.dev")>-1,[4,bZ(e.detectorModelUrl,{fromTFHub:n})];case 1:return r=i.sent(),[2,new oJ(e.modelType,r,e.maxFaces)]}}))}))}function sJ(t,e){return DZ(this,void 0,void 0,(function(){var n,r;return LZ(this,(function(i){if(t===JZ.MediaPipeFaceDetector){if(r=void 0,null!=(n=e)){if("tfjs"===n.runtime)return[2,aJ(n)];if("mediapipe"===n.runtime)return[2,zZ(n)];r=n.runtime}throw new Error("Expect modelConfig.runtime to be either 'tfjs' or 'mediapipe', but got "+r)}throw new Error(t+" is not a supported model name.")}))}))}function lJ(t){return t.width*t.height}function cJ(t){var e=t.xCenter-t.width/2,n=e+t.width,r=t.yCenter-t.height/2;return{xMin:e,xMax:n,yMin:r,yMax:r+t.height,width:t.width,height:t.height}}function uJ(t){return t instanceof bB?{height:t.shape[0],width:t.shape[1]}:{height:t.height,width:t.width}}function hJ(t){return t-2*Math.PI*Math.floor((t+Math.PI)/(2*Math.PI))}function dJ(t){return t instanceof bB?t:uV(t)}function pJ(t,e){aD(0!==t.width,(function(){return e+" width cannot be 0."})),aD(0!==t.height,(function(){return e+" height cannot be 0."}))}function fJ(t,e,n){var r=e.outputTensorSize,i=e.keepAspectRatio,o=e.borderMode,a=e.outputTensorFloatRange,s=uJ(t),l=function(t,e){return e?{xCenter:e.xCenter*t.width,yCenter:e.yCenter*t.height,width:e.width*t.width,height:e.height*t.height,rotation:e.rotation}:{xCenter:.5*t.width,yCenter:.5*t.height,width:t.width,height:t.height,rotation:0}}(s,n),c=function(t,e,n){if(void 0===n&&(n=!1),!n)return{top:0,left:0,right:0,bottom:0};var r=e.height,i=e.width;pJ(e,"targetSize"),pJ(t,"roi");var o,a,s=r/i,l=t.height/t.width,c=0,u=0;return s>l?(o=t.width,a=t.width*s,u=(1-l/s)/2):(o=t.height/s,a=t.height,c=(1-s/l)/2),t.width=o,t.height=a,{top:u,left:c,right:c,bottom:u}}(l,r,i),u=function(t,e,n,r){var i=t.width,o=t.height,a=r?-1:1,s=Math.cos(t.rotation),l=Math.sin(t.rotation),c=t.xCenter,u=t.yCenter,h=1/e,d=1/n,p=new Array(16);return p[0]=i*s*a*h,p[1]=-o*l*h,p[2]=0,p[3]=(-.5*i*s*a+.5*o*l+c)*h,p[4]=i*l*a*d,p[5]=o*s*d,p[6]=0,p[7]=(-.5*o*s-.5*i*l*a+u)*d,p[8]=0,p[9]=0,p[10]=i*h,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,function(t){if(16!==t.length)throw new Error("Array length must be 16 but got "+t.length);return[[t[0],t[1],t[2],t[3]],[t[4],t[5],t[6],t[7]],[t[8],t[9],t[10],t[11]],[t[12],t[13],t[14],t[15]]]}(p)}(l,s.width,s.height,!1),h=iz((function(){var e=dJ(t),n=cq(function(t,e,n){return pJ(n,"inputResolution"),[1/n.width*t[0][0]*e.width,1/n.height*t[0][1]*e.width,t[0][3]*e.width,1/n.width*t[1][0]*e.height,1/n.height*t[1][1]*e.height,t[1][3]*e.height,0,0]}(u,s,r),[1,8]),i="zero"===o?"constant":"nearest",l=VX.transform(dG(uj(e,"float32")),n,"bilinear",i,0,[r.height,r.width]);return null!=a?function(t,e){var n=function(t,e,n,r){var i=(r-n)/255;return{scale:i,offset:n-0*i}}(0,0,e[0],e[1]);return iz((function(){return pj(gj(t,n.scale),n.offset)}))}(l,a):l}));return{imageTensor:h,padding:c,transformationMatrix:u}}function mJ(t){return{xCenter:t.xMin+t.width/2,yCenter:t.yMin+t.height/2,width:t.width,height:t.height}}function gJ(t){var e=t.relativeKeypoints;if(e.length<=1)throw new Error("2 or more keypoints required to calculate a rect.");var n=Number.MAX_VALUE,r=Number.MAX_VALUE,i=Number.MIN_VALUE,o=Number.MIN_VALUE;return e.forEach((function(t){n=Math.min(n,t.x),i=Math.max(i,t.x),r=Math.min(r,t.y),o=Math.max(o,t.y)})),{xCenter:(n+i)/2,yCenter:(r+o)/2,width:i-n,height:o-r}}function yJ(t,e,n,r,i){var o="rect"===n?function(t,e,n){var r,i=t.locationData;if("boundingbox"===e)r=mJ(i.boundingBox);else{r=gJ(i);var o=n.width,a=n.height;r.xCenter=Math.round(r.xCenter*o),r.yCenter=Math.round(r.yCenter*a),r.width=Math.round(r.width*o),r.height=Math.round(r.height*a)}return r}(t,e,r):function(t,e){var n=t.locationData;return"boundingbox"===e?mJ(n.relativeBoundingBox):gJ(n)}(t,e);return i&&(o.rotation=function(t,e,n){var r,i=t.locationData,o=n.rotationVectorStartKeypointIndex,a=n.rotationVectorEndKeypointIndex;r=n.rotationVectorTargetAngle?n.rotationVectorTargetAngle:Math.PI*n.rotationVectorTargetAngleDegree/180;var s=i.relativeKeypoints[o].x*e.width,l=i.relativeKeypoints[o].y*e.height,c=i.relativeKeypoints[a].x*e.width,u=i.relativeKeypoints[a].y*e.height;return hJ(r-Math.atan2(-(u-l),c-s))}(t,r,i)),o}function vJ(t,e,n){for(var r=0;r<e.length;++r){var i=e[r],o=n[t[r]];o.x=i.x,o.y=i.y}}function bJ(t,e,n,r){if("string"==typeof e){if("copy"===e)for(var i=0;i<n.length;++i)r[t[i]].z=n[i].z}else{var o=function(t,e){for(var n=0,r=0;r<e.length;++r)n+=t[e[r]].z;return n/e.length}(r,e);for(i=0;i<t.length;++i)r[t[i]].z=o}}function xJ(t,e){for(var n=function(t){var e=[].concat.apply([],t.map((function(t){return t.indexesMapping})));if(0===e.length)throw new Error("There should be at least one landmark in indexes mapping");var n=e[0],r=e[0],i=new Set(e);i.forEach((function(t){n=Math.min(n,t),r=Math.max(r,t)}));var o=i.size;if(0!==n)throw new Error("Indexes are expected to start with 0 instead of "+n);if(r+1!==o)throw new Error("Indexes should have no gaps but "+(r-o+1)+" indexes are missing");return o}(e),r=new Array(n).fill(null).map(Object),i=0;i<t.length;++i){var o=t[i],a=e[i];if(o.length!==a.indexesMapping.length)throw new Error("There are "+o.length+" refinement landmarks while mapping has "+a.indexesMapping.length);vJ(a.indexesMapping,o,r),bJ(a.indexesMapping,a.zRefinement,o,r)}return r}function _J(t,e){return t.map((function(t){var n=xZ(xZ({},t),{x:t.x*e.width,y:t.y*e.height});return null!=t.z&&(n.z=t.z*e.width),n}))}function wJ(t,e){return"none"===t?e:function(t){return 1/(1+Math.exp(-t))}(e)}function SJ(t,e,n,r){return _Z(this,void 0,void 0,(function(){var i,o,a,s,l,c,u,h;return wZ(this,(function(d){switch(d.label){case 0:return n=n||e.flipHorizontally||!1,r=r||e.flipVertically||!1,i=t.size,o=i/e.numLandmarks,[4,t.data()];case 1:for(a=d.sent(),s=[],l=0;l<e.numLandmarks;++l)c=l*o,(h={x:0,y:0}).x=n?e.inputImageWidth-a[c]:a[c],o>1&&(h.y=r?e.inputImageHeight-a[c+1]:a[c+1]),o>2&&(h.z=a[c+2]),o>3&&(h.score=wJ(e.visibilityActivation,a[c+3])),s.push(h);for(u=0;u<s.length;++u)(h=s[u]).x=h.x/e.inputImageWidth,h.y=h.y/e.inputImageHeight,h.z=h.z/e.inputImageWidth/(e.normalizeZ||1);return[2,s]}}))}))}function TJ(t,e,n){var r=t.width,i=t.height,o=t.rotation;if(null==n.rotation&&null==n.rotationDegree||(o=function(t,e){return null!=e.rotation?t+=e.rotation:null!=e.rotationDegree&&(t+=Math.PI*e.rotationDegree/180),hJ(t)}(o,n)),0===o)t.xCenter=t.xCenter+r*n.shiftX,t.yCenter=t.yCenter+i*n.shiftY;else{var a=(e.width*r*n.shiftX*Math.cos(o)-e.height*i*n.shiftY*Math.sin(o))/e.width,s=(e.width*r*n.shiftX*Math.sin(o)+e.height*i*n.shiftY*Math.cos(o))/e.height;t.xCenter=t.xCenter+a,t.yCenter=t.yCenter+s}if(n.squareLong){var l=Math.max(r*e.width,i*e.height);r=l/e.width,i=l/e.height}else if(n.squareShort){var c=Math.min(r*e.width,i*e.height);r=c/e.width,i=c/e.height}return t.width=r*n.scaleX,t.height=i*n.scaleY,t}(JZ||(JZ={})).MediaPipeFaceDetector="MediaPipeFaceDetector";var EJ,MJ={runtime:"tfjs",maxFaces:1,refineLandmarks:!1,landmarkModelUrl:"https://tfhub.dev/mediapipe/tfjs-model/face_landmarks_detection/face_mesh/1"},CJ={flipHorizontal:!1,staticImageMode:!1},AJ={shiftX:0,shiftY:0,scaleX:1.5,scaleY:1.5,squareLong:!0},kJ={outputTensorSize:{width:192,height:192},outputTensorFloatRange:[0,1],borderMode:"replicate"},IJ={numLandmarks:468,inputImageWidth:192,inputImageHeight:192,visibilityActivation:"none",flipHorizontally:!1,flipVertically:!1},RJ={numLandmarks:80,inputImageWidth:192,inputImageHeight:192,visibilityActivation:"none",flipHorizontally:!1,flipVertically:!1},PJ={numLandmarks:71,inputImageWidth:192,inputImageHeight:192,visibilityActivation:"none",flipHorizontally:!1,flipVertically:!1},NJ={numLandmarks:5,inputImageWidth:192,inputImageHeight:192,visibilityActivation:"none",flipHorizontally:!1,flipVertically:!1},OJ={indexesMapping:Array.from(Array(468).keys()),zRefinement:"copy"},DJ={indexesMapping:[61,146,91,181,84,17,314,405,321,375,291,185,40,39,37,0,267,269,270,409,78,95,88,178,87,14,317,402,318,324,308,191,80,81,82,13,312,311,310,415,76,77,90,180,85,16,315,404,320,307,306,184,74,73,72,11,302,303,304,408,62,96,89,179,86,15,316,403,319,325,292,183,42,41,38,12,268,271,272,407],zRefinement:"none"},LJ={indexesMapping:[33,7,163,144,145,153,154,155,133,246,161,160,159,158,157,173,130,25,110,24,23,22,26,112,243,247,30,29,27,28,56,190,226,31,228,229,230,231,232,233,244,113,225,224,223,222,221,189,35,124,46,53,52,65,143,111,117,118,119,120,121,128,245,156,70,63,105,66,107,55,193],zRefinement:"none"},FJ={indexesMapping:[263,249,390,373,374,380,381,382,362,466,388,387,386,385,384,398,359,255,339,254,253,252,256,341,463,467,260,259,257,258,286,414,446,261,448,449,450,451,452,453,464,342,445,444,443,442,441,413,265,353,276,283,282,295,372,340,346,347,348,349,350,357,465,383,300,293,334,296,336,285,417],zRefinement:"none"},UJ={indexesMapping:[468,469,470,471,472],zRefinement:[33,7,163,144,145,153,154,155,133,246,161,160,159,158,157,173]},BJ={indexesMapping:[473,474,475,476,477],zRefinement:[263,249,390,373,374,380,381,382,362,466,388,387,386,385,384,398]},zJ=function(){function t(t,e,n,r){this.detector=t,this.landmarkModel=e,this.maxFaces=n,this.withAttention=r,this.prevFaceRectsFromLandmarks=null}return t.prototype.estimateFaces=function(t,e){return _Z(this,void 0,void 0,(function(){var n,r,i,o,a,s,l,c,u,h,d,p,f,m=this;return wZ(this,(function(g){switch(g.label){case 0:return n=function(t){if(null==t)return xZ({},CJ);var e=xZ({},t);return null==e.flipHorizontal&&(e.flipHorizontal=CJ.flipHorizontal),null==e.staticImageMode&&(e.staticImageMode=CJ.staticImageMode),e}(e),null==t?(this.reset(),[2,[]]):(r=uJ(t),i=iz((function(){var e=uj(dJ(t),"float32");return n.flipHorizontal&&(e=rq(VX.flipLeftRight(dG(e,0)),[0])),e})),o=this.prevFaceRectsFromLandmarks,n.staticImageMode||null==o||o.length<this.maxFaces?[4,this.detector.detectFaces(i,!1)]:[3,2]);case 1:return 0===(s=g.sent()).length?(this.reset(),i.dispose(),[2,[]]):(a=s.map((function(t){return m.faceDetectionFrontDetectionToRoi(t,r)})),[3,3]);case 2:a=[],g.label=3;case 3:return y=[],[a,o||[]].forEach((function(t){return t.forEach((function(t){(y=y.filter((function(e){return function(t,e){var n=cJ(t),r=cJ(e);if(!function(t,e){return!(t.xMax<e.xMin||e.xMax<t.xMin||t.yMax<e.yMin||e.yMax<t.yMin)}(n,r))return 0;var i=lJ(function(t,e){var n=Math.max(t.xMin,e.xMin),r=Math.min(t.xMax,e.xMax),i=Math.max(t.yMin,e.yMin),o=Math.min(t.yMax,e.yMax);return{xMin:n,xMax:r,yMin:i,yMax:o,width:Math.max(r-n,0),height:Math.max(o-i,0)}}(n,r)),o=lJ(n)+lJ(r)-i;return o>0?i/o:0}(t,e)<=.5}))).push(t)}))})),l=y,[4,Promise.all(l.map((function(t){return m.faceLandmark(t,i)})))];case 4:for(c=g.sent(),u=[],this.prevFaceRectsFromLandmarks=[],h=0;h<c.length;++h)null!=(d=c[h])&&(this.prevFaceRectsFromLandmarks.push(this.faceLandmarksToRoi(d,r)),null!=(p=_J(d,r))&&p.forEach((function(t,e){var n=CZ.get(e);null!=n&&(t.name=n)})),f=AZ(p),u.push({keypoints:p,box:f.locationData.relativeBoundingBox}));return i.dispose(),[2,u]}var y}))}))},t.prototype.dispose=function(){this.detector.dispose(),this.landmarkModel.dispose()},t.prototype.reset=function(){this.detector.reset(),this.prevFaceRectsFromLandmarks=null},t.prototype.faceDetectionFrontDetectionToRoi=function(t,e){return TJ(yJ(t,"boundingbox","normRect",e,{rotationVectorStartKeypointIndex:0,rotationVectorEndKeypointIndex:1,rotationVectorTargetAngleDegree:0}),e,AJ)},t.prototype.faceLandmark=function(t,e){return _Z(this,void 0,void 0,(function(){var n,r,i,o,a,s,l;return wZ(this,(function(c){switch(c.label){case 0:return n=fJ(e,kJ,t).imageTensor,r=["output_faceflag"].concat(this.withAttention?["output_mesh_identity","output_lips","Identity_6:0","Identity_1:0","Identity_2:0","Identity_5:0"]:["output_mesh"]),i=this.landmarkModel.execute(n,r),o=i[0],a=i.slice(1),[4,o.data()];case 1:return c.sent()[0]<.5?(oz(i),oz(n),[2,null]):this.withAttention?[4,this.tensorsToFaceLandmarksWithAttention(a)]:[3,3];case 2:return s=c.sent(),[3,5];case 3:return[4,this.tensorsToFaceLandmarks(a)];case 4:s=c.sent(),c.label=5;case 5:return l=function(t,e,n){void 0===n&&(n={ignoreRotation:!1});for(var r=[],i=0,o=t;i<o.length;i++){var a=o[i],s=a.x-.5,l=a.y-.5,c=n.ignoreRotation?0:e.rotation,u=Math.cos(c)*s-Math.sin(c)*l,h=Math.sin(c)*s+Math.cos(c)*l;u=u*e.width+e.xCenter,h=h*e.height+e.yCenter;var d=a.z*e.width,p=xZ({},a);p.x=u,p.y=h,p.z=d,r.push(p)}return r}(s,t),oz(i),oz(n),[2,l]}}))}))},t.prototype.tensorsToFaceLandmarks=function(t){return _Z(this,void 0,void 0,(function(){return wZ(this,(function(e){return[2,SJ(t[0],IJ)]}))}))},t.prototype.tensorsToFaceLandmarksWithAttention=function(t){return _Z(this,void 0,void 0,(function(){var e,n,r,i,o,a;return wZ(this,(function(s){switch(s.label){case 0:return[4,SJ(t[0],IJ)];case 1:return e=s.sent(),[4,SJ(t[1],RJ)];case 2:return n=s.sent(),[4,SJ(t[3],PJ)];case 3:return r=s.sent(),[4,SJ(t[5],PJ)];case 4:return i=s.sent(),[4,SJ(t[4],NJ)];case 5:return o=s.sent(),[4,SJ(t[2],NJ)];case 6:return a=s.sent(),[2,xJ([e,n,r,i,o,a],[OJ,DJ,LJ,FJ,UJ,BJ])]}}))}))},t.prototype.faceLandmarksToRoi=function(t,e){return TJ(yJ(AZ(t),"boundingbox","normRect",e,{rotationVectorStartKeypointIndex:33,rotationVectorEndKeypointIndex:263,rotationVectorTargetAngleDegree:0}),e,AJ)},t}();function jJ(t){return _Z(this,void 0,void 0,(function(){var e,n,r,i;return wZ(this,(function(o){switch(o.label){case 0:return e=function(t){if(null==t)return xZ({},MJ);var e=xZ({},t);return e.runtime="tfjs",null==e.maxFaces&&(e.maxFaces=MJ.maxFaces),null==e.refineLandmarks&&(e.refineLandmarks=MJ.refineLandmarks),null==e.landmarkModelUrl&&(e.landmarkModelUrl=e.refineLandmarks?"https://tfhub.dev/mediapipe/tfjs-model/face_landmarks_detection/attention_mesh/1":"https://tfhub.dev/mediapipe/tfjs-model/face_landmarks_detection/face_mesh/1"),e}(t),n="string"==typeof e.landmarkModelUrl&&e.landmarkModelUrl.indexOf("https://tfhub.dev")>-1,[4,bZ(e.landmarkModelUrl,{fromTFHub:n})];case 1:return r=o.sent(),[4,sJ(JZ.MediaPipeFaceDetector,{modelType:"short",maxFaces:e.maxFaces,detectorModelUrl:e.detectorModelUrl,runtime:e.runtime})];case 2:return i=o.sent(),[2,new zJ(i,r,e.maxFaces,e.refineLandmarks)]}}))}))}(EJ||(EJ={})).MediaPipeFaceMesh="MediaPipeFaceMesh";Object.freeze({__proto__:null,getKeypointIndexByContour:function(t){if(t===EJ.MediaPipeFaceMesh)return TZ;throw new Error("Model "+t+" is not supported.")},getAdjacentPairs:function(t){if(t===EJ.MediaPipeFaceMesh)return EZ;throw new Error("Model "+t+" is not supported.")}});const VJ={},WJ={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function GJ(t,e){if(!(t in VJ)||null!=e){const n=function(t,e){if(1!==t&&2!==t)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=null==e?function(t){if(FD().getBool("IS_SAFARI")||"undefined"===typeof OffscreenCanvas||2!==t){if("undefined"!==typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}return new OffscreenCanvas(300,150)}(t):e;n.addEventListener("webglcontextlost",(e=>{e.preventDefault(),delete VJ[t]}),!1),FD().getBool("SOFTWARE_WEBGL_ENABLED")&&(WJ.failIfMajorPerformanceCaveat=!1);if(1===t)return n.getContext("webgl",WJ)||n.getContext("experimental-webgl",WJ);return n.getContext("webgl2",WJ)}(t,e);if(null===n)return console.log("Could not get context for WebGL version",t),null;VJ[t]=n}const n=VJ[t];return null==n||n.isContextLost()?(delete VJ[t],GJ(t)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),VJ[t])}var HJ,qJ,XJ;function YJ(t,e){return[e,t]}function KJ(t){const e=cD(t);return dD(Math.ceil(e/4))}function ZJ(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function JJ(t,e){const n=t;let r,i,o,a,s,l,c,u,h,d;return 2===FD().getNumber("WEBGL_VERSION")?(r=n.R32F,i=n.R16F,o=n.RGBA16F,a=n.RGBA32F,s=n.RED,c=4,u=1,h=n.HALF_FLOAT,d=n.FLOAT,l=n.RGBA8):(r=t.RGBA,i=t.RGBA,o=t.RGBA,a=n.RGBA,s=t.RGBA,c=4,u=4,h=null!=e?e.HALF_FLOAT_OES:null,d=t.FLOAT,l=t.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:i,internalFormatPackedHalfFloat:o,internalFormatPackedFloat:a,textureFormatFloat:s,downloadTextureFormat:l,downloadUnpackNumChannels:c,defaultNumChannels:u,textureTypeHalfFloat:h,textureTypeFloat:d}}function QJ(t,e){const n=e();return FD().getBool("DEBUG")&&function(t){const e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+function(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code ".concat(e)}}(t,e))}(t),n}!function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"}(HJ||(HJ={})),function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"}(qJ||(qJ={})),function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(XJ||(XJ={}));function $J(t){return!!(FD().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===t||5.96e-8<Math.abs(t)&&Math.abs(t)<65504)}function tQ(t,e){return cQ(t,(()=>t.getExtension(e)),'Extension "'+e+'" not supported on this browser.')}const eQ=/ERROR: [0-9]+:([0-9]+):/g;function nQ(t,e){const n=eQ.exec(e);if(null==n)return console.log("Couldn't parse line number in error: ".concat(e)),void console.log(t);const r=+n[1],i=t.split("\n"),o=i.length.toString().length+2,a=i.map(((t,e)=>pD((e+1).toString(),o)+t));let s=0;for(let h=0;h<a.length;h++)s=Math.max(a[h].length,s);const l=a.slice(0,r-1),c=a.slice(r-1,r),u=a.slice(r);console.log(l.join("\n")),console.log(e.split("\n")[0]),console.log("%c ".concat(pD(c[0],s)),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(u.join("\n"))}function rQ(t,e){if(QJ(t,(()=>t.validateProgram(e))),!1===t.getProgramParameter(e,t.VALIDATE_STATUS))throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function iQ(t,e,n,r,i,o,a){const s=t.getAttribLocation(e,n);return-1!==s&&(QJ(t,(()=>t.bindBuffer(t.ARRAY_BUFFER,r))),QJ(t,(()=>t.vertexAttribPointer(s,i,t.FLOAT,!1,o,a))),QJ(t,(()=>t.enableVertexAttribArray(s))),!0)}function oQ(t,e,n,r){QJ(t,(()=>function(t,e,n){uQ(t,n),QJ(t,(()=>t.activeTexture(t.TEXTURE0+n))),QJ(t,(()=>t.bindTexture(t.TEXTURE_2D,e)))}(t,e,r))),QJ(t,(()=>t.uniform1i(n,r)))}function aQ(t,e,n){QJ(t,(()=>t.bindFramebuffer(t.FRAMEBUFFER,n))),QJ(t,(()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0)))}function sQ(t,e){QJ(t,(()=>t.bindFramebuffer(t.FRAMEBUFFER,e))),QJ(t,(()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0)))}function lQ(t){const e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+function(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error ".concat(e)}}(t,e))}function cQ(t,e,n){const r=QJ(t,(()=>e()));if(null==r)throw new Error(n);return r}function uQ(t,e){const n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+t.TEXTURE0;if(r<t.TEXTURE0||r>n){const t="[gl.TEXTURE0, gl.TEXTURE".concat(n,"]");throw new Error("textureUnit must be in ".concat(t,"."))}}function hQ(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return cD(t.slice(0,t.length-e))}function dQ(t){if(0===t.length)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function pQ(t){let e=[1,1,1];return 0===t.length||1===t.length&&1===t[0]||(e=[hQ(t),...dQ(t)]),e}function fQ(t){return t%2===0}function mQ(t,e){if(uD(t=t.slice(-2),e=e.slice(-2)))return!0;if(!t.length||!e.length)return!0;if(0===t[0]||0===t[1]||0===e[0]||0===e[1])return!0;if(t.length!==e.length){const n=t[t.length-1],r=e[e.length-1];if(n===r)return!0;if(fQ(n)&&fQ(r)&&(1===t[0]||1===e[0]))return!0}return t[1]===e[1]&&fQ(t[0])&&fQ(e[0])}let gQ,yQ;function vQ(t,e){return null!=t.getExtension(e)}function bQ(t){try{if(null!=GJ(t))return!0}catch($7){return console.log("Error when getting WebGL context: ",$7),!1}return!1}function xQ(t){if(0===t)return!1;const e=GJ(t);if(1!==t){if(vQ(e,"EXT_color_buffer_float"))return _Q(e);const t="EXT_color_buffer_half_float";if(vQ(e,t)){const n=e.getExtension(t);return function(t,e){const n=JJ(t,e),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r);const i=1,o=1;t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,i,o,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const a=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,a),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);const s=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(r),t.deleteFramebuffer(a),s}(e,n)}return!1}if(!vQ(e,"OES_texture_float"))return!1;if(!vQ(e,"WEBGL_color_buffer_float"))return!1;return _Q(e)}function _Q(t){const e=JJ(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n);t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const r=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);const i=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(r),i}function wQ(t,e){Array.isArray(t)||(t=[t]),t.forEach((t=>{null!=t&&aD("complex64"!==t.dtype,(()=>"".concat(e," does not support complex64 tensors ")+"in the WebGL backend."))}))}const SQ=FD();function TQ(){let t,e,n,r,i,o,a,s,l,c;return 2===FD().getNumber("WEBGL_VERSION")?(t="#version 300 es",e="in",n="out",r="in",i="texture",o="outputColor",a="out vec4 outputColor;",s=FD().getBool("WEBGL2_ISNAN_CUSTOM")?"\n      bool isnan_custom(float val) {\n        uint floatToUint = floatBitsToUint(val);\n        return (floatToUint & 0x7fffffffu) > 0x7f800000u;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ":"",l="",c="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(t="",e="attribute",n="varying",r="varying",i="texture2D",o="gl_FragColor",a="",s="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",l="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",c="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:t,attribute:e,varyingVs:n,varyingFs:r,texture2D:i,output:o,defineOutput:a,defineSpecialNaN:s,defineSpecialInf:l,defineRound:c}}function EQ(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index";const r=ED(e);return r.map(((e,i)=>{const o="int ".concat(t[i]," = ").concat(n," / ").concat(e),a=i===r.length-1?"int ".concat(t[i+1]," = ").concat(n," - ").concat(t[i]," * ").concat(e):"index -= ".concat(t[i]," * ").concat(e);return"".concat(o,"; ").concat(a,";")})).join("")}function MQ(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index";const r=ED(e);return r.map(((e,i)=>{const o="int ".concat(t[i]," = ").concat(n," / outShapeStrides[").concat(i,"]"),a=i===r.length-1?"int ".concat(t[i+1]," = ").concat(n," - ").concat(t[i]," * outShapeStrides[").concat(i,"]"):"index -= ".concat(t[i]," * outShapeStrides[").concat(i,"]");return"".concat(o,"; ").concat(a,";")})).join("")}function CQ(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index";const r=t.map(((t,e)=>e)),i=function(t,e){const n=t.length,r=t.map((t=>"".concat(e,"[").concat(t,"]"))),i=new Array(n-1);i[n-2]=r[n-1];for(let o=n-3;o>=0;--o)i[o]="(".concat(i[o+1]," * ").concat(r[o+1],")");return i}(r,e);return i.map(((e,r)=>{const o="int ".concat(t[r]," = ").concat(n," / ").concat(i[r]),a=r===i.length-1?"int ".concat(t[r+1]," = ").concat(n," - ").concat(t[r]," * ").concat(i[r]):"index -= ".concat(t[r]," * ").concat(i[r]);return"".concat(o,"; ").concat(a,";")})).join("")}function AQ(t){const e=ED(t).map((t=>t.toString()));return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ".concat(e[0]," + coords.y * ").concat(e[1]," + coords.z;\n  }\n")}SQ.registerFlag("HAS_WEBGL",(()=>SQ.getNumber("WEBGL_VERSION")>0)),SQ.registerFlag("WEBGL_VERSION",(()=>bQ(2)?2:bQ(1)?1:0)),SQ.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",(()=>!1)),SQ.registerFlag("WEBGL_BUFFER_SUPPORTED",(()=>2===SQ.get("WEBGL_VERSION"))),SQ.registerFlag("WEBGL_CPU_FORWARD",(()=>!0)),SQ.registerFlag("WEBGL_FORCE_F16_TEXTURES",(()=>!1)),SQ.registerFlag("WEBGL_PACK",(()=>SQ.getBool("HAS_WEBGL"))),SQ.registerFlag("WEBGL_PACK_NORMALIZATION",(()=>SQ.getBool("WEBGL_PACK"))),SQ.registerFlag("WEBGL_PACK_CLIP",(()=>SQ.getBool("WEBGL_PACK"))),SQ.registerFlag("WEBGL_PACK_DEPTHWISECONV",(()=>SQ.getBool("WEBGL_PACK"))),SQ.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(()=>SQ.getBool("WEBGL_PACK"))),SQ.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(()=>SQ.getBool("WEBGL_PACK"))),SQ.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(()=>SQ.getBool("WEBGL_PACK"))),SQ.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(()=>SQ.getBool("WEBGL_PACK"))),SQ.registerFlag("WEBGL_PACK_REDUCE",(()=>SQ.getBool("WEBGL_PACK"))),SQ.registerFlag("WEBGL_LAZILY_UNPACK",(()=>SQ.getBool("WEBGL_PACK"))),SQ.registerFlag("WEBGL_CONV_IM2COL",(()=>SQ.getBool("WEBGL_PACK"))),SQ.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",(()=>SQ.getBool("WEBGL_PACK"))),SQ.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(()=>function(t){if(null==gQ){const e=GJ(t);gQ=e.getParameter(e.MAX_TEXTURE_SIZE)}return gQ}(SQ.getNumber("WEBGL_VERSION")))),SQ.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(()=>function(t){if(null==yQ){const e=GJ(t);yQ=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,yQ)}(SQ.getNumber("WEBGL_VERSION")))),SQ.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(()=>{const t=SQ.getNumber("WEBGL_VERSION");return 0===t?0:function(t){if(0===t)return 0;let e;const n=GJ(t);return e=vQ(n,"EXT_disjoint_timer_query_webgl2")&&2===t?2:vQ(n,"EXT_disjoint_timer_query")?1:0,e}(t)})),SQ.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(()=>SQ.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!VB())),SQ.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(()=>function(t){if(0===t)return!1;const e=GJ(t);if(1===t){if(!vQ(e,"OES_texture_float"))return!1}else if(!vQ(e,"EXT_color_buffer_float"))return!1;return _Q(e)}(SQ.getNumber("WEBGL_VERSION")))),SQ.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(()=>!SQ.getBool("WEBGL_FORCE_F16_TEXTURES")&&SQ.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))),SQ.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(()=>xQ(SQ.getNumber("WEBGL_VERSION")))),SQ.registerFlag("WEBGL_FENCE_API_ENABLED",(()=>{return 2===(t=SQ.getNumber("WEBGL_VERSION"))&&null!=GJ(t).fenceSync;var t})),SQ.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(()=>SQ.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0)),SQ.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",(()=>-1),(t=>{if("number"!==typeof t)throw new Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but "+"got ".concat(t,"."));if(t<0&&-1!==t)throw new Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never "+"delete) or at least 0, but got ".concat(t,"."))})),SQ.registerFlag("WEBGL_FLUSH_THRESHOLD",(()=>VB()?1:-1),(t=>{if("number"!==typeof t)throw new Error("WEBGL_FLUSH_THRESHOLD must be a number but got "+"".concat(t,"."));if(t<0&&-1!==t)throw new Error("WEBGL_FLUSH_THRESHOLD must be -1 (indicating never "+"manual flush) or at least 0, but got ".concat(t,"."))})),SQ.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",(()=>128)),SQ.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",(()=>!1)),SQ.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",(()=>1e5)),SQ.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",(()=>128)),SQ.registerFlag("WEBGL_EXP_CONV",(()=>!1)),SQ.registerFlag("SOFTWARE_WEBGL_ENABLED",(()=>SQ.getBool("IS_TEST"))),SQ.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",(()=>1/0)),SQ.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",(()=>!1)),SQ.registerFlag("WEBGL2_ISNAN_CUSTOM",(()=>!1)),SQ.registerFlag("ENGINE_COMPILE_ONLY",(()=>!1));const kQ="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n",{getBroadcastDims:IQ}=a;function RQ(t,e,n){const r=[];if(t.forEach((t=>{const e=cD(t.shapeInfo.logicalShape);if(t.shapeInfo.isUniform?r.push("uniform float ".concat(t.name).concat(e>1?"[".concat(e,"]"):"",";")):(r.push("uniform sampler2D ".concat(t.name,";")),r.push("uniform int offset".concat(t.name,";"))),n.enableShapeUniforms){const{uniformShape:e}=jQ(n.packedInputs,t.shapeInfo.logicalShape,t.shapeInfo.texShape);switch(e.length){case 1:r.push("uniform int ".concat(t.name,"Shape;"));break;case 2:r.push("uniform ivec2 ".concat(t.name,"Shape;"));break;case 3:r.push("uniform ivec3 ".concat(t.name,"Shape;"));break;case 4:r.push("uniform ivec4 ".concat(t.name,"Shape;"))}r.push("uniform ivec2 ".concat(t.name,"TexShape;"))}})),n.enableShapeUniforms){switch(e.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;")}r.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach((t=>{r.push("uniform ".concat(t.type," ").concat(t.name).concat(t.arrayIndex?"[".concat(t.arrayIndex,"]"):"",";"))}));const i=r.join("\n"),o=t.map((t=>function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0,i="";i+=n?NQ(t,r):PQ(t,r);const o=t.shapeInfo.logicalShape,a=e.logicalShape;o.length<=a.length&&(i+=n?function(t,e){const n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),i="get"+r+"AtOutCoords",o=t.shapeInfo.logicalShape.length,a=e.logicalShape.length,s=IQ(t.shapeInfo.logicalShape,e.logicalShape),l=zQ(a),c=a-o;let u;const h=["x","y","z","w","u","v"];u=0===o?"":a<2&&s.length>=1?"coords = 0;":s.map((t=>"coords.".concat(h[t+c]," = 0;"))).join("\n");let d="";d=a<2&&o>0?"coords":t.shapeInfo.logicalShape.map(((t,e)=>"coords.".concat(h[e+c]))).join(", ");let p="return outputValue;";const f=1===cD(t.shapeInfo.logicalShape),m=cD(e.logicalShape),g=1===m;if(1!==o||f||g){if(f&&!g)p=1===a?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(s.length){const t=o-2,e=o-1;s.indexOf(t)>-1&&s.indexOf(e)>-1?p="return vec4(outputValue.x);":s.indexOf(t)>-1?p="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":s.indexOf(e)>-1&&(p="return vec4(outputValue.xx, outputValue.zz);")}}else p="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 ".concat(i,"() {\n      ").concat(l," coords = getOutputCoords();\n      ").concat(u,"\n      vec4 outputValue = get").concat(r,"(").concat(d,");\n      ").concat(p,"\n    }\n  ")}(t,e):function(t,e){const n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),i="get"+r+"AtOutCoords",o=e.texShape,a=t.shapeInfo.texShape,s=t.shapeInfo.logicalShape.length,l=e.logicalShape.length;if(!t.shapeInfo.isUniform&&s===l&&null==t.shapeInfo.flatOffset&&uD(a,o))return"\n      float ".concat(i,"() {\n        return sampleTexture(").concat(n,", resultUV);\n      }\n    ");const c=zQ(l),u=IQ(t.shapeInfo.logicalShape,e.logicalShape),h=l-s;let d;const p=["x","y","z","w","u","v"];d=0===s?"":l<2&&u.length>=1?"coords = 0;":u.map((t=>"coords.".concat(p[t+h]," = 0;"))).join("\n");let f="";f=l<2&&s>0?"coords":t.shapeInfo.logicalShape.map(((t,e)=>"coords.".concat(p[e+h]))).join(", ");return"\n    float ".concat(i,"() {\n      ").concat(c," coords = getOutputCoords();\n      ").concat(d,"\n      return get").concat(r,"(").concat(f,");\n    }\n  ")}(t,e));return i}(t,e,n.packedInputs,n.enableShapeUniforms))).join("\n"),a=e.texShape,s=TQ(),l=function(t){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ".concat(t.texture2D,"(textureSampler, uv).r;\n    }\n  ")}(s);let c,u,h=function(t){const e="".concat(t.version,"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ").concat(t.varyingFs," vec2 resultUV;\n    ").concat(t.defineOutput,"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ").concat(t.defineSpecialNaN,"\n    ").concat(t.defineSpecialInf,"\n    ").concat(t.defineRound,"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ").concat(OQ,"\n    ").concat(DQ,"\n    ").concat(LQ,"\n  ");return e}(s);e.isPacked?(c=function(t,e,n){switch(t.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(t,e,n){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(1===r[0])return n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));\n      }\n    ":"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ".concat(r[1],".0);\n      }\n    ");if(1===r[1])return n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));\n      }\n    ":"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ".concat(r[0],".0);\n      }\n    ");if(n)return"\n    int getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);\n    }\n  ";return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n      return 2 * (resTexRC.x * ").concat(r[1]," + resTexRC.y);\n    }\n  ")}(0,e,n);case 2:return function(t,e,n){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(uD(t,e))return n?"\n      ivec2 getOutputCoords() {\n        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(".concat(r[0],", ").concat(r[1],"));\n      }\n    ");const i=Math.ceil(t[1]/2);if(n)return"\n    ivec2 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec2(r, c);\n    }\n  ";return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n\n      int index = resTexRC.x * ").concat(r[1]," + resTexRC.y;\n      int r = 2 * (index / ").concat(i,");\n      int c = imod(index, ").concat(i,") * 2;\n\n      return ivec2(r, c);\n    }\n  ")}(t,e,n);case 3:return function(t,e,n){if(n)return"\n    ivec3 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],i=Math.ceil(t[2]/2),o=i*Math.ceil(t[1]/2);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n      int index = resTexRC.x * ").concat(r[1]," + resTexRC.y;\n\n      int b = index / ").concat(o,";\n      index -= b * ").concat(o,";\n\n      int r = 2 * (index / ").concat(i,");\n      int c = imod(index, ").concat(i,") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ")}(t,e,n);default:return function(t,e,n){if(n)return"\n    ivec4 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatchN = texelsInBatch * outShape[1];\n\n      int b2 = index / texelsInBatchN;\n      index -= b2 * texelsInBatchN;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec4(b2, b, r, c);\n    }\n  ";const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],i=Math.ceil(t[t.length-1]/2),o=i*Math.ceil(t[t.length-2]/2);let a=o,s="",l="b, r, c";for(let c=2;c<t.length-1;c++)a*=t[t.length-c-1],s="\n      int b".concat(c," = index / ").concat(a,";\n      index -= b").concat(c," * ").concat(a,";\n    ")+s,l="b".concat(c,", ")+l;return"\n    ivec".concat(t.length," getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(").concat(r[0],", ").concat(r[1],"));\n      int index = resTexRC.x * ").concat(r[1]," + resTexRC.y;\n\n      ").concat(s,"\n\n      int b = index / ").concat(o,";\n      index -= b * ").concat(o,";\n\n      int r = 2 * (index / ").concat(i,");\n      int c = imod(index, ").concat(i,") * 2;\n\n      return ivec").concat(t.length,"(").concat(l,");\n    }\n  ")}(t,e,n)}}(e.logicalShape,a,n.enableShapeUniforms),u=function(t){return"\n    void setOutput(vec4 val) {\n      ".concat(t.output," = val;\n    }\n  ")}(s)):(c=function(t,e,n){switch(t.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(t,e,n){if(1===e[0])return n?"\n      int getOutputCoords() {\n        return int(resultUV.x * float(outTexShape[1]));\n      }\n    ":"\n      int getOutputCoords() {\n        return int(resultUV.x * ".concat(e[1],".0);\n      }\n    ");if(1===e[1])return n?"\n      int getOutputCoords() {\n        return int(resultUV.y * float(outTexShape[0]));\n      }\n    ":"\n      int getOutputCoords() {\n        return int(resultUV.y * ".concat(e[0],".0);\n      }\n    ");if(n)return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      return resTexRC.x * outTexShape[1] + resTexRC.y;\n    }\n  ";return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(e[0],", ").concat(e[1],"));\n      return resTexRC.x * ").concat(e[1]," + resTexRC.y;\n    }\n  ")}(0,e,n);case 2:return function(t,e,n){if(uD(t,e))return n?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(".concat(e[0],", ").concat(e[1],"));\n      }\n    ");if(1===t[1])return n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(e[0],", ").concat(e[1],"));\n        int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ");if(1===t[0])return n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(e[0],", ").concat(e[1],"));\n        int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ");if(n)return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      int r = index / outShape[1];\n      int c = index - r * outShape[1];\n      return ivec2(r, c);\n    }\n  ";return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(e[0],", ").concat(e[1],"));\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n      int r = index / ").concat(t[1],";\n      int c = index - r * ").concat(t[1],";\n      return ivec2(r, c);\n    }\n  ")}(t,e,n);case 3:return function(t,e,n){if(n){const e=MQ(["r","c","d"],t);return"\n  ivec3 getOutputCoords() {\n    ivec2 resTexRC = ivec2(resultUV.yx *\n                           vec2(outTexShape[0], outTexShape[1]));\n    int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n    ".concat(e,"\n    return ivec3(r, c, d);\n  }\n")}const r=EQ(["r","c","d"],t);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(e[0],", ").concat(e[1],"));\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n      ").concat(r,"\n      return ivec3(r, c, d);\n    }\n  ")}(t,e,n);case 4:return function(t,e,n){if(n){const e=MQ(["r","c","d","d2"],t);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      ".concat(e,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}const r=EQ(["r","c","d","d2"],t);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(e[0],", ").concat(e[1],"));\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n      ").concat(r,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}(t,e,n);case 5:return function(t,e){const n=EQ(["r","c","d","d2","d3"],t);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(".concat(e[0],",\n                             ").concat(e[1],"));\n\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  ")}(t,e);case 6:return function(t,e){const n=EQ(["r","c","d","d2","d3","d4"],t);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(e[0],", ").concat(e[1],"));\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  ")}(t,e);default:throw new Error("".concat(t.length,"-D output sampling is not yet supported"))}}(e.logicalShape,a,n.enableShapeUniforms),u=function(t){return"\n    void setOutput(float val) {\n      ".concat(t.output," = vec4(val, 0, 0, 0);\n    }\n  ")}(s)),n.packedInputs&&(h+=FQ);return[h,l,u,i,c,o,n.userCode].join("\n")}function PQ(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=t.shapeInfo.logicalShape;switch(n.length){case 0:return function(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return"float ".concat(r,"() {return ").concat(n,";}");const[i,o]=t.shapeInfo.texShape;if(1===i&&1===o)return"\n      float ".concat(r,"() {\n        return sampleTexture(").concat(n,", halfCR);\n      }\n    ");const a=UQ(n);if(e)return"\n    float ".concat(r,"() {\n      vec2 uv = uvFromFlat(").concat(n,"TexShape[0], ").concat(n,"TexShape[1], ").concat(a,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");const[s,l]=t.shapeInfo.texShape;return"\n    float ".concat(r,"() {\n      vec2 uv = uvFromFlat(").concat(s,", ").concat(l,", ").concat(a,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(t,e);case 1:return function(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return"\n      float ".concat(r,"(int index) {\n        ").concat(BQ(t),"\n      }\n    ");const i=t.shapeInfo.texShape,o=i[0],a=i[1];if(1===a&&1===o)return"\n      float ".concat(r,"(int index) {\n        return sampleTexture(").concat(n,", halfCR);\n      }\n    ");const s=UQ(n);if(1===a)return e?"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(s,") + 0.5) / float(").concat(n,"TexShape[0]));\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(s,") + 0.5) / ").concat(o,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(1===o)return e?"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(s,") + 0.5) / float(").concat(n,"TexShape[1]), 0.5);\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(s,") + 0.5) / ").concat(a,".0, 0.5);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(e)return"\n    float ".concat(r,"(int index) {\n      vec2 uv = uvFromFlat(").concat(n,"TexShape[0], ").concat(n,"TexShape[1], index + ").concat(s,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");return"\n    float ".concat(r,"(int index) {\n      vec2 uv = uvFromFlat(").concat(o,", ").concat(a,", index + ").concat(s,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(t,e);case 2:return function(t,e){const n=t.shapeInfo.logicalShape,r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=t.shapeInfo.texShape;if(null!=o&&uD(n,o)){if(e)return"\n      float ".concat(i,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");const t=o[0],n=o[1];return"\n    float ".concat(i,"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(n,".0, ").concat(t,".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ")}const{newShape:a,keptDims:s}=gD(n),l=a;if(l.length<n.length){const n=VQ(t,l),r=["row","col"];return"\n      ".concat(PQ(n,e),"\n      float ").concat(i,"(int row, int col) {\n        return ").concat(i,"(").concat(WQ(r,s),");\n      }\n    ")}if(t.shapeInfo.isUniform)return"\n      float ".concat(i,"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(").concat(n[1],", 1)));\n        ").concat(BQ(t),"\n      }\n    ");const c=o[0],u=o[1],h=UQ(r);if(1===u)return e?"\n      float ".concat(i,"(int row, int col) {\n        float index = dot(vec3(row, col, ").concat(h,"), vec3(").concat(r,"Shape[1], 1, 1));\n        vec2 uv = vec2(0.5, (index + 0.5) / float(").concat(r,"TexShape[0]));\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(i,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(h,"), vec3(").concat(n[1],", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ").concat(c,".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ");if(1===c)return e?"\n      float ".concat(i,"(int row, int col) {\n        float index = dot(vec3(row, col, ").concat(h,"), vec3(").concat(r,"Shape[1], 1, 1));\n        vec2 uv = vec2((index + 0.5) / float(").concat(r,"TexShape[1]), 0.5);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(i,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(h,"), vec3(").concat(n[1],", 1, 1));\n      vec2 uv = vec2((index + 0.5) / ").concat(u,".0, 0.5);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ");if(e)return"\n      float ".concat(i,"(int row, int col) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(r,"Shape[1] + col + ").concat(h,";\n        vec2 uv = uvFromFlat(").concat(r,"TexShape[0], ").concat(r,"TexShape[1], index);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");return"\n  float ".concat(i,"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ").concat(n[1]," + col + ").concat(h,";\n    vec2 uv = uvFromFlat(").concat(c,", ").concat(u,", index);\n    return sampleTexture(").concat(r,", uv);\n  }\n")}(t,e);case 3:return function(t,e){const n=t.shapeInfo.logicalShape,r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=n[1]*n[2],a=n[2],{newShape:s,keptDims:l}=gD(n),c=s;if(c.length<n.length){const n=VQ(t,c),r=["row","col","depth"];return"\n        ".concat(PQ(n,e),"\n        float ").concat(i,"(int row, int col, int depth) {\n          return ").concat(i,"(").concat(WQ(r,l),");\n        }\n      ")}if(t.shapeInfo.isUniform)return"\n      float ".concat(i,"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(").concat(o,", ").concat(a,", 1)));\n        ").concat(BQ(t),"\n      }\n    ");const u=t.shapeInfo.texShape,h=u[0],d=u[1],p=t.shapeInfo.flatOffset;if(d===o&&null==p)return e?"\n      float ".concat(i,"(int row, int col, int depth) {\n        int stride1 = ").concat(r,"Shape[2];\n        float texR = float(row);\n        float texC = dot(vec2(col, depth), vec2(stride1, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n        float ".concat(i,"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(").concat(a,", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(").concat(d,".0, ").concat(h,".0);\n          return sampleTexture(").concat(r,", uv);\n        }\n      ");if(d===a&&null==p)return e?"\n      float ".concat(i,"(int row, int col, int depth) {\n        float texR = dot(vec2(row, col), vec2(").concat(r,"Shape[1], 1));\n        float texC = float(depth);\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(i,"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(").concat(n[1],", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(d,".0, ").concat(h,".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ");const f=UQ(r);if(e)return"\n    float ".concat(i,"(int row, int col, int depth) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int stride0 = ").concat(r,"Shape[1] * ").concat(r,"Shape[2];\n      int stride1 = ").concat(r,"Shape[2];\n      int index = row * stride0 + col * stride1 + depth + ").concat(f,";\n      vec2 uv = uvFromFlat(").concat(r,"TexShape[0], ").concat(r,"TexShape[1], index);\n      return sampleTexture(").concat(r,", uv);\n    }\n    ");return"\n      float ".concat(i,"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(o," + col * ").concat(a," + depth + ").concat(f,";\n        vec2 uv = uvFromFlat(").concat(h,", ").concat(d,", index);\n        return sampleTexture(").concat(r,", uv);\n      }\n  ")}(t,e);case 4:return function(t,e){const n=t.shapeInfo.logicalShape,r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=n[3],a=n[2]*o,s=n[1]*a,{newShape:l,keptDims:c}=gD(n);if(l.length<n.length){const n=VQ(t,l),r=["row","col","depth","depth2"];return"\n      ".concat(PQ(n,e),"\n      float ").concat(i,"(int row, int col, int depth, int depth2) {\n        return ").concat(i,"(").concat(WQ(r,c),");\n      }\n    ")}if(t.shapeInfo.isUniform)return"\n      float ".concat(i,"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(").concat(s,", ").concat(a,", ").concat(o,", 1)));\n        ").concat(BQ(t),"\n      }\n    ");const u=t.shapeInfo.flatOffset,h=t.shapeInfo.texShape,d=h[0],p=h[1],f="int stride2 = ".concat(r,"Shape[3];"),m="int stride1 = ".concat(r,"Shape[2] * stride2;"),g="int stride0 = ".concat(r,"Shape[1] * stride1;");if(p===s&&null==u)return e?"\n      float ".concat(i,"(int row, int col, int depth, int depth2) {\n        ").concat(f,"\n        ").concat(m,"\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(stride1, stride2, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n      float ".concat(i,"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(").concat(a,", ").concat(o,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(p,".0, ").concat(d,".0);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");if(p===o&&null==u)return e?"\n      float ".concat(i,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(r,"Shape[1] * ").concat(r,"Shape[2], ").concat(r,"Shape[2], 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n      float ".concat(i,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(n[1]*n[2],", ").concat(n[2],", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(p,".0, ").concat(d,".0);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");const y=UQ(r);if(e)return"\n    float ".concat(i,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      ").concat(f,"\n      ").concat(m,"\n      ").concat(g,"\n      int index = row * stride0 + col * stride1 +\n          depth * stride2 + depth2;\n      vec2 uv = uvFromFlat(").concat(r,"TexShape[0], ").concat(r,"TexShape[1], index + ").concat(y,");\n      return sampleTexture(").concat(r,", uv);\n    }\n  ");return"\n    float ".concat(i,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(s," + col * ").concat(a," +\n          depth * ").concat(o," + depth2;\n      vec2 uv = uvFromFlat(").concat(d,", ").concat(p,", index + ").concat(y,");\n      return sampleTexture(").concat(r,", uv);\n    }\n  ")}(t,e);case 5:return function(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=e[4],o=e[3]*i,a=e[2]*o,s=e[1]*a,{newShape:l,keptDims:c}=gD(e);if(l.length<e.length){const e=VQ(t,l),n=["row","col","depth","depth2","depth3"];return"\n      ".concat(PQ(e),"\n      float ").concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        return ").concat(r,"(").concat(WQ(n,c),");\n      }\n    ")}if(t.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(s,", ").concat(a,", ").concat(o,", ").concat(i,")) +\n          depth3;\n        ").concat(BQ(t),"\n      }\n    ");const u=t.shapeInfo.flatOffset,h=t.shapeInfo.texShape,d=h[0],p=h[1];if(p===s&&null==u)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(").concat(a,", ").concat(o,", ").concat(i,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(p,".0, ").concat(d,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(p===i&&null==u)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(e[1]*e[2]*e[3],",\n               ").concat(e[2]*e[3],", ").concat(e[3],", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(p,".0, ").concat(d,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");const f=UQ(n);return"\n    float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(s," + col * ").concat(a," + depth * ").concat(o," +\n          depth2 * ").concat(i," + depth3 + ").concat(f,";\n      vec2 uv = uvFromFlat(").concat(d,", ").concat(p,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(t);case 6:return function(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:i,keptDims:o}=gD(e);if(i.length<e.length){const e=VQ(t,i),n=["row","col","depth","depth2","depth3","depth4"];return"\n      ".concat(PQ(e),"\n      float ").concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ").concat(r,"(").concat(WQ(n,o),");\n      }\n    ")}const a=e[5],s=e[4]*a,l=e[3]*s,c=e[2]*l,u=e[1]*c;if(t.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(u,", ").concat(c,", ").concat(l,", ").concat(s,")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(").concat(a,", 1)));\n        ").concat(BQ(t),"\n      }\n    ");const h=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,p=d[0],f=d[1];if(f===u&&null==h)return"\n      float ".concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(").concat(c,", ").concat(l,", ").concat(s,", ").concat(a,")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(f,".0, ").concat(p,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(f===a&&null==h)return"\n      float ".concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(").concat(e[1]*e[2]*e[3]*e[4],",\n               ").concat(e[2]*e[3]*e[4],",\n               ").concat(e[3]*e[4],",\n               ").concat(e[4],")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(f,".0, ").concat(p,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");const m=UQ(n);return"\n    float ".concat(r,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(u," + col * ").concat(c," + depth * ").concat(l," +\n          depth2 * ").concat(s," + depth3 * ").concat(a," + depth4 + ").concat(m,";\n      vec2 uv = uvFromFlat(").concat(p,", ").concat(f,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(t);default:throw new Error("".concat(n.length,"-D input sampling")+" is not yet supported")}}function NQ(t,e){switch(t.shapeInfo.logicalShape.length){case 0:return function(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=TQ();return"\n    vec4 ".concat(n,"() {\n      return ").concat(r.texture2D,"(").concat(e,", halfCR);\n    }\n  ")}(t);case 1:return function(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=t.shapeInfo.texShape,o=TQ();if(e)return"\n    vec4 ".concat(r,"(int index) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(n,"TexShape[0]) / 2.0), ceil(float(").concat(n,"TexShape[1]) / 2.0));\n      vec2 uv = packedUVfrom1D(\n        packedTexShape[0], packedTexShape[1], index);\n      return ").concat(o.texture2D,"(").concat(n,", uv);\n    }\n  ");const a=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];return"\n    vec4 ".concat(r,"(int index) {\n      vec2 uv = packedUVfrom1D(\n        ").concat(a[0],", ").concat(a[1],", index);\n      return ").concat(o.texture2D,"(").concat(n,", uv);\n    }\n  ")}(t,e);case 2:return function(t,e){const n=t.shapeInfo.logicalShape,r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=t.shapeInfo.texShape,a=o[0],s=o[1],l=TQ();if(null!=o&&uD(n,o))return e?"\n      vec4 ".concat(i,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n\n        return ").concat(l.texture2D,"(").concat(r,", uv);\n      }\n    "):"\n      vec4 ".concat(i,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(s,".0, ").concat(a,".0);\n\n        return ").concat(l.texture2D,"(").concat(r,", uv);\n      }\n    ");if(e)return"\n    vec4 ".concat(i,"(int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(r,"TexShape[0]) / 2.0), ceil(float(").concat(r,"TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(").concat(r,"Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);\n      return ").concat(l.texture2D,"(").concat(r,", uv);\n    }\n  ");const c=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],u=Math.ceil(n[1]/2);return"\n    vec4 ".concat(i,"(int row, int col) {\n      vec2 uv = packedUVfrom2D(").concat(u,", ").concat(c[0],", ").concat(c[1],", row, col);\n      return ").concat(l.texture2D,"(").concat(r,", uv);\n    }\n  ")}(t,e);case 3:return function(t,e){const n=t.shapeInfo.logicalShape,r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=t.shapeInfo.texShape,a=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];if(1===n[0]){const r=[1,2],o=VQ(t,n.slice(1)),a=["b","row","col"];return"\n        ".concat(NQ(o,e),"\n        vec4 ").concat(i,"(int b, int row, int col) {\n          return ").concat(i,"(").concat(WQ(a,r),");\n        }\n      ")}const s=TQ();if(e)return"\n    vec4 ".concat(i,"(int b, int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(r,"TexShape[0]) / 2.0), ceil(float(").concat(r,"TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(").concat(r,"Shape[2]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(").concat(r,"Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom3D(\n        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);\n      return ").concat(s.texture2D,"(").concat(r,", uv);\n    }\n  ");const l=a[0],c=a[1],u=Math.ceil(n[2]/2),h=u*Math.ceil(n[1]/2);return"\n    vec4 ".concat(i,"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ").concat(l,", ").concat(c,", ").concat(h,", ").concat(u,", b, row, col);\n      return ").concat(s.texture2D,"(").concat(r,", uv);\n    }\n  ")}(t,e);default:return function(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=TQ();if(e)return"\n    vec4 ".concat(r,"(int b2, int b, int row, int col) {\n      int valuesPerRow = int(ceil(float(").concat(n,"Shape[3]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(").concat(n,"Shape[2]) / 2.0));\n      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);\n      texelsInBatch *= ").concat(n,"Shape[1];\n      index = b2 * texelsInBatch + index;\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(n,"TexShape[0]) / 2.0), ceil(float(").concat(n,"TexShape[1]) / 2.0));\n      int texR = index / packedTexShape[1];\n      int texC = index - texR * packedTexShape[1];\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ").concat(i.texture2D,"(").concat(n,", uv);\n    }\n  ");const o=t.shapeInfo.logicalShape,a=o.length,s=t.shapeInfo.texShape,l=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],c=l[0],u=l[1],h=Math.ceil(o[a-1]/2);let d=h*Math.ceil(o[a-2]/2),p="int b, int row, int col",f="b * ".concat(d," + (row / 2) * ").concat(h," + (col / 2)");for(let m=2;m<a-1;m++)p="int b".concat(m,", ")+p,d*=o[a-m-1],f="b".concat(m," * ").concat(d," + ")+f;return"\n    vec4 ".concat(r,"(").concat(p,") {\n      int index = ").concat(f,";\n      int texR = index / ").concat(u,";\n      int texC = index - texR * ").concat(u,";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(u,", ").concat(c,");\n      return ").concat(i.texture2D,"(").concat(n,", uv);\n    }\n  ")}(t,e)}}const OQ="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",DQ="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",LQ="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",FQ="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function UQ(t){return"offset".concat(t)}function BQ(t){const e=t.name,n=cD(t.shapeInfo.logicalShape);return n<2?"return ".concat(e,";"):"\n    for (int i = 0; i < ".concat(n,"; i++) {\n      if (i == index) {\n        return ").concat(e,"[i];\n      }\n    }\n  ")}function zQ(t){if(t<=1)return"int";if(2===t)return"ivec2";if(3===t)return"ivec3";if(4===t)return"ivec4";if(5===t)return"ivec5";if(6===t)return"ivec6";throw Error("GPU for rank ".concat(t," is not yet supported"))}function jQ(t,e,n){const{newShape:r,keptDims:i}=gD(e),o=e.length,a=t&&3===o&&1===e[0],s=a?e.slice(1):r,l=!t&&o>1&&!uD(e,n)&&r.length<o||a;return{useSqueezeShape:l,uniformShape:l?s:e,keptDims:i}}function VQ(t,e){const n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function WQ(t,e){return e.map((e=>t[e])).join(", ")}function GQ(t,e,n,r){const i=n.map(((t,n)=>{const r={logicalShape:t.shape,texShape:t.isUniform?null:t.texData.texShape,isUniform:t.isUniform,isPacked:!t.isUniform&&t.texData.isPacked,flatOffset:null};return null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0&&(r.flatOffset=t.texData.slice.flatOffset),{name:e.variableNames[n],shapeInfo:r}})),o=i.map((t=>t.shapeInfo)),a={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},s=RQ(i,a,e),l=function(t,e){const n=cQ(t,(()=>t.createShader(t.FRAGMENT_SHADER)),"Unable to create fragment WebGLShader.");if(QJ(t,(()=>t.shaderSource(n,e))),QJ(t,(()=>t.compileShader(n))),FD().get("ENGINE_COMPILE_ONLY"))return n;if(!1===t.getShaderParameter(n,t.COMPILE_STATUS))throw nQ(e,t.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}(t.gl,s),c=t.createProgram(l);return FD().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:l,source:s,webGLProgram:c,inShapeInfos:o,outShapeInfo:a,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(t.buildVao(c),Object.assign({program:e,fragmentShader:l,source:s,webGLProgram:c,inShapeInfos:o,outShapeInfo:a},HQ(t,e,c)))}function HQ(t,e,n){const r=[],i=[];let o,a,s,l=null,c=null;c=t.getUniformLocation(n,"NAN",!1),1===FD().getNumber("WEBGL_VERSION")&&(l=t.getUniformLocation(n,"INFINITY",!1));const u=!1;for(const h of e.variableNames){const i={name:h,uniform:t.getUniformLocation(n,h,u),offset:t.getUniformLocation(n,"offset".concat(h),u)};e.enableShapeUniforms&&(i.shape=t.getUniformLocation(n,"".concat(h,"Shape"),u),i.texShape=t.getUniformLocation(n,"".concat(h,"TexShape"),u)),r.push(i)}if(e.enableShapeUniforms&&(o=t.getUniformLocation(n,"outShape",u),s=t.getUniformLocation(n,"outShapeStrides",u),a=t.getUniformLocation(n,"outTexShape",u)),e.customUniforms)for(const h of e.customUniforms)i.push(t.getUniformLocation(n,h.name,u));return{variablesLocations:r,customUniformLocations:i,infLoc:l,nanLoc:c,outShapeLocation:o,outShapeStridesLocation:s,outTexShapeLocation:a}}function qQ(t,e){if(t.length!==e.length)throw Error("Binary was compiled with ".concat(t.length," inputs, but ")+"was executed with ".concat(e.length," inputs"));t.forEach(((t,n)=>{const r=t.logicalShape,i=e[n],o=i.shape;if(!uD(r,o))throw Error("Binary was compiled with different shapes than "+"the current args. Shapes ".concat(r," and ").concat(o," must match"));if(t.isUniform&&i.isUniform)return;const a=t.texShape,s=i.isUniform?null:i.texData.texShape;if(!uD(a,s))throw Error("Binary was compiled with different texture shapes than the"+" current args. Shape ".concat(a," and ").concat(s," must match"))}))}function XQ(t){return FD().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&t<=4}class YQ{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=HJ.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const e=TQ();this.outputShape=t,this.enableShapeUniforms=XQ(this.outputShape.length),this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(this.enableShapeUniforms?MQ(["r","c","d"],t):EQ(["r","c","d"],t),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ").concat(e.output," = result;\n      }\n    ")}}class KQ{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=HJ.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const e=TQ();this.outputShape=t,this.enableShapeUniforms=XQ(this.outputShape.length),this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(this.enableShapeUniforms?MQ(["r","c","d"],t):EQ(["r","c","d"],t),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ").concat(e.output," = result;\n      }\n    ")}}class ZQ{constructor(t){this.variableNames=["A"],this.outTexUsage=qJ.DOWNLOAD;const e=TQ();this.outputShape=t,this.userCode="\n      ".concat(kQ,"\n\n      void main() {\n        float x = getAAtOutCoords();\n        ").concat(e.output," = encode_float(x);\n      }\n    ")}}class JQ{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=qJ.DOWNLOAD;const e=TQ();this.outputShape=t,this.userCode="\n      ".concat(kQ,"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ").concat(e.output," = encode_float(x);\n      }\n    ")}}const QQ={R:0,G:1,B:2,A:3};class $Q{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"RGBA";this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=TQ();this.outputShape=t,this.enableShapeUniforms=XQ(this.outputShape.length);let i="result";e&&(i="floor(result * 255. + 0.5)");let o="";for(let a=0;a<n.length;a++){const t=n[a];o+="\n          if(offset == ".concat(a,") {\n            result = values[").concat(QQ[t],"];\n          }")}this.userCode="\n      ".concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":AQ(t),"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int flatIndex = getFlatIndex(coords);\n        float result = 0.;\n        int offset = imod(flatIndex, ").concat(n.length,");\n\n        flatIndex = idiv(flatIndex, ").concat(n.length,", 1.);\n\n        int r = flatIndex / texShape[1];\n        if (r < texShape[0]) {\n          int c = imod(flatIndex, texShape[1]);\n          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n          vec4 values = ").concat(r.texture2D,"(A, uv);\n          ").concat(o,"\n        }\n        ").concat(r.output," = vec4(").concat(i,", 0., 0., 0.);\n      }\n    ")}}class t${constructor(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=TQ();this.outputShape=t,this.enableShapeUniforms=XQ(this.outputShape.length);let r="",i="result";e&&(i="floor(result * 255. + 0.5)");for(let o=0;o<=1;o++)for(let e=0;e<=1;e++){const i=2*o+e;r+="\n          localCoords = coords;\n          if(localCoords[2] + ".concat(e," < ").concat(this.enableShapeUniforms?"outShape[2]":"".concat(t[2]),") {\n          localCoords[2] += ").concat(e,";\n          if (localCoords[1] + ").concat(o," < ").concat(this.enableShapeUniforms?"outShape[1]":"".concat(t[1]),") {\n            localCoords[1] += ").concat(o,";\n\n            flatIndex = getFlatIndex(localCoords);\n            offset = imod(flatIndex, 4);\n\n            flatIndex = idiv(flatIndex, 4, 1.);\n\n            int r = flatIndex / texShape[1];\n            int c = imod(flatIndex, texShape[1]);\n            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n            values = ").concat(n.texture2D,"(A, uv);\n\n            if (offset == 0) {\n              result[").concat(i,"] = values[0];\n            } else if (offset == 1) {\n              result[").concat(i,"] = values[1];\n            } else if (offset == 2) {\n              result[").concat(i,"] = values[2];\n            } else {\n              result[").concat(i,"] = values[3];\n            }\n          }\n        }\n        ")}this.userCode="\n        ".concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":AQ(t),"\n\n        void main() {\n          ivec3 coords = getOutputCoords();\n\n          vec4 result = vec4(0.);\n          int flatIndex, r, c, offset;\n          ivec3 localCoords;\n          vec2 uv;\n          vec4 values;\n\n          ").concat(r,"\n\n          ").concat(n.output," = ").concat(i,";\n        }\n    ")}}function e$(t){const e=TQ();return function(t,e){const n=cQ(t,(()=>t.createShader(t.VERTEX_SHADER)),"Unable to create vertex WebGLShader.");if(QJ(t,(()=>t.shaderSource(n,e))),QJ(t,(()=>t.compileShader(n))),!1===t.getShaderParameter(n,t.COMPILE_STATUS))throw console.log(t.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}(t,"".concat(e.version,"\n    precision highp float;\n    ").concat(e.attribute," vec3 clipSpacePos;\n    ").concat(e.attribute," vec2 uv;\n    ").concat(e.varyingVs," vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }"))}function n$(t){return function(t,e){const n=cQ(t,(()=>t.createBuffer()),"Unable to create WebGLBuffer");return QJ(t,(()=>t.bindBuffer(t.ARRAY_BUFFER,n))),QJ(t,(()=>t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW))),n}(t,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function r$(t){return function(t,e){const n=cQ(t,(()=>t.createBuffer()),"Unable to create WebGLBuffer");return QJ(t,(()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n))),QJ(t,(()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW))),n}(t,new Uint16Array([0,1,2,2,1,3]))}function i$(t,e,n,r,i,o){!function(t,e){const n=FD().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){const n="[".concat(t,"x").concat(e,"]");throw new Error("Requested texture size "+n+" is invalid.")}if(t>n||e>n){const r="[".concat(t,"x").concat(e,"]"),i="[".concat(n,"x").concat(n,"]");throw new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+i+".")}}(e,n);const a=function(t){return cQ(t,(()=>t.createTexture()),"Unable to create WebGLTexture.")}(t),s=t.TEXTURE_2D;return QJ(t,(()=>t.bindTexture(s,a))),QJ(t,(()=>t.texParameteri(s,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE))),QJ(t,(()=>t.texParameteri(s,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE))),QJ(t,(()=>t.texParameteri(s,t.TEXTURE_MIN_FILTER,t.NEAREST))),QJ(t,(()=>t.texParameteri(s,t.TEXTURE_MAG_FILTER,t.NEAREST))),1===FD().getNumber("WEBGL_VERSION")?QJ(t,(()=>t.texImage2D(s,0,r,e,n,0,i,o,null))):QJ(t,(()=>t.texStorage2D(s,1,r,e,n))),QJ(t,(()=>t.bindTexture(t.TEXTURE_2D,null))),{texture:a,texShape:[n,e]}}function o$(t){return t.internalFormatFloat}function a$(t){return t.internalFormatHalfFloat}function s$(t){return t.downloadTextureFormat}function l$(t){return t.internalFormatPackedFloat}function c$(t){return t.internalFormatPackedHalfFloat}function u$(t,e,n,r,i,o,a,s){const l=t,c=new Float32Array(function(t,e){const[n,r]=ZJ(t,e);return n*r*4}(o,a));return l.bindBuffer(l.PIXEL_PACK_BUFFER,e),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,c),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),c}class h${constructor(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const e=FD().getNumber("WEBGL_VERSION");if(null!=t?(this.gl=t,function(t,e){VJ[t]=e}(e,t)):this.gl=GJ(e),t=this.gl,2===FD().getNumber("WEBGL_VERSION")){const e=t;this.createVertexArray=()=>QJ(e,(()=>e.createVertexArray())),this.bindVertexArray=t=>QJ(e,(()=>e.bindVertexArray(t))),this.deleteVertexArray=t=>QJ(e,(()=>e.deleteVertexArray(t))),this.getVertexArray=()=>QJ(e,(()=>e.getParameter(e.VERTEX_ARRAY_BINDING)))}else if(null!=t){const e=t.getExtension("OES_vertex_array_object");if(null==e)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>QJ(t,(()=>e.createVertexArrayOES())),this.bindVertexArray=n=>QJ(t,(()=>e.bindVertexArrayOES(n))),this.deleteVertexArray=n=>QJ(t,(()=>e.deleteVertexArrayOES(n))),this.getVertexArray=()=>QJ(t,(()=>t.getParameter(e.VERTEX_ARRAY_BINDING_OES)))}let n="WEBGL_color_buffer_float";const r="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),1===FD().getNumber("WEBGL_VERSION")){const t="OES_texture_float",e="OES_texture_half_float";if(this.textureFloatExtension=tQ(this.gl,t),vQ(this.gl,e))this.textureHalfFloatExtension=tQ(this.gl,e);else if(FD().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),vQ(this.gl,r))this.colorBufferHalfFloatExtension=tQ(this.gl,r);else if(FD().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",vQ(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else{if(!vQ(this.gl,r))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension(r)}this.vertexBuffer=n$(this.gl),this.indexBuffer=r$(this.gl),this.framebuffer=function(t){return cQ(t,(()=>t.createFramebuffer()),"Unable to create WebGLFramebuffer.")}(this.gl),this.textureConfig=JJ(this.gl,this.textureHalfFloatExtension)}get debug(){return FD().getBool("DEBUG")}dispose(){if(this.disposed)return;null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const t=this.gl;QJ(t,(()=>t.finish())),QJ(t,(()=>t.bindFramebuffer(t.FRAMEBUFFER,null))),QJ(t,(()=>t.deleteFramebuffer(this.framebuffer))),QJ(t,(()=>t.bindBuffer(t.ARRAY_BUFFER,null))),QJ(t,(()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null))),QJ(t,(()=>t.deleteBuffer(this.indexBuffer))),this.disposed=!0}createFloat32MatrixTexture(t,e){return this.throwIfDisposed(),function(t,e,n,r){const[i,o]=YJ(e,n);return i$(t,i,o,o$(r),r.textureFormatFloat,t.FLOAT)}(this.gl,t,e,this.textureConfig)}createFloat16MatrixTexture(t,e){return this.throwIfDisposed(),function(t,e,n,r){const[i,o]=YJ(e,n);return i$(t,i,o,a$(r),r.textureFormatFloat,r.textureTypeHalfFloat)}(this.gl,t,e,this.textureConfig)}createUnsignedBytesMatrixTexture(t,e){return this.throwIfDisposed(),function(t,e,n,r){const[i,o]=YJ(e,n);return i$(t,i,o,s$(r),t.RGBA,t.UNSIGNED_BYTE)}(this.gl,t,e,this.textureConfig)}uploadPixelDataToTexture(t,e){this.throwIfDisposed(),function(t,e,n){QJ(t,(()=>t.bindTexture(t.TEXTURE_2D,e))),n.data instanceof Uint8Array?2===FD().getNumber("WEBGL_VERSION")?QJ(t,(()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n.width,n.height,t.RGBA,t.UNSIGNED_BYTE,n.data))):QJ(t,(()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,n.data))):2===FD().getNumber("WEBGL_VERSION")?QJ(t,(()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,n))):QJ(t,(()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n))),QJ(t,(()=>t.bindTexture(t.TEXTURE_2D,null)))}(this.gl,t,e)}uploadDenseMatrixToTexture(t,e,n,r){this.throwIfDisposed(),function(t,e,n,r,i,o){let a,s,l;QJ(t,(()=>t.bindTexture(t.TEXTURE_2D,e))),i instanceof Uint8Array?(a=new Uint8Array(n*r*4),s=t.UNSIGNED_BYTE,l=t.RGBA):(a=new Float32Array(n*r*4),s=t.FLOAT,l=o.internalFormatPackedFloat),a.set(i),2===FD().getNumber("WEBGL_VERSION")?QJ(t,(()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n,r,t.RGBA,s,a))):QJ(t,(()=>t.texImage2D(t.TEXTURE_2D,0,l,n,r,0,t.RGBA,s,a))),QJ(t,(()=>t.bindTexture(t.TEXTURE_2D,null)))}(this.gl,t,e,n,r,this.textureConfig)}createFloat16PackedMatrixTexture(t,e){return this.throwIfDisposed(),function(t,e,n,r){const[i,o]=ZJ(e,n);return i$(t,i,o,c$(r),t.RGBA,r.textureTypeHalfFloat)}(this.gl,t,e,this.textureConfig)}createPackedMatrixTexture(t,e){return this.throwIfDisposed(),function(t,e,n,r){const[i,o]=ZJ(e,n);return i$(t,i,o,l$(r),t.RGBA,t.FLOAT)}(this.gl,t,e,this.textureConfig)}deleteMatrixTexture(t){this.throwIfDisposed(),this.outputTexture===t&&(sQ(this.gl,this.framebuffer),this.outputTexture=null),QJ(this.gl,(()=>this.gl.deleteTexture(t)))}downloadByteEncodedFloatMatrixFromOutputTexture(t,e,n){return this.downloadMatrixDriver(t,(()=>function(t,e,n,r){const[i,o]=YJ(e,n),a=new Uint8Array(e*n*4);return QJ(t,(()=>t.readPixels(0,0,i,o,r.downloadTextureFormat,t.UNSIGNED_BYTE,a))),new Float32Array(a.buffer)}(this.gl,e,n,this.textureConfig)))}downloadPackedMatrixFromBuffer(t,e,n,r,i,o){return u$(this.gl,t,0,0,0,i,o,this.textureConfig)}downloadFloat32MatrixFromBuffer(t,e){return function(t,e,n){const r=t,i=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,i),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),i}(this.gl,t,e)}createBufferFromTexture(t,e,n){this.bindTextureToFrameBuffer(t);const r=function(t,e,n,r){const i=t.createBuffer();QJ(t,(()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,i)));const o=16*e*n;return QJ(t,(()=>t.bufferData(t.PIXEL_PACK_BUFFER,o,t.STREAM_READ))),QJ(t,(()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,0))),QJ(t,(()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null))),i}(this.gl,e,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){const t=this.createFence(this.gl);return this.pollFence(t)}createFence(t){let e,n;if(FD().getBool("WEBGL_FENCE_API_ENABLED")){const r=t,i=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),n=()=>{const t=r.clientWaitSync(i,0,0);return t===r.ALREADY_SIGNALED||t===r.CONDITION_SATISFIED},e=i}else FD().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(e=this.beginQuery(),this.endQuery(),n=()=>this.isQueryAvailable(e,FD().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):n=()=>!0;return{query:e,isFencePassed:n}}downloadMatrixFromPackedTexture(t,e,n){return this.downloadMatrixDriver(t,(()=>function(t,e,n){const r=new Float32Array(e*n*4);return QJ(t,(()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,r))),r}(this.gl,e,n)))}createProgram(t){this.throwIfDisposed();const e=this.gl;null==this.vertexShader&&(this.vertexShader=e$(e));const n=function(t){return cQ(t,(()=>t.createProgram()),"Unable to create WebGLProgram.")}(e);QJ(e,(()=>e.attachShader(n,this.vertexShader))),QJ(e,(()=>e.attachShader(n,t))),function(t,e){if(QJ(t,(()=>t.linkProgram(e))),!FD().get("ENGINE_COMPILE_ONLY")&&!1===t.getProgramParameter(e,t.LINK_STATUS))throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}(e,n);const r=Object.assign(n,{vao:this.createVertexArray()});return this.debug&&rQ(e,r),r}buildVao(t){this.setProgram(t),this.bindVertexArray(t.vao);const e=this.gl;QJ(e,(()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer))),function(t,e,n){QJ(t,(()=>t.bindBuffer(t.ARRAY_BUFFER,n))),iQ(t,e,"clipSpacePos",n,3,20,0)&&iQ(t,e,"uv",n,2,20,12)}(e,t,this.vertexBuffer)}deleteProgram(t){this.throwIfDisposed(),t===this.program&&(this.program=null),null!=t&&(QJ(this.gl,(()=>this.gl.deleteProgram(t))),this.deleteVertexArray(t.vao))}setProgram(t){this.throwIfDisposed(),this.program=t,null!=this.program&&this.debug&&rQ(this.gl,this.program),QJ(this.gl,(()=>this.gl.useProgram(t)))}getUniformLocation(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.throwIfDisposed(),n?function(t,e,n){return cQ(t,(()=>t.getUniformLocation(e,n)),'uniform "'+n+'" not present in program.')}(this.gl,t,e):function(t,e,n){return t.getUniformLocation(e,n)}(this.gl,t,e)}getAttributeLocation(t,e){return this.throwIfDisposed(),QJ(this.gl,(()=>this.gl.getAttribLocation(t,e)))}getUniformLocationNoThrow(t,e){return this.throwIfDisposed(),this.gl.getUniformLocation(t,e)}setInputMatrixTexture(t,e,n){this.throwIfDisposed(),this.throwIfNoProgram(),oQ(this.gl,t,e,n)}setOutputMatrixTexture(t,e,n){this.setOutputMatrixTextureDriver(t,n,e)}setOutputPackedMatrixTexture(t,e,n){this.throwIfDisposed();const[r,i]=ZJ(e,n);this.setOutputMatrixTextureDriver(t,r,i)}setOutputMatrixWriteRegion(t,e,n,r){this.setOutputMatrixWriteRegionDriver(n,t,r,e)}setOutputPackedMatrixWriteRegion(t,e,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){null!=this.program&&rQ(this.gl,this.program),lQ(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const t=this.gl;if(this.debug){const t=this.getVertexArray();console.assert(t===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}QJ(t,(()=>t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),QJ(this.gl,(()=>this.gl.finish()))}getQueryTimerExtension(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=tQ(this.gl,2===FD().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(2===FD().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const t=this.gl,e=this.getQueryTimerExtensionWebGL2(),n=t.createQuery();return t.beginQuery(e.TIME_ELAPSED_EXT,n),n}const t=this.getQueryTimerExtensionWebGL1(),e=t.createQueryEXT();return t.beginQueryEXT(t.TIME_ELAPSED_EXT,e),e}endQuery(){if(2===FD().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const t=this.gl,e=this.getQueryTimerExtensionWebGL2();return void t.endQuery(e.TIME_ELAPSED_EXT)}const t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(t){return await fD((()=>this.disposed||this.isQueryAvailable(t,FD().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")))),this.getQueryTime(t,FD().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(t,e){if(0===e)return null;if(2===e){const e=this.gl;return e.getQueryParameter(t,e.QUERY_RESULT)/1e6}{const e=this.getQueryTimerExtensionWebGL1();return e.getQueryObjectEXT(t,e.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(t,e){if(0===e)return!0;if(2===e){const e=this.gl,n=this.getQueryTimerExtensionWebGL2(),r=e.getQueryParameter(t,e.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(n.GPU_DISJOINT_EXT)),r&&!this.disjoint}{const e=this.getQueryTimerExtensionWebGL1(),n=e.getQueryObjectEXT(t,e.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(e.GPU_DISJOINT_EXT)),n&&!this.disjoint}}pollFence(t){return new Promise((e=>{this.addItemToPoll((()=>t.isFencePassed()),(()=>e()))}))}pollItems(){const t=function(t){let e=0;for(;e<t.length;++e){if(!t[e]())break}return e-1}(this.itemsToPoll.map((t=>t.isDoneFn)));for(let e=0;e<=t;++e){const{resolveFn:t}=this.itemsToPoll[e];t()}this.itemsToPoll=this.itemsToPoll.slice(t+1)}addItemToPoll(t,e){if(this.itemsToPoll.push({isDoneFn:t,resolveFn:e}),this.itemsToPoll.length>1)return;let n;"setTimeoutCustom"in FD().platform&&(n=FD().platform.setTimeoutCustom.bind(FD().platform)),fD((()=>(this.pollItems(),0===this.itemsToPoll.length)),(()=>0),null,n)}bindTextureToFrameBuffer(t){this.throwIfDisposed(),aQ(this.gl,t,this.framebuffer),this.debug&&lQ(this.gl)}unbindTextureToFrameBuffer(){null!=this.outputTexture?(aQ(this.gl,this.outputTexture,this.framebuffer),this.debug&&lQ(this.gl)):sQ(this.gl,this.framebuffer)}downloadMatrixDriver(t,e){this.bindTextureToFrameBuffer(t);const n=e();return this.unbindTextureToFrameBuffer(),n}setOutputMatrixTextureDriver(t,e,n){this.throwIfDisposed();const r=this.gl;aQ(r,t,this.framebuffer),this.debug&&lQ(r),this.outputTexture=t,QJ(r,(()=>r.viewport(0,0,e,n))),QJ(r,(()=>r.scissor(0,0,e,n)))}setOutputMatrixWriteRegionDriver(t,e,n,r){this.throwIfDisposed(),QJ(this.gl,(()=>this.gl.scissor(t,e,n,r)))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(null==this.program)throw new Error("No GPU program is currently set.")}}function d$(t,e){Array.isArray(t)||(t=[t]),t.forEach((t=>{null!=t&&aD("complex64"!==t.dtype,(()=>"".concat(e," does not support complex64 tensors in the CPU backend.")))}))}function p$(t){const e=new Float32Array(t.length);for(let n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e}function f$(t){return(e,n,r,i,o)=>{const a=Oj(e,n),s=a.length,l=ED(a),c=yD(o,cD(a)),u=e.length,h=n.length,d=ED(e),p=ED(n),f=Pj(e,a),m=Pj(n,a);if(f.length+m.length===0)for(let g=0;g<c.length;++g)c[g]=t(r[g%r.length],i[g%i.length]);else for(let g=0;g<c.length;++g){const e=PD(g,s,l),n=e.slice(-u);f.forEach((t=>n[t]=0));const o=RD(n,u,d),a=e.slice(-h);m.forEach((t=>a[t]=0));const y=RD(a,h,p);c[g]=t(r[o],i[y])}return[c,a]}}function m$(t){const{inputs:e,backend:n}=t,{real:r,imag:i}=e,o=n.data.get(r.dataId).values,a=n.data.get(i.dataId).values,s=n.makeTensorInfo(r.shape,"complex64");return n.data.get(s.dataId).complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",o),imag:n.makeTensorInfo(i.shape,"float32",a)},s}function g$(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"float32";if("complex64"===n){return m$({inputs:{real:g$(t,e,"float32"),imag:g$(t,e,"float32")},backend:t})}const r=kD(cD(e),n);return t.makeTensorInfo(e,n,r)}function y$(t){const{inputs:e,backend:n}=t,{x:r}=e;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}function v$(t){const{inputs:e,backend:n}=t,{input:r}=e,i=n.data.get(r.dataId).complexTensorInfos.real,o=n.data.get(i.dataId).values;return n.makeTensorInfo(i.shape,i.dtype,o)}function b$(t,e,n,r){if("int32"===r){return[e,"int32",Int32Array.from(t)]}if("bool"===r){const r=QU([0],n),[i,o]=f$(((t,e)=>t!==e?1:0))(e,[],t,r,"bool");return[o,"bool",i]}throw new Error("Error in Cast: failed to cast ".concat(n," to ").concat(r))}function x$(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{dtype:o}=r;if("complex64"===o){if("complex64"===i.dtype)return y$({inputs:{x:i},backend:n});const t=g$(n,i.shape,i.dtype),e=x$({inputs:{x:i},backend:n,attrs:{dtype:"float32"}}),r=m$({inputs:{real:e,imag:t},backend:n});return n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(e),r}if("complex64"===i.dtype){const t=v$({inputs:{input:i},backend:n}),e=x$({inputs:{x:t},backend:n,attrs:{dtype:o}});return n.disposeIntermediateTensorInfo(t),e}if(!bD(i.dtype,o)){const t=y$({inputs:{x:i},backend:n});return{dataId:t.dataId,shape:t.shape,dtype:o}}const a=n.data.get(i.dataId).values,[s,l,c]=b$(a,i.shape,i.dtype,o);return n.makeTensorInfo(s,l,c)}function _$(t,e,n,r){return null==n?n=>{let{inputs:i,backend:o}=n;const{a:a,b:s}=i,l=o;d$([a,s],t);const c=l.data.get(a.dataId).values,u=l.data.get(s.dataId).values,h="string"===a.dtype?QY(c):c,d="string"===a.dtype?QY(u):u,p=r||a.dtype,[f,m]=e(a.shape,s.shape,h,d,p);return l.makeTensorInfo(m,p,f)}:t=>{let{inputs:i,backend:o}=t;const{a:a,b:s}=i,l=o;if("complex64"===a.dtype||"complex64"===s.dtype){const t=x$({inputs:{x:a},backend:l,attrs:{dtype:"complex64"}}),e=l.data.get(t.dataId),r=e.complexTensorInfos.real,i=e.complexTensorInfos.imag,o=l.data.get(r.dataId).values,c=l.data.get(i.dataId).values,u=x$({inputs:{x:s},backend:l,attrs:{dtype:"complex64"}}),h=l.data.get(u.dataId),d=h.complexTensorInfos.real,p=h.complexTensorInfos.imag,f=l.data.get(d.dataId).values,m=l.data.get(p.dataId).values,[g,y,v]=n(a.shape,s.shape,o,c,f,m),b=l.makeTensorInfo(v,"float32",g),x=l.makeTensorInfo(v,"float32",y),_=m$({inputs:{real:b,imag:x},backend:l});return l.disposeIntermediateTensorInfo(t),l.disposeIntermediateTensorInfo(u),l.disposeIntermediateTensorInfo(b),l.disposeIntermediateTensorInfo(x),_}{const t=l.data.get(a.dataId).values,n=l.data.get(s.dataId).values,i=r||a.dtype,[o,c]=e(a.shape,s.shape,t,n,i);return l.makeTensorInfo(c,i,o)}}}function w$(t){return(e,n,r,i,o,a)=>{const s=Oj(e,n),l=cD(s),c=s.length,u=ED(s),h=yD("float32",l),d=yD("float32",l),p=Pj(e,s),f=Pj(n,s),m=vY(r,i),g=vY(o,a),y=e.length,v=ED(e),b=n.length,x=ED(n);if(p.length+f.length===0)for(let _=0;_<h.length;_++){const e=_%m.length,n=_%g.length,r=t(m[2*e],m[2*e+1],g[2*n],g[2*n+1]);h[_]=r.real,d[_]=r.imag}else for(let _=0;_<h.length;_++){const e=PD(_,c,u),n=e.slice(-y);p.forEach((t=>n[t]=0));const r=RD(n,y,v),i=e.slice(-b);f.forEach((t=>i[t]=0));const o=RD(i,b,x),a=t(m[2*r],m[2*r+1],g[2*o],g[2*o+1]);h[_]=a.real,d[_]=a.imag}return[h,d,s]}}const S$=f$(((t,e)=>t+e)),T$=w$(((t,e,n,r)=>({real:t+n,imag:e+r})));_$(HD,S$,T$);function E$(t,e,n,r,i){const o=cD(r),a=kD(i,n);for(let s=0;s<t.length;s++){const n=t[s];if(n<0)throw new Error("Input x must be non-negative!");n>=i||(a[n]+=o>0?e[s]:1)}return a}function M$(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=t.shape[0],o=t.shape[1],a=cj([i,n],e.dtype);for(let s=0;s<i;s++)for(let i=0;i<o;i++){const o=t.get(s,i);if(o<0)throw new Error("Input x must be non-negative!");o>=n||(r?a.set(1,s,o):e.size>0?a.set(a.get(s,o)+e.get(s,i),s,o):a.set(a.get(s,o)+1,s,o))}return a}const C$=f$(((t,e)=>t&e));_$(oL,C$);function A$(t){return(e,n,r)=>{const i=vD(n,e.length);for(let o=0;o<e.length;++o)i[o]=t(e[o],r);return i}}function k$(t,e,n){return I$(t,A$(e),n)}function I$(t,e,n){return r=>{let{inputs:i,attrs:o,backend:a}=r;const{x:s}=i;d$(s,t);const l=a,c=l.data.get(s.dataId).values;let u;if("string"===s.dtype){if(!Array.isArray(c))throw new Error("String tensor's value was not an instance of Array");u=QY(c)}else u=c;const h=n||s.dtype,d=e(u,h,o);return l.makeTensorInfo(s.shape,h,d)}}const R$=A$((t=>Math.ceil(t)));I$(lL,R$);function P$(t,e,n,r){const i=vD(n,cD(e));if(r&&"string"!==n){let e=0;t.forEach((t=>{const n=cD(t.shape);i.set(t.vals,e),e+=n}))}else{let r=0;t.forEach((t=>{const o="string"===n?QY(t.vals):t.vals;let a=0;for(let n=0;n<t.shape[0];++n){const s=n*e[1]+r;for(let e=0;e<t.shape[1];++e)i[s+e]=o[a++]}r+=t.shape[1]}))}return i}const N$=f$(((t,e)=>t===e?1:0)),O$=(_$(PL,N$,null,"bool"),A$((t=>Math.exp(t)))),D$=(I$(NL,O$,"float32"),A$((t=>Math.expm1(t)))),L$=(I$(DL,D$),A$((t=>Math.floor(t))));I$(UL,L$);function F$(t,e,n,r,i,o,a,s,l){const c=cj([r,o],n);for(let u=0;u<r;u++){const n=[];let r=0;for(let e=0;e<i;e++){const o=t[u*i+e];r+=o*a[e],n.push(o)}if(r<0||r>=l/o)throw new Error("Invalid indices: ".concat(n," does not index into ").concat(s));for(let t=0;t<o;t++)c.values[u*o+t]=e.get(...e.indexToLoc(r*o+t))}return c}function U$(t,e,n){const r=cj(n,t.dtype);for(let i=0;i<r.size;++i){const n=r.indexToLoc(i).slice(),o=n[0],a=n[2],s=e.locToIndex([o,a]);n[2]=e.values[s];const l=t.locToIndex(n);0<=l&&l<t.values.length&&(r.values[i]=t.values[l])}return r}const B$=f$(((t,e)=>t>e?1:0)),z$=(_$(WL,B$,null,"bool"),f$(((t,e)=>t>=e?1:0))),j$=(_$(GL,z$,null,"bool"),f$(((t,e)=>t<e?1:0))),V$=(_$(QL,j$,null,"bool"),f$(((t,e)=>t<=e?1:0)));_$($L,V$,null,"bool");function W$(t,e,n){const r=(e-t)/(n-1),i=kD(n,"float32");i[0]=t;for(let o=1;o<i.length;o++)i[o]=i[o-1]+r;return i}const G$=A$((t=>Math.log(t)));I$(eF,G$);function H$(t,e,n,r){const i=yD(r,cD(n));for(let o=0;o<i.length;++o){const n=o*e;let r=t[n];for(let i=0;i<e;++i){const e=t[n+i];(Number.isNaN(e)||e>r)&&(r=e)}i[o]=r}return i}const q$=f$(((t,e)=>Math.max(t,e))),X$=(_$(aF,q$),f$(((t,e)=>Math.min(t,e)))),Y$=(_$(hF,X$),f$(((t,e)=>t*e))),K$=w$(((t,e,n,r)=>({real:t*n-e*r,imag:t*r+e*n})));_$(fF,Y$,K$);function Z$(t,e,n){const r=JU(-1,n);return Y$([],e,r,t,n)}const J$=f$(((t,e)=>t!==e?1:0));_$(gF,J$,null,"bool");function Q$(t,e,n,r,i){const o=e.length,a=cD(e),s=ED(e),l=ED(i),c=yD(n,cD(i));for(let u=0;u<a;++u){const e=PD(u,o,s),n=new Array(e.length);for(let t=0;t<n.length;t++)n[t]=e[r[t]];c[RD(n,o,l)]=t[u]}return c}function $$(t,e,n,r){const[i,o]=$W(t,r),a=AB(e,"int32"),s=kD(cD(i),a),l=cD(o);for(let c=0;c<s.length;++c){const t=c*l;let e=1;for(let r=0;r<l;++r)e*=n[t+r];s[c]=e}return{outVals:s,outShape:i,outDtype:a}}function t0(t,e,n,r){const i=[];let o=0;const a=e.length-1+n.length,s=new Array(a).fill(null).map((()=>[0]));!function(t,e){for(let n=0;n<t.length;++n){const r=t[n],i=n===t.length-1?e:t[n+1].length;if(0===r.length)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>i)throw new Error("Ragged splits must not point past values");for(let t=1;t<r.length;++t)if(r[t-1]>r[t])throw new Error("Ragged splits must be sorted in ascending order")}}(n,r);let l=1;for(let c=0;c<e.length-1;++c){l*=e[c];const t=e[c+1];for(let e=1;e<l+1;++e)s[c].push(e*t)}for(let c=0;c<t.length;++c){let r=t[c],a=t[c]+1;for(let t=0;t<n.length;++t){const i=n[t],o=t+e.length-1;if(o>=0){const t=s[o],e=t[t.length-1]-i[r];for(let n=r;n<a;++n)s[o].push(i[n+1]+e)}r=i[r],a=i[a]}a!==r&&(i.push([r,a]),o+=a-r)}return{outSplits:s,valueSlices:i,numValues:o}}function e0(t,e){const n=t.slice(0,e);for(;n.length<e;)n.push(1);for(let r=e;r<t.length;r++)n[e-1]*=t[r];return n}function n0(t,e,n,r,i){const o=e.slice();o[0]=i;const a=vD(n,cD(o)),s=t.length;return function(t,e,n,r,i,o){const a=e0(e,2)[1],s=e0(o,2)[1];let l=0;for(const c of n)for(let e=c[0];e<c[1];++e){for(let n=0;n<r;++n)i[l*s+n]=t[e*a+n];++l}}(t,e,r,0===s?0:s/e[0],a,o),[a,o]}function r0(t,e,n,r,i,o,a,s){if(0===t.length)throw new Error("paramsNestedSplits must be non empty");if(0===e[0].length)throw new Error("Split tensors must not be scalars");if(function(t,e,n){t.forEach(((t,r)=>{if(t<0||t>=n){const i=PD(r,e.length,ED(e)).join(",");throw new Error("indices[".concat(i,"] = ").concat(t," is not in [0, ").concat(n,")"))}}))}(o,a,e[0][0]-1),0===r.length)throw new Error("params.rank must be nonzero");const l=r[0],{outSplits:c,valueSlices:u,numValues:h}=t0(o,a,t,l),d=function(t){const e=[];for(let n=0;n<t.length;++n){const r=vD("int32",t[n].length);e.push(r),t[n].forEach(((t,e)=>r[e]=t))}return e}(c),p=n0(n,r,i,u,h);return[d,p[0],p[1]]}const i0=2147483647;function o0(t,e,n,r,i,o,a){if(e.length>1)throw new Error("starts must be a scalar or vector");if(i.length>1)throw new Error("limits must be a scalar or vector");if(a.length>1)throw new Error("deltas must be a scalar or vector");const s=0===e.length,l=0===i.length,c=0===a.length,u=[];s||u.push(e[0]),l||u.push(i[0]),c||u.push(a[0]);for(let m=1;m<u.length;++m)if(u[m]!==u[m-1])throw new Error("starts, limits, and deltas must have the same shape");const h=0===u.length?1:u[0],d=vD("int32",h+1);d[0]=0;for(let m=0;m<h;++m){const e=s?t[0]:t[m],n=l?r[0]:r[m],i=c?o[0]:o[m];if(0===i)throw new Error("Requires delta != 0");let a;if(i>0&&n<e||i<0&&n>e)a=0;else if(a=Math.ceil(Math.abs((n-e)/i)),a>i0)throw new Error("Requires ((limit - start) / delta) <= ".concat(i0));d[m+1]=d[m]+a}const p=vD(n,d[h]);let f=0;for(let m=0;m<h;++m){const e=d[m+1]-d[m];let n=s?t[0]:t[m];const r=c?o[0]:o[m];for(let t=0;t<e;++t)p[f++]=n,n+=r}return[d,p]}var a0=ZX;class s0{constructor(t,e,n,r,i,o,a,s,l,c){this.shape=t,this.shapeShape=e,this.values=n,this.valuesShape=r,this.valuesDType=i,this.defaultValue=o,this.defaultValueShape=a,this.rowPartitionValues=s,this.rowPartitionValuesShapes=l,this.rowPartitionTypes=QX(c),this.raggedRank=$X(this.rowPartitionTypes)}getRowPartitionTypeByDimension(t){return this.rowPartitionTypes[0]===a0.FIRST_DIM_SIZE?this.rowPartitionTypes[t+1]:this.rowPartitionTypes[t]}getRowPartitionTensor(t){return this.rowPartitionTypes[0]===a0.FIRST_DIM_SIZE?this.rowPartitionValues[t+1]:this.rowPartitionValues[t]}getMaxWidth(t){const e=this.getRowPartitionTensor(t-1);switch(this.getRowPartitionTypeByDimension(t-1)){case a0.VALUE_ROWIDS:return s0.getMaxWidthValueRowID(e);case a0.ROW_SPLITS:return s0.getMaxWidthRowSplit(e);default:throw new Error("Cannot handle partition type ".concat(a0[this.getRowPartitionTypeByDimension(t-1)]))}}static getMaxWidthRowSplit(t){const e=t.length;if(0===e||1===e)return 0;let n=0;for(let r=0;r<e-1;++r){const e=t[r+1]-t[r];e>n&&(n=e)}return n}static getMaxWidthValueRowID(t){const e=t.length;if(0===e)return 0;let n=0,r=t[0],i=0;for(let o=1;o<e;++o){const e=t[o];e!==r&&(r=e,i=Math.max(o-n,i),n=o)}return Math.max(e-n,i)}tensorShapeFromTensor(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(0===e.length){if(-1===t[0])return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return c0(t,n)}calculateOutputSize(t){const e=this.valuesShape;tY(this.defaultValueShape,e);const n=this.tensorShapeFromTensor(this.shape,this.shapeShape),r=JX(this.raggedRank,n,e);r[0]<0&&(r[0]=t);for(let i=1;i<=this.raggedRank;++i)r[i]<0&&(r[i]=this.getMaxWidth(i));return r}calculateFirstParentOutputIndex(t,e,n){const r=Math.min(t,n),i=[];let o=0;for(let a=0;a<r;++a,o+=e)i.push(o);for(let a=r;a<t;++a)i.push(-1);return aD(i.length===t,(()=>"Final length of result must be equal to firstDimension.")),i}calculateOutputIndexRowSplit(t,e,n,r){const i=t.length,o=[];for(let a=0;a<i-1;++a){const i=t[a+1]-t[a];let s=Math.min(r,i),l=e[a];-1===l&&(s=0);for(let t=0;t<s;++t)o.push(l),l+=n;for(let t=0;t<i-s;++t)o.push(-1)}if(i>0&&o.length!==t[i-1])throw new Error("Invalid row split size.");return o}calculateOutputIndexValueRowID(t,e,n,r){const i=t.length,o=[];if(0===i)return[];let a=0,s=t[0];if(s>=e.length)throw new Error("Got currentValueRowId=".concat(s,", which is not less than ").concat(e.length));let l=e[s];o.push(l);for(let c=1;c<i;++c){const i=t[c];if(i===s)l>=0&&(++a,a<r?l+=n:l=-1);else{if(a=0,s=i,i>=e.length)throw new Error("Got nextValueRowId=".concat(i," which is not less than ").concat(e.length));l=e[i]}o.push(l)}if(o.length!==t.length)throw new Error("Invalid row ids.");return o}calculateOutputIndex(t,e,n,r){const i=this.getRowPartitionTensor(t),o=this.getRowPartitionTypeByDimension(t);switch(o){case a0.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(i,e,n,r);case a0.ROW_SPLITS:if(i.length-1>e.length)throw new Error("Row partition size is greater than output size: ".concat(i.length-1," > ").concat(e.length));return this.calculateOutputIndexRowSplit(i,e,n,r);default:throw new Error("Unsupported partition type: ".concat(a0[o]))}}getFirstDimensionSize(){const t=this.rowPartitionValues[0];if(0===this.rowPartitionTypes.length)throw new Error("No row_partition_types given.");const e=this.rowPartitionTypes[0];switch(e){case a0.FIRST_DIM_SIZE:return t[0];case a0.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case a0.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error("Cannot handle type ".concat(a0[e]))}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const t=this.getFirstDimensionSize(),e=this.calculateOutputSize(t),n=new Array(this.raggedRank+1);n[n.length-1]=1;for(let o=n.length-2;o>=0;--o)n[o]=n[o+1]*e[o+1];const r=c0(e,!1),i=vD(this.valuesDType,cD(r));if(n[0]*e[0]>0){let o=this.calculateFirstParentOutputIndex(t,n[0],e[0]);for(let t=1;t<=this.raggedRank;++t){o=this.calculateOutputIndex(t-1,o,n[t],e[t])}this.setOutput(this.raggedRank,o,i,r)}return[r,i]}setOutput(t,e,n,r){if(0===n.length)return;const i=this.values,o=n;let a=r.slice();a=a.slice(t+1);const s=cD(a),l=e.length;let c=this.defaultValue;if(c.length!==s&&1!==c.length){const t=this.defaultValueShape;iz((()=>{const e=rW(c,t),n=xW(e,a);c=n.dataSync()}))}let u=0,h=0,d=0;for(let p=0;p<=l;++p){let t=p<l?e[p]:-1;if(t!==d){if(h<d){const t=i.subarray(u*s);l0(o.subarray(h*s),t,(d-h)*s)}if(p>=l){const e=n.length;t=Math.floor(e/s)}if(t>d)if(1===this.defaultValue.length)o.subarray(d*s,t*s).fill(this.defaultValue[0]),d=t;else for(;t>d;){l0(o.slice(d*s),c,s),++d}t<0?(u=p+1,h=d):(u=p,h=d,d=h+1)}else++d}}}function l0(t,e,n){for(let r=0;r<n;r++)t[r]=e[r]}function c0(t,e){const n=[];for(let r of t){if(r<0){if(!e)throw new Error("Dimension ".concat(r," must be >= 0"));if(r<-1)throw new Error("Dimension ".concat(r," must be >= -1"));r=-1}n.push(r)}return n}function u0(t,e,n,r,i,o,a,s,l,c){return new s0(t,e,n,r,i,o,a,s,l,c).compute()}function h0(t,e,n,r){if(t===e||t<e&&n<0||e<t&&n>1)return kD(0,r);const i=kD(Math.abs(Math.ceil((e-t)/n)),r);e<t&&1===n&&(n=-1),i[0]=t;for(let o=1;o<i.length;o++)i[o]=i[o-1]+n;return i}const d0=A$((t=>1/Math.sqrt(t)));I$(BF,d0);function p0(t,e,n,r,i,o,a,s,l,c){const u=[r/i,i],h=t.values,d=e.values;if(0===r)return cj(n,e.dtype);const p=l instanceof mB?l:cj(u,e.dtype);"string"===typeof l||"number"===typeof l?p.values.fill(l):"boolean"===typeof l&&p.values.fill(+l);for(let f=0;f<o;f++){const t=[];let o=0;for(let e=0;e<a;e++){const n=h[f*a+e];t.push(n),o+=n*s[e]}if(o<0||o>=r/i)throw new Error("Invalid indices: ".concat(t," does not index into ").concat(n));for(let n=0;n<i;n++)c?p.values[o*i+n]+=d[f*i+n]:p.values[o*i+n]=0===e.rank?d[0]:d[f*i+n]}return p}const f0=A$((t=>1/(1+Math.exp(-t))));k$(YF,(t=>1/(1+Math.exp(-t))));function m0(t,e,n,r,i){const o=EV(r,e,n),a=cD(n),s=ED(r);if(o){const n=MV(e,s);return"string"===i?t.slice(n,n+a):t.subarray(n,n+a)}const l=cj(r,i,"string"===i?QY(t):t),c=cj(n,i);for(let u=0;u<c.size;++u){const t=c.indexToLoc(u),n=t.map(((t,n)=>t+e[n]));c.set(l.get(...n),...t)}return"string"===i?$Y(c.values):c.values}function g0(t,e,n,r,i,o,a){const s=e[0],l=o[0],c=new Array(l),u=new Array(s),h=e[1];if(0===l){if(0!==s)throw new Error(FY(s));return[vD(n,0),[0,h],vD(i,0),c,u]}let d=!0,p=0;const f=new Array(l).fill(0);for(let g=0;g<s;++g){const e=t[g*h];if(e<0)throw new Error(UY(g,e));if(e>=l)throw new Error(BY(g,e,l));++f[e],d=d&&e>=p,p=e}let m=!0;for(let g=0;g<l;++g){const t=0===f[g];c[g]=t,m=m&&!t,f[g]=Math.max(f[g],1),g>0&&(f[g]+=f[g-1])}if(m&&d){const e=t,n=r;for(let t=0;t<s;++t)u[t]=t;return[e,[s,h],n,c,u]}{const e=f[l-1],o=vD(n,e*h),d=vD(i,e),p=new Array(l).fill(0);for(let n=0;n<s;++n){const e=t[n*h],i=p[e],a=(0===e?0:f[e-1])+i;p[e]++;for(let r=0;r<h;++r)o[a*h+r]=t[n*h+r];d[a]=r[n],u[n]=a}for(let t=0;t<l;++t){if(0===p[t]){const e=0===t?0:f[t-1];o[e*h+0]=t;for(let t=1;t<h;++t)o[e*h+t]=0;d[e]=a}}return[o,[e,h],d,c,u]}}function y0(t,e,n,r,i){const o=cD(r),a=e[0],s=i.length,l=[];let c=1,u=-1;for(let m=0;m<s;++m){const t=i[m];if(-1===t){if(-1!==u)throw new Error(zY(u,m));u=m,l.push(1)}else{if(t<0)throw new Error(jY(m,t));c*=t,l.push(t)}}if(-1!==u){if(c<=0)throw new Error("reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero");const t=Math.trunc(o/c);if(c*t!==o)throw new Error(WY(r,l));l[u]=t}if(cD(l)!==o)throw new Error(GY(r,l));const h=r.length,d=[];if(h>0){d[h-1]=1;for(let t=h-2;t>=0;--t)d[t]=d[t+1]*r[t+1]}const p=[];if(s>0){p[s-1]=1;for(let t=s-2;t>=0;--t)p[t]=p[t+1]*l[t+1]}const f=vD(n,a*s);for(let m=0;m<a;++m){let e=0;for(let n=0;n<h;++n)e+=t[m*h+n]*d[n];for(let t=0;t<s;++t)f[m*s+t]=Math.trunc(e/p[t]),e%=p[t]}return[f,[a,s],l]}function v0(t,e,n,r,i){let o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;const s=r.length,l=[e[0],t.length/e[0]],c=l[1],u=s>0?i[s-1]+1:0;if(u<0)throw new Error("segment ids must be >= 0");const h=e.slice();h[0]=u;const d=h.reduce(((t,e)=>t*e),1),p=vD(n,d);if(0===s)return u>0&&p.fill(a),[p,h];if(u<=0)throw new Error("segment ids must be >= 0");let f=0,m=1,g=0,y=i[f];for(;;){let e=0;if(m<s){if(e=i[m],y===e){++m;continue}if(y>=e)throw new Error("segment ids are not increasing")}if(y<0||y>=u)throw new Error(XY(y,u));y>g&&p.fill(a,g*c,y*c);for(let n=f;n<m;++n){const e=r[n];if(e<0||e>=l[0])throw new Error(YY(n,r[n],l[0]));for(let n=0;n<c;n++)p[y*c+n]+=t[e*c+n]}if(o)for(let t=0;t<c;t++)p[y*c+t]/=m-f;if(f=m,++m,g=y+1,y=e,m>s)break}return g<u&&p.fill(a,g*c,u*c),[p,h]}const b0=A$((t=>Math.sqrt(t))),x0=(k$(ZF,(t=>Math.sqrt(t))),A$(((t,e)=>{const{pattern:n,replaceGlobal:r,rewrite:i}=e;return t.replace(new RegExp(n,r?"g":""),i)})));I$(aU,x0);function _0(t,e,n,r){const i=cj(t,e.dtype);for(let o=0;o<i.size;o++){const t=i.indexToLoc(o),a=new Array(t.length);for(let e=0;e<a.length;e++)a[e]=t[e]*n[e]+r[e];i.set(e.get(...a),...t)}return i}class w0{constructor(t,e,n,r,i,o){this.separator=tB(t),this.nGramWidths=e,this.leftPad=tB(n),this.rightPad=tB(r),this.padWidth=i,this.preserveShort=o}getPadWidth(t){return Math.min(this.padWidth<0?t-1:this.padWidth,t-1)}getNumNGrams(t,e){const n=this.getPadWidth(e);return Math.max(0,t+2*n-e+1)}createNGrams(t,e,n,r,i,o){for(let a=0;a<i;++a){const s=this.getPadWidth(o),l=Math.max(0,s-a),c=Math.max(0,s-(i-(a+1))),u=o-(l+c),h=e+(l>0?0:a-s);let d=0;d+=l*this.leftPad.length;for(let e=0;e<u;++e)d+=t[h+e].length;d+=c*this.rightPad.length;d+=(l+c+u-1)*this.separator.length,n[r+a]=new Uint8Array(d);const p=n[r+a];let f=0;const m=t=>t.forEach((t=>p[f++]=t));for(let t=0;t<l;++t)m(this.leftPad),m(this.separator);for(let e=0;e<u-1;++e)m(t[h+e]),m(this.separator);if(u>0){m(t[h+u-1]);for(let t=0;t<c;++t)m(this.separator),m(this.rightPad)}else{for(let t=0;t<c-1;++t)m(this.rightPad),m(this.separator);m(this.rightPad)}}}compute(t,e){const n=t.length,r=e.length;if(r>0){let t=e[0];if(0!==t)throw new Error("First split value must be 0, got ".concat(t));for(let i=1;i<r;++i){let r=e[i]>=t;if(r=r&&e[i]<=n,!r)throw new Error("Invalid split value ".concat(e[i],", must be in [").concat(t,", ").concat(n,"]"));t=e[i]}if(t!==n)throw new Error("Last split value must be data size. Expected ".concat(n,", got ").concat(t))}const i=r-1,o=vD("int32",r);if(0===n||0===r){const t=new Array(n);for(let e=0;e<=i;++e)o[e]=0;return[t,o]}o[0]=0;for(let s=1;s<=i;++s){const t=e[s]-e[s-1];let n=0;this.nGramWidths.forEach((e=>{n+=this.getNumNGrams(t,e)})),this.preserveShort&&t>0&&0===n&&(n=1),o[s]=o[s-1]+n}const a=new Array(o[i]);for(let s=0;s<i;++s){const n=e[s];let r=o[s];if(this.nGramWidths.forEach((i=>{const o=e[s+1]-e[s],l=this.getNumNGrams(o,i);this.createNGrams(t,n,a,r,l,i),r+=l})),this.preserveShort&&r===o[s]){const i=e[s+1]-e[s];if(0===i)continue;const o=i+2*this.padWidth,l=1;this.createNGrams(t,n,a,r,l,o)}}return[a,o]}}function S0(t,e,n,r,i,o,a,s){return new w0(n,r,i,o,a,s).compute(t,e)}function T0(t,e,n,r){if(!t.length)return;if(0===e.length){for(let e=0;e<t.length;++e)r.push(t.subarray(e,e+1));return}if(1===e.length){const i=e[0];let o=t.indexOf(i);for(;-1!==o;){const e=t.subarray(0,o);n&&0===e.length||r.push(e),o=(t=t.subarray(o+1)).indexOf(i)}return void(n&&0===t.length||r.push(t))}let i=0;for(let o=0;o<t.length+1;o++)if(o===t.length||-1!==e.indexOf(t[o])){const e=t.subarray(i,o);n&&0===e.length||r.push(e),i=o+1}}function E0(t,e,n){const r=t.length,i=[];let o=0,a=0;const s=new Array(r);for(let d=0;d<r;++d){const r=i.length;T0(t[d],e,n,i);const l=i.length-r;s[d]=l,o+=l,a=Math.max(a,l)}const l=vD("int32",2*o),c=new Array(o),u=[r,a];let h=0;for(let d=0;d<r;++d)for(let t=0;t<s[d];++t)l[2*h]=d,l[2*h+1]=t,c[h]=i[h],++h;return[l,c,u]}function M0(t,e){const n=vD("int32",t.length);for(let r=0;r<t.length;++r)n[r]=ZU(t[r]).modulo(e).getLowBitsUnsigned();return n}const C0=f$(((t,e)=>t-e)),A0=w$(((t,e,n,r)=>({real:t-n,imag:e-r})));_$(hU,C0,A0);function k0(t,e){const n=new Array(t.rank);for(let i=0;i<n.length;i++)n[i]=t.shape[i]*e[i];const r=cj(n,t.dtype);for(let i=0;i<r.values.length;++i){const e=r.indexToLoc(i),n=new Array(t.rank);for(let r=0;r<n.length;r++)n[r]=e[r]%t.shape[r];const o=t.locToIndex(n);r.values[i]=t.values[o]}return r}const I0=(t,e)=>{const n=e.value-t.value;return 0===n?t.index-e.index:n};function R0(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length-1;for(;r>n;){if(r-n>600){const i=r-n+1,o=e-n+1,a=Math.log(i),s=.5*Math.exp(2*a/3),l=.5*Math.sqrt(a*s*(i-s)/i)*Math.sign(o-i/2);R0(t,e,Math.max(n,Math.floor(e-o*s/i+l)),Math.min(r,Math.floor(e+(i-o)*s/i+l)))}const i=t[e];let o=n,a=r;for(oD(t,n,e),I0(t[r],i)>0&&oD(t,n,r);o<a;){for(oD(t,o,a),o++,a--;I0(t[o],i)<0;)o+=1;for(;I0(t[a],i)>0;)a-=1}0===I0(t[n],i)?oD(t,n,a):(a+=1,oD(t,a,r)),a<=e&&(n=a+1),e<=a&&(r=a-1)}}function P0(t,e,n,r,i){const o=e[e.length-1],[a,s]=[t.length/o,o],l=yD(n,a*r),c=yD("int32",a*r);for(let h=0;h<a;h++){const e=h*s,n=t.subarray(e,e+s);let o=new Array(n.length);n.forEach(((t,e)=>o[e]={value:t,index:e})),r<o.length&&(R0(o,r),o=o.slice(0,r)),i&&o.sort(I0);const a=h*r,u=l.subarray(a,a+r),d=c.subarray(a,a+r);for(let t=0;t<r;t++)u[t]=o[t].value,d[t]=o[t].index}const u=e.slice();return u[u.length-1]=r,[cj(u,n,l),cj(u,"int32",c)]}function N0(t,e,n,r){const i=mD(e,n)[0],o=[1,n[0],1];for(let f=0;f<i;f++)o[0]*=n[f];o[1]=n[i];for(let f=i+1;f<n.length;f++)o[2]*=n[f];const a=new Map,s=new Int32Array(n[i]),l=new mB(o,r,t),c=[],u=1===o[0]&&1===o[2];for(let f=0;f<n[i];f++){let e;if(u)e=t[f].toString();else{const t=[];for(let e=0;e<o[0];e++)for(let n=0;n<o[2];n++)t.push(l.get(e,f,n));e=t.join(",")}const n=a.get(e);if(null!=n)s[f]=n;else{const t=a.size;a.set(e,t),s[f]=t,c.push(f)}}const h=o.slice();h[1]=a.size;const d=new mB(h,r);c.forEach(((t,e)=>{for(let n=0;n<o[0];n++)for(let r=0;r<o[2];r++)d.set(l.get(n,t,r),n,e,r)}));const p=n.slice();return p[i]=h[1],{outputValues:d.values,outputShape:p,indices:s}}const{mx:O0,XI:D0,Nk:L0,f6:F0,ct:U0,YG:B0,hH:z0,z3:j0,sG:V0,uM:W0,vS:G0,qB:H0,GG:q0,rq:X0,lg:Y0,WR:K0,cu:Z0,GE:J0,px:Q0,jC:$0,He:t1,hE:e1,BF:n1,Dk:r1,cl:i1,_B:o1,ub:a1,_f:s1,Ku:l1,qy:c1,Zy:u1,bu:h1,zv:d1,dH:p1,HS:f1,yH:m1,l3:g1,z9:y1,x6:v1,_m:b1,eW:x1,GK:_1,SP:w1,yr:S1,dl:T1,Dw:E1,xT:M1,_X:C1,wz:A1}=C;function k1(t,e){return["x","y","z","w","u","v"].slice(0,e).map((e=>"".concat(t,".").concat(e)))}function I1(t,e){return 1===e?[t]:k1(t,e)}class R1{constructor(t){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.enableShapeUniforms=XQ(this.outputShape.length),0===this.rank)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{const t=I1("rc",this.rank),e=zQ(this.rank),n=this.getOutOfBoundsCondition(t),r=this.getSetup(t),i=this.getOutput(t);this.userCode="\n        void main() {\n          ".concat(e," rc = getOutputCoords();\n\n          if(").concat(n,") {\n            setOutput(vec4(0));\n          } else {\n            ").concat(r,"\n\n            setOutput(vec4(").concat(i,"));\n          }\n        }\n      ")}}getSourceCoordsArr(t){const e=[];for(let n=0;n<=1;n++)for(let r=0;r<=1;r++){let i="".concat(0===n?"r":"rp1",", ").concat(0===r?"c":"cp1");for(let e=2;e<this.rank;e++)i="".concat(t[t.length-1-e],",")+i;e.push(i)}return e}getOutOfBoundsCondition(t){if(1===this.rank)return"rc > ".concat(this.enableShapeUniforms?"outShape":this.outputShape[0]);let e="";for(let n=this.rank-2;n<this.rank;n++)e+="".concat(t[n]," >= ").concat(this.enableShapeUniforms?"outShape[".concat(n,"]"):this.outputShape[n]),n<this.rank-1&&(e+="||");return e}getSetup(t){if(1===this.rank)return"";const e=t.slice(-2),n=this.enableShapeUniforms?"outShape[".concat(this.rank," - 1]"):this.outputShape[this.rank-1],r=this.enableShapeUniforms?"outShape[".concat(this.rank," - 2]"):this.outputShape[this.rank-2];return"\n      int r = ".concat(e[0],";\n      int c = ").concat(e[1],";\n      int rp1 = r + 1;\n      int cp1 = c + 1;\n\n      bool cEdge = cp1 >= ").concat(n,";\n      bool rEdge = rp1 >= ").concat(r,";\n    ")}getOutput(t){const e=this.getSourceCoordsArr(t);if(1===this.rank){const t=this.enableShapeUniforms?"outShape":this.outputShape[0];return"getA(rc), (rc + 1 >= ".concat(t," ? 0. : getA(rc + 1)), 0, 0")}return"getA(".concat(e[0],"),\n            cEdge ? 0. : getA(").concat(e[1],"),\n            rEdge ? 0. : getA(").concat(e[2],"),\n            rEdge || cEdge ? 0. : getA(").concat(e[3],")")}}class P1{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=t,this.enableShapeUniforms=XQ(this.outputShape.length);let n="";for(let r=0;r<4;r++){let t="thisRC = rc;";r%2===1&&(t+="thisRC.z += 1;"),r>1&&(t+="thisRC.y += 1;"),n+="\n        ".concat(t,"\n        ").concat(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"","\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[").concat(r,"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ").concat(r>0?"}":"","\n      ")}this.userCode="\n      ".concat(function(t,e){const n=e?CQ(["r","c","d"],"inputShape"):EQ(["r","c","d"],t);return"\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ".concat(n,"\n      return ivec3(r, c, d);\n    }\n  ")}(e,this.enableShapeUniforms),"\n      ").concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":AQ(t),"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ").concat(this.enableShapeUniforms?"outShape[1]":t[1],";\n        int cols = ").concat(this.enableShapeUniforms?"outShape[2]":t[2],";\n\n        ").concat(n,"\n\n        setOutput(result);\n      }\n    ")}}class N1{constructor(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(t,e,n){const r=D1(e,n),i=L1(t,r,n);i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]);const o=O1(t,r,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=o,this.log();const t=this.freeTextures[i].pop();return this.usedTextures[i].push(t),t}let a;return r===XJ.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):r===XJ.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):r===XJ.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):r===XJ.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):r===XJ.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[i].push(a),this.numUsedTextures++,this._numBytesAllocated+=o,this.log(),a}releaseTexture(t,e,n,r){if(null==this.freeTextures)return;const i=D1(n,r),o=L1(e,i,r);o in this.freeTextures||(this.freeTextures[o]=[]);const a=O1(e,i,this.gpgpu.gl,this.gpgpu.textureConfig,r),s=FD().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");-1!==s&&this._numBytesAllocated>s?(this.gpgpu.deleteMatrixTexture(t.texture),this._numBytesAllocated-=a):(this.freeTextures[o].push(t),this.numFreeTextures++,this._numBytesFree+=a),this.numUsedTextures--;const l=this.usedTextures[o],c=l&&l.indexOf(t);if(null==c||c<0)throw new Error("Cannot release a texture that was never provided by this texture manager");l[c]=l[l.length-1],l.pop(),this.log()}log(){if(!this.logEnabled)return;const t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used","".concat(this.numFreeTextures," / ").concat(this.numUsedTextures),"(".concat(t,")"));const e=this._numBytesFree/this._numBytesAllocated;console.log("Bytes allocated: ".concat(this._numBytesAllocated)),console.log("Bytes unused: ".concat(this._numBytesFree," (").concat(Math.round(100*e),"%)"))}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(null!=this.freeTextures){for(const t in this.freeTextures)this.freeTextures[t].forEach((t=>{this.gpgpu.deleteMatrixTexture(t.texture)}));for(const t in this.usedTextures)this.usedTextures[t].forEach((t=>{this.gpgpu.deleteMatrixTexture(t.texture)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function O1(t,e,n,r,i){const o=function(t,e){switch(t){case XJ.PACKED_2X2_FLOAT32:return l$(e);case XJ.PACKED_2X2_FLOAT16:return c$(e);case XJ.UNPACKED_FLOAT32:return o$(e);case XJ.UNPACKED_FLOAT16:return a$(e);case XJ.PACKED_4X1_UNSIGNED_BYTE:return s$(e);default:throw new Error("Unknown physical texture type ".concat(t))}}(e,r);let a;if(i){const[e,n]=ZJ(t[0],t[1]);a=e*n}else{const[e,n]=YJ(t[0],t[1]);a=e*n}const s=function(t,e){const n=t;if(e===n.R32F)return 4;if(e===n.R16F)return 2;if(e===n.RGBA32F)return 16;if(e===t.RGBA)return 16;if(e===n.RGBA16F)return 8;if(e===n.RGBA8)return 4;throw new Error("Unknown internal format ".concat(e))}(n,o);return a*s}function D1(t,e){if(t===qJ.UPLOAD)return XJ.PACKED_2X2_FLOAT32;if(t===qJ.RENDER||null==t)return function(t){return FD().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?XJ.PACKED_2X2_FLOAT32:XJ.UNPACKED_FLOAT32:t?XJ.PACKED_2X2_FLOAT16:XJ.UNPACKED_FLOAT16}(e);if(t===qJ.DOWNLOAD||t===qJ.PIXELS)return XJ.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type ".concat(t))}function L1(t,e,n){return"".concat(t[0],"_").concat(t[1],"_").concat(e,"_").concat(n)}class F1{constructor(t,e){this.variableNames=["A"],this.outputShape=t,this.enableShapeUniforms=XQ(this.outputShape.length),this.userCode="\n      float unaryOperation(float x) {\n        ".concat(e,"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")}}const U1="if (isnan(x)) return x;",B1="return x;",z1="return abs(x);";const j1="return (x >= 0.0) ? x : (exp(x) - 1.0);",V1=U1+"\n  return (x < 0.0) ? 0.0 : x;\n",W1=U1+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",G1="return x;",H1="return 1.0 / (1.0 + exp(-1.0 * x));",q1="return x;",X1="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",Y1="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",K1="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",Z1="return 1.0 / (1.0 + exp(-1.0 * x));";class J1{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.enableShapeUniforms=XQ(this.outputShape.length),this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        ".concat(e,"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")}}class Q1{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t,this.enableShapeUniforms=XQ(this.outputShape.length);const e=t.length,n=I1("rc",e),r=zQ(e),i=function(t,e){if(1===t)return"rc";let n="";for(let r=0;r<t;r++)n+=e[r],r<t-1&&(n+=",");return n}(e,n),o=n.slice(-2),a=e<=1?"rc":"vec2(".concat(o.join(","),")");this.userCode="\n      void main() {\n        ".concat(r," rc = getOutputCoords();\n        vec4 packedInput = getA(").concat(i,");\n\n        setOutput(getChannel(packedInput, ").concat(a,"));\n      }\n    ")}}const $1=Tq,t2={};const e2=FD().getNumber("CPU_HANDOFF_SIZE_THRESHOLD");class n2 extends eD{nextDataId(){return n2.nextDataId++}constructor(t){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!FD().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let e;if(null!=t){if(t instanceof h$)e=t;else{const n=GJ(FD().getNumber("WEBGL_VERSION"),t);e=new h$(n)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const t=GJ(FD().getNumber("WEBGL_VERSION"));e=new h$(t),this.binaryCache=((n=FD().getNumber("WEBGL_VERSION"))in t2||(t2[n]={}),t2[n]),this.gpgpuCreatedLocally=!0}var n;this.gpgpu=e,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new N1(this.gpgpu),this.numMBBeforeWarning=null==FD().global.screen?1024:FD().global.screen.height*FD().global.screen.width*window.devicePixelRatio*600/1024/1024,this.texData=new tD(this,rz())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(t,e,n,r,i,o){const a=this.makeTensorInfo(e,n),s=this.texData.get(a.dataId);s.isPacked=!1,s.texture={texture:t,texShape:[r,i]},s.texShape=[r,i];const l=pQ(e),c=new $Q(l,!1,o),u=this.runWebGLProgram(c,[a],n,[[r,i]]);return u.shape=e,s.texture=null,this.disposeIntermediateTensorInfo(a),u.dataId}write(t,e,n){if((FD().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||FD().getBool("DEBUG"))&&this.checkNumericalProblems(t),"complex64"===n&&null!=t)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const r={id:this.nextDataId()};return this.texData.set(r,{shape:e,dtype:n,values:t,usage:qJ.UPLOAD,refCount:1}),r}refCount(t){if(this.texData.has(t)){return this.texData.get(t).refCount}return 0}incRef(t){this.texData.get(t).refCount++}decRef(t){if(this.texData.has(t)){this.texData.get(t).refCount--}}move(t,e,n,r,i){if(FD().getBool("DEBUG")&&this.checkNumericalProblems(e),"complex64"===r)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(t,{shape:n,dtype:r,values:e,usage:qJ.UPLOAD,refCount:i})}disposeIntermediateTensorInfo(t){this.disposeData(t.dataId)}readSync(t){const e=this.texData.get(t),{values:n,dtype:r,complexTensorInfos:i,slice:o,shape:a,isPacked:s}=e;if(null!=o){let e;e=s?new J1(a,G1):new F1(a,G1);const n=this.runWebGLProgram(e,[{dataId:t,shape:a,dtype:r}],r),i=this.readSync(n.dataId);return this.disposeIntermediateTensorInfo(n),i}if(null!=n)return this.convertAndCacheOnCPU(t);if("string"===r)return n;const l=null!=this.activeTimers;let c,u;if(l&&(c=$U()),"complex64"===r){u=vY(this.readSync(i.real.dataId),this.readSync(i.imag.dataId))}else u=this.getValuesFromTexture(t);return l&&(this.downloadWaitMs+=$U()-c),this.convertAndCacheOnCPU(t,u)}async read(t){if(this.pendingRead.has(t)){const e=this.pendingRead.get(t);return new Promise((t=>e.push(t)))}const e=this.texData.get(t),{values:n,shape:r,slice:i,dtype:o,complexTensorInfos:a,isPacked:s}=e;if(null!=i){let e;e=s?new J1(r,G1):new F1(r,G1);const n=this.runWebGLProgram(e,[{dataId:t,shape:r,dtype:o}],o),i=this.read(n.dataId);return this.disposeIntermediateTensorInfo(n),i}if(null!=n)return this.convertAndCacheOnCPU(t);if(FD().getBool("DEBUG")&&!FD().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===FD().getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let l,c,u=null;if("complex64"!==o&&FD().get("WEBGL_BUFFER_SUPPORTED")){l=this.decode(t);const e=this.texData.get(l.dataId);u=this.gpgpu.createBufferFromTexture(e.texture.texture,...KJ(r))}if(this.pendingRead.set(t,[]),"complex64"!==o&&await this.gpgpu.createAndWaitForFence(),"complex64"===o){const t=await Promise.all([this.read(a.real.dataId),this.read(a.imag.dataId)]);c=vY(t[0],t[1])}else if(null==u)c=this.getValuesFromTexture(t);else{const t=cD(r);c=this.gpgpu.downloadFloat32MatrixFromBuffer(u,t)}if(null!=l&&this.disposeIntermediateTensorInfo(l),null!=u){const t=this.gpgpu.gl;QJ(t,(()=>t.deleteBuffer(u)))}const h=this.convertAndCacheOnCPU(t,c),d=this.pendingRead.get(t);return this.pendingRead.delete(t),d.forEach((t=>t(h))),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t)&&rz().removeDataId(t,this),this.pendingDeletes--),h}readToGPU(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=this.texData.get(t),{values:r,shape:i,slice:o,dtype:a,isPacked:s,texture:l}=n;if("complex64"===a)throw new Error("Does not support reading texture for complex64 dtype.");if(null!=o){let n;n=s?new J1(i,G1):new F1(i,G1);const r=this.runWebGLProgram(n,[{dataId:t,shape:i,dtype:a}],a),o=this.readToGPU(r,e);return this.disposeIntermediateTensorInfo(r),o}if(null==l)throw null!=r?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const c=this.decode(t,e.customTexShape),u=rz().makeTensorFromTensorInfo(c),h=this.texData.get(c.dataId);return Object.assign({tensorRef:u},h.texture)}bufferSync(t){const e=this.readSync(t.dataId);if("string"===t.dtype)try{const n=e.map((t=>eB(t)));return cj(t.shape,t.dtype,n)}catch(XC){throw new Error("Failed to decode encoded string bytes into utf-8")}return cj(t.shape,t.dtype,e)}checkNumericalProblems(t){if(null!=t)for(let e=0;e<t.length;e++){const n=t[e];if(!$J(n)){if(FD().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error("The value ".concat(n," cannot be represented with your ")+"current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'");throw Error("The value ".concat(n," cannot be represented on this device."))}}}getValuesFromTexture(t){const{shape:e,dtype:n,isPacked:r}=this.texData.get(t),i=cD(e);if(FD().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const n=this.decode(t),r=this.texData.get(n.dataId),o=this.gpgpu.downloadMatrixFromPackedTexture(r.texture.texture,...KJ(e)).subarray(0,i);return this.disposeIntermediateTensorInfo(n),o}const o=FD().getBool("WEBGL_PACK")&&!0===r,a=o?pQ(e):e,s=o?new JQ(a):new ZQ(a),l=this.runWebGLProgram(s,[{shape:a,dtype:n,dataId:t}],"float32"),c=this.texData.get(l.dataId),u=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(c.texture.texture,c.texShape[0],c.texShape[1]).subarray(0,i);return this.disposeIntermediateTensorInfo(l),u}timerAvailable(){return FD().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(t){const e=this.activeTimers,n=[];let r=!1;null==this.programTimersStack?(this.programTimersStack=n,r=!0):this.activeTimers.push(n),this.activeTimers=n,t();const i=rB(this.activeTimers.map((t=>t.query))).filter((t=>null!=t)),o=rB(this.activeTimers.map((t=>t.name))).filter((t=>null!=t));this.activeTimers=e,r&&(this.programTimersStack=null);const a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(FD().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const t=await Promise.all(i);a.kernelMs=function(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e}(t),a.getExtraProfileInfo=()=>t.map(((t,e)=>({name:o[e],ms:t}))).map((t=>"".concat(t.name,": ").concat(t.ms))).join(", ")}else a.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,a})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return FD().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:$U(),endMs:null}}endTimer(t){return FD().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),t):(t.endMs=$U(),t)}async getQueryTime(t){if(FD().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(t);const e=t;return e.endMs-e.startMs}disposeData(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.pendingDisposal.has(t))return!1;if(!this.texData.has(t))return!0;if(e?this.texData.get(t).refCount=0:this.texData.get(t).refCount--,!e&&this.texData.get(t).refCount>0)return!1;if(this.pendingRead.has(t))return this.pendingDisposal.add(t),this.pendingDeletes++,!1;this.releaseGPUData(t);const{complexTensorInfos:n}=this.texData.get(t);return null!=n&&(this.disposeData(n.real.dataId,e),this.disposeData(n.imag.dataId,e)),this.texData.delete(t),!0}releaseGPUData(t){const{texture:e,dtype:n,texShape:r,usage:i,isPacked:o,slice:a}=this.texData.get(t),s=a&&a.origDataId||t,l=this.dataRefCount.get(s);l>1?this.dataRefCount.set(s,l-1):(this.dataRefCount.delete(s),null!=e&&(this.numBytesInGPU-=this.computeBytes(r,n),this.textureManager.releaseTexture(e,r,i,o)));const c=this.texData.get(t);c.texture=null,c.texShape=null,c.isPacked=!1,c.slice=null}getTexture(t){return this.uploadToGPU(t),this.texData.get(t).texture.texture}getDataInfo(t){return this.texData.get(t)}shouldExecuteOnCPU(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e2;return FD().getBool("WEBGL_CPU_FORWARD")&&t.every((t=>null==this.texData.get(t.dataId).texture&&cD(t.shape)<e))}getGPGPUContext(){return this.gpgpu}where(t){CU("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const e=t.dataSync();return $1(t.shape,e)}packedUnaryOp(t,e,n){const r=new J1(t.shape,e),i=this.compileAndRun(r,[t],n);return rz().makeTensorFromTensorInfo(i)}abs(t){if(this.shouldExecuteOnCPU([t])&&"complex64"!==t.dtype){const e=p1(this.texData.get(t.dataId).values);return this.makeOutput(t.shape,t.dtype,e)}if(FD().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,z1,t.dtype);const e=new F1(t.shape,z1),n=this.compileAndRun(e,[t]);return rz().makeTensorFromTensorInfo(n)}makeTensorInfo(t,e,n){let r;if("string"===e&&null!=n&&n.length>0&&_D(n[0])){const i=n.map((t=>tB(t)));r=this.write(i,t,e)}else r=this.write(n,t,e);return this.texData.get(r).usage=null,{dataId:r,shape:t,dtype:e}}makeOutput(t,e,n){return rz().makeTensorFromTensorInfo(this.makeTensorInfo(t,e,n),this)}unpackTensor(t){const e=new Q1(t.shape);return this.runWebGLProgram(e,[t],t.dtype)}packTensor(t){const e=new R1(t.shape);return this.runWebGLProgram(e,[t],t.dtype,null,!0)}packedReshape(t,e){const n=[hQ(t.shape),...dQ(t.shape)],r={dtype:t.dtype,shape:n,dataId:t.dataId},i=[hQ(e),...dQ(e)],o=new P1(i,n),a=[n],s=this.runWebGLProgram(o,[r],t.dtype,a,!0);return{dataId:s.dataId,shape:e,dtype:s.dtype}}decode(t,e){const n=this.texData.get(t),{isPacked:r,shape:i,dtype:o}=n;if(null!=e){aD(cD(i)<=e[0]*e[1]*4,(()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data."))}const a=pQ(i);let s;s=r?new KQ(a):new YQ(a);const l=[null!=e?e:KJ(a)];return{dtype:o,shape:i,dataId:this.runWebGLProgram(s,[{shape:a,dtype:o,dataId:t}],o,l,!0,e).dataId}}runWebGLProgram(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5?arguments[5]:void 0;const a=this.makeTensorInfo(t.outputShape,n),s=this.texData.get(a.dataId);if(t.packedOutput&&(s.isPacked=!0),t.outPackingScheme===HJ.DENSE){const e=null!=o?o:KJ(t.outputShape);s.texShape=e.map((t=>2*t))}if(null!=t.outTexUsage&&(s.usage=t.outTexUsage),0===cD(a.shape))return s.values=yD(a.dtype,0),a;const l=[],c=e.map((e=>{if("complex64"===e.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let n=this.texData.get(e.dataId);if(null==n.texture){if(!t.packedInputs&&cD(e.shape)<=FD().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:e.shape,texData:null,isUniform:!0,uniformValues:n.values};t.packedInputs&&(n.isPacked=!0,n.shape=e.shape)}if(this.uploadToGPU(e.dataId),!!n.isPacked!==!!t.packedInputs)e=n.isPacked?this.unpackTensor(e):this.packTensor(e),l.push(e),n=this.texData.get(e.dataId);else if(n.isPacked&&!mQ(n.shape,e.shape)){const t=e,r=e.shape;e.shape=n.shape,e=this.packedReshape(e,r),l.push(e),n=this.texData.get(e.dataId),t.shape=r}return{shape:e.shape,texData:n,isUniform:!1}}));this.uploadToGPU(a.dataId);const u={shape:a.shape,texData:s,isUniform:!1},h=function(t,e,n){let r="";e.concat(n).forEach((e=>{const i=null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0;if(t.enableShapeUniforms&&!e.isUniform){const o=e.texData.texShape,{useSqueezeShape:a,uniformShape:s,keptDims:l}=jQ(t.packedInputs,e.shape,o);let c="",u="",h="";if(1===s.length&&t.packedInputs){const t=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];c="".concat(t[0]>1,"_").concat(t[1]>1)}else if(2!==s.length||t.packedInputs){if(s.length>2&&!t.packedInputs){const t=ED(s);h="".concat(t[0]===o[1],"_").concat(t[t.length-1]===o[1])}}else u="".concat(s[0]>1,"_").concat(s[1]>1);const d=e.shape.length,p=2===s.length&&uD(e.shape,o),f=1===cD(e.shape),m=Pj(e.shape,n.shape),g=!t.packedInputs&&d===n.shape.length&&uD(o,n.texData.texShape),y=t.packedInputs||s.length>2?"":"".concat(o[0]>1,"_").concat(o[1]>1);r+="".concat(d,"_").concat(g,"_").concat(a?l:"","_").concat(s.length,"_").concat(f,"_").concat(m,"_").concat(p,"_").concat(c,"_").concat(u,"_").concat(h,"_").concat(y,"_").concat(i)}else{const t=e.isUniform?"uniform":e.texData.texShape;r+="".concat(e.shape,"_").concat(t,"_").concat(i)}}));const i=t.userCode;let o=t.constructor.name;return o+="_"+r+"_"+i+"".concat(FD().getNumber("WEBGL_VERSION")),o}(t,c,u),d=this.getAndSaveBinary(h,(()=>GQ(this.gpgpu,t,c,u))),p=null!=this.activeTimers;let f;p&&(f=this.startTimer()),FD().get("ENGINE_COMPILE_ONLY")||function(t,e,n,r,i){e.program.enableShapeUniforms||(qQ(e.inShapeInfos,n),qQ([e.outShapeInfo],[r]));const o=r.texData.texture,a=r.texData.texShape;r.texData.isPacked?t.setOutputPackedMatrixTexture(o.texture,a[0],a[1]):t.setOutputMatrixTexture(o.texture,a[0],a[1]),t.setProgram(e.webGLProgram),t.bindVertexArray(e.webGLProgram.vao),1===FD().getNumber("WEBGL_VERSION")&&null!==e.infLoc&&t.gl.uniform1f(e.infLoc,1/0),null!==e.nanLoc&&t.gl.uniform1f(e.nanLoc,NaN);for(let l=0;l<n.length;++l){const r=n[l],{uniform:i,offset:o,shape:a,texShape:s}=e.variablesLocations[l];if(a){const{uniformShape:n}=jQ(e.program.packedInputs,r.shape,r.texData.texShape);switch(n.length){case 1:t.gl.uniform1iv(a,new Int32Array(n));break;case 2:t.gl.uniform2iv(a,new Int32Array(n));break;case 3:t.gl.uniform3iv(a,new Int32Array(n));break;case 4:t.gl.uniform4iv(a,new Int32Array(n))}}if(s&&t.gl.uniform2i(s,r.texData.texShape[0],r.texData.texShape[1]),null!=i)if(r.isUniform)if(cD(r.shape)<2)t.gl.uniform1f(i,r.uniformValues[0]);else{let e=r.uniformValues;e instanceof Float32Array||(e=new Float32Array(e)),t.gl.uniform1fv(i,e)}else null!=r.texData.slice&&null!=o&&t.gl.uniform1i(o,r.texData.slice.flatOffset),t.setInputMatrixTexture(r.texData.texture.texture,i,l)}const s=e.outShapeLocation;if(s)switch(r.shape.length){case 1:t.gl.uniform1iv(s,new Int32Array(r.shape));break;case 2:t.gl.uniform2iv(s,new Int32Array(r.shape));break;case 3:t.gl.uniform3iv(s,new Int32Array(r.shape));break;case 4:t.gl.uniform4iv(s,new Int32Array(r.shape))}if(e.outShapeStridesLocation){const n=ED(r.shape);switch(r.shape.length){case 2:t.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(n));break;case 3:t.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(n));break;case 4:t.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(n))}}if(e.outTexShapeLocation&&t.gl.uniform2i(e.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),e.program.customUniforms&&i)for(let l=0;l<e.program.customUniforms.length;++l){const n=e.program.customUniforms[l],r=e.customUniformLocations[l],o=i[l];if("float"===n.type)t.gl.uniform1fv(r,o);else if("vec2"===n.type)t.gl.uniform2fv(r,o);else if("vec3"===n.type)t.gl.uniform3fv(r,o);else if("vec4"===n.type)t.gl.uniform4fv(r,o);else if("int"===n.type)t.gl.uniform1iv(r,o);else if("ivec2"===n.type)t.gl.uniform2iv(r,o);else if("ivec3"===n.type)t.gl.uniform3iv(r,o);else{if("ivec4"!==n.type)throw Error("uniform type ".concat(n.type," is not supported yet."));t.gl.uniform4iv(r,o)}}t.executeProgram()}(this.gpgpu,d,c,u,r),l.forEach((t=>this.disposeIntermediateTensorInfo(t))),p&&(f=this.endTimer(f),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(f)}));const m=FD().getNumber("WEBGL_FLUSH_THRESHOLD");if(m>0){const t=$U();t-this.lastGlFlushTime>m&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=t)}if(!FD().getBool("WEBGL_LAZILY_UNPACK")&&s.isPacked&&!1===i){const t=this.unpackTensor(a);return this.disposeIntermediateTensorInfo(a),t}return a}compileAndRun(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];n=n||e[0].dtype;return this.runWebGLProgram(t,e,n,r,i)}getAndSaveBinary(t,e){return t in this.binaryCache||(this.binaryCache[t]=e()),this.binaryCache[t]}getTextureManager(){return this.textureManager}dispose(){if(!this.disposed){if(!FD().getBool("IS_TEST")){Object.keys(this.binaryCache).forEach((t=>{this.gpgpu.deleteProgram(this.binaryCache[t].webGLProgram),delete this.binaryCache[t]}))}this.textureManager.dispose(),null!=this.canvas&&"undefined"!==typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0}}floatPrecision(){return null==this.floatPrecisionValue&&(this.floatPrecisionValue=iz((()=>{if(!FD().get("WEBGL_RENDER_FLOAT32_ENABLED")){const t=FD().getBool("DEBUG");FD().set("DEBUG",!1);const e=this.abs(_j(1e-8)).dataSync()[0];if(FD().set("DEBUG",t),e>0)return 32}return 16}))),this.floatPrecisionValue}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}uploadToGPU(t){const e=this.texData.get(t),{shape:n,dtype:r,values:i,texture:o,usage:a,isPacked:s}=e;if(null!=o)return;const l=null!=this.activeTimers;let c;l&&(c=$U());let u=e.texShape;if(null==u&&(u=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=FD().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=FD().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");if(r===1/0&&FD().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=n/2),e&&(n*=2,r*=2,t=t.map(((e,n)=>n>=t.length-2?iD(t[n]):t[n])),1===t.length&&(t=[2,t[0]])),2!==t.length){const e=gD(t);t=e.newShape}let i=cD(t),o=null;t.length<=1&&i<=n?o=[1,i]:2===t.length&&t[0]<=n&&t[1]<=n?o=t:3===t.length&&t[0]*t[1]<=n&&t[2]<=n?o=[t[0]*t[1],t[2]]:3===t.length&&t[0]<=n&&t[1]*t[2]<=n?o=[t[0],t[1]*t[2]]:4===t.length&&t[0]*t[1]*t[2]<=n&&t[3]<=n?o=[t[0]*t[1]*t[2],t[3]]:4===t.length&&t[0]<=n&&t[1]*t[2]*t[3]<=n&&(o=[t[0],t[1]*t[2]*t[3]]);const a=null!=o&&Math.max(...o)>r&&Math.min(...o)<=(e?2:1)&&Math.min(...o)>0;if(null==o||a)if(e){const e=hQ(t);let n=2,r=2;t.length&&([n,r]=dQ(t)),i=e*(n/2)*(r/2),o=dD(i).map((t=>2*t))}else o=dD(i);return o}(n,s),e.texShape=u),null!=i){const t=pQ(n);let o,a=u[1],h=u[0];const d=i instanceof Uint8Array||i instanceof Uint8ClampedArray;!s&&d||([a,h]=ZJ(u[0],u[1])),o=s?new t$(t,d):new $Q(t,d);const p=d?[h,a]:u,f=this.makeTensorInfo(p,r),m=this.texData.get(f.dataId);m.usage=d?qJ.PIXELS:qJ.UPLOAD,m.texShape=p,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(f.dataId),a,h,i);const g=[[h,a]],y=!0,v=this.runWebGLProgram(o,[f],r,g,y),b=this.texData.get(v.dataId);e.texShape=b.texShape,e.isPacked=b.isPacked,e.usage=b.usage,FD().get("ENGINE_COMPILE_ONLY")?this.disposeData(v.dataId):(e.texture=b.texture,e.values=null,this.texData.delete(v.dataId)),this.disposeIntermediateTensorInfo(f),l&&(this.uploadWaitMs+=$U()-c)}else{const t=this.acquireTexture(u,a,r,s);e.texture=t}}convertAndCacheOnCPU(t,e){const n=this.texData.get(t),{dtype:r}=n;return null!=e&&(n.values=function(t,e){if("float32"===e||"complex64"===e)return t;if("int32"===e||"bool"===e){const n="int32"===e?new Int32Array(t.length):new Uint8Array(t.length);for(let e=0;e<n.length;++e)n[e]=Math.round(t[e]);return n}throw new Error("Unknown dtype ".concat(e))}(e,r)),n.values}acquireTexture(t,e,n,r){if(this.numBytesInGPU+=this.computeBytes(t,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){const t=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: ".concat(t," MB, ")+"most likely due to a memory leak")}return this.textureManager.acquireTexture(t,e,r)}computeBytes(t,e){return t[0]*t[1]*xD(e)}checkCompileCompletion(){for(const[,t]of Object.entries(this.binaryCache))this.checkCompletion_(t)}async checkCompileCompletionAsync(){const t=[];if(this.gpgpu.parallelCompilationExtension){for(const[,e]of Object.entries(this.binaryCache))t.push(this.checkCompletionAsync_(e));return Promise.all(t)}for(const[,e]of Object.entries(this.binaryCache)){const n=new Promise((t=>{try{this.checkCompletion_(e),t(!0)}catch(oA){throw oA}}));t.push(n)}return Promise.all(t)}async checkCompletionAsync_(t){return this.gpgpu.gl.getProgramParameter(t.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(t):(await new Promise((t=>XX((()=>t())))),this.checkCompletionAsync_(t))}checkCompletion_(t){if(!1===this.gpgpu.gl.getProgramParameter(t.webGLProgram,this.gpgpu.gl.LINK_STATUS)){if(console.log(this.gpgpu.gl.getProgramInfoLog(t.webGLProgram)),!1===this.gpgpu.gl.getShaderParameter(t.fragmentShader,this.gpgpu.gl.COMPILE_STATUS))throw nQ(t.source,this.gpgpu.gl.getShaderInfoLog(t.fragmentShader)),new Error("Failed to compile fragment shader.");throw new Error("Failed to link vertex and fragment shaders.")}return!0}getUniformLocations(){for(const t of Object.values(this.binaryCache)){this.gpgpu.buildVao(t.webGLProgram);const{variablesLocations:e,customUniformLocations:n,infLoc:r,nanLoc:i,outShapeLocation:o,outShapeStridesLocation:a,outTexShapeLocation:s}=HQ(this.gpgpu,t.program,t.webGLProgram);t.variablesLocations=e,t.customUniformLocations=n,t.infLoc=r,t.nanLoc=i,t.outShapeLocation=o,t.outShapeStridesLocation=a,t.outTexShapeLocation=s}}createTensorFromGPUData(t,e,n){t.channels=t.channels||"RGBA";const{texture:r,height:i,width:o,channels:a}=t,s=rz().backend;if(!s.gpgpu.gl.isTexture(r))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const l=s.writeTexture(r,e,n,i,o,a);return rz().makeTensorFromDataId(l,e,n,s)}}n2.nextDataId=0,WB()&&function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;BB.registerBackend(t,e,n)}("webgl",(()=>new n2),2);const r2="\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n";class i2{constructor(t,e,n){this.variableNames=["A","B"],this.outputShape=Oj(e,n),this.enableShapeUniforms=XQ(this.outputShape.length),this.userCode="\n      float binaryOperation(float a, float b) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    ")}}const o2="\n  result.r = isNaN.r ? NAN : result.r;\n  result.g = isNaN.g ? NAN : result.g;\n  result.b = isNaN.b ? NAN : result.b;\n  result.a = isNaN.a ? NAN : result.a;\n";class a2{constructor(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Oj(e,n);const i=this.outputShape.length;this.enableShapeUniforms=XQ(i);let o="";if(r)if(0===i||1===cD(this.outputShape))o="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else{const t=zQ(i);if(o="\n          ".concat(t," coords = getOutputCoords();\n        "),1===i)this.enableShapeUniforms?o+="\n            result.y = (coords + 1) >= outShape ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ":o+="\n            result.y = (coords + 1) >= ".concat(this.outputShape[0]," ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ");else{const t=I1("coords",i);this.enableShapeUniforms?o+="\n            bool nextRowOutOfBounds =\n              (".concat(t[i-2]," + 1) >= outShape[").concat(i," - 2];\n            bool nextColOutOfBounds =\n              (").concat(t[i-1]," + 1) >= outShape[").concat(i," - 1];\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          "):o+="\n            bool nextRowOutOfBounds =\n              (".concat(t[i-2]," + 1) >= ").concat(this.outputShape[i-2],";\n            bool nextColOutOfBounds =\n              (").concat(t[i-1]," + 1) >= ").concat(this.outputShape[i-1],";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          ")}}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ".concat(t,"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ").concat(o,"\n\n        setOutput(result);\n      }\n    ")}}function s2(t){const{inputs:e,backend:n}=t,{x:r}=e;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const l2={kernelName:HL,backendName:"webgl",kernelFunc:s2};function c2(t){const{inputs:e,backend:n}=t,{real:r,imag:i}=e,o=n.makeTensorInfo(r.shape,"complex64"),a=n.texData.get(o.dataId),s=s2({inputs:{x:r},backend:n}),l=s2({inputs:{x:i},backend:n});return a.complexTensorInfos={real:s,imag:l},o}const u2={kernelName:uL,backendName:"webgl",kernelFunc:c2},h2="return (a < 0.) ? b * a : a;",d2="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";const p2={kernelName:JL,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{alpha:o}=r,a=n.makeTensorInfo([],"float32",JU(o,"float32")),s=FD().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new a2(d2,i.shape,a.shape):new i2(h2,i.shape,a.shape),l=n.runWebGLProgram(s,[i,a],"float32");return n.disposeIntermediateTensorInfo(a),l}},f2="return (a < 0.) ? b * a : a;",m2="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";const g2={kernelName:TF,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{x:r,alpha:i}=e,o=FD().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new a2(m2,r.shape,i.shape):new i2(f2,r.shape,i.shape);return n.runWebGLProgram(o,[r,i],"float32")}},y2="if (isnan(x)) return x;";function v2(t){let{opSnippet:e,packedOpSnippet:n,cpuKernelImpl:r,dtype:i}=t;return t=>{let{inputs:o,backend:a}=t;const{x:s}=o,l=a,c=i||s.dtype;if(l.shouldExecuteOnCPU([s])&&null!=r){const t=l.texData.get(s.dataId),e=r(t.values,c);return l.makeTensorInfo(s.shape,c,e)}let u;return u=FD().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&null!=n?new J1(s.shape,n):new F1(s.shape,e),l.runWebGLProgram(u,[s],c)}}function b2(t){let{opSnippet:e,packedOpSnippet:n,checkOutOfBounds:r=!1,supportsComplex:i=!1,cpuKernelImpl:o,dtype:a}=t;return t=>{let{inputs:s,backend:l}=t;const{a:c,b:u}=s,h=l;if(i&&"complex64"===c.dtype){const t=h.texData.get(c.dataId),n=h.texData.get(u.dataId),[r,i]=[[t.complexTensorInfos.real,n.complexTensorInfos.real],[t.complexTensorInfos.imag,n.complexTensorInfos.imag]].map((t=>{const[n,r]=t,i={dataId:n.dataId,dtype:n.dtype,shape:c.shape},o={dataId:r.dataId,dtype:r.dtype,shape:u.shape},a=new i2(e,c.shape,u.shape);return h.runWebGLProgram(a,[i,o],AB(n.dtype,r.dtype))})),o=c2({inputs:{real:r,imag:i},backend:h});return h.disposeIntermediateTensorInfo(r),h.disposeIntermediateTensorInfo(i),o}const d=a||AB(c.dtype,u.dtype);if(("string"===c.dtype||"string"===u.dtype||h.shouldExecuteOnCPU([c,u]))&&null!=o){const t=h.texData.get(c.dataId).values,e=h.texData.get(u.dataId).values,n="string"===c.dtype?QY(t):t,r="string"===c.dtype?QY(e):e,[i,a]=o(c.shape,u.shape,n,r,d),s=h.makeTensorInfo(a,d);return h.texData.get(s.dataId).values=i,s}let p;return p=FD().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&null!=n?new a2(n,c.shape,u.shape,r):new i2(e,c.shape,u.shape),h.runWebGLProgram(p,[c,u],d)}}function x2(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("linear"===t)return e?q1:B1;if("relu"===t)return e?Y1:V1;if("elu"===t)return e?X1:j1;if("relu6"===t)return e?K1:W1;if("prelu"===t)return e?m2:f2;if("leakyrelu"===t)return e?d2:h2;if("sigmoid"===t)return e?Z1:H1;throw new Error("Activation ".concat(t," has not been implemented for the WebGL backend."))}class _2{constructor(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]&&arguments[7],l=arguments.length>8&&void 0!==arguments[8]&&arguments[8];this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.enableShapeUniforms=XQ(this.outputShape.length);const c=r?t[1]:t[2],u=Math.ceil(c/2),h=r?"i * 2, rc.y":"rc.y, i * 2",d=i?"rc.z, i * 2":"i * 2, rc.z",p=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],f=i?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let m="",g="";a&&(m=s?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(a,"\n        }"):l?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(a,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(a,"\n        }"),g="result = activation(result);");const y=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),l&&this.variableNames.push("leakyreluAlpha");let v="rc.x",b="rc.x";t[0]<e[0]?v="imod(rc.x, ".concat(t[0],")"):e[0]<t[0]&&(b="imod(rc.x, ".concat(e[0],")")),this.userCode="\n      ".concat(m,"\n      // Don't use uniform for sharedDimensionPacked for performance.\n      const float sharedDimension = ").concat(u,".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        int batchA = ").concat(v,";\n        int batchB = ").concat(b,";\n        for (int i = 0; i < ").concat(u,"; i++) {\n          vec4 a = getMatrixA(batchA, ").concat(h,");\n          vec4 b = getMatrixB(batchB, ").concat(d,");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (").concat(p[0]," * ").concat(f[0],");\n          result += (").concat(p[1]," * ").concat(f[1],");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ").concat(y,"\n\n        ").concat(g,"\n\n        setOutput(result);\n      }\n    ")}}const w2={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class S2{constructor(t,e,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Oj(e,n),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    ")}}const T2="return a * b;";function E2(t){const{inputs:e,backend:n}=t,{a:r,b:i}=e,o=AB(r.dtype,i.dtype);if("complex64"===r.dtype){const t=n.texData.get(r.dataId),e=n.texData.get(i.dataId),o=new S2(w2.REAL,r.shape,i.shape),a=new S2(w2.IMAG,r.shape,i.shape),s=[{dataId:t.complexTensorInfos.real.dataId,dtype:t.complexTensorInfos.real.dtype,shape:r.shape},{dataId:t.complexTensorInfos.imag.dataId,dtype:t.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:e.complexTensorInfos.real.dataId,dtype:e.complexTensorInfos.real.dtype,shape:i.shape},{dataId:e.complexTensorInfos.imag.dataId,dtype:e.complexTensorInfos.imag.dtype,shape:i.shape}],l=n.runWebGLProgram(o,s,"float32"),c=n.runWebGLProgram(a,s,"float32"),u=c2({inputs:{real:l,imag:c},backend:n});return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(c),u}if(n.shouldExecuteOnCPU([r,i])){const t=n.texData.get(r.dataId),e=n.texData.get(i.dataId),[a,s]=n1(r.shape,i.shape,t.values,e.values,o),l=n.makeTensorInfo(s,o);return n.texData.get(l.dataId).values=a,l}let a;return a=FD().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new a2(T2,r.shape,i.shape):new i2(T2,r.shape,i.shape),n.runWebGLProgram(a,[r,i],o)}const M2={kernelName:fF,backendName:"webgl",kernelFunc:E2};function C2(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{shape:o}=r,a=n,s=cD(i.shape),l=function(t,e){let n=1,r=-1;for(let o=0;o<t.length;++o)if(t[o]>=0)n*=t[o];else if(-1===t[o]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. "+"Found -1 at dim ".concat(r," and dim ").concat(o));r=o}else if(t[o]<0)throw Error("Shapes can not be < 0. Found ".concat(t[o]," at dim ").concat(o));if(-1===r){if(e>0&&e!==n)throw Error("Size(".concat(e,") must match the product of shape ").concat(t));return t}if(0===n)throw Error("Cannot infer the missing size in [".concat(t,"] when ")+"there are 0 elements");if(e%n!==0)throw Error("The implicit shape can't be a fractional number. "+"Got ".concat(e," / ").concat(n));const i=t.slice();return i[r]=e/n,i}(o,s),c=cD(l);aD(s===c,(()=>"The new shape (".concat(l,") has ").concat(c," elements and the old ")+"shape (".concat(i.shape,") has ").concat(s," elements. The new shape and old ")+"shape must have the same number of elements."));const u=a.texData.get(i.dataId);return!u.isPacked||mQ(i.shape,l)||null!==u.texture&&mQ(u.shape,l)?(a.incRef(i.dataId),{dataId:i.dataId,shape:l,dtype:i.dtype}):function(t,e,n){const r=[hQ(t.shape),...dQ(t.shape)],i={dtype:t.dtype,shape:r,dataId:t.dataId},o=[hQ(e),...dQ(e)],a=new P1(o,r),s=[r],l=n.runWebGLProgram(a,[i],t.dtype,s,!0);return{dataId:l.dataId,shape:e,dtype:l.dtype}}(i,l,a)}const A2={kernelName:NF,backendName:"webgl",kernelFunc:C2};class k2{constructor(t,e){this.variableNames=["x"];const{windowSize:n,batchSize:r,inSize:i,outSize:o}=t;this.outputShape=[r,o];const a=4*Math.floor(n/4),s=n%4;let l="sumValue += dot(values, ones);";if(null!=e){const t=1/e;l="sumValue += dot(values * ".concat(hD(t)?t.toPrecision(2):t,", ones);")}let c="";i%n>0&&(c="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return 0.0;\n        }\n      ")),this.userCode="\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ".concat(c,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(n,";\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(a,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(l,"\n        }\n\n        int inIdx = inOffset + ").concat(a,";\n        if (").concat(1===s,") {\n          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);\n\n          ").concat(l,"\n        } else if (").concat(2===s,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1), 0.0, 0.0);\n\n          ").concat(l,"\n        } else if (").concat(3===s,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2), 0.0);\n\n          ").concat(l,"\n        }\n        setOutput(sumValue);\n      }\n    ")}}class I2{constructor(t,e){this.variableNames=["x"];const{windowSize:n,batchSize:r,inSize:i,outSize:o}=t;this.outputShape=[r,o];let a="0.0",s="";"prod"===e?a="1.0":"min"===e?(a="1.0 / 1e-20",s="min"):"max"===e&&(a="-1.0 / 1e-20",s="max");let l="".concat(e,"(").concat(e,"(").concat(e,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===e?l="sumValue":"prod"===e?l="prodValue":"all"===e?l="allValue":"any"===e&&(l="anyValue");const c=4*Math.floor(n/4),u=n%4;let h="\n      if (".concat("sum"===e,") {\n        sumValue += dot(values, ones);\n      } else if (").concat("prod"===e,") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ").concat(s,"(values, minMaxValue);\n        if (").concat("min"===e," || ").concat("max"===e,") {\n          minMaxValue = ").concat(s,"(values, minMaxValue);\n          bvec4 isNaN = isnan(values);\n          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {\n            minMaxValue = vec4(NAN);\n          }\n        }\n      }\n    "),d="vec4";"all"===e?(a="1.0",h="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",d="bvec4"):"any"===e&&(a="0.0",h="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",d="bvec4");let p="";i%n>0&&(p="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return initializationValue;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat(a,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ").concat(p,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(n,";\n\n        vec4 minMaxValue = vec4(").concat(a,");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ").concat(c,"; i += 4) {\n          int inIdx = inOffset + i;\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(h,"\n        }\n\n        int inIdx = inOffset + ").concat(c,";\n        if (").concat(1===u,") {\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(h,"\n        } else if (").concat(2===u,") {\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(h,"\n        } else if (").concat(3===u,") {\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ").concat(h,"\n        }\n        setOutput(").concat(l,");\n      }\n    ")}}function R2(t,e,n,r){const i=function(t){const e=[];for(;0===e.length||1!==e[e.length-1].outSize;){const n=e.length?e[e.length-1].outSize:t[1],r=nY(n);e.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return e}(t.shape);let o=t;for(let a=0;a<i.length;a++){const{inSize:s,windowSize:l,outSize:c}=i[a];let u,h;u="mean"===n?0===a?new k2({windowSize:l,inSize:s,batchSize:t.shape[0],outSize:c},s):new k2({windowSize:l,inSize:s,batchSize:t.shape[0],outSize:c}):new I2({windowSize:l,inSize:s,batchSize:t.shape[0],outSize:c},n),h=o,o=r.runWebGLProgram(u,[o],e),h.dataId!==t.dataId&&r.disposeIntermediateTensorInfo(h)}return o}class P2{constructor(t,e){this.variableNames=["A"];const n=new Array(t.length);for(let o=0;o<n.length;o++)n[o]=t[e[o]];this.outputShape=n,this.rank=n.length;const r=zQ(this.rank),i=function(t){const e=t.length;if(e>6)throw Error("Transpose for rank ".concat(e," is not yet supported"));const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(e);for(let i=0;i<t.length;i++)r[t[i]]=n[i];return r.join()}(e);this.userCode="\n    void main() {\n      ".concat(r," resRC = getOutputCoords();\n      setOutput(getA(").concat(i,"));\n    }\n    ")}}class N2{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const n=new Array(t.length);for(let c=0;c<n.length;c++)n[c]=t[e[c]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank ".concat(this.rank," is not yet supported."));const r=zQ(this.rank),i=k1("rc",this.rank),o=new Array(this.rank);for(let c=0;c<e.length;c++)o[e[c]]=i[c];const a="vec2(".concat(o.slice(-2).join(),")"),s="++".concat(i[this.rank-1]," < ").concat(n[this.rank-1]),l="getChannel(getA(".concat(o.join(),"), ").concat(a,")");this.userCode="\n    void main() {\n      ".concat(r," rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ").concat(l,";\n      if(").concat(s,") {\n        result[1] = ").concat(l,";\n      }\n      --").concat(i[this.rank-1],";\n      if(++").concat(i[this.rank-2]," < ").concat(n[this.rank-2],") {\n        result[2] = ").concat(l,";\n        if(").concat(s,") {\n          result[3] = ").concat(l,";\n        }\n      }\n      setOutput(result);\n    }\n    ")}}function O2(t,e,n){const r=FD().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new N2(t.shape,e):new P2(t.shape,e);return n.runWebGLProgram(r,[t],t.dtype)}function D2(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:o,keepDims:a}=r;return function(t,e,n,r){const i=e,o=t.shape.length,a=mD(i,t.shape);let s=a;const l=nG(s,o),c=null!=l;let u=t;c&&(u=O2(t,l,r),s=iG(s.length,o)),eG("sum",s,o);const[h,d]=$W(u.shape,s);let p=h;n&&(p=tG(h,a));const f=cD(d),m=C2({inputs:{x:u},attrs:{shape:[cD(t.shape)/f,f]},backend:r}),g=R2(m,kB(t.dtype),"sum",r),y=C2({inputs:{x:g},attrs:{shape:p},backend:r});return r.disposeIntermediateTensorInfo(m),r.disposeIntermediateTensorInfo(g),c&&r.disposeIntermediateTensorInfo(u),y}(i,o,a,n)}const L2={kernelName:"Sum",backendName:"webgl",kernelFunc:D2};function F2(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{perm:o}=r,a=n,s=i.shape.length,l=new Array(s);for(let u=0;u<l.length;u++)l[u]=i.shape[o[u]];let c;if(a.shouldExecuteOnCPU([i])){const t=a.texData.get(i.dataId).values,e=C1(t,i.shape,i.dtype,o,l);c=a.makeTensorInfo(l,i.dtype);a.texData.get(c.dataId).values=e}else c=O2(i,o,a);return c}const U2={kernelName:gU,backendName:"webgl",kernelFunc:F2},B2=1e3;function z2(t){let{a:e,b:n,transposeA:r,transposeB:i,backend:o,bias:a=null,preluActivationWeights:s=null,leakyreluAlpha:l=0,activation:c=null}=t;const u=e.shape.length,h=n.shape.length,d=r?e.shape[u-2]:e.shape[u-1],p=i?n.shape[h-1]:n.shape[h-2],f=r?e.shape[u-1]:e.shape[u-2],m=i?n.shape[h-2]:n.shape[h-1],g=e.shape.slice(0,-2),y=n.shape.slice(0,-2),v=cD(g),b=cD(y),x=Oj(e.shape.slice(0,-2),n.shape.slice(0,-2)).concat([f,m]);aD(d===p,(()=>"Error in matMul: inner shapes (".concat(d,") and (")+"".concat(p,") of Tensors with shapes ").concat(e.shape," and ")+"".concat(n.shape," and transposeA=").concat(r)+" and transposeB=".concat(i," must match.")));const _=r?[v,d,f]:[v,f,d],w=i?[b,m,p]:[b,p,m],S=C2({inputs:{x:e},backend:o,attrs:{shape:_}}),T=C2({inputs:{x:n},backend:o,attrs:{shape:w}}),E=[S,T],M=Math.max(v,b),C=r?S.shape[1]:S.shape[2],A=null!=a,k=null!=s,I="leakyrelu"===c,R=null!=c?x2(c,!0):null;let P;if((1===f||1===m)&&C>B2&&!1===(A||k||I||null!=R)){let t=S,e=T;r&&(t=F2({inputs:{x:S},backend:o,attrs:{perm:[0,2,1]}}),E.push(t)),i&&(e=F2({inputs:{x:T},backend:o,attrs:{perm:[0,2,1]}}),E.push(e));const n=1===m;let a=t;1!==m&&(a=C2({inputs:{x:t},backend:o,attrs:{shape:[M,C,1]}}),E.push(a));const s=1===m?2:1;let l=e;n&&(l=C2({inputs:{x:e},backend:o,attrs:{shape:[M,1,C]}}),E.push(l));const c=E2({inputs:{a:a,b:l},backend:o});P=D2({inputs:{x:c},backend:o,attrs:{axis:s,keepDims:!0}}),E.push(c)}else{const t=AB(e.dtype,n.dtype),c=new _2(_,w,[M,f,m],r,i,A,R,k,I),u=[S,T];if(null!=a&&u.push(a),k&&u.push(s),I){const t=o.makeTensorInfo([],"float32",JU(l,"float32"));u.push(t),E.push(t)}P=o.runWebGLProgram(c,u,t)}const N=C2({inputs:{x:P},backend:o,attrs:{shape:x}});E.push(P);for(const O of E)o.disposeIntermediateTensorInfo(O);return N}const j2={kernelName:TU,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{a:i,b:o,bias:a,preluActivationWeights:s}=e,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:h}=r;return z2({a:i,b:o,transposeA:l,transposeB:c,backend:n,bias:a,preluActivationWeights:s,leakyreluAlpha:h,activation:u})}},V2="return abs(x);";const W2={kernelName:VD,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])&&"complex64"!==r.dtype){const t=n.texData.get(r.dataId),e=p1(t.values);return n.makeTensorInfo(r.shape,r.dtype,e)}let i;return i=FD().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new J1(r.shape,V2):new F1(r.shape,V2),n.runWebGLProgram(i,[r],r.dtype)}},G2=v2({opSnippet:U1+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n"}),H2={kernelName:WD,backendName:"webgl",kernelFunc:G2},q2=v2({opSnippet:U1+"\n  if (x < 1.0) return NAN;\nreturn log(x + sqrt(x * x - 1.0));"}),X2={kernelName:GD,backendName:"webgl",kernelFunc:q2},Y2="return a + b;",K2=b2({opSnippet:Y2,packedOpSnippet:Y2,supportsComplex:!0,cpuKernelImpl:O0}),Z2={kernelName:HD,backendName:"webgl",kernelFunc:K2};class J2{constructor(t,e){this.outputShape=[],this.outputShape=t,this.variableNames=e.map(((t,e)=>"T".concat(e)));const n=[];this.variableNames.forEach((t=>{n.push("float v".concat(t," = get").concat(t,"AtOutCoords();"))}));const r=this.variableNames.map((t=>"v".concat(t))).join(" + ");this.userCode="\n      void main() {\n        ".concat(n.join("\n        "),"\n\n        float result = ").concat(r,";\n        setOutput(result);\n      }\n    ")}}class Q2{constructor(t,e){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=e.map(((t,e)=>"T".concat(e)));const n=[];this.variableNames.forEach((t=>{n.push("vec4 v".concat(t," = get").concat(t,"AtOutCoords();"))}));const r=this.variableNames.map((t=>"v".concat(t))).join(" + ");this.userCode="\n      void main() {\n        ".concat(n.join("\n        "),"\n\n        vec4 result = ").concat(r,";\n        setOutput(result);\n      }\n    ")}}const $2={kernelName:qD,backendName:"webgl",kernelFunc:function t(e){const{inputs:n,backend:r}=e,i=n;if(1===i.length)return s2({inputs:{x:i[0]},backend:r});if(i.length>FD().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const e=Math.floor(i.length/2),n=t({inputs:i.slice(0,e),backend:r}),o=t({inputs:i.slice(e),backend:r});return t({inputs:[n,o],backend:r})}const o=i.map((t=>t.dtype)).reduce(((t,e)=>AB(t,e))),a=i.map((t=>t.shape)),s=FD().getBool("WEBGL_PACK")?new Q2(i[0].shape,a):new J2(i[0].shape,a);return r.runWebGLProgram(s,i,o)}};const t3={kernelName:"All",backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:o,keepDims:a}=r,s=i.shape.length,l=mD(o,i.shape);let c=l;const u=nG(c,s);let h=i;null!=u&&(h=F2({inputs:{x:i},backend:n,attrs:{perm:u}}),c=iG(c.length,s)),eG("all",c,s);const[d,p]=$W(h.shape,c),f=C2({inputs:{x:h},backend:n,attrs:{shape:[-1,cD(p)]}}),m=R2(f,f.dtype,"all",n);let g;if(a){g=C2({inputs:{x:m},backend:n,attrs:{shape:tG(d,l)}})}else g=C2({inputs:{x:m},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),null!=u&&n.disposeIntermediateTensorInfo(h),g}};const e3={kernelName:"Any",backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:o,keepDims:a}=r,s=i.shape.length,l=mD(o,i.shape);let c=l;const u=nG(c,s);let h=i;null!=u&&(h=F2({inputs:{x:i},backend:n,attrs:{perm:u}}),c=iG(c.length,s)),eG("any",c,s);const[d,p]=$W(h.shape,c),f=C2({inputs:{x:h},backend:n,attrs:{shape:[-1,cD(p)]}}),m=R2(f,f.dtype,"any",n);let g;if(a){g=C2({inputs:{x:m},backend:n,attrs:{shape:tG(d,l)}})}else g=C2({inputs:{x:m},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),null!=u&&n.disposeIntermediateTensorInfo(h),g}};class n3{constructor(t,e,n){this.variableNames=["A"];const{windowSize:r,batchSize:i,outSize:o}=t;n||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o];const a="max"===e?">":"<",s=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ".concat(r,";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ").concat(r,"; i++) {\n          int inIdx = ").concat(s,";\n          float candidate = getA(batch, inIdx);\n          if (candidate ").concat(a," bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    ")}}class r3{constructor(t,e,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,aD(t.length>2,(()=>"Packed arg".concat(n.charAt(0).toUpperCase()+n.slice(1)," supports only inputs with rank above 2.")));const i=t[t.length-1],o=Math.ceil(i/e);this.outputShape=t.slice(0,-1),o>1&&this.outputShape.push(o),r||this.variableNames.push("bestIndicesA");const a=this.outputShape,s=a.length,l=zQ(s),c=I1("coords",s);let u,h;if(1===o){h=s+1;const t=zQ(h);u="\n        ".concat(t," sourceLocR = ").concat(t,"(").concat(c.join(),", 0);\n        ++").concat(c[s-1],";\n        ").concat(t," sourceLocG = ").concat(t,"(").concat(c.join(),", 0);\n        ++").concat(c[s-2],";\n        ").concat(t," sourceLocA = ").concat(t,"(").concat(c.join(),", 0);\n        --").concat(c[s-1],";\n        ").concat(t," sourceLocB = ").concat(t,"(").concat(c.join(),", 0);\n        --").concat(c[s-2],";")}else h=s,u="\n        ".concat(l," sourceLocR = coords;\n        ++").concat(c[s-1],";\n        ").concat(l," sourceLocG = coords;\n        ++").concat(c[s-2],";\n        ").concat(l," sourceLocA = coords;\n        --").concat(c[s-1],";\n        ").concat(l," sourceLocB = coords;\n        --").concat(c[s-2],";");const d=["x","y","z","w","u","v"].slice(0,h),p="."+d[h-1],f=d.map((t=>"int "+t)),m=I1("sourceLocR",h-1).concat("inIdx.r"),g=I1("sourceLocG",h-1).concat("inIdx.g"),y=I1("sourceLocB",h-1).concat("inIdx.b"),v=I1("sourceLocA",h-1).concat("inIdx.a"),b="max"===n?"greaterThan":"lessThan",x=r?"":"\n          inIdx = round(vec4(getBestIndicesAChannel(".concat(m.join(),"),\n                             getBestIndicesAChannel(").concat(g.join(),"),\n                             getBestIndicesAChannel(").concat(y.join(),"),\n                             getBestIndicesAChannel(").concat(v.join(),")));"),_="vec4(\n            getAChannel(".concat(m.join(),"),\n            hasNextCol ? getAChannel(").concat(g.join(),") : 0.,\n            hasNextRow ? getAChannel(").concat(y.join(),") : 0.,\n            hasNextRow && hasNextCol ? getAChannel(").concat(v.join(),") : 0.)"),w=r?"":"\n      float getBestIndicesAChannel(".concat(f.join(),") {\n        return getChannel(getBestIndicesA(").concat(d.join(),"),\n                                          vec2(").concat(d.slice(-2).join(),"));\n      }");this.userCode="\n      float getAChannel(".concat(f.join(),") {\n        return getChannel(getA(").concat(d.join(),"),\n                               vec2(").concat(d.slice(-2).join(),"));\n      }\n      ").concat(w,"\n      void main() {\n        ").concat(l," coords = getOutputCoords();\n        bool hasNextCol = ").concat(c[s-1]," < ").concat(a[s-1]-1,";\n        bool hasNextRow = ").concat(c[s-2]," < ").concat(a[s-2]-1,";\n        ").concat(u,"\n        ivec4 srcIdx = ivec4(sourceLocR").concat(p,", sourceLocG").concat(p,",\n          sourceLocB").concat(p,", sourceLocA").concat(p,") * ").concat(e,";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ").concat(_,";\n\n        for (int i = 0; i < ").concat(e,"; i++) {\n          inIdx = srcIdx;\n          ").concat(x,"\n          vec4 candidate = ").concat(_,";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(").concat(b,"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    ")}}function i3(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=e.shape[0],o=e.shape[1];null!=r&&(i=r.shape[0],o=r.shape[1]);const a=nY(o),s={windowSize:a,inSize:o,batchSize:i,outSize:Math.ceil(o/a)},l=new n3(s,n,null==r),c=[e];null!=r&&c.push(r);const u=t.runWebGLProgram(l,c,"int32");if(1===u.shape[1])return u;const h=i3(t,e,n,u);return t.disposeIntermediateTensorInfo(u),h}function o3(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const i=null!=r?r.shape:e.shape,o=nY(i[i.length-1]),a=new r3(i,o,n,null==r),s=null==r?[e]:[e,r],l=t.runWebGLProgram(a,s,"int32");if(l.shape.length===e.shape.length){const r=o3(t,e,n,l);return t.disposeIntermediateTensorInfo(l),r}return l}function a3(t,e,n,r){const i=[n];if(eG("arg"+r.charAt(0).toUpperCase()+r.slice(1),i,e.shape.length),!FD().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const n=[],o=t.texData.get(e.dataId);let a=e;null!==o&&o.isPacked&&(a=t.unpackTensor(e),n.push(a));const[s,l]=$W(a.shape,i),c=cD(l),u=C2({inputs:{x:a},backend:t,attrs:{shape:[-1,c]}});n.push(u);const h=i3(t,u,r);n.push(h);const d=C2({inputs:{x:h},backend:t,attrs:{shape:s}});return n.forEach((e=>t.disposeIntermediateTensorInfo(e))),d}return o3(t,e,r)}const s3={kernelName:XD,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:o}=r;let a=mD(o,i.shape);const s=nG(a,i.shape.length);let l=i;const c=[];null!=s&&(l=F2({inputs:{x:i},backend:n,attrs:{perm:s}}),c.push(l),a=iG(a.length,l.shape.length)),eG("argMax",[a[0]],l.shape.length);const u=a3(n,l,a[0],"max");return c.forEach((t=>n.disposeIntermediateTensorInfo(t))),u}};const l3={kernelName:YD,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:o}=r;let a=mD(o,i.shape);const s=nG(a,i.shape.length);let l=i;const c=[];null!=s&&(l=F2({inputs:{x:i},backend:n,attrs:{perm:s}}),c.push(l),a=iG(a.length,l.shape.length)),eG("argMin",[a[0]],l.shape.length);const u=a3(n,l,a[0],"min");return c.forEach((t=>n.disposeIntermediateTensorInfo(t))),u}},c3=v2({opSnippet:U1+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n"}),u3={kernelName:KD,backendName:"webgl",kernelFunc:c3},h3=v2({opSnippet:U1+"return log(x + sqrt(x * x + 1.0));"}),d3={kernelName:ZD,backendName:"webgl",kernelFunc:h3},p3=v2({opSnippet:U1+"\n  return atan(x);\n"}),f3={kernelName:JD,backendName:"webgl",kernelFunc:p3},m3=b2({opSnippet:r2+"\n  return atan(a, b);\n",packedOpSnippet:"\n  vec4 result = atan(a, b);\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+o2+"\n  return result;\n"}),g3={kernelName:$D,backendName:"webgl",kernelFunc:m3},y3=v2({opSnippet:U1+"\n  if ((x < -1.0) || (x > 1.0)) return NAN;\nreturn (log(1.0 + x) - log(1.0 - x)) / 2.0;"}),v3={kernelName:QD,backendName:"webgl",kernelFunc:y3};class b3{constructor(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(this.variableNames=["x"],"avg"===e&&n)throw new Error("Cannot compute positions for average pool.");const o=t.filterWidth,a=t.strideHeight,s=t.strideWidth,l=t.dilationHeight,c=t.dilationWidth,u=t.effectiveFilterHeight,h=t.effectiveFilterWidth,d=t.padInfo.top,p=t.padInfo.left;this.outputShape=t.outShape;const f="avg"===e,m="((batch  * ".concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + d"),g="(xR * ".concat(t.inWidth," + xC) * ").concat(t.inChannels," + d");let y="0.0";if(f||(y="-1.0 / 1e-20"),n){const e=">=";return void(this.userCode="\n        const ivec2 strides = ivec2(".concat(a,", ").concat(s,");\n        const ivec2 pads = ivec2(").concat(d,", ").concat(p,");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ").concat(u,";\n              wR += ").concat(l,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(h,";\n                wC += ").concat(c,") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value ").concat(e," currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ").concat(r?i?m:g:"wR * ".concat(h," + wC"),";\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      "))}let v="".concat(e,"(").concat(e,"(").concat(e,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===e&&(v="avgValue / max(count, 1.0)");const b=4*Math.floor(o/4),x=o%4,_="\n      if (".concat(f,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat("max","(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec2 strides = ivec2(".concat(a,", ").concat(s,");\n      const ivec2 pads = ivec2(").concat(d,", ").concat(p,");\n      const float initializationValue = ").concat(y,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ").concat(t.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(y,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ").concat(u,";\n            wR += ").concat(l,") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ").concat(t.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(b,"; wC += 4) {\n            int xC = xCCorner + wC * ").concat(c,";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(c,", d),\n              getValue(batch, xR, xC + 2 * ").concat(c,", d),\n              getValue(batch, xR, xC + 3 * ").concat(c,", d)\n            );\n\n            ").concat(_,"\n          }\n\n          int xC = xCCorner + ").concat(b,";\n          if (").concat(1===x,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(_,"\n          } else if (").concat(2===x,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(c,", d),\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(_,"\n          } else if (").concat(3===x,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(c,", d),\n              getValue(batch, xR, xC + 2 * ").concat(c,", d),\n              initializationValue\n            );\n\n            ").concat(_,"\n          }\n        }\n        setOutput(").concat(v,");\n      }\n    ")}}class x3{constructor(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(this.variableNames=["x"],"avg"===e&&n)throw new Error("Cannot compute positions for average pool.");const o=t.filterWidth,a=t.strideDepth,s=t.strideHeight,l=t.strideWidth,c=t.dilationDepth,u=t.dilationHeight,h=t.dilationWidth,d=t.effectiveFilterDepth,p=t.effectiveFilterHeight,f=t.effectiveFilterWidth,m=t.padInfo.front,g=t.padInfo.top,y=t.padInfo.left;this.outputShape=t.outShape;const v="avg"===e;let b="0.0";if(v||(b="-1.0 / 1e-20"),n){const e=">=";return void(this.userCode="\n        const ivec3 strides =\n            ivec3(".concat(a,", ").concat(s,", ").concat(l,");\n        const ivec3 pads = ivec3(").concat(m,", ").concat(g,", ").concat(y,");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < ").concat(d,";\n              wD += ").concat(c,") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= ").concat(t.inDepth,") {\n              continue;\n            }\n\n            for (int wR = 0; wR < ").concat(p,";\n                wR += ").concat(u,") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= ").concat(t.inHeight,") {\n                continue;\n              }\n\n              for (int wC = 0; wC < ").concat(f,";\n                  wC += ").concat(h,") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value ").concat(e," currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = ").concat(r?i?"(((batch * ".concat(t.inDepth," + xD) * ").concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + ch"):"((xD * ".concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + ch"):"wD * ".concat(p," * ").concat(f," +\n                      wR * ").concat(f," + wC"),";\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      "))}let x="".concat(e,"(").concat(e,"(").concat(e,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===e&&(x="avgValue / max(count, 1.0)");const _=4*Math.floor(o/4),w=o%4,S="\n      if (".concat(v,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat("max","(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec3 strides =\n        ivec3(".concat(a,", ").concat(s,", ").concat(l,");\n      const ivec3 pads = ivec3(").concat(m,", ").concat(g,", ").concat(y,");\n      const float initializationValue = ").concat(b,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= ").concat(t.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(b,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < ").concat(d,";\n            wD += ").concat(c,") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= ").concat(t.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(p,";\n            wR += ").concat(u,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(_,"; wC += 4) {\n              int xC = xCCorner + wC * ").concat(h,";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(h,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(h,", ch),\n                getValue(batch, xD, xR, xC + 3 * ").concat(h,", ch)\n              );\n\n              ").concat(S,"\n            }\n\n            int xC = xCCorner + ").concat(_,";\n            if (").concat(1===w,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(S,"\n            } else if (").concat(2===w,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(h,", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(S,"\n            } else if (").concat(3===w,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(h,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(h,", ch),\n                initializationValue\n              );\n\n              ").concat(S,"\n            }\n          }\n        }\n        setOutput(").concat(x,");\n      }\n    ")}}const _3={kernelName:tL,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e;wQ(i,"avgPool");const{filterSize:o,strides:a,pad:s,dimRoundingMode:l}=r;aD($V(a,1),(()=>"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(a," and dilations '").concat(1,"'")));const c=WV(i.shape,o,a,1,s,l);if(1===c.filterWidth&&1===c.filterHeight&&uD(c.inShape,c.outShape))return s2({inputs:{x:i},backend:n});const u=new b3(c,"avg",!1);return n.runWebGLProgram(u,[i],"float32")}};const w3={kernelName:eL,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{filterSize:o,strides:a,pad:s,dimRoundingMode:l,dataFormat:c}=r,u=GV(i.shape,o,a,[1,1,1],s,l,c),h=new x3(u,"avg",!1);return n.runWebGLProgram(h,[i],"float32")}};class S3{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,i=t.strideWidth,o=t.dilationHeight,a=t.dilationWidth,s=t.effectiveFilterHeight,l=t.effectiveFilterWidth,c=s-1-t.padInfo.top,u=l-1-t.padInfo.left,h=1/(e*n);this.userCode="\n      const ivec2 pads = ivec2(".concat(c,", ").concat(u,");\n      const float avgMultiplier = float(").concat(h,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(s,";\n            wR += ").concat(o,") {\n          float dyR = float(dyRCorner + wR) / ").concat(r,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(l,";\n            wC+= ").concat(a,") {\n            float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class T3{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const e=t.filterDepth,n=t.filterHeight,r=t.filterWidth,i=t.strideDepth,o=t.strideHeight,a=t.strideWidth,s=t.dilationDepth,l=t.dilationHeight,c=t.dilationWidth,u=t.effectiveFilterDepth,h=t.effectiveFilterHeight,d=t.effectiveFilterWidth,p=u-1-t.padInfo.front,f=h-1-t.padInfo.top,m=d-1-t.padInfo.left,g=1/(e*n*r);this.userCode="\n      const ivec3 pads = ivec3(".concat(p,", ").concat(f,", ").concat(m,");\n      const float avgMultiplier = float(").concat(g,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(u,";\n            wD += ").concat(s,") {\n          float dyD = float(dyDCorner + wD) / ").concat(i,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(t.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(h,";\n              wR += ").concat(l,") {\n            float dyR = float(dyRCorner + wR) / ").concat(o,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(d,";\n                wC += ").concat(c,") {\n              float dyC = float(dyCCorner + wC) / ").concat(a,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}const E3={kernelName:"AvgPool3DGrad",backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,input:o}=e,a=o,{filterSize:s,strides:l,pad:c,dimRoundingMode:u}=r,h=GV(a.shape,s,l,[1,1,1],c,u),d=new T3(h);return n.runWebGLProgram(d,[i],a.dtype)}};const M3={kernelName:"AvgPoolGrad",backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,input:o}=e,a=o;wQ([i,o],"avgPoolGrad");const{filterSize:s,strides:l,pad:c}=r,u=WV(a.shape,s,l,1,c),h=new S3(u);return n.runWebGLProgram(h,[i],a.dtype)}};const C3={kernelName:nL,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{a:i,b:o}=e,{transposeA:a,transposeB:s}=r;return z2({a:i,b:o,transposeA:a,transposeB:s,backend:n})}};class A3{constructor(t,e,n,r,i,o){this.outputShape=[],this.variableNames=["x","mean","variance"],Oj(t,e),Oj(t,n);let a="0.0";null!=r&&(Oj(t,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let s="1.0";null!=i&&(Oj(t,i),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = ".concat(a,";\n        float scale = ").concat(s,";\n        float inv = scale * inversesqrt(variance + float(").concat(o,"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    ")}}class k3{constructor(t,e,n,r,i,o){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Oj(t,e),Oj(t,n);let a="vec4(0.0)";null!=r&&(Oj(t,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let s="vec4(1.0)";null!=i&&(Oj(t,i),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        vec4 offset = ".concat(a,";\n        vec4 scale = ").concat(s,";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4(").concat(o,"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    ")}}const I3={kernelName:zL,backendName:"webgl",kernelFunc:t=>{let{inputs:e,backend:n,attrs:r}=t;const{x:i,mean:o,variance:a,offset:s,scale:l}=e;aD(o.shape.length===a.shape.length,(()=>"Batch normalization gradient requires mean and variance to have equal ranks.")),aD(null==s||o.shape.length===s.shape.length,(()=>"Batch normalization gradient requires mean and offset to have equal ranks.")),aD(null==l||o.shape.length===l.shape.length,(()=>"Batch normalization gradient requires mean and scale to have equal ranks."));let{varianceEpsilon:c}=r;null==c&&(c=.001);const u=[i,o,a];let h=null;null!=s&&(h=s.shape,u.push(s));let d=null;null!=l&&(d=l.shape,u.push(l));const p=FD().getBool("WEBGL_PACK_NORMALIZATION")?new k3(i.shape,o.shape,a.shape,h,d,c):new A3(i.shape,o.shape,a.shape,h,d,c);return n.runWebGLProgram(p,u,u[0].dtype)}};class R3{constructor(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;const e=zQ(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=function(t){if(1===t)return"sourceLoc";if(t<=6)return P3.slice(0,t).map((t=>"sourceLoc."+t)).join(",");throw Error("Slicing for rank ".concat(t," is not yet supported"))}(this.rank);let r;const i=t.map(((t,e)=>"sourceLoc.".concat(P3[e]," = start[").concat(e,"] + coords.").concat(P3[e],";")));r="\n        ".concat(e," sourceLoc;\n        ").concat(e," coords = getOutputCoords();\n        ").concat(i.join("\n"),"\n      "),this.userCode="\n      void main() {\n        ".concat(r,"\n        setOutput(getSource(").concat(n,"));\n      }\n    ")}}const P3=["x","y","z","w","u","v"];class N3{constructor(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const e=zQ(this.rank),n=I1("coords",this.rank),r=I1("sourceLoc",this.rank),i=1===this.rank?"sourceLoc":"vec2(".concat(r.slice(-2).join(),")"),o="getChannel(getSource(".concat(r.join(),"), ").concat(i,")"),a="\n      result.x = ".concat(o,";\n      if (++").concat(n[this.rank-1]," < ").concat(t[this.rank-1],") {\n        ++").concat(r[this.rank-1],";\n        result.y = ").concat(o,";\n        --").concat(r[this.rank-1],";\n      }\n    "),s=1===this.rank?"":"\n      --".concat(n[this.rank-1],";\n      if (++").concat(n[this.rank-2]," < ").concat(t[this.rank-2],") {\n        ++").concat(r[this.rank-2],";\n        result.z = ").concat(o,";\n        if (++").concat(n[this.rank-1]," < ").concat(t[this.rank-1],") {\n          ++").concat(r[this.rank-1],";\n          result.w = ").concat(o,";\n        }\n      }\n    "),l=this.rank<=4?"sourceLoc = coords +\n            ".concat(e,"(").concat(t.map(((t,e)=>"start[".concat(e,"]"))).join(),");"):t.map(((t,e)=>"".concat(r[e]," = ").concat(n[e]," + start[").concat(e,"];"))).join("\n");this.userCode="\n      void main() {\n        ".concat(e," coords = getOutputCoords();\n        ").concat(e," sourceLoc;\n        ").concat(l,"\n        vec4 result = vec4(0.);\n        ").concat(a,"\n        ").concat(s,"\n        setOutput(result);\n      }\n    ")}}function O3(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{begin:o,size:a}=r,[s,l]=CV(i,o,a);if(pV(i,s,l),0===cD(l))return n.makeTensorInfo(l,i.dtype,[]);if(n.shouldExecuteOnCPU([i])||"string"===i.dtype){const t=n.texData.get(i.dataId),e=f1(t.values,s,l,i.shape,i.dtype);return n.makeTensorInfo(l,i.dtype,e)}const{isPacked:c}=n.texData.get(i.dataId),u=EV(i.shape,s,l);if(c||!u){const t=FD().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new N3(l):new R3(l),e=[s];return n.runWebGLProgram(t,[i],i.dtype,e)}return n.uploadToGPU(i.dataId),function(t,e,n,r){const i=r.texData.get(t.dataId),o=r.makeTensorInfo(n,t.dtype),a=r.texData.get(o.dataId);Object.assign(a,i),a.refCount=1,a.shape=n,a.dtype=t.dtype;let s=MV(e,ED(t.shape));i.slice&&(s+=i.slice.flatOffset),a.slice={flatOffset:s,origDataId:i.slice&&i.slice.origDataId||t.dataId};const l=r.dataRefCount.get(a.slice.origDataId)||1;return r.dataRefCount.set(a.slice.origDataId,l+1),o}(i,s,l,n)}const D3={kernelName:HF,backendName:"webgl",kernelFunc:O3},L3={kernelName:rL,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{blockShape:o,crops:a}=r;aD(i.shape.length<=4,(()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"));const s=o.reduce(((t,e)=>t*e)),l=iY(i.shape,o,s),c=oY(l.length,o.length),u=aY(i.shape,o,s),h=sY(a,o.length),d=lY(u,a,o.length),p=[],f=C2({inputs:{x:i},backend:n,attrs:{shape:l}}),m=F2({inputs:{x:f},backend:n,attrs:{perm:c}}),g=C2({inputs:{x:m},backend:n,attrs:{shape:u}}),y=O3({inputs:{x:g},backend:n,attrs:{begin:h,size:d}});return p.push(f),p.push(m),p.push(g),p.forEach((t=>n.disposeIntermediateTensorInfo(t))),y}};const F3={kernelName:iL,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,weights:o}=e,{size:a}=r,s=n.readSync(i.dataId),l=n.readSync(o.dataId),c=D0(s,l,o.dtype,o.shape,a);return n.makeTensorInfo([a],o.dtype,c)}};const U3={kernelName:oL,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{a:r,b:i}=e,o=FD().getBool("WEBGL_PACK_BINARY_OPERATIONS"),a=FD().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([r,i])||1===a){const t=n.texData.get(r.dataId).values,e=n.texData.get(i.dataId).values,[o,a]=F0(r.shape,i.shape,t,e,r.dtype),s=n.makeTensorInfo(a,r.dtype);return n.texData.get(s.dataId).values=o,s}let s;return s=o?new a2("\n  int r = int(a.r) & int(b.r);\n  int g = int(a.g) & int(b.g);\n  int rb = int(a.b) & int(b.b);\n  int ra = int(a.a) & int(b.a);\n  return vec4(r, g, rb, ra);\n",r.shape,i.shape,!1):new i2("\n  return float(int(a.r) & int(b.r));\n",r.shape,i.shape),n.runWebGLProgram(s,[r,i],r.dtype)}};const B3={kernelName:aL,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{s0:r,s1:i}=e,o=n.readSync(r.dataId),a=n.readSync(i.dataId),s=Oj(Array.from(o),Array.from(a));return n.makeTensorInfo([s.length],"int32",Int32Array.from(s))}},z3=b2({opSnippet:"return float(a != b);",cpuKernelImpl:i1,dtype:"bool"}),j3={kernelName:gF,backendName:"webgl",kernelFunc:z3};function V3(t){const{inputs:e,backend:n}=t,{input:r}=e;return s2({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.real},backend:n})}const W3={kernelName:IF,backendName:"webgl",kernelFunc:V3},G3="return float(int(x));";const H3={kernelName:sL,backendName:"webgl",kernelFunc:function t(e){const{inputs:n,backend:r,attrs:i}=e,{x:o}=n,{dtype:a}=i;if("complex64"===a){if("complex64"===o.dtype)return s2({inputs:{x:o},backend:r});const e=XG(o.shape),n=t({inputs:{x:o},backend:r,attrs:{dtype:"float32"}}),i=c2({inputs:{real:n,imag:e},backend:r});return e.dispose(),r.disposeIntermediateTensorInfo(n),i}if("complex64"===o.dtype){const e=V3({inputs:{input:o},backend:r}),n=t({inputs:{x:e},backend:r,attrs:{dtype:a}});return r.disposeIntermediateTensorInfo(e),n}if(!bD(o.dtype,a)){const t=s2({inputs:{x:o},backend:r});return{dataId:t.dataId,shape:t.shape,dtype:a}}if(r.shouldExecuteOnCPU([o])){const t=r.texData.get(o.dataId).values,[e,n,i]=U0(t,o.shape,o.dtype,a);return r.makeTensorInfo(e,n,i)}if("int32"===a)return function(t,e){const n=new F1(t.shape,G3),r=e.runWebGLProgram(n,[t],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}(o,r);if("bool"===a){const t=r.makeTensorInfo([],"bool",yD("bool",1)),e=z3({inputs:{a:o,b:t},backend:r});return r.disposeIntermediateTensorInfo(t),e}throw new Error("Error in Cast: failed to cast ".concat(o.dtype," to ").concat(a))}},q3="return ceil(x);",X3=v2({opSnippet:q3,packedOpSnippet:q3,cpuKernelImpl:B0}),Y3={kernelName:lL,backendName:"webgl",kernelFunc:X3};class K3{constructor(t){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode="\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}}class Z3{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode="\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}}const J3={kernelName:cL,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{clipValueMin:o,clipValueMax:a}=r;let s;s=FD().getBool("WEBGL_PACK_CLIP")?new Z3(i.shape):new K3(i.shape);const l=[[o],[a]];return n.runWebGLProgram(s,[i],i.dtype,l)}};class Q3{constructor(t){this.variableNames=["real","imag"],this.outputShape=t,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "}}function $3(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}const t4={kernelName:hL,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{x:r}=e,i=n.texData.get(r.dataId),o=new Q3(r.shape),a=[$3(r,i.complexTensorInfos.real),$3(r,i.complexTensorInfos.imag)];return n.runWebGLProgram(o,a,a[0].dtype)}};class e4{constructor(t){this.outputShape=[],this.outputShape=KX(t,1),this.variableNames=t.map(((t,e)=>"T".concat(e)));const e=new Array(t.length-1);e[0]=t[0][1];for(let o=1;o<e.length;o++)e[o]=e[o-1]+t[o][1];const n=["if (yC < ".concat(e[0],") setOutput(getT0(yR, yC));")];for(let o=1;o<e.length;o++){const t=e[o-1];n.push("else if (yC < ".concat(e[o],") ")+"setOutput(getT".concat(o,"(yR, yC-").concat(t,"));"))}const r=e.length,i=e[e.length-1];n.push("else setOutput(getT".concat(r,"(yR, yC-").concat(i,"));")),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ".concat(n.join("\n        "),"\n      }\n    ")}}class n4{constructor(t,e){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=KX(t,e);const n=this.outputShape,r=n.length,i=zQ(r),o=I1("coords",r),a=["x","y","z","w","u","v"].slice(0,r);this.variableNames=t.map(((t,e)=>"T".concat(e)));const s=new Array(t.length-1);s[0]=t[0][e];for(let f=1;f<s.length;f++)s[f]=s[f-1]+t[f][e];const l=a[e],c=a.slice(-2),u=a.join();let h="if (".concat(l," < ").concat(s[0],") {\n        return getChannel(\n            getT0(").concat(u,"), vec2(").concat(c.join(),"));\n        }");for(let f=1;f<s.length;f++){const t=s[f-1];h+="\n        if (".concat(l," < ").concat(s[f],"  && ").concat(l," >= ").concat(s[f-1],") {\n          return getChannel(\n            getT").concat(f,"(").concat(r4(a,l,t),"),\n            vec2(").concat(r4(c,l,t),"));\n        }")}const d=s.length,p=s[s.length-1];h+="\n        return getChannel(\n          getT".concat(d,"(").concat(r4(a,l,p),"),\n          vec2(").concat(r4(c,l,p),"));"),this.userCode="\n      float getValue(".concat(a.map((t=>"int "+t)),") {\n        ").concat(h,"\n      }\n\n      void main() {\n        ").concat(i," coords = getOutputCoords();\n        vec4 result = vec4(getValue(").concat(o,"), 0., 0., 0.);\n\n        ").concat(o[r-1]," = ").concat(o[r-1]," + 1;\n        if (").concat(o[r-1]," < ").concat(n[r-1],") {\n          result.g = getValue(").concat(o,");\n        }\n\n        ").concat(o[r-2]," = ").concat(o[r-2]," + 1;\n        if (").concat(o[r-2]," < ").concat(n[r-2],") {\n          result.a = getValue(").concat(o,");\n        }\n\n        ").concat(o[r-1]," = ").concat(o[r-1]," - 1;\n        if (").concat(o[r-2]," < ").concat(n[r-2]," &&\n            ").concat(o[r-1]," < ").concat(n[r-1],") {\n          result.b = getValue(").concat(o,");\n        }\n        setOutput(result);\n      }\n    ")}}function r4(t,e,n){const r=t.indexOf(e),i=t.map(((t,e)=>e===r?"".concat(t," - ").concat(n):t));return i.join()}function i4(t){const{inputs:e,backend:n}=t,{input:r}=e;return s2({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.imag},backend:n})}const o4={kernelName:XL,backendName:"webgl",kernelFunc:i4};function a4(t,e,n){const r=t[0].dtype;if("complex64"===r){const r=t.map((t=>V3({inputs:{input:t},backend:n}))),i=t.map((t=>i4({inputs:{input:t},backend:n}))),o=a4(r,e,n),a=a4(i,e,n),s=c2({inputs:{real:o,imag:a},backend:n});return r.forEach((t=>n.disposeIntermediateTensorInfo(t))),i.forEach((t=>n.disposeIntermediateTensorInfo(t))),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),s}let i=n.shouldExecuteOnCPU(t);if("string"===r&&(i=!0),i){const i=t.map((t=>{const r=cD(t.shape.slice(e));return C2({inputs:{x:t},backend:n,attrs:{shape:[-1,r]}})})),o=i.map((t=>({vals:n.readSync(t.dataId),shape:t.shape}))),a=KX(i.map((t=>t.shape)),1),s=1===i[0].shape[0],l=z0(o,a,r,s),c=KX(t.map((t=>t.shape)),e),u=n.makeTensorInfo(c,r,l);return i.forEach((t=>n.disposeIntermediateTensorInfo(t))),u}const o=t.filter((t=>cD(t.shape)>0)),a=FD().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&o[0].shape.length>1;if(1===o.length){const e=a?new F1(t[0].shape,G1):new J1(t[0].shape,G1);return n.runWebGLProgram(e,t,r)}const s=FD().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(o.length>s){const t=[];for(let i=0;i<o.length;i+=s){const r=o.slice(i,i+s);t.push(a4(r,e,n))}const r=a4(t,e,n);for(const e of t)n.disposeIntermediateTensorInfo(e);return r}if(a){const t=new n4(o.map((t=>t.shape)),e);return n.runWebGLProgram(t,o,r)}const{tensors2D:l,outShape:c}=function(t,e,n){const r=KX(t.map((t=>t.shape)),e),i=t.map((t=>C2({inputs:{x:t},attrs:{shape:[-1,cD(t.shape.slice(e))]},backend:n})));return{tensors2D:i,outShape:r}}(o,e,n),u=new e4(l.map((t=>t.shape))),h=n.runWebGLProgram(u,l,r);l.forEach((t=>n.disposeIntermediateTensorInfo(t)));const d=C2({inputs:{x:h},attrs:{shape:c},backend:n});return n.disposeIntermediateTensorInfo(h),d}function s4(t){const{inputs:e,backend:n,attrs:r}=t,{axis:i}=r,o=mD(i,e[0].shape)[0],a=e.map((t=>t.shape));YX(a,o);const s=KX(e.map((t=>t.shape)),o);if(0===cD(s))return n.makeTensorInfo(s,e[0].dtype,[]);const l=e.filter((t=>cD(t.shape)>0));return 1===l.length?s2({inputs:{x:l[0]},backend:n}):a4(l,o,n)}const l4={kernelName:dL,backendName:"webgl",kernelFunc:s4};class c4{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.outputShape=t.outShape;const o=t.padInfo.top,a=t.padInfo.left,s=t.strideHeight,l=t.strideWidth,c=t.dilationHeight,u=t.dilationWidth,h=t.filterHeight,d=t.filterWidth,p=4*Math.floor(t.inChannels/4),f=t.inChannels%4,m="channelsLast"===t.dataFormat,g=m?1:2,y=m?2:3,v=m?3:1;let b="",x="";n&&(b=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):i?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):"\n          float activation(float x) {\n            ".concat(n,"\n          }\n        "),x="result = activation(result);");const _=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(b,"\n\n      const ivec2 strides = ivec2(").concat(s,", ").concat(l,");\n      const ivec2 pads = ivec2(").concat(o,", ").concat(a,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[").concat(v,"];\n\n        ivec2 xRCCorner =\n            ivec2(coords[").concat(g,"], coords[").concat(y,"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(h,"; wR++) {\n          int xR = xRCorner + wR * ").concat(c,";\n\n          if (xR < 0 || xR >= ").concat(t.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(d,"; wC++) {\n            int xC = xCCorner + wC * ").concat(u,";\n\n            if (xC < 0 || xC >= ").concat(t.inWidth,") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ").concat(p,"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (").concat(m,") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (").concat(1===f,") {\n\n              if (").concat(m,") {\n                dotProd +=\n                    getX(batch, xR, xC, ").concat(p,") *\n                    getW(wR, wC, ").concat(p,", d2);\n              } else {\n                dotProd +=\n                    getX(batch, ").concat(p,", xR, xC) *\n                    getW(wR, wC, ").concat(p,", d2);\n              }\n\n            } else if (").concat(2===f,") {\n              vec2 wValues = vec2(\n                getW(wR, wC, ").concat(p,", d2),\n                getW(wR, wC, ").concat(p," + 1, d2)\n              );\n\n              if (").concat(m,") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ").concat(p,"),\n                  getX(batch, xR, xC, ").concat(p," + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ").concat(p,", xR, xC),\n                  getX(batch, ").concat(p," + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (").concat(3===f,") {\n              vec3 wValues = vec3(\n                getW(wR, wC, ").concat(p,", d2),\n                getW(wR, wC, ").concat(p," + 1, d2),\n                getW(wR, wC, ").concat(p," + 2, d2)\n              );\n\n              if (").concat(m,") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ").concat(p,"),\n                  getX(batch, xR, xC, ").concat(p," + 1),\n                  getX(batch, xR, xC, ").concat(p," + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ").concat(p,", xR, xC),\n                  getX(batch, ").concat(p," + 1, xR, xC),\n                  getX(batch, ").concat(p," + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ").concat(_,"\n        ").concat(x,"\n        setOutput(result);\n      }\n    ")}}class u4{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const e=t.padInfo.front,n=t.padInfo.top,r=t.padInfo.left,i=t.strideDepth,o=t.strideHeight,a=t.strideWidth,s=t.dilationDepth,l=t.dilationHeight,c=t.dilationWidth,u=t.filterDepth,h=t.filterHeight,d=t.filterWidth,p=4*Math.floor(t.inChannels/4),f=t.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3(".concat(i,", ").concat(o,", ").concat(a,");\n      const ivec3 pads = ivec3(").concat(e,", ").concat(n,", ").concat(r,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(u,"; wF++) {\n          int xF = xFCorner + wF * ").concat(s,";\n\n          if (xF < 0 || xF >= ").concat(t.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(h,"; wR++) {\n            int xR = xRCorner + wR * ").concat(l,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(d,"; wC++) {\n              int xC = xCCorner + wC * ").concat(c,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < ").concat(p,"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (").concat(1===f,") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, ").concat(p,") *\n                  getW(wF, wR, wC, ").concat(p,", d2);\n              } else if (").concat(2===f,") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, ").concat(p,"),\n                  getX(batch, xF, xR, xC, ").concat(p," + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, ").concat(p,", d2),\n                  getW(wF, wR, wC, ").concat(p," + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (").concat(3===f,") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, ").concat(p,"),\n                  getX(batch, xF, xR, xC, ").concat(p," + 1),\n                  getX(batch, xF, xR, xC, ").concat(p," + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, ").concat(p,", d2),\n                  getW(wF, wR, wC, ").concat(p," + 1, d2),\n                  getW(wF, wR, wC, ").concat(p," + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class h4{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=XQ(this.outputShape.length);const o=t.padInfo.left,a=t.strideWidth,s=t.dilationWidth,l=t.filterHeight,c=t.filterWidth,u=c;let h="\n       int xR; int xC; int xCOffset;\n       vec4 wTexel; vec4 previous; vec4 final;";for(let m=0;m<c;m++)h+="\n           vec4 xTexelC".concat(2*m,";\n           int xTexelC").concat(2*m,"Ready;\n           vec4 xTexelC").concat(2*m+1,";\n           int xTexelC").concat(2*m+1,"Ready;\n           vec4 xC").concat(m,";");h+="\n     for (int r = 0; r < ".concat(l,"; r++) {\n      for (int d1 = 0; d1 < ").concat(t.inChannels,"; d1 += 2) {\n       ");for(let m=0;m<c;m++)h+="\n           xTexelC".concat(2*m," = vec4(0.0);\n           xTexelC").concat(2*m,"Ready = 0;\n           xTexelC").concat(2*m+1," = vec4(0.0);\n           xTexelC").concat(2*m+1,"Ready = 0;\n           xC").concat(m," = vec4(0.0);");h+="\n         xR = xRCorner + r * dilations[0];\n         if (xR >=0 && xR < inDims[0]) {\n       ";for(let m=0;m<(u+1)/2;m++){const e=2*m;if(h+="\n           xC = xCCorner + ".concat(e*s,";\n           "),1===a){if(e<c&&(o%2===1?(h+="\n                 xCOffset = xC + 1;\n                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(e,"Ready == 0) {\n                   xTexelC").concat(e," = getX(batch, xR, xCOffset, d1);\n\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(e,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(e,"Ready = 1;\n                 }\n               "),h+=1===s&&e>0?"\n                 xC".concat(e," = vec4(xTexelC").concat(e-2,".zw, xTexelC").concat(e,".xy);\n                 "):"\n                   xCOffset = xC + 1 - 2;\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       previous.zw = vec2(0.0);\n                     }\n\n                     xC".concat(e," = vec4(previous.zw, xTexelC").concat(e,".xy);\n                   } else {\n                     xC").concat(e," = vec4(0.0, 0.0, xTexelC").concat(e,".xy);\n                   }\n                   ")):h+="\n                 if (xC >= 0 && xC < inDims[1] && xTexelC".concat(e,"Ready == 0) {\n                   xTexelC").concat(e," = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC").concat(e,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(e,"Ready = 1;\n                 }\n\n                 xC").concat(e," = xTexelC").concat(e,";\n                 "),e+1<c)){const t=o%2===0?iD(s):s;s%2===0&&o%2===1||s%2!==0&&o%2!==1?(h+="\n                   xCOffset = xC + imod(pads[1], 2) + ".concat(t,";\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(e+1,"Ready == 0) {\n                     xTexelC").concat(e+1," = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       xTexelC").concat(e+1,".zw = vec2(0.0);\n                     }\n                     xTexelC").concat(e+1,"Ready = 1;\n                   }\n                   "),h+=s>1?"\n                     xCOffset -= 2;\n                     if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                      previous = getX(batch, xR, xCOffset, d1);\n                      xC".concat(e+1," = vec4(previous.zw, xTexelC").concat(e+1,".xy);\n                     } else {\n                      xC").concat(e+1," = vec4(0.0, 0.0, xTexelC").concat(e+1,".xy);\n                     }\n                     "):"\n                     xC".concat(e+1," = vec4(xTexelC").concat(e,".zw, xTexelC").concat(e+1,".xy);\n                     ")):h+=1===t?"\n                     xC".concat(e+1," = xTexelC").concat(e,";\n                     "):"\n                     xCOffset = xC + ".concat(t,";\n\n                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(e+1,"Ready == 0) {\n                       xTexelC").concat(e+1," = getX(batch, xR, xCOffset, d1);\n                       if (xCOffset + 1 >= inDims[1]) {\n                         xTexelC").concat(e+1,".zw = vec2(0.0);\n                       }\n                       xTexelC").concat(e+1,"Ready = 1;\n                     }\n\n                     xC").concat(e+1," = xTexelC").concat(e+1,";\n                     ")}}else e<c&&(o%2===1?(h+="\n                 xCOffset = xC + 1 - strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(e,"Ready == 0) {\n                   xTexelC").concat(e," = getX(batch, xR, xCOffset, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(e,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(e,"Ready = 1;\n                 }\n\n                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC").concat(e+1,"Ready == 0) {\n                   xTexelC").concat(e+1," = getX(batch, xR, xC + 1, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xC + 2 >= inDims[1]) {\n                     xTexelC").concat(e+1,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(e+1,"Ready = 1;\n                 }\n\n                 xC").concat(e," = vec4(xTexelC").concat(e,".zw, xTexelC").concat(e+1,".zw);\n               "),e+1<c&&(h+="\n                   final = vec4(0.0);\n                   xCOffset = xC + 1 + strides[1];\n                   if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                     final = getX(batch, xR, xCOffset, d1);\n                   }\n                   xC".concat(e+1," = vec4(xTexelC").concat(e+1,".xy, final.xy);\n                 "))):(h+="\n                 if(xC >= 0 && xC < inDims[1] && xTexelC".concat(e,"Ready == 0) {\n                   xTexelC").concat(e," = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC").concat(e,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(e,"Ready = 1;\n                 }\n\n                 xCOffset = xC + strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(e+1,"Ready == 0) {\n                   xTexelC").concat(e+1," = getX(batch, xR, xCOffset, d1);\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(e+1,".zw = vec2(0.);\n                   }\n                   xTexelC").concat(e+1,"Ready = 1;\n                 }\n\n                 xC").concat(e," = vec4(\n                   xTexelC").concat(e,".xy, xTexelC").concat(e+1,".xy);\n               "),e+1<c&&(h+="\n                   xC".concat(e+1," = vec4(xTexelC").concat(e,".zw, xTexelC").concat(e+1,".zw);\n                 "))));e<c&&(h+="\n             wTexel = getW(r, ".concat(e,", d1, d2);\n             dotProd += xC").concat(e,".xxzz * vec4(wTexel.xy, wTexel.xy);\n             if(d1 + 1 < ").concat(t.inChannels,") {\n               dotProd += xC").concat(e,".yyww * vec4(wTexel.zw, wTexel.zw);\n             }\n           "),e+1<c&&(h+="\n               wTexel = getW(r, ".concat(e+1,", d1, d2);\n               dotProd += xC").concat(e+1,".xxzz * vec4(wTexel.xy, wTexel.xy);\n               if(d1 + 1 < ").concat(t.inChannels,") {\n                 dotProd += xC").concat(e+1,".yyww * vec4(wTexel.zw, wTexel.zw);\n               }\n             ")))}h+="\n     }\n   ",h+="\n     }\n   ",h+="\n     }\n   ";let d="",p="";n&&(d=r?"vec4 activation(vec4 a) {\n           vec4 b = getPreluActivationWeightsAtOutCoords();\n           ".concat(n,"\n         }"):i?"vec4 activation(vec4 a) {\n           vec4 b = getLeakyreluAlphaAtOutCoords();\n           ".concat(n,"\n         }"):"vec4 activation(vec4 x) {\n           ".concat(n,"\n         }"),p="result = activation(result);");const f=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n       ".concat(d,"\n\n       void main() {\n         ivec4 coords = getOutputCoords();\n         int batch = coords.x;\n         ivec2 xRCCorner = coords.yz * strides - pads;\n         int d2 = coords.w;\n         int xRCorner = xRCCorner.x;\n         int xCCorner = xRCCorner.y;\n\n         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n         vec4 dotProd = vec4(0.000000000000001);\n\n         ").concat(h,"\n\n         vec4 result = dotProd - vec4(0.000000000000001);\n         ").concat(f,"\n         ").concat(p,"\n         setOutput(result);\n       }\n     ")}}class d4{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=t,this.enableShapeUniforms=XQ(this.outputShape.length);const{dataFormat:n}=e,r=TQ(),i="channelsLast"===n,o=i?1:2,a=i?2:3,s=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":"if(blockIndex < ".concat(t[2]," && pos < ").concat(t[1],") {");let l="";for(let c=0;c<=1;c++)for(let t=0;t<=1;t++)l+="\n          blockIndex = rc.z + ".concat(t,";\n          pos = rc.y + ").concat(c,";\n\n          ").concat(s,"\n            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];\n            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);\n\n            if(d0 < inputShape[").concat(o,"] && d0 >= 0) {\n              // Use custom imod instead mod. On Intel GPU, mod may generate\n              // unexpected value.\n              // https://github.com/tensorflow/tfjs/issues/5447\n              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];\n              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /\n                  inChannels);\n\n              if(d1 < inputShape[").concat(a,"] && d1 >= 0) {\n\n                ch = imod(pos, inChannels);\n\n                if (").concat(i,") {\n                  innerDims = vec2(d1, ch);\n                  result[").concat(2*c+t,"] = getChannel(\n                    getA(rc.x, d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[").concat(2*c+t,"] = getChannel(\n                    getA(rc.x, ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ");this.userCode="\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ".concat(l,"\n\n        ").concat(r.output," = result;\n      }\n    ")}}function p4(t,e){const n=t.length;return n>=3?e?[...t.slice(0,-3),t[n-3]*t[n-2],t[n-1]]:[...t.slice(0,-3),t[n-3],t[n-2]*t[n-1]]:!e&&1===n&&t[0]>1?[t[0],1]:null}function f4(t){let{x:e,filter:n,convInfo:r,backend:i,bias:o=null,preluActivationWeights:a=null,leakyreluAlpha:s=0,activation:l=null}=t;const c=e.shape,u=i.texData.get(e.dataId),h=r.inChannels,d=c[0]*c[1]*c[2],p=r.outChannels,f="channelsLast"===r.dataFormat,m=!1;let g;const y=[];if(null!=a){const t=p4(a.shape,f);null!=t&&(a=C2({inputs:{x:a},backend:i,attrs:{shape:t}}),y.push(a))}if(null!=o){const t=p4(o.shape,f);null!=t&&(o=C2({inputs:{x:o},backend:i,attrs:{shape:t}}),y.push(o))}if(!((1===d||1===p)&&h>B2)&&u.isPacked&&f&&null!=u.texture&&c[2]%2!==0&&uD(u.shape.slice(-3),c.slice(-3))){const t=c[0]*c[1]*(c[2]+1),h={dataId:e.dataId,shape:[1,t,r.inChannels],dtype:e.dtype},d=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,aD(mQ(u.shape,h.shape),(()=>"packed reshape ".concat(u.shape," to ").concat(h.shape," isn't free")));const p=C2({inputs:{x:n},backend:i,attrs:{shape:[1,r.inChannels,r.outChannels]}});y.push(p);const f=z2({a:h,b:p,backend:i,transposeA:false,transposeB:m,bias:o,activation:l,preluActivationWeights:a,leakyreluAlpha:s}),v=i.texData.get(f.dataId);aD(v.isPacked,(()=>"batchMatMul result is expected to be packed")),u.shape=d,v.shape=r.outShape,g=s2({inputs:{x:f},backend:i}),g.shape=r.outShape,y.push(f)}else{const t=r.outHeight*r.outWidth,c=C2({inputs:{x:e},backend:i,attrs:{shape:f?[r.batchSize,t,r.inChannels]:[r.batchSize,r.inChannels,t]}}),u=C2({inputs:{x:n},backend:i,attrs:{shape:[1,r.inChannels,r.outChannels]}}),h=z2({a:f?c:u,b:f?u:c,transposeA:!f,transposeB:m,backend:i,bias:o,activation:l,preluActivationWeights:a,leakyreluAlpha:s});g=C2({inputs:{x:h},backend:i,attrs:{shape:r.outShape}}),y.push(c),y.push(u),y.push(h)}for(const v of y)i.disposeIntermediateTensorInfo(v);return g}function m4(t){let{x:e,filter:n,convInfo:r,backend:i,bias:o=null,preluActivationWeights:a=null,leakyreluAlpha:s=0,activation:l=null}=t;const{filterWidth:c,filterHeight:u,inChannels:h,outWidth:d,outHeight:p,dataFormat:f}=r,m="channelsLast"===f,g=c*u*h,y=p*d,v=[r.batchSize,g,y],b=[];if(null!=a){const t=p4(a.shape,m);null!=t&&(a=C2({inputs:{x:a},backend:i,attrs:{shape:t}}),b.push(a))}if(null!=o){const t=p4(o.shape,m);null!=t&&(o=C2({inputs:{x:o},backend:i,attrs:{shape:t}}),b.push(o))}const x=C2({inputs:{x:n},backend:i,attrs:{shape:[1,g,cD(n.shape)/g]}});b.push(x);const _=new d4(v,r),w=[e.shape,[r.padInfo.top,r.padInfo.left],[r.strideHeight,r.strideWidth],[r.dilationHeight,r.dilationWidth],[r.inChannels],[r.filterWidth*r.inChannels],[r.outWidth]],S=i.runWebGLProgram(_,[e],"float32",w),T=C2({inputs:{x:S},backend:i,attrs:{shape:v}});b.push(S),b.push(T);const E=null!=o,M=null!=a,C="leakyrelu"===l,A=l?x2(l,!0):null,k=new _2(m?T.shape:x.shape,m?x.shape:T.shape,m?[r.batchSize,y,r.outChannels]:[r.batchSize,r.outChannels,y],!0,!1,E,A,M,C),I=m?[T,x]:[x,T];if(o&&I.push(o),M&&I.push(a),C){const t=i.makeTensorInfo([],"float32",JU(s,"float32"));I.push(t),b.push(t)}const R=i.runWebGLProgram(k,I,"float32"),P=C2({inputs:{x:R},backend:i,attrs:{shape:r.outShape}});b.push(R);for(const N of b)i.disposeIntermediateTensorInfo(N);return P}const g4={kernelName:pL,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:o}=e,{strides:a,pad:s,dataFormat:l,dilations:c,dimRoundingMode:u}=r,h=eW(l),d=HV(i.shape,o.shape,a,c,s,u,!1,h);let p;if(1!==d.filterHeight||1!==d.filterWidth||1!==d.dilationHeight||1!==d.dilationWidth||1!==d.strideHeight||1!==d.strideWidth||"SAME"!==d.padInfo.type&&"VALID"!==d.padInfo.type)if(d.strideWidth<=2&&"channelsLast"===h&&FD().getBool("WEBGL_EXP_CONV")){const t=new h4(d),e=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];p=n.runWebGLProgram(t,[i,o],"float32",e)}else if(FD().getBool("WEBGL_CONV_IM2COL"))p=m4({x:i,filter:o,convInfo:d,backend:n});else{const t=new c4(d);p=n.runWebGLProgram(t,[i,o],"float32")}else p=f4({x:i,filter:o,convInfo:d,backend:n});const f=C2({inputs:{x:p},backend:n,attrs:{shape:d.outShape}});return n.disposeIntermediateTensorInfo(p),f}};class y4{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const e=t.strideHeight,n=t.strideWidth,r=t.padInfo.top,i=t.padInfo.left,o="channelsLast"===t.dataFormat;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(t.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(e," - ").concat(r,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(n," - ").concat(i,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              ").concat(o?"float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);":"float dyValue = getDy(b, d2, yR, yC);\n              float xValue = getX(b, d1, xR, xC);\n              dotProd += (xValue * dyValue);","\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class v4{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,i=t.strideWidth,o="channelsLast"===t.dataFormat,a=e-1-t.padInfo.top,s=n-1-t.padInfo.left,l=o?1:2,c=o?2:3,u=o?3:1;this.userCode="\n      const ivec2 pads = ivec2(".concat(a,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[").concat(u,"];\n\n        ivec2 dyCorner = ivec2(coords[").concat(l,"], coords[").concat(c,"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(e,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(r,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(e," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2++) {\n\n              if (").concat(o,") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class b4{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const e=t.strideDepth,n=t.strideHeight,r=t.strideWidth,i=t.padInfo.front,o=t.padInfo.top,a=t.padInfo.left;this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(t.batchSize,"; b++) {\n          for (int yF = 0; yF < ").concat(t.outDepth,"; yF++) {\n            int xF = wF + yF * ").concat(e," - ").concat(i,";\n\n            if (xF < 0 || xF >= ").concat(t.inDepth,") {\n              continue;\n            }\n\n            for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n              int xR = wR + yR * ").concat(n," - ").concat(o,";\n\n              if (xR < 0 || xR >= ").concat(t.inHeight,") {\n                continue;\n              }\n\n              for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n                int xC = wC + yC * ").concat(r," - ").concat(a,";\n\n                if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class x4{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterDepth,n=t.filterHeight,r=t.filterWidth,i=t.strideDepth,o=t.strideHeight,a=t.strideWidth,s=e-1-t.padInfo.front,l=n-1-t.padInfo.top,c=r-1-t.padInfo.left;this.userCode="\n      const ivec3 pads = ivec3(".concat(s,", ").concat(l,", ").concat(c,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(e,"; wF++) {\n          float dyF = float(dyFCorner + wF) / ").concat(i,".0;\n\n          if (dyF < 0.0 || dyF >= ").concat(t.outDepth,".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = ").concat(e," - 1 - wF;\n\n          for (int wR = 0; wR < ").concat(n,"; wR++) {\n            float dyR = float(dyRCorner + wR) / ").concat(o,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = ").concat(n," - 1 - wR;\n\n            for (int wC = 0; wC < ").concat(r,"; wC++) {\n              float dyC = float(dyCCorner + wC) / ").concat(a,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = ").concat(r," - 1 - wC;\n\n              for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}const _4={kernelName:fL,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,dy:o}=e,{strides:a,pad:s,dataFormat:l,dimRoundingMode:c,filterShape:u}=r,h=eW(l),d=HV(i.shape,u,a,1,s,c,!1,h),p=new y4(d);return n.runWebGLProgram(p,[i,o],"float32")}};class w4{constructor(t){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=t.inShape,this.enableShapeUniforms=XQ(this.outputShape.length);const e=t.filterHeight,n=t.filterWidth,r=e-1-t.padInfo.top,i=n-1-t.padInfo.left;this.userCode="\n      const ivec2 pads = ivec2(".concat(r,", ").concat(i,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n\n        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        vec4 result = vec4(0.);\n        for (int wR = 0; wR < ").concat(e,"; wR++) {\n          float dyR = float(dyRCorner + wR) / strides[0];\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n          int wRPerm = ").concat(e," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            float dyC = float(dyCCorner + wC) / strides[1];\n            bool idyCVal = (dyC >= 0.0) && (dyC < ").concat(t.outWidth,".0)\n              && (fract(dyC) == 0.0);\n            int idyC = int(dyC);\n\n            float dyC2 = float(dyCCorner + wC + 1) / strides[1];\n            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ").concat(t.outWidth,".0)\n              && (fract(dyC2) == 0.0);\n            int idyC2 = int(dyC2);\n\n            if (idyCVal && idyCVal2) {\n              for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?\n                  dySample : getDy(batch, idyR, idyC2, d2);\n\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n\n                dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample2.xy : dySample2.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal) {\n              for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal2) {\n              for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC2, d2);\n                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            }\n          }\n        }\n        setOutput(result);\n      }\n    ")}}const S4={kernelName:mL,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,filter:o}=e,{inputShape:a,strides:s,pad:l,dataFormat:c,dimRoundingMode:u}=r,h=eW(c),d=HV(a,o.shape,s,1,l,u,!1,h);if(FD().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&"channelsLast"===h){const t=[[d.strideHeight,d.strideWidth]],e=new w4(d);return n.runWebGLProgram(e,[i,o],"float32",t)}{const t=new v4(d);return n.runWebGLProgram(t,[i,o],"float32")}}};const T4={kernelName:gL,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:o}=e,{strides:a,pad:s,dilations:l}=r,c=qV(i.shape,o.shape,a,l,s),u=new u4(c);return n.runWebGLProgram(u,[i,o],"float32")}};const E4={kernelName:"Conv3DBackpropFilterV2",backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,dy:o}=e,{strides:a,pad:s,filterShape:l}=r,c=qV(i.shape,l,a,1,s),u=new b4(c);return n.runWebGLProgram(u,[i,o],"float32")}};const M4={kernelName:yL,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,filter:o}=e,{pad:a,strides:s,inputShape:l}=r,c=qV(l,o.shape,s,1,a),u=new x4(c);return n.runWebGLProgram(u,[i,o],"float32")}},C4={kernelName:"Cos",backendName:"webgl",kernelFunc:v2({opSnippet:y2+"\n  return cos(x);\n",packedOpSnippet:"\n  vec4 result = cos(x);\n  bvec4 isNaN = isnan(x);\n  ".concat(o2,"\n  return result;\n")})},A4=v2({opSnippet:"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n"}),k4={kernelName:vL,backendName:"webgl",kernelFunc:A4};class I4{constructor(t,e,n,r,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[o,a,s,l]=t,[c]=e,[u,h]=n;this.outputShape=[c,u,h,l];const d="bilinear"===r?1:0,[p,f]=["".concat(a-1,".0"),"".concat(s-1,".0")],[m,g,y]=u>1?["".concat((a-1)/(u-1)),"(y2-y1) * height_ratio","y1*".concat(p," + float(y)*(height_scale)")]:["0.0","0.0","0.5 * (y1+y2) * ".concat(p)],[v,b,x]=h>1?["".concat((s-1)/(h-1)),"(x2-x1) * width_ratio","x1*".concat(f," + float(x)*(width_scale)")]:["0.0","0.0","0.5 * (x1+x2) * ".concat(f)];this.userCode="\n      const float height_ratio = float(".concat(m,");\n      const float width_ratio = float(").concat(v,");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ").concat(o,") {\n          return;\n        }\n\n        float height_scale = ").concat(g,";\n        float width_scale = ").concat(b,";\n\n        float in_y = ").concat(y,";\n        if( in_y < 0.0 || in_y > ").concat(p," ) {\n          setOutput(float(").concat(i,"));\n          return;\n        }\n        float in_x = ").concat(x,";\n        if( in_x < 0.0 || in_x > ").concat(f," ) {\n          setOutput(float(").concat(i,"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(").concat(d," == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    ")}}const R4={kernelName:_L,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n,attrs:r}=t,{image:i,boxes:o,boxInd:a}=e,{cropSize:s,method:l,extrapolationValue:c}=r,u=new I4(i.shape,o.shape,s,l,c);return n.runWebGLProgram(u,[i,o,a],"float32")}};var P4;!function(t){t.Prod="*",t.Sum="+"}(P4||(P4={}));class N4{constructor(t,e,n,r){this.op=t,this.outputShape=e,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const i=this.outputShape.length,o=this.op===P4.Prod?"1.0":"0.0",a=n?o:"getX(".concat(O4(i,"coords",this.op),")"),s=this.outputShape[this.outputShape.length-1];let l="",c="";n?(l=r?"end != ".concat(s-1):"end != 0",c=r?"end + 1":"end - 1"):(l=r?"end + pow2 < ".concat(s):"end >= pow2",c=r?"end + pow2":"end - pow2"),this.userCode="\n      void main() {\n        ".concat(zQ(i)," coords = getOutputCoords();\n        int end = ").concat(D4(i,"coords",this.op),";\n        float val = ").concat(a,";\n        int pow2 = int(pow(2.0, index));\n        if (").concat(l,") {\n          int idx = ").concat(c,";\n          ").concat(D4(i,"coords",this.op)," = idx;\n          val ").concat(this.op,"= getX(").concat(O4(i,"coords",this.op),");\n        }\n        setOutput(val);\n      }\n    ")}}function O4(t,e,n){if(1===t)return"".concat(e);if(2===t)return"".concat(e,".x, ").concat(e,".y");if(3===t)return"".concat(e,".x, ").concat(e,".y, ").concat(e,".z");if(4===t)return"".concat(e,".x, ").concat(e,".y, ").concat(e,".z, ").concat(e,".w");throw new Error("Cumulative ".concat(n," for rank ").concat(t," is not yet supported"))}function D4(t,e,n){if(1===t)return"".concat(e);if(2===t)return"".concat(e,".y");if(3===t)return"".concat(e,".z");if(4===t)return"".concat(e,".w");throw new Error("Cumulative ".concat(n," for rank ").concat(t," is not yet supported"))}function L4(t,e,n,r,i,o){const a=e.shape.length,s=nG([r],a);let l=e;null!=s&&(l=F2({inputs:{x:e},backend:n,attrs:{perm:s}}));const c=iG(1,a)[0];if(c!==a-1)throw new Error("WebGL cumprod shader expects an inner-most axis=".concat(e.shape.length-1," ")+"but got axis=".concat(r));const u=l.shape[c];let h=s2({inputs:{x:l},backend:n});for(let d=0;d<=Math.ceil(Math.log2(u))-1;d++){const e=new N4(t,l.shape,!1,o),r=[[d]],i=h;h=n.runWebGLProgram(e,[h],h.dtype,r),n.disposeIntermediateTensorInfo(i)}if(i){const e=new N4(t,l.shape,i,o),r=h;h=n.runWebGLProgram(e,[h],h.dtype),n.disposeIntermediateTensorInfo(r)}if(null!=s){const t=F2({inputs:{x:h},backend:n,attrs:{perm:rG(s)}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(l),t}return h}const F4={kernelName:bL,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:o,exclusive:a,reverse:s}=r;return L4(P4.Prod,i,n,o,a,s)}};const U4={kernelName:xL,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:o,exclusive:a,reverse:s}=r;return L4(P4.Sum,i,n,o,a,s)}};const B4={kernelName:wL,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,weights:o}=e,{size:a,binaryOutput:s}=r;if(1===i.shape.length){const t=n.readSync(i.dataId),e=n.readSync(o.dataId),r=D0(t,e,o.dtype,o.shape,a);return n.makeTensorInfo([a],o.dtype,r)}if(2===i.shape.length){const t=n.bufferSync(i),e=n.bufferSync(o),r=L0(t,e,a,s);return n.makeTensorInfo(r.shape,o.dtype,r.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+"".concat(i.shape.length,"."))}};class z4{constructor(t,e,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=e,this.dataFormat=n,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = ".concat(this.getHeightCoordString(),";\n      int w = ").concat(this.getWidthCoordString(),";\n      int d = ").concat(this.getDepthCoordString(),";\n\n      int in_h = h / ").concat(e,";\n      int offset_h = imod(h, ").concat(e,");\n      int in_w = w / ").concat(e,";\n      int offset_w = imod(w, ").concat(e,");\n      int offset_d = (offset_h * ").concat(e," + offset_w) *\n        ").concat(this.getOutputDepthSize(),";\n      int in_d = d + offset_d;\n\n      float result = ").concat(this.getInputSamplingString(),";\n      setOutput(result);\n    }\n  ")}getHeightCoordString(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"}getWidthCoordString(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"}getDepthCoordString(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"}getOutputDepthSize(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}const j4={kernelName:SL,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{blockSize:o,dataFormat:a}=r,s=i.shape[0],l=("NHWC"===a?i.shape[1]:i.shape[2])*o,c=("NHWC"===a?i.shape[2]:i.shape[3])*o,u=("NHWC"===a?i.shape[3]:i.shape[1])/(o*o),h=new z4("NHWC"===a?[s,l,c,u]:[s,u,l,c],o,a);return n.runWebGLProgram(h,[i],i.dtype)}};class V4{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=XQ(this.outputShape.length);const o=t.filterHeight,a=t.filterWidth,s=t.outChannels/t.inChannels;let l="",c="";n&&(l=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):i?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):"\n          float activation(float x) {\n            ".concat(n,"\n          }\n        "),c="result = activation(result);");const u=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(l,"\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(s,";\n        int q = d2 - d1 * ").concat(s,";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ").concat(o,"; wR++) {\n          int xR = xRCorner + wR * dilations[0];\n\n          if (xR < 0 || xR >= inDims[0]) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(a,"; wC++) {\n            int xC = xCCorner + wC * dilations[1];\n\n            if (xC < 0 || xC >= inDims[1]) {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ").concat(u,"\n        ").concat(c,"\n        setOutput(result);\n      }\n    ")}}class W4{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=XQ(this.outputShape.length);const o=t.outChannels/t.inChannels,a=t.padInfo.left,s=t.strideWidth,l=t.dilationWidth,c=t.filterHeight,u=t.filterWidth,h=u;let d="\n      int xR; int xC; int xCOffset;\n      vec4 wTexel; vec4 previous; vec4 final;";for(let g=0;g<u;g++)d+="\n          vec4 xTexelC".concat(2*g,";\n          int xTexelC").concat(2*g,"Ready;\n          vec4 xTexelC").concat(2*g+1,";\n          int xTexelC").concat(2*g+1,"Ready;\n          vec4 xC").concat(g,";");d+="\n    for (int r = 0; r < ".concat(c,"; r++) {\n      ");for(let g=0;g<u;g++)d+="\n          xTexelC".concat(2*g," = vec4(0.0);\n          xTexelC").concat(2*g,"Ready = 0;\n          xTexelC").concat(2*g+1," = vec4(0.0);\n          xTexelC").concat(2*g+1,"Ready = 0;\n          xC").concat(g," = vec4(0.0);");d+="\n        xR = xRCorner + r * dilations[0];\n        if (xR >=0 && xR < inDims[0]) {\n      ";for(let g=0;g<(h+1)/2;g++){const t=2*g;if(d+="\n          xC = xCCorner + ".concat(t*l,";\n          "),1===s){if(t<u&&(a%2===1?(d+="\n                xCOffset = xC + 1;\n                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(t,"Ready == 0) {\n                  xTexelC").concat(t," = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(t,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(t,"Ready = 1;\n                }\n              "),d+=1===l&&t>0?"\n                xC".concat(t," = vec4(xTexelC").concat(t-2,".zw, xTexelC").concat(t,".xy);\n                "):"\n                  xCOffset = xC + 1 - 2;\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                    previous = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      previous.zw = vec2(0.0);\n                    }\n\n                    xC".concat(t," = vec4(previous.zw, xTexelC").concat(t,".xy);\n                  } else {\n                    xC").concat(t," = vec4(0.0, 0.0, xTexelC").concat(t,".xy);\n                  }\n                  ")):d+="\n                if (xC >= 0 && xC < inDims[1] && xTexelC".concat(t,"Ready == 0) {\n                  xTexelC").concat(t," = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC").concat(t,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(t,"Ready = 1;\n                }\n\n                xC").concat(t," = xTexelC").concat(t,";\n                "),t+1<u)){const e=a%2===0?iD(l):l;l%2===0&&a%2===1||l%2!==0&&a%2!==1?(d+="\n                  xCOffset = xC + imod(pads[1], 2) + ".concat(e,";\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(t+1,"Ready == 0) {\n                    xTexelC").concat(t+1," = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      xTexelC").concat(t+1,".zw = vec2(0.0);\n                    }\n                    xTexelC").concat(t+1,"Ready = 1;\n                  }\n                  "),d+=l>1?"\n                    xCOffset -= 2;\n                    if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n                     xC".concat(t+1," = vec4(previous.zw, xTexelC").concat(t+1,".xy);\n                    } else {\n                     xC").concat(t+1," = vec4(0.0, 0.0, xTexelC").concat(t+1,".xy);\n                    }\n                    "):"\n                    xC".concat(t+1," = vec4(xTexelC").concat(t,".zw, xTexelC").concat(t+1,".xy);\n                    ")):d+=1===e?"\n                    xC".concat(t+1," = xTexelC").concat(t,";\n                    "):"\n                    xCOffset = xC + ".concat(e,";\n\n                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(t+1,"Ready == 0) {\n                      xTexelC").concat(t+1," = getX(batch, xR, xCOffset, d1);\n                      if (xCOffset + 1 >= inDims[1]) {\n                        xTexelC").concat(t+1,".zw = vec2(0.0);\n                      }\n                      xTexelC").concat(t+1,"Ready = 1;\n                    }\n\n                    xC").concat(t+1," = xTexelC").concat(t+1,";\n                    ")}}else t<u&&(a%2===1?(d+="\n                xCOffset = xC + 1 - strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(t,"Ready == 0) {\n                  xTexelC").concat(t," = getX(batch, xR, xCOffset, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(t,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(t,"Ready = 1;\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC").concat(t+1,"Ready == 0) {\n                  xTexelC").concat(t+1," = getX(batch, xR, xC + 1, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xC + 2 >= inDims[1]) {\n                    xTexelC").concat(t+1,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(t+1,"Ready = 1;\n                }\n\n                xC").concat(t," = vec4(xTexelC").concat(t,".zw, xTexelC").concat(t+1,".zw);\n              "),t+1<u&&(d+="\n                  final = vec4(0.0);\n                  xCOffset = xC + 1 + strides[1];\n                  if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xC".concat(t+1," = vec4(xTexelC").concat(t+1,".xy, final.xy);\n                "))):(d+="\n                if(xC >= 0 && xC < inDims[1] && xTexelC".concat(t,"Ready == 0) {\n                  xTexelC").concat(t," = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC").concat(t,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(t,"Ready = 1;\n                }\n\n                xCOffset = xC + strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(t+1,"Ready == 0) {\n                  xTexelC").concat(t+1," = getX(batch, xR, xCOffset, d1);\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(t+1,".zw = vec2(0.);\n                  }\n                  xTexelC").concat(t+1,"Ready = 1;\n                }\n\n                xC").concat(t," = vec4(\n                  xTexelC").concat(t,".xy, xTexelC").concat(t+1,".xy);\n              "),t+1<u&&(d+="\n                  xC".concat(t+1," = vec4(xTexelC").concat(t,".zw, xTexelC").concat(t+1,".zw);\n                "))));t<u&&(d+="\n            wTexel = getW(r, ".concat(t,", d1, q);\n            dotProd += xC").concat(t," * vec4(wTexel.xz, wTexel.xz);\n          "),t+1<u&&(d+="\n              wTexel = getW(r, ".concat(t+1,", d1, q);\n              dotProd += xC").concat(t+1," * vec4(wTexel.xz, wTexel.xz);\n            ")))}d+="\n    }\n  ",d+="\n      }\n    ";let p="",f="";n&&(p=r?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):i?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(n,"\n        }"),f="result = activation(result);");const m=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(p,"\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(o,";\n        int q = d2 - d1 * ").concat(o,";\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n        vec4 dotProd = vec4(0.000000000000001);\n\n        ").concat(d,"\n\n        vec4 result = dotProd - vec4(0.000000000000001);\n        ").concat(m,"\n        ").concat(f,"\n        setOutput(result);\n      }\n    ")}}const G4={kernelName:TL,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:o}=e,{strides:a,pad:s,dilations:l,dimRoundingMode:c}=r;let u=l;null==u&&(u=[1,1]),aD($V(a,u),(()=>"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(a," and dilations '").concat(u,"'")));const h=HV(i.shape,o.shape,a,u,s,c,!0);let d;d=FD().getBool("WEBGL_PACK_DEPTHWISECONV")&&h.strideWidth<=2&&h.outChannels/h.inChannels===1?new W4(h):new V4(h);const p=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];return n.runWebGLProgram(d,[i,o],"float32",p)}};class H4{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const e=t.strideHeight,n=t.strideWidth,r=t.padInfo.top,i=t.padInfo.left,o=t.outChannels/t.inChannels;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ".concat(o," + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ").concat(t.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(e," - ").concat(r,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(n," - ").concat(i,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class q4{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,i=t.strideWidth,o=e-1-t.padInfo.top,a=n-1-t.padInfo.left,s=t.outChannels/t.inChannels;this.userCode="\n      const ivec2 pads = ivec2(".concat(o,", ").concat(a,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ").concat(e,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(r,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(e," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ").concat(s,"; dm++) {\n              int d2 = d1 * ").concat(s," + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}const X4={kernelName:EL,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,dy:o}=e,{strides:a,dilations:s,pad:l,dimRoundingMode:c,filterShape:u}=r,h=HV(i.shape,u,a,s,l,c,!0),d=new H4(h);return n.runWebGLProgram(d,[i,o],"float32")}};const Y4={kernelName:ML,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,filter:o}=e,{strides:a,dilations:s,pad:l,dimRoundingMode:c,inputShape:u}=r,h=HV(u,o.shape,a,s,l,c,!0),d=new q4(h);return n.runWebGLProgram(d,[i,o],"float32")}};class K4{constructor(t){this.variableNames=["X"],this.outputShape=[t,t],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "}}const Z4={kernelName:CL,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{x:r}=e,i=[...r.shape,...r.shape],o=cD(r.shape),a=C2({inputs:{x:r},backend:n,attrs:{shape:[o]}}),s=new K4(o),l=n.runWebGLProgram(s,[a],a.dtype),c=C2({inputs:{x:l},backend:n,attrs:{shape:i}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),c}};class J4{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const{inHeight:e,inWidth:n,padInfo:r,strideHeight:i,strideWidth:o,filterHeight:a,filterWidth:s,dilationHeight:l,dilationWidth:c}=t,{top:u,left:h}=r;this.userCode="\n      const ivec2 strides = ivec2(".concat(i,", ").concat(o,");\n      const ivec2 pads = ivec2(").concat(u,", ").concat(h,");\n      const float neg_infinity = -3.4e38;\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.w;\n        ivec2 outTopLeftCorner =\n            coords.yz * strides - pads;\n        int hBeg = outTopLeftCorner.x;\n        int wBeg = outTopLeftCorner.y;\n\n        float curVal = neg_infinity;\n        for (int h = 0; h < ").concat(a,"; h++) {\n          int hIn = hBeg + h * ").concat(l,";\n\n          if (hIn >= 0 && hIn < ").concat(e,") {\n            for (int w = 0; w < ").concat(s,"; w++) {\n              int wIn = wBeg + w * ").concat(c,";\n\n              if (wIn >= 0 && wIn < ").concat(n,") {\n                float xVal = getX(batch, hIn, wIn, d1);\n                float wVal = getW(h, w, d1);\n\n                float val = xVal + wVal;\n                if (val > curVal) {\n                  curVal = val;\n                }\n              }\n            }\n          }\n        }\n\n        float result = curVal;\n        setOutput(result);\n      }\n    ")}}const Q4={kernelName:AL,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:o}=e,{strides:a,pad:s,dilations:l}=r,c=VV(i.shape,o.shape,a,s,"NHWC",l);let u;const h=new J4(c);u=n.runWebGLProgram(h,[i,o],"float32");const d=C2({inputs:{x:u},backend:n,attrs:{shape:c.outShape}});return n.disposeIntermediateTensorInfo(u),d}};const $4={kernelName:RL,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{equation:i}=r,o=e,{allDims:a,summedDims:s,idDims:l}=IY(i,o.length);PY(a.length,l,o);const{path:c,steps:u}=NY(s,l),h=u.length;let d=null,p=a.length;const f=[];for(let m=0;m<h;++m){for(const t of u[m]){const{permutationIndices:e,expandDims:r}=RY(p,l[t]);let i;OY(e)?i=o[t]:(i=F2({inputs:{x:o[t]},backend:n,attrs:{perm:e}}),f.push(i));const a=i.shape.slice();for(let t=0;t<r.length;++t)a.splice(r[t],0,1);uD(i.shape,a)||(i=C2({inputs:{x:i},backend:n,attrs:{shape:a}}),f.push(i)),null===d?d=i:(d=E2({inputs:{a:i,b:d},backend:n}),f.push(d))}m<h-1&&(c[m]>=0&&(d=D2({inputs:{x:d},backend:n,attrs:{axis:c[m]-(a.length-p),keepDims:!1}}),f.push(d)),p--)}for(const m of f)m!==d&&n.disposeIntermediateTensorInfo(m);return d}},t6={kernelName:"Elu",backendName:"webgl",kernelFunc:v2({opSnippet:"return (x >= 0.0) ? x : (exp(x) - 1.0);",packedOpSnippet:"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n"})},e6={kernelName:"EluGrad",backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n}=t,{dy:r,y:i}=e,o=FD().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new a2("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",r.shape,i.shape):new i2("return (b >= 0.0) ? a : a * (b + 1.0);",r.shape,i.shape);return n.runWebGLProgram(o,[r,i],r.dtype)}},n6=b2({opSnippet:"return float(a == b);",packedOpSnippet:"\n  return vec4(equal(a, b));\n",dtype:"bool",cpuKernelImpl:j0}),r6={kernelName:PL,backendName:"webgl",kernelFunc:n6},i6={kernelName:"Erf",backendName:"webgl",kernelFunc:v2({opSnippet:'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = '.concat(dY,";\n  float a1 = ").concat(pY,";\n  float a2 = ").concat(fY,";\n  float a3 = ").concat(mY,";\n  float a4 = ").concat(gY,";\n  float a5 = ").concat(yY,";\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n")})},o6=v2({opSnippet:y2+"\n  return exp(x);\n",packedOpSnippet:"\n  vec4 result = exp(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:V0,dtype:"float32"}),a6={kernelName:NL,backendName:"webgl",kernelFunc:o6};function s6(t){const{inputs:e,attrs:n,backend:r}=t,{dim:i}=n,{input:o}=e,a=o.shape.length,s=o.shape.slice();let l=i;return i<0&&(aD(-(a+1)<=i,(()=>"Axis must be in the interval [".concat(-(a+1),", ").concat(a,"]"))),l=a+i+1),s.splice(l,0,1),C2({inputs:{x:o},backend:r,attrs:{shape:s}})}const l6={kernelName:OL,backendName:"webgl",kernelFunc:s6},c6="return exp(x) - 1.0;",u6=v2({opSnippet:c6,packedOpSnippet:c6,cpuKernelImpl:W0}),h6={kernelName:DL,backendName:"webgl",kernelFunc:u6};class d6{constructor(t,e,n){this.variableNames=["real","imag"];const r=e[1];this.outputShape=e;const i=n?"2.0 * ".concat(Math.PI):"-2.0 * ".concat(Math.PI),o=n?"".concat(r,".0"):"1.0";let a;if("real"===t)a="return real * expR - imag * expI;";else{if("imag"!==t)throw new Error('FFT component must be either "real" or "imag", got '.concat(t,"."));a="return real * expI + imag * expR;"}this.userCode="\n      const float exponentMultiplier = ".concat(i,";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        ").concat(a,"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float(").concat(r,");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < ").concat(r,"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / ").concat(o,";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    ")}}function p6(t,e,n){const r=n.texData.get(t.dataId),i=cD(t.shape),o=t.shape[t.shape.length-1],a=C2({inputs:{x:t},backend:n,attrs:{shape:[i/o,o]}}),s=a.shape,l=new d6("real",s,e),c=new d6("imag",s,e),u=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:s},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:s}],h=n.runWebGLProgram(l,u,"float32"),d=n.runWebGLProgram(c,u,"float32"),p=c2({inputs:{real:h,imag:d},backend:n});n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d);const f=C2({inputs:{x:p},backend:n,attrs:{shape:t.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(p),f}const f6={kernelName:"FFT",backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{input:r}=e;return p6(r,!1,n)}};class m6{constructor(t,e){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=t,this.userCode="\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}}function g6(t){const{backend:e,attrs:n}=t,{shape:r,value:i}=n;let{dtype:o}=n;if(o=o||wD(i),"string"===o){const t=vD(o,cD(r));return t.fill(i),e.makeTensorInfo(r,o,t)}{const t=new m6(r,i),n=[[i]];return e.runWebGLProgram(t,[],o,n)}}const y6={kernelName:LL,backendName:"webgl",kernelFunc:g6};class v6{constructor(t){this.variableNames=["Image"],this.outputShape=[];const e=t[2];this.outputShape=t,this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n\n          int coordX = ".concat(e," - x - 1;\n          float outputValue;\n          if(coordX >= 0 && coordX < ").concat(e,") {\n            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);\n          } else {\n            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")}}const b6={kernelName:FL,backendName:"webgl",kernelFunc:t=>{let{inputs:e,backend:n}=t;const{image:r}=e,i=n,o=new v6(r.shape);return i.runWebGLProgram(o,[r],r.dtype)}},x6="return floor(x);",_6=v2({opSnippet:x6,packedOpSnippet:x6,cpuKernelImpl:G0}),w6={kernelName:UL,backendName:"webgl",kernelFunc:_6},S6=b2({opSnippet:"\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",packedOpSnippet:"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n",dtype:"int32"}),T6={kernelName:BL,backendName:"webgl",kernelFunc:S6};class E6{constructor(t){this.variableNames=["A"];const e=TQ(),[n,r]=t;this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(".concat(r,".0, ").concat(n,".0);\n\n        vec4 values = ").concat(e.texture2D,"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    ")}}class M6{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const e=TQ(),[n,r]=t;this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(".concat(r,".0, ").concat(n,".0);\n            vec4 values = ").concat(e.texture2D,"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ").concat(e.output," = result;\n      }\n    ")}}const C6={kernelName:wU,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t;let{pixels:i}=e;const{numChannels:o}=r,a="undefined"!==typeof HTMLVideoElement&&i instanceof HTMLVideoElement,s="undefined"!==typeof HTMLImageElement&&i instanceof HTMLImageElement,[l,c]=a?[i.videoWidth,i.videoHeight]:[i.width,i.height],u=[c,l],h=[c,l,o];if(s||a){const t=FD().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");null!=A6&&t===k6||(k6=t,A6=document.createElement("canvas").getContext("2d",{willReadFrequently:k6})),A6.canvas.width=l,A6.canvas.height=c,A6.drawImage(i,0,0,l,c),i=A6.canvas}const d=n.makeTensorInfo(u,"int32");n.texData.get(d.dataId).usage=qJ.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(d.dataId),i);const p=FD().getBool("WEBGL_PACK")?new M6(h):new E6(h),f=n.runWebGLProgram(p,[d],"int32");return n.disposeData(d.dataId),f}};let A6,k6=FD().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");const I6={kernelName:EU,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:o,bias:a,preluActivationWeights:s}=e,{strides:l,pad:c,dataFormat:u,dilations:h,dimRoundingMode:d,activation:p,leakyreluAlpha:f}=r,m=eW(u),g=HV(i.shape,o.shape,l,h,c,d,!1,m);let y;const v=[],b=null!=a,x=null!=s,_="leakyrelu"===p,w=()=>{const t=[i,o],e=(t,e)=>{if("NCHW"===e&&1===t.shape.length&&1!==t.shape[0]){const e=C2({inputs:{x:t},backend:n,attrs:{shape:[t.shape[0],1,1]}});return v.push(e),e}return t};if(b&&t.push(e(a,u)),x&&t.push(e(s,u)),_){const e=n.makeTensorInfo([],"float32",JU(f,"float32"));t.push(e),v.push(e)}return t};if(1!==g.filterHeight||1!==g.filterWidth||1!==g.dilationHeight||1!==g.dilationWidth||1!==g.strideHeight||1!==g.strideWidth||"SAME"!==g.padInfo.type&&"VALID"!==g.padInfo.type)if(g.strideWidth<=2&&"channelsLast"===m&&FD().getBool("WEBGL_EXP_CONV")){const t=p?x2(p,!0):null,e=new h4(g,b,t,x,_),r=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],i=w();y=n.runWebGLProgram(e,i,"float32",r)}else if(FD().getBool("WEBGL_CONV_IM2COL"))y=m4({x:i,filter:o,convInfo:g,backend:n,bias:a,activation:p,preluActivationWeights:s,leakyreluAlpha:f});else{const t=p?x2(p,!1):null,e=new c4(g,b,t,x,_),r=w();y=n.runWebGLProgram(e,r,"float32")}else y=f4({x:i,filter:o,convInfo:g,backend:n,bias:a,activation:p,preluActivationWeights:s,leakyreluAlpha:f});const S=C2({inputs:{x:y},backend:n,attrs:{shape:g.outShape}});return v.push(y),v.forEach((t=>n.disposeIntermediateTensorInfo(t))),S}};const R6={kernelName:MU,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:o,bias:a,preluActivationWeights:s}=e,{strides:l,pad:c,dilations:u,dimRoundingMode:h,activation:d,leakyreluAlpha:p}=r,f=[];let m=u;null==m&&(m=[1,1]),aD($V(l,m),(()=>"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(l," and dilations '").concat(m,"'")));const g=HV(i.shape,o.shape,l,m,c,h,!0),y=FD().getBool("WEBGL_PACK_DEPTHWISECONV")&&g.strideWidth<=2&&g.outChannels/g.inChannels===1,v=d?x2(d,y):null,b=[i,o],x=null!=a,_=null!=s,w="leakyrelu"===d;if(x&&b.push(a),_&&b.push(s),w){const t=n.makeTensorInfo([],"float32",JU(p,"float32"));b.push(t),f.push(t)}let S;S=y?new W4(g,x,v,_,w):new V4(g,x,v,_,w);const T=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],E=n.runWebGLProgram(S,b,"float32",T);return f.forEach((t=>n.disposeIntermediateTensorInfo(t))),E}};class P6{constructor(t,e,n,r){this.sliceDim=t,this.strides=e,this.paramsShape=r,this.variableNames=["x","indices"],this.outputShape=n;const i=zQ(n.length);let o="\n    int index;";for(let a=0;a<this.sliceDim;a++)o+="\n          index = round(getIndices(coords[0], ".concat(a,"));\n          out_of_bounds = out_of_bounds || index < 0;\n          out_of_bounds = out_of_bounds || index >= ").concat(this.paramsShape[a],";\n          flattenIndex += index * ").concat(this.strides[a],";");this.userCode="\n         void main() {\n          ".concat(i," coords = getOutputCoords();\n          int flattenIndex = 0;\n          bool out_of_bounds = false;\n\n          ").concat(o,"\n\n          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));\n        }\n      ")}}const N6={kernelName:VL,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{params:r,indices:i}=e,o=i.shape,a=o[o.length-1],s=cD(r.shape),[l,c,u,h]=cY(r,i),d=C2({inputs:{x:i},backend:n,attrs:{shape:[c,a]}}),p=C2({inputs:{x:r},backend:n,attrs:{shape:[cD(r.shape)/u,u]}});if(n.shouldExecuteOnCPU([r,i])||"string"===r.dtype){const t=n.readSync(i.dataId),e=n.bufferSync(r),o=H0(t,e,r.dtype,c,a,u,h,r.shape,s);return n.makeTensorInfo(l,r.dtype,o.values)}const f=new P6(a,h,[c,u],r.shape),m=n.runWebGLProgram(f,[p,d],p.dtype),g=C2({inputs:{x:m},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),g}};class O6{constructor(t,e){this.variableNames=["A","indices"],this.outputShape=e,this.rank=e.length;const n=zQ(this.rank),r=function(t,e){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let i=0;i<t.length;i++)2===i?r.push("index"):r.push("".concat(n[i]));return r.join()}(t);this.userCode="\n      void main() {\n        ".concat(n," resRC = getOutputCoords();\n        int index = int(getIndices(resRC.x, resRC.z));\n        float inBounds = (index >= 0) && (index < ").concat(t[2],") ? 1.0 : 0.0;\n        setOutput(inBounds * getA(").concat(r,"));\n      }\n    ")}}function D6(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,indices:o}=e,{axis:a,batchDims:s}=r,l=mD(a,i.shape)[0];if(FD().get("DEBUG")){const t=n.readSync(o.dataId),e=i.shape[l];for(let n=0;n<t.length;++n){const r=t[n];aD(r<=e-1&&r>=0,(()=>"GatherV2: the index value ".concat(r," is not in [0, ").concat(e-1,"]")))}}const c=JY(i,o,l,s),u=cD(o.shape),h=[],d=C2({inputs:{x:i},backend:n,attrs:{shape:[c.batchSize,c.outerSize,c.dimSize,c.sliceSize]}}),p=C2({inputs:{x:o},backend:n,attrs:{shape:[c.batchSize,u/c.batchSize]}});h.push(d),h.push(p);const f=[c.batchSize,c.outerSize,u/c.batchSize,c.sliceSize];if(n.shouldExecuteOnCPU([i,o])||"string"===i.dtype){const t=n.bufferSync(p),e=n.bufferSync(d),r=q0(e,t,f);return h.forEach((t=>n.disposeIntermediateTensorInfo(t))),n.makeTensorInfo(c.outputShape,r.dtype,r.values)}const m=new O6(d.shape,f),g=n.runWebGLProgram(m,[d,p],d.dtype);h.push(g);const y=C2({inputs:{x:g},backend:n,attrs:{shape:c.outputShape}});return h.forEach((t=>n.disposeIntermediateTensorInfo(t))),y}const L6={kernelName:jL,backendName:"webgl",kernelFunc:D6},F6=b2({opSnippet:"return float(a > b);",packedOpSnippet:"\n  return vec4(greaterThan(a, b));\n",cpuKernelImpl:X0,dtype:"bool"}),U6={kernelName:WL,backendName:"webgl",kernelFunc:F6},B6=b2({opSnippet:"return float(a >= b);",packedOpSnippet:"\n  return vec4(greaterThanEqual(a, b));\n",dtype:"bool",cpuKernelImpl:Y0}),z6={kernelName:GL,backendName:"webgl",kernelFunc:B6};const j6={kernelName:qL,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{input:r}=e;return p6(r,!0,n)}},V6=v2({opSnippet:"return float(!isnan(x) && !isinf(x));",dtype:"bool"}),W6={kernelName:YL,backendName:"webgl",kernelFunc:V6},G6=v2({opSnippet:"return float(isinf(x));",dtype:"bool"}),H6={kernelName:KL,backendName:"webgl",kernelFunc:G6},q6=v2({opSnippet:"return float(isnan(x));",dtype:"bool"}),X6={kernelName:ZL,backendName:"webgl",kernelFunc:q6},Y6=b2({opSnippet:"return float(a < b);",packedOpSnippet:"\n  return vec4(lessThan(a, b));\n",cpuKernelImpl:K0,dtype:"bool"}),K6={kernelName:QL,backendName:"webgl",kernelFunc:Y6},Z6=b2({opSnippet:"return float(a <= b);",packedOpSnippet:"\n  return vec4(lessThanEqual(a, b));\n",cpuKernelImpl:Z0,dtype:"bool"}),J6={kernelName:$L,backendName:"webgl",kernelFunc:Z6};const Q6={kernelName:tF,backendName:"webgl",kernelFunc:function(t){const{backend:e,attrs:n}=t,{start:r,stop:i,num:o}=n,a=J0(r,i,o);return e.makeTensorInfo([a.length],"float32",a)}},$6=v2({opSnippet:y2+"\n  return x < 0.0 ? 0./0. : log(x);\n",packedOpSnippet:"\n  vec4 result = log(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);\n  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);\n  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);\n  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);\n  return result;\n",cpuKernelImpl:Q0}),t5={kernelName:eF,backendName:"webgl",kernelFunc:$6},e5=v2({opSnippet:y2+"\n  return log(1.0 + x);\n"}),n5={kernelName:nF,backendName:"webgl",kernelFunc:e5},r5=b2({opSnippet:"return float(a >= 1.0 && b >= 1.0);",packedOpSnippet:"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n",dtype:"bool"}),i5={kernelName:rF,backendName:"webgl",kernelFunc:r5},o5=v2({opSnippet:"return float(!(x >= 1.0));"}),a5={kernelName:iF,backendName:"webgl",kernelFunc:o5},s5=b2({opSnippet:"return float(a >= 1.0 || b >= 1.0);",packedOpSnippet:"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n",dtype:"bool"}),l5={kernelName:oF,backendName:"webgl",kernelFunc:s5};class c5{constructor(t,e,n,r,i){this.variableNames=["x"],this.outputShape=[];const o=e,a=t[3]-1;let s;this.outputShape=t;const l="float(".concat(n,") + float(").concat(r,") * sum");s=.5===i?"inversesqrt(".concat(l,")"):1===i?"1.0/(".concat(l,")"):"exp(log(".concat(l,") * float(-").concat(i,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -".concat(o,"; j <= ").concat(o,"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  ").concat(a,") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * ").concat(s,";\n        setOutput(val);\n      }\n    ")}}class u5{constructor(t,e,n,r,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const o=e,a=t[3]-1;let s;this.outputShape=t;const l="float(".concat(n,") + float(").concat(r,") * sum");s=.5===i?"inversesqrt(".concat(l,")"):1===i?"1.0/(".concat(l,")"):"exp(log(".concat(l,") * float(-").concat(i,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < ".concat(this.outputShape[3],";\n        bool hasNextRow = c < ").concat(this.outputShape[2],";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - ").concat(o,";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - ").concat(o,"; j <= ").concat(o,"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(").concat(a,"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * ").concat(s,";\n        setOutput(result);\n      }\n    ")}}const h5={kernelName:"LRN",backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{depthRadius:o,bias:a,alpha:s,beta:l}=r,c=FD().getBool("WEBGL_PACK_NORMALIZATION")?new u5(i.shape,o,a,s,l):new c5(i.shape,o,a,s,l);return n.runWebGLProgram(c,[i],i.dtype)}};class d5{constructor(t,e,n,r,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=e,this.bias=n,this.alpha=r,this.beta=i,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ".concat(this.depth,"; ++d) {\n          int depthBegin = int(max(0.0, float(d - ").concat(e,")));\n          int depthEnd = int(min(float(").concat(this.depth,"),\n              float(d + ").concat(e," + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ").concat(this.depth,";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(").concat(r,") * norm + float(").concat(n,");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(").concat(r,")\n                * float(").concat(i,")\n                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ").concat(i,");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    ")}}const p5={kernelName:"LRNGrad",backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n,attrs:r}=t,{x:i,y:o,dy:a}=e,{depthRadius:s,bias:l,alpha:c,beta:u}=r,h=new d5(i.shape,s,l,c,u);return n.runWebGLProgram(h,[i,o,a],i.dtype)}};function f5(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{reductionIndices:o,keepDims:a}=r,s=i.shape.length,l=mD(o,i.shape);let c=l;const u=nG(c,s),h=null!=u,d=n.shouldExecuteOnCPU([i]);let p=i;if(h){if(d){const t=n.texData.get(p.dataId).values,e=new Array(s);for(let n=0;n<e.length;n++)e[n]=i.shape[u[n]];const r=C1(t,i.shape,i.dtype,u,e);p=n.makeTensorInfo(e,i.dtype);n.texData.get(p.dataId).values=r}else p=O2(i,u,n);c=iG(c.length,s)}eG("max",c,s);const[f,m]=$W(p.shape,c);let g,y=f;if(a&&(y=tG(f,l)),d){const t=n.texData.get(p.dataId).values,e=$0(t,cD(m),y,i.dtype);g=n.makeTensorInfo(y,i.dtype);n.texData.get(g.dataId).values=e}else g=function(t,e,n,r){const i=cD(e),o=C2({inputs:{x:t},attrs:{shape:[cD(t.shape)/i,i]},backend:r}),a=R2(o,t.dtype,"max",r),s=C2({inputs:{x:a},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(a),s}(p,m,y,n);return h&&n.disposeIntermediateTensorInfo(p),g}const m5={kernelName:"Max",backendName:"webgl",kernelFunc:f5},g5=b2({opSnippet:r2+"\n  return max(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(max(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+o2+"\n  return result;\n",cpuKernelImpl:t1}),y5={kernelName:aF,backendName:"webgl",kernelFunc:g5};const v5={kernelName:sF,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e;wQ(i,"maxPool");const{filterSize:o,strides:a,pad:s,dimRoundingMode:l}=r;aD($V(a,1),(()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(a," and dilations '").concat(1,"'")));const c=WV(i.shape,o,a,1,s,l);if(1===c.filterWidth&&1===c.filterHeight&&uD(c.inShape,c.outShape))return s2({inputs:{x:i},backend:n});const u=new b3(c,"max",!1);return n.runWebGLProgram(u,[i],i.dtype)}};const b5={kernelName:lF,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{filterSize:o,strides:a,pad:s,dataFormat:l,dimRoundingMode:c}=r,u=GV(i.shape,o,a,[1,1,1],s,c,l),h=new x3(u,"max",!1);return n.runWebGLProgram(h,[i],i.dtype)}};class x5{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const e=t.strideHeight,n=t.strideWidth,r=t.dilationHeight,i=t.effectiveFilterHeight,o=t.effectiveFilterWidth,a=i-1-t.padInfo.top,s=o-1-t.padInfo.left,l=i*o-1;this.userCode="\n      const ivec2 pads = ivec2(".concat(a,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(i,";\n          wR += ").concat(r,") {\n          float dyR = float(dyRCorner + wR) / ").concat(e,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(o,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(n,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = ").concat(l," - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * ").concat(o," + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class _5{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const e=t.strideDepth,n=t.strideHeight,r=t.strideWidth,i=t.dilationDepth,o=t.dilationHeight,a=t.dilationWidth,s=t.effectiveFilterDepth,l=t.effectiveFilterHeight,c=t.effectiveFilterWidth,u=s-1-t.padInfo.front,h=l-1-t.padInfo.top,d=c-1-t.padInfo.left,p=s*l*c-1;this.userCode="\n      const ivec3 pads = ivec3(".concat(u,", ").concat(h,", ").concat(d,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(s,";\n           wD += ").concat(i,") {\n          float dyD = float(dyDCorner + wD) / ").concat(e,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(t.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(l,";\n              wR += ").concat(o,") {\n            float dyR = float(dyRCorner + wR) / ").concat(n,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(c,";\n                wC += ").concat(a,") {\n              float dyC = float(dyCCorner + wC) / ").concat(r,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = ").concat(p," -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * ").concat(l," * ").concat(c," +\n                  wR * ").concat(c," + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}const w5={kernelName:"MaxPool3DGrad",backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,input:o}=e,a=o,{filterSize:s,strides:l,pad:c,dimRoundingMode:u}=r,h=GV(a.shape,s,l,[1,1,1],c,u),d=new x3(h,"max",!0),p=n.runWebGLProgram(d,[a],a.dtype),f=new _5(h),m=n.runWebGLProgram(f,[i,p],a.dtype);return n.disposeIntermediateTensorInfo(p),m}};const S5={kernelName:"MaxPoolGrad",backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,input:o,output:a}=e,s=o;wQ([o,a],"maxPoolGrad");const{filterSize:l,strides:c,pad:u,dimRoundingMode:h}=r,d=WV(s.shape,l,c,1,u,h),p=new b3(d,"max",!0),f=n.runWebGLProgram(p,[s],s.dtype),m=new x5(d),g=n.runWebGLProgram(m,[i,f],s.dtype);return n.disposeIntermediateTensorInfo(f),g}};const T5={kernelName:cF,backendName:"webgl",kernelFunc:t=>{let{inputs:e,attrs:n,backend:r}=t;const{x:i}=e,{filterSize:o,strides:a,pad:s,includeBatchInIndex:l}=n,c=r;aD(4===i.shape.length,(()=>"Error in maxPool: input must be rank 4 but got rank ".concat(i.shape.length,".")));const u=[1,1];aD($V(a,u),(()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(a," and dilations '").concat(u,"'")));const h=WV(i.shape,o,a,u,s),[d,p]=function(t,e,n,r){let i=new b3(n,"max",!1);const o=r.runWebGLProgram(i,[t],"float32");return i=new b3(n,"max",!0,!0,e),[o,r.runWebGLProgram(i,[t],"float32")]}(i,l,h,c);return[d,p]}};const E5={kernelName:uF,backendName:"webgl",kernelFunc:t=>{let{inputs:e,attrs:n,backend:r}=t;const{x:i}=e,{keepDims:o,axis:a}=n,s=r,l=i.shape.length,c=mD(a,i.shape);let u=c;const h=nG(u,l),d=null!=h,p=s.shouldExecuteOnCPU([i]),f=[];let m=i;if(d){if(p){const t=s.texData.get(m.dataId).values,e=new Array(l);for(let r=0;r<e.length;r++)e[r]=i.shape[h[r]];const n=C1(t,i.shape,i.dtype,h,e);m=s.makeTensorInfo(e,i.dtype);s.texData.get(m.dataId).values=n}else m=O2(i,h,s);f.push(m),u=iG(u.length,l)}eG("sum",u,l);const[g,y]=$W(m.shape,u);let v=g;o&&(v=tG(g,c));const b=function(t,e,n,r){const i=cD(e),o=C2({inputs:{x:t},attrs:{shape:[cD(t.shape)/i,i]},backend:r}),a=R2(o,"float32","mean",r),s=C2({inputs:{x:a},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(a),s}(m,y,v,s);for(const x of f)s.disposeIntermediateTensorInfo(x);return b}};const M5={kernelName:"Min",backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:o,keepDims:a}=r,s=i.shape.length,l=mD(o,i.shape);let c=l;const u=nG(c,s);let h=i;null!=u&&(h=F2({inputs:{x:i},backend:n,attrs:{perm:u}}),c=iG(c.length,i.shape.length)),eG("min",c,s);const[d,p]=$W(h.shape,c),f=C2({inputs:{x:h},backend:n,attrs:{shape:[-1,cD(p)]}}),m=R2(f,f.dtype,"min",n);let g;if(a){g=C2({inputs:{x:m},backend:n,attrs:{shape:tG(d,l)}})}else g=C2({inputs:{x:m},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),null!=u&&n.disposeIntermediateTensorInfo(h),g}},C5=b2({opSnippet:r2+"\n  return min(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(min(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+o2+"\n  return result;\n",cpuKernelImpl:e1}),A5={kernelName:hF,backendName:"webgl",kernelFunc:C5};class k5{constructor(t,e,n){this.variableNames=["x"],this.outputShape=e.map(((e,n)=>e[0]+t[n]+e[1]));const r=t.length,i=zQ(r),o=e.map((t=>t[0])).join(","),a=e.map(((e,n)=>e[0]+t[n])).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r),l="reflect"===n?0:1;this.userCode=1!==r?"\n      ".concat(i," start = ").concat(i,"(").concat(o,");\n      ").concat(i," end = ").concat(i,"(").concat(a,");\n\n      void main() {\n        ").concat(i," outC = getOutputCoords();\n        for (int i = 0; i < ").concat(r,"; i++) {\n          if (outC[i] < start[i]) {\n            outC[i] = start[i] * 2 - outC[i] - ").concat(l,";\n          } else if(outC[i] >= end[i]) {\n            outC[i] = (end[i] - 1) * 2 - outC[i] + ").concat(l,";\n          }\n        }\n        ").concat(i," coords = outC - start;\n        setOutput(getX(").concat(s,"));\n      }\n    "):"\n        int start = ".concat(o,";\n        int end = ").concat(a,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start) {\n            outC = start * 2 - outC - ").concat(l,";\n          } else if(outC >= end) {\n            outC = (end - 1) * 2 - outC + ").concat(l,";\n          }\n          setOutput(getX(outC - start));\n        }\n      ")}}class I5{constructor(t,e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.map(((e,n)=>e[0]+t[n]+e[1]));const r=t.length,i=zQ(r),o=e.map((t=>t[0])).join(","),a=e.map(((e,n)=>e[0]+t[n])).join(","),s=I1("rc",r),l=I1("source",r),c="".concat(s[r-1]," < ").concat(this.outputShape[r-1]),u=1===r?"source":"vec2(".concat(l.slice(-2).join(),")"),h="reflect"===n?0:1;let d="";if(1===r){const t="\n        ".concat(i," source = rc;\n        if (source < start) {\n          source = start * 2 - source - ").concat(h,";\n        } else if (source >= end) {\n          source = (end - 1) * 2 - source + ").concat(h,";\n        }\n        source -= start;\n      ");d="\n        ".concat(i," rc = outputLoc;\n        ").concat(t,"\n        result[0] = getChannel(getX(").concat(l.join(),"), ").concat(u,");\n        ").concat(s[r-1]," += 1;\n        if(").concat(c,") {\n          ").concat(t,"\n          result[1] = getChannel(getX(").concat(l.join(),"), ").concat(u,");\n        }\n      ")}else{const t="\n        ".concat(i," source = rc;\n        ").concat(i," lt = ").concat(i,"(lessThan(source, start));\n        ").concat(i," gte = ").concat(i,"(greaterThanEqual(source, end));\n        ").concat(i," orig = 1 - (lt + gte);\n        source = orig * source +\n                lt * (start * 2 - source - ").concat(h,") +\n                gte * ((end - 1) * 2 - source + ").concat(h,");\n        source -= start;\n      ");d="\n        ".concat(i," rc = outputLoc;\n        ").concat(t,"\n        result[0] = getChannel(getX(").concat(l.join(),"), ").concat(u,");\n        ").concat(s[r-1]," += 1;\n        if(").concat(c,") {\n          ").concat(t,"\n          result[1] = getChannel(getX(").concat(l.join(),"), ").concat(u,");\n        }\n        rc = outputLoc;\n        ").concat(s[r-2]," += 1;\n        if(").concat(s[r-2]," < ").concat(this.outputShape[r-2],") {\n          ").concat(t,"\n          result[2] = getChannel(getX(").concat(l.join(),"), ").concat(u,");\n          ").concat(s[r-1]," += 1;\n          if(").concat(c,") {\n            ").concat(t,"\n            result[3] = getChannel(getX(").concat(l.join(),"), ").concat(u,");\n          }\n        }\n      ")}this.userCode="\n      const ".concat(i," start = ").concat(i,"(").concat(o,");\n      const ").concat(i," end = ").concat(i,"(").concat(a,");\n\n      void main() {\n        ").concat(i," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(d,"\n        setOutput(result);\n      }\n    ")}}const R5={kernelName:dF,backendName:"webgl",kernelFunc:t=>{let{inputs:e,backend:n,attrs:r}=t;const{x:i}=e,{paddings:o,mode:a}=r,s=FD().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new I5(i.shape,o,a):new k5(i.shape,o,a);return n.runWebGLProgram(s,[i],i.dtype)}},P5={kernelName:"Mod",backendName:"webgl",kernelFunc:b2({opSnippet:"if (b == 0.0) return NAN;\n  return mod(a, b);",packedOpSnippet:"\n  vec4 result = mod(a, b);\n  bvec4 isNaN = equal(b, vec4(0.0));\n  "+o2+"\n  return result;\n"})};class N5{constructor(t,e,n){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[t,n],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < ".concat(e-1,"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float(").concat(e-1,"));\n      }\n    ")}}const O5=b2({opSnippet:"\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",packedOpSnippet:"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",checkOutOfBounds:!0}),D5={kernelName:IL,backendName:"webgl",kernelFunc:O5},L5="return a - b;",F5=b2({opSnippet:L5,packedOpSnippet:L5,supportsComplex:!0,cpuKernelImpl:T1}),U5={kernelName:hU,backendName:"webgl",kernelFunc:F5};function B5(t){const{inputs:e,backend:n,attrs:r}=t,{logits:i}=e,{dim:o}=r,a=mD([o],i.shape),s=f5({inputs:{x:i},backend:n,attrs:{reductionIndices:a,keepDims:!1}}),l=tG(s.shape,a),c=C2({inputs:{x:s},backend:n,attrs:{shape:l}}),u=F5({inputs:{a:i,b:c},backend:n}),h=o6({inputs:{x:u},backend:n}),d=D2({inputs:{x:h},backend:n,attrs:{axis:a,keepDims:!1}}),p=C2({inputs:{x:d},backend:n,attrs:{shape:l}}),f=O5({inputs:{a:h,b:p},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),f}const z5={kernelName:$F,backendName:"webgl",kernelFunc:B5};const j5={kernelName:pF,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{logits:i}=e,{numSamples:o,seed:a,normalized:s}=r,l=s?i:B5({inputs:{logits:i},backend:n,attrs:{dim:i.shape.length-1}}),c=l.shape[0],u=l.shape[1],h=new N5(c,u,o),d=[[a]],p=n.runWebGLProgram(h,[l],"int32",d);return s||n.disposeIntermediateTensorInfo(l),p}},V5=U1+"\n  return -x;\n";const W5={kernelName:mF,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])){const t=n.texData.get(r.dataId),[e,i]=r1(t.values,r.shape,r.dtype);return n.makeTensorInfo(i,r.dtype,e)}let i;return i=FD().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new J1(r.shape,"\n  vec4 result = -x;\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"):new F1(r.shape,V5),n.runWebGLProgram(i,[r],r.dtype)}},G5=oX;const H5={kernelName:yF,backendName:"webgl",kernelFunc:function(t){CU("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:i,scores:o}=e,{maxOutputSize:a,iouThreshold:s,scoreThreshold:l}=r,c=n.readSync(i.dataId),u=n.readSync(o.dataId),{selectedIndices:h}=G5(c,u,a,s,l);return n.makeTensorInfo([h.length],"int32",new Int32Array(h))}},q5=aX;const X5={kernelName:vF,backendName:"webgl",kernelFunc:function(t){CU("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:i,scores:o}=e,{maxOutputSize:a,iouThreshold:s,scoreThreshold:l,padToMaxOutputSize:c}=r,u=n.readSync(i.dataId),h=n.readSync(o.dataId),{selectedIndices:d,validOutputs:p}=q5(u,h,a,s,l,c);return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([],"int32",new Int32Array([p]))]}},Y5=sX;const K5={kernelName:bF,backendName:"webgl",kernelFunc:function(t){CU("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:i,scores:o}=e,{maxOutputSize:a,iouThreshold:s,scoreThreshold:l,softNmsSigma:c}=r,u=n.readSync(i.dataId),h=n.readSync(o.dataId),d=a,p=s,f=l,m=c,{selectedIndices:g,selectedScores:y}=Y5(u,h,d,p,f,m);return[n.makeTensorInfo([g.length],"int32",new Int32Array(g)),n.makeTensorInfo([y.length],"float32",new Float32Array(y))]}};class Z5{constructor(t,e,n,r){this.variableNames=["indices"],this.outputShape=[t,e],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float(".concat(r,"), float(").concat(n,"),\n                      float(index == coords.y)));\n      }\n    ")}}const J5={kernelName:_F,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n,attrs:r}=t,{indices:i}=e,{dtype:o,depth:a,onValue:s,offValue:l}=r,c=cD(i.shape),u=new Z5(c,a,s,l),h=C2({inputs:{x:i},backend:n,attrs:{shape:[c]}}),d=n.runWebGLProgram(u,[h],o);n.disposeIntermediateTensorInfo(h);const p=C2({inputs:{x:d},backend:n,attrs:{shape:[...i.shape,a]}});return n.disposeIntermediateTensorInfo(d),p}};function Q5(t){const{inputs:e,backend:n}=t,{x:r}=e;if("complex64"===r.dtype){const t=V3({inputs:{input:r},backend:n}),e=Q5({inputs:{x:t},backend:n}),i=i4({inputs:{input:r},backend:n}),o=Q5({inputs:{x:i},backend:n}),a=c2({inputs:{real:e,imag:o},backend:n});return n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),a}return g6({attrs:{shape:r.shape,dtype:r.dtype,value:"string"===r.dtype?"":0},backend:n})}const $5={kernelName:xU,backendName:"webgl",kernelFunc:Q5};const t8={kernelName:xF,backendName:"webgl",kernelFunc:function t(e){const{inputs:n,backend:r}=e,{x:i}=n;if("string"===i.dtype)throw new Error("onesLike is not supported under string dtype");if("complex64"===i.dtype){const e=V3({inputs:{input:i},backend:r}),n=t({inputs:{x:e},backend:r}),o=i4({inputs:{input:i},backend:r}),a=Q5({inputs:{x:o},backend:r}),s=c2({inputs:{real:n,imag:a},backend:r});return r.disposeIntermediateTensorInfo(e),r.disposeIntermediateTensorInfo(n),r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(a),s}return g6({attrs:{shape:i.shape,dtype:i.dtype,value:1},backend:r})}};const e8={kernelName:wF,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{axis:i}=r;if(1===e.length)return s6({inputs:{input:e[0]},backend:n,attrs:{dim:i}});const o=e[0].shape,a=e[0].dtype;e.forEach((t=>{sD(o,t.shape,"All tensors passed to stack must have matching shapes"),aD(a===t.dtype,(()=>"All tensors passed to stack must have matching dtypes"))}));const s=[],l=e.map((t=>{const e=s6({inputs:{input:t},backend:n,attrs:{dim:i}});return s.push(e),e})),c=s4({inputs:l,backend:n,attrs:{axis:i}});return s.forEach((t=>n.disposeIntermediateTensorInfo(t))),c}};class n8{constructor(t,e,n){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=e.map(((e,n)=>e[0]+t[n]+e[1]));const r=t.length,i=zQ(r),o=e.map((t=>t[0])).join(","),a=e.map(((e,n)=>e[0]+t[n])).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=1!==r?"\n      ".concat(i," start = ").concat(i,"(").concat(o,");\n      ").concat(i," end = ").concat(i,"(").concat(a,");\n\n      void main() {\n        ").concat(i," outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(value);\n        } else {\n          ").concat(i," coords = outC - start;\n          setOutput(getX(").concat(s,"));\n        }\n      }\n    "):"\n        int start = ".concat(o,";\n        int end = ").concat(a,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(value);\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      ")}}class r8{constructor(t,e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=e.map(((e,n)=>e[0]+t[n]+e[1]));const r=t.length,i=zQ(r),o=e.map((t=>t[0])).join(","),a=e.map(((e,n)=>e[0]+t[n])).join(","),s=I1("rc",r),l=I1("source",r),c="".concat(s[r-1]," < ").concat(this.outputShape[r-1]),u=1===r?"source":"vec2(".concat(l.slice(-2).join(),")"),h=["".concat(i," rc = outputLoc;"),"".concat(s[r-1]," += 1;\n       if(").concat(c,") {\n      "),1===r?"":"}\n       rc = outputLoc;\n       ".concat(s[r-2]," += 1;\n       if(").concat(s[r-2]," < ").concat(this.outputShape[r-2],") {"),1===r?"":"  ".concat(s[r-1]," += 1;\n         if(").concat(c,") {")],d=1===r?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let p="";for(let f=0,m=1===r?2:4;f<m;f++)p+="\n        ".concat(h[f],"\n        if (").concat(d,") {\n          result[").concat(f,"] = float(value);\n        } else {\n          ").concat(i," source = rc - start;\n          result[").concat(f,"] = getChannel(getX(").concat(l.join(),"), ").concat(u,");\n        }\n      ");p+=1===r?"} ":"}}",this.userCode="\n      const ".concat(i," start = ").concat(i,"(").concat(o,");\n      const ").concat(i," end = ").concat(i,"(").concat(a,");\n\n      void main() {\n        ").concat(i," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(p,"\n        setOutput(result);\n      }\n    ")}}const i8=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{paddings:o,constantValue:a}=r;if(0===cD(i.shape)){const t=o.map(((t,e)=>t[0]+i.shape[e]+t[1]));return g6({backend:n,attrs:{shape:t,value:a,dtype:i.dtype}})}const s=FD().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new r8(i.shape,o,a):new n8(i.shape,o,a),l=[[a]];return n.runWebGLProgram(s,[i],i.dtype,l)},o8={kernelName:SF,backendName:"webgl",kernelFunc:i8},a8={kernelName:"Pow",backendName:"webgl",kernelFunc:b2({opSnippet:"\n  if(a < 0.0 && floor(b) < b){\n    return NAN;\n  }\n  if (b == 0.0) {\n    return 1.0;\n  }\n  return (round(mod(b, 2.0)) != 1) ?\n      pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",packedOpSnippet:"\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  bvec4 isNaN1 = lessThan(a, vec4(0.0));\n  bvec4 isNaN2 = lessThan(floor(b), b);\n  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);\n  "+o2+"\n  return result;\n"})};const s8={kernelName:EF,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:o,keepDims:a}=r,s=i.shape.length,l=[],c=mD(o,i.shape);let u=c;const h=nG(u,s);let d,p=i;if(null!=h&&(p=F2({inputs:{x:i},backend:n,attrs:{perm:h}}),u=iG(u.length,s),l.push(p)),eG("prod",u,s),n.shouldExecuteOnCPU([p])){const t=n.texData.get(p.dataId).values,{outVals:e,outShape:r,outDtype:i}=o1(p.shape,p.dtype,t,u);d=n.makeTensorInfo(r,i,e)}else{const[t,e]=$W(p.shape,u),r=cD(e),o=C2({inputs:{x:p},backend:n,attrs:{shape:[-1,r]}}),a=R2(o,kB(i.dtype),"prod",n);d=C2({inputs:{x:a},backend:n,attrs:{shape:t}}),l.push(o),l.push(a)}if(a){l.push(d);const t=tG(d.shape,c);d=C2({inputs:{x:d},backend:n,attrs:{shape:t}})}return l.forEach((t=>n.disposeIntermediateTensorInfo(t))),d}};const l8={kernelName:MF,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{paramsNestedSplits:i,paramsDenseValues:o,indices:a}=e,{outputRaggedRank:s}=r,l=i.map((t=>n.readSync(t.dataId))),c=i.map((t=>t.shape)),u=n.readSync(o.dataId),h=n.readSync(a.dataId),[d,p,f]=a1(l,c,u,o.shape,o.dtype,h,a.shape,s),m=d.map((t=>n.makeTensorInfo([t.length],"int32",t))),g=n.makeTensorInfo(f,o.dtype,p);return m.concat([g])}};const c8={kernelName:CF,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{starts:r,limits:i,deltas:o}=e,a=n.readSync(r.dataId),s=n.readSync(i.dataId),l=n.readSync(o.dataId),[c,u]=s1(a,r.shape,r.dtype,s,i.shape,l,o.shape);return[n.makeTensorInfo([c.length],"int32",c),n.makeTensorInfo([u.length],r.dtype,u)]}};const u8={kernelName:AF,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{shape:i,values:o,defaultValue:a,rowPartitionTensors:s}=e,{rowPartitionTypes:l}=r,c=n.readSync(i.dataId),u=n.readSync(o.dataId),h=n.readSync(a.dataId),d=s.map((t=>n.readSync(t.dataId))),p=s.map((t=>t.shape)),[f,m]=l1(c,i.shape,u,o.shape,o.dtype,h,a.shape,d,p,l);return n.makeTensorInfo(f,o.dtype,m)}},h8=t=>{const{backend:e,attrs:n}=t,{start:r,stop:i,step:o,dtype:a}=n,s=c1(r,i,o,a);return e.makeTensorInfo([s.length],a,s)},d8={kernelName:kF,backendName:"webgl",kernelFunc:h8},p8=v2({opSnippet:"return 1.0 / x;"}),f8={kernelName:RF,backendName:"webgl",kernelFunc:p8},m8=v2({opSnippet:U1+"\n  return (x < 0.0) ? 0.0 : x;\n",packedOpSnippet:"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),g8={kernelName:PF,backendName:"webgl",kernelFunc:m8},y8=v2({opSnippet:U1+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",packedOpSnippet:"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),v8={kernelName:LF,backendName:"webgl",kernelFunc:y8};class b8{constructor(t,e,n,r,i){this.variableNames=["A"],this.outputShape=[];const[o,a,s,l]=t;this.outputShape=[o,e,n,l];const c=[r&&e>1?a-1:a,r&&n>1?s-1:s],u=[r&&e>1?e-1:e,r&&n>1?n-1:n];let h;h=i?"(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(c[0]/u[0],",\n          ").concat(c[1]/u[1],");\n      const vec2 inputShapeRC = vec2(").concat(a,".0, ").concat(s,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(h,";\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    ")}}class x8{constructor(t,e,n,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,a,s,l]=t;this.outputShape=[o,e,n,l];const c=[r&&e>1?a-1:a,r&&n>1?s-1:s],u=[r&&e>1?e-1:e,r&&n>1?n-1:n];let h;h=i?"(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(c[0]/u[0],",\n          ").concat(c[1]/u[1],",\n          ").concat(c[1]/u[1],");\n      const vec3 inputShapeRC = vec3(").concat(a,".0, ").concat(s,".0,\n                                     ").concat(s,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(h,";\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(l-1,";\n        bool hasNextRow = coords.z < ").concat(n-1,";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    ")}}const _8={kernelName:DF,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{images:i}=e,{alignCorners:o,halfPixelCenters:a,size:s}=r,[l,c]=s,u=FD().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new x8(i.shape,l,c,o,a):new b8(i.shape,l,c,o,a);return n.runWebGLProgram(u,[i],"float32")}};class w8{constructor(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e;const[,r,i]=e,[,o,a]=t,s=[n&&o>1?r-1:r,n&&a>1?i-1:i],l=[n&&o>1?o-1:o,n&&a>1?a-1:a],c=s[0]/l[0],u=s[1]/l[1],h=1/c,d=1/u,p=2*Math.ceil(h)+2,f=2*Math.ceil(d)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(c,");\n        const float widthScale = float(").concat(u,");\n\n        const float invHeightScale = float(").concat(h,");\n        const float invWidthScale = float(").concat(d,");\n\n        const int winHeight = int(").concat(p,");\n        const int winWidth = int(").concat(f,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(o,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(a,") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), ").concat(r-1,".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), ").concat(i-1,".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")}}const S8={kernelName:"ResizeBilinearGrad",backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{images:i,dy:o}=e,{alignCorners:a}=r,s=new w8(o.shape,i.shape,a);return n.runWebGLProgram(s,[o],o.dtype)}};class T8{constructor(t,e,n,r,i){this.variableNames=["A"],this.outputShape=[];const[o,a,s,l]=t;this.outputShape=[o,e,n,l];const c=[r&&e>1?a-1:a,r&&n>1?s-1:s],u=[r&&e>1?e-1:e,r&&n>1?n-1:n],h=r?"0.5":"0.0";let d;d=i?"max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(c[0]/u[0],",\n          ").concat(c[1]/u[1],");\n      const vec2 inputShapeRC = vec2(").concat(a,".0, ").concat(s,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(d,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(h,")));\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    ")}}class E8{constructor(t,e,n,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,a,s,l]=t;this.outputShape=[o,e,n,l];const c=[r&&e>1?a-1:a,r&&n>1?s-1:s],u=[r&&e>1?e-1:e,r&&n>1?n-1:n],h=r?"0.5":"0.0";let d;d=i?"max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(c[0]/u[0],",\n          ").concat(c[1]/u[1],",\n          ").concat(c[1]/u[1],");\n      const vec3 inputShapeRC = vec3(").concat(a,".0, ").concat(s,".0,\n                                     ").concat(s,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(d,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec3 sourceNearestRC = ivec3(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(h,")));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(l-1,";\n        bool hasNextRow = coords.z < ").concat(n-1,";\n\n        vec4 newValue = vec4(\n          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),\n          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);\n\n        setOutput(newValue);\n      }\n    ")}}const M8={kernelName:OF,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{images:i}=e,{alignCorners:o,halfPixelCenters:a,size:s}=r,[l,c]=s,u=FD().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new E8(i.shape,l,c,o,a):new T8(i.shape,l,c,o,a);return n.runWebGLProgram(u,[i],i.dtype)}};class C8{constructor(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e;const[,r,i]=e,[,o,a]=t,s=[n&&o>1?r-1:r,n&&a>1?i-1:i],l=[n&&o>1?o-1:o,n&&a>1?a-1:a],c=s[0]/l[0],u=s[1]/l[1],h=1/c,d=1/u,p=2*Math.ceil(h)+2,f=2*Math.ceil(d)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(c,");\n        const float widthScale = float(").concat(u,");\n\n        const float invHeightScale = float(").concat(h,");\n        const float invWidthScale = float(").concat(d,");\n\n        const int winHeight = int(").concat(p,");\n        const int winWidth = int(").concat(f,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(o,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(a,") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float(").concat(s[0],") *\n                (float(dyR) / float(").concat(l[0],"));\n\n            float sourceFracCol =\n                float(").concat(s[1],") *\n                  (float(dyC) / float(").concat(l[1],"));\n\n            int sourceNearestRow = int(min(\n                float(int(").concat(r,") - 1),\n                ").concat(n," ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int(").concat(i,") - 1),\n                ").concat(n," ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")}}const A8={kernelName:"ResizeNearestNeighborGrad",backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{images:i,dy:o}=e,{alignCorners:a}=r,s=new C8(o.shape,i.shape,a);return n.runWebGLProgram(s,[o],o.dtype)}};class k8{constructor(t,e){this.variableNames=["x"];const n=t.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-".concat(n," tensor is not yet supported"));if(this.outputShape=t,1===n)return void(this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(".concat(t[0]," - coord - 1));\n        }\n      "));const r=t.map(((n,r)=>(n=>-1!==e.indexOf(n)&&1!==t[n]?"".concat(t[n]," - coords[").concat(n,"] - 1"):"coords[".concat(n,"]"))(r))).join(","),i=zQ(n);this.userCode="\n      void main() {\n        ".concat(i," coords = getOutputCoords();\n        setOutput(getX(").concat(r,"));\n      }\n    ")}}class I8{constructor(t,e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const n=t.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-".concat(n," tensor is not yet supported"));this.outputShape=t;const r=I1("rc",n),i="".concat(r[n-1]," + 1 < ").concat(this.outputShape[n-1]),o="".concat(r[n-2]," + 1 < ").concat(this.outputShape[n-2]),a=zQ(n);function s(n){const r=t.map(((r,i)=>function(n,r){return-1!==e.indexOf(n)&&1!==t[n]?"".concat(t[n]," - ").concat(r[n]," - 1"):"".concat(r[n])}(i,n))),i=r.join(","),o=r.slice(-2).join(",");return"getChannel(getX(".concat(i,"), vec2(").concat(o,"))")}this.userCode=1===n?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(".concat(t[0]," - rc - 1),\n            ").concat(t[0]," - rc - 1);\n          if(").concat(i,"){\n              result.g = getChannel(getX(").concat(t[0]," - (rc  + 1) - 1),\n                ").concat(t[0]," - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      "):"\n        void main() {\n          ".concat(a," rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ").concat(function(t){return s(t)}(r.slice()),";\n          if(").concat(i,"){\n            result.g = ").concat(function(t){return t[n-1]="("+t[n-1]+" + 1)",s(t)}(r.slice()),";\n          }\n          if(").concat(o,") {\n            result.b = ").concat(function(t){return t[n-2]="("+t[n-2]+" + 1)",s(t)}(r.slice()),";\n            if(").concat(i,") {\n              result.a = ").concat(function(t){return t[n-1]="("+t[n-1]+" + 1)",t[n-2]="("+t[n-2]+" + 1)",s(t)}(r.slice()),";\n            }\n          }\n          setOutput(result);\n        }\n    ")}}const R8={kernelName:FF,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{dims:o}=r,a=i.shape.length,s=mD(o,i.shape);if(0===a)return s2({inputs:{x:i},backend:n});const l=FD().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new I8(i.shape,s):new k8(i.shape,s);return n.runWebGLProgram(l,[i],i.dtype)}};class P8{constructor(t,e){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const n=t[1],r=t[2];this.outputShape=t;let i="";i="number"===typeof e?"float outputValue = ".concat(e.toFixed(2),";"):"\n        vec3 fill = vec3(".concat(e.join(","),");\n        float outputValue = fill[coords[3]];"),this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n          int y = coords[1];\n          float coordXFloat = (float(x) - params[0]) * params[3] -\n            (float(y) - params[1]) * params[2];\n          float coordYFloat = (float(x) - params[0]) * params[2] +\n            (float(y) - params[1]) * params[3];\n          int coordX = int(round(coordXFloat + params[0]));\n          int coordY = int(round(coordYFloat + params[1]));\n          ".concat(i,"\n          if(coordX >= 0 && coordX < ").concat(r," && coordY >= 0 && coordY < ").concat(n,") {\n            outputValue = getImage(coords[0], coordY, coordX, coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")}}const N8={kernelName:SU,backendName:"webgl",kernelFunc:t=>{let{inputs:e,attrs:n,backend:r}=t;const{image:i}=e,{radians:o,fillValue:a,center:s}=n,l=r,c=new P8(i.shape,a),[u,h]=rY(s,i.shape[1],i.shape[2]),d=[[u,h,Math.sin(o),Math.cos(o)]];return l.runWebGLProgram(c,[i],i.dtype,d)}},O8=v2({opSnippet:"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n"}),D8={kernelName:UF,backendName:"webgl",kernelFunc:O8},L8=v2({opSnippet:"return inversesqrt(x);",cpuKernelImpl:u1}),F8={kernelName:BF,backendName:"webgl",kernelFunc:L8};class U8{constructor(t,e,n,r,i,o){let a=arguments.length>7&&void 0!==arguments[7]&&arguments[7];this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;const s=zQ(i.length),l=zQ(o.length);let c="";1===n?c="i":2===n&&(c="i, j");const u="getIndices(".concat(c,")");let h="";1===r?h="i":2===r&&(h="i, coords[1]");const d="getUpdates(".concat(h,")");let p="";a&&(p="coords[0], coords[1]");const f="getDefaultValue(".concat(p,")"),m=e>1?"strides[j]":"strides";this.userCode="\n        ".concat(s," strides = ").concat(s,"(").concat(i,");\n\n        void main() {\n          ").concat(l," coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < ").concat(t,"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < ").concat(e,"; j++) {\n              int index = round(").concat(u,");\n              flattenedIndex += index * ").concat(m,";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += ").concat(d,";\n              found = true;\n            }\n          }\n          setOutput(mix(").concat(f,", sum, float(found)));\n        }\n      ")}}class B8{constructor(t,e,n,r,i,o){let a=arguments.length>7&&void 0!==arguments[7]&&arguments[7];this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=o;const s=zQ(i.length),l=zQ(o.length);let c="";1===n?c="i":2===n&&(c="i, j");const u="getIndices(".concat(c,")");let h="";1===r?h="i":2===r&&(h="i, coords[1]");const d="getUpdates(".concat(h,")");let p="";a&&(p="coords[0], coords[1]");const f="getDefaultValue(".concat(p,")"),m=e>1?"strides[j]":"strides",g=e>1?"strides[j + 1]":"strides";this.userCode="\n        ".concat(s," strides = ").concat(s,"(").concat(i,");\n\n        void main() {\n          ").concat(l," coords = getOutputCoords();\n          vec4 sum = vec4(0.);\n          vec4 found = vec4(0.);\n          for (int i = 0; i < ").concat(t,"; i+=2) {\n            ivec2 flattenedIndex = ivec2(0);\n            for (int j = 0; j < ").concat(e,"; j+=2) {\n              ivec4 index = round(").concat(u,");\n              flattenedIndex += index.xz * ").concat(m,";\n              if (j + 1 < ").concat(e,") {\n                flattenedIndex += index.yw * ").concat(g,";\n              }\n            }\n            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||\n                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {\n              vec4 updVals = ").concat(d,";\n              if (flattenedIndex[0] == coords[0]) {\n                sum.xy += updVals.xy;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[0] == coords[0] + 1) {\n                sum.zw += updVals.xy;\n                found.zw = vec2(1.);\n              }\n              if (flattenedIndex[1] == coords[0]) {\n                sum.xy += updVals.zw;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[1] == coords[0] + 1) {\n                sum.zw += updVals.zw;\n                found.zw = vec2(1.);\n              }\n            }\n          }\n          setOutput(mix(").concat(f,", sum, found));\n        }\n      ")}}const z8={kernelName:zF,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{indices:i,updates:o}=e,{shape:a}=r,{sliceRank:s,numUpdates:l,sliceSize:c,strides:u,outputSize:h}=mq(0,i,a),d=[h/c,c];if(0===h)return n.makeTensorInfo(a,i.dtype);const p=C2({inputs:{x:i},backend:n,attrs:{shape:[l,s]}}),f=C2({inputs:{x:o},backend:n,attrs:{shape:[l,c]}}),m=n.makeTensorInfo([],"float32",new Float32Array([0]));let g;g=FD().getBool("WEBGL_PACK")?new B8(l,s,p.shape.length,f.shape.length,u,d):new U8(l,s,p.shape.length,f.shape.length,u,d);const y=n.runWebGLProgram(g,[f,p,m],f.dtype),v=C2({inputs:{x:y},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(m),v}};class j8{constructor(t,e,n,r){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[t,n];const i="for (int i = 0; i < ".concat(Math.ceil(Math.log2(e+1)),"; ++i) { if (left >= right) break;"),o=2===FD().getNumber("WEBGL_VERSION")?"while (left < right) {":i,a="left"===r?"<":"<=";this.userCode="\n       int findBound(int batch, float value) {\n         int left = 0;\n         int right = numInputs;\n         int mid;\n         ".concat(o,"\n           mid = (left + right) / 2;\n           if (getSortedSequence(batch, mid) ").concat(a," value) {\n             left = mid + 1;\n           } else {\n             right = mid;\n           }\n         }\n         return right;\n       }\n\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int valueIndex = coords[1];\n\n         float value = getValues(batch, valueIndex);\n\n         setOutput(float(findBound(batch, value)));\n       }\n     ")}}const V8={kernelName:VF,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{sortedSequence:i,values:o}=e,{side:a}=r,s=new j8(i.shape[0],i.shape[1],o.shape[1],a),l=[[i.shape[1]]];return n.runWebGLProgram(s,[i,o],"int32",l)}};class W8{constructor(t,e,n){let r,i;if(this.variableNames=["c","a","b"],this.outputShape=e,n>4)throw Error("Where for rank ".concat(n," is not yet supported"));if(1===n)i="resRC",r="resRC";else{const n=["resRC.x","resRC.y","resRC.z","resRC.w"],o=[],a=[];for(let r=0;r<e.length;r++)a.push("".concat(n[r])),r<t&&o.push("".concat(n[r]));r=o.join(),i=a.join()}const o=zQ(n);this.userCode="\n      void main() {\n        ".concat(o," resRC = getOutputCoords();\n        float cVal = getC(").concat(r,");\n        if (cVal >= 1.0) {\n          setOutput(getA(").concat(i,"));\n        } else {\n          setOutput(getB(").concat(i,"));\n        }\n      }\n    ")}}const G8={kernelName:WF,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{condition:r,t:i,e:o}=e,a=new W8(r.shape.length,i.shape,i.shape.length);return n.runWebGLProgram(a,[r,i,o],AB(i.dtype,o.dtype))}},H8=v2({opSnippet:"\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = ".concat(uY,";\n  float scale = ").concat(hY,";\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n")}),q8={kernelName:GF,backendName:"webgl",kernelFunc:H8},X8=v2({opSnippet:y2+"\n  return 1.0 / (1.0 + exp(-1.0 * x));\n",packedOpSnippet:"\n  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:d1}),Y8={kernelName:YF,backendName:"webgl",kernelFunc:X8},K8=v2({opSnippet:"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n"}),Z8={kernelName:XF,backendName:"webgl",kernelFunc:K8},J8={kernelName:"Sin",backendName:"webgl",kernelFunc:v2({opSnippet:y2+"\n  return sin(x);\n",packedOpSnippet:"\n  vec4 result = sin(x);\n  bvec4 isNaN = isnan(x);\n  ".concat(o2,"\n  return result;\n")})},Q8=v2({opSnippet:"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n"}),$8={kernelName:qF,backendName:"webgl",kernelFunc:Q8},t7=v2({opSnippet:"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n"}),e7={kernelName:KF,backendName:"webgl",kernelFunc:t7},n7={kernelName:JF,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{blockShape:o,paddings:a}=r;aD(i.shape.length<=4,(()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"));const s=o.reduce(((t,e)=>t*e)),l=[[0,0]];l.push(...a);for(let y=1+o.length;y<i.shape.length;++y)l.push([0,0]);const c=[],u=i8({inputs:{x:i},backend:n,attrs:{paddings:l,constantValue:0}}),h=iY(u.shape,o,s,!1),d=oY(h.length,o.length,!1),p=aY(u.shape,o,s,!1),f=C2({inputs:{x:u},backend:n,attrs:{shape:h}}),m=F2({inputs:{x:f},backend:n,attrs:{perm:d}}),g=C2({inputs:{x:m},backend:n,attrs:{shape:p}});return c.push(u),c.push(f),c.push(m),c.forEach((t=>n.disposeIntermediateTensorInfo(t))),g}};const r7={kernelName:tU,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{indices:r,values:i,denseShape:o,defaultValue:a}=e;if(1!==o.shape.length)throw new Error("Dense shape must be a vector, saw:\n         ".concat(o.shape));if(2!==r.shape.length)throw new Error("Indices must be a matrix, saw:\n         ".concat(r.shape));if(1!==i.shape.length)throw new Error("Values must be a vector, saw:\n         ".concat(i.shape));if(0!==a.shape.length)throw new Error("Default value must be a scalar, saw:\n        ".concat(a.shape));const s=n.readSync(r.dataId),l=n.readSync(i.dataId),c=n.readSync(o.dataId),u=n.readSync(a.dataId)[0],[h,d,p,f,m]=m1(s,r.shape,r.dtype,l,i.dtype,c,u);return[n.makeTensorInfo(d,r.dtype,h),n.makeTensorInfo([d[0]],i.dtype,p),n.makeTensorInfo([f.length],"bool",new Uint8Array(f.map((t=>Number(t))))),n.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}};const i7={kernelName:eU,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{inputIndices:r,inputShape:i,newShape:o}=e;if(2!==r.shape.length)throw new Error("Input indices should be a matrix but received shape ".concat(r.shape));if(1!==i.shape.length)throw new Error("Input shape should be a vector but received shape ".concat(i.shape));if(1!==o.shape.length)throw new Error("Target shape should be a vector but received shape ".concat(o.shape));const a=Array.from(n.readSync(i.dataId)),s=n.readSync(r.dataId),l=Array.from(n.readSync(o.dataId)),[c,u,h]=g1(s,r.shape,r.dtype,a,l);return[n.makeTensorInfo(u,r.dtype,c),n.makeTensorInfo([h.length],o.dtype,new Int32Array(h))]}};const o7={kernelName:nU,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{data:r,indices:i,segmentIds:o}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.shape.length)throw new Error("Indices should be a vector but received shape\n              ".concat(i.shape));if(1!==o.shape.length)throw new Error("Segment ids should be a vector but received shape\n              ".concat(o.shape));const a=n.readSync(r.dataId),s=n.readSync(i.dataId),l=n.readSync(o.dataId),[c,u]=y1(a,r.shape,r.dtype,s,l,!0);return n.makeTensorInfo(u,r.dtype,c)}};const a7={kernelName:rU,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{data:r,indices:i,segmentIds:o}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.shape.length)throw new Error("Indices should be a vector but received shape\n             ".concat(i.shape));if(1!==o.shape.length)throw new Error("Segment ids should be a vector but received shape\n             ".concat(o.shape));const a=n.readSync(r.dataId),s=n.readSync(i.dataId),l=n.readSync(o.dataId),[c,u]=y1(a,r.shape,r.dtype,s,l);return n.makeTensorInfo(u,r.dtype,c)}};const s7={kernelName:iU,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{sparseIndices:i,sparseValues:o,defaultValue:a}=e,{outputShape:s}=r,{sliceRank:l,numUpdates:c,sliceSize:u,strides:h,outputSize:d}=mq(0,i,s),p=!1;if("string"===o.dtype){const t=n.bufferSync(i),e=n.bufferSync(o),r=eB(n.readSync(a.dataId)[0]),f=h1(t,e,s,d,u,c,l,h,r,p);return n.makeTensorInfo(s,f.dtype,f.values)}const f=new U8(c,l,i.shape.length,o.shape.length,h,[d,1],p),m=n.runWebGLProgram(f,[o,i,a],o.dtype),g=C2({inputs:{x:m},backend:n,attrs:{shape:s}});return n.disposeIntermediateTensorInfo(m),g}};const l7={kernelName:QF,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{numOrSizeSplits:o,axis:a}=r,s=mD(a,i.shape)[0],l=LY(i,o,s),c=i.shape.length,u=new Array(c).fill(0),h=i.shape.slice();return l.map((t=>{const e=[...h];e[s]=t;const r=O3({inputs:{x:i},backend:n,attrs:{begin:u,size:e}});return u[s]+=t,r}))}},c7="return sqrt(x);",u7=v2({opSnippet:c7,packedOpSnippet:c7,cpuKernelImpl:v1}),h7={kernelName:ZF,backendName:"webgl",kernelFunc:u7},d7={kernelName:"Square",backendName:"webgl",kernelFunc:v2({opSnippet:"return x * x;"})},p7="return (a - b) * (a - b);",f7=b2({opSnippet:p7,packedOpSnippet:p7}),m7={kernelName:oU,backendName:"webgl",kernelFunc:f7};const g7={kernelName:aU,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e;if("string"!==i.dtype)throw new Error("Input must be of datatype string");const o=QY(n.readSync(i.dataId)),a=b1(o,"string",r);return n.makeTensorInfo(i.shape,"string",a)}};const y7={kernelName:_U,backendName:"webgl",kernelFunc:function(t){let{inputs:e,attrs:n,backend:r}=t;const{x:i}=e,o=U1+"\n    return x > 0.0 ? 1.0 : float(".concat(n.alpha,");\n  "),a=new F1(i.shape,o);return r.runWebGLProgram(a,[i],i.dtype)}};class v7{constructor(t,e,n){this.variableNames=["x"],this.outputShape=n;const r=n.length,i=zQ(n.length),o=zQ(n.length);let a="";if(1===r)a="coords * strides + begin";else{let t=0;a=n.map(((e,r)=>(t++,1===n.length?"coords * strides[".concat(r,"] + begin[").concat(r,"]"):"coords[".concat(t-1,"] * strides[").concat(r,"] + begin[").concat(r,"]")))).join(",")}this.userCode="\n      ".concat(i," begin = ").concat(i,"(").concat(t,");\n      ").concat(i," strides = ").concat(i,"(").concat(e,");\n\n      void main() {\n        ").concat(o," coords = getOutputCoords();\n        setOutput(getX(").concat(a,"));\n      }\n    ")}}const b7={kernelName:sU,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{begin:o,end:a,strides:s,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:h,shrinkAxisMask:d}=r,{finalShapeSparse:p,finalShape:f,isIdentity:m,sliceDim0:g,isSimpleSlice:y,begin:v,end:b,strides:x}=AV(i.shape,o,a,s,l,c,u,h,d);let _;if(m)_=C2({inputs:{x:i},backend:n,attrs:{shape:f}});else if(g||y){aD(i.shape.length>=1,(()=>"Input must have rank at least 1, got: ".concat(i.shape.length)));const t=mV(v,b,x),e=O3({inputs:{x:i},backend:n,attrs:{begin:v,size:t}});_=C2({inputs:{x:e},backend:n,attrs:{shape:f}}),n.disposeIntermediateTensorInfo(e)}else{if(n.shouldExecuteOnCPU([i])){const t=n.readSync(i.dataId),e=cj(i.shape,i.dtype,t),r=x1(p,e,x,v);_=n.makeTensorInfo(f,i.dtype,r.values)}else{const t=new v7(v,x,p);_=n.runWebGLProgram(t,[i],i.dtype)}}const w=C2({inputs:{x:_},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(_),w}};const x7={kernelName:lU,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{separator:i,nGramWidths:o,leftPad:a,rightPad:s,padWidth:l,preserveShortSequences:c}=r,{data:u,dataSplits:h}=e,d=n.readSync(u.dataId),p=n.readSync(h.dataId),[f,m]=_1(d,p,i,o,a,s,l,c);return[n.makeTensorInfo([f.length],"string",f),n.makeTensorInfo(h.shape,"int32",m)]}};const _7={kernelName:cU,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{skipEmpty:i}=r,{input:o,delimiter:a}=e;if("string"!==o.dtype)throw new Error("Input must be of datatype string");if(1!==o.shape.length)throw new Error("Input must be a vector, got shape: ".concat(o.shape));if(0!==a.shape.length)throw new Error("Delimiter must be a scalar, got shape: ".concat(a.shape));const s=n.readSync(o.dataId),l=n.readSync(a.dataId)[0],[c,u,h]=w1(s,l,i),d=u.length;return[n.makeTensorInfo([d,2],"int32",c),n.makeTensorInfo([d],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(h))]}};const w7={kernelName:uU,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{numBuckets:i}=r,{input:o}=e;if("string"!==o.dtype)throw new Error("Input must be of datatype string");if(i<=0)throw new Error("Number of buckets must be at least 1");const a=n.readSync(o.dataId),s=S1(a,i);return n.makeTensorInfo(o.shape,"int32",s)}},S7={kernelName:"Tan",backendName:"webgl",kernelFunc:v2({opSnippet:"return tan(x);"})},T7=v2({opSnippet:"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n"}),E7={kernelName:dU,backendName:"webgl",kernelFunc:T7};const M7={kernelName:jF,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{tensor:i,indices:o,updates:a}=e,{}=r,{sliceRank:s,numUpdates:l,sliceSize:c,strides:u,outputSize:h}=mq(0,o,i.shape),d=[h/c,c];if(0===h)return n.makeTensorInfo(i.shape,o.dtype);const p=C2({inputs:{x:o},backend:n,attrs:{shape:[l,s]}}),f=C2({inputs:{x:a},backend:n,attrs:{shape:[l,c]}}),m=C2({inputs:{x:i},backend:n,attrs:{shape:d}}),g=new U8(l,s,p.shape.length,f.shape.length,u,d,!1,!0),y=n.runWebGLProgram(g,[f,p,m],m.dtype),v=C2({inputs:{x:y},backend:n,attrs:{shape:i.shape}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),v}};class C7{constructor(t,e){this.variableNames=["A"];const n=new Array(t.length);for(let o=0;o<n.length;o++)n[o]=t[o]*e[o];this.outputShape=n,this.rank=n.length;const r=zQ(this.rank),i=function(t){const e=t.length;if(e>5)throw Error("Tile for rank ".concat(e," is not yet supported"));if(1===e)return"imod(resRC, ".concat(t[0],")");const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let i=0;i<t.length;i++)r.push("imod(".concat(n[i],", ").concat(t[i],")"));return r.join()}(t);this.userCode="\n      void main() {\n        ".concat(r," resRC = getOutputCoords();\n        setOutput(getA(").concat(i,"));\n      }\n    ")}}function A7(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{reps:o}=r;if("string"===i.dtype||i.shape.length>5){const t=n.readSync(i.dataId),e="string"===i.dtype?t.map((t=>eB(t))):t,r=cj(i.shape,i.dtype,e),a=E1(r,o);return n.makeTensorInfo(a.shape,a.dtype,a.values)}const a=new C7(i.shape,o);return n.runWebGLProgram(a,[i],i.dtype)}const k7={kernelName:pU,backendName:"webgl",kernelFunc:A7};class I7{constructor(t){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=t,this.userCode="\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // We compare elements pair-wise within a group of size 2 * inc.\n         // The comparing rule for each group alternates between ascending\n         // and descending. Within each group, we compare each pair at\n         // positions i and i+inc. To decide whether an element at position i\n         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than\n         // inc, it is in the first half of the group, we denote it as x0,\n         // otherwise we denote it as x1.\n         // For example, as shown in the Bitonic top K paper referenced above,\n         // Figure5(a) shows that element[1] is in the\n         // second half of the group when group size is 2, but it is in the\n         // first half of the group when group size is 4.\n\n         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;\n         int i = isFirstInPair ? elemIdx : elemIdx - inc;\n\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));\n         float x0 = i0 < n ? getX(batch, i0) : negativeInf;\n         float x1 = i1 < n ? getX(batch, i1) : negativeInf;\n\n         // Denotes which direction indices are in (ascending or descending).\n         bool reverse = imod(elemIdx, 2 * dir) >= dir;\n         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);\n         if (reverse == isGreater) { // Elements in opposite order of direction\n           int iTemp = i0;\n           i0 = i1;\n           i1 = iTemp;\n         }\n         if (isFirstInPair) {\n            setOutput(float(i0));\n         } else {\n            setOutput(float(i1));\n         }\n       }\n     "}}class R7{constructor(t){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=t,this.userCode="\n    void main() {\n         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // The output size is half of the previous size.\n         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),\n         // we only need to output the indices at positions |, the indices at\n         // positions _ can be thrown away, see Figure5(b) After Phase 2\n         // (Merge phase) in the Bitonic Top K paper referenced above.\n         // For example, the paper shows we only need to output the orange bars.\n         // The output sequence should look like this | | | | | | | |.\n         // Because the sequence is halved, to map the output index back\n         // to the previous sequence to find the corresponding value,\n         // we need to double the index. When we double the index,\n         // we basically interpolate a position, so 2i looks like\n         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position\n         // of each 2k positions by - elemIdx % k. E.g. for output at\n         // index 4,5,6,7, we want to get the corresponding element at\n         // original index 8,9,10,11, for output at index 8,9,10,11,\n         // we want to get the corresponding element at original index\n         // 16,17,18,19, so on and so forth.\n\n         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));\n\n         float x0 = getX(batch, i0);\n         float x1 = i1 < n ? getX(batch, i1) : x0;\n\n         setOutput(x0 >= x1 ? float(i0) : float(i1));\n       }\n     "}}function P7(t,e){null!==e&&t.disposeIntermediateTensorInfo(e)}function N7(t){let e=1;for(;e<t;)e*=2;return e}const O7={kernelName:fU,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{k:o,sorted:a}=r,s=FD().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=FD().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),c=i.shape,u=c[c.length-1];if(n.shouldExecuteOnCPU([i])||u<s||o>l){const t=n.readSync(i.dataId),[e,r]=M1(t,c,i.dtype,o,a);return[n.makeTensorInfo(e.shape,e.dtype,e.values),n.makeTensorInfo(r.shape,r.dtype,r.values)]}if(0===o)return c[c.length-1]=0,[n.makeTensorInfo(c,i.dtype,[]),n.makeTensorInfo(c,"int32",[])];if(1===u)return[i,g6({attrs:{shape:c,dtype:"int32",value:0},backend:n})];const h=n.texData.get(i.dataId),d=null!==h&&h.isPacked,p=d?n.unpackTensor(i):i,f=cD(c)/u,m=C2({inputs:{x:p},attrs:{shape:[f,u]},backend:n});d&&P7(n,p);const g=N7(o),y=N7(u);let v=null;const b=()=>null===v?[m,m]:[m,v],x=(t,e,r)=>{const i=b(),o=new I7(r),a=[[u],[null===v?1:0],[Number.NEGATIVE_INFINITY],[t],[e]],s=v;v=n.runWebGLProgram(o,i,"int32",a),P7(n,s)};for(let E=1;E<g;E*=2){const t=2*E;for(let e=E;e>=1;e/=2)x(t,e,[f,y])}for(let E=y;E>g;E/=2){const t=b(),e=new R7([f,E/2]),r=[[u],[null===v?1:0],[g]],i=v;v=n.runWebGLProgram(e,t,"int32",r),P7(n,i);const o=g/2,a=2*o;for(let n=o;n>=1;n/=2)x(a,n,v.shape)}let _=v;v=O3({inputs:{x:v},backend:n,attrs:{begin:0,size:[f,o]}}),P7(n,_);let w=D6({inputs:{x:m,indices:v},backend:n,attrs:{axis:1,batchDims:1}});P7(n,m);const S=c.slice(0,-1);S.push(o),_=v,v=C2({inputs:{x:v},attrs:{shape:S},backend:n}),P7(n,_);const T=w;return w=C2({inputs:{x:w},attrs:{shape:S},backend:n}),P7(n,T),[w,v]}};class D7{constructor(t,e,n,r,i,o){this.variableNames=["Image","Transforms"],this.outputShape=o;const a="nearest"===n?1:2;let s;switch(r){case"constant":default:s=1;break;case"reflect":s=2;break;case"wrap":s=3;break;case"nearest":s=4}this.userCode="\n            float mapCoord(float outCoord, float len) {\n              float inCoord = outCoord;\n              if(".concat(s," == 2) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    if (inCoord < sz2) {\n                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +\n                      inCoord;\n                    }\n                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    inCoord -= sz2 * float(int(float(inCoord / sz2)));\n                    if (inCoord >= len) {\n                      inCoord = sz2 - inCoord - 1.0;\n                    }\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(s," == 3) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord -= len * float(int(float(inCoord / sz)));\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(s," == 4) {\n                return clamp(outCoord, 0.0, len - 1.0);\n              } else {\n                return outCoord;\n              }\n            }\n\n            float readWithFillValue(int batch, int coordY, int coordX,\n              int channel) {\n              float outputValue;\n              if (0 <= coordY && coordY < ").concat(t," && 0 <= coordX && coordX < ").concat(e,") {\n                  outputValue = getImage(batch, coordY, coordX, channel);\n              } else {\n                outputValue = float(").concat(i,");\n              }\n              return outputValue;\n            }\n\n            void main() {\n              ivec4 coords = getOutputCoords();\n              float outputValue;\n              int batch = coords[0];\n              int x = coords[2];\n              int y = coords[1];\n              int channel = coords[3];\n              float xf = float(x);\n              float yf = float(y);\n              float a1 = getTransforms(batch, 0);\n              float a2 = getTransforms(batch, 1);\n              float a3 = getTransforms(batch, 2);\n              float b1 = getTransforms(batch, 3);\n              float b2 = getTransforms(batch, 4);\n              float b3 = getTransforms(batch, 5);\n              float c1 = getTransforms(batch, 6);\n              float c2 = getTransforms(batch, 7);\n              float projection = c1 * xf + c2 * yf + 1.0;\n              if (projection == 0.0) {\n                outputValue = float(").concat(i,");\n              } else {\n                float inX = (a1 * xf + a2 * yf + a3) / projection;\n                float inY = (b1 * xf + b2 * yf + b3) / projection;\n                float mapX = mapCoord(inX, float(").concat(e,"));\n                float mapY = mapCoord(inY, float(").concat(t,"));\n\n                if (").concat(a," == 1) {\n                  int coordY = int(round(mapY));\n                  int coordX = int(round(mapX));\n                  outputValue = readWithFillValue(batch, coordY, coordX,\n                    channel);\n                } else {\n                  float yFloor = floor(mapY);\n                  float xFloor = floor(mapX);\n                  float yCeil = yFloor + 1.0;\n                  float xCeil = xFloor + 1.0;\n                  float valueYFloor = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);\n                  float valueYCeil = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);\n                  outputValue = (yCeil - mapY) * valueYFloor +\n                  (mapY - yFloor) * valueYCeil;\n                }\n              }\n              setOutput(outputValue);\n            }\n        ")}}const L7={kernelName:mU,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{image:i,transforms:o}=e,{interpolation:a,fillMode:s,fillValue:l,outputShape:c}=r,[u,h,d,p]=i.shape,[f,m]=null!=c?c:[h,d],g=new D7(h,d,a,s,l,[u,f,m,p]);return n.runWebGLProgram(g,[i,o],"float32")}};const F7={kernelName:yU,backendName:"webgl",kernelFunc:function(t){const{inputs:e,attrs:n,backend:r}=t,{axis:i}=n,{x:o}=e;wQ(o,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const a=r.readSync(o.dataId),{outputValues:s,outputShape:l,indices:c}=A1(a,i,o.shape,o.dtype);return[r.makeTensorInfo(l,o.dtype,s),r.makeTensorInfo([c.length],"int32",c)]}};const U7={kernelName:vU,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{value:i}=e;let{axis:o}=r;o<0&&(o+=i.shape.length);const a=i,s=a.shape.length,l=i.shape[o],c=new Array(s-1);let u=0;for(let m=0;m<s;m++)m!==o&&(c[u++]=a.shape[m]);const h=[],d=new Array(s).fill(0),p=a.shape.slice();p[o]=1;const f=new Array(l);for(let m=0;m<f.length;m++){d[o]=m;const t=O3({inputs:{x:a},backend:n,attrs:{begin:d,size:p}}),e=C2({inputs:{x:t},backend:n,attrs:{shape:c}});f[m]=e,h.push(t)}return h.forEach((t=>n.disposeIntermediateTensorInfo(t))),f}};class B7{constructor(t,e){this.variableNames=["x","segmentIds"];const n=t.windowSize,r=t.batchSize,i=t.inSize,o=t.numSegments,a=o*Math.ceil(i/n);this.outputShape=[r,a];const s=4*Math.floor(n/4),l=n%4,c="\n        sumValue += dot(values, segFilter);\n    ";let u="";i%n>0&&(u="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return initializationValue;\n        }\n      "));let h="";i%n>0&&(h="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return -1.0;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat("0.0",";\n\n      float getValue(int batch, int inIdx) {\n        ").concat(u,"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        ").concat(h,"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          ").concat(o,")) * float(").concat(n,"));\n        int currentSeg = int(mod(float(outIdx), float(").concat(o,")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(s,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          ").concat(c,"\n        }\n\n        int inIdx = inOffset + ").concat(s,";\n        if (").concat(1===l,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          ").concat(c,"\n        } else if (").concat(2===l,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          ").concat(c,"\n        } else if (").concat(3===l,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          ").concat(c,"\n        }\n        setOutput(").concat("sumValue",");\n      }\n    ")}}const z7={kernelName:bU,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,segmentIds:o}=e,{numSegments:a}=r,s=i.shape.length,l=[];let c=0;const u=nG([c],s);let h=i;null!=u&&(h=F2({inputs:{x:i},backend:n,attrs:{perm:u}}),l.push(h),c=iG(1,s)[0]);const d=ZY(h.shape,c,a),p=cD([h.shape[c]]),f=C2({inputs:{x:h},backend:n,attrs:{shape:[-1,p]}});l.push(f);const m=kB(i.dtype),g=(t,e,r,i,o)=>{const a=t.shape[0],s=t.shape[1],c=KY(s,o),u=new B7({windowSize:c,inSize:s,batchSize:a,numSegments:o},e),h=n.compileAndRun(u,[t,r],i);if(l.push(h),h.shape[1]===o)return h;const d=h8({backend:n,attrs:{start:0,stop:o,step:1,dtype:"float32"}}),p=A7({inputs:{x:d},backend:n,attrs:{reps:[s/c]}});l.push(d),l.push(p);return g(h,e,p,i,o)},y=C2({inputs:{x:g(f,"unsortedSegmentSum",o,m,a)},backend:n,attrs:{shape:d}});let v=y;if(null!=u){l.push(y);const t=rG(u);v=F2({inputs:{x:v},backend:n,attrs:{perm:t}})}return l.forEach((t=>n.disposeIntermediateTensorInfo(t))),v}},j7=[j2,W2,H2,X2,Z2,$2,t3,e3,s3,l3,u3,d3,f3,g3,v3,_3,w3,E3,M3,C3,I3,L3,F3,U3,B3,H3,Y3,J3,u2,t4,l4,g4,_4,S4,T4,E4,M4,C4,k4,R4,F4,U4,B4,j4,G4,X4,Y4,Z4,Q4,$4,t6,e6,r6,i6,a6,l6,h6,f6,y6,b6,w6,T6,C6,I6,R6,N6,L6,U6,z6,l2,j6,o4,W6,H6,X6,p2,K6,J6,Q6,t5,n5,i5,a5,l5,h5,p5,m5,y5,v5,b5,w5,S5,T5,E5,M5,A5,R5,P5,j5,M2,W5,H5,X5,K5,j3,J5,t8,e8,o8,a8,g2,s8,l8,c8,u8,d8,W3,D5,f8,g8,v8,A2,_8,S8,M8,A8,R8,N8,D8,F8,z8,V8,G8,q8,Y8,Z8,J8,$8,D3,z5,e7,n7,r7,i7,o7,a7,s7,l7,h7,d7,m7,g7,y7,b7,x7,_7,w7,U5,L2,S7,E7,M7,k7,O7,L7,U2,F7,U7,z7,$5];for(const e9 of j7)OU(e9);const V7=EJ.MediaPipeFaceMesh,W7={runtime:"tfjs"},G7={0:"Angry",1:"Disgust",2:"Fear",3:"Happy",4:"Sad",5:"Surprise",6:"Neutral"},H7={0:"Man",1:"Woman"},q7={0:"White",1:"Black",2:"Asian",3:"Indian",4:"Other"},X7=()=>{const[t,e]=(0,k.useState)(!1),n=(0,k.useRef)(null),r=(0,k.useRef)(null),i=(0,k.useRef)(null),o=(0,k.useRef)(new BO.InferenceSession({backendHint:"webgl"})),a=(0,k.useRef)(new BO.InferenceSession({backendHint:"webgl"})),s=async e=>{if("undefined"!==typeof n.current&&null!==n.current&&"undefined"!==typeof r.current&&null!==i.current&&"undefined"!==typeof i.current&&null!==r.current&&4===n.current.video.readyState&&t){const t=n.current.video,i=n.current.video.videoWidth,o=n.current.video.videoHeight;n.current.video.width=i,n.current.video.height=o,r.current.width=i,r.current.height=o;const a=r.current.getContext("2d"),s=await e.estimateFaces(t);requestAnimationFrame((()=>l(a,s,t)))}},l=async(t,e,n)=>{if(e.length>0)for(let r of e){const e=await c(n,r);t.beginPath(),t.strokeStyle="#45ff6a",t.lineWidth=5,t.moveTo(r.box.xMin,r.box.yMin),t.lineTo(r.box.xMax,r.box.yMin),t.lineTo(r.box.xMax,r.box.yMax),t.lineTo(r.box.xMin,r.box.yMax),t.lineTo(r.box.xMin,r.box.yMin),t.scale(-1,1);const[i,o,a,s,l]=[1.25,"cursive","#45ff6a","right","top"];t.font="".concat(i,"em ").concat(o),t.textAlign=s,t.textBaseline=l,t.fillStyle=a,t.fillText(e,-1.15*r.box.xMin,r.box.yMin-20),t.stroke(),t.closePath()}},c=async(t,e)=>{if("undefined"!==typeof i.current&&null!==i.current){const n=e.box.width,r=e.box.height,s=e.box.xMin,l=e.box.yMin,[c,u]=[128,128],h=((t,e,n,r,i,o,a,s)=>{t.clearRect(0,0,e,n),t.drawImage(r,i,o,a,s,0,0,e,n);const l=t.getImageData(0,0,t.canvas.width,t.canvas.height),{data:c,width:u,height:h}=l,d=jO()(new Float32Array(c),[u,h,4]),p=jO()(new Float32Array(u*h*3),[1,3,u,h]);for(let f=0;f<3;f++)WO().assign(p.pick(0,f,null,null),d.pick(null,null,f));return WO().divseq(p,255),p})(i.current.getContext("2d"),c,u,t,s,l,n,r),d=[new BO.Tensor(h.data,"float32",[1,3,c,u])],p=await o.current.run(d),f=await a.current.run(d);let m=WO().argmax(jO()(new Float32Array(p.values().next().value.data))),g=f.get("age").data[0],y=WO().argmax(jO()(new Float32Array(f.get("gender").data))),v=WO().argmax(jO()(new Float32Array(f.get("race").data)));m=G7[m],y=H7[y],v=q7[v];return"".concat(m," ").concat(v," ").concat(y," --- Age ").concat(g.toFixed(0))}return"Predicting ..."};return(0,k.useEffect)((()=>{let e,n;return(async()=>{await(async(t,e)=>{await t.loadModel("/static/models/fer.onnx"),await e.loadModel("/static/models/rag.onnx")})(o.current,a.current)})(),(async()=>{e=await function(t,e){return _Z(this,void 0,void 0,(function(){var n,r;return wZ(this,(function(i){if(t===EJ.MediaPipeFaceMesh){if(r=void 0,null!=(n=e)){if("tfjs"===n.runtime)return[2,jJ(n)];if("mediapipe"===n.runtime)return[2,RZ(n)];r=n.runtime}throw new Error("Expect modelConfig.runtime to be either 'tfjs' or 'mediapipe', but got "+r)}throw new Error(t+" is not a supported model name.")}))}))}(V7,W7),setInterval((()=>s(e)),100),t&&(n=setInterval((()=>s(e)),100))})(),()=>{n&&clearInterval(n),o.current=new BO.InferenceSession({backendHint:"webgl"}),a.current=new BO.InferenceSession({backendHint:"webgl"})}}),[t]),(0,Dn.jsxs)("div",{className:"grid grid-cols-12 gap-4 p-4",children:[(0,Dn.jsx)("div",{className:"col-span-8 flex justify-center",children:t?(0,Dn.jsxs)("div",{className:"relative inline-block",children:[(0,Dn.jsx)(QO(),{ref:n,mirrored:!0,audio:!1,forceScreenshotSourceSize:!0,screenshotFormat:"image/jpeg",screenshotQuality:1,className:"inset-0 w-full h-full",style:{zIndex:9}}),(0,Dn.jsx)("canvas",{ref:r,className:"absolute inset-0 w-full h-full transform scale-x-[-1]",style:{zIndex:9}}),(0,Dn.jsx)("canvas",{ref:i,height:"128",width:"128",className:"hidden"})]}):(0,Dn.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,Dn.jsx)("span",{className:"loading loading-spinner loading-lg"})})}),(0,Dn.jsxs)("div",{className:"col-span-4 flex flex-col items-center",children:[(0,Dn.jsx)("div",{className:"alert alert-info bg-gray-300",children:(0,Dn.jsx)("div",{children:(0,Dn.jsxs)("span",{children:["If camera not showing after clicking the button, make sure you access the website via ",(0,Dn.jsx)("strong",{children:"https"})]})})}),(0,Dn.jsx)("div",{className:"alert alert-info mt-10 bg-gray-300",children:(0,Dn.jsx)("div",{children:(0,Dn.jsx)("span",{children:"All AI models involved here are embedded directly in your browser! So, No data sent to any obscur server! Yeah We are RGPD compliant!!!"})})})]}),(0,Dn.jsx)("div",{className:"col-span-12 flex justify-center my-12",children:(0,Dn.jsx)("button",{className:"btn",onClick:()=>e(!t),children:t?"Pause Camera":"Start Face Detection"})})]})},Y7=t=>{let{children:e,value:n,index:r}=t;return(0,Dn.jsx)("div",{role:"tabpanel",hidden:n!==r,id:"scrollable-auto-tabpanel-".concat(r),"aria-labelledby":"scrollable-auto-tab-".concat(r),children:n===r&&(0,Dn.jsx)("div",{className:"p-3",children:e})})},K7=t=>{let{navBarHeight:e}=t;const[n,r]=(0,k.useState)(0),i=t=>{r(t)};return(0,Dn.jsxs)("div",{className:"w-full h-full bg-gray-800",style:{paddingTop:e},children:[(0,Dn.jsx)("div",{className:"w-full relative",children:(0,Dn.jsxs)("nav",{className:"flex justify-center",children:[(0,Dn.jsx)("button",{className:"px-4 py-2 focus:outline-none ".concat(0===n?"border-b":"border-b border-slate-500"),onClick:()=>i(0),children:"Digit Drawing Classifier"}),(0,Dn.jsx)("button",{className:"px-4 py-2 focus:outline-none ".concat(1===n?"border-b":"border-b border-slate-500"),onClick:()=>i(1),children:"Visual Emotion Classifier"})]})}),(0,Dn.jsxs)("div",{className:"p-4",children:[(0,Dn.jsx)(Y7,{value:n,index:0,children:(0,Dn.jsx)(ZO,{})}),(0,Dn.jsx)(Y7,{value:n,index:1,children:(0,Dn.jsx)(X7,{})})]})]})},Z7=t=>{let{navBarHeight:e}=t;return(0,Dn.jsx)("div",{children:"NLP"})};const J7=function(){const[t,e]=(0,k.useState)(0);return(0,Dn.jsx)("div",{className:"app-container",children:(0,Dn.jsxs)(Yt,{children:[(0,Dn.jsx)(Ln,{setNavBarHeight:e}),(0,Dn.jsxs)(Vt,{children:[(0,Dn.jsx)(zt,{path:"/",element:(0,Dn.jsx)(QA,{})}),(0,Dn.jsx)(zt,{path:"/resume",element:(0,Dn.jsx)(rk,{navBarHeight:t})}),(0,Dn.jsx)(zt,{path:"/projects/dataviz",element:(0,Dn.jsx)(UO,{navBarHeight:t})}),(0,Dn.jsx)(zt,{path:"/projects/computervision",element:(0,Dn.jsx)(K7,{navBarHeight:t})}),(0,Dn.jsx)(zt,{path:"/projects/nlp",element:(0,Dn.jsx)(Z7,{navBarHeight:t})})]})]})})},Q7=t=>{t&&t instanceof Function&&__webpack_require__.e(453).then(__webpack_require__.bind(__webpack_require__,453)).then((e=>{let{getCLS:n,getFID:r,getFCP:i,getLCP:o,getTTFB:a}=e;n(t),r(t),i(t),o(t),a(t)}))};R.createRoot(document.getElementById("root")).render((0,Dn.jsx)(k.StrictMode,{children:(0,Dn.jsx)(J7,{})})),Q7()})()})();
//# sourceMappingURL=main.0c3e31b3.js.map